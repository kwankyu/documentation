
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Number Fields: Galois Groups and Class Groups &#8212; Thematic Tutorials v9.4</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sage.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Orders and Relative Extensions" href="nf_orders.html" />
    <link rel="prev" title="Introduction to Number Fields" href="nf_introduction.html" />
    <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
    <script src="../_static/thebe.js" type="text/javascript"></script>
    <script src="../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="nf_orders.html" title="Orders and Relative Extensions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="nf_introduction.html" title="Introduction to Number Fields"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.4</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="number_fields.html" accesskey="U">Number Fields</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Number Fields: Galois Groups and Class Groups</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="number-fields-galois-groups-and-class-groups">
<h1>Number Fields: Galois Groups and Class Groups<a class="headerlink" href="#number-fields-galois-groups-and-class-groups" title="Permalink to this headline">¶</a></h1>
<section id="galois-groups">
<h2>Galois Groups<a class="headerlink" href="#galois-groups" title="Permalink to this headline">¶</a></h2>
<p>We can compute the Galois group of a number field using the <code class="docutils literal notranslate"><span class="pre">galois_group</span></code>
function, which by default calls Pari (<a class="reference external" href="http://pari.math.u-bordeaux.fr/">http://pari.math.u-bordeaux.fr/</a>). You do
not have to worry about installing Pari, since <em>Pari is part of Sage</em>.  In
fact, despite appearances much of the difficult algebraic number theory in Sage
is actually done by the Pari C library (be sure to also cite Pari in papers
that use Sage).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span> <span class="o">+</span> <span class="mi">40</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1372</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Galois group 6T2 ([3]2) with order 6 of x^6 + 40*x^3 + 1372</span>
</pre></div>
</div>
<p>Internally G is represented as a group of permutations, but we can also apply
any element of G to any element of the field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(1,2)(3,4)(5,6), (1,4,6)(2,5,3)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="mi">1</span><span class="p">;</span> <span class="n">f</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="go">1/36*alpha^4 + 1/18*alpha</span>
</pre></div>
</div>
<p>Some more advanced number-theoretical tools are available via G:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">inertia_group</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">Subgroup generated by [(1,4,6)(2,5,3)] of (Galois group 6T2 ([3]2) with order 6 of x^6 + 40*x^3 + 1372)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">G</span><span class="o">.</span><span class="n">artin_symbol</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">5</span><span class="p">)])</span>  <span class="c1"># random order, see Trac #18308</span>
<span class="go">[(1,3)(2,6)(4,5), (1,2)(3,4)(5,6), (1,5)(2,4)(3,6)]</span>
</pre></div>
</div>
<p>If the number field is not Galois over <span class="math notranslate nohighlight">\(\QQ\)</span>, then the <code class="docutils literal notranslate"><span class="pre">galois_group</span></code>
command will construct its Galois closure and return the Galois group of that:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Galois group 3T2 (S3) with order 6 of x^3 - 2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</section>
<section id="some-more-galois-groups">
<h2>Some more Galois groups<a class="headerlink" href="#some-more-galois-groups" title="Permalink to this headline">¶</a></h2>
<p>We compute two more Galois groups of degree <span class="math notranslate nohighlight">\(5\)</span> extensions, and see that
one has Galois group <span class="math notranslate nohighlight">\(S_5\)</span>, so is not solvable by radicals. For these
purposes we only need to know the structure of the Galois group as an abstract
group, rather than as an explicit group of automorphisms of the splitting
field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group 5T3 (5:4) with order 20 of x^5 - 2</span>
<span class="gp">sage: </span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">galois_group</span><span class="p">()</span>
<span class="go">Galois group 5T5 (S5) with order 120 of x^5 - x + 2</span>
</pre></div>
</div>
</section>
<section id="magma-s-galois-group-command">
<h2>Magma’s Galois group command<a class="headerlink" href="#magma-s-galois-group-command" title="Permalink to this headline">¶</a></h2>
<p>Recent versions of Magma have an algorithm for computing Galois groups that in
theory applies when the input polynomial has any degree. There are no open
source implementation of this algorithm (as far as I know). If you have Magma,
you can use this algorithm from Sage by calling the <code class="docutils literal notranslate"><span class="pre">galois_group</span></code> function
and giving the <code class="docutils literal notranslate"><span class="pre">algorithm='magma'</span></code> option. The return value is one of the
groups in the GAP transitive groups database.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">galois_group</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;gap&quot;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>  <span class="c1"># optional - magma</span>
<span class="go">Galois group Transitive group number 2 of degree 3 of</span>
<span class="go">the Number Field in a with defining polynomial x^3 - 2</span>
</pre></div>
</div>
<p>We emphasize that the above example should not work if you don’t
have Magma.</p>
</section>
<section id="computing-complex-embeddings">
<h2>Computing complex embeddings<a class="headerlink" href="#computing-complex-embeddings" title="Permalink to this headline">¶</a></h2>
<p>You can also enumerate all complex embeddings of a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -0.629960524947437 - 1.09112363597172*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; -0.629960524947437 + 1.09112363597172*I,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial x^3 - 2</span>
<span class="go">  To:   Complex Field with 53 bits of precision</span>
<span class="go">  Defn: a |--&gt; 1.25992104989487</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="class-numbers-and-class-groups">
<h2>Class Numbers and Class Groups<a class="headerlink" href="#class-numbers-and-class-groups" title="Permalink to this headline">¶</a></h2>
<p>The class group <span class="math notranslate nohighlight">\(C_K\)</span> of a number field <span class="math notranslate nohighlight">\(K\)</span> is the group
of fractional ideals of the maximal order <span class="math notranslate nohighlight">\(R\)</span> of <span class="math notranslate nohighlight">\(K\)</span>
modulo the subgroup of principal fractional ideals. One of the main
theorems of algebraic number theory asserts that <span class="math notranslate nohighlight">\(C_K\)</span> is a
finite group. For example, the quadratic number field
<span class="math notranslate nohighlight">\(\QQ(\sqrt{-23})\)</span> has class number <span class="math notranslate nohighlight">\(3\)</span>, as we see
using the Sage <code class="docutils literal notranslate"><span class="pre">class</span> <span class="pre">number</span></code> command.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</section>
<section id="quadratic-imaginary-fields-with-class-number-1">
<h2>Quadratic imaginary fields with class number 1<a class="headerlink" href="#quadratic-imaginary-fields-with-class-number-1" title="Permalink to this headline">¶</a></h2>
<p>There are only 9 quadratic imaginary field
<span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span> that have class number <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="math notranslate nohighlight">
\[D = -3, -4, -7, -8, -11, -19, -43, -67, -163\]</div>
<p>To find this list using Sage, we first experiment with making lists
in Sage. For example, typing <code class="docutils literal notranslate"><span class="pre">[1..10]</span></code> makes the
list of integers between <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(10\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span>
</pre></div>
</div>
<p>We can also make the list of odd integers between <span class="math notranslate nohighlight">\(1\)</span> and
<span class="math notranslate nohighlight">\(11\)</span>, by typing <code class="docutils literal notranslate"><span class="pre">[1,3,..,11]</span></code>, i.e., by giving the second term
in the arithmetic progression.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="mi">11</span><span class="p">]</span>
<span class="go">[1, 3, 5, 7, 9, 11]</span>
</pre></div>
</div>
<p>Applying this idea, we make the list of negative numbers from
<span class="math notranslate nohighlight">\(-1\)</span> down to <span class="math notranslate nohighlight">\(-10\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">]</span>
<span class="go">[-1, -2, -3, -4, -5, -6, -7, -8, -9, -10]</span>
</pre></div>
</div>
</section>
<section id="enumerating-quadratic-imaginary-fields-with-class-number-1">
<h2>Enumerating quadratic imaginary fields with class number 1<a class="headerlink" href="#enumerating-quadratic-imaginary-fields-with-class-number-1" title="Permalink to this headline">¶</a></h2>
<p>The first two lines below makes a list <span class="math notranslate nohighlight">\(v\)</span> of every <span class="math notranslate nohighlight">\(D\)</span>
from <span class="math notranslate nohighlight">\(-1\)</span> down to <span class="math notranslate nohighlight">\(-200\)</span> such that <span class="math notranslate nohighlight">\(D\)</span> is a
fundamental discriminant (the discriminant of a quadratic imaginary
field).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that you will not see the … in the output below;
this … notation just means that part of the output is omitted
below.</p>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">..</span><span class="p">,</span><span class="o">-</span><span class="mi">200</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">w</span> <span class="k">if</span> <span class="n">is_fundamental_discriminant</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[-3, -4, -7, -8, -11, -15, -19, -20, ..., -195, -199]</span>
</pre></div>
</div>
<p>Finally, we make the list of <span class="math notranslate nohighlight">\(D\)</span> in our list <span class="math notranslate nohighlight">\(v\)</span> such that
the quadratic number field <span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span> has class
number <span class="math notranslate nohighlight">\(1\)</span>. Notice that <code class="docutils literal notranslate"><span class="pre">QuadraticField(D)</span></code> is a shorthand for
<code class="docutils literal notranslate"><span class="pre">NumberField(x^2</span> <span class="pre">-</span> <span class="pre">D)</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">if</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span><span class="o">==</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[-3, -4, -7, -8, -11, -19, -43, -67, -163]</span>
</pre></div>
</div>
<p>Of course, we have <em>not</em> proved that this is the list of all
negative <span class="math notranslate nohighlight">\(D\)</span> so that <span class="math notranslate nohighlight">\(\QQ(\sqrt{D})\)</span> has
class number <span class="math notranslate nohighlight">\(1\)</span>.</p>
</section>
<section id="class-number-1-fields">
<h2>Class number 1 fields<a class="headerlink" href="#class-number-1-fields" title="Permalink to this headline">¶</a></h2>
<p>A frustrating open problem is to prove that there are infinitely many
number fields with class number <span class="math notranslate nohighlight">\(1\)</span>. It is quite easy to be
convinced that this is probably true by computing a bunch of class
numbers of real quadratic fields. For example, over 58 percent of the
real quadratic number fields with discriminant <span class="math notranslate nohighlight">\(D&lt;1000\)</span> have
class number <span class="math notranslate nohighlight">\(1\)</span>!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">1000</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">w</span> <span class="k">if</span> <span class="n">is_fundamental_discriminant</span><span class="p">(</span><span class="n">D</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">302</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">([</span><span class="n">D</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="n">v</span> <span class="k">if</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="n">D</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">176</span>
<span class="gp">sage: </span><span class="mf">176.0</span><span class="o">/</span><span class="mi">302</span>
<span class="go">0.582781456953642</span>
</pre></div>
</div>
<p>For more intuition about what is going on, read about the
Cohen-Lenstra heuristics.</p>
</section>
<section id="class-numbers-of-cyclotomic-fields">
<h2>Class numbers of cyclotomic fields<a class="headerlink" href="#class-numbers-of-cyclotomic-fields" title="Permalink to this headline">¶</a></h2>
<p>Sage can also compute class numbers of extensions of higher degree,
within reason. Here we use the shorthand <code class="docutils literal notranslate"><span class="pre">CyclotomicField(n)</span></code> to
create the number field <span class="math notranslate nohighlight">\(\QQ(\zeta_n)\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">Cyclotomic Field of order 7 and degree 6</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.</span><span class="o">.</span><span class="mi">15</span><span class="p">]:</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()))</span>
<span class="go">2 1</span>
<span class="go">3 1</span>
<span class="go">...</span>
<span class="go">15 1</span>
</pre></div>
</div>
<p>In the code above, the notation <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">n</span> <span class="pre">in</span> <span class="pre">[2..15]:</span> <span class="pre">...</span></code> means
“do … for <span class="math notranslate nohighlight">\(n\)</span> equal to each of the integers <span class="math notranslate nohighlight">\(2,3,4,\dots,15\)</span>.”</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exercise: Compute what is omitted (replaced by …) in the output
of the previous example.</p>
</div>
</section>
<section id="assuming-conjectures-to-speed-computations">
<h2>Assuming conjectures to speed computations<a class="headerlink" href="#assuming-conjectures-to-speed-computations" title="Permalink to this headline">¶</a></h2>
<p>Computations of class numbers and class groups in Sage is done by the
Pari C library, and <em>unlike in Pari</em>, by default Sage tells Pari <em>not
to assume</em> any conjectures. This can make some commands vastly slower
than they might be directly in Pari, which <em>does assume unproved
conjectures</em> by default. Fortunately, it is easy to tell Sage to be
more permissive and allow Pari to assume conjectures, either just for
this one call or henceforth for all number field functions. For
example, with <code class="docutils literal notranslate"><span class="pre">proof=False</span></code> it takes only a few seconds to verify,
modulo the conjectures assumed by Pari, that the class number of
<span class="math notranslate nohighlight">\(\QQ(\zeta_{23})\)</span> is <span class="math notranslate nohighlight">\(3\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exercise: What is the smallest <span class="math notranslate nohighlight">\(n\)</span> such that
<span class="math notranslate nohighlight">\(\QQ(\zeta_n)\)</span> has class number bigger than <span class="math notranslate nohighlight">\(1\)</span>?</p>
</div>
</section>
<section id="class-group-structure">
<h2>Class group structure<a class="headerlink" href="#class-group-structure" title="Permalink to this headline">¶</a></h2>
<p>In addition to computing class numbers, Sage can also compute the
group structure and generators for class groups. For example, the
quadratic field <span class="math notranslate nohighlight">\(\QQ(\sqrt{-30})\)</span> has class group
<span class="math notranslate nohighlight">\(C = (\ZZ/2\ZZ)^{\oplus 2}\)</span>, with generators the
ideal classes containing <span class="math notranslate nohighlight">\((5,\sqrt{-30})\)</span> and
<span class="math notranslate nohighlight">\((3,\sqrt{-30})\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">Class group of order 4 with structure C2 x C2 of Number Field in a with defining polynomial x^2 + 30 with a = 5.477225575051661?*I</span>
<span class="gp">sage: </span><span class="n">category</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">Category of finite enumerated commutative groups</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(Fractional ideal class (5, a), Fractional ideal class (3, a))</span>
</pre></div>
</div>
</section>
<section id="arithmetic-in-the-class-group">
<h2>Arithmetic in the class group<a class="headerlink" href="#arithmetic-in-the-class-group" title="Permalink to this headline">¶</a></h2>
<p>In Sage, the notation <code class="docutils literal notranslate"><span class="pre">C.i</span></code> means “the <span class="math notranslate nohighlight">\(i^{th}\)</span> generator of the
object <span class="math notranslate nohighlight">\(C\)</span>,” where the generators are indexed by numbers
<span class="math notranslate nohighlight">\(0, 1, 2, \dots\)</span>. Below, when we write <code class="docutils literal notranslate"><span class="pre">C.0</span> <span class="pre">\*</span> <span class="pre">C.1</span></code>, this
means “the product of the 0th and 1st generators of the class group
<span class="math notranslate nohighlight">\(C\)</span>.”</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">class_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="mi">0</span>
<span class="go">Fractional ideal class (5, a)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="mf">0.</span><span class="n">ideal</span><span class="p">()</span>
<span class="go">Fractional ideal (5, a)</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="mi">0</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">I</span>
<span class="go">Fractional ideal class (2, a)</span>
</pre></div>
</div>
<p>Next we find that the class of the fractional ideal
<span class="math notranslate nohighlight">\((2,\sqrt{-30}+4/3)\)</span> is equal to the ideal class
<span class="math notranslate nohighlight">\(C.0*C.1\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">C</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">Fractional ideal class (2/3, 1/3*a)</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">==</span> <span class="n">C</span><span class="o">.</span><span class="mi">0</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Unfortunately, there is currently no Sage function that writes a
fractional ideal class in terms of the generators for the class
group.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Number Fields: Galois Groups and Class Groups</a><ul>
<li><a class="reference internal" href="#galois-groups">Galois Groups</a></li>
<li><a class="reference internal" href="#some-more-galois-groups">Some more Galois groups</a></li>
<li><a class="reference internal" href="#magma-s-galois-group-command">Magma’s Galois group command</a></li>
<li><a class="reference internal" href="#computing-complex-embeddings">Computing complex embeddings</a></li>
<li><a class="reference internal" href="#class-numbers-and-class-groups">Class Numbers and Class Groups</a></li>
<li><a class="reference internal" href="#quadratic-imaginary-fields-with-class-number-1">Quadratic imaginary fields with class number 1</a></li>
<li><a class="reference internal" href="#enumerating-quadratic-imaginary-fields-with-class-number-1">Enumerating quadratic imaginary fields with class number 1</a></li>
<li><a class="reference internal" href="#class-number-1-fields">Class number 1 fields</a></li>
<li><a class="reference internal" href="#class-numbers-of-cyclotomic-fields">Class numbers of cyclotomic fields</a></li>
<li><a class="reference internal" href="#assuming-conjectures-to-speed-computations">Assuming conjectures to speed computations</a></li>
<li><a class="reference internal" href="#class-group-structure">Class group structure</a></li>
<li><a class="reference internal" href="#arithmetic-in-the-class-group">Arithmetic in the class group</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="nf_introduction.html"
                        title="previous chapter">Introduction to Number Fields</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="nf_orders.html"
                        title="next chapter">Orders and Relative Extensions</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/explicit_methods_in_number_theory/nf_galois_groups.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="nf_orders.html" title="Orders and Relative Extensions"
             >next</a> |</li>
        <li class="right" >
          <a href="nf_introduction.html" title="Introduction to Number Fields"
             >previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.4</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="number_fields.html" >Number Fields</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Number Fields: Galois Groups and Class Groups</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>