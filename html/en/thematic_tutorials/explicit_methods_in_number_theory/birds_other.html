
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>The Matrix of Frobenius on Hyperelliptic Curves &#8212; Thematic Tutorials v9.2</title>
    <link rel="stylesheet" href="../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modular Forms" href="modular_forms.html" />
    <link rel="prev" title="Elliptic Curves" href="elliptic_curves.html" />
    <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
    <script src="../_static/thebe.js" type="text/javascript"></script>
    <script src="../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modular_forms.html" title="Modular Forms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="elliptic_curves.html" title="Elliptic Curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.2</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="birds_eye_view.html" accesskey="U">A Bird’s Eye View</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The Matrix of Frobenius on Hyperelliptic Curves</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-matrix-of-frobenius-on-hyperelliptic-curves">
<h1>The Matrix of Frobenius on Hyperelliptic Curves<a class="headerlink" href="#the-matrix-of-frobenius-on-hyperelliptic-curves" title="Permalink to this headline">¶</a></h1>
<p>Sage has a highly optimized implementation of the Harvey-Kedlaya
algorithm for computing the matrix of Frobenius associated to a curve
over a finite field. This is an implementation by David Harvey, which
is GPL’d and depends only on NTL and zn_poly (a C library in Sage for
fast arithmetic in <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)[x]\)</span>).</p>
<p>We import the hypellfrob function and call it on a polynomial over
<span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.hypellfrob</span> <span class="kn">import</span> <span class="n">hypellfrob</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">101</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">hypellfrob</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[     O(101)      O(101) 93 + O(101) 62 + O(101)]</span>
<span class="go">[     O(101)      O(101) 55 + O(101) 19 + O(101)]</span>
<span class="go">[     O(101)      O(101) 65 + O(101) 42 + O(101)]</span>
<span class="go">[     O(101)      O(101) 89 + O(101) 29 + O(101)]</span>
</pre></div>
</div>
<p>We do the same calculation but in <span class="math notranslate nohighlight">\(\ZZ/101^4\ZZ\)</span>,
which gives enough precision to recognize the exact characteristic
polynomial in <span class="math notranslate nohighlight">\(\ZZ[x]\)</span> of Frobenius as an element of the
endomorphism ring. This computation is still very fast, taking only a
fraction of a second.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">hypellfrob</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>   <span class="c1"># about 0.25 seconds</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">91844754 + O(101^4)</span>
</pre></div>
</div>
<p>The characteristic polynomial of Frobenius is <span class="math notranslate nohighlight">\(x^4 + 7x^3 +
167x^2 + 707x + 10201\)</span>, which determines the <span class="math notranslate nohighlight">\(\zeta\)</span> function of
the curve <span class="math notranslate nohighlight">\(y^2= f(x)\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">(1 + O(101^4))*x^4 + (7 + O(101^4))*x^3 + (167 + O(101^4))*x^2 + (707 + O(101^4))*x + 10201 + O(101^4)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exercise: Write down zeta function explicitly, count points over
some finite fields and see that things match up.</p>
</div>
</div>
<div class="section" id="modular-symbols">
<h1>Modular Symbols<a class="headerlink" href="#modular-symbols" title="Permalink to this headline">¶</a></h1>
<p>Modular symbols play a key role in algorithms for computing with
modular forms, special values of <span class="math notranslate nohighlight">\(L\)</span>-functions, elliptic
curves, and modular abelian varieties. Sage has the most general
implementation of modular symbols available, thanks to work of
myself, Jordi Quer (of Barcelona) and Craig Citro (a student of
Hida). Moreover, computation with modular symbols is by far my most
favorite part of computational mathematics. There is still a lot of
tuning and optimization work to be done for modular symbols in
Sage, in order for it to be across the board the fastest
implementation in the world, since my Magma implementation is still
better in some important cases.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>I will talk much more about modular symbols in my lecture on
Friday, which will be about modular forms and related objects.</p>
</div>
<p>We create the space <span class="math notranslate nohighlight">\(M\)</span> of weight <span class="math notranslate nohighlight">\(4\)</span> modular
symbols for a certain congruence subgroup <span class="math notranslate nohighlight">\(\Gamma_H(13)\)</span>
of level <span class="math notranslate nohighlight">\(13\)</span>. Then we compute a basis for this space,
expressed in terms of Manin symbols. Finally, we compute the Hecke
operator <span class="math notranslate nohighlight">\(T_2\)</span> acting on <span class="math notranslate nohighlight">\(M\)</span>, find its
characteristic polynomial and factor it. We also compute the
dimension of the cuspidal subspace.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="n">GammaH</span><span class="p">(</span><span class="mi">13</span><span class="p">,[</span><span class="mi">3</span><span class="p">]),</span> <span class="n">weight</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Modular Symbols space of dimension 14 for Congruence Subgroup</span>
<span class="go">Gamma_H(13) with H generated by [3] of weight 4 with sign 0</span>
<span class="go">and over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">([X^2,(0,4)],</span>
<span class="go">[X^2,(0,7)],</span>
<span class="go">[X^2,(4,10)],</span>
<span class="go">[X^2,(4,11)],</span>
<span class="go">[X^2,(4,12)],</span>
<span class="go">[X^2,(7,3)],</span>
<span class="go">[X^2,(7,5)],</span>
<span class="go">[X^2,(7,6)],</span>
<span class="go">[X^2,(7,7)],</span>
<span class="go">[X^2,(7,8)],</span>
<span class="go">[X^2,(7,9)],</span>
<span class="go">[X^2,(7,10)],</span>
<span class="go">[X^2,(7,11)],</span>
<span class="go">[X^2,(7,12)])</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">charpoly</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">(x - 7) * (x + 7) * (x - 9)^2 * (x + 5)^2</span>
<span class="go">        * (x^2 - x - 4)^2 * (x^2 + 9)^2</span>
<span class="gp">sage: </span><span class="n">dimension</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">())</span>
<span class="go">10</span>
</pre></div>
</div>
<p>{Cremona’s Modular Symbols Library} Sage includes John Cremona’s
specialized and insanely fast implementation of modular symbols for
weight 2 and trivial character. We illustrate below computing the
space of modular symbols of level 20014, which has dimension
<span class="math notranslate nohighlight">\(5005\)</span>, along with a Hecke operator on this space. The
whole computation below takes only a few seconds; a similar
computation takes a few minutes using Sage’s generic modular
symbols code. Moreover, Cremona has done computations at levels
over 200,000 using his library, so the code is known to scale well
to large problems. The new code in Sage for modular symbols is much
more general, but doesn’t scale nearly so well (yet).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">CremonaModularSymbols</span><span class="p">(</span><span class="mi">20014</span><span class="p">)</span>       <span class="c1"># few seconds</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Cremona Modular Symbols space of dimension 5005 for</span>
<span class="go">Gamma_0(20014) of weight 2 with sign 0</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>             <span class="c1"># few seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="enumerating-totally-real-number-fields">
<h1>Enumerating Totally Real Number Fields<a class="headerlink" href="#enumerating-totally-real-number-fields" title="Permalink to this headline">¶</a></h1>
<p>As part of his project to enumerate Shimura curves, John Voight has
contributed code to Sage for enumerating totally real number
fields. The algorithm isn’t extremely complicated, but it involves
some “inner loops” that have to be coded to run very quickly. Using
Cython, Voight was able to implement exactly the variant of Newton
iteration that he needed for his problem.</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">enumerate_totallyreal_fields_prim(n,</span> <span class="pre">B,</span> <span class="pre">...)</span></code>
enumerates without using a database (!) primitive (no proper subfield)
totally real fields of degree <span class="math notranslate nohighlight">\(n&gt;1\)</span> with discriminant <span class="math notranslate nohighlight">\(d
\leq B\)</span>.</p>
<p>We compute the totally real quadratic fields of discriminant
<span class="math notranslate nohighlight">\(\leq 50\)</span>. The calculation below, which is almost instant,
is done in real time and is not a table lookup.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">enumerate_totallyreal_fields_prim</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="go">[[5, x^2 - x - 1], [8, x^2 - 2], [12, x^2 - 3], [13, x^2 - x - 3],</span>
<span class="go"> [17, x^2 - x - 4], [21, x^2 - x - 5], [24, x^2 - 6], [28, x^2 - 7],</span>
<span class="go"> [29, x^2 - x - 7], [33, x^2 - x - 8], [37, x^2 - x - 9],</span>
<span class="go"> [40, x^2 - 10], [41, x^2 - x - 10], [44, x^2 - 11]]</span>
</pre></div>
</div>
<p>We compute all totally real quintic fields of discriminant
<span class="math notranslate nohighlight">\(\leq 10^5\)</span>.  Again, this is done in real time - it’s not a
table lookup!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">enumerate_totallyreal_fields_prim</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[14641, x^5 - x^4 - 4*x^3 + 3*x^2 + 3*x - 1],</span>
<span class="go"> [24217, x^5 - 5*x^3 - x^2 + 3*x + 1],</span>
<span class="go"> [36497, x^5 - 2*x^4 - 3*x^3 + 5*x^2 + x - 1],</span>
<span class="go"> [38569, x^5 - 5*x^3 + 4*x - 1],</span>
<span class="go"> [65657, x^5 - x^4 - 5*x^3 + 2*x^2 + 5*x + 1],</span>
<span class="go"> [70601, x^5 - x^4 - 5*x^3 + 2*x^2 + 3*x - 1],</span>
<span class="go"> [81509, x^5 - x^4 - 5*x^3 + 3*x^2 + 5*x - 2],</span>
<span class="go"> [81589, x^5 - 6*x^3 + 8*x - 1],</span>
<span class="go"> [89417, x^5 - 6*x^3 - x^2 + 8*x + 3]]</span>
</pre></div>
</div>
</div>
<div class="section" id="bernoulli-numbers">
<h1>Bernoulli Numbers<a class="headerlink" href="#bernoulli-numbers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="mathematica-and-pari">
<h2>Mathematica and Pari<a class="headerlink" href="#mathematica-and-pari" title="Permalink to this headline">¶</a></h2>
<p>From the Mathematica website:</p>
<blockquote>
<div><p>“Today We Broke the Bernoulli Record: From the Analytical Engine
to Mathematica April 29, 2008 Oleksandr Pavlyk, Kernel Technology
A week ago, I took our latest development version of Mathematica,
and I typed <code class="docutils literal notranslate"><span class="pre">BernoulliB[10^7]</span></code>. And then I waited. Yesterday–5
days, 23 hours, 51 minutes, and 37 seconds later–I got the
result!”</p>
</div></blockquote>
<p>Tom Boothby did that same computation in Sage, which uses Pari’s
bernfrac command that uses evaluation of <span class="math notranslate nohighlight">\(\zeta\)</span> and
factorial to high precision, and it took 2 days, 12 hours.</p>
</div>
<div class="section" id="david-harvey-s-bernmm">
<h2>David Harvey’s bernmm<a class="headerlink" href="#david-harvey-s-bernmm" title="Permalink to this headline">¶</a></h2>
<p>Then David Harvey came up with an entirely new algorithm that
parallelizes well. He gives these timings for computing
<span class="math notranslate nohighlight">\(B_{10^7}\)</span> on his machine (it takes 59 minutes, 57 seconds on my
16-core 1.8ghz Opteron box):</p>
<p><code class="docutils literal notranslate"><span class="pre">PARI:</span> <span class="pre">75</span> <span class="pre">h,</span> <span class="pre">Mathematica:</span> <span class="pre">142</span> <span class="pre">h</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">bernmm</span> <span class="pre">(1</span> <span class="pre">core)</span> <span class="pre">=</span> <span class="pre">11.1</span> <span class="pre">h,</span> <span class="pre">bernmm</span> <span class="pre">(10</span> <span class="pre">cores)</span> <span class="pre">=</span> <span class="pre">1.3</span> <span class="pre">h</span></code></p>
<blockquote>
<div><p>“Running on 10 cores for 5.5 days, I [David Harvey] computed [the
Bernoulli number] <span class="math notranslate nohighlight">\(B_k\)</span> for <span class="math notranslate nohighlight">\(k = 10^8\)</span>, which I
believe is a new record. Essentially it’s the multimodular
algorithm I suggested earlier on this thread, but I figured out
some tricks to optimise the crap out of the computation of
<span class="math notranslate nohighlight">\(B_k \text{mod} p\)</span>.”</p>
</div></blockquote>
<p>So now Sage is the fastest in the world for large Bernoulli
numbers. The timings below are on a 24-core 2.66Ghz Xeon box.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w1</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">num_threads</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>     <span class="c1"># 0.9 seconds wall time</span>
<span class="gp">sage: </span><span class="n">w2</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>   <span class="c1"># long time (6s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="n">w1</span> <span class="o">==</span> <span class="n">w2</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="polynomial-arithmetic">
<h1>Polynomial Arithmetic<a class="headerlink" href="#polynomial-arithmetic" title="Permalink to this headline">¶</a></h1>
<div class="section" id="flint-univariate-polynomial-arithmetic">
<h2>FLINT: Univariate Polynomial Arithmetic<a class="headerlink" href="#flint-univariate-polynomial-arithmetic" title="Permalink to this headline">¶</a></h2>
<p>Sage uses Bill Hart and David Harvey’s GPL’d Flint C library for
arithmetic in <span class="math notranslate nohighlight">\(\ZZ[x]\)</span>. Its main claim to fame is that it is the
world’s fastest for polynomial multiplication, e.g., in the benchmark
below it is faster than NTL and Magma on some systems (though such
benchmarks of course change as software improves).  Behind the scenes
Flint contains some carefully tuned discrete Fourier transform code.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Rflint</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Rflint</span><span class="p">([</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">32</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Rflint</span><span class="p">([</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">32</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;f*g&#39;</span><span class="p">)</span>               <span class="c1"># random output</span>
<span class="go">625 loops, best of 3: 105 microseconds per loop</span>
<span class="gp">sage: </span><span class="n">Rntl</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s1">&#39;NTL&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Rntl</span><span class="p">([</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">32</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">Rntl</span><span class="p">([</span><span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">32</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;f*g&#39;</span><span class="p">)</span>               <span class="c1"># random output</span>
<span class="go">625 loops, best of 3: 310 microseconds per loop</span>
<span class="gp">sage: </span><span class="n">ff</span> <span class="o">=</span> <span class="n">magma</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">gg</span> <span class="o">=</span> <span class="n">magma</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>  <span class="c1">#optional - magma</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;time v := [</span><span class="si">%s</span><span class="s1"> * </span><span class="si">%s</span><span class="s1"> : i in [1..10^5]];&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">ff</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span> <span class="n">gg</span><span class="o">.</span><span class="n">name</span><span class="p">())</span> <span class="c1">#optional - magma</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>     <span class="c1">#optional - magma</span>
<span class="go">&#39;Time: ...&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="singular-multivariate-polynomial-arithmetic">
<h2>Singular: Multivariate Polynomial Arithmetic<a class="headerlink" href="#singular-multivariate-polynomial-arithmetic" title="Permalink to this headline">¶</a></h2>
<p>Multivariate polynomial arithmetic in many cases uses Singular in
library mode (due to Martin Albrecht), which is quite fast. For example,
below we do the Fateman benchmark over the finite field of order
32003, and compare the timing with Magma.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">32003</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;p*q&#39;</span><span class="p">)</span>   <span class="c1"># random output</span>
<span class="go">125 loops, best of 3: 1.53 ms per loop</span>

<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">20</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;p*q&#39;</span><span class="p">)</span>   <span class="c1"># not tested - timeout if SAGE_DEBUG=yes</span>
<span class="go">5 loops, best of 3: 384 ms per loop</span>

<span class="gp">sage: </span><span class="n">pp</span> <span class="o">=</span> <span class="n">magma</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">qq</span> <span class="o">=</span> <span class="n">magma</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1">#optional - magma</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;time w := </span><span class="si">%s</span><span class="s1">*</span><span class="si">%s</span><span class="s1">;&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">pp</span><span class="o">.</span><span class="n">name</span><span class="p">(),</span><span class="n">qq</span><span class="o">.</span><span class="n">name</span><span class="p">())</span> <span class="c1">#optional - magma</span>
<span class="gp">sage: </span><span class="n">magma</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="c1">#optional - magma</span>
<span class="go">&#39;Time: ...&#39;</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Matrix of Frobenius on Hyperelliptic Curves</a></li>
<li><a class="reference internal" href="#modular-symbols">Modular Symbols</a></li>
<li><a class="reference internal" href="#enumerating-totally-real-number-fields">Enumerating Totally Real Number Fields</a></li>
<li><a class="reference internal" href="#bernoulli-numbers">Bernoulli Numbers</a><ul>
<li><a class="reference internal" href="#mathematica-and-pari">Mathematica and Pari</a></li>
<li><a class="reference internal" href="#david-harvey-s-bernmm">David Harvey’s bernmm</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polynomial-arithmetic">Polynomial Arithmetic</a><ul>
<li><a class="reference internal" href="#flint-univariate-polynomial-arithmetic">FLINT: Univariate Polynomial Arithmetic</a></li>
<li><a class="reference internal" href="#singular-multivariate-polynomial-arithmetic">Singular: Multivariate Polynomial Arithmetic</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="elliptic_curves.html"
                        title="previous chapter">Elliptic Curves</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modular_forms.html"
                        title="next chapter">Modular Forms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/explicit_methods_in_number_theory/birds_other.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modular_forms.html" title="Modular Forms"
             >next</a> |</li>
        <li class="right" >
          <a href="elliptic_curves.html" title="Elliptic Curves"
             >previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.2</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="birds_eye_view.html" >A Bird’s Eye View</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">The Matrix of Frobenius on Hyperelliptic Curves</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>