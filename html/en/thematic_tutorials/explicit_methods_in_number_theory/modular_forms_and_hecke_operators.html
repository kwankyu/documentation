
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Modular Forms and Hecke Operators &#8212; Thematic Tutorials</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Modular Symbols" href="modular_symbols.html" />
    <link rel="prev" title="Modular Forms" href="modular_forms.html" />
  <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
  <!-- <script src="../_static/thebe.js" type="text/javascript"></script> -->
  <!-- <script src="../_static/thebe-sage.js" type="text/javascript"></script> -->

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modular_symbols.html" title="Modular Symbols"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="modular_forms.html" title="Modular Forms"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../index.html">Thematic Tutorials</a> &#187;
    
  </li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="modular_forms.html" accesskey="U">Modular Forms</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Modular Forms and Hecke Operators</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="modular-forms-and-hecke-operators">
<h1>Modular Forms and Hecke Operators<a class="headerlink" href="#modular-forms-and-hecke-operators" title="Permalink to this headline">¶</a></h1>
<section id="congruence-subgroups">
<h2>Congruence subgroups<a class="headerlink" href="#congruence-subgroups" title="Permalink to this headline">¶</a></h2>
<section id="definition">
<h3>Definition<a class="headerlink" href="#definition" title="Permalink to this headline">¶</a></h3>
<p>A congruence subgroup is a subgroup of the group
<span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ)\)</span> of determinant <span class="math notranslate nohighlight">\(\pm 1\)</span> integer
matrices that contains</p>
<div class="math notranslate nohighlight">
\[\Gamma(N) = \mathrm{Ker}(\mathrm{SL}_2(\ZZ) \to \mathrm{SL}_2(\ZZ/N\ZZ))\]</div>
<p>for some positive integer <span class="math notranslate nohighlight">\(N\)</span>. Since <span class="math notranslate nohighlight">\(\Gamma(N)\)</span> has
finite index in <span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ)\)</span>, all congruence subgroups
have finite index. The converse is not true, though in many other
settings it is true (see [paper of Serre]).</p>
<p>The inverse image <span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span> of the subgroup of upper
triangular matrices in <span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ/N\ZZ)\)</span>
is a congruence subgroup, as is the inverse image <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>
of the subgroup of matrices of the form
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}1&amp;*\\0&amp;1\end{smallmatrix}\right)\)</span>. Also,
for any subgroup <span class="math notranslate nohighlight">\(H\subset (\ZZ/N\ZZ)^*\)</span>, the
inverse image <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> of the subgroup of
<span class="math notranslate nohighlight">\(\mathrm{SL}_2(\ZZ/N\ZZ)\)</span> of all elements of the
form <span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}a&amp;*\\0&amp;d\end{smallmatrix}\right)\)</span>
with <span class="math notranslate nohighlight">\(d \in H\)</span> is a congruence subgroup.</p>
<p>We can create each of the above congruence subgroups in Sage, using
the Gamma0, Gamma1, and GammaH commands.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">Congruence Subgroup Gamma0(8)</span>
<span class="gp">sage: </span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">Congruence Subgroup Gamma1(13)</span>
<span class="gp">sage: </span><span class="n">GammaH</span><span class="p">(</span><span class="mi">11</span><span class="p">,[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Congruence Subgroup Gamma_H(11) with H generated by [3]</span>
</pre></div>
</div>
<p>The second argument to the GammaH command is a list of generators of
the subgroup <span class="math notranslate nohighlight">\(H\)</span> of <span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>.</p>
</section>
<section id="generators">
<h3>Generators<a class="headerlink" href="#generators" title="Permalink to this headline">¶</a></h3>
<p>Sage can compute a list of generators for these subgroups. The
algorithm Sage uses is a straightforward generic procedure that uses
coset representatives for the congruence subgroup (which are easy to
enumerate) to obtain a list of generators [[ref my modular forms
book]].</p>
<p>The list of generators Sage computes is unfortunately large. Improving this
would be an excellent Sage development project, which would involve much
beautiful mathematics.</p>
<p>UPDATE (March 2012): The project referred to above has been carried out (by
several people, notably Hartmut Monien, building on earlier work of Chris
Kurth). Sage now uses a much more advanced algorithm based on Farey symbols
which calculates a <em>minimal</em> set of generators.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[1 1]  [ 1 -1]</span>
<span class="go">[0 1], [ 2 -1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;todd-coxeter&quot;</span><span class="p">)</span> <span class="c1"># the old implementation</span>
<span class="go">(</span>
<span class="go">[1 1]  [-1  0]  [ 1 -1]  [ 1 -1]  [-1  1]</span>
<span class="go">[0 1], [ 0 -1], [ 0  1], [ 2 -1], [-2  1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">15</span>
</pre></div>
</div>
</section>
</section>
<section id="modular-forms">
<h2>Modular Forms<a class="headerlink" href="#modular-forms" title="Permalink to this headline">¶</a></h2>
<section id="id1">
<h3>Definition<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>A modular form on a congruence subgroup
<span class="math notranslate nohighlight">\(\Gamma\)</span> of integer weight <span class="math notranslate nohighlight">\(k\)</span> is a holomorphic
function <span class="math notranslate nohighlight">\(f(z)\)</span> on the upper half plane</p>
<div class="math notranslate nohighlight">
\[\mathfrak{h}^* = \{z \in \CC : \Im(z) &gt; 0\}\cup \QQ \cup\{i\infty\}\]</div>
<p>such that for every matrix
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}a&amp;b\\c&amp;d\end{smallmatrix}\right)\in\Gamma\)</span>,
we have</p>
<div class="math notranslate nohighlight" id="modform">
\[f\left(\frac{az+b}{cz+d}\right) = (cz+d)^{k} f(z).\]</div>
<p>A cusp form is a modular form that vanishes at all of the cusps
<span class="math notranslate nohighlight">\(\QQ \cup \{i\infty\}\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\Gamma\)</span> contains <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span> for some <span class="math notranslate nohighlight">\(N\)</span>,
then
<span class="math notranslate nohighlight">\(\left(\begin{smallmatrix}1&amp;1\\0&amp;1\end{smallmatrix}\right)\in\Gamma\)</span>,
so <a class="reference internal" href="#modform"><span class="std std-ref">the modular form condition</span></a> implies that <span class="math notranslate nohighlight">\(f(z) = f(z+1)\)</span>. This, coupled
with the holomorphicity condition, implies that <span class="math notranslate nohighlight">\(f(z)\)</span> has a
Fourier expansion</p>
<div class="math notranslate nohighlight">
\[f(z) = \sum_{n=0}^{\infty} a_n e^{2\pi i n z}\]</div>
<p>with <span class="math notranslate nohighlight">\(a_n\in\CC\)</span>. We let <span class="math notranslate nohighlight">\(q = e^{2\pi i z}\)</span>, and
call <span class="math notranslate nohighlight">\(f = \sum_{n=0}^{\infty} a_n q^n\)</span> the <span class="math notranslate nohighlight">\(q\)</span>-expansion
of <span class="math notranslate nohighlight">\(f\)</span>.</p>
</section>
<section id="creation-in-sage">
<h3>Creation in Sage<a class="headerlink" href="#creation-in-sage" title="Permalink to this headline">¶</a></h3>
<p>Henceforth we assume that
<span class="math notranslate nohighlight">\(\Gamma\)</span> is either <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>,
<span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span>, or <span class="math notranslate nohighlight">\(\Gamma_H(N)\)</span> for some
<span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(N\)</span>. The complex vector space
<span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> of all modular forms of weight <span class="math notranslate nohighlight">\(k\)</span>
on <span class="math notranslate nohighlight">\(\Gamma\)</span> is a finite dimensional vector space.</p>
<p>We create the space <span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> in Sage by typing
<code class="docutils literal notranslate"><span class="pre">ModularForms(G,</span> <span class="pre">k)</span></code> where <span class="math notranslate nohighlight">\(G\)</span> is the congruence subgroup
and <span class="math notranslate nohighlight">\(k\)</span> is the weight.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 11 for ...</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">CuspForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span><span class="mi">4</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span> <span class="n">S</span>
<span class="go">Cuspidal subspace of dimension 5 of Modular Forms space ...</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + q^9 - 8*q^11 - 8*q^14 + O(q^15),</span>
<span class="go">q^2 - q^7 - q^8 - 7*q^12 + 7*q^13 + O(q^15),</span>
<span class="go">q^3 + q^7 - 2*q^8 - 6*q^12 - 5*q^13 + O(q^15),</span>
<span class="go">q^4 - q^6 - 3*q^9 + 5*q^11 - 2*q^14 + O(q^15),</span>
<span class="go">q^5 - 4*q^10 + O(q^15)</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="dimension-formulas">
<h3>Dimension Formulas<a class="headerlink" href="#dimension-formulas" title="Permalink to this headline">¶</a></h3>
<p>Sage computes the dimensions of all these spaces using simple
arithmetic formulas instead of actually computing bases for the spaces
in question. In fact, Sage has the most general collection of modular
forms dimension formulas of any software; type <code class="docutils literal notranslate"><span class="pre">help(sage.modular.dims)</span></code>
to see a list of arithmetic functions that are used to implement these
dimension formulas.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">949284</span><span class="p">),</span> <span class="mi">456</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">11156973844800</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.dims</span> <span class="kn">import</span> <span class="n">dimension_cusp_forms</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">dimension_cusp_forms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="n">N</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..25</span><span class="p">]];</span> <span class="n">a</span>
<span class="go">[0, 0, ..., 1, 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 2, 2, 1, 0]</span>
<span class="gp">sage: </span><span class="n">oeis</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>                                       <span class="c1"># optional - internet</span>
<span class="go">0: A001617: Genus of modular group Gamma_0(n). Or, genus of modular curve X_0(n).</span>
</pre></div>
</div>
<p>Sage does not have simple formulas for dimensions of spaces of modular
forms of weight <span class="math notranslate nohighlight">\(1\)</span>, since such formulas perhaps do not exist.</p>
</section>
<section id="diamond-bracket-operators">
<h3>Diamond Bracket Operators<a class="headerlink" href="#diamond-bracket-operators" title="Permalink to this headline">¶</a></h3>
<p>The space
<span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span> is equipped with an action of
<span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span> by diamond bracket operators
<span class="math notranslate nohighlight">\(\langle d \rangle\)</span>, and this induces a decomposition</p>
<div class="math notranslate nohighlight">
\[M_k(\Gamma_1(N)) = \bigoplus_{\varepsilon:(\ZZ/N\ZZ)^* \to \CC^*} M_k(N,\varepsilon),\]</div>
<p>where the sum is over all complex characters of the
finite abelian group <span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>. These
characters are called Dirichlet characters, which are central in
number theory.</p>
<p>The factors <span class="math notranslate nohighlight">\(M_k(N,\varepsilon)\)</span> then have bases whose
<span class="math notranslate nohighlight">\(q\)</span>-expansions are elements of <span class="math notranslate nohighlight">\(R[[q]]\)</span>, where
<span class="math notranslate nohighlight">\(R = \ZZ[\varepsilon]\)</span> is the ring generated over
<span class="math notranslate nohighlight">\(\ZZ\)</span> by the image of <span class="math notranslate nohighlight">\(\varepsilon\)</span>. We illustrate
this with <span class="math notranslate nohighlight">\(N=k=5\)</span> below, where DirichletGroup will be
described later.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CuspForms</span><span class="p">(</span><span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="mf">.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + (-zeta4 - 1)*q^2 + (6*zeta4 - 6)*q^3 - ... + O(q^6)</span>
<span class="go">]</span>
</pre></div>
</div>
</section>
<section id="dirichlet-characters">
<h3>Dirichlet Characters<a class="headerlink" href="#dirichlet-characters" title="Permalink to this headline">¶</a></h3>
<p>Use the command DirichletGroup(N,R) to create the group of all
Dirichlet characters of modulus <span class="math notranslate nohighlight">\(N\)</span> taking values in the
ring <span class="math notranslate nohighlight">\(R\)</span>. If <span class="math notranslate nohighlight">\(R\)</span> is omitted, it defaults to a
cyclotomic field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Group of Dirichlet characters modulo 8 with values in Cyclotomic Field of order 2 and degree 1</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[Dirichlet character modulo 8 of conductor 1 mapping 7 |--&gt; 1, 5 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 4 mapping 7 |--&gt; -1, 5 |--&gt; 1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 8 mapping 7 |--&gt; 1, 5 |--&gt; -1,</span>
<span class="go">Dirichlet character modulo 8 of conductor 8 mapping 7 |--&gt; -1, 5 |--&gt; -1]</span>
<span class="gp">sage: </span><span class="n">eps</span> <span class="o">=</span> <span class="n">G</span><span class="mf">.0</span><span class="p">;</span> <span class="n">eps</span>
<span class="go">Dirichlet character modulo 8 of conductor 4 mapping 7 |--&gt; -1, 5 |--&gt; 1</span>
<span class="gp">sage: </span><span class="n">eps</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[0, 1, 0, -1, 0, 1, 0, -1]</span>
</pre></div>
</div>
<p>Sage both represents Dirichlet characters by giving a “matrix”,
i.e., the list of images of canonical generators of
<span class="math notranslate nohighlight">\((\ZZ/N\ZZ)^*\)</span>, and as vectors modulo an
integer <span class="math notranslate nohighlight">\(n\)</span>. For years, I was torn between these two
representations, until J. Quer and I realized that the best
approach is to use both and make it easy to convert between them.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">eps</span><span class="o">.</span><span class="n">element</span><span class="p">())</span>
<span class="go">Vector space of dimension 2 over Ring of integers modulo 2</span>
</pre></div>
</div>
<p>Given a Dirichlet character, Sage also lets you compute the
associated Jacobi and Gauss sums, generalized Bernoulli numbers,
the conductor, Galois orbit, etc.</p>
</section>
<section id="decomposing-m-k-gamma-1-n">
<h3>Decomposing <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span><a class="headerlink" href="#decomposing-m-k-gamma-1-n" title="Permalink to this headline">¶</a></h3>
<p>Recall that
Dirichlet characters give a decomposition</p>
<div class="math notranslate nohighlight">
\[M_k(\Gamma_1(N)) = \bigoplus_{\varepsilon:(\ZZ/N\ZZ)^* \to \CC^*} M_k(N,\varepsilon).\]</div>
<p>Given a Dirichlet character <span class="math notranslate nohighlight">\(\varepsilon\)</span> we type
ModularForms(eps, weight) to create the space of modular forms with
that character and a given integer weight. For example, we create
the space of forms of weight <span class="math notranslate nohighlight">\(5\)</span> with the character modulo
<span class="math notranslate nohighlight">\(8\)</span> above that is <span class="math notranslate nohighlight">\(-1\)</span> on <span class="math notranslate nohighlight">\(3\)</span> and
<span class="math notranslate nohighlight">\(1\)</span> on <span class="math notranslate nohighlight">\(5\)</span> as follows.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 6, character [-1, 1] and</span>
<span class="go">weight 5 over Rational Field</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">ModularForms</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span> <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="n">v</span><span class="p">])</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Modular Forms space of dimension 11 ...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exercise: Compute the dimensions of all spaces <span class="math notranslate nohighlight">\(M_2(37,\varepsilon)\)</span>
for all Dirichlet characters <span class="math notranslate nohighlight">\(\varepsilon\)</span>.</p>
</div>
</section>
<section id="hecke-operators">
<h3>Hecke Operators<a class="headerlink" href="#hecke-operators" title="Permalink to this headline">¶</a></h3>
<p>The space <span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span>
is equipped with an action of a commuting ring <span class="math notranslate nohighlight">\(\mathbb{T}\)</span> of
Hecke operators <span class="math notranslate nohighlight">\(T_n\)</span> for <span class="math notranslate nohighlight">\(n\geq 1\)</span>. A standard
computational problem in the theory of modular forms is to compute
an explicit basis of <span class="math notranslate nohighlight">\(q\)</span>-expansion for
<span class="math notranslate nohighlight">\(M_k(\Gamma)\)</span> along with matrices for the action of any
Hecke operator <span class="math notranslate nohighlight">\(T_n\)</span>, and to compute the subspace
<span class="math notranslate nohighlight">\(S_k(\Gamma)\)</span> of cusp forms.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">q + 3*q^3 - 6*q^4 - 7*q^5 + O(q^6),</span>
<span class="go">q^2 - 4*q^3 + 2*q^4 + 8*q^5 + O(q^6),</span>
<span class="go">1 + O(q^6),</span>
<span class="go">q + 9*q^2 + 28*q^3 + 73*q^4 + 126*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0 2 0 0]</span>
<span class="go">[1 2 0 0]</span>
<span class="go">[0 0 9 0]</span>
<span class="go">[0 0 0 9]</span>
</pre></div>
</div>
<p>We can also compute Hecke operators on the cuspidal subspace.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0 2]</span>
<span class="go">[1 2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[ 3 -8]</span>
<span class="go">[-4 -5]</span>
</pre></div>
</div>
</section>
<section id="hecke-operator-on-m-k-gamma-1-n">
<h3>Hecke Operator on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span><a class="headerlink" href="#hecke-operator-on-m-k-gamma-1-n" title="Permalink to this headline">¶</a></h3>
<p>At the time these lectures were first written, Sage didn’t yet implement
computation of the Hecke operators on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span>, but these have
subsequently been added:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">ModularForms</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Modular Forms space of dimension 3 for Congruence Subgroup</span>
<span class="go">Gamma1(5) of weight 2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ -21    0 -240]</span>
<span class="go">[  -2    0  -23]</span>
<span class="go">[   2    1   24]</span>
</pre></div>
</div>
<p>These are calculated by first calculating Hecke operators on modular symbols
for <span class="math notranslate nohighlight">\(\Gamma_1(N)\)</span>, which is a <span class="math notranslate nohighlight">\(\mathbb{T}\)</span>-module that is
isomorphic to <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span> (see <a class="reference internal" href="modular_symbols.html#sec-modsym"><span class="std std-ref">Modular Symbols</span></a>).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">hecke_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 2  1  1]</span>
<span class="go">[ 1  2 -1]</span>
<span class="go">[ 0  0 -1]</span>
</pre></div>
</div>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Modular Forms and Hecke Operators</a><ul>
<li><a class="reference internal" href="#congruence-subgroups">Congruence subgroups</a><ul>
<li><a class="reference internal" href="#definition">Definition</a></li>
<li><a class="reference internal" href="#generators">Generators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#modular-forms">Modular Forms</a><ul>
<li><a class="reference internal" href="#id1">Definition</a></li>
<li><a class="reference internal" href="#creation-in-sage">Creation in Sage</a></li>
<li><a class="reference internal" href="#dimension-formulas">Dimension Formulas</a></li>
<li><a class="reference internal" href="#diamond-bracket-operators">Diamond Bracket Operators</a></li>
<li><a class="reference internal" href="#dirichlet-characters">Dirichlet Characters</a></li>
<li><a class="reference internal" href="#decomposing-m-k-gamma-1-n">Decomposing <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span></a></li>
<li><a class="reference internal" href="#hecke-operators">Hecke Operators</a></li>
<li><a class="reference internal" href="#hecke-operator-on-m-k-gamma-1-n">Hecke Operator on <span class="math notranslate nohighlight">\(M_k(\Gamma_1(N))\)</span></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="modular_forms.html"
                          title="previous chapter">Modular Forms</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="modular_symbols.html"
                          title="next chapter">Modular Symbols</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/explicit_methods_in_number_theory/modular_forms_and_hecke_operators.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="modular_symbols.html" title="Modular Symbols"
             >next</a> |</li>
        <li class="right" >
          <a href="modular_forms.html" title="Modular Forms"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../index.html">Thematic Tutorials</a> &#187;
    
  </li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="modular_forms.html" >Modular Forms</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Modular Forms and Hecke Operators</a></li> 
      </ul>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
  </script>
  <script type="text/javascript">
/* detex the document title by removing "\(", "\)", "\", "$" */
document.title = document.title.replace(/\\\(/g, '').replace(/\\\)/g, '').replace(/\\/g, '').replace(/\$/g, '');
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>