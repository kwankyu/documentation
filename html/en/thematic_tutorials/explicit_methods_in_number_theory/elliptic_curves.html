
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Elliptic Curves &#8212; Thematic Tutorials v8.9</title>
    <link rel="stylesheet" href="../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Matrix of Frobenius on Hyperelliptic Curves" href="birds_other.html" />
    <link rel="prev" title="Integer Factorization" href="integer_factorization.html" />
    <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
    <script src="../_static/thebe.js" type="text/javascript"></script>
    <script src="../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="birds_other.html" title="The Matrix of Frobenius on Hyperelliptic Curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="integer_factorization.html" title="Integer Factorization"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v8.9</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="birds_eye_view.html" accesskey="U">A Bird’s Eye View</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="elliptic-curves">
<h1>Elliptic Curves<a class="headerlink" href="#elliptic-curves" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cremona-s-databases">
<h2>Cremona’s Databases<a class="headerlink" href="#cremona-s-databases" title="Permalink to this headline">¶</a></h2>
<p>Cremona’s databases of elliptic curves are part of Sage. The curves up
to conductor 10,000 come standard with Sage, and an there is an optional
download to gain access to his complete tables. From a shell, you
should run</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">sage -i database_cremona_ellcurve</span>
</pre></div>
</div>
<p>to automatically download and install the extended table.</p>
<p>To use the database, just create a curve by giving</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CremonaDatabase</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[</span><span class="mi">37</span><span class="p">][</span><span class="s1">&#39;allcurves&#39;</span><span class="p">]</span>
<span class="go">{&#39;a1&#39;: [[0, 0, 1, -1, 0], 1, 1],</span>
<span class="go">&#39;b1&#39;: [[0, 1, 1, -23, -50], 0, 3],</span>
<span class="go">&#39;b2&#39;: [[0, 1, 1, -1873, -31833], 0, 1],</span>
<span class="go">&#39;b3&#39;: [[0, 1, 1, -3, 1], 0, 3]}</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">(</span><span class="s1">&#39;37b&#39;</span><span class="p">)</span>
<span class="go">[Elliptic Curve defined by y^2 + y = x^3 + x^2 - 23*x - 50</span>
<span class="go">over Rational Field, ...]</span>
</pre></div>
</div>
<p>There is also a Stein-Watkins database that contains hundreds of
millions of elliptic curves. It’s over a 2GB download though!</p>
</div>
<div class="section" id="bryan-birch-s-birthday-card">
<h2>Bryan Birch’s Birthday Card<a class="headerlink" href="#bryan-birch-s-birthday-card" title="Permalink to this headline">¶</a></h2>
<p>Bryan Birch recently had a birthday conference, and I used Sage
to draw the cover of his birthday card by enumerating all optimal
elliptic curves of conductor up to 37, then plotting them with
thick randomly colored lines. As you can see below, plotting an
elliptic curve is as simple as calling the plot method on it. Also,
the graphics
array command allows us to easily combine numerous plots into a
single graphics object.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">cremona_optimal_curves</span><span class="p">([</span><span class="mf">11.</span><span class="o">.</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thickness</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="n">random</span><span class="p">(),</span><span class="n">random</span><span class="p">(),</span><span class="n">random</span><span class="p">()))</span> <span class="k">for</span> <span class="n">E</span> <span class="ow">in</span> <span class="n">v</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">graphics_array</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/birch.png" src="../_images/birch.png" />
</div>
<div class="section" id="plotting-modulo-p">
<h2>Plotting Modulo <span class="math notranslate nohighlight">\(p\)</span><a class="headerlink" href="#plotting-modulo-p" title="Permalink to this headline">¶</a></h2>
<p>We can use Sage’s interact feature to draw a plot of an elliptic
curve modulo <span class="math notranslate nohighlight">\(p\)</span>, with a slider that one drags to change
the prime <span class="math notranslate nohighlight">\(p\)</span>. The interact feature of Sage is very helpful
for interactively changing parameters and viewing the results. Type
interact? for more help and examples and visit the web page
<a class="reference external" href="http://wiki.sagemath.org/interact">http://wiki.sagemath.org/interact</a>.</p>
<p>In the code below we first define the elliptic curve <span class="math notranslate nohighlight">\(E\)</span>
using the Cremona label 37a. Then we define an interactive function
<span class="math notranslate nohighlight">\(f\)</span>, which is made interactive using the &#64;interact Python
decorator. Because the default for <span class="math notranslate nohighlight">\(p\)</span> is primes(2,500),
the Sage notebook constructs a slider that varies over the primes
up to <span class="math notranslate nohighlight">\(500\)</span>. When you drag the slider and let go, a plot is
drawn of the affine <span class="math notranslate nohighlight">\(\GF{p}\)</span> points on the curve
<span class="math notranslate nohighlight">\(E_{\GF{p}}\)</span>. Of course, one should never plot curves over
finite fields, which makes this even more fun.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">E = EllipticCurve(&#39;37a&#39;)</span>
<span class="go">@interact</span>
<span class="go">def f(p=primes(2,500)):</span>
<span class="go">    show(plot(E.change_ring(GF(p)),pointsize=30),</span>
<span class="go">    axes=False, frame=True, gridlines=&quot;automatic&quot;,</span>
<span class="go">    aspect_ratio=1, gridlinesstyle={&#39;rgbcolor&#39;:(0.7,0.7,0.7)})</span>
</pre></div>
</div>
<img alt="../_images/modpcurve.png" src="../_images/modpcurve.png" />
</div>
<div class="section" id="schoof-elkies-atkin-point-counting">
<h2>Schoof-Elkies-Atkin Point Counting<a class="headerlink" href="#schoof-elkies-atkin-point-counting" title="Permalink to this headline">¶</a></h2>
<p>Sage includes sea.gp, which is a fast implementation of the SEA
(Schoff-Elkies-Atkin) algorithm for counting the number of points on
an elliptic curve over <span class="math notranslate nohighlight">\(\GF{p}\)</span>.</p>
<p>We create the finite field <span class="math notranslate nohighlight">\(k=\GF{p}\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the
next prime after <span class="math notranslate nohighlight">\(10^{20}\)</span>. The next prime command uses Pari’s
nextprime function, but proves primality of the result (unlike Pari
which gives only the next probable prime after a number). Sage also
has a next probable prime function.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<p>compute its cardinality, which behind the scenes uses SEA.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="n">random_element</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>                   <span class="c1"># less than a second</span>
<span class="go">99999999999371984255</span>
</pre></div>
</div>
<p>To see how Sage chooses when to use SEA versus other methods, type
E.cardinality?? and read the source code. As of this writing, it
simply uses SEA whenever <span class="math notranslate nohighlight">\(p&gt;10^{18}\)</span>.</p>
</div>
<div class="section" id="p-adic-regulators">
<h2><span class="math notranslate nohighlight">\(p\)</span>-adic Regulators<a class="headerlink" href="#p-adic-regulators" title="Permalink to this headline">¶</a></h2>
<p>Sage has the world’s best code for computing <span class="math notranslate nohighlight">\(p\)</span>-adic regulators
of elliptic curves, thanks to work of David Harvey and Robert
Bradshaw. The <span class="math notranslate nohighlight">\(p\)</span>-adic regulator of an elliptic curve <span class="math notranslate nohighlight">\(E\)</span>
at a good ordinary prime <span class="math notranslate nohighlight">\(p\)</span> is the determinant of the global
<span class="math notranslate nohighlight">\(p\)</span>-adic height pairing matrix on the Mordell-Weil group
<span class="math notranslate nohighlight">\(E(\QQ)\)</span>. (This has nothing to do with local or
Archimedean heights.) This is the analogue of the regulator in the
Mazur-Tate-Teitelbaum <span class="math notranslate nohighlight">\(p\)</span>-adic analogue of the Birch and
Swinnerton-Dyer conjecture.</p>
<p>In particular, Sage implements Harvey’s improvement on an algorithm of
Mazur-Stein-Tate, which builds on Kiran Kedlaya’s Monsky-Washnitzer
approach to computing <span class="math notranslate nohighlight">\(p\)</span>-adic cohomology groups.</p>
<p>We create the elliptic curve with Cremona label 389a, which is the
curve of smallest conductor and rank <span class="math notranslate nohighlight">\(2\)</span>. We then compute both
the <span class="math notranslate nohighlight">\(5\)</span>-adic and <span class="math notranslate nohighlight">\(997\)</span>-adic regulators of this curve.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">5^2 + 2*5^3 + 2*5^4 + 4*5^5 + 3*5^6 + 4*5^7 + 3*5^8 + 5^9 + O(5^11)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">997</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">740*997^2 + 916*997^3 + 472*997^4 + 325*997^5 + 697*997^6</span>
<span class="go">          + 642*997^7 + 68*997^8 + 860*997^9 + 884*997^10 + O(997^11)</span>
</pre></div>
</div>
<p>Before the new algorithm mentioned above, even computing a
<span class="math notranslate nohighlight">\(7\)</span>-adic regulator to <span class="math notranslate nohighlight">\(3\)</span> digits of precision was a
nontrivial computational challenge. Now in Sage computing the
<span class="math notranslate nohighlight">\(100003\)</span>-adic regulator is routine:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">padic_regulator</span><span class="p">(</span><span class="mi">100003</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># a couple of seconds</span>
<span class="go">42582*100003^2 + 35250*100003^3 + 12790*100003^4 + 64078*100003^5 + O(100003^6)</span>
</pre></div>
</div>
</div>
<div class="section" id="p-adic-l-functions">
<h2><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions<a class="headerlink" href="#p-adic-l-functions" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions play a central role in the
arithmetic study of elliptic curves. They are <span class="math notranslate nohighlight">\(p\)</span>-adic analogues
of complex analytic <span class="math notranslate nohighlight">\(L\)</span>-function, and their leading coefficient
(at <span class="math notranslate nohighlight">\(0\)</span>) is the analogue of <span class="math notranslate nohighlight">\(L^{(r)}(E,1)/\Omega_E\)</span> in the
<span class="math notranslate nohighlight">\(p\)</span>-adic analogue of the Birch and Swinnerton-Dyer
conjecture. They also appear in theorems of Kato, Schneider, and
others that prove partial results toward <span class="math notranslate nohighlight">\(p\)</span>-adic BSD using
Iwasawa theory.</p>
<p>The implementation in Sage is mainly due to work of myself,
Christian Wuthrich, and Robert Pollack. We use Sage to compute the
<span class="math notranslate nohighlight">\(5\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-series of the elliptic curve 389a of
rank <span class="math notranslate nohighlight">\(2\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">5-adic L-series of Elliptic Curve defined</span>
<span class="go">by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">O(5^5) + O(5^2)*T + (4 + 4*5 + O(5^2))*T^2 +</span>
<span class="go">(2 + 4*5 + O(5^2))*T^3 + (3 + O(5^2))*T^4 + O(T^5)</span>
</pre></div>
</div>
</div>
<div class="section" id="bounding-shafarevich-tate-groups">
<h2>Bounding Shafarevich-Tate Groups<a class="headerlink" href="#bounding-shafarevich-tate-groups" title="Permalink to this headline">¶</a></h2>
<p>Sage implements
code to compute numerous explicit bounds on Shafarevich-Tate Groups
of elliptic curves. This functionality is only available in Sage,
and uses results Kolyvagin, Kato, Perrin-Riou, etc., and
unpublished papers of Wuthrich and me.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>            <span class="c1"># so only 2 could divide sha</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span>  <span class="c1"># so only 2 could divide sha</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<p>The <span class="math notranslate nohighlight">\((0,0)\)</span> in the last output above indicates that the Euler
systems results of Kolyvagin and Kato give no information about
finiteness of the Shafarevich-Tate group of the curve <span class="math notranslate nohighlight">\(E\)</span>. In
fact, it is an open problem to prove this finiteness, since <span class="math notranslate nohighlight">\(E\)</span>
has rank <span class="math notranslate nohighlight">\(2\)</span>, and finiteness is only known for elliptic curves
for which <span class="math notranslate nohighlight">\(L(E,1)\neq 0\)</span> or <span class="math notranslate nohighlight">\(L'(E,1)\neq 0\)</span>.</p>
<p>Partial results of Kato, Schneider and others on the <span class="math notranslate nohighlight">\(p\)</span>-adic
analogue of the BSD conjecture yield algorithms for bounding the
<span class="math notranslate nohighlight">\(p\)</span>-part of the Shafarevich-Tate group.  These algorithms
require as input explicit computation of <span class="math notranslate nohighlight">\(p\)</span>-adic
<span class="math notranslate nohighlight">\(L\)</span>-functions, <span class="math notranslate nohighlight">\(p\)</span>-adic regulators, etc., as explained in
Stein-Wuthrich. For example, below we use Sage to prove that <span class="math notranslate nohighlight">\(5\)</span>
and <span class="math notranslate nohighlight">\(7\)</span> do not divide the Shafarevich-Tate group of our rank
<span class="math notranslate nohighlight">\(2\)</span> curve 389a.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sha</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sha</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># iwasawa theory ==&gt; 5 doesn&#39;t divide sha</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">sha</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># iwasawa theory ==&gt; 7 doesn&#39;t divide sha</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This is consistent with the Birch and Swinnerton-Dyer conjecture,
which predicts that the Shafarevich-Tate group is trivial. Below we
compute this predicted order, which is the floating point number
<span class="math notranslate nohighlight">\(1.000000\)</span> to some precision. That the result is a floating
point number helps emphasize that it is an open problem to show that
the conjectural order of the Shafarevich-Tate group is even a rational
number in general!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<div class="section" id="mordell-weil-groups-and-integral-points">
<h2>Mordell-Weil Groups and Integral Points<a class="headerlink" href="#mordell-weil-groups-and-integral-points" title="Permalink to this headline">¶</a></h2>
<p>Sage includes both Cremona’s mwrank library and Simon’s 2-descent
GP scripts for computing Mordell-Weil groups of elliptic curves.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">159</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>       <span class="c1"># not in the Tables</span>
<span class="go">10272987</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>            <span class="c1"># a few seconds</span>
<span class="go">[(-3 : 9 : 1), (-3347/3249 : 1873597/185193 : 1)]</span>
</pre></div>
</div>
<p>Sage can also compute the torsion subgroup, isogeny class,
determine images of Galois representations, determine reduction
types, and includes a full implementation of Tate’s algorithm over
number fields.</p>
<p>Sage has the world’s fastest implementation of computation of all
integral points on an elliptic curve over <span class="math notranslate nohighlight">\(\QQ\)</span>, due
to work of Cremona, Michael Mardaus, and Tobias Nagel. This is also
the only free open source implementation available.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">17</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">integral_points</span><span class="p">(</span><span class="n">both_signs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(1 : -9 : 1), (1 : 3 : 1)]</span>
</pre></div>
</div>
<p>A very impressive example is the lowest conductor elliptic curve of
rank <span class="math notranslate nohighlight">\(3\)</span>, which has 36 integral points.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">elliptic_curves</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">integral_points</span><span class="p">(</span><span class="n">both_signs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># less than 3 seconds</span>
<span class="go">[(-3 : -1 : 1), (-3 : 0 : 1), (-2 : -4 : 1), (-2 : 3 : 1), ...(816 : -23310 : 1), (816 : 23309 : 1)]</span>
</pre></div>
</div>
<p>The algorithm to compute all integral points involves first
computing the Mordell-Weil group, then bounding the integral
points, and listing all integral points satisfying those bounds.
See Cohen’s new GTM 239 for complete details.</p>
<p>The complexity grows exponentially in the rank of the curve. We can
do the above calculation, but with the first known curve of rank
<span class="math notranslate nohighlight">\(4\)</span>, and it finishes in about a minute (and outputs 64
points).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">elliptic_curves</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">integral_points</span><span class="p">(</span><span class="n">both_signs</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># about a minute</span>
<span class="go">[(-10 : 3 : 1), (-10 : 7 : 1), ...</span>
<span class="go"> (19405 : -2712802 : 1), (19405 : 2693397 : 1)]</span>
</pre></div>
</div>
</div>
<div class="section" id="l-functions">
<h2><span class="math notranslate nohighlight">\(L\)</span>-functions<a class="headerlink" href="#l-functions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="evaluation">
<h3>Evaluation<a class="headerlink" href="#evaluation" title="Permalink to this headline">¶</a></h3>
<p>We next compute with the complex <span class="math notranslate nohighlight">\(L\)</span>-function</p>
<div class="math notranslate nohighlight">
\[L(E,s) = \prod_{p\mid \Delta=389} \frac{1}{1-a_p p^{-s} + p
p^{-2s}} \cdot \prod_{p\mid \Delta=389} \frac{1}{1-a_p p^{-s}}\]</div>
<p>of <span class="math notranslate nohighlight">\(E\)</span>. Though the above Euler product only defines an
analytic function on the right half plane where <span class="math notranslate nohighlight">\(\text{Re}(s) &gt;
3/2\)</span>, a deep theorem of Wiles et al. (the Modularity Theorem) implies
that it has an analytic continuation to the whole complex plane and
functional equation. We can evaluate the function <span class="math notranslate nohighlight">\(L\)</span> anywhere
on the complex plane using Sage (via code of Tim Dokchitser).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Complex L-series of the Elliptic Curve defined by</span>
<span class="go">       y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#random due to numerical noise</span>
<span class="go">-1.04124792770327e-19</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">)</span>
<span class="go">-0.638409938588039 + 0.715495239204667*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</div>
<div class="section" id="taylor-series">
<h3>Taylor Series<a class="headerlink" href="#taylor-series" title="Permalink to this headline">¶</a></h3>
<p>We can also compute the
Taylor series of <span class="math notranslate nohighlight">\(L\)</span> about any point, thanks to Tim
Dokchitser’s code.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lseries</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ld</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">dokchitser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ld</span><span class="o">.</span><span class="n">taylor_series</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#random due to numerical noise</span>
<span class="go">-1.28158145691931e-23 + (7.26268290635587e-24)*z + 0.759316500288427*z^2 - 0.430302337583362*z^3 + O(z^4)</span>
</pre></div>
</div>
</div>
<div class="section" id="grh">
<h3>GRH<a class="headerlink" href="#grh" title="Permalink to this headline">¶</a></h3>
<p>The Generalized Riemann Hypothesis asserts that all nontrivial zeros
of <span class="math notranslate nohighlight">\(L(E,s)\)</span> are of the form <span class="math notranslate nohighlight">\(1+iy\)</span>. Mike Rubinstein has
written a C++ program that is part of Sage that can for any <span class="math notranslate nohighlight">\(n\)</span>
compute the first <span class="math notranslate nohighlight">\(n\)</span> values of <span class="math notranslate nohighlight">\(y\)</span> such that <span class="math notranslate nohighlight">\(1+iy\)</span>
is a zero of <span class="math notranslate nohighlight">\(L(E,s)\)</span>. It also verifies the Riemann Hypothesis
for these zeros (I think). Rubinstein’s program can also do similar
computations for a wide class of <span class="math notranslate nohighlight">\(L\)</span>-functions, though not all
of this functionality is as easy to use from Sage as for elliptic
curves. Below we compute the first <span class="math notranslate nohighlight">\(10\)</span> zeros of <span class="math notranslate nohighlight">\(L(E,s)\)</span>,
where <span class="math notranslate nohighlight">\(E\)</span> is still the rank <span class="math notranslate nohighlight">\(2\)</span> curve 389a.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0.000000000, 0.000000000, 2.87609907, 4.41689608, 5.79340263,</span>
<span class="go"> 6.98596665, 7.47490750, 8.63320525, 9.63307880, 10.3514333]</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Elliptic Curves</a><ul>
<li><a class="reference internal" href="#cremona-s-databases">Cremona’s Databases</a></li>
<li><a class="reference internal" href="#bryan-birch-s-birthday-card">Bryan Birch’s Birthday Card</a></li>
<li><a class="reference internal" href="#plotting-modulo-p">Plotting Modulo <span class="math notranslate nohighlight">\(p\)</span></a></li>
<li><a class="reference internal" href="#schoof-elkies-atkin-point-counting">Schoof-Elkies-Atkin Point Counting</a></li>
<li><a class="reference internal" href="#p-adic-regulators"><span class="math notranslate nohighlight">\(p\)</span>-adic Regulators</a></li>
<li><a class="reference internal" href="#p-adic-l-functions"><span class="math notranslate nohighlight">\(p\)</span>-adic <span class="math notranslate nohighlight">\(L\)</span>-functions</a></li>
<li><a class="reference internal" href="#bounding-shafarevich-tate-groups">Bounding Shafarevich-Tate Groups</a></li>
<li><a class="reference internal" href="#mordell-weil-groups-and-integral-points">Mordell-Weil Groups and Integral Points</a></li>
<li><a class="reference internal" href="#l-functions"><span class="math notranslate nohighlight">\(L\)</span>-functions</a><ul>
<li><a class="reference internal" href="#evaluation">Evaluation</a></li>
<li><a class="reference internal" href="#taylor-series">Taylor Series</a></li>
<li><a class="reference internal" href="#grh">GRH</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="integer_factorization.html"
                        title="previous chapter">Integer Factorization</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="birds_other.html"
                        title="next chapter">The Matrix of Frobenius on Hyperelliptic Curves</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/explicit_methods_in_number_theory/elliptic_curves.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="birds_other.html" title="The Matrix of Frobenius on Hyperelliptic Curves"
             >next</a> |</li>
        <li class="right" >
          <a href="integer_factorization.html" title="Integer Factorization"
             >previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v8.9</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >Three Lectures about Explicit Methods in Number Theory Using Sage</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="birds_eye_view.html" >A Bird’s Eye View</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>