
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>The Weyl Character Ring &#8212; Thematic Tutorials v8.3</title>
    <link rel="stylesheet" href="../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Maximal Subgroups and Branching Rules" href="branching_rules.html" />
    <link rel="prev" title="Lie Group Basics" href="lie_basics.html" />
    <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
    <script src="../_static/thebe.js" type="text/javascript"></script>
    <script src="../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="branching_rules.html" title="Maximal Subgroups and Branching Rules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lie_basics.html" title="Lie Group Basics"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v8.3</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../lie.html" accesskey="U">Lie Methods and Related Combinatorics in Sage</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-weyl-character-ring">
<h1>The Weyl Character Ring<a class="headerlink" href="#the-weyl-character-ring" title="Permalink to this headline">¶</a></h1>
<div class="section" id="weyl-character-rings">
<h2>Weyl character rings<a class="headerlink" href="#weyl-character-rings" title="Permalink to this headline">¶</a></h2>
<p>The Weyl character ring is the representation ring of a compact Lie group. It
has a basis consisting of the irreducible representations of <span class="math notranslate nohighlight">\(G\)</span>, or
equivalently, their characters. The addition and multiplication in the Weyl
character ring correspond to direct sum and tensor product of representations.</p>
</div>
<div class="section" id="methods-of-the-ambient-space">
<h2>Methods of the ambient space<a class="headerlink" href="#methods-of-the-ambient-space" title="Permalink to this headline">¶</a></h2>
<p>In Sage, many useful features of the Lie group are available as
methods of the ambient space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="go">[(1, -1), (1, 1), (1, 0), (0, 1), (-1, 1), (-1, -1), (-1, 0), (0, -1)]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="go">Finite family {1: (1, 0), 2: (1/2, 1/2)}</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">positive_roots</span><span class="p">()</span>
<span class="go">[(1, -1), (1, 1), (1, 0), (0, 1)]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">weyl_group</span><span class="p">()</span>
<span class="go">Weyl Group of type [&#39;B&#39;, 2] (as a matrix group acting on the ambient space)</span>
</pre></div>
</div>
</div>
<div class="section" id="methods-of-the-weyl-character-ring">
<h2>Methods of the Weyl character ring<a class="headerlink" href="#methods-of-the-weyl-character-ring" title="Permalink to this headline">¶</a></h2>
<p>If you are going to work with representations, you may want to create
a <em>Weyl Character ring</em>. Many methods of the ambient space are
available as methods of the Weyl character ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="go">Finite family {1: (1, 0, 0), 2: (1, 1, 0), 3: (1/2, 1/2, 1/2)}</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1: (1, -1, 0), 2: (0, 1, -1), 3: (0, 0, 1)}</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">dynkin_diagram</span><span class="p">()</span>
<span class="go">O---O=&gt;=O</span>
<span class="go">1   2   3</span>
<span class="go">B3</span>
</pre></div>
</div>
<p>Other useful methods of the Weyl character ring include:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">cartan_type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">highest_root</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">positive_root</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">extended_dynkin_diagram</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">rank</span></code></li>
</ul>
<p>Some methods of the ambient space are not implemented as methods of
the Weyl character ring. However, the ambient space itself is a
method, and so you have access to its methods from the Weyl character
ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">space</span><span class="p">()</span><span class="o">.</span><span class="n">weyl_group</span><span class="p">()</span>
<span class="go">Weyl Group of type [&#39;B&#39;, 3] (as a matrix group acting on the ambient space)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">space</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 3]</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">space</span><span class="p">()</span><span class="o">.</span><span class="n">rho</span><span class="p">()</span>
<span class="go">(5/2, 3/2, 1/2)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;B&#39;, 3]</span>
</pre></div>
</div>
</div>
<div class="section" id="coroot-notation">
<h2>Coroot notation<a class="headerlink" href="#coroot-notation" title="Permalink to this headline">¶</a></h2>
<p>It is useful to give the Weyl character ring a name that corresponds
to its Cartan type. This has the effect that the ring can parse its
own output:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G2</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span> <span class="k">for</span> <span class="n">fw</span> <span class="ow">in</span> <span class="n">G2</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()]</span>
<span class="go">[G2(1,0,-1), G2(2,-1,-1)]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">G2(1,0,-1)</span>
</pre></div>
</div>
<p>Actually the prefix for the ring is configurable, so you don’t really
have to call this ring <code class="docutils literal notranslate"><span class="pre">G2</span></code>. Type <code class="docutils literal notranslate"><span class="pre">WeylCharacterRing?</span></code> at the
<code class="docutils literal notranslate"><span class="pre">sage:</span></code> prompt for details.</p>
<p>There is one important option that you may want to know about. This
is <em>coroot notation</em>. You select this by specifying the option
<code class="docutils literal notranslate"><span class="pre">style=&quot;coroots&quot;</span></code> when you create the ring. With the coroot style,
the fundamental weights are represented <code class="docutils literal notranslate"><span class="pre">(1,0,0,</span> <span class="pre">...)</span></code>,
<code class="docutils literal notranslate"><span class="pre">(0,1,0,...)</span></code> instead of as vectors in the ambient space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B3</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span> <span class="k">for</span> <span class="n">fw</span> <span class="ow">in</span> <span class="n">B3</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()]</span>
<span class="go">[B3(1,0,0), B3(0,1,0), B3(0,0,1)]</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">B3(0,0,1)</span>
<span class="gp">sage: </span><span class="n">B3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>The last representation is the eight dimensional spin representation
of <span class="math notranslate nohighlight">\(G = spin(7)\)</span>, the double cover of the orthogonal group <span class="math notranslate nohighlight">\(SO(7)\)</span>. In
the default notation it would be represented <code class="docutils literal notranslate"><span class="pre">B3(1/2,1/2,1/2)</span></code>.</p>
<p>With the coroot notation every irreducible representation is
represented <code class="docutils literal notranslate"><span class="pre">B3(a,b,c)</span></code> where <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code> and <code class="docutils literal notranslate"><span class="pre">c</span></code> are nonnegative
integers. This is often convenient. For many purposes the coroot style
is preferable.</p>
<p>One disadvantage: in the coroot style the Lie group or Lie algebra is
treated as semisimple, so you lose the distinction between <span class="math notranslate nohighlight">\(GL(n)\)</span> and
<span class="math notranslate nohighlight">\(SL(n)\)</span>; you also some information about representations of E6 and E7
for the same reason.</p>
</div>
<div class="section" id="tensor-products-of-representations">
<h2>Tensor products of representations<a class="headerlink" href="#tensor-products-of-representations" title="Permalink to this headline">¶</a></h2>
<p>The multiplication in the Weyl character ring corresponds to tensor
product. This gives us a convenient way of decomposing a tensor
product into irreducibles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fw</span> <span class="o">=</span> <span class="n">B3</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">spinweight</span> <span class="o">=</span> <span class="n">fw</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="n">spinweight</span>
<span class="go">(1/2, 1/2, 1/2)</span>
<span class="gp">sage: </span><span class="n">spin</span> <span class="o">=</span> <span class="n">B3</span><span class="p">(</span><span class="n">spinweight</span><span class="p">);</span> <span class="n">spin</span>
<span class="go">B3(1/2,1/2,1/2)</span>
<span class="gp">sage: </span><span class="n">spin</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
<p>The element <span class="math notranslate nohighlight">\(spin\)</span> of the WeylCharacterRing is the representation
corresponding to the third highest weight representation, the
eight-dimensional spin representation of <span class="math notranslate nohighlight">\(spin(7)\)</span>. We could
just as easily construct it with the commmand:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">spin</span> <span class="o">=</span> <span class="n">B3</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We may compute its tensor product with itself, using the
multiplicative structure of the Weyl character ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">chi</span> <span class="o">=</span> <span class="n">spin</span><span class="o">*</span><span class="n">spin</span><span class="p">;</span> <span class="n">chi</span>
<span class="go">B3(0,0,0) + B3(1,0,0) + B3(1,1,0) + B3(1,1,1)</span>
</pre></div>
</div>
<p>We have taken the eight-dimensional spin representation and tensored
with itself. We see that the tensor square splits into four
irreducibles, each with multiplicity one.</p>
<p>The highest weights that appear here are available (with their
coefficients) through the usual free module accessors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">chi</span><span class="p">)</span>                           <span class="c1"># random</span>
<span class="go">[((1, 1, 1), 1), ((0, 0, 0), 1), ((1, 0, 0), 1), ((1, 1, 0), 1)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">chi</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[((0, 0, 0), 1), ((1, 0, 0), 1), ((1, 1, 0), 1), ((1, 1, 1), 1)]</span>
<span class="gp">sage: </span><span class="n">pprint</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">chi</span><span class="p">))</span>
<span class="go">{(0, 0, 0): 1, (1, 0, 0): 1, (1, 1, 0): 1, (1, 1, 1): 1}</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">chi</span><span class="o">.</span><span class="n">monomials</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">support</span><span class="p">());</span> <span class="n">M</span>
<span class="go">[B3(0,0,0), B3(1,0,0), B3(1,1,0), B3(1,1,1)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">chi</span><span class="o">.</span><span class="n">support</span><span class="p">())</span>
<span class="go">[(0, 0, 0), (1, 0, 0), (1, 1, 0), (1, 1, 1)]</span>
<span class="gp">sage: </span><span class="n">chi</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">r</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
<span class="go">[1, 7, 21, 35]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">chi</span><span class="o">.</span><span class="n">monomials</span><span class="p">())</span>
<span class="go">64</span>
</pre></div>
</div>
<p>Here we have extracted the individual representations, computed
their degrees and checked that they sum up to <span class="math notranslate nohighlight">\(64\)</span>.</p>
</div>
<div class="section" id="weight-multiplicities">
<h2>Weight multiplicities<a class="headerlink" href="#weight-multiplicities" title="Permalink to this headline">¶</a></h2>
<p>The weights of the character are available (with their coefficients)
through the method <code class="docutils literal notranslate"><span class="pre">weight_multiplicities</span></code>. Continuing from the
example in the last section:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pprint</span><span class="p">(</span><span class="n">chi</span><span class="o">.</span><span class="n">weight_multiplicities</span><span class="p">())</span>
<span class="go">{(0, 0, 0): 8, (-1, 0, 0): 4, (-1, -1, 0): 2, (-1, -1, -1): 1,</span>
<span class="go"> (-1, -1, 1): 1, (-1, 1, 0): 2, (-1, 1, -1): 1, (-1, 1, 1): 1,</span>
<span class="go"> (-1, 0, -1): 2, (-1, 0, 1): 2, (1, 0, 0): 4, (1, -1, 0): 2,</span>
<span class="go"> (1, -1, -1): 1, (1, -1, 1): 1, (1, 1, 0): 2, (1, 1, -1): 1,</span>
<span class="go"> (1, 1, 1): 1, (1, 0, -1): 2, (1, 0, 1): 2, (0, -1, 0): 4,</span>
<span class="go"> (0, -1, -1): 2, (0, -1, 1): 2, (0, 1, 0): 4, (0, 1, -1): 2,</span>
<span class="go"> (0, 1, 1): 2, (0, 0, -1): 4, (0, 0, 1): 4}</span>
</pre></div>
</div>
<p>Each key of this dictionary is a weight, and its value is the
multiplicity of that weight in the character.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<p>Suppose that we wish to compute the integral</p>
<div class="math notranslate nohighlight">
\[\int_{U(n)} |tr(g)|^{2k}\,dg\]</div>
<p>for various <span class="math notranslate nohighlight">\(n\)</span>. Here <span class="math notranslate nohighlight">\(U(n)\)</span> is the unitary group, which is the maximal
compact subroup of <span class="math notranslate nohighlight">\(GL(n,\mathbb{C})\)</span>. The irreducible unitary representations
of <span class="math notranslate nohighlight">\(U(n)\)</span> may be regarded as the basis elements of the WeylCharacterRing of
type <span class="math notranslate nohighlight">\(A_r\)</span>, where <span class="math notranslate nohighlight">\(r=n-1\)</span> so we might work in that ring. The trace <span class="math notranslate nohighlight">\(tr(g)\)</span> is
then just the character of the standard representation. We may realize
it in the WeylCharacterRing by taking the first fundamental weight and
coercing it into the ring. For example, if <span class="math notranslate nohighlight">\(k=5\)</span> and <span class="math notranslate nohighlight">\(n=3\)</span> so <span class="math notranslate nohighlight">\(r=2\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fw</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">();</span> <span class="n">fw</span>
<span class="go">Finite family {1: (1, 0, 0), 2: (1, 1, 0)}</span>
<span class="gp">sage: </span><span class="n">tr</span> <span class="o">=</span> <span class="n">A2</span><span class="p">(</span><span class="n">fw</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">tr</span>
<span class="go">A2(1,0,0)</span>
</pre></div>
</div>
<p>We may compute the norm square the character <code class="docutils literal notranslate"><span class="pre">tr^5</span></code> by decomposing it into
irreducibles, and taking the sum of the squares of their multiplicities. By
Schur orthogonality, this gives the inner product of the <span class="math notranslate nohighlight">\(tr(g)^5\)</span> with
itself, that is, the integral of <span class="math notranslate nohighlight">\(|tr(g)|^{10}\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">d</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tr</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>
<span class="go">103</span>
</pre></div>
</div>
<p>So far we have been working with <span class="math notranslate nohighlight">\(n=3\)</span>. For general <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
<span class="go">....:     R = WeylCharacterRing([&#39;A&#39;,n-1])</span>
<span class="go">....:     tr = R(R.fundamental_weights()[1])</span>
<span class="go">....:     return sum(d^2 for d in (tr^k).coefficients())</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.</span><span class="o">.</span><span class="mi">7</span><span class="p">]]</span>
<span class="go">[42, 103, 119, 120, 120, 120]</span>
</pre></div>
</div>
<p>We see that the 10-th moment of <span class="math notranslate nohighlight">\(tr(g)\)</span> is just <span class="math notranslate nohighlight">\(5!\)</span> when <span class="math notranslate nohighlight">\(n\)</span> is sufficiently
large. What if we fix <span class="math notranslate nohighlight">\(n\)</span> and vary <span class="math notranslate nohighlight">\(k\)</span>?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]]</span>
<span class="go">[1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">catalan_number</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]]</span>
<span class="go">[1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796]</span>
</pre></div>
</div>
</div>
<div class="section" id="frobenius-schur-indicator">
<h2>Frobenius-Schur indicator<a class="headerlink" href="#frobenius-schur-indicator" title="Permalink to this headline">¶</a></h2>
<p>The Frobeinus-Schur indicator of an irreducible representation of a
compact Lie group <span class="math notranslate nohighlight">\(G\)</span> with character <span class="math notranslate nohighlight">\(\chi\)</span> is:</p>
<div class="math notranslate nohighlight">
\[\int_G\chi(g^2) \, dg\]</div>
<p>The Haar measure is normalized so that <span class="math notranslate nohighlight">\(vol(G) = 1\)</span>. The
Frobenius-Schur indicator equals <span class="math notranslate nohighlight">\(1\)</span> if the representation is real
(orthogonal), <span class="math notranslate nohighlight">\(-1\)</span> if it is quaternionic (symplectic) and <span class="math notranslate nohighlight">\(0\)</span> if it is
complex (not self-contragredient). This is a method of weight ring
elements corresponding to irreducible representations. Let us compute
the Frobenius-Schur indicators of the spin representations of some
odd spin groups:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">spinrepn</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
<span class="go">....:     R = WeylCharacterRing([&#39;B&#39;,r])</span>
<span class="go">....:     return R(R.fundamental_weights()[r])</span>
<span class="go">....:</span>
<span class="gp">sage: </span><span class="n">spinrepn</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">B3(1/2,1/2,1/2)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">4</span><span class="p">]:</span>
<span class="go">....:     print(&quot;{} {}&quot;.format(r, spinrepn(r).frobenius_schur_indicator()))</span>
<span class="go">1 -1</span>
<span class="go">2 -1</span>
<span class="go">3 1</span>
<span class="go">4 1</span>
</pre></div>
</div>
<p>Here we have defined a function that returns the spin representation
of the group <span class="math notranslate nohighlight">\(spin(2r+1)\)</span> with Cartan type <span class="math notranslate nohighlight">\(['B',r]\)</span>, then computed
the Frobenius-Schur indicators for a few values. From this experiment
we see that the spin representations of <span class="math notranslate nohighlight">\(spin(3)\)</span> and <span class="math notranslate nohighlight">\(spin(5)\)</span> are
symplectic, while those of <span class="math notranslate nohighlight">\(spin(7)\)</span> and <span class="math notranslate nohighlight">\(spin(9)\)</span> are orthogonal.</p>
</div>
<div class="section" id="symmetric-and-exterior-powers">
<h2>Symmetric and exterior powers<a class="headerlink" href="#symmetric-and-exterior-powers" title="Permalink to this headline">¶</a></h2>
<p>Sage can compute symmetric and exterior powers of a representation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B3</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">spin</span> <span class="o">=</span> <span class="n">B3</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">spin</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">spin</span><span class="o">.</span><span class="n">exterior_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">B3(1,0,0) + B3(0,1,0)</span>
<span class="gp">sage: </span><span class="n">spin</span><span class="o">.</span><span class="n">exterior_square</span><span class="p">()</span>
<span class="go">B3(1,0,0) + B3(0,1,0)</span>
<span class="gp">sage: </span><span class="n">spin</span><span class="o">.</span><span class="n">exterior_power</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">B3(0,0,1) + B3(1,0,1)</span>
<span class="gp">sage: </span><span class="n">spin</span><span class="o">.</span><span class="n">symmetric_power</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">B3(0,0,1) + B3(0,0,3) + B3(0,0,5)</span>
</pre></div>
</div>
<p>The <span class="math notranslate nohighlight">\(k\)</span>-th exterior square of a representation is zero if <span class="math notranslate nohighlight">\(k\)</span>
is greater than the degree of the representation. However the
<span class="math notranslate nohighlight">\(k\)</span>-th symmetric power is nonzero for all <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>The tensor square of any representation decomposes as the direct sum
of the symmetric and exterior squares:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C4</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;C4&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">chi</span> <span class="o">=</span> <span class="n">C4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">chi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">chi</span><span class="o">.</span><span class="n">symmetric_square</span><span class="p">()</span>
<span class="go">C4(2,0,0,0)</span>
<span class="gp">sage: </span><span class="n">chi</span><span class="o">.</span><span class="n">exterior_square</span><span class="p">()</span>
<span class="go">C4(0,0,0,0) + C4(0,1,0,0)</span>
<span class="gp">sage: </span><span class="n">chi</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">chi</span><span class="o">.</span><span class="n">symmetric_square</span><span class="p">()</span> <span class="o">+</span> <span class="n">chi</span><span class="o">.</span><span class="n">exterior_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Since in this example the exterior square contains the trivial
representation we expect the Frobenius-Schur indicator to be <span class="math notranslate nohighlight">\(-1\)</span>, and
indeed it is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">chi</span> <span class="o">=</span> <span class="n">C4</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">chi</span><span class="o">.</span><span class="n">frobenius_schur_indicator</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
<p>This is not surprising since this is the standard representation
of a symplectic group, which is symplectic <em>by definition</em>!</p>
</div>
<div class="section" id="weyl-dimension-formula">
<h2>Weyl dimension formula<a class="headerlink" href="#weyl-dimension-formula" title="Permalink to this headline">¶</a></h2>
<p>If the representation is truly large you will not be able to construct
it in the Weyl character ring, since internally it is represented by a
dictionary of its weights. If you want to know its degree, you can
still compute that since Sage implements the Weyl dimension
formula. The degree of the representation is implemented as a method
of its highest weight vector:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">L</span><span class="o">.</span><span class="n">weyl_dimension</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()]</span>
<span class="go">[3875, 147250, 6696000, 6899079264, 146325270, 2450240, 30380, 248]</span>
</pre></div>
</div>
<p>It is a fact that for any compact Lie group if <span class="math notranslate nohighlight">\(\rho\)</span> is the Weyl vector
(half the sum of the positive roots) then the degree of the irreducible
representation with highest weight <span class="math notranslate nohighlight">\(\rho\)</span> equals <span class="math notranslate nohighlight">\(2^N\)</span> where <span class="math notranslate nohighlight">\(N\)</span> is the number
of positive roots. Let us check this for <span class="math notranslate nohighlight">\(E_8\)</span>. In this case <span class="math notranslate nohighlight">\(N = 120\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">positive_roots</span><span class="p">())</span>
<span class="go">120</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">120</span>
<span class="go">1329227995784915872903807060280344576</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">weyl_dimension</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">rho</span><span class="p">())</span>
<span class="go">1329227995784915872903807060280344576</span>
</pre></div>
</div>
</div>
<div class="section" id="sl-versus-gl">
<span id="slvsgl"></span><h2>SL versus GL<a class="headerlink" href="#sl-versus-gl" title="Permalink to this headline">¶</a></h2>
<p>Sage takes the weight space for type <code class="docutils literal notranslate"><span class="pre">['A',r]</span></code> to be <span class="math notranslate nohighlight">\(r+1\)</span>
dimensional. As a by-product, if you create the Weyl character ring
with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you are effectively working with <span class="math notranslate nohighlight">\(GL(3)\)</span> instead of <span class="math notranslate nohighlight">\(SL(3)\)</span>. For
example, the determinant is the character <code class="docutils literal notranslate"><span class="pre">A2(1,1,1)</span></code>. However, as
we will explain later, you can work with <span class="math notranslate nohighlight">\(SL(3)\)</span> if you like, so long
as you are willing to work with fractional weights. On the other hand
if you create the Weyl character ring with the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you are working with <span class="math notranslate nohighlight">\(SL(3)\)</span>.</p>
<p>There are some advantages to this arrangement:</p>
<ul class="simple">
<li>The group <span class="math notranslate nohighlight">\(GL(r+1)\)</span> arises frequently in practice. For example, even
if you care mainly about semisimple groups, the group <span class="math notranslate nohighlight">\(GL(r+1)\)</span> may
arise as a Levi subgroup.</li>
<li>It avoids fractional weights. If you want to work with <span class="math notranslate nohighlight">\(SL(3)\)</span> the
fundamental weights are <code class="docutils literal notranslate"><span class="pre">(2/3,-1/3,-1/3)</span></code> and
<code class="docutils literal notranslate"><span class="pre">(1/3,1/3,-2/3)</span></code>. If you work instead with <span class="math notranslate nohighlight">\(GL(3)\)</span>, they are
<code class="docutils literal notranslate"><span class="pre">(1,0,0)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1,1,0)</span></code>. For many mathematical purposes it
doesn’t make any difference which you use. This is because the
difference between <code class="docutils literal notranslate"><span class="pre">(2/3,-1/3,-1/3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1,0,0)</span></code> is a vector
that is orthogonal to all the simple roots. Thus these vectors are
interchangeable. But for convenience avoiding fractional weights is
advantageous.</li>
</ul>
<p>However if you want to be an <span class="math notranslate nohighlight">\(SL\)</span> purist, Sage will support you. The
weight space for <span class="math notranslate nohighlight">\(SL(3)\)</span> can be taken to be the hyperplane in
<span class="math notranslate nohighlight">\(\mathbf{Q}^3\)</span> consisting of vectors <span class="math notranslate nohighlight">\((a,b,c)\)</span> with
<span class="math notranslate nohighlight">\(a+b+c = 0\)</span>. The fundamental weights for SL(3) are then
<code class="docutils literal notranslate"><span class="pre">(2/3,-1/3,-1/3)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1/3,1/3,-2/3)</span></code>, though Sage will tell you
they are <code class="docutils literal notranslate"><span class="pre">(1,0,0)</span></code> and <code class="docutils literal notranslate"><span class="pre">(1,1,0)</span></code>. The work-around is to filter
them through the method <code class="docutils literal notranslate"><span class="pre">coerce_to_sl</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">fw1</span><span class="p">,</span><span class="n">fw2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span><span class="o">.</span><span class="n">coerce_to_sl</span><span class="p">()</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">A2</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">standard</span><span class="p">,</span> <span class="n">contragredient</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">A2</span><span class="p">(</span><span class="n">fw1</span><span class="p">),</span> <span class="n">A2</span><span class="p">(</span><span class="n">fw2</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">standard</span><span class="p">,</span> <span class="n">contragredient</span>
<span class="go">(A2(2/3,-1/3,-1/3), A2(1/3,1/3,-2/3))</span>
<span class="gp">sage: </span><span class="n">standard</span><span class="o">*</span><span class="n">contragredient</span>
<span class="go">A2(0,0,0) + A2(1,0,-1)</span>
</pre></div>
</div>
<p>Sage is not confused by the fractional weights. Note that if you use
coroot notation, you are working with <span class="math notranslate nohighlight">\(SL\)</span> automatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">weight_multiplicities</span><span class="p">()</span>
<span class="go">{(-1/3, -1/3, 2/3): 1, (-1/3, 2/3, -1/3): 1, (2/3, -1/3, -1/3): 1}</span>
</pre></div>
</div>
<p>There is no convenient way to create the determinant in the Weyl
character ring if you adopt the coroot style.</p>
<p>Just as we coerced the fundamental weights into the <span class="math notranslate nohighlight">\(SL\)</span> weight
lattice, you may need to coerce the Weyl vector <span class="math notranslate nohighlight">\(\rho\)</span> if you are
working with <span class="math notranslate nohighlight">\(SL\)</span>. The default value for <span class="math notranslate nohighlight">\(\rho\)</span> in type <span class="math notranslate nohighlight">\(A_r\)</span> is
<span class="math notranslate nohighlight">\((r,r-1,\dots,0)\)</span>, but if you are an <span class="math notranslate nohighlight">\(SL\)</span> purist you want</p>
<div class="math notranslate nohighlight">
\[\left(\frac{r}{2}, \frac{r}{2}-1,\dots,-\frac{r}{2}\right).\]</div>
<p>Therefore take the value of <span class="math notranslate nohighlight">\(\rho\)</span> that you get from the method of the
ambient space and coerce it into <span class="math notranslate nohighlight">\(SL\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">space</span><span class="p">()</span><span class="o">.</span><span class="n">rho</span><span class="p">()</span><span class="o">.</span><span class="n">coerce_to_sl</span><span class="p">();</span> <span class="n">rho</span>
<span class="go">(1, 0, -1)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">space</span><span class="p">()</span><span class="o">.</span><span class="n">positive_roots</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>You do not need to do this for other Cartan types. If you are working
with (say) <span class="math notranslate nohighlight">\(F4\)</span> then a <span class="math notranslate nohighlight">\(\rho\)</span> is a <span class="math notranslate nohighlight">\(\rho\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F4</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;F4&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">F4</span><span class="o">.</span><span class="n">space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">rho</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">positive_roots</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="integration">
<h2>Integration<a class="headerlink" href="#integration" title="Permalink to this headline">¶</a></h2>
<p>Suppose that we wish to compute the integral</p>
<div class="math notranslate nohighlight">
\[\int_{U(n)} |tr(g)|^{2k}\,dg\]</div>
<p>for various <span class="math notranslate nohighlight">\(n\)</span>. Here <span class="math notranslate nohighlight">\(U(n)\)</span> is the unitary group, which is the maximal
compact subroup of <span class="math notranslate nohighlight">\(GL(n,\mathbf{C})\)</span>, and <span class="math notranslate nohighlight">\(dg\)</span> is the Haar measure on
<span class="math notranslate nohighlight">\(U(n)\)</span>, normalized so that the volume of the group is 1.</p>
<p>The irreducible unitary representations of <span class="math notranslate nohighlight">\(U(n)\)</span> may be regarded as the basis
elements of the WeylCharacterRing of type <span class="math notranslate nohighlight">\(A_r\)</span>, where <span class="math notranslate nohighlight">\(r=n-1\)</span> so we might
work in that ring. The trace <span class="math notranslate nohighlight">\(tr(g)\)</span> is then just the character of the
standard representation. We may realize it in the WeylCharacterRing by taking
the first fundamental weight and coercing it into the ring. For example, if
<span class="math notranslate nohighlight">\(k=5\)</span> and <span class="math notranslate nohighlight">\(n=3\)</span> so <span class="math notranslate nohighlight">\(r=2\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fw</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">();</span> <span class="n">fw</span>
<span class="go">Finite family {1: (1, 0, 0), 2: (1, 1, 0)}</span>
<span class="gp">sage: </span><span class="n">tr</span> <span class="o">=</span> <span class="n">A2</span><span class="p">(</span><span class="n">fw</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">tr</span>
<span class="go">A2(1,0,0)</span>
</pre></div>
</div>
<p>We may compute the norm square the character <code class="docutils literal notranslate"><span class="pre">tr^5</span></code> by decomposing it into
irreducibles, and taking the sum of the squares of their multiplicities. By
Schur orthogonality, this gives the inner product of the <span class="math notranslate nohighlight">\(tr(g)^5\)</span> with
itself, that is, the integral of <span class="math notranslate nohighlight">\(|tr(g)|^{10}\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">tr</span><span class="o">^</span><span class="mi">5</span>
<span class="go">5*A2(2,2,1) + 6*A2(3,1,1) + 5*A2(3,2,0) + 4*A2(4,1,0) + A2(5,0,0)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">((</span><span class="n">tr</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">monomials</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">support</span><span class="p">())</span>
<span class="go">[A2(2,2,1), A2(3,1,1), A2(3,2,0), A2(4,1,0), A2(5,0,0)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">((</span><span class="n">tr</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>
<span class="go">[1, 4, 5, 5, 6]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tr</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>
<span class="go">103</span>
</pre></div>
</div>
<p>So far we have been working with <span class="math notranslate nohighlight">\(n=3\)</span>. For general <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
<span class="go">....:    R = WeylCharacterRing([&#39;A&#39;,n-1])</span>
<span class="go">....:    tr = R(R.fundamental_weights()[1])</span>
<span class="go">....:    return sum(x^2 for x in (tr^k).coefficients())</span>
<span class="go">....:</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">2.</span><span class="o">.</span><span class="mi">7</span><span class="p">]]</span>  <span class="c1"># long time (31s on sage.math, 2012)</span>
<span class="go">[42, 103, 119, 120, 120, 120]</span>
</pre></div>
</div>
<p>We see that the 10-th moment of <span class="math notranslate nohighlight">\(tr(g)\)</span> is just <span class="math notranslate nohighlight">\(5!\)</span> when <span class="math notranslate nohighlight">\(n\)</span> is sufficiently
large. What if we fix <span class="math notranslate nohighlight">\(n\)</span> and vary <span class="math notranslate nohighlight">\(k\)</span>?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]]</span>
<span class="go">[1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">catalan_number</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]]</span>
<span class="go">[1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796]</span>
</pre></div>
</div>
</div>
<div class="section" id="invariants-and-multiplicities">
<h2>Invariants and multiplicities<a class="headerlink" href="#invariants-and-multiplicities" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we are only interested in the multiplicity of the trivial
representation in some character. This may be found by the method
<code class="docutils literal notranslate"><span class="pre">invariant_degree</span></code>. Continuing from the preceding example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">WeylCharacterRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;coroots&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ad</span> <span class="o">=</span> <span class="n">A2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">ad</span><span class="o">.</span><span class="n">symmetric_power</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">invariant_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">6</span><span class="p">]]</span>
<span class="go">[1, 0, 1, 1, 1, 1, 2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">ad</span><span class="o">.</span><span class="n">exterior_power</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">invariant_degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">6</span><span class="p">]]</span>
<span class="go">[1, 0, 0, 1, 0, 1, 0]</span>
</pre></div>
</div>
<p>If we want the multiplicity of some other representation, we may
obtain that using the method <code class="docutils literal notranslate"><span class="pre">multiplicity</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">ad</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicity</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Weyl Character Ring</a><ul>
<li><a class="reference internal" href="#weyl-character-rings">Weyl character rings</a></li>
<li><a class="reference internal" href="#methods-of-the-ambient-space">Methods of the ambient space</a></li>
<li><a class="reference internal" href="#methods-of-the-weyl-character-ring">Methods of the Weyl character ring</a></li>
<li><a class="reference internal" href="#coroot-notation">Coroot notation</a></li>
<li><a class="reference internal" href="#tensor-products-of-representations">Tensor products of representations</a></li>
<li><a class="reference internal" href="#weight-multiplicities">Weight multiplicities</a></li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#frobenius-schur-indicator">Frobenius-Schur indicator</a></li>
<li><a class="reference internal" href="#symmetric-and-exterior-powers">Symmetric and exterior powers</a></li>
<li><a class="reference internal" href="#weyl-dimension-formula">Weyl dimension formula</a></li>
<li><a class="reference internal" href="#sl-versus-gl">SL versus GL</a></li>
<li><a class="reference internal" href="#integration">Integration</a></li>
<li><a class="reference internal" href="#invariants-and-multiplicities">Invariants and multiplicities</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="lie_basics.html"
                        title="previous chapter">Lie Group Basics</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="branching_rules.html"
                        title="next chapter">Maximal Subgroups and Branching Rules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/lie/weyl_character_ring.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="branching_rules.html" title="Maximal Subgroups and Branching Rules"
             >next</a> |</li>
        <li class="right" >
          <a href="lie_basics.html" title="Lie Group Basics"
             >previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v8.3</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../lie.html" >Lie Methods and Related Combinatorics in Sage</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>