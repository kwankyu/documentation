
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>Vector calculus in the Euclidean plane &#8212; Thematic Tutorials v9.3</title>
    <link rel="stylesheet" href="../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Programming (Mixed Integer)" href="../linear_programming.html" />
    <link rel="prev" title="Advanced aspects: the Euclidean space as a Riemannian manifold" href="vector_calc_advanced.html" />
    <link rel="icon" href="../_static/sageicon.png" type="image/x-icon" />
    <script src="../_static/thebe.js" type="text/javascript"></script>
    <script src="../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../linear_programming.html" title="Linear Programming (Mixed Integer)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="vector_calc_advanced.html" title="Advanced aspects: the Euclidean space as a Riemannian manifold"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.3</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../vector_calculus.html" accesskey="U">Tutorial: Vector Calculus in Euclidean Spaces</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Vector calculus in the Euclidean plane</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="vector-calculus-in-the-euclidean-plane">
<h1>Vector calculus in the Euclidean plane<a class="headerlink" href="#vector-calculus-in-the-euclidean-plane" title="Permalink to this headline">¶</a></h1>
<p>This tutorial introduces some vector calculus capabilities of SageMath in the
framework of the 2-dimensional Euclidean space. The corresponding tools have
been developed via the <a class="reference external" href="https://sagemanifolds.obspm.fr">SageManifolds</a>
project.</p>
<p>The tutorial is also available as a Jupyter notebook, either
<a class="reference external" href="https://nbviewer.jupyter.org/github/sagemanifolds/SageManifolds/blob/master/Notebooks/VectorCalculus/vector_calc_plane.ipynb">passive</a> (<code class="docutils literal notranslate"><span class="pre">nbviewer</span></code>)
or <a class="reference external" href="https://mybinder.org/v2/gh/sagemanifolds/SageManifolds/master?filepath=Notebooks/VectorCalculus/vector_calc_plane.ipynb">interactive</a> (<code class="docutils literal notranslate"><span class="pre">binder</span></code>).</p>
<div class="section" id="defining-the-euclidean-plane">
<h2>1. Defining the Euclidean plane<a class="headerlink" href="#defining-the-euclidean-plane" title="Permalink to this headline">¶</a></h2>
<p>We define the Euclidean plane <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> as a 2-dimensional Euclidean
space, with Cartesian coordinates <span class="math notranslate nohighlight">\((x,y)\)</span>, via the function
<a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/differentiable/examples/euclidean.html#sage.manifolds.differentiable.examples.euclidean.EuclideanSpace" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">EuclideanSpace</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EuclideanSpace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Euclidean plane E^2</span>
</pre></div>
</div>
<p>Thanks to the use of <code class="docutils literal notranslate"><span class="pre">&lt;x,y&gt;</span></code> in the above command, the Python variables
<code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> are assigned to the symbolic variables <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> describing
the Cartesian coordinates (there is no need to declare them via <a class="reference external" href="../../reference/calculus/sage/calculus/var.html#sage.calculus.var.var" title="(in Sage 9.3 Reference Manual: Symbolic Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">var()</span></code></a>,
i.e. to type <code class="docutils literal notranslate"><span class="pre">x,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">var('x</span> <span class="pre">y')</span></code>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>Instead of using the variables <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, one may also access to the
coordinates by their indices in the chart of Cartesian coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cartesian</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">cartesian_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cartesian</span>
<span class="go">Chart (E^2, (x, y))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cartesian</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">cartesian</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">y</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="ow">is</span> <span class="n">cartesian</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Each of the Cartesian coordinates spans the entire real line:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cartesian</span><span class="o">.</span><span class="n">coord_range</span><span class="p">()</span>
<span class="go">x: (-oo, +oo); y: (-oo, +oo)</span>
</pre></div>
</div>
</div>
<div class="section" id="vector-fields">
<h2>2. Vector fields<a class="headerlink" href="#vector-fields" title="Permalink to this headline">¶</a></h2>
<p>The Euclidean plane <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> is canonically endowed with the vector
frame associated with Cartesian coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">default_frame</span><span class="p">()</span>
<span class="go">Coordinate frame (E^2, (e_x,e_y))</span>
</pre></div>
</div>
<p>Vector fields on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> are then defined from their components in that
frame:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = -y e_x + x e_y</span>
</pre></div>
</div>
<p>The access to individual components is performed by the square bracket
operator:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">-y</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[:]</span>
<span class="go">[-y, x]</span>
</pre></div>
</div>
<p>A plot of the vector field <span class="math notranslate nohighlight">\(v\)</span> (this is with the default parameters, see the
documentation of
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/vectorfield.html#sage.manifolds.differentiable.vectorfield.VectorField.plot" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a> for the
various options):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 80 graphics primitives</span>
</pre></div>
</div>
<div class="figure align-default">
<img alt="../_images/vector_calc_plane-1.svg" src="../_images/vector_calc_plane-1.svg" /></div>
<p>One may also define a vector field by setting the components in a second
stage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;w_x&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;w_y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">w = w_x(x, y) e_x + w_y(x, y) e_y</span>
</pre></div>
</div>
<p>Note that in the above example the components of <span class="math notranslate nohighlight">\(w\)</span> are unspecified functions
of <span class="math notranslate nohighlight">\((x,y)\)</span>, contrary to the components of <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>Standard linear algebra operations can be performed on vector fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">v</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">w</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x*w_x(x, y) - 2*y) e_x + (x*w_y(x, y) + 2*x) e_y</span>
</pre></div>
</div>
<div class="section" id="scalar-product-and-norm">
<h3>Scalar product and norm<a class="headerlink" href="#scalar-product-and-norm" title="Permalink to this headline">¶</a></h3>
<p>The dot (or scalar) product <span class="math notranslate nohighlight">\(u\cdot v\)</span> of the vector fields <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> is
obtained by the operator
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/vectorfield.html#sage.manifolds.differentiable.vectorfield.VectorField.dot_product" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dot_product()</span></code></a>; it
gives rise to a scalar field on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">dot_product</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span>
<span class="go">Scalar field v.w on the Euclidean plane E^2</span>
</pre></div>
</div>
<p>A shortcut alias of
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/vectorfield.html#sage.manifolds.differentiable.vectorfield.VectorField.dot_product" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dot_product()</span></code></a> is
<code class="docutils literal notranslate"><span class="pre">dot</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v.w: E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; -y*w_x(x, y) + x*w_y(x, y)</span>
</pre></div>
</div>
<p>The symbolic expression representing the scalar field <span class="math notranslate nohighlight">\(v\cdot w\)</span> is obtained
by means of the method <a class="reference external" href="../../reference/manifolds/sage/manifolds/scalarfield.html#sage.manifolds.scalarfield.ScalarField.expr" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">-y*w_x(x, y) + x*w_y(x, y)</span>
</pre></div>
</div>
<p>The Euclidean norm of the vector field <span class="math notranslate nohighlight">\(v\)</span> is a scalar field on
<span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">|v|: E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; sqrt(x^2 + y^2)</span>
</pre></div>
</div>
<p>Again, the corresponding symbolic expression is obtained via
<a class="reference external" href="../../reference/manifolds/sage/manifolds/scalarfield.html#sage.manifolds.scalarfield.ScalarField.expr" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">sqrt(x^2 + y^2)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">sqrt(w_x(x, y)^2 + w_y(x, y)^2)</span>
</pre></div>
</div>
<p>We have of course <span class="math notranslate nohighlight">\(\|v\|^2 = v\cdot v\)</span></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="values-at-a-given-point">
<h3>Values at a given point<a class="headerlink" href="#values-at-a-given-point" title="Permalink to this headline">¶</a></h3>
<p>We introduce a point <span class="math notranslate nohighlight">\(p\in \mathbb{E}^2\)</span> via the generic SageMath syntax for
creating an element from its parent (here <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>), i.e. the call
operator <code class="docutils literal notranslate"><span class="pre">()</span></code>, with the Cartesian coordinates of the point as the first
argument:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">Point p on the Euclidean plane E^2</span>
</pre></div>
</div>
<p>The coordinates of <span class="math notranslate nohighlight">\(p\)</span> are returned by the method
<a class="reference external" href="../../reference/manifolds/sage/manifolds/point.html#sage.manifolds.point.ManifoldPoint.coord" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coord()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">coord</span><span class="p">()</span>
<span class="go">(-2, 3)</span>
</pre></div>
</div>
<p>or by letting the chart <code class="docutils literal notranslate"><span class="pre">cartesian</span></code> act on the point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cartesian</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">(-2, 3)</span>
</pre></div>
</div>
<p>The value of the scalar field <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">norm(v)</span></code> at <span class="math notranslate nohighlight">\(p\)</span> is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="go">sqrt(13)</span>
</pre></div>
</div>
<p>The value of a vector field at <span class="math notranslate nohighlight">\(p\)</span> is obtained by the method
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/tensorfield_paral.html#sage.manifolds.differentiable.tensorfield_paral.TensorFieldParal.at" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">at()</span></code></a>
(since the call operator <code class="docutils literal notranslate"><span class="pre">()</span></code> is reserved for the action on scalar fields,
see <a class="reference internal" href="#vector-fields-as-derivations-plane"><span class="std std-ref">Vector fields as derivations</span></a> below):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">vp</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">vp</span>
<span class="go">Vector v at Point p on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">vp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = -3 e_x - 2 e_y</span>
<span class="gp">sage: </span><span class="n">wp</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">wp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">w = w_x(-2, 3) e_x + w_y(-2, 3) e_y</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span> <span class="n">pi</span><span class="o">*</span><span class="n">w</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(pi*w_x(-2, 3) - 3) e_x + (pi*w_y(-2, 3) - 2) e_y</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="differential-operators">
<h2>3. Differential operators<a class="headerlink" href="#differential-operators" title="Permalink to this headline">¶</a></h2>
<p>The standard operators <span class="math notranslate nohighlight">\(\mathrm{grad}\)</span>, <span class="math notranslate nohighlight">\(\mathrm{div}\)</span>, etc. involved in
vector calculus are accessible as methods on scalar fields and vector fields
(e.g. <code class="docutils literal notranslate"><span class="pre">v.div()</span></code>). However, to use standard mathematical notations (e.g.
<code class="docutils literal notranslate"><span class="pre">div(v)</span></code>), let us import the functions
<a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.grad" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">grad()</span></code></a>, <a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.div" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">div()</span></code></a>,
and <a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.laplacian" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">laplacian()</span></code></a> in the global namespace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.manifolds.operators</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="section" id="divergence">
<h3>Divergence<a class="headerlink" href="#divergence" title="Permalink to this headline">¶</a></h3>
<p>The divergence of a vector field is returned by the function
<a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.div" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">div()</span></code></a>; the output is a scalar field on
<span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">Scalar field div(v) on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">div(v): E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; 0</span>
</pre></div>
</div>
<p>In the present case, <span class="math notranslate nohighlight">\(\mathrm{div}\, v\)</span> vanishes identically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>On the contrary, the divergence of <span class="math notranslate nohighlight">\(w\)</span> is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">div(w): E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; d(w_x)/dx + d(w_y)/dy</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">diff(w_x(x, y), x) + diff(w_y(x, y), y)</span>
</pre></div>
</div>
</div>
<div class="section" id="gradient">
<h3>Gradient<a class="headerlink" href="#gradient" title="Permalink to this headline">¶</a></h3>
<p>The gradient of a scalar field, e.g. <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">norm(v)</span></code>, is returned by the
function <a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.grad" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">grad()</span></code></a>; the output is a vector field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">Vector field grad(|v|) on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">grad(|v|) = x/sqrt(x^2 + y^2) e_x + y/sqrt(x^2 + y^2) e_y</span>
<span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">y/sqrt(x^2 + y^2)</span>
</pre></div>
</div>
<p>For a generic scalar field, like:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>we have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">grad(F) = d(f)/dx e_x + d(f)/dy e_y</span>
<span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">)[:]</span>
<span class="go">[d(f)/dx, d(f)/dy]</span>
</pre></div>
</div>
<p>Of course, we may combine <a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.grad" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">grad()</span></code></a> and
<a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.div" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">div()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">div</span><span class="p">(</span><span class="n">w</span><span class="p">))</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">grad(div(w)) = (d^2(w_x)/dx^2 + d^2(w_y)/dxdy) e_x + (d^2(w_x)/dxdy + d^2(w_y)/dy^2) e_y</span>
</pre></div>
</div>
</div>
<div class="section" id="laplace-operator">
<h3>Laplace operator<a class="headerlink" href="#laplace-operator" title="Permalink to this headline">¶</a></h3>
<p>The Laplace operator <span class="math notranslate nohighlight">\(\Delta\)</span> is obtained by the function
<a class="reference external" href="../../reference/euclidean_spaces/sage/manifolds/operators.html#sage.manifolds.operators.laplacian" title="(in Sage 9.3 Reference Manual: Euclidean Spaces and Vector Calculus v9.3)"><code class="xref py py-func docutils literal notranslate"><span class="pre">laplacian()</span></code></a>; it acts on scalar fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplacian</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">Delta(F): E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; d^2(f)/dx^2 + d^2(f)/dy^2</span>
</pre></div>
</div>
<p>as well as on vector fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplacian</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">Delta(w) = (d^2(w_x)/dx^2 + d^2(w_x)/dy^2) e_x + (d^2(w_y)/dx^2 + d^2(w_y)/dy^2) e_y</span>
</pre></div>
</div>
<p>For a scalar field, we have the identity</p>
<div class="math notranslate nohighlight">
\[\Delta F = \mathrm{div}\left(\mathrm{grad}\, F\right),\]</div>
<p>as we can check:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplacian</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">div</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="polar-coordinates">
<h2>4. Polar coordinates<a class="headerlink" href="#polar-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Polar coordinates <span class="math notranslate nohighlight">\((r,\phi)\)</span> are introduced on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> by:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polar</span><span class="o">.&lt;</span><span class="n">r</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">polar_coordinates</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">polar</span>
<span class="go">Chart (E^2, (r, ph))</span>
<span class="gp">sage: </span><span class="n">polar</span><span class="o">.</span><span class="n">coord_range</span><span class="p">()</span>
<span class="go">r: (0, +oo); ph: [0, 2*pi] (periodic)</span>
</pre></div>
</div>
<p>They are related to Cartesian coordinates by the following transformations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">coord_change</span><span class="p">(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cartesian</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">x = r*cos(ph)</span>
<span class="go">y = r*sin(ph)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">coord_change</span><span class="p">(</span><span class="n">cartesian</span><span class="p">,</span> <span class="n">polar</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">r = sqrt(x^2 + y^2)</span>
<span class="go">ph = arctan2(y, x)</span>
</pre></div>
</div>
<p>The orthonormal vector frame <span class="math notranslate nohighlight">\((e_r, e_\phi)\)</span> associated with polar coordinates
is returned by the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">polar_frame()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polar_frame</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">polar_frame</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">polar_frame</span>
<span class="go">Vector frame (E^2, (e_r,e_ph))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">er</span> <span class="o">=</span> <span class="n">polar_frame</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">er</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">e_r = x/sqrt(x^2 + y^2) e_x + y/sqrt(x^2 + y^2) e_y</span>
</pre></div>
</div>
<p>The above display is in the default frame (Cartesian frame) with the default
coordinates (Cartesian). Let us ask for the display in the same frame, but
with the components expressed in polar coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">er</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">cartesian</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">e_r = cos(ph) e_x + sin(ph) e_y</span>
</pre></div>
</div>
<p>Similarly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">eph</span> <span class="o">=</span> <span class="n">polar_frame</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">eph</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">e_ph = -y/sqrt(x^2 + y^2) e_x + x/sqrt(x^2 + y^2) e_y</span>
<span class="gp">sage: </span><span class="n">eph</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">cartesian</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">e_ph = -sin(ph) e_x + cos(ph) e_y</span>
</pre></div>
</div>
<p>We may check that <span class="math notranslate nohighlight">\((e_r, e_\phi)\)</span> is an orthonormal frame:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">er</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">er</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">er</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">eph</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">eph</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">eph</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Scalar fields can be expressed in terms of polar coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">F: E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; f(x, y)</span>
<span class="go">   (r, ph) |--&gt; f(r*cos(ph), r*sin(ph))</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>
<span class="go">F: E^2 --&gt; R</span>
<span class="go">   (r, ph) |--&gt; f(r*cos(ph), r*sin(ph))</span>
</pre></div>
</div>
<p>and we may ask for the components of vector fields in terms of the polar
frame:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>  <span class="c1"># default frame and default coordinates (both Cartesian ones)</span>
<span class="go">v = -y e_x + x e_y</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">)</span>  <span class="c1"># polar frame and default coordinates</span>
<span class="go">v = sqrt(x^2 + y^2) e_ph</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">,</span> <span class="n">polar</span><span class="p">)</span>  <span class="c1"># polar frame and polar coordinates</span>
<span class="go">v = r e_ph</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">w = w_x(x, y) e_x + w_y(x, y) e_y</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">,</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">w = (cos(ph)*w_x(r*cos(ph), r*sin(ph)) + sin(ph)*w_y(r*cos(ph), r*sin(ph))) e_r</span>
<span class="go">+ (-sin(ph)*w_x(r*cos(ph), r*sin(ph)) + cos(ph)*w_y(r*cos(ph), r*sin(ph))) e_ph</span>
</pre></div>
</div>
<div class="section" id="gradient-in-polar-coordinates">
<h3>Gradient in polar coordinates<a class="headerlink" href="#gradient-in-polar-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Let us define a generic scalar field in terms of polar coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">({</span><span class="n">polar</span><span class="p">:</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">ph</span><span class="p">)},</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>
<span class="go">H: E^2 --&gt; R</span>
<span class="go">   (r, ph) |--&gt; h(r, ph)</span>
</pre></div>
</div>
<p>The gradient of <span class="math notranslate nohighlight">\(H\)</span> is then:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">,</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">grad(H) = d(h)/dr e_r + d(h)/dph/r e_ph</span>
</pre></div>
</div>
<p>The access to individual components is achieved via the square bracket
operator, where, in addition to the index, one has to specify the vector frame
and the coordinates if they are not the default ones:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">cartesian</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">grad(H) = (r*cos(ph)*d(h)/dr - sin(ph)*d(h)/dph)/r e_x + (r*sin(ph)*d(h)/dr</span>
<span class="go"> + cos(ph)*d(h)/dph)/r e_y</span>
<span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">H</span><span class="p">)[</span><span class="n">polar_frame</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">polar</span><span class="p">]</span>
<span class="go">d(h)/dph/r</span>
</pre></div>
</div>
</div>
<div class="section" id="divergence-in-polar-coordinates">
<h3>Divergence in polar coordinates<a class="headerlink" href="#divergence-in-polar-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Let us define a generic vector field in terms of polar coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">vector_field</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;u_r&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                   <span class="n">function</span><span class="p">(</span><span class="s1">&#39;u_ph&#39;</span><span class="p">,</span> <span class="n">latex_name</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;u_\phi&#39;</span><span class="p">)(</span><span class="n">r</span><span class="p">,</span><span class="n">ph</span><span class="p">),</span>
<span class="gp">....: </span>                   <span class="n">frame</span><span class="o">=</span><span class="n">polar_frame</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">,</span> <span class="n">polar</span><span class="p">)</span>
<span class="go">u = u_r(r, ph) e_r + u_ph(r, ph) e_ph</span>
</pre></div>
</div>
<p>Its divergence is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>
<span class="go">div(u): E^2 --&gt; R</span>
<span class="go">   (r, ph) |--&gt; (r*d(u_r)/dr + u_r(r, ph) + d(u_ph)/dph)/r</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>
<span class="go">(r*diff(u_r(r, ph), r) + u_r(r, ph) + diff(u_ph(r, ph), ph))/r</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">u_r(r, ph)/r + diff(u_ph(r, ph), ph)/r + diff(u_r(r, ph), r)</span>
</pre></div>
</div>
</div>
<div class="section" id="using-polar-coordinates-by-default">
<h3>Using polar coordinates by default:<a class="headerlink" href="#using-polar-coordinates-by-default" title="Permalink to this headline">¶</a></h3>
<p>In order to avoid specifying the arguments <code class="docutils literal notranslate"><span class="pre">polar_frame</span></code> and <code class="docutils literal notranslate"><span class="pre">polar</span></code> in
<code class="docutils literal notranslate"><span class="pre">display()</span></code>, <code class="docutils literal notranslate"><span class="pre">expr()</span></code> and <code class="docutils literal notranslate"><span class="pre">[]</span></code>, we may change the default values by
means of
<a class="reference external" href="../../reference/manifolds/sage/manifolds/manifold.html#sage.manifolds.manifold.TopologicalManifold.set_default_chart" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_chart()</span></code></a> and
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/manifold.html#sage.manifolds.differentiable.manifold.DifferentiableManifold.set_default_frame" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_default_frame()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_default_chart</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">set_default_frame</span><span class="p">(</span><span class="n">polar_frame</span><span class="p">)</span>
</pre></div>
</div>
<p>Then we have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">u = u_r(r, ph) e_r + u_ph(r, ph) e_ph</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">u_r(r, ph)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = r e_ph</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">r</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">w = (cos(ph)*w_x(r*cos(ph), r*sin(ph)) + sin(ph)*w_y(r*cos(ph), r*sin(ph))) e_r + (-sin(ph)*w_x(r*cos(ph), r*sin(ph)) + cos(ph)*w_y(r*cos(ph), r*sin(ph))) e_ph</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">(r*diff(u_r(r, ph), r) + u_r(r, ph) + diff(u_ph(r, ph), ph))/r</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="advanced-topics-the-euclidean-plane-as-a-riemannian-manifold">
<h2>5. Advanced topics: the Euclidean plane as a Riemannian manifold<a class="headerlink" href="#advanced-topics-the-euclidean-plane-as-a-riemannian-manifold" title="Permalink to this headline">¶</a></h2>
<p><span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> is actually a <em>Riemannian manifold</em> (see
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/pseudo_riemannian.html#module-sage.manifolds.differentiable.pseudo_riemannian" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pseudo_riemannian</span></code></a>), i.e. a smooth real
manifold endowed with a positive definite metric tensor:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Join of</span>
<span class="go"> Category of smooth manifolds over Real Field with 53 bits of precision and</span>
<span class="go"> Category of connected manifolds over Real Field with 53 bits of precision and</span>
<span class="go"> Category of complete metric spaces</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span> <span class="ow">is</span> <span class="n">RR</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Actually <code class="docutils literal notranslate"><span class="pre">RR</span></code> is used here as a proxy for the real field (this should
be replaced in the future, see the discussion at
<a class="reference external" href="https://trac.sagemath.org/ticket/24456">#24456</a>) and the 53 bits of
precision play of course no role for the symbolic computations.</p>
<p>The user atlas of <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> has two charts:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">atlas</span><span class="p">()</span>
<span class="go">[Chart (E^2, (x, y)), Chart (E^2, (r, ph))]</span>
</pre></div>
</div>
<p>while there are three vector frames defined on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">frames</span><span class="p">()</span>
<span class="go">[Coordinate frame (E^2, (e_x,e_y)),</span>
<span class="go"> Coordinate frame (E^2, (d/dr,d/dph)),</span>
<span class="go"> Vector frame (E^2, (e_r,e_ph))]</span>
</pre></div>
</div>
<p>Indeed, there are two frames associated with polar coordinates: the coordinate
frame <span class="math notranslate nohighlight">\((\frac{\partial}{\partial r}, \frac{\partial}{\partial \phi})\)</span> and the
orthonormal frame <span class="math notranslate nohighlight">\((e_r, e_\phi)\)</span>.</p>
<div class="section" id="riemannian-metric">
<h3>Riemannian metric<a class="headerlink" href="#riemannian-metric" title="Permalink to this headline">¶</a></h3>
<p>The default metric tensor of <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span>
<span class="go">Riemannian metric g on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = e^r*e^r + e^ph*e^ph</span>
</pre></div>
</div>
<p>In the above display, <code class="docutils literal notranslate"><span class="pre">e^r</span></code> = <span class="math notranslate nohighlight">\(e^r\)</span> and <code class="docutils literal notranslate"><span class="pre">e^ph</span></code> = <span class="math notranslate nohighlight">\(e^\phi\)</span> are the 1-forms
defining the coframe dual to the orthonormal polar frame <span class="math notranslate nohighlight">\((e_r, e_\phi)\)</span>,
which is the default vector frame on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polar_frame</span><span class="o">.</span><span class="n">coframe</span><span class="p">()</span>
<span class="go">Coframe (E^2, (e^r,e^ph))</span>
</pre></div>
</div>
<p>Of course, we may ask for some display with respect to frames different from
the default one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">cartesian</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span>
<span class="go">g = dx*dx + dy*dy</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">(</span><span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">())</span>
<span class="go">g = dr*dr + r^2 dph*dph</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[:]</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">(),:]</span>
<span class="go">[  1   0]</span>
<span class="go">[  0 r^2]</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(g\)</span> is a <em>flat</em> metric: its (Riemann) curvature tensor (see
<a class="reference external" href="../../reference/manifolds/sage/manifolds/differentiable/metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric.riemann" title="(in Sage 9.3 Reference Manual: Manifolds v9.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">riemann()</span></code></a>)
is zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">riemann</span><span class="p">()</span>
<span class="go">Tensor field Riem(g) of type (1,3) on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">riemann</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">Riem(g) = 0</span>
</pre></div>
</div>
<p>The metric <span class="math notranslate nohighlight">\(g\)</span> is defining the dot product on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">v</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="vector-fields-as-derivations">
<span id="vector-fields-as-derivations-plane"></span><h3>Vector fields as derivations<a class="headerlink" href="#vector-fields-as-derivations" title="Permalink to this headline">¶</a></h3>
<p>Vector fields act as derivations on scalar fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">Scalar field v(F) on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v(F): E^2 --&gt; R</span>
<span class="go">   (x, y) |--&gt; -y*d(f)/dx + x*d(f)/dy</span>
<span class="go">   (r, ph) |--&gt; -r*sin(ph)*d(f)/d(r*cos(ph)) + r*cos(ph)*d(f)/d(r*sin(ph))</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dF</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">dF</span>
<span class="go">1-form dF on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">dF</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The set <span class="math notranslate nohighlight">\(\mathfrak{X}(\mathbb{E}^2)\)</span> of all vector fields on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span> is
a free module of rank 2 over the commutative algebra of smooth scalar fields
on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>, <span class="math notranslate nohighlight">\(C^\infty(\mathbb{E}^2)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">XE</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">XE</span>
<span class="go">Free module X(E^2) of vector fields on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">XE</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of finite dimensional modules over Algebra of differentiable</span>
<span class="go"> scalar fields on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">XE</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Algebra of differentiable scalar fields on the Euclidean plane E^2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CE</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">CE</span>
<span class="go">Algebra of differentiable scalar fields on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">CE</span> <span class="ow">is</span> <span class="n">XE</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">CE</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of commutative algebras over Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">rank</span><span class="p">(</span><span class="n">XE</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The bases of the free module <span class="math notranslate nohighlight">\(\mathfrak{X}(\mathbb{E}^2)\)</span> are nothing but the
vector frames defined on <span class="math notranslate nohighlight">\(\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">XE</span><span class="o">.</span><span class="n">bases</span><span class="p">()</span>
<span class="go">[Coordinate frame (E^2, (e_x,e_y)),</span>
<span class="go"> Coordinate frame (E^2, (d/dr,d/dph)),</span>
<span class="go"> Vector frame (E^2, (e_r,e_ph))]</span>
</pre></div>
</div>
</div>
<div class="section" id="tangent-spaces">
<h3>Tangent spaces<a class="headerlink" href="#tangent-spaces" title="Permalink to this headline">¶</a></h3>
<p>A vector field evaluated at a point $p$ is a vector in the tangent space
<span class="math notranslate nohighlight">\(T_p\mathbb{E}^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">vp</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">vp</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = -3 e_x - 2 e_y</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">vp</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Tp</span>
<span class="go">Tangent space at Point p on the Euclidean plane E^2</span>
<span class="gp">sage: </span><span class="n">Tp</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of finite dimensional vector spaces over Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">dim</span><span class="p">(</span><span class="n">Tp</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">Tp</span><span class="p">,</span> <span class="n">FiniteRankFreeModule</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Tp</span><span class="o">.</span><span class="n">bases</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="p">)</span>
<span class="go">[Basis (d/dr,d/dph) on the Tangent space at Point p on the Euclidean plane E^2,</span>
<span class="go"> Basis (e_r,e_ph) on the Tangent space at Point p on the Euclidean plane E^2,</span>
<span class="go"> Basis (e_x,e_y) on the Tangent space at Point p on the Euclidean plane E^2]</span>
</pre></div>
</div>
</div>
<div class="section" id="levi-civita-connection">
<h3>Levi-Civita connection<a class="headerlink" href="#levi-civita-connection" title="Permalink to this headline">¶</a></h3>
<p>The Levi-Civita connection associated to the Euclidean metric <span class="math notranslate nohighlight">\(g\)</span> is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nabla</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">connection</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">nabla</span>
<span class="go">Levi-Civita connection nabla_g associated with the Riemannian metric g on the Euclidean plane E^2</span>
</pre></div>
</div>
<p>The corresponding Christoffel symbols with respect to the polar coordinates
are:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">christoffel_symbols_display</span><span class="p">()</span>
<span class="go">Gam^r_ph,ph = -r</span>
<span class="go">Gam^ph_r,ph = 1/r</span>
</pre></div>
</div>
<p>By default, only nonzero and nonredundant values are displayed (for instance
<span class="math notranslate nohighlight">\(\Gamma^\phi_{\ \, \phi r}\)</span> is skipped, since it can be deduced from
<span class="math notranslate nohighlight">\(\Gamma^\phi_{\ \, r \phi}\)</span> by symmetry on the last two indices).</p>
<p>The Christoffel symbols with respect to the Cartesian coordinates are all
zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">christoffel_symbols_display</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cartesian</span><span class="p">,</span> <span class="n">only_nonzero</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Gam^x_xx = 0</span>
<span class="go">Gam^x_xy = 0</span>
<span class="go">Gam^x_yy = 0</span>
<span class="go">Gam^y_xx = 0</span>
<span class="go">Gam^y_xy = 0</span>
<span class="go">Gam^y_yy = 0</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(\nabla_g\)</span> is the connection involved in differential operators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">nabla</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">nabla</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">grad</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">down</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">nabla</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">div</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">nabla</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">laplacian</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">==</span> <span class="n">nabla</span><span class="p">(</span><span class="n">nabla</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">g</span><span class="p">))</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">laplacian</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">nabla</span><span class="p">(</span><span class="n">nabla</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">up</span><span class="p">(</span><span class="n">g</span><span class="p">))</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Vector calculus in the Euclidean plane</a><ul>
<li><a class="reference internal" href="#defining-the-euclidean-plane">1. Defining the Euclidean plane</a></li>
<li><a class="reference internal" href="#vector-fields">2. Vector fields</a><ul>
<li><a class="reference internal" href="#scalar-product-and-norm">Scalar product and norm</a></li>
<li><a class="reference internal" href="#values-at-a-given-point">Values at a given point</a></li>
</ul>
</li>
<li><a class="reference internal" href="#differential-operators">3. Differential operators</a><ul>
<li><a class="reference internal" href="#divergence">Divergence</a></li>
<li><a class="reference internal" href="#gradient">Gradient</a></li>
<li><a class="reference internal" href="#laplace-operator">Laplace operator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polar-coordinates">4. Polar coordinates</a><ul>
<li><a class="reference internal" href="#gradient-in-polar-coordinates">Gradient in polar coordinates</a></li>
<li><a class="reference internal" href="#divergence-in-polar-coordinates">Divergence in polar coordinates</a></li>
<li><a class="reference internal" href="#using-polar-coordinates-by-default">Using polar coordinates by default:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-topics-the-euclidean-plane-as-a-riemannian-manifold">5. Advanced topics: the Euclidean plane as a Riemannian manifold</a><ul>
<li><a class="reference internal" href="#riemannian-metric">Riemannian metric</a></li>
<li><a class="reference internal" href="#vector-fields-as-derivations">Vector fields as derivations</a></li>
<li><a class="reference internal" href="#tangent-spaces">Tangent spaces</a></li>
<li><a class="reference internal" href="#levi-civita-connection">Levi-Civita connection</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="vector_calc_advanced.html"
                        title="previous chapter">Advanced aspects: the Euclidean space as a Riemannian manifold</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../linear_programming.html"
                        title="next chapter">Linear Programming (Mixed Integer)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/vector_calculus/vector_calc_plane.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../linear_programming.html" title="Linear Programming (Mixed Integer)"
             >next</a> |</li>
        <li class="right" >
          <a href="vector_calc_advanced.html" title="Advanced aspects: the Euclidean space as a Riemannian manifold"
             >previous</a> |</li>
  
    
      <a href="../../index.html"><img src="../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../index.html">Thematic Tutorials v9.3</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../toctree.html" >Thematic tutorial document tree</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../vector_calculus.html" >Tutorial: Vector Calculus in Euclidean Spaces</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Vector calculus in the Euclidean plane</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>