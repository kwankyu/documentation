
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Common Asymptotic Expansions &#8212; Sage Reference Manual v9.0: Asymptotic Expansions</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="(Asymptotic) Growth Groups" href="growth_group.html" />
    <link rel="prev" title="Asymptotic Ring" href="asymptotic_ring.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="growth_group.html" title="(Asymptotic) Growth Groups"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="asymptotic_ring.html" title="Asymptotic Ring"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Asymptotic Expansions</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="common-asymptotic-expansions">
<span id="sage-rings-asymptotic-asymptotic-expansion-generators"></span><h1>Common Asymptotic Expansions<a class="headerlink" href="#common-asymptotic-expansions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.asymptotic.asymptotic_expansion_generators"></span><p>Asymptotic expansions in SageMath can be built through the
<code class="docutils literal notranslate"><span class="pre">asymptotic_expansions</span></code> object. It contains generators for common
asymptotic expressions. For example,</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Stirling</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(1/2) +</span>
<span class="go">1/12*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-1/2) +</span>
<span class="go">1/288*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-3/2) +</span>
<span class="go">O(e^(n*log(n))*(e^n)^(-1)*n^(-5/2))</span>
</pre></div>
</div>
<p>generates the first 5 summands of Stirling’s approximation formula for
factorials.</p>
<p>To construct an asymptotic expression manually, you can use the class
<a class="reference internal" href="asymptotic_ring.html#sage.rings.asymptotic.asymptotic_ring.AsymptoticRing" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsymptoticRing</span></code></a>. See
<a class="reference internal" href="asymptotic_ring.html"><span class="doc">asymptotic ring</span></a> for more details and a lot of
examples.</p>
<p><strong>Asymptotic Expansions</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HarmonicNumber()</span></code></a></td>
<td>harmonic numbers</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stirling()</span></code></a></td>
<td>Stirling’s approximation formula for factorials</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_Stirling()</span></code></a></td>
<td>the logarithm of Stirling’s approximation formula for factorials</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Binomial_kn_over_n()</span></code></a></td>
<td>an asymptotic expansion of the binomial coefficient</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SingularityAnalysis()</span></code></a></td>
<td>an asymptotic expansion obtained by singularity analysis</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansion()</span></code></a></td>
<td>the singular expansion of a function <span class="math notranslate nohighlight">\(y(z)\)</span> satisfying <span class="math notranslate nohighlight">\(y(z) = z \Phi(y(z))\)</span></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansionPeriodicPart()</span></code></a></td>
<td>the singular expansion of the periodic part of a function <span class="math notranslate nohighlight">\(y(z)\)</span> satisfying <span class="math notranslate nohighlight">\(y(z) = z\Phi(y(z))\)</span></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InverseFunctionAnalysis()</span></code></a></td>
<td>coefficient growth of a function <span class="math notranslate nohighlight">\(y(z)\)</span> defined implicitly by <span class="math notranslate nohighlight">\(y(z) = z \Phi(y(z))\)</span></td>
</tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>Daniel Krenn (2015)</li>
<li>Clemens Heuberger (2016)</li>
<li>Benjamin Hackl (2016)</li>
</ul>
<p>ACKNOWLEDGEMENT:</p>
<ul class="simple">
<li>Benjamin Hackl, Clemens Heuberger and Daniel Krenn are supported by the
Austrian Science Fund (FWF): P 24644-N26.</li>
</ul>
<div class="section" id="classes-and-methods">
<h2>Classes and Methods<a class="headerlink" href="#classes-and-methods" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators">
<em class="property">class </em><code class="descclassname">sage.rings.asymptotic.asymptotic_expansion_generators.</code><code class="descname">AsymptoticExpansionGenerators</code><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>A collection of constructors for several common asymptotic expansions.</p>
<p>A list of all asymptotic expansions in this database is available via tab
completion. Type “<code class="docutils literal notranslate"><span class="pre">asymptotic_expansions.</span></code>” and then hit tab to see which
expansions are available.</p>
<p>The asymptotic expansions currently in this class include:</p>
<ul class="simple">
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HarmonicNumber()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stirling()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_Stirling()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Binomial_kn_over_n()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SingularityAnalysis()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansion()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansionPeriodicPart()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InverseFunctionAnalysis()</span></code></a></li>
</ul>
<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n">
<em class="property">static </em><code class="descname">Binomial_kn_over_n</code><span class="sig-paren">(</span><em>var</em>, <em>k</em>, <em>precision=None</em>, <em>skip_constant_factor=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Binomial_kn_over_n" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the asymptotic expansion of the binomial coefficient
<span class="math notranslate nohighlight">\(kn\)</span> choose <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> – a number or symbolic constant.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">skip_constant_factor</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a
boolean. If set, then the constant factor <span class="math notranslate nohighlight">\(\sqrt{k/(2\pi(k-1))}\)</span>
is left out.
As a consequence, the coefficient ring of the output changes
from <code class="docutils literal notranslate"><span class="pre">Symbolic</span> <span class="pre">Constants</span> <span class="pre">Subring</span></code> (if <code class="docutils literal notranslate"><span class="pre">False</span></code>) to
<code class="docutils literal notranslate"><span class="pre">Rational</span> <span class="pre">Field</span></code> (if <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Binomial_kn_over_n</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/sqrt(pi)*4^n*n^(-1/2)</span>
<span class="go">- 1/8/sqrt(pi)*4^n*n^(-3/2)</span>
<span class="go">+ 1/128/sqrt(pi)*4^n*n^(-5/2)</span>
<span class="go">+ O(4^n*n^(-7/2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;QQ^n * n^QQ&gt; over Symbolic Constants Subring</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Binomial_kn_over_n</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/2*sqrt(3)/sqrt(pi)*(27/4)^n*n^(-1/2)</span>
<span class="go">- 7/144*sqrt(3)/sqrt(pi)*(27/4)^n*n^(-3/2)</span>
<span class="go">+ 49/20736*sqrt(3)/sqrt(pi)*(27/4)^n*n^(-5/2)</span>
<span class="go">+ O((27/4)^n*n^(-7/2))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Binomial_kn_over_n</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">7</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/2*sqrt(7)/sqrt(pi)*(7/10*7^(2/5)*2^(3/5))^n*n^(-1/2)</span>
<span class="go">- 13/112*sqrt(7)/sqrt(pi)*(7/10*7^(2/5)*2^(3/5))^n*n^(-3/2)</span>
<span class="go">+ 169/12544*sqrt(7)/sqrt(pi)*(7/10*7^(2/5)*2^(3/5))^n*n^(-5/2)</span>
<span class="go">+ O((7/10*7^(2/5)*2^(3/5))^n*n^(-7/2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(Symbolic Constants Subring)^n * n^QQ&gt;</span>
<span class="go">over Symbolic Constants Subring</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber">
<em class="property">static </em><code class="descname">HarmonicNumber</code><span class="sig-paren">(</span><em>var</em>, <em>precision=None</em>, <em>skip_constant_summand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.HarmonicNumber" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the asymptotic expansion of a harmonic number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">skip_constant_summand</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a
boolean. If set, then the constant summand <code class="docutils literal notranslate"><span class="pre">euler_gamma</span></code> is left out.
As a consequence, the coefficient ring of the output changes
from <code class="docutils literal notranslate"><span class="pre">Symbolic</span> <span class="pre">Constants</span> <span class="pre">Subring</span></code> (if <code class="docutils literal notranslate"><span class="pre">False</span></code>) to
<code class="docutils literal notranslate"><span class="pre">Rational</span> <span class="pre">Field</span></code> (if <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">HarmonicNumber</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">log(n) + euler_gamma + 1/2*n^(-1) - 1/12*n^(-2) + 1/120*n^(-4) + O(n^(-6))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion">
<em class="property">static </em><code class="descname">ImplicitExpansion</code><span class="sig-paren">(</span><em>var</em>, <em>phi</em>, <em>tau=None</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the singular expansion for a function <span class="math notranslate nohighlight">\(y(z)\)</span> defined
implicitly by <span class="math notranslate nohighlight">\(y(z) = z \Phi(y(z))\)</span>.</p>
<p>The function <span class="math notranslate nohighlight">\(\Phi\)</span> is assumed to be analytic around <span class="math notranslate nohighlight">\(0\)</span>. Furthermore,
<span class="math notranslate nohighlight">\(\Phi\)</span> is not allowed to be an affine-linear function and we require
<span class="math notranslate nohighlight">\(\Phi(0) \neq 0\)</span>.</p>
<p>Furthermore, it is assumed that there is a unique positive solution <span class="math notranslate nohighlight">\(\tau\)</span>
of <span class="math notranslate nohighlight">\(\Phi(\tau) - \tau\Phi'(\tau) = 0\)</span>.</p>
<p>All details are given in Chapter VI.7 of <a class="reference internal" href="../../../../references/index.html#fs2009" id="id1">[FS2009]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">phi</span></code> – the function <span class="math notranslate nohighlight">\(\Phi\)</span>. See the extended description for
assumptions on <span class="math notranslate nohighlight">\(\Phi\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tau</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the fundamental constant described
in the extended description. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <span class="math notranslate nohighlight">\(\tau\)</span> is determined
automatically if possible.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the given case, the radius of convergence of the function of
interest is known to be <span class="math notranslate nohighlight">\(\rho = \tau/\Phi(\tau)\)</span>.  Until <a class="reference external" href="https://trac.sagemath.org/20050">trac ticket #20050</a>
is implemented, the variable in the returned asymptotic expansion
represents a singular element of the form <span class="math notranslate nohighlight">\((1 - z/\rho)^{-1}\)</span>,
for the variable <span class="math notranslate nohighlight">\(z\to\rho\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<p>We can, for example, determine the singular expansion of the well-known
tree function <span class="math notranslate nohighlight">\(T\)</span> (which satisfies <span class="math notranslate nohighlight">\(T(z) = z \exp(T(z))\)</span>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">exp</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">FutureWarning: This class/method/function is marked as experimental. It, its functionality or its interface might change without a formal deprecation.</span>
<span class="go">See http://trac.sagemath.org/20050 for details.</span>
<span class="go">1 - sqrt(2)*Z^(-1/2) + 2/3*Z^(-1) - 11/36*sqrt(2)*Z^(-3/2) +</span>
<span class="go">43/135*Z^(-2) - 769/4320*sqrt(2)*Z^(-5/2) + 1768/8505*Z^(-3) + O(Z^(-7/2))</span>
</pre></div>
</div>
<p>Another classical example in this context is the generating function <span class="math notranslate nohighlight">\(B(z)\)</span>
enumerating binary trees with respect to the number of inner nodes. The
function satisfies <span class="math notranslate nohighlight">\(B(z) = z (1 + 2B(z) + B(z)^2)\)</span>, which can also be
solved explicitly, yielding <span class="math notranslate nohighlight">\(B(z) = \frac{1 - \sqrt{1 - 4z}}{2z} - 1\)</span>. We
compare the expansions from both approaches:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;Z^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">Z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 - 2*Z^(-1/2) + 2*Z^(-1) - 2*Z^(-3/2) + 2*Z^(-2)</span>
<span class="go">- 2*Z^(-5/2) + O(Z^(-3))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1 - 2*Z^(-1/2) + 2*Z^(-1) - 2*Z^(-3/2) + 2*Z^(-2)</span>
<span class="go">- 2*Z^(-5/2) + O(Z^(-3))</span>
</pre></div>
</div>
<p>Neither <span class="math notranslate nohighlight">\(\tau\)</span> nor <span class="math notranslate nohighlight">\(\Phi\)</span> have to be known explicitly, they can
also be passed symbolically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;phi&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="n">tau</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">tau + (-sqrt(2)*sqrt(-tau*phi(tau)^2/(2*tau*diff(phi(tau), tau)^2</span>
<span class="go">- tau*phi(tau)*diff(phi(tau), tau, tau)</span>
<span class="go">- 2*phi(tau)*diff(phi(tau), tau))))*Z^(-1/2) + O(Z^(-1))</span>
</pre></div>
</div>
<p>Note that we do not check whether a passed <span class="math notranslate nohighlight">\(\tau\)</span> actually
satisfies the requirements. Only the first of the following
expansions is correct:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># correct expansion</span>
<span class="go">1 - 2*Z^(-1/2) + 2*Z^(-1) - 2*Z^(-3/2) + O(Z^(-2))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ZeroDivisionError: symbolic division by zero</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansion</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3 - 4*I*sqrt(3)*Z^(-1/2) + 6*I*sqrt(3)*Z^(-3/2) + O(Z^(-2))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansionPeriodicPart()</span></code></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InverseFunctionAnalysis()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart">
<em class="property">static </em><code class="descname">ImplicitExpansionPeriodicPart</code><span class="sig-paren">(</span><em>var</em>, <em>phi</em>, <em>period</em>, <em>tau=None</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the singular expansion for the periodic part of a function <span class="math notranslate nohighlight">\(y(z)\)</span>
defined implicitly by <span class="math notranslate nohighlight">\(y(z) = z \Phi(y(z))\)</span>.</p>
<p>The function <span class="math notranslate nohighlight">\(\Phi\)</span> is assumed to be analytic around <span class="math notranslate nohighlight">\(0\)</span>. Furthermore,
<span class="math notranslate nohighlight">\(\Phi\)</span> is not allowed to be an affine-linear function and we require
<span class="math notranslate nohighlight">\(\Phi(0) \neq 0\)</span>. For an integer <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(\Phi\)</span> is called <span class="math notranslate nohighlight">\(p\)</span>-periodic
if we have <span class="math notranslate nohighlight">\(\Psi(u^p) = \Phi(u)\)</span> for a power series <span class="math notranslate nohighlight">\(\Psi\)</span>
where <span class="math notranslate nohighlight">\(p\)</span> is maximal.</p>
<p>Furthermore, it is assumed that there is a unique positive solution <span class="math notranslate nohighlight">\(\tau\)</span>
of <span class="math notranslate nohighlight">\(\Phi(\tau) - \tau\Phi'(\tau) = 0\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(\Phi\)</span> is <span class="math notranslate nohighlight">\(p\)</span>-periodic, then we have <span class="math notranslate nohighlight">\(y(z) = z g(z^p)\)</span>. This method
returns the singular expansion of <span class="math notranslate nohighlight">\(g(z)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">phi</span></code> – the function <span class="math notranslate nohighlight">\(\Phi\)</span>. See the extended description for
assumptions on <span class="math notranslate nohighlight">\(\Phi\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">period</span></code> – the period of the function <span class="math notranslate nohighlight">\(\Phi\)</span>. See the
extended description for details.</li>
<li><code class="docutils literal notranslate"><span class="pre">tau</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the fundamental constant described
in the extended description. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <span class="math notranslate nohighlight">\(\tau\)</span> is determined
automatically if possible.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In the given case, the radius of convergence of the function of
interest is known to be <span class="math notranslate nohighlight">\(\rho = \tau/\Phi(\tau)\)</span>. Until <a class="reference external" href="https://trac.sagemath.org/20050">trac ticket #20050</a>
is implemented, the variable in the returned asymptotic expansion
represents a singular element of the form <span class="math notranslate nohighlight">\((1 - z/\rho)^{-1}\)</span>,
for the variable <span class="math notranslate nohighlight">\(z\to\rho\)</span>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansion()</span></code></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">InverseFunctionAnalysis()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>The generating function enumerating binary trees with respect to
tree size satisfies <span class="math notranslate nohighlight">\(B(z) = z (1 + B(z)^2)\)</span>. This function can be
written as <span class="math notranslate nohighlight">\(B(z) = z g(z^2)\)</span>, and as <span class="math notranslate nohighlight">\(B(z)\)</span> can be determined
explicitly we have <span class="math notranslate nohighlight">\(g(z) = \frac{1 - \sqrt{1 - 4z}}{2z}\)</span>. We
compare the corresponding expansions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">ImplicitExpansionPeriodicPart</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>                                                    <span class="n">period</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">doctest:warning</span>
<span class="go">...</span>
<span class="go">FutureWarning: This class/method/function is marked as experimental. It, its functionality or its interface might change without a formal deprecation.</span>
<span class="go">See http://trac.sagemath.org/20050 for details.</span>
<span class="go">2 - 2*Z^(-1/2) + 2*Z^(-1) - 2*Z^(-3/2) + 2*Z^(-2) - 2*Z^(-5/2) + O(Z^(-3))</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;Z^QQ&#39;</span><span class="p">,</span> <span class="n">QQ</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">Z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">2 - 2*Z^(-1/2) + 2*Z^(-1) - 2*Z^(-3/2) + 2*Z^(-2) - 2*Z^(-5/2) + O(Z^(-3))</span>
</pre></div>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis">
<em class="property">static </em><code class="descname">InverseFunctionAnalysis</code><span class="sig-paren">(</span><em>var</em>, <em>phi</em>, <em>tau=None</em>, <em>period=1</em>, <em>precision=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.InverseFunctionAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coefficient growth of a function <span class="math notranslate nohighlight">\(y(z)\)</span> defined implicitly
by <span class="math notranslate nohighlight">\(y(z) = z \Phi(y(z))\)</span>.</p>
<p>The function <span class="math notranslate nohighlight">\(\Phi\)</span> is assumed to be analytic around <span class="math notranslate nohighlight">\(0\)</span>. Furthermore,
<span class="math notranslate nohighlight">\(\Phi\)</span> is not allowed to be an affine-linear function and we require
<span class="math notranslate nohighlight">\(\Phi(0) \neq 0\)</span>. For an integer <span class="math notranslate nohighlight">\(p\)</span>, <span class="math notranslate nohighlight">\(\Phi\)</span> is called <span class="math notranslate nohighlight">\(p\)</span>-periodic
if we have <span class="math notranslate nohighlight">\(\Psi(u^p) = \Phi(u)\)</span> for a power series <span class="math notranslate nohighlight">\(\Psi\)</span>
where <span class="math notranslate nohighlight">\(p\)</span> is maximal.</p>
<p>Furthermore, it is assumed that there is a unique positive solution <span class="math notranslate nohighlight">\(\tau\)</span>
of <span class="math notranslate nohighlight">\(\Phi(\tau) - \tau\Phi'(\tau) = 0\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">phi</span></code> – the function <span class="math notranslate nohighlight">\(\Phi\)</span>. See the extended description for
assumptions on <span class="math notranslate nohighlight">\(\Phi\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">tau</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) the fundamental constant described
in the extended description. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then <span class="math notranslate nohighlight">\(\tau\)</span> is determined
automatically if possible.</li>
<li><code class="docutils literal notranslate"><span class="pre">period</span></code> – (default: <span class="math notranslate nohighlight">\(1\)</span>) the period of the function <span class="math notranslate nohighlight">\(\Phi\)</span>. See
the extended description for details.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>It is not checked that the passed period actually fits to
the passed function <span class="math notranslate nohighlight">\(\Phi\)</span>.</p>
<p class="last">The resulting asymptotic expansion is only valid
for <span class="math notranslate nohighlight">\(n \equiv 1 \mod p\)</span>, where <span class="math notranslate nohighlight">\(p\)</span> is the period. All other
coefficients are <span class="math notranslate nohighlight">\(0\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<p>There are <span class="math notranslate nohighlight">\(C_n\)</span> (the <span class="math notranslate nohighlight">\(n\)</span>-th Catalan number) different binary trees
of size <span class="math notranslate nohighlight">\(2n+1\)</span>, and there are no binary trees with an even number of
nodes. The corresponding generating function satisfies
<span class="math notranslate nohighlight">\(B(z) = z (1 + B(z)^2)\)</span>, which allows us to compare the asymptotic
expansions for the number of binary trees of size <span class="math notranslate nohighlight">\(n\)</span> obtained via
<span class="math notranslate nohighlight">\(C_n\)</span> and obtained via the analysis of <span class="math notranslate nohighlight">\(B(z)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">SR</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">n</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">AsymptoticRing</span><span class="p">(</span><span class="s1">&#39;QQ^n * n^QQ&#39;</span><span class="p">,</span> <span class="n">SR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">binomial_expansion</span> <span class="o">=</span> <span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Binomial_kn_over_n</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">catalan_expansion</span> <span class="o">=</span> <span class="n">binomial_expansion</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">catalan_expansion</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*sqrt(1/2)/sqrt(pi)*2^n*n^(-3/2) - 3/2*sqrt(1/2)/sqrt(pi)*2^n*n^(-5/2)</span>
<span class="go">+ 25/16*sqrt(1/2)/sqrt(pi)*2^n*n^(-7/2) + O(2^n*n^(-9/2))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">InverseFunctionAnalysis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>                                              <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">2*sqrt(1/2)/sqrt(pi)*2^n*n^(-3/2) - 3/2*sqrt(1/2)/sqrt(pi)*2^n*n^(-5/2)</span>
<span class="go">+ 25/16*sqrt(1/2)/sqrt(pi)*2^n*n^(-7/2) + O(2^n*n^(-9/2))</span>
</pre></div>
</div>
<p>The code in the aperiodic case is more efficient, however. Therefore,
it is recommended to use combinatorial identities to reduce to the
aperiodic case. In the example above, this is well-known: we now count
binary trees with <span class="math notranslate nohighlight">\(n\)</span> internal nodes. The corresponding generating function
satisfies <span class="math notranslate nohighlight">\(B(z) = z (1 + 2B(z) + B(z)^2)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">catalan_expansion</span>
<span class="go">1/sqrt(pi)*4^n*n^(-3/2) - 9/8/sqrt(pi)*4^n*n^(-5/2)</span>
<span class="go">+ 145/128/sqrt(pi)*4^n*n^(-7/2) + O(4^n*n^(-9/2))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">InverseFunctionAnalysis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span> <span class="o">+</span> <span class="n">u</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>                                              <span class="n">tau</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">1/sqrt(pi)*4^n*n^(-3/2) - 9/8/sqrt(pi)*4^n*n^(-5/2)</span>
<span class="go">+ 145/128/sqrt(pi)*4^n*n^(-7/2) + O(4^n*n^(-9/2))</span>

<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansion"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansion()</span></code></a>,
<a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.ImplicitExpansionPeriodicPart"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ImplicitExpansionPeriodicPart()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis">
<em class="property">static </em><code class="descname">SingularityAnalysis</code><span class="sig-paren">(</span><em>var</em>, <em>zeta=1</em>, <em>alpha=0</em>, <em>beta=0</em>, <em>delta=0</em>, <em>precision=None</em>, <em>normalized=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.SingularityAnalysis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the asymptotic expansion of the coefficients of
an power series with specified pole and logarithmic singularity.</p>
<p>More precisely, this extracts the <span class="math notranslate nohighlight">\(n\)</span>-th coefficient</p>
<div class="math notranslate nohighlight">
\[[z^n] \left(\frac{1}{1-z/\zeta}\right)^\alpha
\left(\frac{1}{z/\zeta} \log \frac{1}{1-z/\zeta}\right)^\beta
\left(\frac{1}{z/\zeta} \log
\left(\frac{1}{z/\zeta} \log \frac{1}{1-z/\zeta}\right)\right)^\delta\]</div>
<p>(if <code class="docutils literal notranslate"><span class="pre">normalized=True</span></code>, the default) or</p>
<div class="math notranslate nohighlight">
\[[z^n] \left(\frac{1}{1-z/\zeta}\right)^\alpha
\left(\log \frac{1}{1-z/\zeta}\right)^\beta
\left(\log
\left(\frac{1}{z/\zeta} \log \frac{1}{1-z/\zeta}\right)\right)^\delta\]</div>
<p>(if <code class="docutils literal notranslate"><span class="pre">normalized=False</span></code>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">zeta</span></code> – (default: <span class="math notranslate nohighlight">\(1\)</span>) the location of the singularity.</li>
<li><code class="docutils literal notranslate"><span class="pre">alpha</span></code> – (default: <span class="math notranslate nohighlight">\(0\)</span>) the pole order of the singularity.</li>
<li><code class="docutils literal notranslate"><span class="pre">beta</span></code> – (default: <span class="math notranslate nohighlight">\(0\)</span>) the order of the logarithmic singularity.</li>
<li><code class="docutils literal notranslate"><span class="pre">delta</span></code> – (default: <span class="math notranslate nohighlight">\(0\)</span>) the order of the log-log singularity.
Not yet implemented for <code class="docutils literal notranslate"><span class="pre">delta</span> <span class="pre">!=</span> <span class="pre">0</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">normalized</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) a boolean, see above.</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">n + 1</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1/2*n^2 + 3/2*n + 1</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;n^ZZ&gt; over Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">3/4/sqrt(pi)*n^(-5/2)</span>
<span class="go">+ 45/32/sqrt(pi)*n^(-7/2)</span>
<span class="go">+ 1155/512/sqrt(pi)*n^(-9/2)</span>
<span class="go">+ O(n^(-11/2))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1/2/sqrt(pi)*n^(-3/2)</span>
<span class="go">- 3/16/sqrt(pi)*n^(-5/2)</span>
<span class="go">- 25/256/sqrt(pi)*n^(-7/2)</span>
<span class="go">+ O(n^(-9/2))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1/sqrt(pi)*n^(-1/2)</span>
<span class="go">- 1/8/sqrt(pi)*n^(-3/2)</span>
<span class="go">+ 1/128/sqrt(pi)*n^(-5/2)</span>
<span class="go">+ 5/1024/sqrt(pi)*n^(-7/2)</span>
<span class="go">+ O(n^(-9/2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;n^QQ&gt; over Symbolic Constants Subring</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">SR</span><span class="o">.</span><span class="n">subring</span><span class="p">(</span><span class="n">rejecting_variables</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">S</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span>
<span class="gp">....: </span>    <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span>
<span class="go">1/gamma(a)*n^(a - 1)</span>
<span class="go">+ (1/2*(a - 1)*a/gamma(a))*n^(a - 2)</span>
<span class="go">+ (1/24*(3*a - 1)*(a - 1)*(a - 2)*a/gamma(a))*n^(a - 3)</span>
<span class="go">+ (1/48*(a - 1)^2*(a - 2)*(a - 3)*a^2/gamma(a))*n^(a - 4)</span>
<span class="go">+ O(n^(a - 5))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;n^(Symbolic Subring rejecting the variable n)&gt;</span>
<span class="go">over Symbolic Subring rejecting the variable n</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ae</span> <span class="o">=</span> <span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span>
<span class="gp">....: </span>         <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">);</span> <span class="n">ae</span>
<span class="go">1/sqrt(pi)*n^(-1/2)*log(n) + ((euler_gamma + 2*log(2))/sqrt(pi))*n^(-1/2)</span>
<span class="go">- 5/8/sqrt(pi)*n^(-3/2)*log(n) + (1/8*(3*euler_gamma + 6*log(2) - 8)/sqrt(pi)</span>
<span class="go">- (euler_gamma + 2*log(2) - 2)/sqrt(pi))*n^(-3/2) + O(n^(-5/2)*log(n))</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ae</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">canonicalize_radical</span><span class="p">())</span>
<span class="go">1/sqrt(pi)*n^(-1/2)*log(n)</span>
<span class="go">+ ((euler_gamma + 2*log(2))/sqrt(pi))*n^(-1/2)</span>
<span class="go">- 1/8/sqrt(pi)*n^(-3/2)*log(n)</span>
<span class="go">+ (-1/8*(euler_gamma + 2*log(2))/sqrt(pi))*n^(-3/2)</span>
<span class="go">+ O(n^(-5/2)*log(n))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">log(n)^(1/2) + 1/2*euler_gamma*log(n)^(-1/2)</span>
<span class="go">+ (-1/8*euler_gamma^2 + 1/48*pi^2)*log(n)^(-3/2)</span>
<span class="go">+ (1/16*euler_gamma^3 - 1/32*euler_gamma*pi^2 + 1/8*zeta(3))*log(n)^(-5/2)</span>
<span class="go">+ O(log(n)^(-7/2))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ae</span> <span class="o">=</span> <span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span>
<span class="gp">....: </span>    <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">ae</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ae</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*n^(-1)*log(n) + 2*euler_gamma*n^(-1) - n^(-2) - 1/6*n^(-3) + O(n^(-5))</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">-1/2/sqrt(pi)*n^(-3/2)*log(n)</span>
<span class="go">+ (-1/2*(euler_gamma + 2*log(2) - 2)/sqrt(pi))*n^(-3/2)</span>
<span class="go">+ O(n^(-5/2)*log(n))</span>
<span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">SingularityAnalysis</span><span class="p">(</span>
<span class="gp">....: </span>    <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">normalized</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">2^n*n^(-1) + O(2^n*n^(-2))</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See <a class="reference internal" href="../../../../references/index.html#fs2009" id="id2">[FS2009]</a>.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling">
<em class="property">static </em><code class="descname">Stirling</code><span class="sig-paren">(</span><em>var</em>, <em>precision=None</em>, <em>skip_constant_factor=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Stirling’s approximation formula for factorials.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer <span class="math notranslate nohighlight">\(\ge 3\)</span>. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">skip_constant_factor</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a
boolean. If set, then the constant factor <span class="math notranslate nohighlight">\(\sqrt{2\pi}\)</span> is left out.
As a consequence, the coefficient ring of the output changes
from <code class="docutils literal notranslate"><span class="pre">Symbolic</span> <span class="pre">Constants</span> <span class="pre">Subring</span></code> (if <code class="docutils literal notranslate"><span class="pre">False</span></code>) to
<code class="docutils literal notranslate"><span class="pre">Rational</span> <span class="pre">Field</span></code> (if <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">Stirling</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(1/2) +</span>
<span class="go">1/12*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-1/2) +</span>
<span class="go">1/288*sqrt(2)*sqrt(pi)*e^(n*log(n))*(e^n)^(-1)*n^(-3/2) +</span>
<span class="go">O(e^(n*log(n))*(e^n)^(-1)*n^(-5/2))</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Asymptotic Ring &lt;(e^(n*log(n)))^QQ * (e^n)^QQ * n^QQ * log(n)^QQ&gt;</span>
<span class="go">over Symbolic Constants Subring</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_Stirling()</span></code></a>,
<a class="reference internal" href="asymptotic_ring.html#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factorial()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="staticmethod">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling">
<em class="property">static </em><code class="descname">log_Stirling</code><span class="sig-paren">(</span><em>var</em>, <em>precision=None</em>, <em>skip_constant_summand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.log_Stirling" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the logarithm of Stirling’s approximation formula
for factorials.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> – a string for the variable name.</li>
<li><code class="docutils literal notranslate"><span class="pre">precision</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then
the default precision of the asymptotic ring is used.</li>
<li><code class="docutils literal notranslate"><span class="pre">skip_constant_summand</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) a
boolean. If set, then the constant summand <span class="math notranslate nohighlight">\(\log(2\pi)/2\)</span> is left out.
As a consequence, the coefficient ring of the output changes
from <code class="docutils literal notranslate"><span class="pre">Symbolic</span> <span class="pre">Constants</span> <span class="pre">Subring</span></code> (if <code class="docutils literal notranslate"><span class="pre">False</span></code>) to
<code class="docutils literal notranslate"><span class="pre">Rational</span> <span class="pre">Field</span></code> (if <code class="docutils literal notranslate"><span class="pre">True</span></code>).</li>
</ul>
<p>OUTPUT:</p>
<p>An asymptotic expansion.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">asymptotic_expansions</span><span class="o">.</span><span class="n">log_Stirling</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">n*log(n) - n + 1/2*log(n) + 1/2*log(2*pi) + 1/12*n^(-1)</span>
<span class="go">- 1/360*n^(-3) + 1/1260*n^(-5) + O(n^(-7))</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Stirling()</span></code></a>,
<a class="reference internal" href="asymptotic_ring.html#sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial" title="sage.rings.asymptotic.asymptotic_ring.AsymptoticExpansion.factorial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">factorial()</span></code></a>.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="sage.rings.asymptotic.asymptotic_expansion_generators.asymptotic_expansions">
<code class="descclassname">sage.rings.asymptotic.asymptotic_expansion_generators.</code><code class="descname">asymptotic_expansions</code><em class="property"> = &lt;sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators object&gt;</em><a class="headerlink" href="#sage.rings.asymptotic.asymptotic_expansion_generators.asymptotic_expansions" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of several common asymptotic expansions.</p>
<p>This is an instance of <a class="reference internal" href="#sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators" title="sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators"><code class="xref py py-class docutils literal notranslate"><span class="pre">AsymptoticExpansionGenerators</span></code></a> whose documentation
provides more details.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Common Asymptotic Expansions</a><ul>
<li><a class="reference internal" href="#classes-and-methods">Classes and Methods</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="asymptotic_ring.html"
                        title="previous chapter">Asymptotic Ring</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="growth_group.html"
                        title="next chapter">(Asymptotic) Growth Groups</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/rings/asymptotic/asymptotic_expansion_generators.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="growth_group.html" title="(Asymptotic) Growth Groups"
             >next</a> |</li>
        <li class="right" >
          <a href="asymptotic_ring.html" title="Asymptotic Ring"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Asymptotic Expansions</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>