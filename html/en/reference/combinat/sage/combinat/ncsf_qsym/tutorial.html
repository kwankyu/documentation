
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Introduction to Quasisymmetric Functions &#8212; Sage 9.4 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Symmetric Functions in Non-Commuting Variables" href="../ncsym/__init__.html" />
    <link rel="prev" title="Quasisymmetric functions" href="qsym.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ncsym/__init__.html" title="Symmetric Functions in Non-Commuting Variables"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="qsym.html" title="Quasisymmetric functions"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction to Quasisymmetric Functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="introduction-to-quasisymmetric-functions">
<span id="sage-combinat-ncsf-qsym-tutorial"></span><h1>Introduction to Quasisymmetric Functions<a class="headerlink" href="#introduction-to-quasisymmetric-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.ncsf_qsym.tutorial"></span><p>In this document we briefly explain the quasisymmetric function bases and
related functionality in Sage.   We assume the reader is familiar with the
package <a class="reference internal" href="../sf/sf.html#sage.combinat.sf.sf.SymmetricFunctions" title="sage.combinat.sf.sf.SymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">SymmetricFunctions</span></code></a>.</p>
<p>Quasisymmetric functions, denoted <span class="math notranslate nohighlight">\(QSym\)</span>, form a subring of the power
series ring in countably many variables. <span class="math notranslate nohighlight">\(QSym\)</span> contains the symmetric
functions.  These functions first arose in the theory of
<span class="math notranslate nohighlight">\(P\)</span>-partitions.  The initial ideas in this field are attributed to
MacMahon, Knuth, Kreweras, Glânffrwd Thomas, Stanley. In 1984, Gessel
formalized the study of quasisymmetric functions and introduced the
basis of fundamental quasisymmetric functions <a class="reference internal" href="qsym.html#ges" id="id1"><span>[Ges]</span></a>. In 1995, Gelfand,
Krob, Lascoux, Leclerc, Retakh, and Thibon showed that the ring of
quasisymmetric functions is Hopf dual to the noncommutative symmetric
functions <a class="reference internal" href="combinatorics.html#ncsf" id="id2"><span>[NCSF]</span></a>.  Many results have built on these.</p>
<p>One advantage of working in <span class="math notranslate nohighlight">\(QSym\)</span> is that many interesting families of
symmetric functions have explicit expansions in fundamental quasisymmetric
functions such as Schur functions <a class="reference internal" href="qsym.html#ges" id="id3"><span>[Ges]</span></a>, Macdonald polynomials
<a class="reference internal" href="#hhl05" id="id4"><span>[HHL05]</span></a>, and plethysm of Schur functions <a class="reference internal" href="#lw12" id="id5"><span>[LW12]</span></a>.</p>
<p>For more background see <a class="reference external" href="https://en.wikipedia.org/wiki/Quasisymmetric_function">Wikipedia article Quasisymmetric_function</a>.</p>
<p>To begin, initialize the ring.  Below we chose to use the rational
numbers <span class="math notranslate nohighlight">\(\QQ\)</span>.  Other options include the integers <span class="math notranslate nohighlight">\(\ZZ\)</span> and <span class="math notranslate nohighlight">\(\CC\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QSym</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QSym</span>
<span class="go">Quasisymmetric functions over the Rational Field</span>

<span class="gp">sage: </span><span class="n">QSym</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">CC</span><span class="p">);</span> <span class="n">QSym</span>
<span class="go">Quasisymmetric functions over the Complex Field with 53 bits of precision</span>

<span class="gp">sage: </span><span class="n">QSym</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">ZZ</span><span class="p">);</span> <span class="n">QSym</span>
<span class="go">Quasisymmetric functions over the Integer Ring</span>
</pre></div>
</div>
<p>All bases of <span class="math notranslate nohighlight">\(QSym\)</span> are indexed by compositions e.g. <span class="math notranslate nohighlight">\([3,1,1,4]\)</span>. The
convention is to use capital letters for bases of <span class="math notranslate nohighlight">\(QSym\)</span> and lowercase
letters for bases of the symmetric functions <span class="math notranslate nohighlight">\(Sym\)</span>.  Next set up names for the
known bases by running <code class="docutils literal notranslate"><span class="pre">inject_shorthands()</span></code>. As with symmetric functions,
you do not need to run this command and you could assign these bases other
names.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QSym</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QSym</span><span class="o">.</span><span class="n">inject_shorthands</span><span class="p">()</span>
<span class="go">Defining M as shorthand for Quasisymmetric functions over the Rational Field in the Monomial basis</span>
<span class="go">Defining F as shorthand for Quasisymmetric functions over the Rational Field in the Fundamental basis</span>
<span class="go">Defining E as shorthand for Quasisymmetric functions over the Rational Field in the Essential basis</span>
<span class="go">Defining dI as shorthand for Quasisymmetric functions over the Rational Field in the dualImmaculate basis</span>
<span class="go">Defining QS as shorthand for Quasisymmetric functions over the Rational Field in the Quasisymmetric Schur basis</span>
<span class="go">Defining YQS as shorthand for Quasisymmetric functions over the Rational Field in the Young Quasisymmetric Schur basis</span>
<span class="go">Defining phi as shorthand for Quasisymmetric functions over the Rational Field in the phi basis</span>
<span class="go">Defining psi as shorthand for Quasisymmetric functions over the Rational Field in the psi basis</span>
</pre></div>
</div>
<p>Now one can start constructing quasisymmetric functions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is best to use variables other than <code class="docutils literal notranslate"><span class="pre">M</span></code> and <code class="docutils literal notranslate"><span class="pre">F</span></code>.</p>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">M[1, 2] + M[2, 1]</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span> <span class="n">y</span>
<span class="go">3*M[1, 2] + 2*M[3, 3] + M[6]</span>

<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">7*F[2, 1] + F[3, 1, 3]</span>

<span class="gp">sage: </span><span class="mi">3</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span>
<span class="go">F[1, 2, 2, 1] + F[1, 2, 3] + 2*F[1, 3, 2] + F[1, 4, 1] + F[1, 5] + 3*F[2, 1, 2]</span>
<span class="go"> + 2*F[2, 2, 2] + 2*F[2, 3, 1] + 2*F[2, 4] + F[3, 2, 1] + 3*F[3, 3] + 2*F[4, 2] + F[5, 1] + F[6]</span>
</pre></div>
</div>
<p>To convert from one basis to another is easy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">M[1, 2, 1]</span>

<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">-F[1, 1, 1, 1] + F[1, 2, 1]</span>

<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">M[1, 2, 1]</span>
</pre></div>
</div>
<p>To expand in variables, one can specify a finite size alphabet <span class="math notranslate nohighlight">\(x_1, x_2,
\ldots, x_m\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x0*x1^2*x2 + x0*x1^2*x3 + x0*x2^2*x3 + x1*x2^2*x3</span>
</pre></div>
</div>
<p>The usual methods on free modules are available such as coefficients,
degrees, and the support:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span> <span class="n">z</span>
<span class="go">3*M[1, 2] + 2*M[3, 3] + M[6]</span>

<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">coefficient</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">coefficients</span><span class="p">())</span>
<span class="go">[1, 2, 3]</span>

<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">monomials</span><span class="p">(),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">support</span><span class="p">())</span>
<span class="go">[M[1, 2], M[3, 3], M[6]]</span>

<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">monomial_coefficients</span><span class="p">()</span>
<span class="go">{[1, 2]: 3, [3, 3]: 2, [6]: 1}</span>
</pre></div>
</div>
<p>As with the symmetric functions package, the quasisymmetric function <code class="docutils literal notranslate"><span class="pre">1</span></code>
has several instantiations. However, the most obvious way to write <code class="docutils literal notranslate"><span class="pre">1</span></code>
leads to an error (this is due to the semantics of python):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">[[]]</span>
<span class="go">M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[]]</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[]</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">SyntaxError: invalid syntax</span>
</pre></div>
</div>
<section id="working-with-symmetric-functions">
<h2>Working with symmetric functions<a class="headerlink" href="#working-with-symmetric-functions" title="Permalink to this headline">¶</a></h2>
<p>The quasisymmetric functions are a ring which contains the symmetric
functions as a subring.  The Monomial quasisymmetric functions are
related to the monomial symmetric functions by <span class="math notranslate nohighlight">\(m_\lambda =
\sum_{\mathrm{sort}(c) = \lambda} M_c\)</span>, where <span class="math notranslate nohighlight">\(\mathrm{sort}(c)\)</span>
means the partition obtained by sorting the composition <span class="math notranslate nohighlight">\(c\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">SymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">inject_shorthands</span><span class="p">()</span>
<span class="go">Defining e as shorthand for Symmetric Functions over Rational Field in the elementary basis</span>
<span class="go">Defining f as shorthand for Symmetric Functions over Rational Field in the forgotten basis</span>
<span class="go">Defining h as shorthand for Symmetric Functions over Rational Field in the homogeneous basis</span>
<span class="go">Defining m as shorthand for Symmetric Functions over Rational Field in the monomial basis</span>
<span class="go">Defining p as shorthand for Symmetric Functions over Rational Field in the powersum basis</span>
<span class="go">Defining s as shorthand for Symmetric Functions over Rational Field in the Schur basis</span>

<span class="gp">sage: </span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">m[2, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">M[1, 2] + M[2, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">2*M[1, 1, 1] + M[1, 2] + M[2, 1]</span>
</pre></div>
</div>
<p>There are methods to test if an expression <span class="math notranslate nohighlight">\(f\)</span> in the quasisymmetric functions
is a symmetric function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(f\)</span> is symmetric, there are methods to convert <span class="math notranslate nohighlight">\(f\)</span> to an expression in the
symmetric functions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">to_symmetric_function</span><span class="p">()</span>
<span class="go">m[3, 1]</span>
</pre></div>
</div>
<p>The expansion of the Schur function in terms of the Fundamental quasisymmetric
functions is due to <a class="reference internal" href="qsym.html#ges" id="id6"><span>[Ges]</span></a>. There is one term in the expansion for each
standard tableau of shape equal to the partition indexing the Schur function.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">to_symmetric_function</span><span class="p">()</span>
<span class="go">5*m[1, 1, 1, 1, 1] + 3*m[2, 1, 1, 1] + 2*m[2, 2, 1] + m[3, 1, 1] + m[3, 2]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">to_symmetric_function</span><span class="p">())</span>
<span class="go">s[3, 2]</span>
</pre></div>
</div>
<p>It is also possible to convert any symmetric function to the quasisymmetric
function expansion in any known basis. The converse is not true:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">(</span> <span class="n">m</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="go">M[1, 1, 3] + M[1, 3, 1] + M[3, 1, 1]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span> <span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="go">F[1, 1, 2, 1] + F[1, 2, 1, 1] + F[1, 2, 2] + F[2, 1, 2] + F[2, 2, 1]</span>

<span class="gp">sage: </span><span class="n">s</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: do not know how to make x (= M[2, 1]) an element of self</span>
</pre></div>
</div>
<p>It is possible to experiment with the quasisymmetric function expansion of other
bases, but it is important that the base ring be the same for both algebras.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Qp</span> <span class="o">=</span> <span class="n">SymmetricFunctions</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">.</span><span class="n">hall_littlewood</span><span class="p">()</span><span class="o">.</span><span class="n">Qp</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">QSymt</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ft</span> <span class="o">=</span> <span class="n">QSymt</span><span class="o">.</span><span class="n">F</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ft</span><span class="p">(</span> <span class="n">Qp</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="go">F[1, 2, 1] + t*F[1, 3] + (t+1)*F[2, 2] + t*F[3, 1] + t^2*F[4]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Ht</span> <span class="o">=</span> <span class="n">SymmetricFunctions</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">macdonald</span><span class="p">()</span><span class="o">.</span><span class="n">Ht</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Fqt</span> <span class="o">=</span> <span class="n">QuasiSymmetricFunctions</span><span class="p">(</span><span class="n">Ht</span><span class="o">.</span><span class="n">base_ring</span><span class="p">())</span><span class="o">.</span><span class="n">F</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Fqt</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">q*t*F[1, 1, 1] + (q+t)*F[1, 2] + (q+t)*F[2, 1] + F[3]</span>
</pre></div>
</div>
<p>The following will raise an error because the base ring of <code class="docutils literal notranslate"><span class="pre">F</span></code> is not
equal to the base ring of <code class="docutils literal notranslate"><span class="pre">Ht</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: do not know how to make x (= McdHt[2, 1]) an element of self (=Quasisymmetric functions over the Rational Field in the Fundamental basis)</span>
</pre></div>
</div>
</section>
<section id="qsym-is-a-hopf-algebra">
<h2>QSym is a Hopf algebra<a class="headerlink" href="#qsym-is-a-hopf-algebra" title="Permalink to this headline">¶</a></h2>
<p>The product on <span class="math notranslate nohighlight">\(QSym\)</span> is commutative and is inherited from the
product by the realization within the polynomial ring:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">M[1, 1, 3] + M[1, 3, 1] + M[1, 4] + M[3, 1, 1] + M[4, 1]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">F[1, 1, 3] + F[1, 2, 2] + F[1, 3, 1] + F[1, 4] + F[2, 1, 2] + F[2, 2, 1] + F[2, 3] + F[3, 1, 1] + F[3, 2] + F[4, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">M[1, 1, 3] + M[1, 3, 1] + M[1, 4] + M[2, 3] + M[3, 1, 1] + M[3, 2] + M[4, 1] + M[5]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">F[1, 1, 1, 2] - F[1, 2, 2] + F[2, 1, 1, 1] - F[2, 1, 2] - F[2, 2, 1] + F[5]</span>
</pre></div>
</div>
<p>There is a coproduct on this ring as well, which in the Monomial basis acts by
cutting the composition into a left half and a right half. The co-product is
non-co-commutative:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">M[] # M[1, 3, 1] + M[1] # M[3, 1] + M[1, 3] # M[1] + M[1, 3, 1] # M[]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">F[] # F[1, 3, 1] + F[1] # F[3, 1] + F[1, 1] # F[2, 1] + F[1, 2] # F[1, 1] + F[1, 3] # F[1] + F[1, 3, 1] # F[]</span>
</pre></div>
</div>
<p class="rubric">The Duality Pairing with Non-Commutative Symmetric Functions</p>
<p>These two operations endow <span class="math notranslate nohighlight">\(QSym\)</span> with the structure of a Hopf algebra. It is
the dual Hopf algebra of the non-commutative symmetric functions <span class="math notranslate nohighlight">\(NCSF\)</span>. Under
this duality, the Monomial basis of <span class="math notranslate nohighlight">\(QSym\)</span> is dual to the Complete basis of
<span class="math notranslate nohighlight">\(NCSF\)</span>, and the Fundamental basis of <span class="math notranslate nohighlight">\(QSym\)</span> is dual to the Ribbon basis of
<span class="math notranslate nohighlight">\(NCSF\)</span> (see <a class="reference internal" href="qsym.html#mr" id="id7"><span>[MR]</span></a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">dual</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Non-Commutative Symmetric Functions over the Rational Field in the Complete basis</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">duality_pairing_matrix</span><span class="p">(</span> <span class="n">S</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span>
<span class="go">[1 0 0 0 0 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0]</span>
<span class="go">[0 0 0 1 0 0 0 0]</span>
<span class="go">[0 0 0 0 1 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">duality_pairing_matrix</span><span class="p">(</span> <span class="n">S</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span>
<span class="go">[1 0 0 0 0 0 0 0]</span>
<span class="go">[1 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 1 0 0 0 0 0]</span>
<span class="go">[1 1 1 1 0 0 0 0]</span>
<span class="go">[1 0 0 0 1 0 0 0]</span>
<span class="go">[1 1 0 0 1 1 0 0]</span>
<span class="go">[1 0 1 0 1 0 1 0]</span>
<span class="go">[1 1 1 1 1 1 1 1]</span>
<span class="gp">sage: </span><span class="n">NCSF</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">realization_of</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">NCSF</span><span class="o">.</span><span class="n">Ribbon</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">duality_pairing_matrix</span><span class="p">(</span> <span class="n">R</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span>
<span class="go">[1 0 0 0 0 0 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0]</span>
<span class="go">[0 0 0 1 0 0 0 0]</span>
<span class="go">[0 0 0 0 1 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">duality_pairing_matrix</span><span class="p">(</span> <span class="n">R</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">4</span> <span class="p">)</span>
<span class="go">[ 1  0  0  0  0  0  0  0]</span>
<span class="go">[-1  1  0  0  0  0  0  0]</span>
<span class="go">[-1  0  1  0  0  0  0  0]</span>
<span class="go">[ 1 -1 -1  1  0  0  0  0]</span>
<span class="go">[-1  0  0  0  1  0  0  0]</span>
<span class="go">[ 1 -1  0  0 -1  1  0  0]</span>
<span class="go">[ 1  0 -1  0 -1  0  1  0]</span>
<span class="go">[-1  1  1 -1  1 -1 -1  1]</span>
</pre></div>
</div>
<p>Let <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(G\)</span> be elements of <span class="math notranslate nohighlight">\(QSym\)</span> and <span class="math notranslate nohighlight">\(h\)</span> an element of <span class="math notranslate nohighlight">\(NCSF\)</span>. Then if
we represent the duality pairing with the mathematical notation <span class="math notranslate nohighlight">\([ \cdot,
\cdot ]\)</span>, we have:</p>
<div class="math notranslate nohighlight">
\[[H \cdot G, h] = [H \otimes G, \Delta(h)].\]</div>
<p>For example, the coefficient of <code class="docutils literal notranslate"><span class="pre">M[2,1,4,1]</span></code> in <code class="docutils literal notranslate"><span class="pre">M[1,3]*M[2,1,1]</span></code> may be
computed with the duality pairing:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span><span class="p">,</span> <span class="n">J</span> <span class="o">=</span> <span class="n">Composition</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]),</span> <span class="n">Composition</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">*</span><span class="n">M</span><span class="p">[</span><span class="n">J</span><span class="p">])</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>And the coefficient of <code class="docutils literal notranslate"><span class="pre">S[1,3]</span> <span class="pre">#</span> <span class="pre">S[2,1,1]</span></code> in <code class="docutils literal notranslate"><span class="pre">S[2,1,4,1].coproduct()</span></code> is
equal to this result:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">S[] # S[2, 1, 4, 1] + ... + S[1, 3] # S[2, 1, 1] + ... + S[4, 1] # S[2, 1]</span>
</pre></div>
</div>
<p>The duality pairing on the tensor space is another way of getting this
coefficient, but currently the method
<a class="reference internal" href="generic_basis_code.html#sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ParentMethods.duality_pairing" title="sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ParentMethods.duality_pairing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">duality_pairing()</span></code></a>
is not defined on the tensor squared space. However, we can extend this
functionality by applying a linear morphism to the terms in the coproduct,
as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">linear_morphism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">M</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">apply_multilinear_morphism</span><span class="p">(</span><span class="n">linear_morphism</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Similarly, if <span class="math notranslate nohighlight">\(H\)</span> is an element of <span class="math notranslate nohighlight">\(QSym\)</span> and <span class="math notranslate nohighlight">\(g\)</span> and <span class="math notranslate nohighlight">\(h\)</span> are elements of
<span class="math notranslate nohighlight">\(NCSF\)</span>, then</p>
<div class="math notranslate nohighlight">
\[[ H, g \cdot h ] = [ \Delta(H), g \otimes h ].\]</div>
<p>For example, the coefficient of <code class="docutils literal notranslate"><span class="pre">R[2,3,1]</span></code> in <code class="docutils literal notranslate"><span class="pre">R[2,1]*R[2,1]</span></code> is computed
with the duality pairing by the following command:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">R[2, 1, 2, 1] + R[2, 3, 1]</span>
</pre></div>
</div>
<p>This coefficient should then be equal to the coefficient of <code class="docutils literal notranslate"><span class="pre">F[2,1]</span> <span class="pre">#</span> <span class="pre">F[2,1]</span></code>
in <code class="docutils literal notranslate"><span class="pre">F[2,3,1].coproduct()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">F[] # F[2, 3, 1] + ... + F[2, 1] # F[2, 1]  + ... + F[2, 3, 1] # F[]</span>
</pre></div>
</div>
<p>This can also be computed by the duality pairing on the tensor space,
as above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">linear_morphism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="n">y</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">apply_multilinear_morphism</span><span class="p">(</span><span class="n">linear_morphism</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p class="rubric">The Operation Adjoint to Multiplication by a Non-Commutative Symmetric Function</p>
<p>Let <span class="math notranslate nohighlight">\(g \in NCSF\)</span> and consider the linear endomorphism of <span class="math notranslate nohighlight">\(NCSF\)</span> defined by
left (respectively, right) multiplication by <span class="math notranslate nohighlight">\(g\)</span>. Since there is a duality
between <span class="math notranslate nohighlight">\(QSym\)</span> and <span class="math notranslate nohighlight">\(NCSF\)</span>, this linear transformation induces an operator
<span class="math notranslate nohighlight">\(g^\perp\)</span> on <span class="math notranslate nohighlight">\(QSym\)</span> satisfying</p>
<div class="math notranslate nohighlight">
\[[ g^\perp(H), h ] = [ H, g \cdot h ].\]</div>
<p>for any non-commutative symmetric function <span class="math notranslate nohighlight">\(h\)</span>.</p>
<p>This is implemented by the method
<a class="reference internal" href="generic_basis_code.html#sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ElementMethods.skew_by" title="sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ElementMethods.skew_by"><code class="xref py py-meth docutils literal notranslate"><span class="pre">skew_by()</span></code></a>.
Explicitly, if <code class="docutils literal notranslate"><span class="pre">H</span></code> is a quasisymmetric function and <code class="docutils literal notranslate"><span class="pre">g</span></code>
a non-commutative symmetric function, then <code class="docutils literal notranslate"><span class="pre">H.skew_by(g)</span></code> and
<code class="docutils literal notranslate"><span class="pre">H.skew_by(g,</span> <span class="pre">side='right')</span></code> are expressions that satisfy,
for any non-commutative symmetric function <code class="docutils literal notranslate"><span class="pre">h</span></code>, the following
identities:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">H.skew_by(g).duality_pairing(h) == H.duality_pairing(g*h)</span>
<span class="go">H.skew_by(g, side=&#39;right&#39;).duality_pairing(h) == H.duality_pairing(h*g)</span>
</pre></div>
</div>
<p>For example, <code class="docutils literal notranslate"><span class="pre">M[J].skew_by(S[I])</span></code> is <span class="math notranslate nohighlight">\(0\)</span> unless the composition <span class="math notranslate nohighlight">\(J\)</span>
begins with <span class="math notranslate nohighlight">\(I\)</span> and <code class="docutils literal notranslate"><span class="pre">M(J).skew_by(S(I),</span> <span class="pre">side='right')</span></code> is <span class="math notranslate nohighlight">\(0\)</span> unless
the composition <span class="math notranslate nohighlight">\(J\)</span> ends with <span class="math notranslate nohighlight">\(I\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">skew_by</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="go">M[2, 2]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">skew_by</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span><span class="o">.</span><span class="n">apply_multilinear_morphism</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">duality_pairing</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">*</span><span class="n">y</span> <span class="p">)</span>
<span class="go">M[2, 2]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">skew_by</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">skew_by</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">M[3, 2]</span>
</pre></div>
</div>
<p class="rubric">The antipode</p>
<p>The antipode sends the Fundamental basis element indexed by the
composition <span class="math notranslate nohighlight">\(I\)</span> to <span class="math notranslate nohighlight">\(-1\)</span> to the size of <span class="math notranslate nohighlight">\(I\)</span> times the Fundamental
basis element indexed by the conjugate composition to <span class="math notranslate nohighlight">\(I\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>
<span class="go">-F[1, 2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">Composition</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">[1, 2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>
<span class="go">-M[2, 2, 3] - M[2, 5] - M[4, 3] - M[7]</span>
</pre></div>
</div>
<p>We demonstrate here the defining relation of the antipode:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">F</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">apply_multilinear_morphism</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">.</span><span class="n">antipode</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">apply_multilinear_morphism</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<dl class="citation">
<dt class="label" id="hhl05"><span class="brackets"><a class="fn-backref" href="#id4">HHL05</a></span></dt>
<dd><p><em>A combinatorial formula for Macdonald polynomials</em>.
Haiman, Haglund, and Loehr.
J. Amer. Math. Soc. 18 (2005), no. 3, 735-761.</p>
</dd>
<dt class="label" id="lw12"><span class="brackets"><a class="fn-backref" href="#id5">LW12</a></span></dt>
<dd><p><em>Quasisymmetric expansions of Schur-function plethysms</em>.
Loehr and Warrington.
Proc. Amer. Math. Soc. 140 (2012), no. 4, 1159-1171.</p>
</dd>
<dt class="label" id="kt97"><span class="brackets">KT97</span></dt>
<dd><p><em>Noncommutative symmetric functions IV: Quantum linear groups and
Hecke algebras at</em> <span class="math notranslate nohighlight">\(q = 0\)</span>.
Krob and Thibon.
Journal of Algebraic Combinatorics 6 (1997), 339-376.</p>
</dd>
</dl>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction to Quasisymmetric Functions</a><ul>
<li><a class="reference internal" href="#working-with-symmetric-functions">Working with symmetric functions</a></li>
<li><a class="reference internal" href="#qsym-is-a-hopf-algebra">QSym is a Hopf algebra</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="qsym.html"
                        title="previous chapter">Quasisymmetric functions</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../ncsym/__init__.html"
                        title="next chapter">Symmetric Functions in Non-Commuting Variables</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/ncsf_qsym/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ncsym/__init__.html" title="Symmetric Functions in Non-Commuting Variables"
             >next</a> |</li>
        <li class="right" >
          <a href="qsym.html" title="Quasisymmetric functions"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Introduction to Quasisymmetric Functions</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>