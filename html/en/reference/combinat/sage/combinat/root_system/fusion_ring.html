
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Fusion Rings &#8212; Sage 9.5 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Weyl Groups" href="weyl_group.html" />
    <link rel="prev" title="Weyl Character Rings" href="weyl_characters.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_group.html" title="Weyl Groups"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.5 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module List</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fusion Rings</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="fusion-rings">
<span id="sage-combinat-root-system-fusion-ring"></span><h1>Fusion Rings<a class="headerlink" href="#fusion-rings" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.root_system.fusion_ring"></span><dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.root_system.fusion_ring.</span></span><span class="sig-name descname"><span class="pre">FusionRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">ct</span></em>, <em class="sig-param"><span class="pre">base_ring=Integer</span> <span class="pre">Ring</span></em>, <em class="sig-param"><span class="pre">prefix=None</span></em>, <em class="sig-param"><span class="pre">style='lattice'</span></em>, <em class="sig-param"><span class="pre">k=None</span></em>, <em class="sig-param"><span class="pre">conjugate=False</span></em>, <em class="sig-param"><span class="pre">cyclotomic_order=None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="weyl_characters.html#sage.combinat.root_system.weyl_characters.WeylCharacterRing" title="sage.combinat.root_system.weyl_characters.WeylCharacterRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.root_system.weyl_characters.WeylCharacterRing</span></code></a></p>
<p>Return the Fusion Ring (Verlinde Algebra) of level <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ct</span></code> – the Cartan type of a simple (finite-dimensional) Lie algebra</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a nonnegative integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">conjugate</span></code> – (default <code class="docutils literal notranslate"><span class="pre">False</span></code>) set <code class="docutils literal notranslate"><span class="pre">True</span></code> to obtain
the complex conjugate ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cyclotomic_order</span></code> – (default computed depending on <code class="docutils literal notranslate"><span class="pre">ct</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code>)</p></li>
</ul>
<p>The cyclotomic order is an integer <span class="math notranslate nohighlight">\(N\)</span> such that all computations
will return elements of the cyclotomic field of <span class="math notranslate nohighlight">\(N\)</span>-th roots of unity.
Normally you will never need to change this but consider changing it
if <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.root_of_unity" title="sage.combinat.root_system.fusion_ring.FusionRing.root_of_unity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_of_unity()</span></code></a> ever returns <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This algebra has a basis (sometimes called <em>primary fields</em> but here
called <em>simple objects</em>) indexed by the weights of level <span class="math notranslate nohighlight">\(\leq k\)</span>.
These arise as the fusion algebras of Wess-Zumino-Witten (WZW) conformal
field theories, or as Grothendieck groups of tilting modules for quantum
groups at roots of unity. The <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing" title="sage.combinat.root_system.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a> class is implemented as
a variant of the <a class="reference internal" href="weyl_characters.html#sage.combinat.root_system.weyl_characters.WeylCharacterRing" title="sage.combinat.root_system.weyl_characters.WeylCharacterRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeylCharacterRing</span></code></a>.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#baki2001" id="id1"><span>[BaKi2001]</span></a> Chapter 3</p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#dfms1996" id="id2"><span>[DFMS1996]</span></a> Chapter 16</p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#egno2015" id="id3"><span>[EGNO2015]</span></a> Chapter 8</p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#feingold2004" id="id4"><span>[Feingold2004]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#fuchs1994" id="id5"><span>[Fuchs1994]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#row2006" id="id6"><span>[Row2006]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#walton1990" id="id7"><span>[Walton1990]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#wan2010" id="id8"><span>[Wan2010]</span></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">]</span> <span class="o">=</span> <span class="n">A22</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="p">[</span><span class="n">A22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">f1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">f1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">f2</span><span class="p">,</span> <span class="n">f1</span><span class="o">+</span><span class="n">f2</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">M</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">M</span><span class="p">]</span>
<span class="go">[A22(1,1),</span>
<span class="go"> A22(0,1),</span>
<span class="go"> A22(1,0),</span>
<span class="go"> A22(0,0) + A22(1,1),</span>
<span class="go"> A22(0,1) + A22(2,0),</span>
<span class="go"> A22(1,0) + A22(0,2)]</span>
</pre></div>
</div>
<p>You may assign your own labels to the basis elements. In the next
example, we create the <span class="math notranslate nohighlight">\(SO(5)\)</span> fusion ring of level <span class="math notranslate nohighlight">\(2\)</span>, check the
weights of the basis elements, then assign new labels to them while
injecting them into the global namespace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">B22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">get_order</span><span class="p">()];</span> <span class="n">b</span>
<span class="go">[B22(0,0), B22(1,0), B22(0,1), B22(2,0), B22(1,1), B22(0,2)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[(0, 0), (1, 0), (1/2, 1/2), (2, 0), (3/2, 1/2), (1, 1)]</span>
<span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">([</span><span class="s1">&#39;I0&#39;</span><span class="p">,</span><span class="s1">&#39;Y1&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="s1">&#39;Xp&#39;</span><span class="p">,</span><span class="s1">&#39;Y2&#39;</span><span class="p">],</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">B22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">get_order</span><span class="p">()];</span> <span class="n">b</span>
<span class="go">[I0, Y1, X, Z, Xp, Y2]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[(I0, (0, 0)),</span>
<span class="go"> (Y1, (1, 0)),</span>
<span class="go"> (X, (1/2, 1/2)),</span>
<span class="go"> (Z, (2, 0)),</span>
<span class="go"> (Xp, (3/2, 1/2)),</span>
<span class="go"> (Y2, (1, 1))]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">*</span> <span class="n">Y1</span>
<span class="go">X + Xp</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">*</span> <span class="n">Z</span>
<span class="go">I0</span>
</pre></div>
</div>
<p>A fixed order of the basis keys is available with <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.get_order" title="sage.combinat.root_system.fusion_ring.FusionRing.get_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_order()</span></code></a>.
This is the order used by methods such as <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_matrix" title="sage.combinat.root_system.fusion_ring.FusionRing.s_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_matrix()</span></code></a>. You may
use <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule.set_order" title="sage.combinat.free_module.CombinatorialFreeModule.set_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinatorialFreeModule.set_order()</span></code></a> to reorder the basis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">set_order</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="n">I0</span><span class="p">,</span><span class="n">Y1</span><span class="p">,</span><span class="n">Y2</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Xp</span><span class="p">,</span><span class="n">Z</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">get_order</span><span class="p">()]</span>
<span class="go">[I0, Y1, Y2, X, Xp, Z]</span>
</pre></div>
</div>
<p>To reset the labels, you may run <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.fusion_labels" title="sage.combinat.root_system.fusion_ring.FusionRing.fusion_labels"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fusion_labels()</span></code></a> with no parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">get_order</span><span class="p">()]</span>
<span class="go">[B22(0,0), B22(1,0), B22(0,2), B22(0,1), B22(1,1), B22(2,0)]</span>
</pre></div>
</div>
<p>To reset the order to the default, simply set it to the list of basis
element keys:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">set_order</span><span class="p">(</span><span class="n">B22</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B22</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">get_order</span><span class="p">()]</span>
<span class="go">[B22(0,0), B22(1,0), B22(0,1), B22(2,0), B22(1,1), B22(0,2)]</span>
</pre></div>
</div>
<p>The fusion ring has a number of methods that reflect its role
as the Grothendieck ring of a <em>modular tensor category</em> (MTC). These
include twist methods <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.twist" title="sage.combinat.root_system.fusion_ring.FusionRing.Element.twist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Element.twist()</span></code></a> and <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon" title="sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Element.ribbon()</span></code></a>
for its elements related to the ribbon structure, and the 
S-matrix <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_ij" title="sage.combinat.root_system.fusion_ring.FusionRing.s_ij"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_ij()</span></code></a>.</p>
<p>There are two natural normalizations of the S-matrix. Both
are explained in Chapter 3 of <a class="reference internal" href="../../../../references/index.html#baki2001" id="id9"><span>[BaKi2001]</span></a>. The one that is computed
by the method <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_matrix" title="sage.combinat.root_system.fusion_ring.FusionRing.s_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_matrix()</span></code></a>, or whose individual entries
are computed by <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_ij" title="sage.combinat.root_system.fusion_ring.FusionRing.s_ij"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_ij()</span></code></a> is denoted <span class="math notranslate nohighlight">\(\tilde{s}\)</span> in
<a class="reference internal" href="../../../../references/index.html#baki2001" id="id10"><span>[BaKi2001]</span></a>. It is not unitary.</p>
<p>The unitary S-matrix is <span class="math notranslate nohighlight">\(s=D^{-1/2}\tilde{s}\)</span> where</p>
<div class="math notranslate nohighlight">
\[D = \sum_V d_i(V)^2.\]</div>
<p>The sum is over all simple objects <span class="math notranslate nohighlight">\(V\)</span> with
<span class="math notranslate nohighlight">\(d_i(V)\)</span> the <em>quantum dimension</em>. We will call quantity <span class="math notranslate nohighlight">\(D\)</span>
the <em>global quantum dimension</em> and <span class="math notranslate nohighlight">\(\sqrt{D}\)</span> the
<em>total quantum order</em>. They are  computed by <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension" title="sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension"><code class="xref py py-meth docutils literal notranslate"><span class="pre">global_q_dimension()</span></code></a>
and <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.total_q_order" title="sage.combinat.root_system.fusion_ring.FusionRing.total_q_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">total_q_order()</span></code></a>. The unitary S-matrix <span class="math notranslate nohighlight">\(s\)</span> may be obtained
using <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_matrix" title="sage.combinat.root_system.fusion_ring.FusionRing.s_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">s_matrix()</span></code></a> with the option <code class="docutils literal notranslate"><span class="pre">unitary=True</span></code>.</p>
<p>Let us check the Verlinde formula, which is <a class="reference internal" href="../../../../references/index.html#dfms1996" id="id11"><span>[DFMS1996]</span></a> (16.3). This
famous identity states that</p>
<div class="math notranslate nohighlight">
\[N^k_{ij} = \sum_l \frac{s(i,\ell)\,s(j,\ell)\,\overline{s(k,\ell)}}{s(I,\ell)},\]</div>
<p>where <span class="math notranslate nohighlight">\(N^k_{ij}\)</span> are the fusion coefficients, i.e. the structure
constants of the fusion ring, and <code class="docutils literal notranslate"><span class="pre">I</span></code> is the unit object.
The S-matrix has the property that if <span class="math notranslate nohighlight">\(i*\)</span> denotes the dual
object of <span class="math notranslate nohighlight">\(i\)</span>, implemented in Sage as <code class="docutils literal notranslate"><span class="pre">i.dual()</span></code>, then</p>
<div class="math notranslate nohighlight">
\[s(i*,j) = s(i,j*) = \overline{s(i,j)}.\]</div>
<p>This is equation (16.5) in <a class="reference internal" href="../../../../references/index.html#dfms1996" id="id12"><span>[DFMS1996]</span></a>. Thus with <span class="math notranslate nohighlight">\(N_{ijk}=N^{k*}_{ij}\)</span>
the Verlinde formula is equivalent to</p>
<div class="math notranslate nohighlight">
\[N_{ijk} = \sum_l \frac{s(i,\ell)\,s(j,\ell)\,s(k,\ell)}{s(I,\ell)},\]</div>
<p>In this formula <span class="math notranslate nohighlight">\(s\)</span> is the normalized unitary S-matrix
denoted <span class="math notranslate nohighlight">\(s\)</span> in <a class="reference internal" href="../../../../references/index.html#baki2001" id="id13"><span>[BaKi2001]</span></a>. We may define a function that
corresponds to the right-hand side, except using
<span class="math notranslate nohighlight">\(\tilde{s}\)</span> instead of <span class="math notranslate nohighlight">\(s\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">V</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">R</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">s_ij</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">s_ij</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">s_ij</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="o">/</span> <span class="n">R</span><span class="o">.</span><span class="n">s_ij</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">one</span><span class="p">(),</span><span class="n">l</span><span class="p">)</span>
<span class="gp">....: </span>               <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span>
</pre></div>
</div>
<p>This does not produce <code class="docutils literal notranslate"><span class="pre">self.N_ijk(i,j,k)</span></code> exactly, because of the
missing normalization factor. The following code to check the
Verlinde formula takes this into account:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">test_verlinde</span><span class="p">(</span><span class="n">R</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">b0</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span><span class="n">V</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="n">c</span> <span class="o">*</span> <span class="n">R</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">....: </span>               <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">R</span><span class="o">.</span><span class="n">basis</span><span class="p">())</span>
</pre></div>
</div>
<p>Every fusion ring should pass this test:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">test_verlinde</span><span class="p">(</span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">test_verlinde</span><span class="p">(</span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B4&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># long time (.56s)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As an exercise, the reader may verify the examples in
Section 5.3 of <a class="reference internal" href="../../../../references/index.html#rostwa2009" id="id14"><span>[RoStWa2009]</span></a>. Here we check the example
of the Ising modular tensor category, which is related
to the BPZ minimal model <span class="math notranslate nohighlight">\(M(4,3)\)</span> or to an <span class="math notranslate nohighlight">\(E_8\)</span> coset
model. See <a class="reference internal" href="../../../../references/index.html#dfms1996" id="id15"><span>[DFMS1996]</span></a> Sections 7.4.2 and 18.4.1.
<a class="reference internal" href="../../../../references/index.html#rostwa2009" id="id16"><span>[RoStWa2009]</span></a> Example 5.3.4 tells us how to
construct it as the conjugate of the <span class="math notranslate nohighlight">\(E_8\)</span> level 2
<a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing" title="sage.combinat.root_system.fusion_ring.FusionRing"><code class="xref py py-class docutils literal notranslate"><span class="pre">FusionRing</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">conjugate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">([</span><span class="s2">&quot;i0&quot;</span><span class="p">,</span><span class="s2">&quot;p&quot;</span><span class="p">,</span><span class="s2">&quot;s&quot;</span><span class="p">],</span><span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">I</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">b</span>
<span class="go">[i0, p, s]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[[i0, p, s], [p, i0, s], [s, s, i0 + p]]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[0, 1, 1/8]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">ribbon</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[1, -1, zeta128^8]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">i0</span><span class="p">),</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">i0</span><span class="p">),</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">),</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">)]]</span>
<span class="go">[-zeta128^56, -1, -zeta128^32, -zeta128^32, zeta128^24]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">i0</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">total_q_order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">q_dimension</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[1, 1, 2]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">s_matrix</span><span class="p">()</span>
<span class="go">[                       1                        1 -zeta128^48 + zeta128^16]</span>
<span class="go">[                       1                        1  zeta128^48 - zeta128^16]</span>
<span class="go">[-zeta128^48 + zeta128^16  zeta128^48 - zeta128^16                        0]</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">s_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1 1 2]</span>
<span class="go">[1 1 2]</span>
<span class="go">[2 2 0]</span>
</pre></div>
</div>
<p>The term <em>modular tensor category</em> refers to the fact that associated
with the category there is a projective representation of the modular
group <span class="math notranslate nohighlight">\(SL(2,\ZZ)\)</span>. We recall that this group is generated by</p>
<div class="math notranslate nohighlight">
\[\begin{split}S = \begin{pmatrix} &amp; -1\\1\end{pmatrix},\qquad
T = \begin{pmatrix} 1 &amp; 1\\ &amp;1 \end{pmatrix}\end{split}\]</div>
<p>subject to the relations <span class="math notranslate nohighlight">\((ST)^3 = S^2\)</span>, <span class="math notranslate nohighlight">\(S^2T = TS^2\)</span>, and <span class="math notranslate nohighlight">\(S^4 = I\)</span>.
Let <span class="math notranslate nohighlight">\(s\)</span> be the normalized S-matrix, and
<span class="math notranslate nohighlight">\(t\)</span> the diagonal matrix whose entries are the twists of the simple
objects. Let <span class="math notranslate nohighlight">\(s\)</span> the unitary S-matrix and <span class="math notranslate nohighlight">\(t\)</span> the matrix of twists,
and <span class="math notranslate nohighlight">\(C\)</span> the conjugation matrix <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.conj_matrix" title="sage.combinat.root_system.fusion_ring.FusionRing.conj_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">conj_matrix()</span></code></a>. Let</p>
<div class="math notranslate nohighlight">
\[D_+ = \sum_i d_i^2 \theta_i, \qquad D_- = d_i^2 \theta_i^{-1},\]</div>
<p>where <span class="math notranslate nohighlight">\(d_i\)</span> and <span class="math notranslate nohighlight">\(\theta_i\)</span> are the quantum dimensions and twists of the
simple objects. Let <span class="math notranslate nohighlight">\(c\)</span> be the Virasoro central charge, a rational number
that is computed in <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.virasoro_central_charge" title="sage.combinat.root_system.fusion_ring.FusionRing.virasoro_central_charge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">virasoro_central_charge()</span></code></a>. It is known that</p>
<div class="math notranslate nohighlight">
\[\sqrt{\frac{D_+}{D_-}} = e^{i\pi c/4}.\]</div>
<p>It is proved in <a class="reference internal" href="../../../../references/index.html#baki2001" id="id17"><span>[BaKi2001]</span></a> Equation (3.1.17) that</p>
<div class="math notranslate nohighlight">
\[(st)^3 = e^{i\pi c/4} s^2, \qquad
s^2 = C, \qquad C^2 = 1, \qquad Ct = tC.\]</div>
<p>Therefore <span class="math notranslate nohighlight">\(S \mapsto s, T \mapsto t\)</span> is a projective representation
of <span class="math notranslate nohighlight">\(SL(2, \ZZ)\)</span>. Let us confirm these identities for the Fibonacci MTC
<code class="docutils literal notranslate"><span class="pre">FusionRing(&quot;G2&quot;,</span> <span class="pre">1)</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">s_matrix</span><span class="p">(</span><span class="n">unitary</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">twists_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">conj_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">virasoro_central_charge</span><span class="p">();</span> <span class="n">c</span>
<span class="go">14/5</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">S</span><span class="o">*</span><span class="n">T</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="n">S</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">C</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">*</span><span class="n">T</span> <span class="o">==</span> <span class="n">T</span><span class="o">*</span><span class="n">C</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.D_minus">
<span class="sig-name descname"><span class="pre">D_minus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.D_minus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(\sum d_i^2\theta_i^{-1}\)</span> where <span class="math notranslate nohighlight">\(i\)</span> runs through the simple
objects, <span class="math notranslate nohighlight">\(d_i\)</span> is the quantum dimension and <span class="math notranslate nohighlight">\(\theta_i\)</span> is the twist.</p>
<p>This is denoted <span class="math notranslate nohighlight">\(p_-\)</span> in <a class="reference internal" href="../../../../references/index.html#baki2001" id="id18"><span>[BaKi2001]</span></a> Chapter 3.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E83</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">conjugate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Dp</span><span class="p">,</span><span class="n">Dm</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">E83</span><span class="o">.</span><span class="n">D_plus</span><span class="p">(),</span> <span class="n">E83</span><span class="o">.</span><span class="n">D_minus</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">Dp</span><span class="o">*</span><span class="n">Dm</span> <span class="o">==</span> <span class="n">E83</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">E83</span><span class="o">.</span><span class="n">virasoro_central_charge</span><span class="p">();</span> <span class="n">c</span>
<span class="go">-248/11</span>
<span class="gp">sage: </span><span class="n">Dp</span><span class="o">*</span><span class="n">Dm</span> <span class="o">==</span> <span class="n">E83</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.D_plus">
<span class="sig-name descname"><span class="pre">D_plus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.D_plus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(\sum d_i^2\theta_i\)</span> where <span class="math notranslate nohighlight">\(i\)</span> runs through the simple objects,
<span class="math notranslate nohighlight">\(d_i\)</span> is the quantum dimension and <span class="math notranslate nohighlight">\(\theta_i\)</span> is the twist.</p>
<p>This is denoted <span class="math notranslate nohighlight">\(p_+\)</span> in <a class="reference internal" href="../../../../references/index.html#baki2001" id="id19"><span>[BaKi2001]</span></a> Chapter 3.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B31</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B3&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Dp</span> <span class="o">=</span> <span class="n">B31</span><span class="o">.</span><span class="n">D_plus</span><span class="p">();</span> <span class="n">Dp</span>
<span class="go">2*zeta48^13 - 2*zeta48^5</span>
<span class="gp">sage: </span><span class="n">Dm</span> <span class="o">=</span> <span class="n">B31</span><span class="o">.</span><span class="n">D_minus</span><span class="p">();</span> <span class="n">Dm</span>
<span class="go">-2*zeta48^3</span>
<span class="gp">sage: </span><span class="n">Dp</span><span class="o">*</span><span class="n">Dm</span> <span class="o">==</span> <span class="n">B31</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">B31</span><span class="o">.</span><span class="n">virasoro_central_charge</span><span class="p">();</span> <span class="n">c</span>
<span class="go">7/2</span>
<span class="gp">sage: </span><span class="n">Dp</span><span class="o">/</span><span class="n">Dm</span> <span class="o">==</span> <span class="n">B31</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="weyl_characters.html#sage.combinat.root_system.weyl_characters.WeylCharacterRing.Element" title="sage.combinat.root_system.weyl_characters.WeylCharacterRing.Element"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.root_system.weyl_characters.WeylCharacterRing.Element</span></code></a></p>
<p>A class for FusionRing elements.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element.is_simple_object">
<span class="sig-name descname"><span class="pre">is_simple_object</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.is_simple_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a simple object of the fusion ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">A22</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">x</span>
<span class="go">A22(1,0)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_simple_object</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="go">A22(0,1) + A22(2,0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_simple_object</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element.q_dimension">
<span class="sig-name descname"><span class="pre">q_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.q_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quantum dimension as an element of the cyclotomic
field of the <span class="math notranslate nohighlight">\(2\ell\)</span>-th roots of unity, where <span class="math notranslate nohighlight">\(l = m (k+h^\vee)\)</span>
with <span class="math notranslate nohighlight">\(m=1,2,3\)</span> depending on whether type is simply, doubly or
triply laced, <span class="math notranslate nohighlight">\(k\)</span> is the level and <span class="math notranslate nohighlight">\(h^\vee\)</span> is the dual
Coxeter number.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">b</span><span class="o">.</span><span class="n">q_dimension</span><span class="p">())</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">B22</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, 4, 5, 1, 5, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon">
<span class="sig-name descname"><span class="pre">ribbon</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the twist or ribbon element of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>If <span class="math notranslate nohighlight">\(h\)</span> is the rational number modulo 2 produced by
<code class="docutils literal notranslate"><span class="pre">self.twist()</span></code>, this  method produces <span class="math notranslate nohighlight">\(e^{i\pi h}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>An additive version of this is available as <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.twist" title="sage.combinat.root_system.fusion_ring.FusionRing.Element.twist"><code class="xref py py-meth docutils literal notranslate"><span class="pre">twist()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 3/10, 4/5, 3/2]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">ribbon</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">F</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, zeta40^6, zeta40^12 - zeta40^8 + zeta40^4 - 1, -zeta40^10]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">[1, zeta40^6, zeta40^12 - zeta40^8 + zeta40^4 - 1, -zeta40^10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element.twist">
<span class="sig-name descname"><span class="pre">twist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">reduced</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.twist" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a rational number <span class="math notranslate nohighlight">\(h\)</span> such that <span class="math notranslate nohighlight">\(\theta = e^{i \pi h}\)</span> 
is the twist of <code class="docutils literal notranslate"><span class="pre">self</span></code>. The quantity <span class="math notranslate nohighlight">\(e^{i \pi h}\)</span> is
also available using <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon" title="sage.combinat.root_system.fusion_ring.FusionRing.Element.ribbon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ribbon()</span></code></a>.</p>
<p>This method is only available for simple objects. If
<span class="math notranslate nohighlight">\(\lambda\)</span> is the weight of the object, then
<span class="math notranslate nohighlight">\(h = \langle \lambda, \lambda+2\rho \rangle\)</span>, where
<span class="math notranslate nohighlight">\(\rho\)</span> is half the sum of the positive roots.
As in <a class="reference internal" href="../../../../references/index.html#row2006" id="id20"><span>[Row2006]</span></a>, this requires normalizing
the invariant bilinear form so that 
<span class="math notranslate nohighlight">\(\langle \alpha, \alpha \rangle = 2\)</span> for short roots.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reduced</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) boolean; if <code class="docutils literal notranslate"><span class="pre">True</span></code>
then return the twist reduced modulo 2</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G21</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">G21</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 4/5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G21</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">G21</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[1, zeta60^14 - zeta60^4]</span>
<span class="gp">sage: </span><span class="n">zeta60</span> <span class="o">=</span> <span class="n">G21</span><span class="o">.</span><span class="n">field</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">zeta60</span><span class="o">^</span><span class="p">((</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">60</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">zeta60^14 - zeta60^4</span>

<span class="gp">sage: </span><span class="n">F42</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;F4&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">F42</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 18/11, 2/11, 12/11, 4/11]</span>

<span class="gp">sage: </span><span class="n">E62</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E6&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">E62</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span>
<span class="go">[0, 26/21, 12/7, 8/21, 8/21, 26/21, 2/3, 4/7, 2/3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Element.weight">
<span class="sig-name descname"><span class="pre">weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Element.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the parametrizing dominant weight in the level <span class="math notranslate nohighlight">\(k\)</span> alcove.</p>
<p>This method is only available for basis elements.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A21</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">A21</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()]</span>
<span class="go">[(0, 0, 0), (2/3, -1/3, -1/3), (1/3, 1/3, -2/3)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.N_ijk">
<span class="sig-name descname"><span class="pre">N_ijk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elt_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elt_k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.N_ijk" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symmetric fusion coefficient <span class="math notranslate nohighlight">\(N_{ijk}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elt_i</span></code>, <code class="docutils literal notranslate"><span class="pre">elt_j</span></code>, <code class="docutils literal notranslate"><span class="pre">elt_k</span></code> – elements of the fusion basis</p></li>
</ul>
<p>This is the same as <span class="math notranslate nohighlight">\(N_{ij}^{k\ast}\)</span>, where <span class="math notranslate nohighlight">\(N_{ij}^k\)</span> are
the structure coefficients of the ring (see <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.Nk_ij" title="sage.combinat.root_system.fusion_ring.FusionRing.Nk_ij"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Nk_ij()</span></code></a>),
and <span class="math notranslate nohighlight">\(k\ast\)</span> denotes the dual element. The coefficient <span class="math notranslate nohighlight">\(N_{ijk}\)</span>
is unchanged under permutations of the three basis vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G23</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G23</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">G23</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">();</span> <span class="n">b</span>
<span class="go">[g0, g1, g2, g3, g4, g5]</span>
<span class="gp">sage: </span><span class="p">[(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">if</span> <span class="n">G23</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="go">[(g3, g3, g3), (g3, g3, g4), (g3, g4, g3), (g4, g3, g3)]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">G23</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="o">==</span><span class="n">G23</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">G23</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="o">==</span><span class="n">G23</span><span class="o">.</span><span class="n">N_ijk</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.Nk_ij">
<span class="sig-name descname"><span class="pre">Nk_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elt_j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elt_k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.Nk_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fusion coefficient <span class="math notranslate nohighlight">\(N^k_{ij}\)</span>.</p>
<p>These are the structure coefficients of the fusion ring, so</p>
<div class="math notranslate nohighlight">
\[i * j = \sum_{k} N_{ij}^k k.\]</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">A22</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">A22</span><span class="o">.</span><span class="n">Nk_ij</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.conj_matrix">
<span class="sig-name descname"><span class="pre">conj_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.conj_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjugation matrix, which is the permutation matrix
for the conjugation (dual) operation on basis elements.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">conj_matrix</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.field">
<span class="sig-name descname"><span class="pre">field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a cyclotomic field large enough to
contain the <span class="math notranslate nohighlight">\(2 \ell\)</span>-th roots of unity, as well as
all the S-matrix entries.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A2&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 60 and degree 16</span>
<span class="gp">sage: </span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 40 and degree 16</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.fusion_l">
<span class="sig-name descname"><span class="pre">fusion_l</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.fusion_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product <span class="math notranslate nohighlight">\(\ell = m_g(k + h^\vee)\)</span>, where <span class="math notranslate nohighlight">\(m_g\)</span> denotes the
square of the ratio of the lengths of long to short roots of
the underlying Lie algebra, <span class="math notranslate nohighlight">\(k\)</span> denotes the level of the FusionRing,
and <span class="math notranslate nohighlight">\(h^\vee\)</span> denotes the dual Coxeter number of the underlying Lie
algebra.</p>
<p>This value is used to define the associated root <span class="math notranslate nohighlight">\(2\ell\)</span>-th
of unity <span class="math notranslate nohighlight">\(q = e^{i\pi/\ell}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">fusion_l</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">D52</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D52</span><span class="o">.</span><span class="n">fusion_l</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.fusion_labels">
<span class="sig-name descname"><span class="pre">fusion_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inject_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.fusion_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the labels of the basis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">labels</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a list of strings or string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inject_variables</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
inject the variable names into the global namespace; note that
this could override objects already defined</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">labels</span></code> is a list, the length of the list must equal the
number of basis elements. These become the names of
the basis elements.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">labels</span></code> is a string, this is treated as a prefix and a
list of names is generated.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">labels</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then this resets the labels to the default.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A13</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A13</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fb</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">A13</span><span class="o">.</span><span class="n">basis</span><span class="p">());</span> <span class="n">fb</span>
<span class="go">[x0, x1, x2, x3]</span>
<span class="gp">sage: </span><span class="n">Matrix</span><span class="p">([[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">A13</span><span class="o">.</span><span class="n">basis</span><span class="p">()]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">A13</span><span class="o">.</span><span class="n">basis</span><span class="p">()])</span>
<span class="go">[     x0      x1      x2      x3]</span>
<span class="go">[     x1 x0 + x2 x1 + x3      x2]</span>
<span class="go">[     x2 x1 + x3 x0 + x2      x1]</span>
<span class="go">[     x3      x2      x1      x0]</span>
</pre></div>
</div>
<p>We give an example where the variables are injected into the
global namespace:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A13</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y0</span>
<span class="go">y0</span>
<span class="gp">sage: </span><span class="n">y0</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">A13</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We reset the labels to the default:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A13</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fb</span>
<span class="go">[A13(0), A13(1), A13(2), A13(3)]</span>
<span class="gp">sage: </span><span class="n">y0</span>
<span class="go">A13(0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.fusion_level">
<span class="sig-name descname"><span class="pre">fusion_level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.fusion_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level <span class="math notranslate nohighlight">\(k\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B22</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B22</span><span class="o">.</span><span class="n">fusion_level</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.get_order">
<span class="sig-name descname"><span class="pre">get_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.get_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weights of the basis vectors in a fixed order.</p>
<p>You may change the order of the basis using <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule.set_order" title="sage.combinat.free_module.CombinatorialFreeModule.set_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinatorialFreeModule.set_order()</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A14</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">A14</span><span class="o">.</span><span class="n">get_order</span><span class="p">();</span> <span class="n">w</span>
<span class="go">[(0, 0), (1/2, -1/2), (1, -1), (3/2, -3/2), (2, -2)]</span>
<span class="gp">sage: </span><span class="n">A14</span><span class="o">.</span><span class="n">set_order</span><span class="p">([</span><span class="n">w</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A14</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">A14</span><span class="o">.</span><span class="n">get_order</span><span class="p">()]</span>
<span class="go">[A14(0), A14(4), A14(1), A14(3), A14(2)]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This duplicates <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.get_order" title="sage.combinat.root_system.fusion_ring.FusionRing.get_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_order()</span></code></a> from
<a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule" title="sage.combinat.free_module.CombinatorialFreeModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">CombinatorialFreeModule</span></code></a> except the result
is <em>not</em> cached. Caching of
<a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule.get_order" title="sage.combinat.free_module.CombinatorialFreeModule.get_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinatorialFreeModule.get_order()</span></code></a> causes inconsistent
results after calling <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule.set_order" title="sage.combinat.free_module.CombinatorialFreeModule.set_order"><code class="xref py py-meth docutils literal notranslate"><span class="pre">CombinatorialFreeModule.set_order()</span></code></a>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension">
<span class="sig-name descname"><span class="pre">global_q_dimension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(\sum d_i^2\)</span>, where the sum is over all simple objects
and <span class="math notranslate nohighlight">\(d_i\)</span> is the quantum dimension. It is a positive real number.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E6&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.r_matrix">
<span class="sig-name descname"><span class="pre">r_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.r_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the R-matrix entry corresponding to the subobject <code class="docutils literal notranslate"><span class="pre">k</span></code>
in the tensor product of <code class="docutils literal notranslate"><span class="pre">i</span></code> with <code class="docutils literal notranslate"><span class="pre">j</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method only gives complete information when <span class="math notranslate nohighlight">\(N_{ij}^k = 1\)</span>
(an important special case). Tables of MTC including R-matrices
may be found in Section 5.3 of <a class="reference internal" href="../../../../references/index.html#rostwa2009" id="id21"><span>[RoStWa2009]</span></a> and in <a class="reference internal" href="../../../../references/index.html#bond2007" id="id22"><span>[Bond2007]</span></a>.</p>
</div>
<p>The R-matrix is a homomorphism <span class="math notranslate nohighlight">\(i \otimes j \rightarrow j \otimes i\)</span>.
This may be hard to describe since the object <span class="math notranslate nohighlight">\(i \otimes j\)</span>
may be reducible. However if <span class="math notranslate nohighlight">\(k\)</span> is a simple subobject of
<span class="math notranslate nohighlight">\(i \otimes j\)</span> it is also a subobject of <span class="math notranslate nohighlight">\(j \otimes i\)</span>. If we fix
embeddings <span class="math notranslate nohighlight">\(k \rightarrow i \otimes j\)</span>, <span class="math notranslate nohighlight">\(k \rightarrow j \otimes i\)</span>
we may ask for the scalar automorphism of <span class="math notranslate nohighlight">\(k\)</span> induced by the
R-matrix. This method computes that scalar. It is possible to
adjust the set of embeddings <span class="math notranslate nohighlight">\(k \rightarrow i \otimes j\)</span> (called
a <em>gauge</em>) so that this scalar equals</p>
<div class="math notranslate nohighlight">
\[\pm \sqrt{\frac{ \theta_k }{ \theta_i \theta_j }}.\]</div>
<p>If <span class="math notranslate nohighlight">\(i \neq j\)</span>, the gauge may be used to control the sign of
the square root. But if <span class="math notranslate nohighlight">\(i = j\)</span> then we must be careful
about the sign. These cases are computed by a formula
of <a class="reference internal" href="../../../../references/index.html#bdgrtw2019" id="id23"><span>[BDGRTW2019]</span></a>, Proposition 2.3.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;E8&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">conjugate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Ising MTC</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">fusion_labels</span><span class="p">([</span><span class="s2">&quot;i0&quot;</span><span class="p">,</span><span class="s2">&quot;p&quot;</span><span class="p">,</span><span class="s2">&quot;s&quot;</span><span class="p">],</span> <span class="n">inject_variables</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">i0</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">i0</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">r_matrix</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">I</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">8</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.root_of_unity">
<span class="sig-name descname"><span class="pre">root_of_unity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.root_of_unity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(e^{i\pi r}\)</span> as an element of <code class="docutils literal notranslate"><span class="pre">self.field()</span></code> if possible.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> – a rational number</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A11</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A11</span><span class="o">.</span><span class="n">field</span><span class="p">()</span>
<span class="go">Cyclotomic Field of order 24 and degree 8</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A11</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..7</span><span class="p">]]</span>
<span class="go">[1, -1, zeta24^4 - 1, zeta24^6, None, zeta24^4, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.s_ij">
<span class="sig-name descname"><span class="pre">s_ij</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elt_i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elt_j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_ij" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the element of the S-matrix of this fusion ring corresponding to
the given elements.</p>
<p>This is computed using the formula</p>
<div class="math notranslate nohighlight">
\[s_{i,j} = \frac{1}{\theta_i\theta_j} \sum_k N_{ik}^j d_k \theta_k,\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta_k\)</span> is the twist and <span class="math notranslate nohighlight">\(d_k\)</span> is the quantum
dimension. See <a class="reference internal" href="../../../../references/index.html#row2006" id="id24"><span>[Row2006]</span></a> Equation (2.2) or <a class="reference internal" href="../../../../references/index.html#egno2015" id="id25"><span>[EGNO2015]</span></a>
Proposition 8.13.8.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elt_i</span></code>, <code class="docutils literal notranslate"><span class="pre">elt_j</span></code> – elements of the fusion basis</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G21</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">G21</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">G21</span><span class="o">.</span><span class="n">s_ij</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">b</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[1, -zeta60^14 + zeta60^6 + zeta60^4, -zeta60^14 + zeta60^6 + zeta60^4, -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.s_matrix">
<span class="sig-name descname"><span class="pre">s_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unitary</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.s_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the S-matrix of this fusion ring.</p>
<p>OPTIONAL:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">unitary</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to obtain
the unitary S-matrix</p></li>
</ul>
<p>Without the <code class="docutils literal notranslate"><span class="pre">unitary</span></code> parameter, this is the matrix denoted 
<span class="math notranslate nohighlight">\(\widetilde{s}\)</span> in <a class="reference internal" href="../../../../references/index.html#baki2001" id="id26"><span>[BaKi2001]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D91</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;D9&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D91</span><span class="o">.</span><span class="n">s_matrix</span><span class="p">()</span>
<span class="go">[          1           1           1           1]</span>
<span class="go">[          1           1          -1          -1]</span>
<span class="go">[          1          -1 -zeta136^34  zeta136^34]</span>
<span class="go">[          1          -1  zeta136^34 -zeta136^34]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">D91</span><span class="o">.</span><span class="n">s_matrix</span><span class="p">(</span><span class="n">unitary</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">S</span>
<span class="go">[            1/2             1/2             1/2             1/2]</span>
<span class="go">[            1/2             1/2            -1/2            -1/2]</span>
<span class="go">[            1/2            -1/2 -1/2*zeta136^34  1/2*zeta136^34]</span>
<span class="go">[            1/2            -1/2  1/2*zeta136^34 -1/2*zeta136^34]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">*</span><span class="n">S</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.some_elements">
<span class="sig-name descname"><span class="pre">some_elements</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D41</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D41</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[D41(1,0,0,0), D41(0,0,1,0), D41(0,0,0,1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.total_q_order">
<span class="sig-name descname"><span class="pre">total_q_order</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.total_q_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the positive square root of <code class="docutils literal notranslate"><span class="pre">self.global_q_dimension()</span></code>
as an element of <code class="docutils literal notranslate"><span class="pre">self.field()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;G2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tqo</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">total_q_order</span><span class="p">();</span> <span class="n">tqo</span>
<span class="go">zeta60^15 - zeta60^11 - zeta60^9 + 2*zeta60^3 + zeta60</span>
<span class="gp">sage: </span><span class="n">tqo</span><span class="o">.</span><span class="n">is_real_positive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">tqo</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">F</span><span class="o">.</span><span class="n">global_q_dimension</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.twists_matrix">
<span class="sig-name descname"><span class="pre">twists_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.twists_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a diagonal matrix describing the twist corresponding to
each simple object in the <code class="docutils literal notranslate"><span class="pre">FusionRing</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B21</span><span class="o">=</span><span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;B2&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B21</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()]</span>
<span class="go">[0, 1, 5/8]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B21</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">twist</span><span class="p">())</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">B21</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">()]</span>
<span class="go">[1, -1, zeta32^10]</span>
<span class="gp">sage: </span><span class="n">B21</span><span class="o">.</span><span class="n">twists_matrix</span><span class="p">()</span>
<span class="go">[        1         0         0]</span>
<span class="go">[        0        -1         0]</span>
<span class="go">[        0         0 zeta32^10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.fusion_ring.FusionRing.virasoro_central_charge">
<span class="sig-name descname"><span class="pre">virasoro_central_charge</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.fusion_ring.FusionRing.virasoro_central_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Virasoro central charge of the WZW conformal
field theory associated with the Fusion Ring.</p>
<p>If <span class="math notranslate nohighlight">\(\mathfrak{g}\)</span> is the corresponding semisimple Lie algebra, this is</p>
<div class="math notranslate nohighlight">
\[\frac{k\dim\mathfrak{g}}{k+h^\vee},\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the level and <span class="math notranslate nohighlight">\(h^\vee\)</span> is the dual Coxeter number.
See <a class="reference internal" href="../../../../references/index.html#dfms1996" id="id27"><span>[DFMS1996]</span></a> Equation (15.61).</p>
<p>Let <span class="math notranslate nohighlight">\(d_i\)</span> and <span class="math notranslate nohighlight">\(\theta_i\)</span> be the quantum dimensions and
twists of the simple objects. By Proposition 2.3 in <a class="reference internal" href="../../../../references/index.html#rostwa2009" id="id28"><span>[RoStWa2009]</span></a>,
there exists a rational number <span class="math notranslate nohighlight">\(c\)</span> such that
<span class="math notranslate nohighlight">\(D_+ / \sqrt{D} = e^{i\pi c/4}\)</span>, where <span class="math notranslate nohighlight">\(D_+ = \sum d_i^2 \theta_i\)</span>
is computed in <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.D_plus" title="sage.combinat.root_system.fusion_ring.FusionRing.D_plus"><code class="xref py py-meth docutils literal notranslate"><span class="pre">D_plus()</span></code></a> and <span class="math notranslate nohighlight">\(D = \sum d_i^2 &gt; 0\)</span> is computed
by <a class="reference internal" href="#sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension" title="sage.combinat.root_system.fusion_ring.FusionRing.global_q_dimension"><code class="xref py py-meth docutils literal notranslate"><span class="pre">global_q_dimension()</span></code></a>. Squaring this identity and
remembering that <span class="math notranslate nohighlight">\(D_+ D_- = D\)</span> gives</p>
<div class="math notranslate nohighlight">
\[D_+ / D_- = e^{i\pi c/2}.\]</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">FusionRing</span><span class="p">(</span><span class="s2">&quot;A1&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">virasoro_central_charge</span><span class="p">();</span> <span class="n">c</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Dp</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">D_plus</span><span class="p">();</span> <span class="n">Dp</span>
<span class="go">2*zeta32^6</span>
<span class="gp">sage: </span><span class="n">Dm</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">D_minus</span><span class="p">();</span> <span class="n">Dm</span>
<span class="go">-2*zeta32^10</span>
<span class="gp">sage: </span><span class="n">Dp</span> <span class="o">/</span> <span class="n">Dm</span> <span class="o">==</span> <span class="n">R</span><span class="o">.</span><span class="n">root_of_unity</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="weyl_characters.html"
                        title="previous chapter">Weyl Character Rings</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="weyl_group.html"
                        title="next chapter">Weyl Groups</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/root_system/fusion_ring.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_group.html" title="Weyl Groups"
             >next</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.5 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module List</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Fusion Rings</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>