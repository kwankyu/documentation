
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Nonsymmetric Macdonald polynomials &#8212; Sage Reference Manual v8.8: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Pieri Factors" href="pieri_factors.html" />
    <link rel="prev" title="Integrable Representations of Affine Lie Algebras" href="integrable_representations.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pieri_factors.html" title="Pieri Factors"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="integrable_representations.html" title="Integrable Representations of Affine Lie Algebras"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nonsymmetric-macdonald-polynomials">
<span id="sage-combinat-root-system-non-symmetric-macdonald-polynomials"></span><h1>Nonsymmetric Macdonald polynomials<a class="headerlink" href="#nonsymmetric-macdonald-polynomials" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.root_system.non_symmetric_macdonald_polynomials"></span><p>AUTHORS:</p>
<ul class="simple">
<li>Anne Schilling and Nicolas M. Thiery (2013): initial version</li>
</ul>
<p>ACKNOWLEDGEMENTS:</p>
<p>The initial version of this code (together with <a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras"><code class="xref py py-class docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras</span></code></a>
and <a class="reference internal" href="hecke_algebra_representation.html#sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation" title="sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">hecke_algebra_representation.HeckeAlgebraRepresentation</span></code></a>) was written by
Anne Schilling and Nicolas M. Thiery during the ICERM Semester Program on “Automorphic Forms,
Combinatorial Representation Theory and Multiple Dirichlet Series” (January 28, 2013 - May 3, 2013)
with the help of Dan Bump, Ben Brubaker, Bogdan Ion, Dan Orr, Arun Ram, Siddhartha Sahi, and Mark Shimozono.
Special thanks go to Bogdan Ion and Mark Shimozono for their patient explanations and hand computations
to check the code.</p>
<dl class="class">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials">
<em class="property">class </em><code class="descclassname">sage.combinat.root_system.non_symmetric_macdonald_polynomials.</code><code class="descname">NonSymmetricMacdonaldPolynomials</code><span class="sig-paren">(</span><em>KL</em>, <em>q</em>, <em>q1</em>, <em>q2</em>, <em>normalized</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="hecke_algebra_representation.html#sage.combinat.root_system.hecke_algebra_representation.CherednikOperatorsEigenvectors" title="sage.combinat.root_system.hecke_algebra_representation.CherednikOperatorsEigenvectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.root_system.hecke_algebra_representation.CherednikOperatorsEigenvectors</span></code></a></p>
<p>Nonsymmetric Macdonald polynomials</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">KL</span></code> – an affine Cartan type or the group algebra of a
realization of the affine weight lattice</li>
<li><code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">q1</span></code>, <code class="docutils literal notranslate"><span class="pre">q2</span></code> – parameters in the base ring of the group algebra (default: <code class="docutils literal notranslate"><span class="pre">q</span></code>, <code class="docutils literal notranslate"><span class="pre">q1</span></code>, <code class="docutils literal notranslate"><span class="pre">q2</span></code>)</li>
<li><code class="docutils literal notranslate"><span class="pre">normalized</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)
whether to normalize the result to have leading coefficient 1</li>
</ul>
<p>This implementation covers all reduced affine root systems.
The polynomials are constructed recursively by the application
of intertwining operators.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Non-reduced case (Koornwinder polynomials).</li>
<li>Non-equal parameters for the affine Hecke algebra.</li>
<li>Choice of convention (dominant/anti-dominant, …).</li>
<li>More uniform implementation of the <span class="math notranslate nohighlight">\(T_0^\vee\)</span> operator.</li>
<li>Optimizations, in particular in the calculation of the
eigenvalues for the recursion.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>We construct the family of nonsymmetric Macdonald polynomials in
three variables in type <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>They are constructed as elements of the group algebra of the
classical weight lattice <span class="math notranslate nohighlight">\(L_0\)</span> (or one of its realizations, such as
the ambient space, which is used here) and indexed by elements of <span class="math notranslate nohighlight">\(L_0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">();</span> <span class="n">L0</span>
<span class="go">Ambient space of the Root system of type [&#39;A&#39;, 2]</span>
</pre></div>
</div>
<p>Here is the nonsymmetric Macdonald polynomial with leading term
<span class="math notranslate nohighlight">\([2,0,1]\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">((-q*q1-q*q2)/(-q*q1-q2))*B[(1, 1, 1)] + ((-q1-q2)/(-q*q1-q2))*B[(2, 1, 0)] + B[(2, 0, 1)]</span>
</pre></div>
</div>
<p>It can be seen as a polynomial (or in general a Laurent
polynomial) by interpreting each term as an exponent vector. The
parameter <span class="math notranslate nohighlight">\(q\)</span> is the exponential of the null (co)root, whereas
<span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span> are the two eigenvalues of each generator
<span class="math notranslate nohighlight">\(T_i\)</span> of the affine Hecke algebra (see the background section for
details).</p>
<p>By setting <span class="math notranslate nohighlight">\(q_1=t\)</span>, <span class="math notranslate nohighlight">\(q_2=-1\)</span> and using the
<a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.expand" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.expand"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras.ElementMethods.expand()</span></code></a>
method, we recover the nonsymmetric Macdonald polynomial as
computed by <a class="reference internal" href="#hhl06" id="id1">[HHL06]</a>’s combinatorial formula:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">q2</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">vars</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="s1">&#39;x0,x1,x2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span>
<span class="go">((-t + 1)/(-q*t + 1))*x0^2*x1 + x0^2*x2 + ((-q*t + q)/(-q*t + 1))*x0*x1*x2</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.sf.ns_macdonald</span> <span class="kn">import</span> <span class="n">E</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t + 1))*x0^2*x1 + x0^2*x2 + ((-q*t + q)/(-q*t + 1))*x0*x1*x2</span>
</pre></div>
</div>
<p>Here is a type <span class="math notranslate nohighlight">\(G_2^{(1)}\)</span> nonsymmetric Macdonald polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span> <span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
<span class="go">((-q*q1^3*q2-q*q1^2*q2^2)/(q*q1^4-q2^4))*B[(0, 0, 0)] + B[(1, -1, 0)] + ((-q1*q2^3-q2^4)/(q*q1^4-q2^4))*B[(1, 0, -1)]</span>
</pre></div>
</div>
<p>Many more examples are given after the background section.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="../sf/ns_macdonald.html#sage.combinat.sf.ns_macdonald.E" title="sage.combinat.sf.ns_macdonald.E"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.combinat.sf.ns_macdonald.E()</span></code></a></li>
<li><a class="reference internal" href="../sf/sf.html#sage.combinat.sf.sf.SymmetricFunctions.macdonald" title="sage.combinat.sf.sf.SymmetricFunctions.macdonald"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SymmetricFunctions.macdonald()</span></code></a></li>
</ul>
</div>
<p class="rubric">Background</p>
<p class="rubric">The polynomial module</p>
<p>The nonsymmetric Macdonald polynomials are a distinguished basis of the “polynomial” module
of the affine Hecke algebra. Given:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">- a ground ring `K`, which contains the input parameters `q, q_1, q_2`</span>
<span class="go">- an affine root system, specified by a Cartan type `C`</span>
<span class="go">- a realization `L` of the weight lattice of type `C`</span>
</pre></div>
</div>
<p>the polynomial module is the group algebra <span class="math notranslate nohighlight">\(K[L_0]\)</span> of the classical
weight lattice <span class="math notranslate nohighlight">\(L_0\)</span> with coefficients in <span class="math notranslate nohighlight">\(K\)</span>. It is isomorphic to the
Laurent polynomial ring over <span class="math notranslate nohighlight">\(K\)</span> generated by the formal exponentials
of any basis of <span class="math notranslate nohighlight">\(L_0\)</span>.</p>
<p>In our running example <span class="math notranslate nohighlight">\(L\)</span> is the ambient space of type <span class="math notranslate nohighlight">\(C_2^{(1)}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">();</span> <span class="n">L</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>

<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: -2*e[0] + e[&#39;delta&#39;], 1: e[0] - e[1], 2: 2*e[1]}</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">();</span> <span class="n">omega</span>
<span class="go">Finite family {0: e[&#39;deltacheck&#39;], 1: e[0] + e[&#39;deltacheck&#39;], 2: e[0] + e[1] + e[&#39;deltacheck&#39;]}</span>

<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">();</span> <span class="n">L0</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">KL0</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
</pre></div>
</div>
<p class="rubric">Affine Hecke algebra</p>
<p>The affine Hecke algebra is generated by elements <span class="math notranslate nohighlight">\(T_i\)</span> for <code class="docutils literal notranslate"><span class="pre">i</span></code> in the
set of affine Dynkin nodes. They satisfy the same braid relations
as the simple reflections <span class="math notranslate nohighlight">\(s_i\)</span> of the affine Weyl group.
The <span class="math notranslate nohighlight">\(T_i\)</span> satisfy the quadratic relation</p>
<div class="math notranslate nohighlight">
\[(T_i-q_1)\circ(T_i-q_2) = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span> are the input parameters.  Some of the
representation theory requires that <span class="math notranslate nohighlight">\(q_1\)</span> and <span class="math notranslate nohighlight">\(q_2\)</span> satisfy
additional relations; typically one uses the specializations
<span class="math notranslate nohighlight">\(q_1=u\)</span> and <span class="math notranslate nohighlight">\(q_2=-1/u\)</span> or <span class="math notranslate nohighlight">\(q_1=t\)</span> and <span class="math notranslate nohighlight">\(q_2=-1\)</span>). This can be
achieved by constructing an appropriate field and passing <span class="math notranslate nohighlight">\(q_1\)</span>
and <span class="math notranslate nohighlight">\(q_2\)</span> appropriately; see the examples. In principle, the
parameter(s) could further depend on <code class="docutils literal notranslate"><span class="pre">i</span></code>; this is not yet
implemented but the code has been designed in such a way that this
feature is easy to add.</p>
<p class="rubric">Demazure-Lusztig operators</p>
<p>The <code class="docutils literal notranslate"><span class="pre">i</span></code>-th Demazure-Lusztig operator is an operator on <span class="math notranslate nohighlight">\(K[L]\)</span>
which interpolates between the reflection <span class="math notranslate nohighlight">\(s_i\)</span> and the Demazure operator <span class="math notranslate nohighlight">\(\pi_i\)</span>
(see <code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization.RootLatticeRealization.Algebras.ParentMethods.demazure_lusztig_operators()</span></code>).:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">);</span> <span class="n">KL</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">x</span>
<span class="go">B[e[0] + e[&#39;deltacheck&#39;]]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">q1*B[e[0] + e[&#39;deltacheck&#39;]]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[e[0] + e[&#39;deltacheck&#39;]] + q1*B[e[1] + e[&#39;deltacheck&#39;]]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">q1*B[e[0] + e[&#39;deltacheck&#39;]]</span>
</pre></div>
</div>
<p>The affine Hecke algebra acts on <span class="math notranslate nohighlight">\(K[L]\)</span> by letting the generators <span class="math notranslate nohighlight">\(T_i\)</span> act by
the Demazure-Lusztig operators. The class
<a class="reference internal" href="hecke_algebra_representation.html#sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation" title="sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation</span></code></a>
implements some simple generic features for representations of affine Hecke algebras
defined by the action of their <span class="math notranslate nohighlight">\(T\)</span>-generators.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span>
<span class="go">A representation of the (q1, q2)-Hecke algebra of type [&#39;C&#39;, 2, 1] on Algebra of the Ambient space of the Root system of type [&#39;C&#39;, 2, 1] over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>                 <span class="c1"># long time (1.3s)</span>
</pre></div>
</div>
<p>Here we construct the operator <span class="math notranslate nohighlight">\(q_1 T_2^{-1}\circ T_1^{-1}T_0\)</span>
from a signed reduced word:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">q1</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Generic endomorphism of Algebra of the Ambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
</pre></div>
</div>
<p>(note the reversal of the word). Inverses are computed using the
quadratic relation.</p>
<p class="rubric">Cherednik operators</p>
<p>The affine Hecke algebra contains elements <span class="math notranslate nohighlight">\(Y_\lambda\)</span> indexed by
the coroot lattice. Their action on <span class="math notranslate nohighlight">\(K[L]\)</span> is implemented in Sage:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Y</span><span class="p">();</span> <span class="n">Y</span>
<span class="go">Lazy family (...)_{i in Coroot lattice of the Root system of type [&#39;C&#39;, 2, 1]}</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y1</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">Y1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">((q1^3+q1^2*q2)/(-q2^3))*B[-e[0] - 2*e[1] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+2*q1^2*q2+q1*q2^2)/(-q2^3))*B[-e[0] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+q1^2*q2)/(-q2^3))*B[e[0] - 2*e[1] - 2*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+q1^2*q2)/(-q2^3))*B[e[0] - 2*e[1] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+2*q1^2*q2+q1*q2^2)/(-q2^3))*B[e[0] - 2*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+q1^2*q2)/(-q2^3))*B[e[0] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]] + ((q1^2+2*q1*q2+q2^2)/(-q1*q2))*B[e[0] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+q1^2*q2)/(-q2^3))*B[2*e[0] - e[1] - 2*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((-q1^2-q1*q2)/(-q2^2))*B[2*e[0] - e[1] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]] + (q1^3/(-q2^3))*B[3*e[0] - 2*e[1] - 3*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+q1^2*q2)/(-q2^3))*B[3*e[0] - 3*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((q1^3+2*q1^2*q2+q1*q2^2)/(-q2^3))*B[-e[1] - e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="go">+ ((-q1^2-2*q1*q2-q2^2)/(-q2^2))*B[-e[1] + e[&#39;deltacheck&#39;]] + ((q1+q2)/(-q2))*B[e[1] + e[&#39;deltacheck&#39;]]</span>
</pre></div>
</div>
<p>The Cherednik operators span a Laurent polynomial ring inside the
affine Hecke algebra; namely <span class="math notranslate nohighlight">\(\lambda\mapsto Y_\lambda\)</span> is a group
isomorphism from the classical root lattice (viewed additively) to
the affine Hecke algebra (viewed multiplicatively). In practice,
<span class="math notranslate nohighlight">\(Y_\lambda\)</span> is constructed by computing combinatorially its signed
reduced word (and an overall scalar factor) using the periodic
orientation of the alcove model in the coweight lattice (see
<a class="reference internal" href="hecke_algebra_representation.html#sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation.Y_lambdacheck" title="sage.combinat.root_system.hecke_algebra_representation.HeckeAlgebraRepresentation.Y_lambdacheck"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hecke_algebra_representation.HeckeAlgebraRepresentation.Y_lambdacheck()</span></code></a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Lcheck</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">root_system</span><span class="o">.</span><span class="n">coweight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lcheck</span><span class="o">.</span><span class="n">reduced_word_of_translation</span><span class="p">(</span><span class="n">Lcheck</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="n">w</span>
<span class="go">[0, 2, 1, 0, 2, 1]</span>
<span class="gp">sage: </span><span class="n">Lcheck</span><span class="o">.</span><span class="n">signs_of_alcovewalk</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">[1, -1, 1, -1, 1, 1]</span>
</pre></div>
</div>
<p class="rubric">Level zero representation of the affine Hecke algebra</p>
<p>The action of the affine Hecke algebra on <span class="math notranslate nohighlight">\(K[L]\)</span> induces
an action on <span class="math notranslate nohighlight">\(K[L_0]\)</span>: the action of <span class="math notranslate nohighlight">\(T_i\)</span> on <span class="math notranslate nohighlight">\(X^\lambda\)</span> for <span class="math notranslate nohighlight">\(\lambda\)</span> a
classical weight in <span class="math notranslate nohighlight">\(L_0\)</span> is obtained by embedding the weight at
level zero in the affine weight lattice (see
<a class="reference internal" href="weight_lattice_realizations.html#sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations.ParentMethods.embed_at_level" title="sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations.ParentMethods.embed_at_level"><code class="xref py py-meth docutils literal notranslate"><span class="pre">weight_lattice_realizations.WeightLatticeRealizations.ParentMethods.embed_at_level()</span></code></a>)
applying the Demazure-Lusztig operator there, and projecting from <span class="math notranslate nohighlight">\(K[L]\to K[L_0]\)</span>
mapping the exponential of <span class="math notranslate nohighlight">\(\delta\)</span> to <span class="math notranslate nohighlight">\(q\)</span> (see
<a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras.ParentMethods.q_project()</span></code></a>). This is implemented in
<a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators_on_classical" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators_on_classical"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators_on_classical()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators_on_classical</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q*q2)*B[(-1, 0)]</span>
</pre></div>
</div>
<p>For classical nodes these are the usual Demazure-Lusztig operators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 0)] + q1*B[(0, 1)]</span>
</pre></div>
</div>
<p class="rubric">Nonsymmetric Macdonald polynomials</p>
<p>We can now finally define the nonsymmetric Macdonald polynomials.
Because the Cherednik operators commute (and there is no radical),
they can be simultaneously diagonalized; namely, <span class="math notranslate nohighlight">\(K[L_0]\)</span> admits a
<span class="math notranslate nohighlight">\(K\)</span>-basis of joint eigenvectors for the <span class="math notranslate nohighlight">\(Y_\lambda\)</span>.  For <span class="math notranslate nohighlight">\(\mu \in
L_0\)</span>, the nonsymmetric Macdonald polynomial <span class="math notranslate nohighlight">\(E_\mu\)</span> is the unique
eigenvector of the family of Cherednik operators <span class="math notranslate nohighlight">\(Y_\lambda\)</span>
having <span class="math notranslate nohighlight">\(\mu\)</span> as leading term:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">);</span> <span class="n">E</span>
<span class="go">The family of the Macdonald polynomials of type [&#39;C&#39;, 2, 1] with parameters q, q1, q2</span>
</pre></div>
</div>
<p>Or for short:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Recursive construction of the nonsymmetric Macdonald polynomials</p>
<p>The generators <span class="math notranslate nohighlight">\(T_i\)</span> of the affine Hecke algebra almost skew
commute with the Cherednik operators. More precisely, one
can deform them into the so-called intertwining operators:</p>
<div class="math notranslate nohighlight">
\[\tau_i = T_i - (q_1+q_2) \frac{Y_i^{a-1}}{1-Y_i^a}\,.\]</div>
<p>(where <span class="math notranslate nohighlight">\(a=1\)</span> except for <span class="math notranslate nohighlight">\(i=0\)</span> in type <span class="math notranslate nohighlight">\(BC\)</span> where <span class="math notranslate nohighlight">\(a=a_0=2\)</span>) which
satisfy the following skew commutation relations:</p>
<div class="math notranslate nohighlight">
\[\tau_i Y_\lambda = \tau_i Y_{s_i\lambda} \,.\]</div>
<p>If <span class="math notranslate nohighlight">\(s_i \mu \ne \mu\)</span>, applying <span class="math notranslate nohighlight">\(\tau_i\)</span> on an eigenvector <span class="math notranslate nohighlight">\(E_\mu\)</span>
produces a new eigenvector (essentially <span class="math notranslate nohighlight">\(E_{s_i\mu}\)</span>) with a
distinct eigenvalue.  It follows that the eigenvectors indexed by
an affine Weyl orbit of weights, may be recursively computed from
a single weight in the orbit.</p>
<p>In the case at hand, there is a little complication: namely, the
simple reflections <span class="math notranslate nohighlight">\(s_i\)</span> acting at level 0 do not act transitively
on classical weights; in fact the orbits for the classical Weyl
group and for the affine Weyl group are the same. Thus, one can
construct the nonsymmetric Macdonald polynomials for all weights
from those for the classical dominant weights, but one is lacking
a creation operator to construct the nonsymmetric Macdonald
polynomials for dominant weights.</p>
<p class="rubric">Twisted Demazure-Lusztig operators</p>
<p>To compensate for this, one needs to consider another affinization
of the action of the classical Demazure-Lusztig operators
<span class="math notranslate nohighlight">\(T_1,\dots,T_n\)</span>, which gives rise to the double affine Hecke algebra.
Following Cherednik, one adds another operator <span class="math notranslate nohighlight">\(T_0^\vee\)</span> implemented in:
<a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.T0_check_on_basis" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.T0_check_on_basis"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras.ParentMethods.T0_check_on_basis()</span></code></a>.
See also:
<a class="reference internal" href="root_lattice_realization_algebras.html#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators()</span></code></a>.</p>
<p>Depending on the type (untwisted or not), this is a representation
of the affine Hecke algebra for another affinization of the
classical Cartan type. The corresponding action of the affine Weyl
group – which is used to compute the recursion on <span class="math notranslate nohighlight">\(\mu\)</span> – occurs
in the corresponding weight lattice realization:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;B&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">L_prime()</span></code></a> and
<a class="reference internal" href="cartan_type.html#sage.combinat.root_system.cartan_type.CartanType_affine.other_affinization" title="sage.combinat.root_system.cartan_type.CartanType_affine.other_affinization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cartan_type.CartanType_affine.other_affinization()</span></code></a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="haimanicm" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HaimanICM]</td><td>M. Haiman, Cherednik algebras, Macdonald polynomials and combinatorics,
Proceedings of the International Congress of Mathematicians,
Madrid 2006, Vol. III, 843-872.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hhl06" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HHL06]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id3">3</a>, <a class="fn-backref" href="#id5">4</a>, <a class="fn-backref" href="#id6">5</a>)</em> J. Haglund, M. Haiman and N. Loehr,
A combinatorial formula for nonsymmetric Macdonald polynomials,
Amer. J. Math. 130, No. 2 (2008), 359-383.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="lnsss12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[LNSSS12]</a></td><td>C. Lenart, S. Naito, D. Sagaki, A. Schilling, M. Shimozono,
A uniform model for Kirillov-Reshetikhin crystals I: Lifting
the parabolic quantum Bruhat graph, preprint arXiv.1211.2042
[math.QA]</td></tr>
</tbody>
</table>
<p class="rubric">More examples</p>
<p>We show how to create the nonsymmetric Macdonald polynomials in
two different ways and check that they are the same:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">((-q*u^2+q)/(-q*u^4+1))*B[(1/2, -1/2, 1/2)] + ((-q*u^2+q)/(-q*u^4+1))*B[(1/2, 1/2, -1/2)] + B[(3/2, 1/2, 1/2)]</span>

<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;D&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">==</span> <span class="n">P</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))]</span>
<span class="go">((-q*u^2+q)/(-q*u^2+1))*B[(0, 0, 0)] + ((-u^2+1)/(-q*u^2+1))*B[(1, 1, 0)]</span>
<span class="go">+ ((-u^2+1)/(-q*u^2+1))*B[(1, 0, -1)] + B[(0, 1, -1)]</span>
</pre></div>
</div>
<p>In type <span class="math notranslate nohighlight">\(A\)</span>, there is also a combinatorial implementation of the
nonsymmetric Macdonald polynomials in terms of augmented diagram
fillings as in <a class="reference internal" href="#hhl06" id="id2">[HHL06]</a>. See
<a class="reference internal" href="../sf/ns_macdonald.html#sage.combinat.sf.ns_macdonald.E" title="sage.combinat.sf.ns_macdonald.E"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.combinat.sf.ns_macdonald.E()</span></code></a>.  First we check that
these polynomials are indeed eigenvectors of the Cherednik
operators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span> <span class="o">=</span> <span class="n">t</span><span class="p">;</span> <span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.combinat.sf.ns_macdonald</span> <span class="kn">as</span> <span class="nn">NS</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">p</span>
<span class="go">x0</span>
<span class="gp">sage: </span><span class="n">pp</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">[t, (-1)/(-q*t^2), t]</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">eig</span><span class="p">(</span><span class="n">l</span><span class="p">):</span> <span class="k">return</span> <span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span>

<span class="gp">sage: </span><span class="n">eig</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[t, (-1)/(-q*t^2), t]</span>
<span class="gp">sage: </span><span class="n">eig</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[q*t, (-1)/(-q^2*t^2), t]</span>
<span class="gp">sage: </span><span class="n">eig</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[q^2*t, (-1)/(-q^3*t^2), t]</span>
<span class="gp">sage: </span><span class="n">eig</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">[(-1)/(-q^3*t), 1/(q^2*t), q^4*t^2]</span>
</pre></div>
</div>
<p>Next we check explicitly that they agree with the current implementation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="s1">&#39;x0,x1&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">EE</span><span class="p">(</span><span class="n">weight</span><span class="p">):</span> <span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">(</span><span class="n">weight</span><span class="p">)]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.combinat.sf.ns_macdonald</span> <span class="kn">as</span> <span class="nn">NS</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x0</span>
<span class="gp">sage: </span><span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x0</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t + 1))*x0 + x1</span>
<span class="gp">sage: </span><span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t + 1))*x0 + x1</span>

<span class="gp">sage: </span><span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x0^2 + ((-q*t + q)/(-q*t + 1))*x0*x1</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x0^2 + ((-q*t + q)/(-q*t + 1))*x0*x1</span>
</pre></div>
</div>
<p>The same, directly in the ambient lattice with several shifts:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])]</span>
<span class="go">((-q*t+q)/(-q*t+1))*B[(1, 1)] + B[(2, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">((-q*t+q)/(-q*t+1))*B[(0, 0)] + B[(1, -1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])]</span>
<span class="go">((-q*t+q)/(-q*t+1))*B[(-1, -1)] + B[(0, -2)]</span>
</pre></div>
</div>
<p>Systematic checks with Sage’s implementation of <a class="reference internal" href="#hhl06" id="id3">[HHL06]</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">EE</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span> <span class="o">==</span> <span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">IntegerVectors</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>With the current implementation, we can compute nonsymmetric
Macdonald polynomials for any type, for example for type <span class="math notranslate nohighlight">\(E_6^{(1)}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">weyl_action</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">((-u^2+1)/(-q*u^16+1))*B[-Lambda[1] + Lambda[3]] + ((-u^2+1)/(-q*u^16+1))*B[Lambda[1]]</span>
<span class="go">+ B[-Lambda[2] + Lambda[5]] + ((-u^2+1)/(-q*u^16+1))*B[Lambda[2] - Lambda[4] + Lambda[5]]</span>
<span class="go">+ ((-u^2+1)/(-q*u^16+1))*B[-Lambda[3] + Lambda[4]]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">weyl_action</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])]</span>  <span class="c1"># long time (6s)</span>
<span class="go">((-q^2*u^20+q^2*u^18+q*u^2-q)/(-q^2*u^32+2*q*u^16-1))*B[0]</span>
<span class="go">+ B[Lambda[1] - Lambda[3] + Lambda[4] - Lambda[5] + Lambda[6]]</span>
<span class="go">+ ((-u^2+1)/(-q*u^16+1))*B[Lambda[1] - Lambda[3] + Lambda[5]]</span>
<span class="go">+ ((-q*u^20+q*u^18+u^2-1)/(-q^2*u^32+2*q*u^16-1))*B[-Lambda[2] + Lambda[4]]</span>
<span class="go">+ ((-q*u^20+q*u^18+u^2-1)/(-q^2*u^32+2*q*u^16-1))*B[Lambda[2]]</span>
<span class="go">+ ((u^4-2*u^2+1)/(q^2*u^32-2*q*u^16+1))*B[Lambda[3] - Lambda[4] + Lambda[5]]</span>
<span class="go">+ ((-u^2+1)/(-q*u^16+1))*B[Lambda[3] - Lambda[5] + Lambda[6]]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>  <span class="c1"># long time (13s)</span>
<span class="go">((q^2*u^10-q^2*u^8-q^2*u^2+q^2)/(q^2*u^26-q*u^16-q*u^10+1))*B[0]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[1] - Lambda[2] + Lambda[6]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[1] + Lambda[2] - Lambda[4] + Lambda[6]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[1] - Lambda[3] + Lambda[4] - Lambda[5] + Lambda[6]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[1] - Lambda[3] + Lambda[5]] + B[Lambda[1] + Lambda[6]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[-Lambda[2] + Lambda[4]] + ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[2]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[3] - Lambda[4] + Lambda[5]]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^10+1))*B[Lambda[3] - Lambda[5] + Lambda[6]]</span>
</pre></div>
</div>
<p>We test various other types:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">((-q*u^2+q)/(-q*u^8+1))*B[(0, 0, 0)] + B[(1, 1, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))]</span>                                       <span class="c1"># long time (1.5s)</span>
<span class="go">((-q^2*u^10+q^2*u^8-q*u^6+q*u^4+q*u^2+u^2-q-1)/(-q^3*u^12+q^2*u^8+q*u^4-1))*B[(0, 0, 0)]</span>
<span class="go">+ ((-u^2+1)/(-q*u^4+1))*B[(1, -1, 0)]</span>
<span class="go">+ ((u^6-u^4-u^2+1)/(q^3*u^12-q^2*u^8-q*u^4+1))*B[(1, 1, 0)]</span>
<span class="go">+ ((u^4-2*u^2+1)/(q^3*u^12-q^2*u^8-q*u^4+1))*B[(1, 0, -1)]</span>
<span class="go">+ ((q^2*u^12-q^2*u^10-u^2+1)/(q^3*u^12-q^2*u^8-q*u^4+1))*B[(1, 0, 1)] + B[(0, -1, 1)]</span>
<span class="go">+ ((-u^2+1)/(-q^2*u^8+1))*B[(0, 1, -1)] + ((-u^2+1)/(-q^2*u^8+1))*B[(0, 1, 1)]</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">=</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;E&quot;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>                           <span class="c1"># long time (5s)</span>
<span class="go">((-q^3*u^20+q^3*u^18+q^2*u^2-q^2)/(-q^3*u^28+q^2*u^22+q*u^6-1))*B[(0, 0, 0, 0)]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^6+1))*B[(1/2, 1/2, -1/2, -1/2)] + ((-q*u^2+q)/(-q*u^6+1))*B[(1/2, 1/2, -1/2, 1/2)]</span>
<span class="go">+ ((-q*u^2+q)/(-q*u^6+1))*B[(1/2, 1/2, 1/2, -1/2)] + ((-q*u^2+q)/(-q*u^6+1))*B[(1/2, 1/2, 1/2, 1/2)]</span>
<span class="go">+ ((q*u^2-q)/(q*u^6-1))*B[(1, 0, 0, 0)] + B[(1, 1, 0, 0)] + ((-q*u^2+q)/(-q*u^6+1))*B[(0, 1, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))]</span>                                     <span class="c1"># long time (23s)</span>
<span class="go">((q^3*u^18-q^3*u^16+q*u^4-q^2*u^2-2*q*u^2+q^2+q)/(q^3*u^18-q^2*u^12-q*u^6+1))*B[(0, 0, 0, 0)]</span>
<span class="go">+ ((-q^3*u^18+q^3*u^16+q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(1/2, -1/2, -1/2, -1/2)]</span>
<span class="go">+ ((-q^3*u^18+q^3*u^16+q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(1/2, -1/2, -1/2, 1/2)]</span>
<span class="go">+ ((q^3*u^18-q^3*u^16-q*u^2+q)/(q^3*u^18-q^2*u^12-q*u^6+1))*B[(1/2, -1/2, 1/2, -1/2)]</span>
<span class="go">+ ((q^3*u^18-q^3*u^16-q*u^2+q)/(q^3*u^18-q^2*u^12-q*u^6+1))*B[(1/2, -1/2, 1/2, 1/2)]</span>
<span class="go">+ ((q*u^8-q*u^6-q*u^2+q)/(q^3*u^18-q^2*u^12-q*u^6+1))*B[(1/2, 1/2, -1/2, -1/2)]</span>
<span class="go">+ ((q*u^8-q*u^6-q*u^2+q)/(q^3*u^18-q^2*u^12-q*u^6+1))*B[(1/2, 1/2, -1/2, 1/2)]</span>
<span class="go">+ ((-q*u^8+q*u^6+q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(1/2, 1/2, 1/2, -1/2)]</span>
<span class="go">+ ((-q*u^8+q*u^6+q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(1/2, 1/2, 1/2, 1/2)]</span>
<span class="go">+ ((-q^2*u^18+q^2*u^16-q*u^8+q*u^6+q*u^2+u^2-q-1)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(1, 0, 0, 0)]</span>
<span class="go">+ B[(1, -1, 0, 0)] + ((-u^2+1)/(-q^2*u^12+1))*B[(1, 1, 0, 0)] + ((-u^2+1)/(-q^2*u^12+1))*B[(1, 0, -1, 0)]</span>
<span class="go">+ ((u^2-1)/(q^2*u^12-1))*B[(1, 0, 1, 0)] + ((-u^2+1)/(-q^2*u^12+1))*B[(1, 0, 0, -1)]</span>
<span class="go">+ ((-u^2+1)/(-q^2*u^12+1))*B[(1, 0, 0, 1)] + ((-q*u^2+q)/(-q*u^6+1))*B[(0, -1, 0, 0)]</span>
<span class="go">+ ((-q*u^4+2*q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(0, 1, 0, 0)]</span>
<span class="go">+ ((-q*u^4+2*q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(0, 0, -1, 0)]</span>
<span class="go">+ ((-q*u^4+2*q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(0, 0, 1, 0)]</span>
<span class="go">+ ((-q*u^4+2*q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(0, 0, 0, -1)]</span>
<span class="go">+ ((-q*u^4+2*q*u^2-q)/(-q^3*u^18+q^2*u^12+q*u^6-1))*B[(0, 0, 0, 1)]</span>
</pre></div>
</div>
<p>Next we test a twisted type (checked against Maple computation by
Bogdan Ion for <span class="math notranslate nohighlight">\(q_1=t^2\)</span> and <span class="math notranslate nohighlight">\(q_2=-1\)</span>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(1, 0, 0)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(-1, 0, 0)] + ((-q*q1^6-q*q1^5*q2-q1*q2^5-q2^6)/(-q^3*q1^6-q^2*q1^5*q2-q*q1*q2^5-q2^6))*B[(1, 0, 0)] + ((-q1-q2)/(-q*q1-q2))*B[(0, -1, 0)]</span>
<span class="go">+ ((q1+q2)/(q*q1+q2))*B[(0, 1, 0)] + ((-q1-q2)/(-q*q1-q2))*B[(0, 0, -1)] + ((-q1-q2)/(-q*q1-q2))*B[(0, 0, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((-q1*q2^3-q2^4)/(q*q1^4-q2^4))*B[(1, 0, 0)] + B[(0, 1, 0)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((q^2*q1^7+q^2*q1^6*q2-q1*q2^6-q2^7)/(q^3*q1^7-q^2*q1^5*q2^2+q*q1^2*q2^5-q2^7))*B[(1, 0, 0)] + B[(0, -1, 0)]</span>
<span class="go">+ ((q*q1^5*q2^2+q*q1^4*q2^3-q1*q2^6-q2^7)/(q^3*q1^7-q^2*q1^5*q2^2+q*q1^2*q2^5-q2^7))*B[(0, 1, 0)]</span>
<span class="go">+ ((-q1*q2-q2^2)/(q*q1^2-q2^2))*B[(0, 0, -1)] + ((q1*q2+q2^2)/(-q*q1^2+q2^2))*B[(0, 0, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((-q^3*q1^6-q^3*q1^5*q2-2*q^2*q1^6-3*q^2*q1^5*q2+q^2*q1^4*q2^2+2*q^2*q1^3*q2^3+q*q1^5*q2+2*q*q1^4*q2^2-q*q1^3*q2^3-2*q*q1^2*q2^4+q*q1*q2^5+q*q2^6-q1^3*q2^3-q1^2*q2^4+2*q1*q2^5+2*q2^6)/(-q^4*q1^6-q^3*q1^5*q2+q^3*q1^4*q2^2-q*q1^2*q2^4+q*q1*q2^5+q2^6))*B[(0, 0, 0)] + B[(-1, -1, 0)]</span>
<span class="go">+ ((q*q1^4+q*q1^3*q2+q1*q2^3+q2^4)/(q^3*q1^4+q^2*q1^3*q2+q*q1*q2^3+q2^4))*B[(-1, 1, 0)] + ((q1+q2)/(q*q1+q2))*B[(-1, 0, -1)] + ((-q1-q2)/(-q*q1-q2))*B[(-1, 0, 1)]</span>
<span class="go">+ ((q*q1^4+q*q1^3*q2+q1*q2^3+q2^4)/(q^3*q1^4+q^2*q1^3*q2+q*q1*q2^3+q2^4))*B[(1, -1, 0)]</span>
<span class="go">+ ((-q^2*q1^6-q^2*q1^5*q2-q*q1^5*q2+q*q1^3*q2^3+q1^5*q2+q1^4*q2^2-q1^3*q2^3-q1^2*q2^4+q1*q2^5+q2^6)/(-q^4*q1^6-q^3*q1^5*q2+q^3*q1^4*q2^2-q*q1^2*q2^4+q*q1*q2^5+q2^6))*B[(1, 1, 0)]</span>
<span class="go">+ ((-q*q1^4-2*q*q1^3*q2-q*q1^2*q2^2+q1^3*q2+q1^2*q2^2-q1*q2^3-q2^4)/(-q^3*q1^4-q^2*q1^3*q2-q*q1*q2^3-q2^4))*B[(1, 0, -1)]</span>
<span class="go">+ ((-q*q1^4-2*q*q1^3*q2-q*q1^2*q2^2+q1^3*q2+q1^2*q2^2-q1*q2^3-q2^4)/(-q^3*q1^4-q^2*q1^3*q2-q*q1*q2^3-q2^4))*B[(1, 0, 1)] + ((q1+q2)/(q*q1+q2))*B[(0, -1, -1)]</span>
<span class="go">+ ((-q1-q2)/(-q*q1-q2))*B[(0, -1, 1)] + ((q*q1^4+2*q*q1^3*q2+q*q1^2*q2^2-q1^3*q2-q1^2*q2^2+q1*q2^3+q2^4)/(q^3*q1^4+q^2*q1^3*q2+q*q1*q2^3+q2^4))*B[(0, 1, -1)]</span>
<span class="go">+ ((q*q1^4+2*q*q1^3*q2+q*q1^2*q2^2-q1^3*q2-q1^2*q2^2+q1*q2^3+q2^4)/(q^3*q1^4+q^2*q1^3*q2+q*q1*q2^3+q2^4))*B[(0, 1, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((q^3*q1^7+q^3*q1^6*q2-q*q1*q2^6-q*q2^7)/(q^3*q1^7-q^2*q1^5*q2^2+q*q1^2*q2^5-q2^7))*B[(0, 0, 0)] + B[(1, -1, 0)]</span>
<span class="go">+ ((q*q1^5*q2^2+q*q1^4*q2^3-q1*q2^6-q2^7)/(q^3*q1^7-q^2*q1^5*q2^2+q*q1^2*q2^5-q2^7))*B[(1, 1, 0)] + ((-q1*q2-q2^2)/(q*q1^2-q2^2))*B[(1, 0, -1)]</span>
<span class="go">+ ((q1*q2+q2^2)/(-q*q1^2+q2^2))*B[(1, 0, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">((-q1*q2^2-q2^3)/(-q*q1^3-q2^3))*B[(1, 0, 0)] + ((-q1*q2^2-q2^3)/(-q*q1^3-q2^3))*B[(0, 1, 0)] + B[(0, 0, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">((q*q1^4*q2+q*q1^3*q2^2-q1*q2^4-q2^5)/(-q^2*q1^5-q2^5))*B[(1, 0, 0)] + ((q*q1^4*q2+q*q1^3*q2^2-q1*q2^4-q2^5)/(-q^2*q1^5-q2^5))*B[(0, 1, 0)]</span>
<span class="go">+ B[(0, 0, -1)] + ((-q1*q2^4-q2^5)/(-q^2*q1^5-q2^5))*B[(0, 0, 1)]</span>
</pre></div>
</div>
<p class="rubric">Comparison with the energy function of crystals</p>
<p>Next we test that the nonsymmetric Macdonald polynomials at <span class="math notranslate nohighlight">\(t=0\)</span>
match with the one-dimensional configuration sums involving
Kirillov-Reshetikhin crystals for various types. See
<a class="reference internal" href="#lnsss12" id="id4">[LNSSS12]</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="go">B[(-1, 0, 0)] + B[(1, 0, 0)] + B[(0, -1, 0)] + B[(0, 1, 0)] + B[(0, 0, -1)] + B[(0, 0, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>   <span class="c1"># long time (3s)</span>
<span class="go">(q+2)*B[(0, 0, 0)] + B[(-1, -1, 0)] + B[(-1, 1, 0)] + B[(-1, 0, -1)]</span>
<span class="go">+ B[(-1, 0, 1)] + B[(1, -1, 0)] + B[(1, 1, 0)] + B[(1, 0, -1)] + B[(1, 0, 1)]</span>
<span class="go">+ B[(0, -1, -1)] + B[(0, -1, 1)] + B[(0, 1, -1)] + B[(0, 1, 1)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>   <span class="c1"># long time (5s)</span>
<span class="go">2*B[(0, 0, 0)] + B[(-1, -1, 0)] + B[(-1, 1, 0)] + B[(-1, 0, -1)]</span>
<span class="go">+ B[(-1, 0, 1)] + B[(1, -1, 0)] + B[(1, 1, 0)] + B[(1, 0, -1)] + B[(1, 0, 1)]</span>
<span class="go">+ B[(0, -1, -1)] + B[(0, -1, 1)] + B[(0, 1, -1)] + B[(0, 1, 1)]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (15s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">La</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (45s)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>                                  <span class="c1"># long time (10s)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="n">IntegerVectors</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">weight</span> <span class="o">=</span> <span class="n">x</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">....: </span>        <span class="n">weight0</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">....: </span>        <span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">E</span><span class="p">[</span><span class="n">weight0</span><span class="p">]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (23s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">KirillovReshetikhin</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">TensorProduct</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (2s)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (21s)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;BC&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dual</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># long time (30s)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>           <span class="c1"># long time (1.5s)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">support</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>                           <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">parent</span><span class="p">())</span>                             <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">B</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">g</span>                  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">dual</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (149s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">La</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time (23s)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The next test breaks if the energy is not scaled by the
translation factor for dual type <span class="math notranslate nohighlight">\(G_2^{(1)}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">La</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">La</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>                                  <span class="c1"># long time (41s)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="ow">in</span> <span class="n">IntegerVectors</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">weight</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">La</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">....: </span>        <span class="n">weight0</span> <span class="o">=</span> <span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">c</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">d</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">....: </span>        <span class="n">LS</span> <span class="o">=</span> <span class="n">crystals</span><span class="o">.</span><span class="n">ProjectedLevelZeroLSPaths</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">assert</span> <span class="n">E</span><span class="p">[</span><span class="n">weight0</span><span class="p">]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">==</span> <span class="n">LS</span><span class="o">.</span><span class="n">one_dimensional_configuration_sum</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">add his notes in latex</p>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;BC&#39;, 2, 2]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">2*e[&#39;delta&#39;]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: -e[0] + e[&#39;delta&#39;], 1: e[0] - e[1], 2: 2*e[1]}</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;C&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span><span class="n">q1</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="o">=</span><span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1: (1, -1), 2: (0, 2)}</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q*q1*q2^3-q*q2^4)/(q^2*q1^4-q2^4))*B[(0, 0)] + B[(1, 0)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>      <span class="c1"># long time # not checked against Bogdan&#39;s notes, but a good self-consistency test</span>
<span class="go">((-q^12*q1^6-q^12*q1^5*q2+2*q^10*q1^5*q2+5*q^10*q1^4*q2^2+3*q^10*q1^3*q2^3+2*q^8*q1^5*q2+4*q^8*q1^4*q2^2+q^8*q1^3*q2^3-q^8*q1^2*q2^4+q^8*q1*q2^5+q^8*q2^6-q^6*q1^3*q2^3+q^6*q1^2*q2^4+4*q^6*q1*q2^5+2*q^6*q2^6+q^4*q1^3*q2^3+3*q^4*q1^2*q2^4+4*q^4*q1*q2^5+2*q^4*q2^6)/(-q^12*q1^6-q^10*q1^5*q2-q^8*q1^3*q2^3+q^6*q1^4*q2^2-q^6*q1^2*q2^4+q^4*q1^3*q2^3+q^2*q1*q2^5+q2^6))*B[(0, 0)] + ((q^7*q1^2*q2+2*q^7*q1*q2^2+q^7*q2^3+q^5*q1^2*q2+2*q^5*q1*q2^2+q^5*q2^3)/(-q^8*q1^3-q^6*q1^2*q2+q^2*q1*q2^2+q2^3))*B[(-1, 0)] + ((q^6*q1*q2+q^6*q2^2)/(-q^6*q1^2+q2^2))*B[(-1, -1)] + ((q^6*q1^2*q2+2*q^6*q1*q2^2+q^6*q2^3+q^4*q1^2*q2+2*q^4*q1*q2^2+q^4*q2^3)/(-q^8*q1^3-q^6*q1^2*q2+q^2*q1*q2^2+q2^3))*B[(-1, 1)] + ((q^3*q1*q2+q^3*q2^2)/(-q^6*q1^2+q2^2))*B[(-1, 2)] + ((-q^7*q1^3-q^7*q1^2*q2+q^7*q1*q2^2+q^7*q2^3+2*q^5*q1^2*q2+4*q^5*q1*q2^2+2*q^5*q2^3+2*q^3*q1^2*q2+4*q^3*q1*q2^2+2*q^3*q2^3)/(-q^8*q1^3-q^6*q1^2*q2+q^2*q1*q2^2+q2^3))*B[(1, 0)] + ((-q^6*q1^2*q2-2*q^6*q1*q2^2-q^6*q2^3-q^4*q1^2*q2-2*q^4*q1*q2^2-q^4*q2^3)/(q^8*q1^3+q^6*q1^2*q2-q^2*q1*q2^2-q2^3))*B[(1, -1)] + ((q^8*q1^3+q^8*q1^2*q2+q^6*q1^3+q^6*q1^2*q2-q^6*q1*q2^2-q^6*q2^3-2*q^4*q1^2*q2-4*q^4*q1*q2^2-2*q^4*q2^3-q^2*q1^2*q2-3*q^2*q1*q2^2-2*q^2*q2^3)/(q^8*q1^3+q^6*q1^2*q2-q^2*q1*q2^2-q2^3))*B[(1, 1)] + ((-q^5*q1^2-q^5*q1*q2+q^3*q1*q2+q^3*q2^2+q*q1*q2+q*q2^2)/(-q^6*q1^2+q2^2))*B[(1, 2)] + ((-q^6*q1^2-q^6*q1*q2+q^4*q1*q2+q^4*q2^2+q^2*q1*q2+q^2*q2^2)/(-q^6*q1^2+q2^2))*B[(2, 0)] + ((q^3*q1*q2+q^3*q2^2)/(-q^6*q1^2+q2^2))*B[(2, -1)] + ((-q^5*q1^2-q^5*q1*q2+q^3*q1*q2+q^3*q2^2+q*q1*q2+q*q2^2)/(-q^6*q1^2+q2^2))*B[(2, 1)] + B[(2, 2)] + ((-q^7*q1^2*q2-2*q^7*q1*q2^2-q^7*q2^3-q^5*q1^2*q2-2*q^5*q1*q2^2-q^5*q2^3)/(q^8*q1^3+q^6*q1^2*q2-q^2*q1*q2^2-q2^3))*B[(0, -1)] + ((q^7*q1^3+q^7*q1^2*q2-q^7*q1*q2^2-q^7*q2^3-2*q^5*q1^2*q2-4*q^5*q1*q2^2-2*q^5*q2^3-2*q^3*q1^2*q2-4*q^3*q1*q2^2-2*q^3*q2^3)/(q^8*q1^3+q^6*q1^2*q2-q^2*q1*q2^2-q2^3))*B[(0, 1)] + ((-q^6*q1^2-q^6*q1*q2+q^4*q1*q2+q^4*q2^2+q^2*q1*q2+q^2*q2^2)/(-q^6*q1^2+q2^2))*B[(0, 2)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">recursion</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[0, 1, 0, 2, 1, 0, 2, 1, 0]</span>
</pre></div>
</div>
<p>Some tests that the <span class="math notranslate nohighlight">\(T\)</span> s are implemented properly by hand
defining the <span class="math notranslate nohighlight">\(Y\)</span> s in terms of them:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">_T_Y</span>
<span class="gp">sage: </span><span class="n">Ye1</span>     <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">scalar</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ye2</span>     <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">signs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">scalar</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">Yalpha0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">signs</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">scalar</span> <span class="o">=</span> <span class="n">q</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Yalpha1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">signs</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">scalar</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Yalpha2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">signs</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">scalar</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">Ye1</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q1^2/q2^2*B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">Ye2</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">((-q1)/q2)*B[(0, 0)]</span>

<span class="gp">sage: </span><span class="n">Yalpha0</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q2^2/(q*q1^2)*B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">Yalpha1</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">((-q1)/q2)*B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">Yalpha2</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q1^2/q2^2*B[(0, 0)]</span>
</pre></div>
</div>
<p>Testing the <span class="math notranslate nohighlight">\(Y\)</span> s directly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">Coroot lattice of the Root system of type [&#39;BC&#39;, 2, 2]</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">-2*e[0] + e[&#39;deltacheck&#39;]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e[0] - e[1]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">e[1]</span>

<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">word</span>
<span class="go">(0, 1, 2, 1)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">signs</span>
<span class="go">(-1, -1, -1, -1)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">scalar</span> <span class="c1"># mind that Sage&#39;s q is the usual q^{1/2}</span>
<span class="go">q1^2*q2^2/q</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q2^2/(q*q1^2)*B[(0, 0)]</span>

<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">word</span>
<span class="go">(1, 2, 0, 1, 2, 0)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">signs</span>
<span class="go">(1, 1, -1, 1, -1, 1)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">1/(-q1*q2)</span>

<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">word</span>    <span class="c1"># Bogdan says it should be the square of that; do we need to take translation factors into account or not?</span>
<span class="go">(2, 1, 0, 1)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">signs</span>
<span class="go">(1, 1, 1, -1)</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">1/(-q1*q2)</span>
</pre></div>
</div>
<p>Checking the provided nonsymmetric Macdonald polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E10</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span> <span class="o">+</span> <span class="n">KL0</span><span class="p">(</span> <span class="n">q</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">/</span><span class="n">q2</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">/</span><span class="n">q2</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">E10</span> <span class="o">==</span> <span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">E10</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[q*q1^2/q2^2, q2^3/(-q^2*q1^3), q1/(-q2)]</span>
</pre></div>
</div>
<p>Checking T0check:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T0check_on_basis</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T0check_on_basis</span><span class="o">.</span><span class="n">phi</span> <span class="c1"># note: this is in fact a0 phi</span>
<span class="go">(2, 0)</span>
<span class="gp">sage: </span><span class="n">T0check_on_basis</span><span class="o">.</span><span class="n">v</span>   <span class="c1"># what to match it with?</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">T0check_on_basis</span><span class="o">.</span><span class="n">j</span>   <span class="c1"># what to match it with?</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">T0check_on_basis</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">((-q1^2)/q2)*B[(1, 0)]</span>

<span class="gp">sage: </span><span class="n">T0check</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">_T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">T0check</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">((-q1^2)/q2)*B[(1, 0)]</span>
</pre></div>
</div>
<p>Systematic tests of nonsymmetric Macdonald polynomials in type
<span class="math notranslate nohighlight">\(A_1^{(1)}\)</span>, in the weight lattice. Each time, we specify the
eigenvalues for the action of <span class="math notranslate nohighlight">\(Y_{\alpha_0}\)</span>, and <span class="math notranslate nohighlight">\(Y_{\alpha_1}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span> <span class="n">x</span>
<span class="go">B[0]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">[1/(q*t), t]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Algebra of the Weight lattice of the Root system of type [&#39;A&#39;, 1]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, t over Rational Field</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[t, 1/(q*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q*t+q)/(-q*t+1))*B[0] + B[2*Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[q*t, 1/(q^2*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q^2*t+q^2)/(-q^2*t+1))*B[-Lambda[1]] + ((-q^2*t+q^2-q*t+q)/(-q^2*t+1))*B[Lambda[1]] + B[3*Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[q^2*t, 1/(q^3*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">4</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((q^5*t^2-q^5*t+q^4*t^2-2*q^4*t+q^3*t^2+q^4-2*q^3*t+q^3-q^2*t+q^2)/(q^5*t^2-q^3*t-q^2*t+1))*B[0] + ((-q^3*t+q^3)/(-q^3*t+1))*B[-2*Lambda[1]] + ((-q^3*t+q^3-q^2*t+q^2-q*t+q)/(-q^3*t+1))*B[2*Lambda[1]] + B[4*Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[q^3*t, 1/(q^4*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">6</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q^12*t^3+q^12*t^2-q^11*t^3+2*q^11*t^2-2*q^10*t^3-q^11*t+4*q^10*t^2-2*q^9*t^3-2*q^10*t+5*q^9*t^2-2*q^8*t^3-4*q^9*t+6*q^8*t^2-q^7*t^3+q^9-5*q^8*t+5*q^7*t^2-q^6*t^3+q^8-6*q^7*t+4*q^6*t^2+2*q^7-5*q^6*t+2*q^5*t^2+2*q^6-4*q^5*t+q^4*t^2+2*q^5-2*q^4*t+q^4-q^3*t+q^3)/(-q^12*t^3+q^9*t^2+q^8*t^2+q^7*t^2-q^5*t-q^4*t-q^3*t+1))*B[0] + ((-q^5*t+q^5)/(-q^5*t+1))*B[-4*Lambda[1]] + ((q^9*t^2-q^9*t+q^8*t^2-2*q^8*t+q^7*t^2+q^8-2*q^7*t+q^6*t^2+q^7-2*q^6*t+q^5*t^2+q^6-2*q^5*t+q^5-q^4*t+q^4)/(q^9*t^2-q^5*t-q^4*t+1))*B[-2*Lambda[1]] + ((q^9*t^2-q^9*t+q^8*t^2-2*q^8*t+2*q^7*t^2+q^8-3*q^7*t+2*q^6*t^2+q^7-4*q^6*t+2*q^5*t^2+2*q^6-4*q^5*t+q^4*t^2+2*q^5-3*q^4*t+q^3*t^2+2*q^4-2*q^3*t+q^3-q^2*t+q^2)/(q^9*t^2-q^5*t-q^4*t+1))*B[2*Lambda[1]] + ((q^5*t-q^5+q^4*t-q^4+q^3*t-q^3+q^2*t-q^2+q*t-q)/(q^5*t-1))*B[4*Lambda[1]] + B[6*Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[q^5*t, 1/(q^6*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[-Lambda[1]] + ((-t+1)/(-q*t+1))*B[Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[(-1)/(-q^2*t), q*t]</span>
</pre></div>
</div>
<p>As expected, <span class="math notranslate nohighlight">\(e^{-\omega}\)</span> is not an eigenvector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">AssertionError</span>
</pre></div>
</div>
<p>We proceed by comparing against the examples from the appendix of
<a class="reference internal" href="#hhl06" id="id5">[HHL06]</a> in type <span class="math notranslate nohighlight">\(A_2^{(1)}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="s1">&#39;x1,x2,x3&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">EE</span><span class="p">(</span><span class="n">weight</span><span class="p">):</span> <span class="k">return</span> <span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">(</span><span class="n">weight</span><span class="p">)]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>

<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x1</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t^2 + 1))*x1 + x2</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t + 1))*x1 + ((-t + 1)/(-q*t + 1))*x2 + x3</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x1*x2</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t^2 + 1))*x1*x2 + x1*x3</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q*t + 1))*x1*x2 + ((-t + 1)/(-q*t + 1))*x1*x3 + x2*x3</span>
<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x1^2 + ((-q*t + q)/(-q*t + 1))*x1*x2 + ((-q*t + q)/(-q*t + 1))*x1*x3</span>

<span class="gp">sage: </span><span class="n">EE</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">((-t + 1)/(-q^2*t^2 + 1))*x1^2 + ((-q^2*t^3 + q^2*t^2 - q*t^2 + 2*q*t - q + t - 1)/(-q^3*t^3 + q^2*t^2 + q*t - 1))*x1*x2 + x2^2 + ((q*t^2 - 2*q*t + q)/(q^3*t^3 - q^2*t^2 - q*t + 1))*x1*x3 + ((-q*t + q)/(-q*t + 1))*x2*x3</span>
</pre></div>
</div>
<p>Systematic checks with Sage’s implementation of <a class="reference internal" href="#hhl06" id="id6">[HHL06]</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.combinat.sf.ns_macdonald</span> <span class="kn">as</span> <span class="nn">NS</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">EE</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span> <span class="o">==</span> <span class="n">NS</span><span class="o">.</span><span class="n">E</span><span class="p">([</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">])</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="ow">in</span> <span class="n">IntegerVectors</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="c1"># long time (9s)</span>
</pre></div>
</div>
<p>We check that we get eigenvectors for generic <span class="math notranslate nohighlight">\(q_1\)</span>, <span class="math notranslate nohighlight">\(q_2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((q*q1+q*q2)/(q*q1+q2))*B[(1, 2, 1)] + ((q*q1+q*q2)/(q*q1+q2))*B[(2, 1, 1)] + B[(2, 2, 0)]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>                                    <span class="c1"># long time (9s)</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">weight</span> <span class="ow">in</span> <span class="n">IntegerVectors</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">L0</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">L0</span><span class="p">(</span><span class="n">weight</span><span class="p">)])</span>
</pre></div>
</div>
<p>Some type <span class="math notranslate nohighlight">\(C\)</span> calculations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># checked for i=0 with previous calculation</span>
<span class="go">[1/(q*t^3), t, t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(1, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[t, 1/(q*t^3), t]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>          <span class="c1"># consistent with before refactoring</span>
<span class="go">B[(-1, 0)] + ((-t+1)/(-q*t+1))*B[(1, 0)] + ((-t+1)/(-q*t+1))*B[(0, -1)] + ((t-1)/(q*t-1))*B[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[(-1)/(-q^2*t^3), q*t, t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># consistent with before refactoring</span>
<span class="go">((-t+1)/(-q*t^3+1))*B[(1, 0)] + B[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[t, q*t^3, (-1)/(-q*t^2)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>  <span class="c1"># consistent with before refactoring</span>
<span class="go">((-t+1)/(-q*t^2+1))*B[(1, 0)] + B[(0, -1)] + ((-t+1)/(-q*t^2+1))*B[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[1/(q^2*t^3), 1/(q*t), q*t^2]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((-q^2*t^4+q^2*t^3-q*t^3+2*q*t^2-q*t+t-1)/(-q^3*t^4+q^2*t^3+q*t-1))*B[(0, 0)] + B[(-1, -1)] + ((-t+1)/(-q*t+1))*B[(-1, 1)] + ((t-1)/(q*t-1))*B[(1, -1)] + ((-q*t^4+q*t^3+t-1)/(-q^3*t^4+q^2*t^3+q*t-1))*B[(1, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked                       # long time (1s)</span>
<span class="go">[1/(q^3*t^3), t, q*t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">c</span><span class="p">:</span> <span class="n">c</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>     <span class="c1"># checking againsts crystals</span>
<span class="go">B[(0, 0)] + B[(-1, -1)] + B[(-1, 1)] + B[(1, -1)] + B[(1, 1)]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">((-q^6*t^7+q^6*t^6-q^5*t^6+2*q^5*t^5-q^4*t^5-q^5*t^3+3*q^4*t^4-3*q^4*t^3+q^3*t^4+q^4*t^2-2*q^3*t^2+q^3*t-q^2*t+q^2)/(-q^6*t^7+q^5*t^6+q^4*t^4+q^3*t^4-q^3*t^3-q^2*t^3-q*t+1))*B[(0, 0)] + ((-q^3*t^2+q^3*t)/(-q^3*t^3+1))*B[(-1, -1)] + ((-q^3*t^3+2*q^3*t^2-q^3*t)/(-q^4*t^4+q^3*t^3+q*t-1))*B[(-1, 1)] + ((-q^3*t^3+2*q^3*t^2-q^3*t)/(-q^4*t^4+q^3*t^3+q*t-1))*B[(1, -1)] + ((-q^4*t^4+q^4*t^3-q^3*t^3+2*q^3*t^2-q^2*t^3-q^3*t+2*q^2*t^2-q^2*t+q*t-q)/(-q^4*t^4+q^3*t^3+q*t-1))*B[(1, 1)] + ((q*t-q)/(q*t-1))*B[(2, 0)] + B[(2, 2)] + ((-q*t+q)/(-q*t+1))*B[(0, 2)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># not checked</span>
<span class="go">[q^3*t^3, t, (-1)/(-q^2*t^2)]</span>
</pre></div>
</div>
<p>The following computations were calculated by hand:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E11</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">sum_of_terms</span><span class="p">([[</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">E11</span> <span class="o">==</span> <span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">E11</span><span class="p">)</span>
<span class="go">[q*t^3, t, (-1)/(-q*t^2)]</span>

<span class="gp">sage: </span><span class="n">E1m1</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">sum_of_terms</span><span class="p">([[</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)],</span> <span class="p">[</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)]</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">E1m1</span> <span class="o">==</span> <span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">E1m1</span><span class="p">)</span>
<span class="go">[1/(q*t), 1/(q^2*t^3), q*t^2]</span>
</pre></div>
</div>
<p>Now we present an example for a twisted affine root system. The
results are eigenvectors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;C2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[1/(q*t^2), t, t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q*t+q)/(-q*t^2+1))*B[(0, 0)] + B[(1, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[q*t^2, 1/(q^2*t^3), t]</span>

<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q*t+q-t+1)/(-q^2*t+1))*B[(0, 0)] + B[(-1, 0)] + ((-t+1)/(-q^2*t+1))*B[(1, 0)] + ((-t+1)/(-q^2*t+1))*B[(0, -1)] + ((t-1)/(q^2*t-1))*B[(0, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[(-1)/(-q^3*t^2), q^2*t, t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">B[(-1/2, 1/2)] + ((-t+1)/(-q^2*t^3+1))*B[(1/2, -1/2)] + ((-q*t^3+q*t^2-t+1)/(-q^2*t^3+1))*B[(1/2, 1/2)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[(-1)/(-q^2*t^2), q^2*t^3, (-1)/(-q*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">B[(1/2, -1/2)] + ((-t+1)/(-q*t^2+1))*B[(1/2, 1/2)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">[t, 1/(q^2*t^3), q*t^2]</span>
</pre></div>
</div>
<p>Type BC, comparison with calculations with Maple by Bogdan Ion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">to_SR</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">.</span><span class="n">expand</span><span class="p">([</span><span class="n">SR</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">i</span>) for i in range(1,x.parent().basis().keys().dimension()+1)]).subs(q=SR.var(&#39;q&#39;), t=SR.var(&#39;t&#39;))
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x1,x2,x3&#39;</span><span class="p">)</span>
<span class="go">(x1, x2, x3)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">q2</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">to_SR</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="o">-</span> <span class="n">expected</span>                       <span class="c1"># long time (3.5s)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">q2</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">omega</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span> <span class="n">mu</span>
<span class="go">(-1, 2, -1)</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x3</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">*</span><span class="n">x2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">14</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x3</span><span class="o">*</span><span class="n">x2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">to_SR</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">mu</span><span class="p">])</span> <span class="o">-</span> <span class="n">expected</span>                               <span class="c1"># long time (20s)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">q2</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">omega</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">mu</span>
<span class="go">(-4)</span>
<span class="gp">sage: </span><span class="n">expected</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">7</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">26</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">30</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">32</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">34</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">26</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">28</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">30</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">32</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">30</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">-</span><span class="mi">9</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">26</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">28</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="mi">11</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">28</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">-</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">26</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">22</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">24</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">12</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">18</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">16</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">6</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">14</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">6</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">4</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">q</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="p">((</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">7</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">x1</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="p">((</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">to_SR</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">mu</span><span class="p">])</span> <span class="o">-</span> <span class="n">expected</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Type <span class="math notranslate nohighlight">\(BC\)</span> dual, comparison with hand calculations by Bogdan Ion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ct</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="o">=</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="o">=</span><span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">domain</span><span class="p">();</span> <span class="n">KL</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">();</span> <span class="n">alpha</span>
<span class="go">Finite family {1: (1, -1), 2: (0, 1)}</span>
<span class="gp">sage: </span><span class="n">omega</span><span class="o">=</span><span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">();</span> <span class="n">omega</span>
<span class="go">Finite family {1: (1, 0), 2: (1/2, 1/2)}</span>
<span class="gp">sage: </span><span class="n">epsilon</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">basis</span><span class="p">();</span> <span class="n">epsilon</span>
<span class="go">Finite family {0: (1, 0), 1: (0, 1)}</span>
</pre></div>
</div>
<p>Note: Sage’s <span class="math notranslate nohighlight">\(q\)</span> is the usual <span class="math notranslate nohighlight">\(q^2\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">L</span><span class="p">()</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">e[&#39;delta&#39;]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">L</span><span class="p">()</span><span class="o">.</span><span class="n">null_coroot</span><span class="p">()</span>
<span class="go">2*e[&#39;deltacheck&#39;]</span>
</pre></div>
</div>
<p>Some eigenvectors:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="go">((-q^2*q1^3*q2-q^2*q1^2*q2^2)/(q^2*q1^4-q2^4))*B[(0, 0)] + B[(1, 0)]</span>
<span class="gp">sage: </span><span class="n">Eomega1</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">one</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">/</span><span class="n">q2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">/</span><span class="n">q2</span><span class="p">)))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">q1</span><span class="o">/</span><span class="n">q2</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="n">Eomega1</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking the <span class="math notranslate nohighlight">\(Y\)</span> s:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y0</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">Y1</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">Y2</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

<span class="gp">sage: </span><span class="n">Y0</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Y0</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Y0</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">((0, 1, 2, 1, 0, 1, 2, 1), (-1, -1, -1, -1, -1, -1, -1, -1), q1^4*q2^4/q^2)</span>
<span class="gp">sage: </span><span class="n">Y1</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Y1</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Y1</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">((1, 2, 0, 1, 2, 0), (1, 1, -1, 1, -1, 1), 1/(-q1*q2))</span>
<span class="gp">sage: </span><span class="n">Y2</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Y2</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Y2</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">((2, 1, 0, 1), (1, 1, 1, -1), 1/(-q1*q2))</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[q2^4/(q^2*q1^4), q1/(-q2), q1/(-q2)]</span>
</pre></div>
</div>
<p>Checking the <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(T^{-1}\)</span> s:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">_T_Y</span>
<span class="gp">sage: </span><span class="n">Tinv0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Tinv1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Tinv2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
<span class="gp">....: </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">Tinv0</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">Tinv0</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">Tinv1</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">Tinv1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">Tinv2</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">](</span><span class="n">Tinv2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="n">x</span>

<span class="gp">sage: </span><span class="n">start</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]];</span> <span class="n">start</span>
<span class="go">((-q^2*q1^3*q2-q^2*q1^2*q2^2)/(q^2*q1^4-q2^4))*B[(0, 0)] + B[(1, 0)]</span>
<span class="gp">sage: </span><span class="n">Tinv1</span><span class="p">(</span><span class="n">Tinv2</span><span class="p">(</span><span class="n">Tinv1</span><span class="p">(</span><span class="n">Tinv0</span><span class="p">(</span><span class="n">Tinv1</span><span class="p">(</span><span class="n">Tinv2</span><span class="p">(</span><span class="n">Tinv1</span><span class="p">(</span><span class="n">Tinv0</span><span class="p">(</span><span class="n">start</span><span class="p">))))))))</span> <span class="o">*</span> <span class="p">(</span><span class="n">q1</span><span class="o">*</span><span class="n">q2</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="n">q</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">Y0</span><span class="p">(</span><span class="n">start</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Y0</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="o">==</span> <span class="n">q</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">q1</span><span class="o">^</span><span class="mi">4</span><span class="o">/</span><span class="n">q2</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">start</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Checking the relation between the <span class="math notranslate nohighlight">\(Y\)</span> s:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">q</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Y0</span><span class="p">(</span><span class="n">Y1</span><span class="p">(</span><span class="n">Y1</span><span class="p">(</span><span class="n">Y2</span><span class="p">(</span><span class="n">Y2</span><span class="p">(</span><span class="n">start</span><span class="p">)))))</span> <span class="o">==</span> <span class="n">start</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="o">*</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">epsilon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">epsilon</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
<span class="gp">....: </span>    <span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="k">assert</span> <span class="n">q</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Y0</span><span class="p">(</span><span class="n">Y1</span><span class="p">(</span><span class="n">Y1</span><span class="p">(</span><span class="n">Y2</span><span class="p">(</span><span class="n">Y2</span><span class="p">(</span><span class="n">start</span><span class="p">)))))</span> <span class="o">==</span> <span class="n">start</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.KL0">
<code class="descname">KL0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.KL0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the group algebra where the nonsymmetric Macdonald polynomials live.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">KL0</span><span class="p">()</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">KL0</span><span class="p">()</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
<span class="go">over Fraction Field of Multivariate Polynomial Ring in q, q1, q2 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L">
<code class="descname">L</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the affinization of the classical weight space.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L0">
<code class="descname">L0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L0" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the space indexing the monomials of the nonsymmetric Macdonald polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L0</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L0</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_check">
<code class="descname">L_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the other affinization of the classical weight space.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">should this just return <span class="math notranslate nohighlight">\(L\)</span> in the simply laced case?</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">L_check</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">L_check</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime">
<code class="descname">L_prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>The affine space where classical weights are lifted for the recursion.</p>
<p>Also the parent of <span class="math notranslate nohighlight">\(\rho'\)</span>.</p>
<p>EXAMPLES:</p>
<p>In the twisted case, this is the affinization of the classical
ambient space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]^*</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]^*</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
</pre></div>
</div>
<p>In the untwisted case, this is the other affinization of the
classical ambient space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
</pre></div>
</div>
<p>For simply laced, the two affinizations coincide:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;A2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;A&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;A2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;A&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;A2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;A&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;A2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;A&#39;, 2]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">do we want the coambient space of type <span class="math notranslate nohighlight">\(A_2^{(1)}\)</span> instead?</p>
</div>
<p>For type BC:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">L_prime</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;BC&#39;, 3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.Q_to_Qcheck">
<code class="descname">Q_to_Qcheck</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.Q_to_Qcheck" title="Permalink to this definition">¶</a></dt>
<dd><p>The reindexing of the index set of the Y’s by the coroot lattice.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;C2~&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">Q_to_Qcheck</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">alphacheck[0] - alphacheck[2]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">Q_to_Qcheck</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">alphacheck[1]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">Q_to_Qcheck</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">alphacheck[2]</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Root lattice of the Root system of type [&#39;B&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">Q_to_Qcheck</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">alphacheck[1] + 2*alphacheck[2]</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Coroot lattice of the Root system of type [&#39;C&#39;, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.Y">
<code class="descname">Y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.Y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the family of <span class="math notranslate nohighlight">\(Y\)</span> operators whose eigenvectors are the nonsymmetric Macdonald polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;C2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="go">Lazy family (&lt;lambda&gt;(i))_{i in Root lattice of the Root system of type [&#39;B&#39;, 2, 1]}</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Root lattice of the Root system of type [&#39;B&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;C2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="go">Lazy family (&lt;...Y_lambdacheck...&gt;(i))_{i in Coroot lattice of the Root system of type [&#39;C&#39;, 2, 1]^*}</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Root lattice of the Root system of type [&#39;C&#39;, 2]</span>

<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="go">Lazy family (&lt;...Y_lambdacheck...&gt;(i))_{i in Coroot lattice of the Root system of type [&#39;BC&#39;, 3, 2]}</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Root lattice of the Root system of type [&#39;B&#39;, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_lift">
<code class="descname">affine_lift</code><span class="sig-paren">(</span><em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_lift" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the affinization of <span class="math notranslate nohighlight">\(\mu\)</span> in <span class="math notranslate nohighlight">\(L'\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mu</span></code> – a classical weight <span class="math notranslate nohighlight">\(\mu\)</span></li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="hecke_algebra_representation.html#sage.combinat.root_system.hecke_algebra_representation.CherednikOperatorsEigenvectors.affine_lift" title="sage.combinat.root_system.hecke_algebra_representation.CherednikOperatorsEigenvectors.affine_lift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">hecke_algebra_representation.CherednikOperatorsEigenvectors.affine_lift()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_retract" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_retract"><code class="xref py py-meth docutils literal notranslate"><span class="pre">affine_retract()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">L_prime()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>In the untwisted case, this is the other affinization at level 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">();</span> <span class="n">L0</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e[0] + e[&#39;deltacheck&#39;]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
</pre></div>
</div>
<p>In the twisted case, this is the usual affinization at level 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">();</span> <span class="n">L0</span>
<span class="go">Ambient space of the Root system of type [&#39;C&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e[0] + e[&#39;deltacheck&#39;]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]^*</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_retract">
<code class="descname">affine_retract</code><span class="sig-paren">(</span><em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_retract" title="Permalink to this definition">¶</a></dt>
<dd><p>Retract the affine weight <span class="math notranslate nohighlight">\(\mu\)</span> into a classical weight.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mu</span></code> – an affine weight <span class="math notranslate nohighlight">\(\mu\)</span> in <span class="math notranslate nohighlight">\(L'\)</span></li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><code class="xref py py-meth docutils literal notranslate"><span class="pre">hecke_algebra_representation.HeckeAlgebraRepresentation.affine_retract()</span></code></li>
<li><a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_lift" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.affine_lift"><code class="xref py py-meth docutils literal notranslate"><span class="pre">affine_lift()</span></code></a></li>
<li><a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">L_prime()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">();</span> <span class="n">L0</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2]</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e[0] + e[&#39;deltacheck&#39;]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">affine_retract</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">affine_lift</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">(1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.cartan_type">
<code class="descname">cartan_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.cartan_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Cartan type of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;B&#39;, 2, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.eigenvalue_experimental">
<code class="descname">eigenvalue_experimental</code><span class="sig-paren">(</span><em>mu</em>, <em>l</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.eigenvalue_experimental" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the eigenvalue of <span class="math notranslate nohighlight">\(Y^{\lambda^\vee}\)</span> acting on the macdonald polynomial <span class="math notranslate nohighlight">\(E_\mu\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mu</span></code> – the index <span class="math notranslate nohighlight">\(\mu\)</span> of an eigenvector</li>
<li><span class="math notranslate nohighlight">\(l\)</span> – an index <span class="math notranslate nohighlight">\(\lambda^\vee\)</span> of some <span class="math notranslate nohighlight">\(Y\)</span></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>This method is currently not used; most tests below even
test the naive method. They are left here as a basis for
a future implementation.</li>
<li>This is actually equivariant, as long as <span class="math notranslate nohighlight">\(s_i\)</span> does not
fix <span class="math notranslate nohighlight">\(\lambda\)</span>.</li>
<li>This method is only really needed for
<span class="math notranslate nohighlight">\(\lambda^\vee=\alpha^\vee_i\)</span> with <span class="math notranslate nohighlight">\(i=0,...,n\)</span>.</li>
</ul>
</div>
<p>See Corollary 6.11 of <a class="reference internal" href="root_lattice_realization_algebras.html#haiman06" id="id7">[Haiman06]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span> <span class="o">=</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span> <span class="c1"># Checked by hand by Mark and Arun</span>
<span class="go">[1/(q*t), t]</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue_experimental</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># todo: not implemented</span>
<span class="go">1/(q*t)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue_experimental</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">t</span>
</pre></div>
</div>
<p>Some examples of eigenvalues (not mathematically checked!!!):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[t, 1/(q*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[1/(q^2*t), q*t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[1/(q*t), t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[t, 1/(q*t)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[(-1)/(-q^3*t), q^2*t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[(-1)/(-q^4*t), q^3*t]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">[(-1)/(-q^3*t), q^2*t]</span>
</pre></div>
</div>
<p>Some type <span class="math notranslate nohighlight">\(B\)</span> examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span> <span class="o">=</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">simple_coroots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># not checked # not tested</span>
<span class="go">q/t</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># What Mark got by hand # not tested</span>
<span class="go">q</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># not checked # not tested</span>
<span class="go">t</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># not checked # not tested</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="n">KL</span><span class="p">,</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">simple_coroots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">eigenvalue</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="n">alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># assuming Mark&#39;s calculation is correct, one should get # not tested</span>
<span class="go">1/(q*t^2)</span>
</pre></div>
</div>
<p>The expected value can more or less be read off from equation
(37), Corollary 6.15 of <a class="reference internal" href="root_lattice_realization_algebras.html#haiman06" id="id8">[Haiman06]</a></p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Use proposition 6.9 of <a class="reference internal" href="root_lattice_realization_algebras.html#haiman06" id="id9">[Haiman06]</a> to check the action
of the <span class="math notranslate nohighlight">\(Y\)</span> s on monomials.</li>
<li>Generalize to any <span class="math notranslate nohighlight">\(q_1\)</span>, <span class="math notranslate nohighlight">\(q_2\)</span>.</li>
<li>Check claim by Mark: all scalar products should occur in
the finite weight lattice, with alpha 0 being the
appropriate projection of the affine alpha 0. Question:
can this be emulated by being at level 0?</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.rho_prime">
<code class="descname">rho_prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.rho_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level 0 sum of the classical fundamental weights in <span class="math notranslate nohighlight">\(L'\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.L_prime"><code class="xref py py-meth docutils literal notranslate"><span class="pre">L_prime()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>Untwisted case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rho_prime</span><span class="p">()</span> <span class="c1"># CHECKME</span>
<span class="go">3/2*e[0] + 1/2*e[1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rho_prime</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Coambient space of the Root system of type [&#39;C&#39;, 2, 1]</span>
</pre></div>
</div>
<p>Twisted case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rho_prime</span><span class="p">()</span> <span class="c1"># CHECKME</span>
<span class="go">2*e[0] + e[1]</span>
<span class="gp">sage: </span><span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rho_prime</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Ambient space of the Root system of type [&#39;B&#39;, 2, 1]^*</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.seed">
<code class="descname">seed</code><span class="sig-paren">(</span><em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(E_\mu\)</span> for <span class="math notranslate nohighlight">\(\mu\)</span> minuscule, i.e. in the fundamental alcove.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mu</span></code> – the index <span class="math notranslate nohighlight">\(\mu\)</span> of an eigenvector</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">B[(1, 0, 0)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.symmetric_macdonald_polynomial">
<code class="descname">symmetric_macdonald_polynomial</code><span class="sig-paren">(</span><em>mu</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.symmetric_macdonald_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symmetric Macdonald polynomial indexed by <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mu</span></code> – a dominant weight <span class="math notranslate nohighlight">\(\mu\)</span></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The result is Weyl-symmetric only for Hecke parameters of
the form <span class="math notranslate nohighlight">\(q_1=v\)</span> and <span class="math notranslate nohighlight">\(q_2=-1/v\)</span>.  In general the value of
<span class="math notranslate nohighlight">\(v\)</span> below, should be the square root of <span class="math notranslate nohighlight">\(-q_1/q_2\)</span>, but the
use of <span class="math notranslate nohighlight">\(q_1=t\)</span> and <span class="math notranslate nohighlight">\(q_2=-1\)</span> results in nonintegral powers of <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,v,t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">om</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">L0</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">symmetric_macdonald_polynomial</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[(1, 1, 0)] + B[(1, 0, 1)] + B[(0, 1, 1)]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">symmetric_macdonald_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((q*v^2+v^2-q-1)/(q*v^2-1))*B[(1, 1, 0)] + ((q*v^2+v^2-q-1)/(q*v^2-1))*B[(1, 0, 1)] + B[(2, 0, 0)] + ((q*v^2+v^2-q-1)/(q*v^2-1))*B[(0, 1, 1)] + B[(0, 2, 0)] + B[(0, 0, 2)]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symmetric_macdonald_polynomial</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">L0</span><span class="p">()((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span> <span class="n">f</span>
<span class="go">((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(1, 1, 1)] + B[(1, 2, 0)] + B[(1, 0, 2)] + B[(2, 1, 0)] + B[(2, 0, 1)] + B[(0, 1, 2)] + B[(0, 2, 1)]</span>
</pre></div>
</div>
<p>We compare with the type <span class="math notranslate nohighlight">\(A\)</span> Macdonald polynomials
coming from symmetric functions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">SymmetricFunctions</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">macdonald</span><span class="p">()</span><span class="o">.</span><span class="n">P</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">P</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">g</span>
<span class="go">x0^2*x1 + x0*x1^2 + x0^2*x2 + ((-2*q*t^2 + q*t - t^2 + q - t + 2)/(-q*t^2 + 1))*x0*x1*x2 + x1^2*x2 + x0*x2^2 + x1*x2^2</span>
<span class="gp">sage: </span><span class="n">fe</span> <span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">());</span> <span class="n">fe</span>
<span class="go">x0^2*x1 + x0*x1^2 + x0^2*x2 + ((2*q*v^4 + v^4 - q*v^2 + v^2 - q - 2)/(q*v^4 - 1))*x0*x1*x2 + x1^2*x2 + x0*x2^2 + x1*x2^2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">map_coefficients</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="n">v</span><span class="o">*</span><span class="n">v</span><span class="p">))</span> <span class="o">==</span> <span class="n">fe</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">om</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">L0</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">symmetric_macdonald_polynomial</span><span class="p">(</span><span class="n">om</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">om</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">B[(-2, -1, 0)] + B[(-2, 1, 0)] + B[(-2, 0, -1)] + B[(-2, 0, 1)] + ((4*q^3*v^14+2*q^2*v^14-2*q^3*v^12+2*q^2*v^12-2*q^3*v^10+q*v^12-5*q^2*v^10-5*q*v^4+q^2*v^2-2*v^4+2*q*v^2-2*v^2+2*q+4)/(q^3*v^14-q^2*v^10-q*v^4+1))*B[(-1, 0, 0)] + B[(-1, -2, 0)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(-1, -1, -1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(-1, -1, 1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(-1, 1, -1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(-1, 1, 1)] + B[(-1, 2, 0)] + B[(-1, 0, -2)] + B[(-1, 0, 2)] + ((4*q^3*v^14+2*q^2*v^14-2*q^3*v^12+2*q^2*v^12-2*q^3*v^10+q*v^12-5*q^2*v^10-5*q*v^4+q^2*v^2-2*v^4+2*q*v^2-2*v^2+2*q+4)/(q^3*v^14-q^2*v^10-q*v^4+1))*B[(1, 0, 0)] + B[(1, -2, 0)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(1, -1, -1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(1, -1, 1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(1, 1, -1)] + ((2*q*v^4+v^4-q*v^2+v^2-q-2)/(q*v^4-1))*B[(1, 1, 1)] + B[(1, 2, 0)] + B[(1, 0, -2)] + B[(1, 0, 2)] + B[(2, -1, 0)] + B[(2, 1, 0)] + B[(2, 0, -1)] + B[(2, 0, 1)] + B[(0, -2, -1)] + B[(0, -2, 1)] + ((-4*q^3*v^14-2*q^2*v^14+2*q^3*v^12-2*q^2*v^12+2*q^3*v^10-q*v^12+5*q^2*v^10+5*q*v^4-q^2*v^2+2*v^4-2*q*v^2+2*v^2-2*q-4)/(-q^3*v^14+q^2*v^10+q*v^4-1))*B[(0, -1, 0)] + B[(0, -1, -2)] + B[(0, -1, 2)] + ((-4*q^3*v^14-2*q^2*v^14+2*q^3*v^12-2*q^2*v^12+2*q^3*v^10-q*v^12+5*q^2*v^10+5*q*v^4-q^2*v^2+2*v^4-2*q*v^2+2*v^2-2*q-4)/(-q^3*v^14+q^2*v^10+q*v^4-1))*B[(0, 1, 0)] + B[(0, 1, -2)] + B[(0, 1, 2)] + B[(0, 2, -1)] + B[(0, 2, 1)] + ((4*q^3*v^14+2*q^2*v^14-2*q^3*v^12+2*q^2*v^12-2*q^3*v^10+q*v^12-5*q^2*v^10-5*q*v^4+q^2*v^2-2*v^4+2*q*v^2-2*v^2+2*q+4)/(q^3*v^14-q^2*v^10-q*v^4+1))*B[(0, 0, -1)] + ((4*q^3*v^14+2*q^2*v^14-2*q^3*v^12+2*q^2*v^12-2*q^3*v^10+q*v^12-5*q^2*v^10-5*q*v^4+q^2*v^2-2*v^4+2*q*v^2-2*v^2+2*q+4)/(q^3*v^14-q^2*v^10-q*v^4+1))*B[(0, 0, 1)]</span>
</pre></div>
</div>
<p>An example for type <span class="math notranslate nohighlight">\(G\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">NonSymmetricMacdonaldPolynomials</span><span class="p">([</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">om</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">L0</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">symmetric_macdonald_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">om</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">((3*q^6*v^22+3*q^5*v^22-3*q^6*v^20+q^4*v^22-4*q^5*v^20+q^4*v^18-q^5*v^16+q^3*v^18-2*q^4*v^16+q^5*v^14-q^3*v^16+q^4*v^14-4*q^4*v^12+q^2*v^14+q^5*v^10-8*q^3*v^12+4*q^4*v^10-4*q^2*v^12+8*q^3*v^10-q*v^12-q^4*v^8+4*q^2*v^10-q^2*v^8+q^3*v^6-q*v^8+2*q^2*v^6-q^3*v^4+q*v^6-q^2*v^4+4*q*v^2-q^2+3*v^2-3*q-3)/(q^6*v^22-q^5*v^20-q^4*v^12-q^3*v^12+q^3*v^10+q^2*v^10+q*v^2-1))*B[(0, 0, 0)] + ((q*v^2+v^2-q-1)/(q*v^2-1))*B[(-2, 1, 1)] + B[(-2, 2, 0)] + B[(-2, 0, 2)] + ((-q*v^2-v^2+q+1)/(-q*v^2+1))*B[(-1, -1, 2)] + ((2*q^4*v^12+2*q^3*v^12-2*q^4*v^10-2*q^3*v^10+q^2*v^8-q^3*v^6+q*v^8-2*q^2*v^6+q^3*v^4-q*v^6+q^2*v^4-2*q*v^2-2*v^2+2*q+2)/(q^4*v^12-q^3*v^10-q*v^2+1))*B[(-1, 1, 0)] + ((-q*v^2-v^2+q+1)/(-q*v^2+1))*B[(-1, 2, -1)] + ((2*q^4*v^12+2*q^3*v^12-2*q^4*v^10-2*q^3*v^10+q^2*v^8-q^3*v^6+q*v^8-2*q^2*v^6+q^3*v^4-q*v^6+q^2*v^4-2*q*v^2-2*v^2+2*q+2)/(q^4*v^12-q^3*v^10-q*v^2+1))*B[(-1, 0, 1)] + ((-q*v^2-v^2+q+1)/(-q*v^2+1))*B[(1, -2, 1)] + ((-2*q^4*v^12-2*q^3*v^12+2*q^4*v^10+2*q^3*v^10-q^2*v^8+q^3*v^6-q*v^8+2*q^2*v^6-q^3*v^4+q*v^6-q^2*v^4+2*q*v^2+2*v^2-2*q-2)/(-q^4*v^12+q^3*v^10+q*v^2-1))*B[(1, -1, 0)] + ((-q*v^2-v^2+q+1)/(-q*v^2+1))*B[(1, 1, -2)] + ((-2*q^4*v^12-2*q^3*v^12+2*q^4*v^10+2*q^3*v^10-q^2*v^8+q^3*v^6-q*v^8+2*q^2*v^6-q^3*v^4+q*v^6-q^2*v^4+2*q*v^2+2*v^2-2*q-2)/(-q^4*v^12+q^3*v^10+q*v^2-1))*B[(1, 0, -1)] + B[(2, -2, 0)] + ((q*v^2+v^2-q-1)/(q*v^2-1))*B[(2, -1, -1)] + B[(2, 0, -2)] + B[(0, -2, 2)] + ((-2*q^4*v^12-2*q^3*v^12+2*q^4*v^10+2*q^3*v^10-q^2*v^8+q^3*v^6-q*v^8+2*q^2*v^6-q^3*v^4+q*v^6-q^2*v^4+2*q*v^2+2*v^2-2*q-2)/(-q^4*v^12+q^3*v^10+q*v^2-1))*B[(0, -1, 1)] + ((2*q^4*v^12+2*q^3*v^12-2*q^4*v^10-2*q^3*v^10+q^2*v^8-q^3*v^6+q*v^8-2*q^2*v^6+q^3*v^4-q*v^6+q^2*v^4-2*q*v^2-2*v^2+2*q+2)/(q^4*v^12-q^3*v^10-q*v^2+1))*B[(0, 1, -1)] + B[(0, 2, -2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.twist">
<code class="descname">twist</code><span class="sig-paren">(</span><em>mu</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials.twist" title="Permalink to this definition">¶</a></dt>
<dd><p>Act by <span class="math notranslate nohighlight">\(s_i\)</span> on the affine weight <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>This calls <code class="docutils literal notranslate"><span class="pre">simple_reflection</span></code>; which is semantically the
same as the default implementation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">WeylGroup</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">element_class</span><span class="o">.</span><span class="n">_repr_</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">reduced_word</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KW</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KW</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">affine</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Y_eigenvectors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">w</span>
<span class="go">123</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">twist</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1231</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="integrable_representations.html"
                        title="previous chapter">Integrable Representations of Affine Lie Algebras</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="pieri_factors.html"
                        title="next chapter">Pieri Factors</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/root_system/non_symmetric_macdonald_polynomials.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pieri_factors.html" title="Pieri Factors"
             >next</a> |</li>
        <li class="right" >
          <a href="integrable_representations.html" title="Integrable Representations of Affine Lie Algebras"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>