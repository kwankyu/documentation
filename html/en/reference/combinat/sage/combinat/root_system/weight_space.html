
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Weight lattices and weight spaces &#8212; Sage 9.5 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Weyl Character Rings" href="weyl_characters.html" />
    <link rel="prev" title="Weight lattice realizations" href="weight_lattice_realizations.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="weight_lattice_realizations.html" title="Weight lattice realizations"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.5 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module List</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Weight lattices and weight spaces</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="weight-lattices-and-weight-spaces">
<span id="sage-combinat-root-system-weight-space"></span><h1>Weight lattices and weight spaces<a class="headerlink" href="#weight-lattices-and-weight-spaces" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.root_system.weight_space"></span><dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.root_system.weight_space.</span></span><span class="sig-name descname"><span class="pre">WeightSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_system</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ring</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule" title="sage.combinat.free_module.CombinatorialFreeModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.free_module.CombinatorialFreeModule</span></code></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">root_system</span></code> – a root system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a ring <span class="math notranslate nohighlight">\(R\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extended</span></code> – a boolean (default: False)</p></li>
</ul>
<p>The weight space (or lattice if <code class="docutils literal notranslate"><span class="pre">base_ring</span></code> is <span class="math notranslate nohighlight">\(\ZZ\)</span>) of a root
system is the formal free module <span class="math notranslate nohighlight">\(\bigoplus_i R \Lambda_i\)</span>
generated by the fundamental weights <span class="math notranslate nohighlight">\((\Lambda_i)_{i\in I}\)</span> of the
root system.</p>
<p>This class is also used for coweight spaces (or lattices).</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem" title="sage.combinat.root_system.root_system.RootSystem"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RootSystem()</span></code></a></p></li>
<li><p><a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem.weight_lattice" title="sage.combinat.root_system.root_system.RootSystem.weight_lattice"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RootSystem.weight_lattice()</span></code></a> and <a class="reference internal" href="root_system.html#sage.combinat.root_system.root_system.RootSystem.weight_space" title="sage.combinat.root_system.root_system.RootSystem.weight_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RootSystem.weight_space()</span></code></a></p></li>
<li><p><a class="reference internal" href="weight_lattice_realizations.html#sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations" title="sage.combinat.root_system.weight_lattice_realizations.WeightLatticeRealizations"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WeightLatticeRealizations()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Weight lattice of the Root system of type [&#39;A&#39;, 3]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1: 2*Lambda[1] - Lambda[2], 2: -Lambda[1] + 2*Lambda[2] - Lambda[3], 3: -Lambda[2] + 2*Lambda[3]}</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">();</span> <span class="n">Q</span>
<span class="go">Weight lattice of the Root system of type [&#39;A&#39;, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: 2*Lambda[0] -   Lambda[1]               -   Lambda[3],</span>
<span class="go">               1:  -Lambda[0] + 2*Lambda[1] -   Lambda[2],</span>
<span class="go">               2:                -Lambda[1] + 2*Lambda[2] -   Lambda[3],</span>
<span class="go">               3:  -Lambda[0]               -   Lambda[2] + 2*Lambda[3]}</span>
</pre></div>
</div>
<p>For infinite types, the Cartan matrix is singular, and therefore
the embedding of the root lattice is not faithful:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">())</span>
<span class="go">0</span>
</pre></div>
</div>
<p>In particular, the null root is zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>This can be compensated by extending the basis of the weight space
and slightly deforming the simple roots to make them linearly
independent, without affecting the scalar product with the
coroots. This feature is currently only implemented for affine
types. In that case, if <code class="docutils literal notranslate"><span class="pre">extended</span></code> is set, then the basis of the
weight space is extended by an element <span class="math notranslate nohighlight">\(\delta\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span> <span class="o">=</span> <span class="kc">True</span><span class="p">);</span> <span class="n">Q</span>
<span class="go">Extended weight lattice of the Root system of type [&#39;A&#39;, 3, 1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">{0, 1, 2, 3, &#39;delta&#39;}</span>
</pre></div>
</div>
<p>And the simple root <span class="math notranslate nohighlight">\(\alpha_0\)</span> associated to the special node is
deformed as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {0: 2*Lambda[0] -   Lambda[1]               -   Lambda[3] + delta,</span>
<span class="go">               1:  -Lambda[0] + 2*Lambda[1] -   Lambda[2],</span>
<span class="go">               2:                -Lambda[1] + 2*Lambda[2] -   Lambda[3],</span>
<span class="go">               3:  -Lambda[0]               -   Lambda[2] + 2*Lambda[3]}</span>
</pre></div>
</div>
<p>Now, the null root is nonzero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">delta</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>By a slight notational abuse, the extra basis element used to
extend the fundamental weights is called <code class="docutils literal notranslate"><span class="pre">\delta</span></code> in the
current implementation. However, in the literature,
<code class="docutils literal notranslate"><span class="pre">\delta</span></code> usually denotes instead the null root. Most of the
time, those two objects coincide, but not for type <span class="math notranslate nohighlight">\(BC\)</span> (aka.
<span class="math notranslate nohighlight">\(A_{2n}^{(2)}\)</span>). Therefore we currently have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - Lambda[1] + delta</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">2*delta</span>
</pre></div>
</div>
<p>whereas, with the standard notations from the literature, one
would expect to get respectively <span class="math notranslate nohighlight">\(2\Lambda_0 -\Lambda_1 +1/2
\delta\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span>.</p>
<p>Other than this notational glitch, the implementation remains
correct for type <span class="math notranslate nohighlight">\(BC\)</span>.</p>
<p>The notations may get improved in a subsequent version, which
might require changing the index of the extra basis
element. To guarantee backward compatibility in code not
included in Sage, it is recommended to use the following idiom
to get that index:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">();</span> <span class="n">F</span>
<span class="go">Finite family {&#39;delta&#39;: delta}</span>
<span class="gp">sage: </span><span class="n">index</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">index</span>
<span class="go">&#39;delta&#39;</span>
</pre></div>
</div>
<p>Then, for example, the coefficient of an element of the
extended weight lattice on that basis element can be recovered
with:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">null_root</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
<span class="go">2</span>
</pre></div>
</div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.root_system.weight_space.WeightSpaceElement" title="sage.combinat.root_system.weight_space.WeightSpaceElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightSpaceElement</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.basis_extension">
<span class="sig-name descname"><span class="pre">basis_extension</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.basis_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the basis elements used to extend the fundamental weights</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Family ()</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Finite family {&#39;delta&#39;: delta}</span>
</pre></div>
</div>
<p>This method is irrelevant for finite types:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_extension</span><span class="p">()</span>
<span class="go">Family ()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.fundamental_weight">
<span class="sig-name descname"><span class="pre">fundamental_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.fundamental_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <span class="math notranslate nohighlight">\(i\)</span>-th fundamental weight</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – an element of the index set or <code class="docutils literal notranslate"><span class="pre">&quot;delta&quot;</span></code></p></li>
</ul>
<p>By a slight notational abuse, for an affine type this method
also accepts <code class="docutils literal notranslate"><span class="pre">&quot;delta&quot;</span></code> as input, and returns the image of
<span class="math notranslate nohighlight">\(\delta\)</span> of the extended weight lattice in this realization.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">fundamental_weight()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Lambda[1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Lambda[1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">fundamental_weight</span><span class="p">(</span><span class="s2">&quot;delta&quot;</span><span class="p">)</span>
<span class="go">delta</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.is_extended">
<span class="sig-name descname"><span class="pre">is_extended</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.is_extended" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this is an extended weight lattice.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_extended()</span></code></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">is_extended</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">is_extended</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.simple_root">
<span class="sig-name descname"><span class="pre">simple_root</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">j</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.simple_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <span class="math notranslate nohighlight">\(j^{th}\)</span> simple root</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-Lambda[2] + 2*Lambda[3] - Lambda[4]</span>
</pre></div>
</div>
<p>Its coefficients are given by the corresponding column of the
Cartan matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span><span class="o">.</span><span class="n">cartan_matrix</span><span class="p">()[:,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[ 0]</span>
<span class="go">[-1]</span>
<span class="go">[ 2]</span>
<span class="go">[-1]</span>
</pre></div>
</div>
<p>Here are all simple roots:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="go">Finite family {1:  2*Lambda[1]   - Lambda[2],</span>
<span class="go">               2:   -Lambda[1] + 2*Lambda[2]   - Lambda[3],</span>
<span class="go">               3:   -Lambda[2] + 2*Lambda[3]   - Lambda[4],</span>
<span class="go">               4:               -2*Lambda[3] + 2*Lambda[4]}</span>
</pre></div>
</div>
<p>For the extended weight lattice of an affine type, the simple
root associated to the special node is deformed by adding
<span class="math notranslate nohighlight">\(\delta\)</span>, where <span class="math notranslate nohighlight">\(\delta\)</span> is the null root:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - 2*Lambda[1] + delta</span>
</pre></div>
</div>
<p>In fact <span class="math notranslate nohighlight">\(\delta\)</span> is really <span class="math notranslate nohighlight">\(1/a_0\)</span> times the null root (see
the discussion in <a class="reference internal" href="#sage.combinat.root_system.weight_space.WeightSpace" title="sage.combinat.root_system.weight_space.WeightSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">WeightSpace</span></code></a>)
but this only makes a difference in type <span class="math notranslate nohighlight">\(BC\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">CartanType</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*Lambda[0] - Lambda[1] + delta</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="go">2*delta</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="type_affine.html#sage.combinat.root_system.type_affine.AmbientSpace.simple_root" title="sage.combinat.root_system.type_affine.AmbientSpace.simple_root"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simple_root()</span></code></a></p></li>
<li><p><code class="xref py py-meth docutils literal notranslate"><span class="pre">CartanType.col_annihilator()</span></code></p></li>
</ul>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpace.to_ambient_space_morphism">
<span class="sig-name descname"><span class="pre">to_ambient_space_morphism</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpace.to_ambient_space_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>The morphism from <code class="docutils literal notranslate"><span class="pre">self</span></code> to its associated ambient space.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">to_ambient_space_morphism</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">From: Weight lattice of the Root system of type [&#39;A&#39;, 2]</span>
<span class="go">To:   Ambient space of the Root system of type [&#39;A&#39;, 2]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Implemented only for finite Cartan type.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpaceElement">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.root_system.weight_space.</span></span><span class="sig-name descname"><span class="pre">WeightSpaceElement</span></span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.with_basis.indexed_element.IndexedFreeModuleElement</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpaceElement.is_dominant">
<span class="sig-name descname"><span class="pre">is_dominant</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.is_dominant" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether an element in the weight space lies in the positive cone spanned
by the basis elements (fundamental weights).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In the extended affine weight lattice, ‘delta’ is orthogonal to
the positive coroots, so adding or subtracting it should not
effect dominance</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">null_root</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">delta</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpaceElement.scalar">
<span class="sig-name descname"><span class="pre">scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lambdacheck</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>The canonical scalar product between the weight lattice and
the coroot lattice.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>merge with_apply_multi_module_morphism</p></li>
<li><p>allow for any root space / lattice</p></li>
<li><p>define properly the return type (depends on the base rings of the two spaces)</p></li>
<li><p>make this robust for extended weight lattices (<span class="math notranslate nohighlight">\(i\)</span> might be “delta”)</p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span>     <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">simple_coroots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The fundamental weights and the simple coroots are dual bases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span> <span class="p">[</span> <span class="n">Lambda</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="gp">....: </span>           <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">index_set</span><span class="p">()</span> <span class="p">]</span>
<span class="gp">....: </span>         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">L</span><span class="o">.</span><span class="n">index_set</span><span class="p">()</span> <span class="p">])</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[0 0 0 0 1]</span>
</pre></div>
</div>
<p>Note that the scalar product is not yet implemented between
the weight space and the coweight space; in any cases, that
won’t be the job of this method:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">coweight_space</span><span class="p">()</span><span class="o">.</span><span class="n">roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: -Lambdacheck[1] + 2*Lambdacheck[2] - Lambdacheck[3] is not in the coroot space</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpaceElement.to_ambient">
<span class="sig-name descname"><span class="pre">to_ambient</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.to_ambient" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps <code class="docutils literal notranslate"><span class="pre">self</span></code> to the ambient space.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">mu</span>
<span class="go">2*Lambda[1] + 2*Lambda[2]</span>
<span class="gp">sage: </span><span class="n">mu</span><span class="o">.</span><span class="n">to_ambient</span><span class="p">()</span>
<span class="go">(3, 1)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only implemented in finite Cartan type.
Does not work for coweight lattices because there is no implemented map
from the coweight lattice to the ambient space.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.root_system.weight_space.WeightSpaceElement.to_weight_space">
<span class="sig-name descname"><span class="pre">to_weight_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.weight_space.WeightSpaceElement.to_weight_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Map <code class="docutils literal notranslate"><span class="pre">self</span></code> to the weight space.</p>
<p>Since <span class="math notranslate nohighlight">\(self.parent()\)</span> is the weight space, this map just returns <code class="docutils literal notranslate"><span class="pre">self</span></code>.
This overrides the generic method in <span class="math notranslate nohighlight">\(WeightSpaceRealizations\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">root_system</span><span class="p">()</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">mu</span>
<span class="go">2*Lambda[1] + 2*Lambda[2]</span>
<span class="gp">sage: </span><span class="n">mu</span><span class="o">.</span><span class="n">to_weight_space</span><span class="p">()</span>
<span class="go">2*Lambda[1] + 2*Lambda[2]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="weight_lattice_realizations.html"
                        title="previous chapter">Weight lattice realizations</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="weyl_characters.html"
                        title="next chapter">Weyl Character Rings</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/root_system/weight_space.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="weyl_characters.html" title="Weyl Character Rings"
             >next</a> |</li>
        <li class="right" >
          <a href="weight_lattice_realizations.html" title="Weight lattice realizations"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.5 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module List</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Weight lattices and weight spaces</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>