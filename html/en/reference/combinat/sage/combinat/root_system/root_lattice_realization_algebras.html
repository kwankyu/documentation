
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Group algebras of root lattice realizations &#8212; Sage Reference Manual v8.2: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Root lattice realizations" href="root_lattice_realizations.html" />
    <link rel="prev" title="Finite real reflection groups" href="reflection_group_real.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="root_lattice_realizations.html" title="Root lattice realizations"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="reflection_group_real.html" title="Finite real reflection groups"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="group-algebras-of-root-lattice-realizations">
<span id="sage-combinat-root-system-root-lattice-realization-algebras"></span><h1>Group algebras of root lattice realizations<a class="headerlink" href="#group-algebras-of-root-lattice-realizations" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.root_system.root_lattice_realization_algebras"></span><dl class="class">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras">
<em class="property">class </em><code class="descclassname">sage.combinat.root_system.root_lattice_realization_algebras.</code><code class="descname">Algebras</code><span class="sig-paren">(</span><em>category</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/algebra_functor.html#sage.categories.algebra_functor.AlgebrasCategory" title="(in Sage Reference Manual: Category Framework v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.algebra_functor.AlgebrasCategory</span></code></a></p>
<p>The category of group algebras of root lattice realizations.</p>
<p>This includes typically weight rings (group algebras of weight lattices).</p>
<dl class="class">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods">
<em class="property">class </em><code class="descname">ElementMethods</code><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.acted_upon">
<code class="descname">acted_upon</code><span class="sig-paren">(</span><em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.acted_upon" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the action of <code class="docutils literal"><span class="pre">w</span></code> on <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">w</span></code> – an element of the Weyl group acting on the underlying weight lattice realization</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">weyl_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">m</span>  <span class="c1"># TODO: investigate why we don&#39;t get something more interesting</span>
<span class="go">B[(2, 2, 3, 0)]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span> <span class="n">m</span>
<span class="go">B[(0, 0, 0, 0)] + 2*B[(2, 2, 3, 0)] + B[(4, 4, 6, 0)]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">an_element</span><span class="p">();</span> <span class="n">w</span><span class="o">.</span><span class="n">reduced_word</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">acted_upon</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">B[(0, 0, 0, 0)] + 2*B[(0, 2, 2, 3)] + B[(0, 4, 4, 6)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.expand">
<code class="descname">expand</code><span class="sig-paren">(</span><em>alphabet</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ElementMethods.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand <code class="docutils literal"><span class="pre">self</span></code> into variables in the <code class="docutils literal"><span class="pre">alphabet</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">alphabet</span></code> – a non empty list/tuple of (invertible) variables in a ring to expand in</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">+</span> <span class="n">KL</span><span class="o">.</span><span class="n">sum_of_monomials</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">some_elements</span><span class="p">());</span> <span class="n">p</span>
<span class="go">B[(1, 0, 0)] + B[(1, -1, 0)] + B[(1, 1, 0)] + 2*B[(2, 2, 3)] + B[(0, 1, -1)]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">LaurentPolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">2*x^2*y^2*z^3 + x*y + x + y*z^-1 + x*y^-1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods">
<em class="property">class </em><code class="descname">ParentMethods</code><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.T0_check_on_basis">
<code class="descname">T0_check_on_basis</code><span class="sig-paren">(</span><em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.T0_check_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(T_0^\vee\)</span> operator acting on the basis.</p>
<p>This implements the formula for <span class="math">\(T_{0'}\)</span> in Section 6.12 of <a class="reference internal" href="#haiman06" id="id1">[Haiman06]</a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="haiman06" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Haiman06]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> M. Haiman, Cherednik algebras, Macdonald polynomials and combinatorics, ICM 2006.</td></tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The current implementation probably returns just
nonsense, if the convention is not “dominant”.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">some_weights</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">L0</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">(q1+q2)*B[(0, 0)] + q1*B[(1, -1)]</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">some_weights</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">L0</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>       <span class="c1"># not checked</span>
<span class="go">(q1+q2)*B[(0, 0, 0, 0)] + q1^3/q2^2*B[(1, 0, 0, -1)]</span>
</pre></div>
</div>
<p>The following results have not been checked:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">some_weights</span><span class="p">:</span>
<span class="go">....:     print(&quot;{} : {}&quot;.format(x, f(x)))</span>
<span class="go">(1, 0, 0, 0) : q1*B[(1, 0, 0, 0)]</span>
<span class="go">(1, 1, 0, 0) : q1*B[(1, 1, 0, 0)]</span>
<span class="go">(1, 1, 1, 0) : q1*B[(1, 1, 1, 0)]</span>
</pre></div>
</div>
<p>Some examples for type <span class="math">\(B_2^{(1)}\)</span> dual:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="s2">&quot;B2~*&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span> <span class="o">=</span> <span class="n">u</span>
<span class="gp">sage: </span><span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Direct calculation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">(</span><span class="mi">0</span><span class="p">)(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">((u^2-1)/u)*B[(0, 0)] + u^3*B[(1, 1)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">((u^2-1)/u)*B[(0, 0)] + u^3*B[(1, 1)]</span>
</pre></div>
</div>
<p>Step by step calculation, comparing by hand with Mark Shimozono:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])));</span> <span class="n">res</span>
<span class="go">u*B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L0</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">res</span>
<span class="go">u*B[(-1, 1)]</span>
<span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">res</span><span class="p">);</span> <span class="n">res</span>
<span class="go">(u^2-1)*B[(0, 0)] + u^2*B[(1, -1)]</span>
<span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="n">res</span><span class="p">);</span> <span class="n">res</span>
<span class="go">((u^2-1)/u)*B[(0, 0)] + u^3*B[(1, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.cartan_type">
<code class="descname">cartan_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.cartan_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Cartan type of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;A&#39;, 2, 1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cartan_type</span><span class="p">()</span>
<span class="go">[&#39;B&#39;, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.classical">
<code class="descname">classical</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.classical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the group algebra of the corresponding classical lattice.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="go">Algebra of the Ambient space of the Root system of type [&#39;A&#39;, 2] over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_basis">
<code class="descname">demazure_lusztig_operator_on_basis</code><span class="sig-paren">(</span><em>weight</em>, <em>i</em>, <em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the result of applying the <span class="math">\(i\)</span>-th Demazure-Lusztig operator on <code class="docutils literal"><span class="pre">weight</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">weight</span></code> – an element <span class="math">\(\lambda\)</span> of the weight lattice</li>
<li><code class="docutils literal"><span class="pre">i</span></code> – an element of the index set</li>
<li><code class="docutils literal"><span class="pre">q1,q2</span></code> – two elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<p>See <a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators"><code class="xref py py-meth docutils literal"><span class="pre">demazure_lusztig_operators()</span></code></a> for the details.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">q1*B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 2)] + (q1+q2)*B[(2, 1)] + (q1+q2)*B[(3, 0)] + q1*B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[(1, 2)] + (-q1-q2)*B[(2, 1)] + (-q2)*B[(3, 0)]</span>
</pre></div>
</div>
<p>At <span class="math">\(q_1=1\)</span> and <span class="math">\(q_2=0\)</span> we recover the action of the isobaric divided differences <span class="math">\(\pi_i\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">B[(1, 2)] + B[(2, 1)] + B[(3, 0)] + B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">-B[(1, 2)] - B[(2, 1)]</span>
</pre></div>
</div>
<p>Or <span class="math">\(1-\pi_i\)</span> for <code class="docutils literal"><span class="pre">bar=True</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="go">-B[(1, 2)] - B[(2, 1)] - B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="go">B[(1, 2)] + B[(2, 1)] + B[(0, 3)]</span>
</pre></div>
</div>
<p>At <span class="math">\(q_1=1\)</span> and <span class="math">\(q_2=-1\)</span> we recover the action of the simple reflection <span class="math">\(s_i\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">B[(3, 0)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_classical_on_basis">
<code class="descname">demazure_lusztig_operator_on_classical_on_basis</code><span class="sig-paren">(</span><em>weight</em>, <em>i</em>, <em>q</em>, <em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_classical_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the result of applying the <span class="math">\(i\)</span>-th Demazure-Lusztig operator on the classical weight <code class="docutils literal"><span class="pre">weight</span></code> embedded at level 0.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">weight</span></code> – a classical weight <span class="math">\(\lambda\)</span></li>
<li><code class="docutils literal"><span class="pre">i</span></code> – an element of the index set</li>
<li><code class="docutils literal"><span class="pre">q1,q2</span></code> – two elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<p>See <a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators"><code class="xref py py-meth docutils literal"><span class="pre">demazure_lusztig_operators()</span></code></a> for the details.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Optimize the code to only do the embedding/projection for T_0</li>
<li>Add an option to specify at which level one wants to
work. Currently this is level 0.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</pre></div>
</div>
<p>These operators coincide with the usual Demazure-Lusztig
operators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_classical_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">q1*B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL0</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">q1*B[(2, 2)]</span>

<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_classical_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 2)] + (q1+q2)*B[(2, 1)] + (q1+q2)*B[(3, 0)] + q1*B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL0</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 2)] + (q1+q2)*B[(2, 1)] + (q1+q2)*B[(3, 0)] + q1*B[(0, 3)]</span>
</pre></div>
</div>
<p>except that we now have an action of <span class="math">\(T_0\)</span>, which introduces some <span class="math">\(q\)</span> s:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_classical_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">q1*B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operator_on_classical_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="go">(-q^2*q1-q^2*q2)*B[(1, 2)] + (-q*q1-q*q2)*B[(2, 1)] + (-q^3*q2)*B[(0, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators">
<code class="descname">demazure_lusztig_operators</code><span class="sig-paren">(</span><em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Demazure-Lusztig operators acting on <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q1,q2</span></code> – two elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<p>If <span class="math">\(R\)</span> is the parent weight ring, the Demazure-Lusztig
operator <span class="math">\(T_i\)</span> is the linear map <span class="math">\(R\rightarrow R\)</span> obtained
by interpolating between the isobaric divided difference
operator <span class="math">\(\pi_i\)</span> (see <a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.isobaric_divided_difference_on_basis" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.isobaric_divided_difference_on_basis"><code class="xref py py-meth docutils literal"><span class="pre">isobaric_divided_difference_on_basis()</span></code></a>)
and the simple reflection <span class="math">\(s_i\)</span>.</p>
<div class="math">
\[(q_1+q_2) \pi_i - q_2 s_i\]</div>
<p>The Demazure-Lusztig operators give the usual
representation of the operator <span class="math">\(T_i\)</span> of the (affine) Hecke
algebra with eigenvalues <span class="math">\(q_1\)</span> and <span class="math">\(q_2\)</span> associated to the
Weyl group.</p>
<p>Several variants are available to match with various
conventions used in the literature:</p>
<ul class="simple">
<li>“bar” replaces <span class="math">\(\pi_i\)</span> in the formula above by
<span class="math">\(\overline{\pi}_i = (1-\pi_i)\)</span>.</li>
<li>“dominant” conjugates the operator by
<span class="math">\(x^\lambda \mapsto x^-\lambda\)</span>.</li>
</ul>
<p>The names dominant and antidominant for the conventions were chosen with regards to
the nonsymmetric Macdonald polynomials. The <span class="math">\(Y\)</span> operators for the Macdonald polynomials
in the “dominant” convention satisfy <span class="math">\(Y_\lambda = T_{t_{\lambda}}\)</span> for <span class="math">\(\lambda\)</span> dominant.
This is also the convention used in <a class="reference internal" href="#haiman06" id="id2">[Haiman06]</a>. For the “antidominant” convention,
<span class="math">\(Y_\lambda = T_{t_{\lambda}}\)</span> with <span class="math">\(\lambda\)</span> antidominant.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_basis" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_basis"><code class="xref py py-meth docutils literal"><span class="pre">demazure_lusztig_operator_on_basis()</span></code></a>.</li>
<li><a class="reference internal" href="non_symmetric_macdonald_polynomials.html#sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials" title="sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials"><code class="xref py py-class docutils literal"><span class="pre">NonSymmetricMacdonaldPolynomials</span></code></a>.</li>
</ul>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="lusztig1985" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Lusztig1985]</td><td>G. Lusztig,
<em>Equivariant K-theory and representations of Hecke algebras</em>,
Proc. Amer. Math. Soc. 94 (1985), no. 2, 337-342.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="cherednik1995" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Cherednik1995]</td><td>I. Cherednik,
<em>Nonsymmetric Macdonald polynomials</em>. IMRN 10, 483-515 (1995).</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tbar</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tdominant</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 2)] + (q1+q2)*B[(2, 1)] + (q1+q2)*B[(3, 0)] + q1*B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">Tbar</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[(1, 2)] + (-q1-q2)*B[(2, 1)] + (-q1-2*q2)*B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">Tbar</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(3, 0)] + (-2*q2)*B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">Tdominant</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[(1, 2)] + (-q1-q2)*B[(2, 1)] + (-q2)*B[(0, 3)]</span>

<span class="gp">sage: </span><span class="n">Tdominant</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">((-q1-q2)/(q1*q2))*B[(0, 0)] - 1/q2*B[(1, -1)]</span>
</pre></div>
</div>
<p>We repeat similar computation in the affine setting:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tbar</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tdominant</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[e[0] + 2*e[1]] + (q1+q2)*B[2*e[0] + e[1]] + (q1+q2)*B[3*e[0]] + q1*B[3*e[1]]</span>
<span class="gp">sage: </span><span class="n">Tbar</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[e[0] + 2*e[1]] + (-q1-q2)*B[2*e[0] + e[1]] + (-q1-2*q2)*B[3*e[1]]</span>
<span class="gp">sage: </span><span class="n">Tbar</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[3*e[0]] + (-2*q2)*B[3*e[1]]</span>
<span class="gp">sage: </span><span class="n">Tdominant</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[e[0] + 2*e[1]] + (-q1-q2)*B[2*e[0] + e[1]] + (-q2)*B[3*e[1]]</span>
<span class="gp">sage: </span><span class="n">Tdominant</span><span class="o">.</span><span class="n">Tw_inverse</span><span class="p">(</span><span class="mi">1</span><span class="p">)(</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="o">-</span><span class="n">L</span><span class="o">.</span><span class="n">simple_root</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">((-q1-q2)/(q1*q2))*B[0] - 1/q2*B[e[0] - e[1]]</span>
</pre></div>
</div>
<p>One can obtain iterated operators by passing a reduced
word or an element of the Weyl group:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1^2+2*q1*q2+q2^2)*B[e[0] + e[1] + e[2]] +</span>
<span class="go">(q1^2+2*q1*q2+q2^2)*B[e[0] + 2*e[1]] +</span>
<span class="go">(q1^2+q1*q2)*B[e[0] + 2*e[2]] + (q1^2+2*q1*q2+q2^2)*B[2*e[0] + e[1]] +</span>
<span class="go">(q1^2+q1*q2)*B[2*e[0] + e[2]] + (q1^2+q1*q2)*B[3*e[0]] +</span>
<span class="go">(q1^2+q1*q2)*B[e[1] + 2*e[2]] + (q1^2+q1*q2)*B[2*e[1] + e[2]] +</span>
<span class="go">(q1^2+q1*q2)*B[3*e[1]] + q1^2*B[3*e[2]]</span>
</pre></div>
</div>
<p>and use that to check, for example, the braid relations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The operators satisfy the relations of the affine Hecke
algebra with parameters <span class="math">\(q_1\)</span>, <span class="math">\(q_2\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Tdominant</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Tbar</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span> <span class="c1">#-q2,q1+2*q2   # todo: not implemented: set the appropriate eigenvalues!</span>
</pre></div>
</div>
<p>And the <span class="math">\(\bar{T}\)</span> are basically the inverses of the <span class="math">\(T\)</span> s:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Tinv</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">q1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">q2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">q1</span><span class="p">,</span><span class="n">convention</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Tinv</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">))</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">KL</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()]</span>
<span class="go">[0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
<p>We check that <span class="math">\(\Lambda_1-\Lambda_0\)</span> is an eigenvector for
the <span class="math">\(Y\)</span> s in affine type:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="o">=</span><span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">simple_coroots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">alpha</span><span class="p">()</span> <span class="c1"># alpha of coroot lattice is alphacheck</span>
<span class="gp">sage: </span><span class="n">alphacheck</span>
<span class="go">Finite family {0: alphacheck[0], 1: alphacheck[1], 2: alphacheck[2]}</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">x</span>
<span class="go">B[e[0]]</span>
</pre></div>
</div>
<p>In fact it is not exactly an eigenvector, but the extra
‘delta` term is to be interpreted as a <span class="math">\(q\)</span> parameter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="n">KL</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q2^2/q1^2*B[0]</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]](</span><span class="n">x</span><span class="p">)</span>
<span class="go">((-q2^2)/(-q1^2))*B[e[0] - e[&#39;delta&#39;]]</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">]](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1/(-q2))*B[e[0]]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]](</span><span class="n">x</span><span class="p">),</span><span class="n">q</span><span class="p">)</span>
<span class="go">((-q2^2)/(-q*q1^2))*B[(1, 0, 0)]</span>

<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">B[(1, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="n">x</span><span class="p">),</span><span class="n">q</span><span class="p">)</span>
<span class="go">((-q*q1)/q2)*B[(1, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]](</span><span class="n">x</span><span class="p">),</span><span class="n">q</span><span class="p">)</span>
<span class="go">((-q2^2)/(-q*q1^2))*B[(1, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">2</span><span class="p">]](</span><span class="n">x</span><span class="p">),</span><span class="n">q</span><span class="p">)</span>
<span class="go">(q1/(-q2))*B[(1, 0, 0)]</span>
</pre></div>
</div>
<p>We now check systematically that the Demazure-Lusztig
operators satisfy the relations of the Iwahori-Hecke
algebra:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cartan_type</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span> <span class="c1"># long time 12s</span>
<span class="go">....:    L = RootSystem(cartan_type).root_lattice()</span>
<span class="go">....:    KL = L.algebra(K)</span>
<span class="go">....:    T = KL.demazure_lusztig_operators(q1,q2)</span>
<span class="go">....:    T._test_relations()</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">cartan_type</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span> <span class="c1"># long time 12s</span>
<span class="go">....:    L = RootSystem(cartan_type).weight_lattice()</span>
<span class="go">....:    KL = L.algebra(K)</span>
<span class="go">....:    T = KL.demazure_lusztig_operators(q1,q2)</span>
<span class="go">....:    T._test_relations()</span>
</pre></div>
</div>
<p>Recall that the Demazure-Lusztig operators are only
defined when all monomials belong to the weight lattice.
Thus, in the group algebra of the ambient space, we need
to specify explicitly the elements on which to run the
tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cartan_type</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span> <span class="c1"># long time 12s</span>
<span class="go">....:    L = RootSystem(cartan_type).ambient_space()</span>
<span class="go">....:    KL = L.algebra(K)</span>
<span class="go">....:    weight_lattice = RootSystem(cartan_type).weight_lattice(extended=L.is_extended())</span>
<span class="go">....:    elements = [ KL.monomial(L(weight)) for weight in weight_lattice.some_elements() ]</span>
<span class="go">....:    T = KL.demazure_lusztig_operators(q1,q2)</span>
<span class="go">....:    T._test_relations(elements=elements)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators_on_classical">
<code class="descname">demazure_lusztig_operators_on_classical</code><span class="sig-paren">(</span><em>q</em>, <em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators_on_classical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Demazure-Lusztig operators acting at level 1 on <code class="docutils literal"><span class="pre">self.classical()</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q,q1,q2</span></code> – three elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<p>Let <span class="math">\(KL\)</span> be the group algebra of an affine weight lattice
realization <span class="math">\(L\)</span>. The Demazure-Lusztig operators for <span class="math">\(KL\)</span>
act on the group algebra of the corresponding classical
weight lattice by embedding it at level 1, and projecting
back.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operators"><code class="xref py py-meth docutils literal"><span class="pre">demazure_lusztig_operators()</span></code></a>.</li>
<li><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_classical_on_basis" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_lusztig_operator_on_classical_on_basis"><code class="xref py py-meth docutils literal"><span class="pre">demazure_lusztig_operator_on_classical_on_basis()</span></code></a>.</li>
<li><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project"><code class="xref py py-meth docutils literal"><span class="pre">q_project()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators_on_classical</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L0</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)));</span> <span class="n">x</span>
<span class="go">B[(3, 0)]</span>
</pre></div>
</div>
<p>For <span class="math">\(T_1,\dots\)</span> we recover the usual Demazure-Lusztig operators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(q1+q2)*B[(1, 2)] + (q1+q2)*B[(2, 1)] + (q1+q2)*B[(3, 0)] + q1*B[(0, 3)]</span>
</pre></div>
</div>
<p>For <span class="math">\(T_0\)</span>, we can note that, in the projection, <span class="math">\(\delta\)</span>
is mapped to <span class="math">\(q\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">x</span><span class="p">)</span>
<span class="go">(-q^2*q1-q^2*q2)*B[(1, 2)] + (-q*q1-q*q2)*B[(2, 1)] + (-q^3*q2)*B[(0, 3)]</span>
</pre></div>
</div>
<p>Note that there is no translation part, and in particular
1 is an eigenvector for all <span class="math">\(T_i\)</span>‘s:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q1*B[(0, 0)]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">q1*B[(0, 0)]</span>

<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span><span class="o">=</span><span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]](</span><span class="n">KL0</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>
<span class="go">((-q2)/(q*q1))*B[(0, 0)]</span>
</pre></div>
</div>
<p>Matching with Ion Bogdan’s hand calculations from 3/15/2013:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">(</span><span class="n">extended</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q,u&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL0</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">KL0</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">omega</span> <span class="o">=</span> <span class="n">L0</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators_on_classical</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">u</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Y</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alphacheck</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">simple_roots</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">Ydelta</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">Y</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">.</span><span class="n">null_root</span><span class="p">()]</span>
<span class="gp">sage: </span><span class="n">Ydelta</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Ydelta</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Ydelta</span><span class="o">.</span><span class="n">scalar</span>
<span class="go">((), (), 1/q)</span>

<span class="gp">sage: </span><span class="n">Y1</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">Y1</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Y1</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Y1</span><span class="o">.</span><span class="n">scalar</span> <span class="c1"># This is T_0 T_1 (T_1 acts first, then T_0); Ion gets T_1 T_0</span>
<span class="go">((1, 0), (1, 1), 1)</span>

<span class="gp">sage: </span><span class="n">Y0</span> <span class="o">=</span> <span class="n">Y</span><span class="p">[</span><span class="n">alphacheck</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">Y0</span><span class="o">.</span><span class="n">word</span><span class="p">,</span> <span class="n">Y0</span><span class="o">.</span><span class="n">signs</span><span class="p">,</span> <span class="n">Y0</span><span class="o">.</span><span class="n">scalar</span> <span class="c1"># This is 1/q T_1^-1 T_0^-1</span>
<span class="go">((0, 1), (-1, -1), 1/q)</span>
</pre></div>
</div>
<p>Note that the following computations use the “dominant” convention:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">Tw</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T0</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">q*u*B[-Lambda[1]] + ((u^2-1)/u)*B[Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">T0</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">((q*u^2-q)/u)*B[0] + q^2*u*B[-2*Lambda[1]] + ((u^2-1)/u)*B[2*Lambda[1]]</span>

<span class="gp">sage: </span><span class="n">T0</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="o">-</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">1/(q*u)*B[Lambda[1]]</span>
<span class="gp">sage: </span><span class="n">T0</span><span class="p">(</span><span class="n">KL0</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">omega</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">((-u^2+1)/(q*u))*B[0] + 1/(q^2*u)*B[2*Lambda[1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_operators">
<code class="descname">demazure_operators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Demazure operators acting on <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>The <span class="math">\(i\)</span>-th Demazure operator is defined by:</p>
<div class="math">
\[\pi_i = \frac{ 1 - e^{-\alpha_i}s_i }{ 1-e^{-\alpha_i} }\]</div>
<p>It acts on <span class="math">\(e^\lambda\)</span>, for <span class="math">\(\lambda\)</span> a weight, by:</p>
<div class="math">
\[\pi_i e^\lambda = \frac{e^\lambda - e^{-\alpha_i+s_i\lambda}}{1-e^{-\alpha_i}}\]</div>
<p>This matches with Lascoux’ definition <a class="reference internal" href="#lascoux2003" id="id3">[Lascoux2003]</a> of <span class="math">\(\pi_i\)</span>, and
with the <span class="math">\(i\)</span>-th Demazure operator of <a class="reference internal" href="#kumar1987" id="id4">[Kumar1987]</a>, which also works for
general Kac-Moody types.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="kumar1987" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Kumar1987]</a></td><td>S. Kumar, Demazure character formula in arbitrary Kac-Moody setting,
Invent. Math. 89 (1987), no. 2, 395-423.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<p>We compute some Schur functions, as images of dominant
monomials under the action of the maximal isobaric divided
difference <span class="math">\(\Delta_{w_0}\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w0</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">weyl_group</span><span class="p">()</span><span class="o">.</span><span class="n">long_element</span><span class="p">()</span><span class="o">.</span><span class="n">reduced_word</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_operators</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pi0</span> <span class="o">=</span> <span class="n">pi</span><span class="p">[</span><span class="n">w0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">pi0</span><span class="p">(</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span>
<span class="go">2*B[(1, 1, 1)] + B[(1, 2, 0)] + B[(1, 0, 2)] + B[(2, 1, 0)] + B[(2, 0, 1)] + B[(0, 1, 2)] + B[(0, 2, 1)]</span>
</pre></div>
</div>
<p>Let us make the result into an actual polynomial:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">pi0</span><span class="p">(</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))))</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="go">x^2*y + x*y^2 + x^2*z + 2*x*y*z + y^2*z + x*z^2 + y*z^2</span>
</pre></div>
</div>
<p>This is indeed a Schur function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">SymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">s</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">P</span><span class="o">.</span><span class="n">variable_names</span><span class="p">())</span>
<span class="go">x^2*y + x*y^2 + x^2*z + 2*x*y*z + y^2*z + x*z^2 + y*z^2</span>
</pre></div>
</div>
<p>Let us check this systematically on Schur functions of degree 6:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Partitions</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">():</span>
<span class="go">....:     assert s.monomial(p).expand(3, P.variable_names()) == pi0(KL.monomial(L(tuple(p)))).expand(P.gens())</span>
</pre></div>
</div>
<p>We check systematically that these operators satisfy the Iwahori-Hecke algebra relations:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">cartan_type</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span> <span class="c1"># long time 12s</span>
<span class="go">....:     L = RootSystem(cartan_type).weight_lattice()</span>
<span class="go">....:     KL = L.algebra(QQ)</span>
<span class="go">....:     T = KL.demazure_operators()</span>
<span class="go">....:     T._test_relations()</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_operators</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>The Demazure operators are only defined if all the
elements in the support have integral scalar products
with the coroots (basically, they are in the weight
lattice). Otherwise an error is raised:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">CartanType</span><span class="p">([</span><span class="s2">&quot;G&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">dual</span><span class="p">())</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_operators</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="p">[</span><span class="mi">1</span><span class="p">](</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the weight does not have an integral scalar product with the coroot</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.divided_difference_on_basis">
<code class="descname">divided_difference_on_basis</code><span class="sig-paren">(</span><em>weight</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.divided_difference_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the result of applying the <span class="math">\(i\)</span>-th divided difference on <code class="docutils literal"><span class="pre">weight</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">weight</span></code> – a weight</li>
<li><code class="docutils literal"><span class="pre">i</span></code> – an element of the index set</li>
</ul>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">type free definition (Viviane’s definition uses that we are in the ambient space)</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">B[(2, 0)] + B[(1, 1)] + B[(0, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># todo: not implemented</span>
<span class="go">-B[(2, 0)] - B[(1, 1)] - B[(0, 2)]</span>
</pre></div>
</div>
<p>In type <span class="math">\(A\)</span> and in the ambient lattice, we recover the
usual action of divided differences polynomials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">p</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x^2 + x*y + y^2</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-x^2 - x*y - y^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.from_polynomial">
<code class="descname">from_polynomial</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.from_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an element of <code class="docutils literal"><span class="pre">self</span></code> from a polynomial <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – a polynomial</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">B[(1, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">from_polynomial</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="go">B[(2, 1, 0)] + 2*B[(0, 1, 0)] - B[(0, 0, 1)]</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">make this work for Laurent polynomials too</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.isobaric_divided_difference_on_basis">
<code class="descname">isobaric_divided_difference_on_basis</code><span class="sig-paren">(</span><em>weight</em>, <em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.isobaric_divided_difference_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the result of applying the <span class="math">\(i\)</span>-th isobaric divided difference on <code class="docutils literal"><span class="pre">weight</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">weight</span></code> – a weight</li>
<li><code class="docutils literal"><span class="pre">i</span></code> – an element of the index set</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.demazure_operators"><code class="xref py py-meth docutils literal"><span class="pre">demazure_operators()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">isobaric_divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">B[(2, 2)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">isobaric_divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">B[(1, 2)] + B[(2, 1)] + B[(3, 0)] + B[(0, 3)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">isobaric_divided_difference_on_basis</span><span class="p">(</span><span class="n">L</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">-B[(1, 2)] - B[(2, 1)]</span>
</pre></div>
</div>
<p>In type <span class="math">\(A\)</span> and in the ambient lattice, we recover the
usual action of divided differences on polynomials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x,y&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">p</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">p</span><span class="p">)(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2*y^2</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x^3 + x^2*y + x*y^2 + y^3</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-x^2*y - x*y^2</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="lascoux2003" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Lascoux2003]</a></td><td>Alain Lascoux, Symmetric functions and combinatorial operators on polynomials,
CBMS Regional Conference Series in Mathematics, 99, 2003.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project">
<code class="descname">q_project</code><span class="sig-paren">(</span><em>x</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement the <span class="math">\(q\)</span>-projection morphism from <code class="docutils literal"><span class="pre">self</span></code> to the group algebra of the classical space.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> – an element of the group algebra of <code class="docutils literal"><span class="pre">self</span></code></li>
<li><code class="docutils literal"><span class="pre">q</span></code> – an element of the ground ring</li>
</ul>
<p>This is an algebra morphism mapping <span class="math">\(\delta\)</span> to <span class="math">\(q\)</span> and
<span class="math">\(X^b\)</span> to its classical counterpart for the other elements
<span class="math">\(b\)</span> of the basis of the realization.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">+</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;deltacheck&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]);</span> <span class="n">x</span>
<span class="go">B[2*e[0] + 2*e[1] + 3*e[2]] + B[4*e[1] + 3*e[2] - 2*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">B[(2, 2, 3)] + 1/q^2*B[(0, 4, 3)]</span>

<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span> <span class="o">+</span> <span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;deltacheck&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">]);</span> <span class="n">x</span>
<span class="go">B[2*e[0] + 2*e[1] + 3*e[2]] + B[4*e[1] + 3*e[2] - 2*e[&#39;delta&#39;] + e[&#39;deltacheck&#39;]]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="go">B[(2, 2, 3)] + 1/q^2*B[(0, 4, 3)]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Recall that the null root, usually denoted <span class="math">\(\delta\)</span>,
is in fact <code class="docutils literal"><span class="pre">a[0]\delta</span></code> in Sage’s notation, in order
to avoid half integer coefficients (this only makes a
difference in type BC). Similarly, what’s usually
denoted <span class="math">\(q\)</span> is in fact <code class="docutils literal"><span class="pre">q^a[0]</span></code> in Sage’s notations,
to avoid manipulating square roots:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">KL</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">null_root</span><span class="p">()),</span><span class="n">q</span><span class="p">)</span>
<span class="go">q^2*B[(0, 0, 0)]</span>
</pre></div>
</div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project_on_basis">
<code class="descname">q_project_on_basis</code><span class="sig-paren">(</span><em>l</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the monomial <span class="math">\(c * cl(l)\)</span>  in the group algebra of the classical lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">l</span></code> – an element of the root lattice realization</li>
<li><code class="docutils literal"><span class="pre">q</span></code> – an element of the ground ring</li>
</ul>
<p>Here, <span class="math">\(cl(l)\)</span> is the projection of <span class="math">\(l\)</span> in the classical
lattice, and <span class="math">\(c\)</span> is the coefficient of <span class="math">\(l\)</span> in <span class="math">\(\delta\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project_on_basis" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.q_project_on_basis"><code class="xref py py-meth docutils literal"><span class="pre">q_project_on_basis()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">q_project_on_basis</span><span class="p">(</span> <span class="mi">4</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">e</span><span class="p">[</span><span class="s1">&#39;deltacheck&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">e</span><span class="p">[</span><span class="s1">&#39;delta&#39;</span><span class="p">],</span> <span class="n">q</span><span class="p">)</span>
<span class="go">1/q^2*B[(0, 4, 3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.some_elements">
<code class="descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of the algebra <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[B[2*e[0] + 2*e[1] + 3*e[2]],</span>
<span class="go">B[-e[0] + e[2] + e[&#39;delta&#39;]],</span>
<span class="go">B[e[0] - e[1]],</span>
<span class="go">B[e[1] - e[2]],</span>
<span class="go">B[e[&#39;deltacheck&#39;]],</span>
<span class="go">B[e[0] + e[&#39;deltacheck&#39;]],</span>
<span class="go">B[e[0] + e[1] + e[&#39;deltacheck&#39;]]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">weight_space</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[B[2*Lambda[1] + 2*Lambda[2]],</span>
<span class="go">B[2*Lambda[1] - 2*Lambda[2]],</span>
<span class="go">B[-Lambda[1] + 2*Lambda[2]],</span>
<span class="go">B[Lambda[1]],</span>
<span class="go">B[Lambda[2]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operator_on_basis">
<code class="descname">twisted_demazure_lusztig_operator_on_basis</code><span class="sig-paren">(</span><em>weight</em>, <em>i</em>, <em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operator_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the twisted Demazure-Lusztig operator acting on the basis.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">weight</span></code> – an element <span class="math">\(\lambda\)</span> of the weight lattice</li>
<li><code class="docutils literal"><span class="pre">i</span></code> – an element of the index set</li>
<li><code class="docutils literal"><span class="pre">q1,q2</span></code> – two elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators" title="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators"><code class="xref py py-meth docutils literal"><span class="pre">twisted_demazure_lusztig_operators()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Lambda</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span><span class="o">.</span><span class="n">fundamental_weights</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="go">(-q2)*B[(2, 3, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="go">(-q1-q2)*B[(3, 1, 1, 0)] + (-q2)*B[(3, 0, 2, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="go">q1*B[(3, 2, 0, 0)]</span>
<span class="gp">sage: </span><span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operator_on_basis</span><span class="p">(</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">Lambda</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="go">((q1*q2+q2^2)/q1)*B[(1, 2, 1, 1)] + ((q1*q2+q2^2)/q1)*B[(1, 2, 2, 0)] + q2^2/q1*B[(1, 2, 0, 2)]</span>
<span class="go">+ ((q1^2+2*q1*q2+q2^2)/q1)*B[(2, 1, 1, 1)] + ((q1^2+2*q1*q2+q2^2)/q1)*B[(2, 1, 2, 0)]</span>
<span class="go">+ ((q1*q2+q2^2)/q1)*B[(2, 1, 0, 2)] + ((q1^2+2*q1*q2+q2^2)/q1)*B[(2, 2, 1, 0)] + ((q1*q2+q2^2)/q1)*B[(2, 2, 0, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators">
<code class="descname">twisted_demazure_lusztig_operators</code><span class="sig-paren">(</span><em>q1</em>, <em>q2</em>, <em>convention='antidominant'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.root_system.root_lattice_realization_algebras.Algebras.ParentMethods.twisted_demazure_lusztig_operators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the twisted Demazure-Lusztig operators acting on <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q1,q2</span></code> – two elements of the ground ring</li>
<li><code class="docutils literal"><span class="pre">convention</span></code> – “antidominant”, “bar”, or “dominant” (default: “antidominant”)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>the code is currently only tested for <span class="math">\(q_1q_2=-1\)</span></li>
<li>only the “dominant” convention is functional for <span class="math">\(i=0\)</span></li>
</ul>
</div>
<p>For <span class="math">\(T_1,\ldots,T_n\)</span>, these operators are the usual
Demazure-Lusztig operators. On the other hand, the
operator <span class="math">\(T_0\)</span> is twisted:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Choose a good set of Cartan Type to run on. Rank &gt;4 is
too big. But <span class="math">\(C_1\)</span> and <span class="math">\(B_1\)</span> are boring.</p>
</div>
<p>We now check systematically that those operators satisfy
the relations of the Iwahori-Hecke algebra:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;q1,q2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">cartan_type</span> <span class="ow">in</span> <span class="n">CartanType</span><span class="o">.</span><span class="n">samples</span><span class="p">(</span><span class="n">affine</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">crystallographic</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span> <span class="c1"># long time 12s</span>
<span class="go">....:     if cartan_type.rank() &gt; 4: continue</span>
<span class="go">....:     if cartan_type.type() == &#39;BC&#39;: continue</span>
<span class="go">....:     KL = RootSystem(cartan_type).weight_lattice().algebra(K)</span>
<span class="go">....:     T = KL.twisted_demazure_lusztig_operators(q1, q2, convention=&quot;dominant&quot;)</span>
<span class="go">....:     T._test_relations()</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p>Investigate why <span class="math">\(T_0^\vee\)</span> currently does not satisfy
the quadratic relation in type <span class="math">\(BC\)</span>. This should
hopefuly be fixed when <span class="math">\(T_0^\vee\)</span> will have a more
uniform implementation:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cartan_type</span> <span class="o">=</span> <span class="n">CartanType</span><span class="p">([</span><span class="s2">&quot;BC&quot;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">(</span><span class="n">cartan_type</span><span class="p">)</span><span class="o">.</span><span class="n">weight_lattice</span><span class="p">()</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">twisted_demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">_test_relations</span><span class="p">()</span>
<span class="gp">... </span><span class="n">tester</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="n">Ti</span><span class="p">(</span><span class="n">Ti</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">q2</span><span class="p">),</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">q1</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">())</span> <span class="o">...</span>
<span class="go">AssertionError: False is not true</span>
<span class="gt">Traceback (most recent call last):</span>
</pre></div>
</div>
</div>
<p>Comparison with T0:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">RootSystem</span><span class="p">([</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">ambient_space</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;t,q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span><span class="n">q</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">q1</span> <span class="o">=</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="n">q2</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">KL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">algebra</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L0</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">classical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">demazure_lusztig_operators</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">T0</span><span class="p">(</span><span class="o">*</span><span class="n">l0</span><span class="p">):</span> <span class="k">return</span> <span class="n">KL</span><span class="o">.</span><span class="n">q_project</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">on_basis</span><span class="p">()(</span><span class="n">L</span><span class="o">.</span><span class="n">embed_at_level</span><span class="p">(</span><span class="n">L0</span><span class="p">(</span><span class="n">l0</span><span class="p">),</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T0_check_on_basis</span> <span class="o">=</span> <span class="n">KL</span><span class="o">.</span><span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span> <span class="n">q2</span><span class="p">,</span> <span class="n">convention</span><span class="o">=</span><span class="s2">&quot;dominant&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">T0c</span><span class="p">(</span><span class="o">*</span><span class="n">l0</span><span class="p">):</span> <span class="k">return</span> <span class="n">T0_check_on_basis</span><span class="p">(</span><span class="n">L0</span><span class="p">(</span><span class="n">l0</span><span class="p">))</span>

<span class="gp">sage: </span><span class="n">T0</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>                                 <span class="c1"># not double checked</span>
<span class="go">((-t+1)/q)*B[(1, 0, 0)] + 1/q^2*B[(2, 0, -1)]</span>
<span class="gp">sage: </span><span class="n">T0c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(t^2-t)*B[(1, 0, 0)] + (t^2-t)*B[(1, 1, -1)] + t^2*B[(2, 0, -1)] + (t-1)*B[(0, 0, 1)]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="reflection_group_real.html"
                                  title="previous chapter">Finite real reflection groups</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="root_lattice_realizations.html"
                                  title="next chapter">Root lattice realizations</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/root_system/root_lattice_realization_algebras.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="root_lattice_realizations.html" title="Root lattice realizations"
             >next</a> |</li>
        <li class="right" >
          <a href="reflection_group_real.html" title="Finite real reflection groups"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>