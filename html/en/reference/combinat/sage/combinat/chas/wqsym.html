
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>Word Quasi-symmetric functions &#8212; Sage 9.2 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Cluster Algebras and Quivers" href="../cluster_algebra_quiver/__init__.html" />
    <link rel="prev" title="Poirier-Reutenauer Hopf algebra of standard tableaux" href="fsym.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../cluster_algebra_quiver/__init__.html" title="Cluster Algebras and Quivers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fsym.html" title="Poirier-Reutenauer Hopf algebra of standard tableaux"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.2 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Word Quasi-symmetric functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="word-quasi-symmetric-functions">
<span id="sage-combinat-chas-wqsym"></span><h1>Word Quasi-symmetric functions<a class="headerlink" href="#word-quasi-symmetric-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.chas.wqsym"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Travis Scrimshaw (2018-04-09): initial implementation</p></li>
<li><p>Darij Grinberg and Amy Pang (2018-04-12): further bases and methods</p></li>
</ul>
<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WQSymBases">
<em class="property">class </em><code class="sig-prename descclassname">sage.combinat.chas.wqsym.</code><code class="sig-name descname">WQSymBases</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">base</span></em>, <em class="sig-param"><span class="n">graded</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/realizations.html#sage.categories.realizations.Category_realization_of_parent" title="(in Sage 9.2 Reference Manual: Category Framework v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.categories.realizations.Category_realization_of_parent</span></code></a></p>
<p>The category of bases of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ElementMethods">
<em class="property">class </em><code class="sig-name descname">ElementMethods</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement">
<code class="sig-name descname">algebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the algebraic complement involution.</p>
<p>If <span class="math notranslate nohighlight">\(u = (u_1, u_2, \ldots, u_n)\)</span> is a packed word
that contains the letters <span class="math notranslate nohighlight">\(1, 2, \ldots, k\)</span> and no
others, then the <em>complement</em> of <span class="math notranslate nohighlight">\(u\)</span> is defined to
be the packed word
<span class="math notranslate nohighlight">\(\overline{u} := (k+1 - u_1, k+1 - u_2, \ldots, k+1 - u_n)\)</span>.</p>
<p>The algebraic complement involution is defined as the
linear map <span class="math notranslate nohighlight">\(WQSym \to WQSym\)</span> that sends each basis
element <span class="math notranslate nohighlight">\(\mathbf{M}_u\)</span> of the monomial basis of <span class="math notranslate nohighlight">\(WQSym\)</span>
to the basis element <span class="math notranslate nohighlight">\(\mathbf{M}_{\overline{u}}\)</span>.
This is a graded algebra automorphism and a coalgebra
anti-automorphism of <span class="math notranslate nohighlight">\(WQSym\)</span>.
Denoting by <span class="math notranslate nohighlight">\(\overline{f}\)</span> the image of an element
<span class="math notranslate nohighlight">\(f \in WQSym\)</span> under the algebraic complement involution,
it can be shown that every packed word <span class="math notranslate nohighlight">\(u\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[\overline{\mathbf{M}_u} = \mathbf{M}_{\overline{u}},
\qquad \overline{X_u} = X_{\overline{u}},\]</div>
<p>where standard notations for classical bases of <span class="math notranslate nohighlight">\(WQSym\)</span>
are being used (that is, <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> for the monomial
basis, and <span class="math notranslate nohighlight">\(X\)</span> for the characteristic basis).</p>
<p>This can be restated in terms of ordered set partitions:
For any ordered set partition <span class="math notranslate nohighlight">\(R = (R_1, R_2, \ldots, R_k)\)</span>,
let <span class="math notranslate nohighlight">\(R^r\)</span> denote the ordered set partition
<span class="math notranslate nohighlight">\((R_k, R_{k-1}, \ldots, R_1)\)</span>; this is known as
the <em>reversal</em> of <span class="math notranslate nohighlight">\(R\)</span>. Then,</p>
<div class="math notranslate nohighlight">
\[\overline{\mathbf{M}_A} = \mathbf{M}_{A^r}, \qquad
\overline{X_A} = X_{A^r}\]</div>
<p>for any ordered set partition <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>The formula describing algebraic complements on the Q basis
(<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyCoarser</span></code></a>)
is more complicated, and requires some definitions.
We define a partial order <span class="math notranslate nohighlight">\(\leq\)</span> on the set of all ordered
set partitions as follows: <span class="math notranslate nohighlight">\(A \leq B\)</span> if and only if
<span class="math notranslate nohighlight">\(A\)</span> is strongly finer than <span class="math notranslate nohighlight">\(B\)</span> (see
<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer" title="sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_finer()</span></code></a>
for a definition of this).
The <em>length</em> <span class="math notranslate nohighlight">\(\ell(R)\)</span> of an ordered set partition <span class="math notranslate nohighlight">\(R\)</span> shall
be defined as the number of parts of <span class="math notranslate nohighlight">\(R\)</span>.
Use the notation <span class="math notranslate nohighlight">\(Q\)</span> for the Q basis.
For any ordered set partition <span class="math notranslate nohighlight">\(A\)</span> of <span class="math notranslate nohighlight">\([n]\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\overline{Q_A} = \sum_P c_{A, P} Q_P,\]</div>
<p>where the sum is over all ordered set partitions <span class="math notranslate nohighlight">\(P\)</span> of
<span class="math notranslate nohighlight">\([n]\)</span>, and where the coefficient <span class="math notranslate nohighlight">\(c_{A, P}\)</span> is defined
as follows:</p>
<ul class="simple">
<li><p>If there exists an ordered set partition <span class="math notranslate nohighlight">\(R\)</span> satisfying
<span class="math notranslate nohighlight">\(R \leq P\)</span> and <span class="math notranslate nohighlight">\(A \leq R^r\)</span>, then this <span class="math notranslate nohighlight">\(R\)</span> is unique,
and <span class="math notranslate nohighlight">\(c_{A, P} = \left(-1\right)^{\ell(R) - \ell(P)}\)</span>.</p></li>
<li><p>If there exists no such <span class="math notranslate nohighlight">\(R\)</span>, then <span class="math notranslate nohighlight">\(c_{A, P} = 0\)</span>.</p></li>
</ul>
<p>The formula describing algebraic complements on the <span class="math notranslate nohighlight">\(\Phi\)</span>
basis (<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyFiner</span></code></a>)
is identical to the above formula for the Q basis, except
that the <span class="math notranslate nohighlight">\(\leq\)</span> sign has to be replaced by <span class="math notranslate nohighlight">\(\geq\)</span> in the
definition of the coefficients <span class="math notranslate nohighlight">\(c_{A, P}\)</span>. In fact, both
formulas are particular cases of a general formula for
involutions:
Assume that <span class="math notranslate nohighlight">\(V\)</span> is an (additive) abelian group, and that
<span class="math notranslate nohighlight">\(I\)</span> is a poset. For each <span class="math notranslate nohighlight">\(i \in I\)</span>, let <span class="math notranslate nohighlight">\(M_i\)</span> be an element
of <span class="math notranslate nohighlight">\(V\)</span>. Also, let <span class="math notranslate nohighlight">\(\omega\)</span> be an involution of the set <span class="math notranslate nohighlight">\(I\)</span>
(not necessarily order-preserving or order-reversing),
and let <span class="math notranslate nohighlight">\(\omega'\)</span> be an involutive group endomorphism of
<span class="math notranslate nohighlight">\(V\)</span> such that each <span class="math notranslate nohighlight">\(i \in I\)</span> satisfies
<span class="math notranslate nohighlight">\(\omega'(M_i) = M_{\omega(i)}\)</span>.
For each <span class="math notranslate nohighlight">\(i \in I\)</span>, let <span class="math notranslate nohighlight">\(F_i = \sum_{j \geq i} M_j\)</span>,
where we assume that the sum is finite.
Then, each <span class="math notranslate nohighlight">\(i \in I\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[\begin{split}\omega'(F_i)
= \sum_j \sum_{\substack{k \leq j; \\ \omega(k) \geq i}}
  \mu(k, j) F_j,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu\)</span> denotes the Möbius function. This formula becomes
particularly useful when the <span class="math notranslate nohighlight">\(k\)</span> satisfying <span class="math notranslate nohighlight">\(k \leq j\)</span>
and <span class="math notranslate nohighlight">\(\omega(k) \geq i\)</span> is unique (if it exists).
In our situation, <span class="math notranslate nohighlight">\(V\)</span> is <span class="math notranslate nohighlight">\(WQSym\)</span>, and <span class="math notranslate nohighlight">\(I\)</span> is the set of
ordered set partitions equipped either with the <span class="math notranslate nohighlight">\(\leq\)</span> partial
order defined above or with its opposite order.
The <span class="math notranslate nohighlight">\(M_i\)</span> is the <span class="math notranslate nohighlight">\(\mathbf{M}_A\)</span>, whereas the <span class="math notranslate nohighlight">\(F_i\)</span> is either
<span class="math notranslate nohighlight">\(Q_i\)</span> or <span class="math notranslate nohighlight">\(\Phi_i\)</span>.</p>
<p>If we denote the star involution
(<a class="reference internal" href="../ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Bases.ElementMethods.star_involution" title="sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Bases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a>)
of the quasisymmetric functions by <span class="math notranslate nohighlight">\(f \mapsto f^{\ast}\)</span>,
and if we let <span class="math notranslate nohighlight">\(\pi\)</span> be the canonical projection
<span class="math notranslate nohighlight">\(WQSym \to QSym\)</span>, then each <span class="math notranslate nohighlight">\(f \in WQSym\)</span> satisfies
<span class="math notranslate nohighlight">\(\pi(\overline{f}) = (\pi(f))^{\ast}\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>Recall that the index set for the bases of <span class="math notranslate nohighlight">\(WQSym\)</span> is
given by ordered set partitions, not packed words.
Translated into the language of ordered set partitions,
the algebraic complement involution acts on the
Monomial basis by reversing the ordered set partition.
In other words, we have</p>
<div class="math notranslate nohighlight">
\[\overline{\mathbf{M}_{(P_1, P_2, \ldots, P_k)}}
= \mathbf{M}_{(P_k, P_{k-1}, \ldots, P_1)}\]</div>
<p>for any standard ordered set partition
<span class="math notranslate nohighlight">\((P_1, P_2, \ldots, P_k)\)</span>. Let us check this in practice:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">M[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">M[{3, 6}, {2, 5}, {1, 4}]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">M</span><span class="p">[[]]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">-4*M[] + 3*M[{1}] + 5*M[{2}, {1}]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">X[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">-C[{1, 2, 3}] - C[{1, 3}, {2}] + C[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">Q[{3, 4}, {1, 2, 5, 6}] + Q[{3, 4}, {5, 6}, {1, 2}] - Q[{3, 4, 5, 6}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{1}, {3}, {2}] + Phi[{1, 3}, {2}] + Phi[{3}, {1}, {2}]</span>
</pre></div>
</div>
<p>The algebraic complement involution intertwines the antipode
and the inverse of the antipode:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Testing the <span class="math notranslate nohighlight">\(\pi(\overline{f}) = (\pi(f))^{\ast}\)</span> relation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Check further commutative squares.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement">
<code class="sig-name descname">coalgebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the coalgebraic complement involution.</p>
<p>If <span class="math notranslate nohighlight">\(u = (u_1, u_2, \ldots, u_n)\)</span> is a packed word,
then the <em>reversal</em> of <span class="math notranslate nohighlight">\(u\)</span> is defined to be the
packed word <span class="math notranslate nohighlight">\((u_n, u_{n-1}, \ldots, u_1)\)</span>.
This reversal is denoted by <span class="math notranslate nohighlight">\(u^r\)</span>.</p>
<p>The coalgebraic complement involution is defined as the
linear map <span class="math notranslate nohighlight">\(WQSym \to WQSym\)</span> that sends each basis
element <span class="math notranslate nohighlight">\(\mathbf{M}_u\)</span> of the monomial basis of <span class="math notranslate nohighlight">\(WQSym\)</span>
to the basis element <span class="math notranslate nohighlight">\(\mathbf{M}_{u^r}\)</span>.
This is a graded coalgebra automorphism and an algebra
anti-automorphism of <span class="math notranslate nohighlight">\(WQSym\)</span>.
Denoting by <span class="math notranslate nohighlight">\(f^r\)</span> the image of an element <span class="math notranslate nohighlight">\(f \in WQSym\)</span>
under the coalgebraic complement involution,
it can be shown that every packed word <span class="math notranslate nohighlight">\(u\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[(\mathbf{M}_u)^r = \mathbf{M}_{u^r}, \qquad
(X_u)^r = X_{u^r},\]</div>
<p>where standard notations for classical bases of <span class="math notranslate nohighlight">\(WQSym\)</span>
are being used (that is, <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> for the monomial
basis, and <span class="math notranslate nohighlight">\(X\)</span> for the characteristic basis).</p>
<p>This can be restated in terms of ordered set partitions:
For any ordered set partition <span class="math notranslate nohighlight">\(R\)</span> of <span class="math notranslate nohighlight">\([n]\)</span>, let
<span class="math notranslate nohighlight">\(\overline{R}\)</span> denote the complement of <span class="math notranslate nohighlight">\(R\)</span> (defined in
<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.complement" title="sage.combinat.set_partition_ordered.OrderedSetPartition.complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complement()</span></code></a>).
Then,</p>
<div class="math notranslate nohighlight">
\[(\mathbf{M}_A)^r = \mathbf{M}_{\overline{A}}, \qquad
(X_A)^r = X_{\overline{A}}\]</div>
<p>for any ordered set partition <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Recall that <span class="math notranslate nohighlight">\(WQSym\)</span> is a subring of the ring of all
bounded-degree noncommutative power series in countably many
indeterminates. The latter ring has an obvious continuous
algebra anti-endomorphism which sends each letter <span class="math notranslate nohighlight">\(x_i\)</span> to
<span class="math notranslate nohighlight">\(x_i\)</span> (and thus sends each monomial
<span class="math notranslate nohighlight">\(x_{i_1} x_{i_2} \cdots x_{i_n}\)</span> to
<span class="math notranslate nohighlight">\(x_{i_n} x_{i_{n-1}} \cdots x_{i_1}\)</span>).
This anti-endomorphism is actually an involution.
The coalgebraic complement involution is simply the
restriction of this involution to the subring <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>The formula describing coalgebraic complements on the Q basis
(<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyCoarser</span></code></a>)
is more complicated, and requires some definitions.
We define a partial order <span class="math notranslate nohighlight">\(\leq\)</span> on the set of all ordered
set partitions as follows: <span class="math notranslate nohighlight">\(A \leq B\)</span> if and only if
<span class="math notranslate nohighlight">\(A\)</span> is strongly finer than <span class="math notranslate nohighlight">\(B\)</span> (see
<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer" title="sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_finer()</span></code></a>
for a definition of this).
The <em>length</em> <span class="math notranslate nohighlight">\(\ell(R)\)</span> of an ordered set partition <span class="math notranslate nohighlight">\(R\)</span> shall
be defined as the number of parts of <span class="math notranslate nohighlight">\(R\)</span>.
Use the notation <span class="math notranslate nohighlight">\(Q\)</span> for the Q basis.
For any ordered set partition <span class="math notranslate nohighlight">\(A\)</span> of <span class="math notranslate nohighlight">\([n]\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[(Q_A)^r = \sum_P c_{A, P} Q_P ,\]</div>
<p>where the sum is over all ordered set partitions <span class="math notranslate nohighlight">\(P\)</span> of
<span class="math notranslate nohighlight">\([n]\)</span>, and where the coefficient <span class="math notranslate nohighlight">\(c_{A, P}\)</span> is defined
as follows:</p>
<ul class="simple">
<li><p>If there exists an ordered set partition <span class="math notranslate nohighlight">\(R\)</span> satisfying
<span class="math notranslate nohighlight">\(R \leq P\)</span> and <span class="math notranslate nohighlight">\(A \leq \overline{R}\)</span>, then this <span class="math notranslate nohighlight">\(R\)</span> is
unique,
and <span class="math notranslate nohighlight">\(c_{A, P} = \left(-1\right)^{\ell(R) - \ell(P)}\)</span>.</p></li>
<li><p>If there exists no such <span class="math notranslate nohighlight">\(R\)</span>, then <span class="math notranslate nohighlight">\(c_{A, P} = 0\)</span>.</p></li>
</ul>
<p>The formula describing coalgebraic complements on the <span class="math notranslate nohighlight">\(\Phi\)</span>
basis (<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyFiner</span></code></a>)
is identical to the above formula for the Q basis, except
that the <span class="math notranslate nohighlight">\(\leq\)</span> sign has to be replaced by <span class="math notranslate nohighlight">\(\geq\)</span> in the
definition of the coefficients <span class="math notranslate nohighlight">\(c_{A, P}\)</span>. In fact, both
formulas are particular cases of the general formula for
involutions described in the documentation of
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>.</p>
<p>If we let <span class="math notranslate nohighlight">\(\pi\)</span> be the canonical projection
<span class="math notranslate nohighlight">\(WQSym \to QSym\)</span>, then each <span class="math notranslate nohighlight">\(f \in WQSym\)</span> satisfies
<span class="math notranslate nohighlight">\(\pi(f^r) = \pi(f)\)</span>.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>Recall that the index set for the bases of <span class="math notranslate nohighlight">\(WQSym\)</span> is
given by ordered set partitions, not packed words.
Translated into the language of ordered set partitions,
the coalgebraic complement involution acts on the
Monomial basis by complementing the ordered set partition.
In other words, we have</p>
<div class="math notranslate nohighlight">
\[(\mathbf{M}_A)^r = \mathbf{M}_{\overline{A}}\]</div>
<p>for any standard ordered set partition <span class="math notranslate nohighlight">\(P\)</span>.
Let us check this in practice:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">M[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">M[{2, 3}, {1}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">M[{4}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">M[{3, 6}, {2, 5}, {1, 4}]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">M</span><span class="p">[[]]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">-4*M[] + 3*M[{1}] + 5*M[{2}, {1}]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">X[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">C[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">Q[{1, 2, 5, 6}, {3, 4}] + Q[{5, 6}, {1, 2}, {3, 4}] - Q[{5, 6}, {1, 2, 3, 4}]</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{2}, {1}, {3}] + Phi[{2}, {1, 3}] + Phi[{2}, {3}, {1}]</span>
</pre></div>
</div>
<p>The coalgebraic complement involution intertwines the antipode
and the inverse of the antipode:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Testing the <span class="math notranslate nohighlight">\(\pi(f^r) = \pi(f)\)</span> relation above:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Check further commutative squares.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution">
<code class="sig-name descname">star_involution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the star involution.</p>
<p>The star involution is the composition of the
algebraic complement involution
(<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>) with the coalgebraic
complement involution (<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a>).
The composition can be performed in either order, as the
involutions commute.</p>
<p>The star involution is a graded Hopf algebra
anti-automorphism of <span class="math notranslate nohighlight">\(WQSym\)</span>.
Let <span class="math notranslate nohighlight">\(f^{\ast}\)</span> denote the image of an element
<span class="math notranslate nohighlight">\(f \in WQSym\)</span> under the star involution.
Let <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>, <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(\Phi\)</span> stand for the
monomial, characteristic, Q and Phi bases of <span class="math notranslate nohighlight">\(WQSym\)</span>.
For any ordered set partition <span class="math notranslate nohighlight">\(A\)</span> of <span class="math notranslate nohighlight">\([n]\)</span>, we let
<span class="math notranslate nohighlight">\(A^{\ast}\)</span> denote the complement
(<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.complement" title="sage.combinat.set_partition_ordered.OrderedSetPartition.complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">complement()</span></code></a>)
of the reversal
(<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.reversed" title="sage.combinat.set_partition_ordered.OrderedSetPartition.reversed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reversed()</span></code></a>)
of <span class="math notranslate nohighlight">\(A\)</span>. Then, for any ordered set partition <span class="math notranslate nohighlight">\(A\)</span> of <span class="math notranslate nohighlight">\([n]\)</span>,
we have</p>
<div class="math notranslate nohighlight">
\[(\mathbf{M}_A)^{\ast} = \mathbf{M}_{A^{\ast}}, \qquad
(X_A)^{\ast} = X_{A^{\ast}}, \qquad
(Q_A)^{\ast} = Q_{A^{\ast}}, \qquad
(\Phi_A)^{\ast} = \Phi_{A^{\ast}} .\]</div>
<p>The star involution
(<a class="reference internal" href="../ncsf_qsym/ncsf.html#sage.combinat.ncsf_qsym.ncsf.NonCommutativeSymmetricFunctions.Bases.ElementMethods.star_involution" title="sage.combinat.ncsf_qsym.ncsf.NonCommutativeSymmetricFunctions.Bases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a>)
on the ring of noncommutative symmetric functions is a
restriction of the star involution on <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>If we denote the star involution
(<a class="reference internal" href="../ncsf_qsym/qsym.html#sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Bases.ElementMethods.star_involution" title="sage.combinat.ncsf_qsym.qsym.QuasiSymmetricFunctions.Bases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a>)
of the quasisymmetric functions by <span class="math notranslate nohighlight">\(f \mapsto f^{\ast}\)</span>,
and if we let <span class="math notranslate nohighlight">\(\pi\)</span> be the canonical projection
<span class="math notranslate nohighlight">\(WQSym \to QSym\)</span>, then each <span class="math notranslate nohighlight">\(f \in WQSym\)</span> satisfies
<span class="math notranslate nohighlight">\(\pi(f^{\ast}) = (\pi(f))^{\ast}\)</span>.</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>More commutative diagrams?
FQSym and FSym need their own star_involution
methods defined first.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>Keep in mind that the default input method for basis keys
of <span class="math notranslate nohighlight">\(WQSym\)</span> is by entering an ordered set partition, not a
packed word. Let us check the basis formulas for the
star involution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">M[{1, 2, 4}, {3, 5}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">M[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">M[{1, 4}, {2, 5}, {3, 6}]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">M</span><span class="p">[[]]</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">-4*M[] + 3*M[{1}] + 5*M[{1}, {2}]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">X[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">-C[{1, 2, 3}] - C[{1, 3}, {2}] + C[{2}, {1, 3}]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Q[{1, 2, 4}, {3, 5}]</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Phi[{1, 2, 4}, {3, 5}]</span>
</pre></div>
</div>
<p>Testing the formulas for <span class="math notranslate nohighlight">\((Q_A)^{\ast}\)</span> and <span class="math notranslate nohighlight">\((\Phi_A)^{\ast}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">A</span><span class="p">]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span><span class="o">.</span><span class="n">reversed</span><span class="p">()]</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">Phi</span><span class="p">[</span><span class="n">A</span><span class="p">]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span> <span class="o">==</span> <span class="n">Phi</span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">complement</span><span class="p">()</span><span class="o">.</span><span class="n">reversed</span><span class="p">()]</span> <span class="k">for</span> <span class="n">A</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The star involution commutes with the antipode:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">(</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Testing the <span class="math notranslate nohighlight">\(\pi(f^{\ast}) = (\pi(f))^{\ast}\)</span> relation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="gp">....: </span>     <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">OrderedSetPartitions</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Testing the fact that the star involution on the
noncommutative symmetric functions is a restriction of
the star involution on <span class="math notranslate nohighlight">\(WQSym\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">NCSF</span> <span class="o">=</span> <span class="n">NonCommutativeSymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">NCSF</span><span class="o">.</span><span class="n">R</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span><span class="o">.</span><span class="n">to_fqsym</span><span class="p">()</span><span class="o">.</span><span class="n">to_wqsym</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="o">==</span> <span class="n">R</span><span class="p">[</span><span class="n">I</span><span class="p">]</span><span class="o">.</span><span class="n">to_fqsym</span><span class="p">()</span><span class="o">.</span><span class="n">to_wqsym</span><span class="p">()</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">I</span> <span class="ow">in</span> <span class="n">Compositions</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Check further commutative squares.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.to_quasisymmetric_function">
<code class="sig-name descname">to_quasisymmetric_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.to_quasisymmetric_function" title="Permalink to this definition">¶</a></dt>
<dd><p>The projection of <code class="docutils literal notranslate"><span class="pre">self</span></code> to the ring <span class="math notranslate nohighlight">\(QSym\)</span> of
quasisymmetric functions.</p>
<p>There is a canonical projection <span class="math notranslate nohighlight">\(\pi : WQSym \to QSym\)</span>
that sends every element <span class="math notranslate nohighlight">\(\mathbf{M}_P\)</span> of the monomial
basis of <span class="math notranslate nohighlight">\(WQSym\)</span> to the monomial quasisymmetric function
<span class="math notranslate nohighlight">\(M_c\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is the composition whose parts are the
sizes of the blocks of <span class="math notranslate nohighlight">\(P\)</span>.
This <span class="math notranslate nohighlight">\(\pi\)</span> is a ring homomorphism.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>an element of the quasisymmetric functions in the monomial basis</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">M[2, 1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],])</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">4*M[2, 1] - M[3]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span> <span class="o">*</span> <span class="n">Y</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span> <span class="o">==</span> <span class="p">(</span><span class="n">X</span><span class="o">*</span><span class="n">Y</span><span class="p">)</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span> <span class="o">==</span> <span class="n">M</span><span class="p">(</span><span class="n">C</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C2</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">M[2, 2]</span>
<span class="gp">sage: </span><span class="n">C2</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">to_quasisymmetric_function</span><span class="p">()</span>
<span class="go">M[4]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ParentMethods">
<em class="property">class </em><code class="sig-name descname">ParentMethods</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ParentMethods" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ParentMethods.degree_on_basis">
<code class="sig-name descname">degree_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ParentMethods.degree_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of an ordered set partition in
the algebra of word quasi-symmetric functions.</p>
<p>This is the sum of the sizes of the blocks of the
ordered set partition.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">degree_on_basis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">degree_on_basis</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ParentMethods.is_commutative">
<code class="sig-name descname">is_commutative</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ParentMethods.is_commutative" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is commutative.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_commutative</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ParentMethods.is_field">
<code class="sig-name descname">is_field</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">proof</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ParentMethods.is_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether <code class="docutils literal notranslate"><span class="pre">self</span></code> is a field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.ParentMethods.one_basis">
<code class="sig-name descname">one_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.ParentMethods.one_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of the unit.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">one_basis</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBases.super_categories">
<code class="sig-name descname">super_categories</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBases.super_categories" title="Permalink to this definition">¶</a></dt>
<dd><p>The super categories of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.chas.wqsym</span> <span class="kn">import</span> <span class="n">WQSymBases</span>
<span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bases</span> <span class="o">=</span> <span class="n">WQSymBases</span><span class="p">(</span><span class="n">WQSym</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bases</span><span class="o">.</span><span class="n">super_categories</span><span class="p">()</span>
<span class="go">[Category of realizations of Word Quasi-symmetric functions over Integer Ring,</span>
<span class="go"> Join of Category of realizations of hopf algebras over Integer Ring</span>
<span class="go">     and Category of graded algebras over Integer Ring</span>
<span class="go">     and Category of graded coalgebras over Integer Ring,</span>
<span class="go"> Category of graded connected hopf algebras with basis over Integer Ring]</span>

<span class="gp">sage: </span><span class="n">bases</span> <span class="o">=</span> <span class="n">WQSymBases</span><span class="p">(</span><span class="n">WQSym</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bases</span><span class="o">.</span><span class="n">super_categories</span><span class="p">()</span>
<span class="go">[Category of realizations of Word Quasi-symmetric functions over Integer Ring,</span>
<span class="go"> Join of Category of realizations of hopf algebras over Integer Ring</span>
<span class="go">     and Category of graded algebras over Integer Ring</span>
<span class="go">     and Category of graded coalgebras over Integer Ring,</span>
<span class="go"> Join of Category of filtered connected hopf algebras with basis over Integer Ring</span>
<span class="go">     and Category of graded algebras over Integer Ring</span>
<span class="go">     and Category of graded coalgebras over Integer Ring]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WQSymBasis_abstract">
<em class="property">class </em><code class="sig-prename descclassname">sage.combinat.chas.wqsym.</code><code class="sig-name descname">WQSymBasis_abstract</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em>, <em class="sig-param"><span class="n">graded</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../free_module.html#sage.combinat.free_module.CombinatorialFreeModule" title="sage.combinat.free_module.CombinatorialFreeModule"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.free_module.CombinatorialFreeModule</span></code></a>, <a class="reference external" href="../../../../misc/sage/misc/bindable_class.html#sage.misc.bindable_class.BindableClass" title="(in Sage 9.2 Reference Manual: Utilities v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.misc.bindable_class.BindableClass</span></code></a></p>
<p>Abstract base class for bases of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>This must define two attributes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_prefix</span></code> – the basis prefix</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_basis_name</span></code> – the name of the basis (must match one
of the names that the basis can be constructed from <span class="math notranslate nohighlight">\(WQSym\)</span>)</p></li>
</ul>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBasis_abstract.an_element">
<code class="sig-name descname">an_element</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract.an_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an element of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">an_element</span><span class="p">()</span>
<span class="go">M[{1}] + 2*M[{1}, {2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.combinat.chas.wqsym.WQSymBasis_abstract.options">
<code class="sig-name descname">options</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">get_value</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">set_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Set and display the global options for bases of WordQuasiSymmetricFunctions.
If no parameters are set, then the function returns a copy of the options
dictionary.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> can be accessed as the method
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.options</span></code></a> of
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions</span></code></a> or of any associated basis.</p>
<p>OPTIONS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">display</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">normal</span></code>)
Specifies how basis elements of WordQuasiSymmetricFunctions should be printed</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compact</span></code> – Using a severely compacted representation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normal</span></code>  – Using the normal representation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tight</span></code>   – Dropping spaces after commas</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">objects</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">compositions</span></code>)
Specifies how basis elements of WordQuasiSymmetricFunctions should be indexed</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compositions</span></code> – Indexing the basis by ordered set partitions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">words</span></code>        – Indexing the basis by packed words</p></li>
</ul>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">'words'</span></code> representation of a basis element of
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions</span></code></a>, indexed by an ordered
set partition <span class="math notranslate nohighlight">\(A\)</span>, is the packed word associated to <span class="math notranslate nohighlight">\(A\)</span>.
See <a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.to_packed_word" title="sage.combinat.set_partition_ordered.OrderedSetPartition.to_packed_word"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OrderedSetPartition.to_packed_word()</span></code></a> for details.)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQ</span> <span class="o">=</span> <span class="n">WordQuasiSymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQ</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">elt</span> <span class="o">=</span> <span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]]</span><span class="o">*</span><span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">]]];</span> <span class="n">elt</span>
<span class="go">M[{1, 2}, {3}] + M[{1, 2, 3}] + M[{3}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[{1,2},{3}] + M[{1,2,3}] + M[{3},{1,2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;compact&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[12.3] + M[123] + M[3.12]</span>
<span class="gp">sage: </span><span class="n">WQ</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="s2">&quot;words&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[1, 1, 2] + M[1, 1, 1] + M[2, 2, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[1,1,2] + M[1,1,1] + M[2,2,1]</span>
<span class="gp">sage: </span><span class="n">WQ</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;compact&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[112] + M[111] + M[221]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[{1, 2}, {3}] + M[{1, 2, 3}] + M[{3}, {1, 2}]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="../../../../structure/sage/structure/global_options.html#sage.structure.global_options.GlobalOptions" title="(in Sage 9.2 Reference Manual: Parents and Elements v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalOptions</span></code></a> for more features of these options.</p>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WQSymBasis_abstract.some_elements">
<code class="sig-name descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of the word quasi-symmetric functions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[M[], M[{1}], M[{1, 2}],</span>
<span class="go"> M[{1}] + M[{1}, {2}],</span>
<span class="go"> M[] + 1/2*M[{1}]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions">
<em class="property">class </em><code class="sig-prename descclassname">sage.combinat.chas.wqsym.</code><code class="sig-name descname">WordQuasiSymmetricFunctions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage 9.2 Reference Manual: Parents and Elements v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Sage 9.2 Reference Manual: Parents and Elements v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.parent.Parent</span></code></a></p>
<p>The word quasi-symmetric functions.</p>
<p>The ring of word quasi-symmetric functions can be defined as a
subring of the ring of all bounded-degree noncommutative power
series in countably many indeterminates (i.e., elements in
<span class="math notranslate nohighlight">\(R \langle \langle x_1, x_2, x_3, \ldots \rangle \rangle\)</span> of bounded
degree). Namely, consider words over the alphabet <span class="math notranslate nohighlight">\(\{1, 2, 3, \ldots\}\)</span>;
every noncommutative power series is an infinite <span class="math notranslate nohighlight">\(R\)</span>-linear
combination of these words.
For each such word <span class="math notranslate nohighlight">\(w\)</span>, we define the <em>packing</em> of <span class="math notranslate nohighlight">\(w\)</span> to be the
word <span class="math notranslate nohighlight">\(\operatorname{pack}(w)\)</span> that is obtained from <span class="math notranslate nohighlight">\(w\)</span> by replacing
the smallest letter that appears in <span class="math notranslate nohighlight">\(w\)</span> by <span class="math notranslate nohighlight">\(1\)</span>, the second-smallest
letter that appears in <span class="math notranslate nohighlight">\(w\)</span> by <span class="math notranslate nohighlight">\(2\)</span>, etc. (for example,
<span class="math notranslate nohighlight">\(\operatorname{pack}(4112774) = 3112443\)</span>).
A word <span class="math notranslate nohighlight">\(w\)</span> is said to be <em>packed</em> if <span class="math notranslate nohighlight">\(\operatorname{pack}(w) = w\)</span>.
For each packed word <span class="math notranslate nohighlight">\(u\)</span>, we define the noncommutative power series
<span class="math notranslate nohighlight">\(\mathbf{M}_u = \sum w\)</span>, where the sum ranges over all words <span class="math notranslate nohighlight">\(w\)</span>
satisfying <span class="math notranslate nohighlight">\(\operatorname{pack}(w) = u\)</span>.
The span of these power series <span class="math notranslate nohighlight">\(\mathbf{M}_u\)</span> is a subring of the
ring of all noncommutative power series; it is called the ring of
word quasi-symmetric functions, and is denoted by <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>For each nonnegative integer <span class="math notranslate nohighlight">\(n\)</span>, there is a bijection between
packed words of length <span class="math notranslate nohighlight">\(n\)</span> and ordered set partitions of
<span class="math notranslate nohighlight">\(\{1, 2, \ldots, n\}\)</span>. Under this bijection, a packed word
<span class="math notranslate nohighlight">\(u = (u_1, u_2, \ldots, u_n)\)</span> of length <span class="math notranslate nohighlight">\(n\)</span> corresponds to the
ordered set partition <span class="math notranslate nohighlight">\(P = (P_1, P_2, \ldots, P_k)\)</span> of
<span class="math notranslate nohighlight">\(\{1, 2, \ldots, n\}\)</span> whose <span class="math notranslate nohighlight">\(i\)</span>-th part <span class="math notranslate nohighlight">\(P_i\)</span> (for each <span class="math notranslate nohighlight">\(i\)</span>) is the
set of all <span class="math notranslate nohighlight">\(j \in \{1, 2, \ldots, n\}\)</span> such that <span class="math notranslate nohighlight">\(u_j = i\)</span>.</p>
<p>The basis element <span class="math notranslate nohighlight">\(\mathbf{M}_u\)</span> is also denoted as <span class="math notranslate nohighlight">\(\mathbf{M}_P\)</span>
in this situation. The basis <span class="math notranslate nohighlight">\((\mathbf{M}_P)_P\)</span> is called the
<em>Monomial basis</em> and is implemented as
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monomial</span></code></a>.</p>
<p>Other bases are the cone basis (aka C basis), the characteristic
basis (aka X basis), the Q basis and the Phi basis.</p>
<p>Bases of <span class="math notranslate nohighlight">\(WQSym\)</span> are implemented (internally) using ordered set
partitions. However, the user may access specific basis vectors using
either packed words or ordered set partitions. See the examples below,
noting especially the section on ambiguities.</p>
<p><span class="math notranslate nohighlight">\(WQSym\)</span> is endowed with a connected graded Hopf algebra structure (see
Section 2.2 of <a class="reference internal" href="../../../../references/index.html#nothwi08" id="id5"><span>[NoThWi08]</span></a>, Section 1.1 of <a class="reference internal" href="../../../../references/index.html#foimal14" id="id6"><span>[FoiMal14]</span></a> and
Section 4.3.2 of <a class="reference internal" href="../../../../references/index.html#menoth11" id="id7"><span>[MeNoTh11]</span></a>) given by</p>
<div class="math notranslate nohighlight">
\[\Delta(\mathbf{M}_{(P_1,\ldots,P_{\ell})}) = \sum_{i=0}^{\ell}
    \mathbf{M}_{\operatorname{st}(P_1, \ldots, P_i)} \otimes
    \mathbf{M}_{\operatorname{st}(P_{i+1}, \ldots, P_{\ell})}.\]</div>
<p>Here, for any ordered set partition <span class="math notranslate nohighlight">\((Q_1, \ldots, Q_k)\)</span> of a
finite set <span class="math notranslate nohighlight">\(Z\)</span> of integers, we let <span class="math notranslate nohighlight">\(\operatorname{st}(Q_1, \ldots, Q_k)\)</span>
denote the set partition obtained from <span class="math notranslate nohighlight">\(Z\)</span> by replacing the smallest
element appearing in it by <span class="math notranslate nohighlight">\(1\)</span>, the second-smallest element by <span class="math notranslate nohighlight">\(2\)</span>,
and so on.</p>
<p>A rule for multiplying elements of the monomial basis relies on the
<em>quasi-shuffle product</em> of two ordered set partitions.
The quasi-shuffle product <span class="math notranslate nohighlight">\(\Box\)</span> is given by
<a class="reference internal" href="../shuffle.html#sage.combinat.shuffle.ShuffleProduct_overlapping" title="sage.combinat.shuffle.ShuffleProduct_overlapping"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShuffleProduct_overlapping</span></code></a> with the
<code class="docutils literal notranslate"><span class="pre">+</span></code> operation in the overlapping of the shuffles being the
union of the sets.  The product <span class="math notranslate nohighlight">\(\mathbf{M}_P \mathbf{M}_Q\)</span>
for two ordered set partitions <span class="math notranslate nohighlight">\(P\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> of <span class="math notranslate nohighlight">\([n]\)</span> and <span class="math notranslate nohighlight">\([m]\)</span>
is then given by</p>
<div class="math notranslate nohighlight">
\[\mathbf{M}_P \mathbf{M}_Q
= \sum_{R \in P \Box Q^+} \mathbf{M}_R ,\]</div>
<p>where <span class="math notranslate nohighlight">\(Q^+\)</span> means <span class="math notranslate nohighlight">\(Q\)</span> with all numbers shifted upwards by <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Sometimes, <span class="math notranslate nohighlight">\(WQSym\)</span> is also denoted as <span class="math notranslate nohighlight">\(NCQSym\)</span>.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../../references/index.html#foimal14" id="id8"><span>[FoiMal14]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#menoth11" id="id9"><span>[MeNoTh11]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#nothwi08" id="id10"><span>[NoThWi08]</span></a></p></li>
<li><p><a class="reference internal" href="../../../../references/index.html#berzab05" id="id11"><span>[BerZab05]</span></a></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Constructing the algebra and its Monomial basis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">WQSym</span>
<span class="go">Word Quasi-symmetric functions over Integer Ring</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">Word Quasi-symmetric functions over Integer Ring in the Monomial basis</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[]]</span>
<span class="go">M[]</span>
</pre></div>
</div>
<p>Calling basis elements using packed words:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">x</span>
<span class="go">M[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="n">Word</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">];</span> <span class="n">y</span>
<span class="go">-M[{1}, {2, 3}] + M[{1, 2}, {3}]</span>
</pre></div>
</div>
<p>Calling basis elements using ordered set partitions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],];</span> <span class="n">z</span>
<span class="go">M[{1, 2, 3}]</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">==</span> <span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]]</span> <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">M[{1, 2}, {3}]</span>
</pre></div>
</div>
<p>Note that expressions above are output in terms of ordered set partitions,
even when input as packed words. Output as packed words can be achieved
by modifying the global options. (See <code class="xref py py-meth docutils literal notranslate"><span class="pre">OrderedSetPartitions.options()</span></code>
for further details.):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="s2">&quot;words&quot;</span>
<span class="gp">sage: </span><span class="n">y</span>
<span class="go">-M[1, 2, 2] + M[1, 1, 2]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;compact&quot;</span>
<span class="gp">sage: </span><span class="n">y</span>
<span class="go">-M[122] + M[112]</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">M[111]</span>
</pre></div>
</div>
<p>The options should be reset to display as ordered set partitions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">M[{1, 2, 3}]</span>
</pre></div>
</div>
<p>Illustration of the Hopf algebra structure:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">M[] # M[{2, 3}, {5}, {6}, {4}, {1}] + M[{1, 2}] # M[{3}, {4}, {2}, {1}]</span>
<span class="go"> + M[{1, 2}, {3}] # M[{3}, {2}, {1}] + M[{1, 2}, {3}, {4}] # M[{2}, {1}]</span>
<span class="go"> + M[{1, 2}, {4}, {5}, {3}] # M[{1}] + M[{2, 3}, {5}, {6}, {4}, {1}] # M[]</span>
<span class="gp">sage: </span><span class="n">_</span> <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span> <span class="o">*</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>   <span class="c1"># packed words</span>
<span class="go">M[{1, 2, 3}, {4, 5}, {6}] + M[{1, 2, 3, 4, 5}, {6}]</span>
<span class="go"> + M[{4, 5}, {1, 2, 3}, {6}] + M[{4, 5}, {1, 2, 3, 6}]</span>
<span class="go"> + M[{4, 5}, {6}, {1, 2, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],]</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>  <span class="c1"># ordered set partition</span>
<span class="go">-M[{1, 2, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>
<span class="go">-M[{1, 2, 3}] - M[{2, 3}, {1}] - M[{3}, {1, 2}] - M[{3}, {2}, {1}]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">M</span><span class="p">[[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">counit</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">antipode</span><span class="p">()</span>
<span class="go">3*M[{1}, {2}] + 3*M[{1, 2}] - M[{1, 2, 3}] - M[{2, 3}, {1}]</span>
<span class="go"> - M[{3}, {1, 2}] - M[{3}, {2}, {1}]</span>
</pre></div>
</div>
<p class="rubric">Ambiguities</p>
<p>Some ambiguity arises when accessing basis vectors with the dictionary syntax,
i.e., <code class="docutils literal notranslate"><span class="pre">M[...]</span></code>. A common example is when referencing an ordered set partition
with one part. For example, in the expression <code class="docutils literal notranslate"><span class="pre">M[[1,2]]</span></code>, does <code class="docutils literal notranslate"><span class="pre">[[1,2]]</span></code>
refer to an ordered set partition or does <code class="docutils literal notranslate"><span class="pre">[1,2]</span></code> refer to a packed word?
We choose the latter: if the received arguments do not behave like a tuple of
iterables, then view them as describing a packed word. (In the running example,
one argument is received, which behaves as a tuple of integers.) Here are a
variety of ways to get the same basis vector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">x</span>
<span class="go">M[{1, 2}]</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># treated as word</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],]</span> <span class="o">==</span> <span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]]</span>  <span class="c1"># treated as ordered set partitions</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span>  <span class="c1"># treat as ordered set partition</span>
<span class="go">M[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">==</span> <span class="n">M</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># treat as word</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id12">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Dendriform structure.</p></li>
</ul>
</div>
<dl class="py attribute">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.C">
<code class="sig-name descname">C</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.C" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.Cone</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic">
<em class="property">class </em><code class="sig-name descname">Characteristic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="sage.combinat.chas.wqsym.WQSymBasis_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.chas.wqsym.WQSymBasis_abstract</span></code></a></p>
<p>The Characteristic basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>The <em>Characteristic basis</em> is a graded basis <span class="math notranslate nohighlight">\((X_P)\)</span> of <span class="math notranslate nohighlight">\(WQSym\)</span>,
indexed by ordered set partitions <span class="math notranslate nohighlight">\(P\)</span>. It is defined by</p>
<div class="math notranslate nohighlight">
\[X_P = (-1)^{\ell(P)} \mathbf{M}_P ,\]</div>
<p>where <span class="math notranslate nohighlight">\((\mathbf{M}_P)_P\)</span> denotes the Monomial basis,
and where <span class="math notranslate nohighlight">\(\ell(P)\)</span> denotes the number of blocks in an ordered
set partition <span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">();</span> <span class="n">X</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Characteristic basis</span>

<span class="gp">sage: </span><span class="n">X</span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]]</span> <span class="o">*</span> <span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">X[{1, 2, 3}, {4, 5}, {6}] - X[{1, 2, 3, 4, 5}, {6}]</span>
<span class="go"> + X[{4, 5}, {1, 2, 3}, {6}] - X[{4, 5}, {1, 2, 3, 6}]</span>
<span class="go"> + X[{4, 5}, {6}, {1, 2, 3}]</span>

<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">X[] # X[{1, 4}, {3}, {2}] + X[{1, 2}] # X[{2}, {1}]</span>
<span class="go"> + X[{1, 3}, {2}] # X[{1}] + X[{1, 4}, {3}, {2}] # X[]</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],])</span>
<span class="go">-M[{1, 2, 3}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">M[{1, 3}, {2}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],])</span>
<span class="go">-X[{1, 2, 3}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="go">X[{1, 3}, {2}]</span>
</pre></div>
</div>
<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element">
<em class="property">class </em><code class="sig-name descname">Element</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.with_basis.indexed_element.IndexedFreeModuleElement</span></code></p>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement">
<code class="sig-name descname">algebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the algebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.algebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">X[{3, 4}, {5, 6}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">X[{4}, {1, 2}, {3}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement">
<code class="sig-name descname">coalgebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the coalgebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.coalgebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">X[{5, 6}, {1, 2}, {3, 4}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">X[{2}, {3, 4}, {1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution">
<code class="sig-name descname">star_involution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.star_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the star involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.star_involution()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">X[{3, 4}, {1, 2}, {5, 6}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">X[{1}, {3, 4}, {2}]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone">
<em class="property">class </em><code class="sig-name descname">Cone</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="sage.combinat.chas.wqsym.WQSymBasis_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.chas.wqsym.WQSymBasis_abstract</span></code></a></p>
<p>The Cone basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\((X_P)_P\)</span> denote the Characteristic basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.
Denote the quasi-shuffle of two ordered set partitions <span class="math notranslate nohighlight">\(A\)</span> and
<span class="math notranslate nohighlight">\(B\)</span> by <span class="math notranslate nohighlight">\(A \Box B\)</span>. For an ordered set partition
<span class="math notranslate nohighlight">\(P = (P_1, \ldots, P_{\ell})\)</span>, we form a list of ordered set
partitions <span class="math notranslate nohighlight">\([P] := (P'_1, \ldots, P'_k)\)</span> as follows.
Define a strictly decreasing sequence of integers
<span class="math notranslate nohighlight">\(\ell + 1 = i_0 &gt; i_1 &gt; \cdots &gt; i_k = 1\)</span> recursively by
requiring that <span class="math notranslate nohighlight">\(\min P_{i_j} \leq \min P_a\)</span> for all <span class="math notranslate nohighlight">\(a &lt; i_{j-1}\)</span>.
Set <span class="math notranslate nohighlight">\(P'_j = (P_{i_j}, \ldots, P_{i_{j-1}-1})\)</span>.</p>
<p>The <em>Cone basis</em> <span class="math notranslate nohighlight">\((C_P)_P\)</span> is defined by</p>
<div class="math notranslate nohighlight">
\[C_P = \sum_Q X_Q,\]</div>
<p>where the sum is over all elements <span class="math notranslate nohighlight">\(Q\)</span> of the quasi-shuffle
product <span class="math notranslate nohighlight">\(P'_1 \Box P'_2 \Box \cdots \Box P'_k\)</span> with
<span class="math notranslate nohighlight">\([P] = (P'_1, \ldots, P'_k)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Cone basis</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">X</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">C</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">X[{1, 2, 3, 4}] + X[{1, 4}, {2, 3}] + X[{2, 3}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">C</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="go">X[{1, 4}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">C</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">X[{1}, {2, 3}, {4}] + X[{1}, {2, 3, 4}] + X[{1}, {4}, {2, 3}]</span>
<span class="go"> + X[{1, 2, 3}, {4}] + X[{2, 3}, {1}, {4}]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">C</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="go">X[{1, 2, 3, 4, 5}] + X[{1, 2, 4, 5}, {3}] + X[{1, 3, 4}, {2, 5}]</span>
<span class="go"> + X[{1, 4}, {2, 3, 5}] + X[{1, 4}, {2, 5}, {3}]</span>
<span class="go"> + X[{1, 4}, {3}, {2, 5}] + X[{2, 3, 5}, {1, 4}]</span>
<span class="go"> + X[{2, 5}, {1, 3, 4}] + X[{2, 5}, {1, 4}, {3}]</span>
<span class="go"> + X[{2, 5}, {3}, {1, 4}] + X[{3}, {1, 2, 4, 5}]</span>
<span class="go"> + X[{3}, {1, 4}, {2, 5}] + X[{3}, {2, 5}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="p">(</span><span class="n">X</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">-C[{1, 2, 3, 4}] - C[{1, 4}, {2, 3}] + C[{2, 3}, {1, 4}]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Section 4 of <a class="reference internal" href="../../../../references/index.html#early2017" id="id13"><span>[Early2017]</span></a></p></li>
</ul>
<div class="admonition-todo admonition" id="id14">
<p class="admonition-title">Todo</p>
<p>Experiments suggest that <code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code>,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code>, and <code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code>
should have reasonable formulas on the C basis; at least
the coefficients of the outputs on any element of the C
basis seem to be always <span class="math notranslate nohighlight">\(0, 1, -1\)</span>.
Is this true? What is the formula?</p>
</div>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone.some_elements">
<code class="sig-name descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Cone.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of the word quasi-symmetric functions
in the Cone basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">C</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[C[], C[{1}], C[{1, 2}], C[] + 1/2*C[{1}]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.M">
<code class="sig-name descname">M</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.M" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.Monomial</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial">
<em class="property">class </em><code class="sig-name descname">Monomial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em>, <em class="sig-param"><span class="n">graded</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="sage.combinat.chas.wqsym.WQSymBasis_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.chas.wqsym.WQSymBasis_abstract</span></code></a></p>
<p>The Monomial basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>The family <span class="math notranslate nohighlight">\((\mathbf{M}_u)\)</span>, as defined in
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions</span></code></a>
with <span class="math notranslate nohighlight">\(u\)</span> ranging over all packed words, is a basis for the
free <span class="math notranslate nohighlight">\(R\)</span>-module <span class="math notranslate nohighlight">\(WQSym\)</span> and called the <em>Monomial basis</em>.
Here it is labelled using ordered set partitions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Monomial basis</span>
</pre></div>
</div>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial.coproduct_on_basis">
<code class="sig-name descname">coproduct_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial.coproduct_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coproduct of <code class="docutils literal notranslate"><span class="pre">self</span></code> on the basis element
indexed by the ordered set partition <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>  <span class="c1"># indirect doctest</span>
<span class="go">M[] # M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">M</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">M[] # M[{1}] + M[{1}] # M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">M</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">M[] # M[{1, 2}] + M[{1, 2}] # M[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">M</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">M[] # M[{1}, {2}] + M[{1}] # M[{1}] + M[{1}, {2}] # M[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial.product_on_basis">
<code class="sig-name descname">product_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Monomial.product_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (associative) <span class="math notranslate nohighlight">\(*\)</span> product of the basis elements
of <code class="docutils literal notranslate"><span class="pre">self</span></code> indexed by the ordered set partitions <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>This is the shifted quasi-shuffle product of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">M[{1}, {2, 3}, {4, 5}] + M[{1}, {2, 3, 4, 5}]</span>
<span class="go"> + M[{1}, {4, 5}, {2, 3}] + M[{1, 4, 5}, {2, 3}]</span>
<span class="go"> + M[{4, 5}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">M[{1}, {2, 3}, {4, 5}, {6}] + M[{1}, {2, 3, 4, 5}, {6}]</span>
<span class="go"> + M[{1}, {4, 5}, {2, 3}, {6}] + M[{1}, {4, 5}, {2, 3, 6}]</span>
<span class="go"> + M[{1}, {4, 5}, {6}, {2, 3}] + M[{1, 4, 5}, {2, 3}, {6}]</span>
<span class="go"> + M[{1, 4, 5}, {2, 3, 6}] + M[{1, 4, 5}, {6}, {2, 3}]</span>
<span class="go"> + M[{4, 5}, {1}, {2, 3}, {6}] + M[{4, 5}, {1}, {2, 3, 6}]</span>
<span class="go"> + M[{4, 5}, {1}, {6}, {2, 3}] + M[{4, 5}, {1, 6}, {2, 3}]</span>
<span class="go"> + M[{4, 5}, {6}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">M[{1, 2}, {3, 4}] + M[{1, 2, 3, 4}] + M[{3, 4}, {1, 2}]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Phi">
<code class="sig-name descname">Phi</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Phi" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyFiner</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Q">
<code class="sig-name descname">Q</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.StronglyCoarser</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser">
<em class="property">class </em><code class="sig-name descname">StronglyCoarser</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="sage.combinat.chas.wqsym.WQSymBasis_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.chas.wqsym.WQSymBasis_abstract</span></code></a></p>
<p>The Q basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>We define a partial order <span class="math notranslate nohighlight">\(\leq\)</span> on the set of all ordered
set partitions as follows: <span class="math notranslate nohighlight">\(A \leq B\)</span> if and only if
<span class="math notranslate nohighlight">\(A\)</span> is strongly finer than <span class="math notranslate nohighlight">\(B\)</span> (see
<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer" title="sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_finer()</span></code></a>
for a definition of this).</p>
<p>The <em>Q basis</em> <span class="math notranslate nohighlight">\((Q_P)_P\)</span> is a basis of <span class="math notranslate nohighlight">\(WQSym\)</span> indexed by ordered
set partitions, and is defined by</p>
<div class="math notranslate nohighlight">
\[Q_P = \sum \mathbf{M}_W,\]</div>
<p>where the sum is over ordered set partitions <span class="math notranslate nohighlight">\(W\)</span> satisfying
<span class="math notranslate nohighlight">\(P \leq W\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">();</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Q basis</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">Q[{2, 3}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">Q[{1, 2}, {3, 4}] - Q[{1, 2, 3, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{1, 2}, {3, 4}] + M[{1, 2, 3, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Q</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{2, 3}, {1}, {4}] + M[{2, 3}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Q</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{3}, {2, 5}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
<span class="go">M[{1, 4}, {2, 3}, {5}, {6}] + M[{1, 4}, {2, 3}, {5, 6}]</span>
<span class="go"> + M[{1, 4}, {2, 3, 5}, {6}] + M[{1, 4}, {2, 3, 5, 6}]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">Q[{1, 3}, {2}, {4}, {5}] + Q[{1, 3}, {4}, {2}, {5}]</span>
<span class="go"> + Q[{1, 3}, {4}, {5}, {2}] + Q[{4}, {1, 3}, {2}, {5}]</span>
<span class="go"> + Q[{4}, {1, 3}, {5}, {2}] + Q[{4}, {5}, {1, 3}, {2}]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">Q[] # Q[{1, 3}, {2}] + Q[{1, 2}] # Q[{1}] + Q[{1, 3}, {2}] # Q[]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Section 6 of <a class="reference internal" href="../../../../references/index.html#berzab05" id="id15"><span>[BerZab05]</span></a></p></li>
</ul>
<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element">
<em class="property">class </em><code class="sig-name descname">Element</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.with_basis.indexed_element.IndexedFreeModuleElement</span></code></p>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement">
<code class="sig-name descname">algebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the algebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.algebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">Q[{3, 4}, {1, 2, 5, 6}] + Q[{3, 4}, {5, 6}, {1, 2}]</span>
<span class="go"> - Q[{3, 4, 5, 6}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">Q[{1, 2, 4}, {3}] + Q[{4}, {1, 2}, {3}] - Q[{4}, {1, 2, 3}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement">
<code class="sig-name descname">coalgebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the coalgebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.coalgebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">Q[{1, 2, 5, 6}, {3, 4}] + Q[{5, 6}, {1, 2}, {3, 4}] - Q[{5, 6}, {1, 2, 3, 4}]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">Q[{2}, {1, 3, 4}] + Q[{2}, {3, 4}, {1}] - Q[{2, 3, 4}, {1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution">
<code class="sig-name descname">star_involution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.star_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the star involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.star_involution()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Q[{3, 4}, {1, 2}, {5, 6}]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Q[{1}, {3, 4}, {2}]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.coproduct_on_basis">
<code class="sig-name descname">coproduct_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.coproduct_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coproduct of <code class="docutils literal notranslate"><span class="pre">self</span></code> on the basis element
indexed by the ordered set partition <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>  <span class="c1"># indirect doctest</span>
<span class="go">Q[] # Q[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Q</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">Q[] # Q[{1}] + Q[{1}] # Q[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Q</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">Q[] # Q[{1, 2}] + Q[{1, 2}] # Q[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Q</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">Q[] # Q[{1}, {2}] + Q[{1}] # Q[{1}] + Q[{1}, {2}] # Q[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">Q[] # Q[{1, 2}, {3}, {4}] + Q[{1, 2}] # Q[{1}, {2}]</span>
<span class="go"> + Q[{1, 2}, {3}] # Q[{1}] + Q[{1, 2}, {3}, {4}] # Q[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.product_on_basis">
<code class="sig-name descname">product_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.product_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (associative) <span class="math notranslate nohighlight">\(*\)</span> product of the basis elements
of the Q basis <code class="docutils literal notranslate"><span class="pre">self</span></code> indexed by the ordered set partitions
<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>This is the shifted shuffle product of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Q[{1}, {2, 3}, {4, 5}] + Q[{1}, {4, 5}, {2, 3}]</span>
<span class="go"> + Q[{4, 5}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">Q[{1}, {2, 3}, {4, 5}, {6}] + Q[{1}, {4, 5}, {2, 3}, {6}]</span>
<span class="go"> + Q[{1}, {4, 5}, {6}, {2, 3}] + Q[{4, 5}, {1}, {2, 3}, {6}]</span>
<span class="go"> + Q[{4, 5}, {1}, {6}, {2, 3}] + Q[{4, 5}, {6}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Q[{1, 2}, {3, 4}] + Q[{3, 4}, {1, 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.some_elements">
<code class="sig-name descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyCoarser.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of the word quasi-symmetric functions
in the Q basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[Q[], Q[{1}], Q[{1, 2}], Q[] + 1/2*Q[{1}]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner">
<em class="property">class </em><code class="sig-name descname">StronglyFiner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alg</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBasis_abstract" title="sage.combinat.chas.wqsym.WQSymBasis_abstract"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.chas.wqsym.WQSymBasis_abstract</span></code></a></p>
<p>The Phi basis of <span class="math notranslate nohighlight">\(WQSym\)</span>.</p>
<p>We define a partial order <span class="math notranslate nohighlight">\(\leq\)</span> on the set of all ordered
set partitions as follows: <span class="math notranslate nohighlight">\(A \leq B\)</span> if and only if
<span class="math notranslate nohighlight">\(A\)</span> is strongly finer than <span class="math notranslate nohighlight">\(B\)</span> (see
<a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer" title="sage.combinat.set_partition_ordered.OrderedSetPartition.is_strongly_finer"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_finer()</span></code></a>
for a definition of this).</p>
<p>The <em>Phi basis</em> <span class="math notranslate nohighlight">\((\Phi_P)_P\)</span> is a basis of <span class="math notranslate nohighlight">\(WQSym\)</span> indexed by ordered
set partitions, and is defined by</p>
<div class="math notranslate nohighlight">
\[\Phi_P = \sum \mathbf{M}_W,\]</div>
<p>where the sum is over ordered set partitions <span class="math notranslate nohighlight">\(W\)</span> satisfying
<span class="math notranslate nohighlight">\(W \leq P\)</span>.</p>
<p>Novelli and Thibon introduced this basis in <a class="reference internal" href="../../../../references/index.html#novthi06" id="id16"><span>[NovThi06]</span></a>
Section 2.7.2, and called it the quasi-ribbon basis.
It later reappeared in <a class="reference internal" href="../../../../references/index.html#menoth11" id="id17"><span>[MeNoTh11]</span></a> Section 4.3.2.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">M</span><span class="p">();</span> <span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Phi basis</span>

<span class="gp">sage: </span><span class="n">Phi</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">Phi[{2}, {3}, {1}, {4}] - Phi[{2}, {3}, {1, 4}]</span>
<span class="go"> - Phi[{2, 3}, {1}, {4}] + Phi[{2, 3}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">(</span><span class="n">M</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">Phi[{1}, {2}, {3}, {4}] - Phi[{1}, {2}, {3, 4}]</span>
<span class="go"> - Phi[{1, 2}, {3}, {4}] + Phi[{1, 2}, {3, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{1}, {2}, {3}, {4}] + M[{1}, {2}, {3, 4}]</span>
<span class="go"> + M[{1, 2}, {3}, {4}] + M[{1, 2}, {3, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Phi</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{2}, {3}, {1}, {4}] + M[{2, 3}, {1}, {4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Phi</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="go">M[{3}, {2}, {5}, {1}, {4}] + M[{3}, {2}, {5}, {1, 4}]</span>
<span class="go"> + M[{3}, {2, 5}, {1}, {4}] + M[{3}, {2, 5}, {1, 4}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">(</span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">]])</span>
<span class="go">M[{1}, {4}, {2}, {3}, {5}, {6}] + M[{1}, {4}, {2, 3}, {5}, {6}]</span>
<span class="go"> + M[{1, 4}, {2}, {3}, {5}, {6}] + M[{1, 4}, {2, 3}, {5}, {6}]</span>

<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">],]</span> <span class="o">*</span> <span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
<span class="go">Phi[{1, 2, 4}, {3}] + Phi[{2}, {1, 4}, {3}]</span>
<span class="go"> + Phi[{2, 4}, {1, 3}] + Phi[{2, 4}, {3}, {1}]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">Phi[] # Phi[{3, 5}, {1, 4}, {2}]</span>
<span class="go"> + Phi[{1}] # Phi[{4}, {1, 3}, {2}]</span>
<span class="go"> + Phi[{1, 2}] # Phi[{1, 3}, {2}]</span>
<span class="go"> + Phi[{2, 3}, {1}] # Phi[{2}, {1}]</span>
<span class="go"> + Phi[{2, 4}, {1, 3}] # Phi[{1}]</span>
<span class="go"> + Phi[{3, 5}, {1, 4}, {2}] # Phi[]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Section 2.7.2 of <a class="reference internal" href="../../../../references/index.html#novthi06" id="id18"><span>[NovThi06]</span></a></p></li>
</ul>
<dl class="py class">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element">
<em class="property">class </em><code class="sig-name descname">Element</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.with_basis.indexed_element.IndexedFreeModuleElement</span></code></p>
<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement">
<code class="sig-name descname">algebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the algebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.algebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{3}, {2}, {4}, {1}] + Phi[{3}, {2, 4}, {1}] + Phi[{3}, {4}, {2}, {1}]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">algebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{4}, {2}, {3}, {1}] + Phi[{4}, {2, 3}, {1}] + Phi[{4}, {3}, {2}, {1}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement">
<code class="sig-name descname">coalgebraic_complement</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the coalgebraic complement involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.coalgebraic_complement()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">star_involution()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{4}, {3}, {1}, {2}] + Phi[{4}, {3}, {1, 2}] + Phi[{4}, {3}, {2}, {1}]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">]]</span><span class="o">.</span><span class="n">coalgebraic_complement</span><span class="p">()</span>
<span class="go">-Phi[{3}, {1}, {4}, {2}] + Phi[{3}, {1, 4}, {2}] + Phi[{3}, {4}, {1}, {2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution">
<code class="sig-name descname">star_involution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.star_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the element <code class="docutils literal notranslate"><span class="pre">self</span></code> of <span class="math notranslate nohighlight">\(WQSym\)</span>
under the star involution.</p>
<p>See
<a class="reference internal" href="#sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution" title="sage.combinat.chas.wqsym.WQSymBases.ElementMethods.star_involution"><code class="xref py py-meth docutils literal notranslate"><span class="pre">WQSymBases.ElementMethods.star_involution()</span></code></a>
for a definition of the involution and for examples.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.algebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">algebraic_complement()</span></code></a>, <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.Element.coalgebraic_complement"><code class="xref py py-meth docutils literal notranslate"><span class="pre">coalgebraic_complement()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">WQSym</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Phi[{3, 4}, {1, 2}, {5, 6}]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">star_involution</span><span class="p">()</span>
<span class="go">Phi[{1}, {3, 4}, {2}]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.coproduct_on_basis">
<code class="sig-name descname">coproduct_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.coproduct_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coproduct of <code class="docutils literal notranslate"><span class="pre">self</span></code> on the basis element
indexed by the ordered set partition <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>The coproduct of the basis element <span class="math notranslate nohighlight">\(\Phi_x\)</span> indexed by
an ordered set partition <span class="math notranslate nohighlight">\(x\)</span> of <span class="math notranslate nohighlight">\([n]\)</span> can be computed by the
following formula (<a class="reference internal" href="../../../../references/index.html#novthi06" id="id19"><span>[NovThi06]</span></a>):</p>
<div class="math notranslate nohighlight">
\[\Delta \Phi_x
= \sum \Phi_y \otimes \Phi_z ,\]</div>
<p>where the sum ranges over all pairs <span class="math notranslate nohighlight">\((y, z)\)</span> of ordered set
partitions <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> such that:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> are ordered set partitions of two complementary
subsets of <span class="math notranslate nohighlight">\([n]\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(x\)</span> is obtained either by concatenating <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, or by
first concatenating <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(z\)</span> and then merging the two
“middle blocks” (i.e., the last block of <span class="math notranslate nohighlight">\(y\)</span> and the first
block of <span class="math notranslate nohighlight">\(z\)</span>); in the latter case, the maximum of the last
block of <span class="math notranslate nohighlight">\(y\)</span> has to be smaller than the minimum of the first
block of <span class="math notranslate nohighlight">\(z\)</span> (so that when merging these blocks, their
entries don’t need to be sorted).</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>

<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span><span class="n">Phi</span><span class="o">.</span><span class="n">one</span><span class="p">())</span>  <span class="c1"># indirect doctest</span>
<span class="go">Phi[] # Phi[]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Phi</span><span class="p">([[</span><span class="mi">1</span><span class="p">]])</span> <span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">Phi[] # Phi[{1}] + Phi[{1}] # Phi[]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Phi</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">Phi[] # Phi[{1, 2}] + Phi[{1}] # Phi[{1}] + Phi[{1, 2}] # Phi[]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">coproduct</span><span class="p">(</span> <span class="n">Phi</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span> <span class="p">)</span>
<span class="go">Phi[] # Phi[{1}, {2}] + Phi[{1}] # Phi[{1}] + Phi[{1}, {2}] # Phi[]</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">]]</span><span class="o">.</span><span class="n">coproduct</span><span class="p">()</span>
<span class="go">Phi[] # Phi[{1, 2}, {3}, {4}] + Phi[{1}] # Phi[{1}, {2}, {3}]</span>
<span class="go"> + Phi[{1, 2}] # Phi[{1}, {2}] + Phi[{1, 2}, {3}] # Phi[{1}]</span>
<span class="go"> + Phi[{1, 2}, {3}, {4}] # Phi[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.product_on_basis">
<code class="sig-name descname">product_on_basis</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">y</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.product_on_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (associative) <span class="math notranslate nohighlight">\(*\)</span> product of the basis elements
of the Phi basis <code class="docutils literal notranslate"><span class="pre">self</span></code> indexed by the ordered set partitions
<span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>This is obtained by the following algorithm (going back to
<a class="reference internal" href="../../../../references/index.html#novthi06" id="id20"><span>[NovThi06]</span></a>):</p>
<p>Let <span class="math notranslate nohighlight">\(x\)</span> be an ordered set partition of <span class="math notranslate nohighlight">\([m]\)</span>, and <span class="math notranslate nohighlight">\(y\)</span> an
ordered set partition of <span class="math notranslate nohighlight">\([n]\)</span>.
Transform <span class="math notranslate nohighlight">\(x\)</span> into a list <span class="math notranslate nohighlight">\(u\)</span> of all the <span class="math notranslate nohighlight">\(m\)</span> elements of <span class="math notranslate nohighlight">\([m]\)</span>
by writing out each block of <span class="math notranslate nohighlight">\(x\)</span> (in increasing order) and
putting bars between each two consecutive blocks; this is
called a barred permutation.
Do the same for <span class="math notranslate nohighlight">\(y\)</span>, but also shift each entry of the
resulting barred permutation by <span class="math notranslate nohighlight">\(m\)</span>. Let <span class="math notranslate nohighlight">\(v\)</span> be the barred
permutation of <span class="math notranslate nohighlight">\([m+n] \setminus [m]\)</span> thus obtained.
Now, shuffle the two barred permutations <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>
(ignoring the bars) in all the <span class="math notranslate nohighlight">\(\binom{n+m}{n}\)</span> possible ways.
For each shuffle obtained, place bars between some entries
of the shuffle, according to the following rule:</p>
<ul class="simple">
<li><p>If two consecutive entries of the shuffle both come from
<span class="math notranslate nohighlight">\(u\)</span>, then place a bar between them if the corresponding
entries of <span class="math notranslate nohighlight">\(u\)</span> had a bar between them.</p></li>
<li><p>If the first of two consecutive entries of the shuffle
comes from <span class="math notranslate nohighlight">\(v\)</span> and the second from <span class="math notranslate nohighlight">\(u\)</span>, then place a bar
between them.</p></li>
</ul>
<p>This results in a barred permutation of <span class="math notranslate nohighlight">\([m+n]\)</span>.
Transform it into an ordered set partition of <span class="math notranslate nohighlight">\([m+n]\)</span>,
by treating the bars as dividers separating consecutive
blocks.</p>
<p>The product <span class="math notranslate nohighlight">\(\Phi_x \Phi_y\)</span> is the sum of <span class="math notranslate nohighlight">\(\Phi_p\)</span> with
<span class="math notranslate nohighlight">\(p\)</span> ranging over all ordered set partitions obtained this
way.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">OrderedSetPartition</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Phi[{1}, {2, 3, 4, 5}] + Phi[{1}, {2, 4}, {3, 5}]</span>
<span class="go"> + Phi[{1}, {2, 4, 5}, {3}] + Phi[{1, 4}, {2, 3, 5}]</span>
<span class="go"> + Phi[{1, 4}, {2, 5}, {3}] + Phi[{1, 4, 5}, {2, 3}]</span>
<span class="go"> + Phi[{4}, {1}, {2, 3, 5}] + Phi[{4}, {1}, {2, 5}, {3}]</span>
<span class="go"> + Phi[{4}, {1, 5}, {2, 3}] + Phi[{4, 5}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="go">Phi[{1}, {2, 3, 4, 5}, {6}] + Phi[{1}, {2, 4}, {3, 5}, {6}]</span>
<span class="go"> + Phi[{1}, {2, 4, 5}, {3, 6}] + Phi[{1}, {2, 4, 5}, {6}, {3}]</span>
<span class="go"> + Phi[{1, 4}, {2, 3, 5}, {6}] + Phi[{1, 4}, {2, 5}, {3, 6}]</span>
<span class="go"> + Phi[{1, 4}, {2, 5}, {6}, {3}] + Phi[{1, 4, 5}, {2, 3, 6}]</span>
<span class="go"> + Phi[{1, 4, 5}, {2, 6}, {3}] + Phi[{1, 4, 5}, {6}, {2, 3}]</span>
<span class="go"> + Phi[{4}, {1}, {2, 3, 5}, {6}]</span>
<span class="go"> + Phi[{4}, {1}, {2, 5}, {3, 6}]</span>
<span class="go"> + Phi[{4}, {1}, {2, 5}, {6}, {3}]</span>
<span class="go"> + Phi[{4}, {1, 5}, {2, 3, 6}] + Phi[{4}, {1, 5}, {2, 6}, {3}]</span>
<span class="go"> + Phi[{4}, {1, 5}, {6}, {2, 3}] + Phi[{4, 5}, {1}, {2, 3, 6}]</span>
<span class="go"> + Phi[{4, 5}, {1}, {2, 6}, {3}] + Phi[{4, 5}, {1, 6}, {2, 3}]</span>
<span class="go"> + Phi[{4, 5}, {6}, {1}, {2, 3}]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">product_on_basis</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">Phi[{1, 2, 3, 4}] + Phi[{1, 3}, {2, 4}] + Phi[{1, 3, 4}, {2}]</span>
<span class="go"> + Phi[{3}, {1, 2, 4}] + Phi[{3}, {1, 4}, {2}]</span>
<span class="go"> + Phi[{3, 4}, {1, 2}]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.some_elements">
<code class="sig-name descname">some_elements</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.StronglyFiner.some_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Return some elements of the word quasi-symmetric functions
in the Phi basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">Phi</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">some_elements</span><span class="p">()</span>
<span class="go">[Phi[], Phi[{1}], Phi[{1, 2}], Phi[] + 1/2*Phi[{1}]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.X">
<code class="sig-name descname">X</code><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.X" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.Characteristic"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.Characteristic</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.a_realization">
<code class="sig-name descname">a_realization</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.a_realization" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a particular realization of <code class="docutils literal notranslate"><span class="pre">self</span></code> (the <span class="math notranslate nohighlight">\(M\)</span>-basis).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQSym</span> <span class="o">=</span> <span class="n">algebras</span><span class="o">.</span><span class="n">WQSym</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">WQSym</span><span class="o">.</span><span class="n">a_realization</span><span class="p">()</span>
<span class="go">Word Quasi-symmetric functions over Rational Field in the Monomial basis</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options">
<code class="sig-name descname">options</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">get_value</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">set_value</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options" title="Permalink to this definition">¶</a></dt>
<dd><p>Set and display the global options for bases of WordQuasiSymmetricFunctions.
If no parameters are set, then the function returns a copy of the options
dictionary.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> can be accessed as the method
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions.options"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions.options</span></code></a> of
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions</span></code></a> or of any associated basis.</p>
<p>OPTIONS:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">display</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">normal</span></code>)
Specifies how basis elements of WordQuasiSymmetricFunctions should be printed</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compact</span></code> – Using a severely compacted representation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normal</span></code>  – Using the normal representation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tight</span></code>   – Dropping spaces after commas</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">objects</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">compositions</span></code>)
Specifies how basis elements of WordQuasiSymmetricFunctions should be indexed</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">compositions</span></code> – Indexing the basis by ordered set partitions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">words</span></code>        – Indexing the basis by packed words</p></li>
</ul>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">'words'</span></code> representation of a basis element of
<a class="reference internal" href="#sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions" title="sage.combinat.chas.wqsym.WordQuasiSymmetricFunctions"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordQuasiSymmetricFunctions</span></code></a>, indexed by an ordered
set partition <span class="math notranslate nohighlight">\(A\)</span>, is the packed word associated to <span class="math notranslate nohighlight">\(A\)</span>.
See <a class="reference internal" href="../set_partition_ordered.html#sage.combinat.set_partition_ordered.OrderedSetPartition.to_packed_word" title="sage.combinat.set_partition_ordered.OrderedSetPartition.to_packed_word"><code class="xref py py-meth docutils literal notranslate"><span class="pre">OrderedSetPartition.to_packed_word()</span></code></a> for details.)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WQ</span> <span class="o">=</span> <span class="n">WordQuasiSymmetricFunctions</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">WQ</span><span class="o">.</span><span class="n">M</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">elt</span> <span class="o">=</span> <span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]]</span><span class="o">*</span><span class="n">M</span><span class="p">[[[</span><span class="mi">1</span><span class="p">]]];</span> <span class="n">elt</span>
<span class="go">M[{1, 2}, {3}] + M[{1, 2, 3}] + M[{3}, {1, 2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[{1,2},{3}] + M[{1,2,3}] + M[{3},{1,2}]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;compact&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[12.3] + M[123] + M[3.12]</span>
<span class="gp">sage: </span><span class="n">WQ</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">objects</span> <span class="o">=</span> <span class="s2">&quot;words&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[1, 1, 2] + M[1, 1, 1] + M[2, 2, 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[1,1,2] + M[1,1,1] + M[2,2,1]</span>
<span class="gp">sage: </span><span class="n">WQ</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span> <span class="o">=</span> <span class="s2">&quot;compact&quot;</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[112] + M[111] + M[221]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">elt</span>
<span class="go">M[{1, 2}, {3}] + M[{1, 2, 3}] + M[{3}, {1, 2}]</span>
</pre></div>
</div>
<p>See <a class="reference external" href="../../../../structure/sage/structure/global_options.html#sage.structure.global_options.GlobalOptions" title="(in Sage 9.2 Reference Manual: Parents and Elements v9.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">GlobalOptions</span></code></a> for more features of these options.</p>
</dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="fsym.html"
                        title="previous chapter">Poirier-Reutenauer Hopf algebra of standard tableaux</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../cluster_algebra_quiver/__init__.html"
                        title="next chapter">Cluster Algebras and Quivers</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/chas/wqsym.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../cluster_algebra_quiver/__init__.html" title="Cluster Algebras and Quivers"
             >next</a> |</li>
        <li class="right" >
          <a href="fsym.html" title="Poirier-Reutenauer Hopf algebra of standard tableaux"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.2 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Word Quasi-symmetric functions</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>