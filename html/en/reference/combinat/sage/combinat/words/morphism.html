
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Word morphisms/substitutions &#8212; Sage Reference Manual v9.0: Combinatorics</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Word paths" href="paths.html" />
    <link rel="prev" title="Lyndon words" href="lyndon_word.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="paths.html" title="Word paths"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="lyndon_word.html" title="Lyndon words"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="word-morphisms-substitutions">
<span id="sage-combinat-words-morphism"></span><h1>Word morphisms/substitutions<a class="headerlink" href="#word-morphisms-substitutions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.words.morphism"></span><p>This modules implements morphisms over finite and infinite words.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Sebastien Labbe (2007-06-01): initial version</li>
<li>Sebastien Labbe (2008-07-01): merged into sage-words</li>
<li>Sebastien Labbe (2008-12-17): merged into sage</li>
<li>Sebastien Labbe (2009-02-03): words next generation</li>
<li>Sebastien Labbe (2009-11-20): allowing the choice of the
datatype of the image. Doc improvements.</li>
<li>Stepan Starosta (2012-11-09): growing letters</li>
</ul>
<p>EXAMPLES:</p>
<p>Creation of a morphism from a dictionary or a string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;x-&gt;xyxsxss,s-&gt;xyss,y-&gt;ys&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span>
<span class="go">WordMorphism: 0-&gt;0221, 1-&gt;02, 2-&gt;221</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">WordMorphism: s-&gt;xyss, x-&gt;xyxsxss, y-&gt;ys</span>
</pre></div>
</div>
<p>The codomain may be specified:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]},</span> <span class="n">codomain</span><span class="o">=</span><span class="n">Words</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="go">WordMorphism: 0-&gt;0221, 1-&gt;02, 2-&gt;221</span>
</pre></div>
</div>
<p>Power of a morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">^</span><span class="mi">2</span>
<span class="go">WordMorphism: 0-&gt;022122122102, 1-&gt;0221221, 2-&gt;22122102</span>
</pre></div>
</div>
<p>Image under a morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="go">word: ys</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="s1">&#39;xxxsy&#39;</span><span class="p">)</span>
<span class="go">word: xyxsxssxyxsxssxyxsxssxyssys</span>
</pre></div>
</div>
<p>Iterated image under a morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">word: ysxyssxyxsxssysxyssxyss</span>
</pre></div>
</div>
<p>See more examples in the documentation of the call method
(<code class="docutils literal notranslate"><span class="pre">m.__call__?</span></code>).</p>
<p>Infinite fixed point of morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fix</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fix</span>
<span class="go">word: xyxsxssysxyxsxssxyssxyxsxssxyssxyssysxys...</span>
<span class="gp">sage: </span><span class="n">fix</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>Incidence matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">[2 3 1]</span>
<span class="go">[1 3 0]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
<p>Many other functionalities…:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.combinat.words.morphism.PeriodicPointIterator">
<em class="property">class </em><code class="descclassname">sage.combinat.words.morphism.</code><code class="descname">PeriodicPointIterator</code><span class="sig-paren">(</span><em>m</em>, <em>cycle</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.PeriodicPointIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>(Lazy) constructor of the periodic points of a word morphism.</p>
<p>This class is mainly used in <a class="reference internal" href="#sage.combinat.words.morphism.WordMorphism.periodic_point" title="sage.combinat.words.morphism.WordMorphism.periodic_point"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordMorphism.periodic_point</span></code></a> and
<a class="reference internal" href="#sage.combinat.words.morphism.WordMorphism.periodic_points" title="sage.combinat.words.morphism.WordMorphism.periodic_points"><code class="xref py py-class docutils literal notranslate"><span class="pre">WordMorphism.periodic_points</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.words.morphism</span> <span class="kn">import</span> <span class="n">PeriodicPointIterator</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bacca,b-&gt;cba,c-&gt;aab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">PeriodicPointIterator</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">lazy list [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;, ...]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">lazy list [&#39;b&#39;, &#39;a&#39;, &#39;c&#39;, ...]</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">_cache</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">lazy list [&#39;c&#39;, &#39;b&#39;, &#39;a&#39;, ...]</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.combinat.words.morphism.PeriodicPointIterator.get_iterator">
<code class="descname">get_iterator</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.PeriodicPointIterator.get_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal method.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.words.morphism</span> <span class="kn">import</span> <span class="n">PeriodicPointIterator</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bacca,b-&gt;cba,c-&gt;aab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">PeriodicPointIterator</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">get_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">&lt;generator object ...get_iterator at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.combinat.words.morphism.WordMorphism">
<em class="property">class </em><code class="descclassname">sage.combinat.words.morphism.</code><code class="descname">WordMorphism</code><span class="sig-paren">(</span><em>data</em>, <em>domain=None</em>, <em>codomain=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>WordMorphism class</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">data</span></code> – dict or str or an instance of WordMorphism, the map
giving the image of letters</li>
<li><code class="docutils literal notranslate"><span class="pre">domain</span></code> – (optional:<code class="docutils literal notranslate"><span class="pre">None</span></code>) set of words over a given
alphabet. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the domain alphabet is computed from <code class="docutils literal notranslate"><span class="pre">data</span></code>
and is <em>sorted</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – (optional:<code class="docutils literal notranslate"><span class="pre">None</span></code>) set of words over a given
alphabet. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, the codomain alphabet is computed from
<code class="docutils literal notranslate"><span class="pre">data</span></code> and is <em>sorted</em>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the domain or the codomain are not explicitly given, it is
expected that the letters are comparable because the alphabets of
the domain and of the codomain are sorted.</p>
</div>
<p>EXAMPLES:</p>
<p>From a dictionary:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">n</span>
<span class="go">WordMorphism: 0-&gt;0221, 1-&gt;02, 2-&gt;221</span>
</pre></div>
</div>
<p>From a string with <code class="docutils literal notranslate"><span class="pre">'-&gt;'</span></code> as separation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;x-&gt;xyxsxss,s-&gt;xyss,y-&gt;ys&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span>
<span class="go">WordMorphism: s-&gt;xyss, x-&gt;xyxsxss, y-&gt;ys</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;s&#39;, &#39;x&#39;, &#39;y&#39;}</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;s&#39;, &#39;x&#39;, &#39;y&#39;}</span>
</pre></div>
</div>
<p>Specifying the domain and codomain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">FiniteWords</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">0</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {0, 1, 2}</span>
</pre></div>
</div>
<p>When the alphabet is non-sortable, the domain and/or codomain must be
explicitly given:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">FiniteWords</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">W</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
<span class="go">WordMorphism: 6-&gt;666a, a-&gt;a6a</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.abelian_rotation_subspace">
<code class="descname">abelian_rotation_subspace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.abelian_rotation_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the subspace on which the incidence matrix of <code class="docutils literal notranslate"><span class="pre">self</span></code> acts by
roots of unity.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;1,1-&gt;0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 0 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;122,2-&gt;211&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1 -1]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;1,1-&gt;102,2-&gt;3,3-&gt;4,4-&gt;2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 5 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[0 0 0 0 1]</span>
</pre></div>
</div>
<p>The domain needs to be equal to the codomain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;1,1-&gt;&#39;</span><span class="p">,</span><span class="n">codomain</span><span class="o">=</span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">abelian_rotation_subspace</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 0 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.codomain">
<code class="descname">codomain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.codomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the codomain of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;a&#39;, &#39;b&#39;}</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;5&#39;, &#39;a&#39;, &#39;b&#39;, &#39;d&#39;, &#39;s&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.conjugate">
<code class="descname">conjugate</code><span class="sig-paren">(</span><em>pos</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the morphism where the image of the letter by <code class="docutils literal notranslate"><span class="pre">self</span></code>
is conjugated of parameter <code class="docutils literal notranslate"><span class="pre">pos</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">pos</span></code> - integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abcde&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">m</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;bcdea</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;deabc</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">WordMorphism:</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abcde,b-&gt;xyz&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;cdeab, b-&gt;zxy</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.domain">
<code class="descname">domain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns domain of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;a&#39;, &#39;b&#39;}</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;b-&gt;ba,a-&gt;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;a&#39;, &#39;b&#39;}</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Finite words over {&#39;0&#39;, &#39;6&#39;, &#39;y&#39;}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.dual_map">
<code class="descname">dual_map</code><span class="sig-paren">(</span><em>k=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.dual_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the dual map <span class="math notranslate nohighlight">\(E_k^*\)</span> of self (see [1]).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is actually implemented only for <span class="math notranslate nohighlight">\(k=1\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - unimodular endomorphism defined on integers
<code class="docutils literal notranslate"><span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">\ldots,</span> <span class="pre">d</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> - integer (optional, default: 1)</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>an instance of E1Star - the dual map</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">dual_map</span><span class="p">()</span>
<span class="go">E_1^*(1-&gt;2, 2-&gt;3, 3-&gt;12)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sigma</span><span class="o">.</span><span class="n">dual_map</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: The dual map E_k^* is implemented only for k = 1 (not 2)</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] Sano, Y., Arnoux, P. and Ito, S., Higher dimensional
extensions of substitutions and their dual maps, Journal
d’Analyse Mathematique 83 (2001), 183-206.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.extend_by">
<code class="descname">extend_by</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.extend_by" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">self</span></code> extended by <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(\varphi_1:A^*\rightarrow B^*\)</span> and <span class="math notranslate nohighlight">\(\varphi_2:C^*\rightarrow D^*\)</span>
be two morphisms. A morphism <span class="math notranslate nohighlight">\(\mu:(A\cup C)^*\rightarrow (B\cup D)^*\)</span>
corresponds to <span class="math notranslate nohighlight">\(\varphi_1\)</span> <em>extended by</em> <span class="math notranslate nohighlight">\(\varphi_2\)</span> if
<span class="math notranslate nohighlight">\(\mu(a)=\varphi_1(a)\)</span> if <span class="math notranslate nohighlight">\(a\in A\)</span> and <span class="math notranslate nohighlight">\(\mu(a)=\varphi_2(a)\)</span> otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">other</span></code> - a WordMorphism.</li>
</ul>
<p>OUTPUT:</p>
<p>WordMorphism</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s1">&#39;0&#39;</span><span class="p">:</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;5&#39;</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">extend_by</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">WordMorphism: 0-&gt;1, 1-&gt;0, a-&gt;ab, b-&gt;ba</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">extend_by</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">WordMorphism: 0-&gt;1, 1-&gt;0, a-&gt;5, b-&gt;ba</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">extend_by</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;ab, b-&gt;ba</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.fixed_point">
<code class="descname">fixed_point</code><span class="sig-paren">(</span><em>letter</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.fixed_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fixed point of <code class="docutils literal notranslate"><span class="pre">self</span></code> beginning by the given <code class="docutils literal notranslate"><span class="pre">letter</span></code>.</p>
<p>A fixed point of morphism <span class="math notranslate nohighlight">\(\varphi\)</span> is a word <span class="math notranslate nohighlight">\(w\)</span> such that
<span class="math notranslate nohighlight">\(\varphi(w) = w\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - an endomorphism, must be prolongable on <code class="docutils literal notranslate"><span class="pre">letter</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">letter</span></code> - in the domain of <code class="docutils literal notranslate"><span class="pre">self</span></code>, the first letter
of the fixed point.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">word</span></code> - the fixed point of <code class="docutils literal notranslate"><span class="pre">self</span></code> beginning with <code class="docutils literal notranslate"><span class="pre">letter</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">FiniteWords</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic">
<li><p class="first">Infinite fixed point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abbabaabbaababbabaababbaabbabaabbaababba...</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abaababaabaababaababaabaababaabaababaaba...</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;b,c-&gt;ba&#39;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb...</span>
</pre></div>
</div>
</li>
<li><p class="first">Infinite fixed point of an erasing morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;,c-&gt;ba&#39;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: ab</span>
</pre></div>
</div>
</li>
<li><p class="first">Finite fixed point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;b,c-&gt;ba&#39;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">word: b</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;}</span>

<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;cc,c-&gt;&#39;</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">W</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abcc</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Finite words over {&#39;a&#39;, &#39;b&#39;, &#39;c&#39;}</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abc,b-&gt;,c-&gt;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fp</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">fp</span>
<span class="go">word: abc</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">(</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="go">word: ba</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1">#todo: not implemented</span>
<span class="go">word: ba</span>
</pre></div>
</div>
</li>
</ol>
<ol class="arabic" start="5">
<li><p class="first">Fixed point of a power of a morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abbabaabbaababbabaababbaabbabaabbaababba...</span>
</pre></div>
</div>
</li>
</ol>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.fixed_points">
<code class="descname">fixed_points</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.fixed_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of all fixed points of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">():</span> <span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">abbabaabbaababbabaababbaabbabaabbaababba...</span>
<span class="go">baababbaabbabaababbabaabbaababbaabbabaab...</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;c,c-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">():</span> <span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">abcaababcabcaabcaababcaababcabcaababcabc...</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;cab,c-&gt;bcc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">():</span> <span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">abcabbccabcabcabbccbccabcabbccabcabbccab...</span>
</pre></div>
</div>
<p>This shows that ticket <a class="reference external" href="https://trac.sagemath.org/13668">trac ticket #13668</a> has been resolved:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span><span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span><span class="mi">8</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span><span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span><span class="mi">10</span><span class="p">:[</span><span class="mi">1</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s7</span> <span class="o">=</span> <span class="n">s</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">s7</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">[word: 12232342..., word: 2,3,4,5,6,7,8...]</span>
<span class="gp">sage: </span><span class="n">s7r</span> <span class="o">=</span> <span class="n">s7</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s7r</span><span class="o">.</span><span class="n">periodic_point</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">word: 2,1,1,10,9,8,7,6,5,4,3,2,1,10,9,8,7,6,5,4,3,2,10,9,8,7,6,5,4,3,2,9,8,7,6,5,4,3,2,8,...</span>
</pre></div>
</div>
<p>This shows that ticket <a class="reference external" href="https://trac.sagemath.org/13668">trac ticket #13668</a> has been resolved:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;1-&gt;321331332133133,2-&gt;133321331332133133,3-&gt;2133133133321331332133133&quot;</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.growing_letters">
<code class="descname">growing_letters</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.growing_letters" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of growing letters.</p>
<p>See <a class="reference internal" href="#sage.combinat.words.morphism.WordMorphism.is_growing" title="sage.combinat.words.morphism.WordMorphism.is_growing"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_growing()</span></code></a> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">growing_letters</span><span class="p">()</span>
<span class="go">[&#39;0&#39;, &#39;1&#39;]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">growing_letters</span><span class="p">()</span>
<span class="go">[&#39;0&#39;]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;0,2-&gt;1&#39;</span><span class="p">,</span><span class="n">codomain</span><span class="o">=</span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;012&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">growing_letters</span><span class="p">()</span>
<span class="go">[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.has_conjugate_in_classP">
<code class="descname">has_conjugate_in_classP</code><span class="sig-paren">(</span><em>f=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.has_conjugate_in_classP" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> has a conjugate in class <span class="math notranslate nohighlight">\(f\)</span>-<span class="math notranslate nohighlight">\(P\)</span>.</p>
<p>DEFINITION : Let <span class="math notranslate nohighlight">\(A\)</span> be an alphabet. We say that a
primitive substitution <span class="math notranslate nohighlight">\(S\)</span> is in the <em>class P</em> if there
exists a palindrome <span class="math notranslate nohighlight">\(p\)</span> and for each <span class="math notranslate nohighlight">\(b\in A\)</span> a
palindrome <span class="math notranslate nohighlight">\(q_b\)</span> such that <span class="math notranslate nohighlight">\(S(b)=pq_b\)</span> for all
<span class="math notranslate nohighlight">\(b\in A\)</span>. [1]</p>
<p>Let <span class="math notranslate nohighlight">\(f\)</span> be an involution on <span class="math notranslate nohighlight">\(A\)</span>. We say that a morphism
<span class="math notranslate nohighlight">\(\varphi\)</span> is in class <span class="math notranslate nohighlight">\(f\)</span>-<span class="math notranslate nohighlight">\(P\)</span> if there exists an
<span class="math notranslate nohighlight">\(f\)</span>-palindrome <span class="math notranslate nohighlight">\(p\)</span> and for each <span class="math notranslate nohighlight">\(\alpha \in A\)</span>
there exists an <span class="math notranslate nohighlight">\(f\)</span>-palindrome <span class="math notranslate nohighlight">\(q_\alpha\)</span> such
that <span class="math notranslate nohighlight">\(\varphi(\alpha)=pq_\alpha\)</span>. [2]</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">f</span></code> - involution (default: None) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] Hof, A., O. Knill et B. Simon, Singular continuous
spectrum for palindromic Schrödinger operators,
Commun. Math. Phys.  174 (1995) 149-159.</li>
<li>[2] Labbe, Sebastien. Proprietes combinatoires des
<span class="math notranslate nohighlight">\(f\)</span>-palindromes, Memoire de maitrise en Mathematiques,
Montreal, UQAM, 2008, 109 pages.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fibo</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibo</span><span class="o">.</span><span class="n">has_conjugate_in_classP</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">fibo</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">fibo</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">has_conjugate_in_classP</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.has_left_conjugate">
<code class="descname">has_left_conjugate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.has_left_conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if all the non empty images of <code class="docutils literal notranslate"><span class="pre">self</span></code> begins with
the same letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abcde,b-&gt;xyz&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;b-&gt;xyz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;,b-&gt;xyz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abbab,b-&gt;abb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abbab,b-&gt;abb,c-&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_left_conjugate</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.has_right_conjugate">
<code class="descname">has_right_conjugate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.has_right_conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if all the non empty images of <code class="docutils literal notranslate"><span class="pre">self</span></code> ends with the
same letter.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abcde,b-&gt;xyz&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;b-&gt;xyz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;,b-&gt;xyz&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abbab,b-&gt;abb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abbab,b-&gt;abb,c-&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">has_right_conjugate</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.image">
<code class="descname">image</code><span class="sig-paren">(</span><em>letter</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of a letter.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">letter</span></code> – a letter in the domain alphabet</li>
</ul>
<p>OUTPUT:</p>
<p>word</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The letter is assumed to be in the domain alphabet
(no check done). Hence, this method is faster
than the <code class="docutils literal notranslate"><span class="pre">__call__</span></code> method suitable for words input.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ac,c-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">word: ac</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">):[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">):[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">image</span><span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">word: (&#39;a&#39;, 1),(&#39;a&#39;, 2)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s1">&#39;b&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">:(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s1">&#39;z&#39;</span><span class="p">:[</span><span class="mi">9</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">7</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">word: 12</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: 234</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">word: 987</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.images">
<code class="descname">images</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.images" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of all the images of the letters of the alphabet
under <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">())</span>
<span class="go">[word: a, word: ab]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">images</span><span class="p">())</span>
<span class="go">[word: 5, word: ab, word: asd]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.incidence_matrix">
<code class="descname">incidence_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.incidence_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the incidence matrix of the morphism. The order of the rows
and column are given by the order defined on the alphabet of the
domain and the codomain.</p>
<p>The matrix returned is over the integers.  If a different ring is
desired, use either the <code class="docutils literal notranslate"><span class="pre">change_ring</span></code> function or the <code class="docutils literal notranslate"><span class="pre">matrix</span></code>
function.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abc,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
<span class="go">[1 1 0]</span>
<span class="go">[1 0 0]</span>
<span class="go">[1 0 1]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abc,b-&gt;a,c-&gt;c,d-&gt;abbccccabca,e-&gt;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span>
<span class="go">[1 1 0 3 1]</span>
<span class="go">[1 0 0 3 1]</span>
<span class="go">[1 0 1 5 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_empty">
<code class="descname">is_empty</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the cardinality of the domain is zero and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_endomorphism">
<code class="descname">is_endomorphism</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_endomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the codomain is a subset of the domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;aa,c-&gt;aaa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Wabc</span> <span class="o">=</span> <span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;aa,c-&gt;aaa&#39;</span><span class="p">,</span><span class="n">codomain</span> <span class="o">=</span> <span class="n">Wabc</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/8674">trac ticket #8674</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">WordPaths</span><span class="p">(</span><span class="s1">&#39;abcd&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;adab,b-&gt;ab,c-&gt;cbcd,d-&gt;cd&#39;</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">P</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_endomorphism</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_erasing">
<code class="descname">is_erasing</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_erasing" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an erasing morphism, i.e. the image of a
letter is the empty word.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_erasing</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_erasing</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd,7-&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_erasing</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_erasing</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_growing">
<code class="descname">is_growing</code><span class="sig-paren">(</span><em>letter=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_growing" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">letter</span></code> is a growing letter.</p>
<p>A letter <span class="math notranslate nohighlight">\(a\)</span> is <em>growing</em> for the morphism <span class="math notranslate nohighlight">\(s\)</span> if the length of the
iterates of <span class="math notranslate nohighlight">\(| s^n(a) |\)</span> tend to infinity as <span class="math notranslate nohighlight">\(n\)</span> goes to infinity.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">letter</span></code> – <code class="docutils literal notranslate"><span class="pre">None</span></code> or a letter in the domain of <code class="docutils literal notranslate"><span class="pre">self</span></code></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If letter is <code class="docutils literal notranslate"><span class="pre">None</span></code>, this returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is
everywhere growing, i.e., all letters are growing letters (see
<a class="reference internal" href="#cassnic10" id="id1">[CassNic10]</a>), and that <code class="docutils literal notranslate"><span class="pre">self</span></code> <strong>must</strong> be an endomorphism.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;10&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;1,1-&gt;2,2-&gt;01&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The domain needs to be equal to the codomain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;0,2-&gt;1&#39;</span><span class="p">,</span><span class="n">codomain</span><span class="o">=</span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;012&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">is_growing</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Test of erasing morphisms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;0-&gt;01,1-&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bc,b-&gt;bcc,c-&gt;&#39;</span><span class="p">,</span><span class="n">codomain</span><span class="o">=</span><span class="n">Words</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_growing</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="cassnic10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[CassNic10]</a></td><td>Cassaigne J., Nicolas F. Factor complexity.
Combinatorics, automata and number theory, 163–247, Encyclopedia
Math. Appl., 135, Cambridge Univ. Press, Cambridge, 2010.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_identity">
<code class="descname">is_identity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_identity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is the identity morphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;b,c-&gt;c,d-&gt;e&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;b,c-&gt;c&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;b,c-&gt;cb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;c,c-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">m</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/8618">trac ticket #8618</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="s1">&#39;a1&#39;</span><span class="p">:[</span><span class="s1">&#39;a2&#39;</span><span class="p">],</span> <span class="s1">&#39;a2&#39;</span><span class="p">:[</span><span class="s1">&#39;a1&#39;</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">.</span><span class="n">is_identity</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_in_classP">
<code class="descname">is_in_classP</code><span class="sig-paren">(</span><em>f=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_in_classP" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is in class <span class="math notranslate nohighlight">\(P\)</span> (or <span class="math notranslate nohighlight">\(f\)</span>-<span class="math notranslate nohighlight">\(P\)</span>).</p>
<p>DEFINITION : Let <span class="math notranslate nohighlight">\(A\)</span> be an alphabet. We say that a
primitive substitution <span class="math notranslate nohighlight">\(S\)</span> is in the <em>class P</em> if there
exists a palindrome <span class="math notranslate nohighlight">\(p\)</span> and for each <span class="math notranslate nohighlight">\(b\in A\)</span> a
palindrome <span class="math notranslate nohighlight">\(q_b\)</span> such that <span class="math notranslate nohighlight">\(S(b)=pq_b\)</span> for all
<span class="math notranslate nohighlight">\(b\in A\)</span>. [1]</p>
<p>Let <span class="math notranslate nohighlight">\(f\)</span> be an involution on <span class="math notranslate nohighlight">\(A\)</span>. “We say that a morphism
<span class="math notranslate nohighlight">\(\varphi\)</span> is in class <span class="math notranslate nohighlight">\(f\)</span>-<span class="math notranslate nohighlight">\(P\)</span> if there exists an
<span class="math notranslate nohighlight">\(f\)</span>-palindrome <span class="math notranslate nohighlight">\(p\)</span> and for each <span class="math notranslate nohighlight">\(\alpha \in A\)</span>
there exists an <span class="math notranslate nohighlight">\(f\)</span>-palindrome <span class="math notranslate nohighlight">\(q_\alpha\)</span> such
that <span class="math notranslate nohighlight">\(\varphi(\alpha)=pq_\alpha\)</span>. [2]</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">f</span></code> - involution (default: None) on the alphabet of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
It must be callable on letters as well as words (e.g. WordMorphism).</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] Hof, A., O. Knill et B. Simon, Singular continuous
spectrum for palindromic Schrödinger operators,
Commun. Math. Phys.  174 (1995) 149-159.</li>
<li>[2] Labbe, Sebastien. Proprietes combinatoires des
<span class="math notranslate nohighlight">\(f\)</span>-palindromes, Memoire de maitrise en Mathematiques,
Montreal, UQAM, 2008, 109 pages.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bbaba,b-&gt;bba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">tm</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tm</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tm</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">tm</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">tm</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fibo</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibo</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fibo</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">(</span><span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">fibo</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;acbcc,b-&gt;acbab,c-&gt;acbba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_in_classP</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_involution">
<code class="descname">is_involution</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_involution" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an involution, i.e. its square
is the identity.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - an endomorphism</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_involution</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;ba&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_involution</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span><span class="o">.</span><span class="n">is_involution</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_primitive">
<code class="descname">is_primitive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is primitive.</p>
<p>A morphism <span class="math notranslate nohighlight">\(\varphi\)</span> is <em>primitive</em> if there exists
an positive integer <span class="math notranslate nohighlight">\(k\)</span> such that for all <span class="math notranslate nohighlight">\(\alpha\in\Sigma\)</span>,
<span class="math notranslate nohighlight">\(\varphi^k(\alpha)\)</span> contains all the letters of <span class="math notranslate nohighlight">\(\Sigma\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - an endomorphism</li>
</ul>
<p>ALGORITHM:</p>
<blockquote>
<div>Exercices 8.7.8, p.281 in [1]:
(c) Let <span class="math notranslate nohighlight">\(y(M)\)</span> be the least integer <span class="math notranslate nohighlight">\(e\)</span> such that <span class="math notranslate nohighlight">\(M^e\)</span> has all
positive entries. Prove that, for all primitive matrices <span class="math notranslate nohighlight">\(M\)</span>,
we have <span class="math notranslate nohighlight">\(y(M) \leq (d-1)^2 + 1\)</span>.
(d) Prove that the bound <span class="math notranslate nohighlight">\(y(M)\leq (d-1)^2+1\)</span> is best possible.</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">tm</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tm</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">fibo</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fibo</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bb,b-&gt;aa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;c,c-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;c,c-&gt;d,d-&gt;e,e-&gt;f,f-&gt;g,g-&gt;h,h-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] Jean-Paul Allouche and Jeffrey Shallit, Automatic Sequences:
Theory, Applications, Generalizations, Cambridge University Press,
2003.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_prolongable">
<code class="descname">is_prolongable</code><span class="sig-paren">(</span><em>letter</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_prolongable" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is prolongable on <code class="docutils literal notranslate"><span class="pre">letter</span></code>.</p>
<p>A morphism <span class="math notranslate nohighlight">\(\varphi\)</span> is prolongable on a letter <span class="math notranslate nohighlight">\(a\)</span>
if <span class="math notranslate nohighlight">\(a\)</span> is a prefix of <span class="math notranslate nohighlight">\(\varphi(a)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - its codomain must be an instance of Words</li>
<li><code class="docutils literal notranslate"><span class="pre">letter</span></code> - a letter in the domain alphabet</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;ab&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;ab&#39;</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ba,b-&gt;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bb,b-&gt;aac&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">(</span><span class="n">letter</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/8595">trac ticket #8595</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">:</span> <span class="p">[(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">is_prolongable</span><span class="p">((</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.is_uniform">
<code class="descname">is_uniform</code><span class="sig-paren">(</span><em>k=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.is_uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if self is a <span class="math notranslate nohighlight">\(k\)</span>-uniform morphism.</p>
<p>Let <span class="math notranslate nohighlight">\(k\)</span> be a positive integer. A morphism <span class="math notranslate nohighlight">\(\phi\)</span> is called <span class="math notranslate nohighlight">\(k\)</span>-uniform
if for every letter <span class="math notranslate nohighlight">\(\alpha\)</span>, we have <span class="math notranslate nohighlight">\(|\phi(\alpha)| = k\)</span>. In other
words, all images have length <span class="math notranslate nohighlight">\(k\)</span>. A morphism is called uniform if it
is <span class="math notranslate nohighlight">\(k\)</span>-uniform for some positive integer <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> - a positive integer or None. If set to a positive integer,
then the function return True if self is <span class="math notranslate nohighlight">\(k\)</span>-uniform. If set to
None, then the function return True if self is uniform.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_uniform</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_uniform</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">is_uniform</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">is_uniform</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">tau</span><span class="o">.</span><span class="n">is_uniform</span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.language">
<code class="descname">language</code><span class="sig-paren">(</span><em>n</em>, <em>u=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.language" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the words of length <code class="docutils literal notranslate"><span class="pre">n</span></code> in the language generated by this substitution.</p>
<p>Given a non-erasing substitution <span class="math notranslate nohighlight">\(s\)</span> and a word <span class="math notranslate nohighlight">\(u\)</span> the DOL-language
generated by <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(u\)</span> is the union of the factors of <span class="math notranslate nohighlight">\(s^n(u)\)</span> where
<span class="math notranslate nohighlight">\(n\)</span> is a non-negative integer.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – non-negative integer - length of the words in the language</li>
<li><code class="docutils literal notranslate"><span class="pre">u</span></code> – a word or <code class="docutils literal notranslate"><span class="pre">None</span></code> (optional, default <code class="docutils literal notranslate"><span class="pre">None</span></code>) - if set to
<code class="docutils literal notranslate"><span class="pre">None</span></code> some letter of the alphabet is used</li>
</ul>
<p>OUTPUT: a Python set</p>
<p>EXAMPLES:</p>
<p>The fibonacci morphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[word: 001, word: 010, word: 100, word: 101]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">1001</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">==</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A growing but non-primitive example. The DOL-languages generated
by 0 and 2 are different:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]})</span>

<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A0</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B0</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">A0</span><span class="p">)</span> <span class="o">==</span> <span class="n">B0</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span><span class="o">.</span><span class="n">factor_set</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span> <span class="o">==</span> <span class="n">B2</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">A0</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">A2</span><span class="p">)</span>
<span class="go">(6, 20)</span>
</pre></div>
</div>
<p>The Chacon transformation (non-primitive):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">language</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">[word: 0001000101,</span>
<span class="go"> word: 0001010010,</span>
<span class="go"> ...</span>
<span class="go"> word: 1010010001,</span>
<span class="go"> word: 1010010100]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.latex_layout">
<code class="descname">latex_layout</code><span class="sig-paren">(</span><em>layout=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.latex_layout" title="Permalink to this definition">¶</a></dt>
<dd><p>Get or set the actual latex layout (oneliner vs array).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">layout</span></code> - string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>), can take one of the
following values:<ul>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> - Returns the actual latex layout. By default, the
layout is <code class="docutils literal notranslate"><span class="pre">'array'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'oneliner'</span></code> - Set the layout to <code class="docutils literal notranslate"><span class="pre">'oneliner'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'array'</span></code> - Set the layout to <code class="docutils literal notranslate"><span class="pre">'array'</span></code></li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;ba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">latex_layout</span><span class="p">()</span>
<span class="go">&#39;array&#39;</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">latex_layout</span><span class="p">(</span><span class="s1">&#39;oneliner&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">latex_layout</span><span class="p">()</span>
<span class="go">&#39;oneliner&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.list_of_conjugates">
<code class="descname">list_of_conjugates</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.list_of_conjugates" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the list of all the conjugate morphisms of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>DEFINITION:</p>
<p>Recall from Lothaire [1] (Section 2.3.4)
that <span class="math notranslate nohighlight">\(\varphi\)</span> is <em>right conjugate</em> of <span class="math notranslate nohighlight">\(\varphi'\)</span>,
noted <span class="math notranslate nohighlight">\(\varphi\triangleleft\varphi'\)</span>, if there exists
<span class="math notranslate nohighlight">\(u \in \Sigma^*\)</span> such that</p>
<div class="math notranslate nohighlight">
\[\varphi(\alpha)u = u\varphi'(\alpha),\]</div>
<p>for all <span class="math notranslate nohighlight">\(\alpha \in \Sigma\)</span>, or equivalently that
<span class="math notranslate nohighlight">\(\varphi(x)u = u\varphi'(x)\)</span>, for all words <span class="math notranslate nohighlight">\(x \in \Sigma^*\)</span>.
Clearly, this relation is not
symmetric so that we say that two morphisms <span class="math notranslate nohighlight">\(\varphi\)</span> and
<span class="math notranslate nohighlight">\(\varphi'\)</span> are <em>conjugate</em>, noted
<span class="math notranslate nohighlight">\(\varphi\bowtie\varphi'\)</span>, if
<span class="math notranslate nohighlight">\(\varphi\triangleleft\varphi'\)</span> or
<span class="math notranslate nohighlight">\(\varphi'\triangleleft\varphi\)</span>. It is easy to see that
conjugacy of morphisms is an equivalence relation.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] M. Lothaire, Algebraic Combinatorics on words, Cambridge
University Press, 2002.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abbab,b-&gt;abb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">list_of_conjugates</span><span class="p">()</span>
<span class="go">[WordMorphism: a-&gt;babba, b-&gt;bab,</span>
<span class="go">WordMorphism: a-&gt;abbab, b-&gt;abb,</span>
<span class="go">WordMorphism: a-&gt;bbaba, b-&gt;bba,</span>
<span class="go">WordMorphism: a-&gt;babab, b-&gt;bab,</span>
<span class="go">WordMorphism: a-&gt;ababb, b-&gt;abb,</span>
<span class="go">WordMorphism: a-&gt;babba, b-&gt;bba,</span>
<span class="go">WordMorphism: a-&gt;abbab, b-&gt;bab]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;aaa,b-&gt;aa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">list_of_conjugates</span><span class="p">()</span>
<span class="go">[WordMorphism: a-&gt;aaa, b-&gt;aa]</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">list_of_conjugates</span><span class="p">()</span>
<span class="go">[WordMorphism: ]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;aba,b-&gt;aba&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">list_of_conjugates</span><span class="p">()</span>
<span class="go">[WordMorphism: a-&gt;baa, b-&gt;baa,</span>
<span class="go">WordMorphism: a-&gt;aab, b-&gt;aab,</span>
<span class="go">WordMorphism: a-&gt;aba, b-&gt;aba]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;abb,b-&gt;abbab,c-&gt;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">list_of_conjugates</span><span class="p">()</span>
<span class="go">[WordMorphism: a-&gt;bab, b-&gt;babba, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;abb, b-&gt;abbab, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;bba, b-&gt;bbaba, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;bab, b-&gt;babab, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;abb, b-&gt;ababb, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;bba, b-&gt;babba, c-&gt;,</span>
<span class="go">WordMorphism: a-&gt;bab, b-&gt;abbab, c-&gt;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.partition_of_domain_alphabet">
<code class="descname">partition_of_domain_alphabet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.partition_of_domain_alphabet" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a partition of the domain alphabet.</p>
<p>Let <span class="math notranslate nohighlight">\(\varphi:\Sigma^*\rightarrow\Sigma^*\)</span> be an involution. There
exists a triple of sets <span class="math notranslate nohighlight">\((A, B, C)\)</span> such that</p>
<blockquote>
<div><ul class="simple">
<li><span class="math notranslate nohighlight">\(A \cup B \cup C =\Sigma\)</span>;</li>
<li><span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> and <span class="math notranslate nohighlight">\(C\)</span> are mutually disjoint and</li>
<li><span class="math notranslate nohighlight">\(\varphi(A)= B\)</span>, <span class="math notranslate nohighlight">\(\varphi(B)= A\)</span>, <span class="math notranslate nohighlight">\(\varphi(C)= C\)</span>.</li>
</ul>
</div></blockquote>
<p>These sets are not unique.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - An involution.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple of three sets</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">partition_of_domain_alphabet</span><span class="p">()</span> <span class="c1">#random ordering</span>
<span class="go">({&#39;a&#39;}, {&#39;b&#39;}, {})</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">partition_of_domain_alphabet</span><span class="p">()</span> <span class="c1">#random ordering</span>
<span class="go">({&#39;a&#39;}, {&#39;b&#39;}, {&#39;c&#39;})</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;a,b-&gt;b,c-&gt;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">partition_of_domain_alphabet</span><span class="p">()</span> <span class="c1">#random ordering</span>
<span class="go">({}, {}, {&#39;a&#39;, &#39;c&#39;, &#39;b&#39;})</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;A-&gt;T,T-&gt;A,C-&gt;G,G-&gt;C&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">partition_of_domain_alphabet</span><span class="p">()</span> <span class="c1">#random ordering</span>
<span class="go">({&#39;A&#39;, &#39;C&#39;}, {&#39;T&#39;, &#39;G&#39;}, {})</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">oo</span><span class="p">,</span><span class="n">oo</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span><span class="mi">3</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">I</span><span class="o">.</span><span class="n">partition_of_domain_alphabet</span><span class="p">()</span> <span class="c1">#random ordering</span>
<span class="go">({0, -1, -3, -2}, {1, 2, 3, +Infinity}, {})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.periodic_point">
<code class="descname">periodic_point</code><span class="sig-paren">(</span><em>letter</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.periodic_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the periodic point of self that starts with <code class="docutils literal notranslate"><span class="pre">letter</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bab,b-&gt;ab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">periodic_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">word: abbababbababbabababbababbabababbababbaba...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fixed_point</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: self must be prolongable on a</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.periodic_points">
<code class="descname">periodic_points</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.periodic_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the periodic points of <code class="docutils literal notranslate"><span class="pre">f</span></code> as a list of tuples where each tuple is
a periodic orbit of <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;aba,b-&gt;baa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">periodic_points</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} , {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">1 , ababaaababaaabaabaababaaababaaabaabaabab...</span>
<span class="go">1 , baaabaabaababaaabaababaaabaababaaababaaa...</span>

<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;bab,b-&gt;aa&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">periodic_points</span><span class="p">():</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} , {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">2 , aababaaaababaababbabaababaababbabaababaa...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>This shows that ticket <a class="reference external" href="https://trac.sagemath.org/13668">trac ticket #13668</a> has been resolved:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span><span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span><span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span><span class="mi">6</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span><span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span><span class="mi">8</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span><span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span><span class="mi">10</span><span class="p">:[</span><span class="mi">1</span><span class="p">]}</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s7</span> <span class="o">=</span> <span class="n">s</span><span class="o">^</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">s7r</span> <span class="o">=</span> <span class="n">s7</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">s7r</span><span class="o">.</span><span class="n">periodic_points</span><span class="p">():</span> <span class="n">p</span>
<span class="go">[word: 1,10,9,8,7,6,5,4,3,2,10,9,8,7,6,5,4,3,2,...,</span>
<span class="go"> word: 8765432765432654325432432322176543265432...,</span>
<span class="go"> word: 5,4,3,2,4,3,2,3,2,2,1,4,3,2,3,2,2,1,3,2,...,</span>
<span class="go"> word: 2,1,1,10,9,8,7,6,5,4,3,2,1,10,9,8,7,6,5,...,</span>
<span class="go"> word: 9876543287654327654326543254324323221876...,</span>
<span class="go"> word: 6543254324323221543243232214323221322121...,</span>
<span class="go"> word: 3,2,2,1,2,1,1,10,9,8,7,6,5,4,3,2,2,1,1,1...,</span>
<span class="go"> word: 10,9,8,7,6,5,4,3,2,9,8,7,6,5,4,3,2,8,7,6...,</span>
<span class="go"> word: 7654326543254324323221654325432432322154...,</span>
<span class="go"> word: 4,3,2,3,2,2,1,3,2,2,1,2,1,1,10,9,8,7,6,5...]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.pisot_eigenvector_left">
<code class="descname">pisot_eigenvector_left</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.pisot_eigenvector_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the left eigenvector of the incidence matrix associated
to the largest eigenvalue (in absolute value).</p>
<p>Unicity of the result is guaranteed when the multiplicity of the
largest eigenvalue is one, for example when self is a Pisot
irreductible substitution.</p>
<p>A substitution is Pisot irreducible if the characteristic
polynomial of its incidence matrix is irreducible over <span class="math notranslate nohighlight">\(\QQ\)</span> and
has all roots, except one, of modulus strictly smaller than 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a Pisot irreducible substitution.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;aaaabbc,b-&gt;aaabbc,c-&gt;aabc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">[4 3 2]</span>
<span class="go">[2 2 1]</span>
<span class="go">[1 1 1]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">pisot_eigenvector_left</span><span class="p">()</span>
<span class="go">(1, 0.8392867552141611?, 0.5436890126920763?)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.pisot_eigenvector_right">
<code class="descname">pisot_eigenvector_right</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.pisot_eigenvector_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the right eigenvector of the incidence matrix associated
to the largest eigenvalue (in absolute value).</p>
<p>Unicity of the result is guaranteed when the multiplicity of the
largest eigenvalue is one, for example when self is a Pisot
irreductible substitution.</p>
<p>A substitution is Pisot irreducible if the characteristic
polynomial of its incidence matrix is irreducible over <span class="math notranslate nohighlight">\(\QQ\)</span> and
has all roots, except one, of modulus strictly smaller than 1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a Pisot irreducible substitution.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;aaaabbc,b-&gt;aaabbc,c-&gt;aabc&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">[4 3 2]</span>
<span class="go">[2 2 1]</span>
<span class="go">[1 1 1]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">pisot_eigenvector_right</span><span class="p">()</span>
<span class="go">(1, 0.5436890126920763?, 0.2955977425220848?)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot">
<code class="descname">rauzy_fractal_plot</code><span class="sig-paren">(</span><em>n=None</em>, <em>exchange=False</em>, <em>eig=None</em>, <em>translate=None</em>, <em>prec=53</em>, <em>colormap='hsv'</em>, <em>opacity=None</em>, <em>plot_origin=None</em>, <em>plot_basis=False</em>, <em>point_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a plot of the Rauzy fractal associated with a substitution.</p>
<p>The substitution does not have to be irreducible.
The usual definition of a Rauzy fractal requires that
its dominant eigenvalue is a Pisot number but the present method
doesn’t require this, allowing to plot some interesting pictures
in the non-Pisot case (see the examples below).</p>
<p>For more details about the definition of the fractal and the
projection which is used, see Section 3.1 of [1].</p>
<p>Plots with less than 100,000 points take a few seconds,
and several millions of points can be plotted in reasonable time.</p>
<p>Other ways to draw Rauzy fractals (and more generally projections of paths)
can be found in <a class="reference internal" href="paths.html#sage.combinat.words.paths.FiniteWordPath_all.plot_projection" title="sage.combinat.words.paths.FiniteWordPath_all.plot_projection"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.words.paths.FiniteWordPath_all.plot_projection()</span></code></a>
or in <a class="reference internal" href="../e_one_star.html#module-sage.combinat.e_one_star" title="sage.combinat.e_one_star"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.combinat.e_one_star()</span></code></a>.</p>
<p>OUTPUT:</p>
<p>A Graphics object.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n</span></code> - integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)
The number of points used to plot the fractal.
Default values: <code class="docutils literal notranslate"><span class="pre">1000</span></code> for a 1D fractal,
<code class="docutils literal notranslate"><span class="pre">50000</span></code> for a 2D fractal, <code class="docutils literal notranslate"><span class="pre">10000</span></code> for a 3D fractal.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">exchange</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).
Plot the Rauzy fractal with domain exchange.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">eig</span></code> - a real element of <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> of degree &gt;= 2 (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
The eigenvalue used to plot the fractal.
It must be an eigenvalue of <code class="docutils literal notranslate"><span class="pre">self.incidence_matrix()</span></code>.
The one used by default the maximal eigenvalue of
<code class="docutils literal notranslate"><span class="pre">self.incidence_matrix()</span></code> (usually a Pisot number),
but for substitutions with more than 3 letters
other interesting choices are sometimes possible.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">translate</span></code> - a list of vectors of <code class="docutils literal notranslate"><span class="pre">RR^size_alphabet</span></code>,
or a dictionary from the alphabet to lists of vectors (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
Plot translated copies of the fractal.
This option allows to plot tilings easily.
The projection used for these vectors is the same as
the projection used for the canonical basis to plot the fractal.
If the input is a list, all the pieces will be translated and plotted.
If the input is a dictionary, each piece will be translated and plotted
accordingly to the vectors associated with each letter in the dictionary.
Note: by default, the Rauzy fractal placed at the origin
is not plotted with the <code class="docutils literal notranslate"><span class="pre">translate</span></code> option;
the vector <code class="docutils literal notranslate"><span class="pre">(0,0,...,0)</span></code> has to be added manually.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">prec</span></code> - integer (default: <code class="docutils literal notranslate"><span class="pre">53</span></code>).
The number of bits used in the floating point representations
of the points of the fractal.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">colormap</span></code> - color map or dictionary (default: <code class="docutils literal notranslate"><span class="pre">'hsv'</span></code>).
It can be one of the following:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">string</span></code> - a coloring map. For available coloring map names type:
<code class="docutils literal notranslate"><span class="pre">sorted(colormaps)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dict</span></code> - a dictionary of the alphabet mapped to colors.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">opacity</span></code> - a dictionary from the alphabet to the real interval [0,1] (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
If none is specified, all letters are plotted with opacity <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plot_origin</span></code> - a couple <code class="docutils literal notranslate"><span class="pre">(k,c)</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
If specified, mark the origin by a point of size <code class="docutils literal notranslate"><span class="pre">k</span></code> and color <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">plot_basis</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).
Plot the projection of the canonical basis with the fractal.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">point_size</span></code> - float (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
The size of the points used to plot the fractal.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<ol class="arabic">
<li><p class="first">The Rauzy fractal of the Tribonacci substitution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>     <span class="c1"># long time</span>
<span class="go">Graphics object consisting of 3 graphics primitives</span>
</pre></div>
</div>
</li>
<li><p class="first">The “Hokkaido” fractal. We tweak the plot using the plotting options
to get a nice reusable picture, in which we mark the origin by a black dot:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;c,c-&gt;d,d-&gt;e,e-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot_origin</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="s2">&quot;black&quot;</span><span class="p">))</span>  <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">false</span><span class="p">)</span> <span class="c1"># not tested</span>
</pre></div>
</div>
</li>
<li><p class="first">Another “Hokkaido” fractal and its domain exchange:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>                  <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">exchange</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A three-dimensional Rauzy fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;14,4-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A one-dimensional Rauzy fractal (very scattered):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;2122,2-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A high resolution plot of a complicated fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;23,2-&gt;123,3-&gt;1122233&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">300000</span><span class="p">)</span>  <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">false</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>      <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A nice colorful animation of a domain exchange:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;21,2-&gt;3,3-&gt;4,4-&gt;25,5-&gt;6,6-&gt;7,7-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(),</span> <span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">exchange</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>     <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">animate</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">false</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">Plotting with only one color:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;31,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">colormap</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="s1">&#39;black&#39;</span><span class="p">})</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">Different fractals can be obtained by choosing another (non-Pisot) eigenvalue:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;3,3-&gt;45,4-&gt;5,5-&gt;6,6-&gt;7,7-&gt;8,8-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">incidence_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">E</span> <span class="k">if</span> <span class="o">-</span><span class="mf">0.8</span> <span class="o">&lt;</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.7</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>          <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">eig</span><span class="o">=</span><span class="n">x</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A Pisot reducible substitution with seemingly overlapping tiles:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">10</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A non-Pisot reducible substitution with a strange Rauzy fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">A substitution with overlapping tiles. We use the options
<code class="docutils literal notranslate"><span class="pre">colormap</span></code> and <code class="docutils literal notranslate"><span class="pre">opacity</span></code> to study how the tiles overlap:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;213,2-&gt;4,3-&gt;5,4-&gt;1,5-&gt;21&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>                                   <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">colormap</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="s1">&#39;purple&#39;</span><span class="p">})</span>     <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;1&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">:</span><span class="mf">0.1</span><span class="p">},</span> <span class="n">n</span><span class="o">=</span><span class="mi">150000</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">Funny experiments by playing with the precision of the float numbers used to plot the fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>      <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>      <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>     <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>     <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>     <span class="c1"># not tested</span>
</pre></div>
</div>
</li>
<li><p class="first">Using the <code class="docutils literal notranslate"><span class="pre">translate</span></code> option to plot periodic tilings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s2">&quot;a-&gt;aC,b-&gt;d,C-&gt;de,d-&gt;a,e-&gt;ab&quot;</span><span class="p">)</span>   <span class="c1"># substitution found by Julien Bernat</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="n">vector</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">vector</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]))</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">S</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">Using the <code class="docutils literal notranslate"><span class="pre">translate</span></code> option to plot arbitrary tilings with the fractal pieces.
This can be used for example to plot the self-replicating tiling of the Rauzy fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">()</span>     <span class="c1"># not tested takes &gt; 1 second</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="mi">3</span><span class="p">:[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span> <span class="mi">6</span><span class="p">:[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]}</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">translate</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
<li><p class="first">Plot the projection of the canonical basis with the fractal:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">({</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_plot</span><span class="p">(</span><span class="n">plot_basis</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>     <span class="c1"># not tested takes &gt; 1 second</span>
</pre></div>
</div>
</li>
</ol>
<p>REFERENCES:</p>
<ul class="simple">
<li>[1] Valerie Berthe and Anne Siegel,
Tilings associated with beta-numeration and substitutions,
Integers 5 (3), 2005.
<a class="reference external" href="http://www.integers-ejcnt.org/vol5-3.html">http://www.integers-ejcnt.org/vol5-3.html</a></li>
</ul>
<p>AUTHOR:</p>
<blockquote>
<div>Timo Jolivet (2012-06-16)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.rauzy_fractal_points">
<code class="descname">rauzy_fractal_points</code><span class="sig-paren">(</span><em>n=None</em>, <em>exchange=False</em>, <em>eig=None</em>, <em>translate=None</em>, <em>prec=53</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.rauzy_fractal_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary of list of points associated with the pieces
of the Rauzy fractal of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<blockquote>
<div>See the method <a class="reference internal" href="#sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot" title="sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rauzy_fractal_plot()</span></code></a> for a description
of the options and more examples.</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div>dictionary of list of points</div></blockquote>
<p>EXAMPLES:</p>
<p>The Rauzy fractal of the Tribonacci substitution and the number of
points in the piece of the fractal associated with <code class="docutils literal notranslate"><span class="pre">'1'</span></code>, <code class="docutils literal notranslate"><span class="pre">'2'</span></code>
and <code class="docutils literal notranslate"><span class="pre">'3'</span></code> are respectively:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_points</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">])</span>
<span class="go">54</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;2&#39;</span><span class="p">])</span>
<span class="go">30</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="s1">&#39;3&#39;</span><span class="p">])</span>
<span class="go">16</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<blockquote>
<div>Timo Jolivet (2012-06-16)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.rauzy_fractal_projection">
<code class="descname">rauzy_fractal_projection</code><span class="sig-paren">(</span><em>eig=None</em>, <em>prec=53</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.rauzy_fractal_projection" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dictionary giving the projection of the canonical basis.</p>
<p>See the method <a class="reference internal" href="#sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot" title="sage.combinat.words.morphism.WordMorphism.rauzy_fractal_plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rauzy_fractal_plot()</span></code></a> for more details about the projection.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">eig</span></code> - a real element of <code class="docutils literal notranslate"><span class="pre">QQbar</span></code> of degree &gt;= 2 (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).
The eigenvalue used for the projection.
It must be an eigenvalue of <code class="docutils literal notranslate"><span class="pre">self.incidence_matrix()</span></code>.
The one used by default is the maximal eigenvalue of
<code class="docutils literal notranslate"><span class="pre">self.incidence_matrix()</span></code> (usually a Pisot number),
but for substitutions with more than 3 letters
other interesting choices are sometimes possible.</li>
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> - integer (default: <code class="docutils literal notranslate"><span class="pre">53</span></code>).
The number of bits used in the floating point representations
of the coordinates.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>dictionary, letter -&gt; vector, giving the projection</div></blockquote>
<p>EXAMPLES:</p>
<p>The projection for the Rauzy fractal of the Tribonacci substitution
is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;1-&gt;12,2-&gt;13,3-&gt;1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">rauzy_fractal_projection</span><span class="p">()</span>
<span class="go">{&#39;1&#39;: (1.00000000000000, 0.000000000000000),</span>
<span class="go"> &#39;2&#39;: (-1.41964337760708, -0.606290729207199),</span>
<span class="go"> &#39;3&#39;: (-0.771844506346038, 1.11514250803994)}</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<blockquote>
<div>Timo Jolivet (2012-06-16)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.restrict_domain">
<code class="descname">restrict_domain</code><span class="sig-paren">(</span><em>alphabet</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.restrict_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a restriction of <code class="docutils literal notranslate"><span class="pre">self</span></code> to the given alphabet.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">alphabet</span></code> - an iterable</li>
</ul>
<p>OUTPUT:</p>
<p>WordMorphism</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;b,b-&gt;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;b</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="go">WordMorphism:</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="go">WordMorphism:</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="s1">&#39;Aa&#39;</span><span class="p">)</span>
<span class="go">WordMorphism: a-&gt;b</span>
</pre></div>
</div>
<p>The input alphabet must be iterable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="mi">66</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: &#39;sage.rings.integer.Integer&#39; object is not iterable</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.combinat.words.morphism.WordMorphism.reversal">
<code class="descname">reversal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.WordMorphism.reversal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the reversal of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;6-&gt;ab,y-&gt;5,0-&gt;asd&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="go">WordMorphism: 0-&gt;dsa, 6-&gt;ba, y-&gt;5</span>
<span class="gp">sage: </span><span class="n">WordMorphism</span><span class="p">(</span><span class="s1">&#39;a-&gt;ab,b-&gt;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reversal</span><span class="p">()</span>
<span class="go">WordMorphism: a-&gt;ba, b-&gt;a</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.combinat.words.morphism.get_cycles">
<code class="descclassname">sage.combinat.words.morphism.</code><code class="descname">get_cycles</code><span class="sig-paren">(</span><em>f</em>, <em>domain=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.words.morphism.get_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cycle of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> on the finite set domain. It is
assumed that f is an endomorphism.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">f</span></code> - function.</li>
<li><code class="docutils literal notranslate"><span class="pre">domain</span></code> - set (default: None) - the domain of <code class="docutils literal notranslate"><span class="pre">f</span></code>. If none, then
tries to use <code class="docutils literal notranslate"><span class="pre">f.domain()</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.words.morphism</span> <span class="kn">import</span> <span class="n">get_cycles</span>
<span class="gp">sage: </span><span class="n">get_cycles</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">%</span><span class="k">3</span>, domain=[0,1,2])
<span class="go">[(0, 1, 2)]</span>
<span class="gp">sage: </span><span class="n">get_cycles</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[(0,)]</span>
<span class="gp">sage: </span><span class="n">get_cycles</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="n">domain</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[(1,)]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="lyndon_word.html"
                        title="previous chapter">Lyndon words</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="paths.html"
                        title="next chapter">Word paths</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/words/morphism.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="paths.html" title="Word paths"
             >next</a> |</li>
        <li class="right" >
          <a href="lyndon_word.html" title="Lyndon words"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>