
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Latin Squares &#8212; Sage 9.4 Reference Manual: Combinatorics</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Miscellaneous" href="../misc.html" />
    <link rel="prev" title="Hadamard matrices" href="hadamard_matrix.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../misc.html" title="Miscellaneous"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hadamard_matrix.html" title="Hadamard matrices"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Latin Squares</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="latin-squares">
<span id="sage-combinat-matrices-latin"></span><h1>Latin Squares<a class="headerlink" href="#latin-squares" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.matrices.latin"></span><p>A <em>latin square</em> of order <span class="math notranslate nohighlight">\(n\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> array such that
each symbol <span class="math notranslate nohighlight">\(s \in \{ 0, 1, \dots, n-1\}\)</span> appears precisely once in each
row, and precisely once in each column. A <em>partial latin square</em> of
order <span class="math notranslate nohighlight">\(n\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> array such that
each symbol <span class="math notranslate nohighlight">\(s \in \{ 0, 1, \dots, n-1\}\)</span> appears at most once in each
row, and at most once in each column. Empty cells are denoted by <span class="math notranslate nohighlight">\(-1\)</span>.
A latin square <span class="math notranslate nohighlight">\(L\)</span> is a
<em>completion</em> of a partial latin square <span class="math notranslate nohighlight">\(P\)</span> if <span class="math notranslate nohighlight">\(P \subseteq L\)</span>. If
<span class="math notranslate nohighlight">\(P\)</span> completes to just <span class="math notranslate nohighlight">\(L\)</span> then <span class="math notranslate nohighlight">\(P\)</span> <em>has unique completion</em>.</p>
<p>A <em>latin bitrade</em> <span class="math notranslate nohighlight">\((T_1,\, T_2)\)</span> is a pair of partial
latin squares such that:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(\{ (i,\,j) \mid (i,\,j,\,k) \in T_1 \text{ for some symbol }k \}
= \{ (i,\,j) \mid (i,\,j,\,k') \in T_2 \text{ for some symbol }k' \};\)</span></p></li>
<li><p>for each <span class="math notranslate nohighlight">\((i,\,j,\,k) \in T_1\)</span> and <span class="math notranslate nohighlight">\((i,\,j,\,k') \in T_2\)</span>,
<span class="math notranslate nohighlight">\(k \neq k'\)</span>;</p></li>
<li><p>the symbols appearing in row <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(T_1\)</span> are the same as those of
row <span class="math notranslate nohighlight">\(i\)</span> of <span class="math notranslate nohighlight">\(T_2\)</span>; the symbols appearing in column <span class="math notranslate nohighlight">\(j\)</span> of <span class="math notranslate nohighlight">\(T_1\)</span> are
the same as those of column <span class="math notranslate nohighlight">\(j\)</span> of <span class="math notranslate nohighlight">\(T_2\)</span>.</p></li>
</ol>
<p>Intuitively speaking, a bitrade gives the difference between two latin
squares, so if <span class="math notranslate nohighlight">\((T_1,\, T_2)\)</span> is a bitrade
for the pair of latin squares <span class="math notranslate nohighlight">\((L_1,\, L_2)\)</span>, then
<span class="math notranslate nohighlight">\(L1 = (L2 \setminus T_1) \cup T_2\)</span>
and
<span class="math notranslate nohighlight">\(L2 = (L1 \setminus T_2) \cup T_1\)</span>.</p>
<p>This file contains</p>
<ol class="arabic simple">
<li><p>LatinSquare class definition;</p></li>
<li><p>some named latin squares (back circulant, forward circulant, abelian
<span class="math notranslate nohighlight">\(2\)</span>-group);</p></li>
<li><p>functions is_partial_latin_square and is_latin_square to test
if a LatinSquare object satisfies the definition of a latin square
or partial latin square, respectively;</p></li>
<li><p>tests for completion and unique completion (these use the C++
implementation of Knuth’s dancing links algorithm to solve the
problem as a instance of <span class="math notranslate nohighlight">\(0-1\)</span> matrix exact cover);</p></li>
<li><p>functions for calculating the <span class="math notranslate nohighlight">\(\tau_i\)</span> representation of a bitrade
and the genus of the associated hypermap embedding;</p></li>
<li><p>Markov chain of Jacobson and Matthews (1996) for generating latin
squares uniformly at random (provides a generator interface);</p></li>
<li><p>a few examples of <span class="math notranslate nohighlight">\(\tau_i\)</span> representations of bitrades constructed
from the action of a group on itself by right multiplication,
functions for converting to a pair of LatinSquare objects.</p></li>
</ol>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">[0 1 2 3 4]</span>
<span class="go">[1 2 3 4 0]</span>
<span class="go">[2 3 4 0 1]</span>
<span class="go">[3 4 0 1 2]</span>
<span class="go">[4 0 1 2 3]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_latin_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_latin_square</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0 -1  3  1]</span>
<span class="go">[-1  1  0  2]</span>
<span class="go">[ 1  3  2 -1]</span>
<span class="go">[ 2  0 -1  3]</span>
<span class="gp">sage: </span><span class="n">T2</span>
<span class="go">[ 1 -1  0  3]</span>
<span class="go">[-1  0  2  1]</span>
<span class="go">[ 2  1  3 -1]</span>
<span class="go">[ 0  3 -1  2]</span>
<span class="gp">sage: </span><span class="n">T1</span><span class="o">.</span><span class="n">nr_filled_cells</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">genus</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ol class="arabic simple">
<li><p>Latin squares with symbols from a ring instead of the integers
<span class="math notranslate nohighlight">\(\{ 0, 1, \dots, n-1 \}\)</span>.</p></li>
<li><p>Isotopism testing of latin squares and bitrades via graph
isomorphism (nauty?).</p></li>
<li><p>Combinatorial constructions for bitrades.</p></li>
</ol>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Carlo Hamalainen (2008-03-23): initial version</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">LatinSquare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Latin squares.</p>
<p>This class implements a latin square of order n with rows and
columns indexed by the set 0, 1, …, n-1 and symbols from the same
set. The underlying latin square is a matrix(ZZ, n, n). If L is a
latin square, then the cell at row r, column c is empty if and only
if L[r, c] &lt; 0. In this way we allow partial latin squares and can
speak of completions to latin squares, etc.</p>
<p>There are two ways to declare a latin square:</p>
<p>Empty latin square of order n:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[-1 -1 -1]</span>
<span class="go">[-1 -1 -1]</span>
<span class="go">[-1 -1 -1]</span>
</pre></div>
</div>
<p>Latin square from a matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">LatinSquare</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[2 3]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.actual_row_col_sym_sizes">
<span class="sig-name descname"><span class="pre">actual_row_col_sym_sizes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.actual_row_col_sym_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bitrades sometimes end up in partial latin squares with unused
rows, columns, or symbols. This function works out the actual
number of used rows, columns, and symbols.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We assume that the unused rows/columns occur in the lower
right of self, and that the used symbols are in the range
{0, 1, …, m} (no holes in that list).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">[-1  1 -1]</span>
<span class="go">[ 1  2 -1]</span>
<span class="go">[ 2 -1 -1]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">actual_row_col_sym_sizes</span><span class="p">()</span>
<span class="go">(3, 2, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.apply_isotopism">
<span class="sig-name descname"><span class="pre">apply_isotopism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row_perm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_perm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sym_perm</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.apply_isotopism" title="Permalink to this definition">¶</a></dt>
<dd><p>An isotopism is a permutation of the rows, columns, and symbols of
a partial latin square self. Use isotopism() to convert a tuple
(indexed from 0) to a Permutation object.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">[0 1 2 3 4]</span>
<span class="go">[1 2 3 4 0]</span>
<span class="go">[2 3 4 0 1]</span>
<span class="go">[3 4 0 1 2]</span>
<span class="go">[4 0 1 2 3]</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">beta</span>  <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="go">[3 4 2 0 1]</span>
<span class="go">[0 2 3 1 4]</span>
<span class="go">[1 3 0 4 2]</span>
<span class="go">[4 0 1 2 3]</span>
<span class="go">[2 1 4 3 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.clear_cells">
<span class="sig-name descname"><span class="pre">clear_cells</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.clear_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark every cell in self as being empty.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">clear_cells</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[-1 -1]</span>
<span class="go">[-1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.column">
<span class="sig-name descname"><span class="pre">column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.column" title="Permalink to this definition">¶</a></dt>
<dd><p>Return column x of the latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 1, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.contained_in">
<span class="sig-name descname"><span class="pre">contained_in</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.contained_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if self is a subset of Q?</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">contained_in</span><span class="p">(</span><span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">contained_in</span><span class="p">(</span><span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.disjoint_mate_dlxcpp_rows_and_map">
<span class="sig-name descname"><span class="pre">disjoint_mate_dlxcpp_rows_and_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_subtrade</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.disjoint_mate_dlxcpp_rows_and_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for find_disjoint_mates.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">disjoint_mate_dlxcpp_rows_and_map</span><span class="p">(</span><span class="n">allow_subtrade</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">([[0, 16, 32],</span>
<span class="go">  [1, 17, 32],</span>
<span class="go">  [2, 18, 32],</span>
<span class="go">  [3, 19, 32],</span>
<span class="go">  [4, 16, 33],</span>
<span class="go">  [5, 17, 33],</span>
<span class="go">  [6, 18, 33],</span>
<span class="go">  [7, 19, 33],</span>
<span class="go">  [8, 16, 34],</span>
<span class="go">  [9, 17, 34],</span>
<span class="go">  [10, 18, 34],</span>
<span class="go">  [11, 19, 34],</span>
<span class="go">  [12, 16, 35],</span>
<span class="go">  [13, 17, 35],</span>
<span class="go">  [14, 18, 35],</span>
<span class="go">  [15, 19, 35],</span>
<span class="go">  [0, 20, 36],</span>
<span class="go">  [1, 21, 36],</span>
<span class="go">  [2, 22, 36],</span>
<span class="go">  [3, 23, 36],</span>
<span class="go">  [4, 20, 37],</span>
<span class="go">  [5, 21, 37],</span>
<span class="go">  [6, 22, 37],</span>
<span class="go">  [7, 23, 37],</span>
<span class="go">  [8, 20, 38],</span>
<span class="go">  [9, 21, 38],</span>
<span class="go">  [10, 22, 38],</span>
<span class="go">  [11, 23, 38],</span>
<span class="go">  [12, 20, 39],</span>
<span class="go">  [13, 21, 39],</span>
<span class="go">  [14, 22, 39],</span>
<span class="go">  [15, 23, 39],</span>
<span class="go">  [0, 24, 40],</span>
<span class="go">  [1, 25, 40],</span>
<span class="go">  [2, 26, 40],</span>
<span class="go">  [3, 27, 40],</span>
<span class="go">  [4, 24, 41],</span>
<span class="go">  [5, 25, 41],</span>
<span class="go">  [6, 26, 41],</span>
<span class="go">  [7, 27, 41],</span>
<span class="go">  [8, 24, 42],</span>
<span class="go">  [9, 25, 42],</span>
<span class="go">  [10, 26, 42],</span>
<span class="go">  [11, 27, 42],</span>
<span class="go">  [12, 24, 43],</span>
<span class="go">  [13, 25, 43],</span>
<span class="go">  [14, 26, 43],</span>
<span class="go">  [15, 27, 43],</span>
<span class="go">  [0, 28, 44],</span>
<span class="go">  [1, 29, 44],</span>
<span class="go">  [2, 30, 44],</span>
<span class="go">  [3, 31, 44],</span>
<span class="go">  [4, 28, 45],</span>
<span class="go">  [5, 29, 45],</span>
<span class="go">  [6, 30, 45],</span>
<span class="go">  [7, 31, 45],</span>
<span class="go">  [8, 28, 46],</span>
<span class="go">  [9, 29, 46],</span>
<span class="go">  [10, 30, 46],</span>
<span class="go">  [11, 31, 46],</span>
<span class="go">  [12, 28, 47],</span>
<span class="go">  [13, 29, 47],</span>
<span class="go">  [14, 30, 47],</span>
<span class="go">  [15, 31, 47]],</span>
<span class="go"> {(0, 16, 32): (0, 0, 0),</span>
<span class="go">  (0, 20, 36): (1, 0, 0),</span>
<span class="go">  (0, 24, 40): (2, 0, 0),</span>
<span class="go">  (0, 28, 44): (3, 0, 0),</span>
<span class="go">  (1, 17, 32): (0, 0, 1),</span>
<span class="go">  (1, 21, 36): (1, 0, 1),</span>
<span class="go">  (1, 25, 40): (2, 0, 1),</span>
<span class="go">  (1, 29, 44): (3, 0, 1),</span>
<span class="go">  (2, 18, 32): (0, 0, 2),</span>
<span class="go">  (2, 22, 36): (1, 0, 2),</span>
<span class="go">  (2, 26, 40): (2, 0, 2),</span>
<span class="go">  (2, 30, 44): (3, 0, 2),</span>
<span class="go">  (3, 19, 32): (0, 0, 3),</span>
<span class="go">  (3, 23, 36): (1, 0, 3),</span>
<span class="go">  (3, 27, 40): (2, 0, 3),</span>
<span class="go">  (3, 31, 44): (3, 0, 3),</span>
<span class="go">  (4, 16, 33): (0, 1, 0),</span>
<span class="go">  (4, 20, 37): (1, 1, 0),</span>
<span class="go">  (4, 24, 41): (2, 1, 0),</span>
<span class="go">  (4, 28, 45): (3, 1, 0),</span>
<span class="go">  (5, 17, 33): (0, 1, 1),</span>
<span class="go">  (5, 21, 37): (1, 1, 1),</span>
<span class="go">  (5, 25, 41): (2, 1, 1),</span>
<span class="go">  (5, 29, 45): (3, 1, 1),</span>
<span class="go">  (6, 18, 33): (0, 1, 2),</span>
<span class="go">  (6, 22, 37): (1, 1, 2),</span>
<span class="go">  (6, 26, 41): (2, 1, 2),</span>
<span class="go">  (6, 30, 45): (3, 1, 2),</span>
<span class="go">  (7, 19, 33): (0, 1, 3),</span>
<span class="go">  (7, 23, 37): (1, 1, 3),</span>
<span class="go">  (7, 27, 41): (2, 1, 3),</span>
<span class="go">  (7, 31, 45): (3, 1, 3),</span>
<span class="go">  (8, 16, 34): (0, 2, 0),</span>
<span class="go">  (8, 20, 38): (1, 2, 0),</span>
<span class="go">  (8, 24, 42): (2, 2, 0),</span>
<span class="go">  (8, 28, 46): (3, 2, 0),</span>
<span class="go">  (9, 17, 34): (0, 2, 1),</span>
<span class="go">  (9, 21, 38): (1, 2, 1),</span>
<span class="go">  (9, 25, 42): (2, 2, 1),</span>
<span class="go">  (9, 29, 46): (3, 2, 1),</span>
<span class="go">  (10, 18, 34): (0, 2, 2),</span>
<span class="go">  (10, 22, 38): (1, 2, 2),</span>
<span class="go">  (10, 26, 42): (2, 2, 2),</span>
<span class="go">  (10, 30, 46): (3, 2, 2),</span>
<span class="go">  (11, 19, 34): (0, 2, 3),</span>
<span class="go">  (11, 23, 38): (1, 2, 3),</span>
<span class="go">  (11, 27, 42): (2, 2, 3),</span>
<span class="go">  (11, 31, 46): (3, 2, 3),</span>
<span class="go">  (12, 16, 35): (0, 3, 0),</span>
<span class="go">  (12, 20, 39): (1, 3, 0),</span>
<span class="go">  (12, 24, 43): (2, 3, 0),</span>
<span class="go">  (12, 28, 47): (3, 3, 0),</span>
<span class="go">  (13, 17, 35): (0, 3, 1),</span>
<span class="go">  (13, 21, 39): (1, 3, 1),</span>
<span class="go">  (13, 25, 43): (2, 3, 1),</span>
<span class="go">  (13, 29, 47): (3, 3, 1),</span>
<span class="go">  (14, 18, 35): (0, 3, 2),</span>
<span class="go">  (14, 22, 39): (1, 3, 2),</span>
<span class="go">  (14, 26, 43): (2, 3, 2),</span>
<span class="go">  (14, 30, 47): (3, 3, 2),</span>
<span class="go">  (15, 19, 35): (0, 3, 3),</span>
<span class="go">  (15, 23, 39): (1, 3, 3),</span>
<span class="go">  (15, 27, 43): (2, 3, 3),</span>
<span class="go">  (15, 31, 47): (3, 3, 3)})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.dlxcpp_has_unique_completion">
<span class="sig-name descname"><span class="pre">dlxcpp_has_unique_completion</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.dlxcpp_has_unique_completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the partial latin square self of order n can be embedded
in precisely one latin square of order n.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">dlxcpp_has_unique_completion</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">dlxcpp_has_unique_completion</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">dlxcpp_has_unique_completion</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.dumps">
<span class="sig-name descname"><span class="pre">dumps</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.dumps" title="Permalink to this definition">¶</a></dt>
<dd><p>Since the latin square class does not hold any other private
variables we just call dumps on self.square:</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.filled_cells_map">
<span class="sig-name descname"><span class="pre">filled_cells_map</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.filled_cells_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Number the filled cells of self with integers from {1, 2, 3, …}</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - Partial latin square self (empty cells
have negative values)</p></li>
</ul>
<p>OUTPUT: A dictionary cells_map where cells_map[(i,j)] = m means
that (i,j) is the m-th filled cell in P, while cells_map[m] =
(i,j).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">filled_cells_map</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">}</span>
<span class="go">{1: (0, 0),</span>
<span class="go"> 2: (0, 2),</span>
<span class="go"> 3: (0, 3),</span>
<span class="go"> 4: (1, 1),</span>
<span class="go"> 5: (1, 2),</span>
<span class="go"> 6: (1, 3),</span>
<span class="go"> 7: (2, 0),</span>
<span class="go"> 8: (2, 1),</span>
<span class="go"> 9: (2, 2),</span>
<span class="go"> 10: (3, 0),</span>
<span class="go"> 11: (3, 1),</span>
<span class="go"> 12: (3, 3)}</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">}</span>
<span class="go">{(0, 0): 1,</span>
<span class="go"> (0, 2): 2,</span>
<span class="go"> (0, 3): 3,</span>
<span class="go"> (1, 1): 4,</span>
<span class="go"> (1, 2): 5,</span>
<span class="go"> (1, 3): 6,</span>
<span class="go"> (2, 0): 7,</span>
<span class="go"> (2, 1): 8,</span>
<span class="go"> (2, 2): 9,</span>
<span class="go"> (3, 0): 10,</span>
<span class="go"> (3, 1): 11,</span>
<span class="go"> (3, 3): 12}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.find_disjoint_mates">
<span class="sig-name descname"><span class="pre">find_disjoint_mates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nr_to_find</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_subtrade</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.find_disjoint_mates" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If allow_subtrade is <code class="docutils literal notranslate"><span class="pre">True</span></code> then we may return a partial
latin square that is <em>not</em> disjoint to <code class="docutils literal notranslate"><span class="pre">self</span></code>. In that case,
use bitrade(P, Q) to get an actual bitrade.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">find_disjoint_mates</span><span class="p">(</span><span class="n">allow_subtrade</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B1</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B0</span><span class="p">,</span> <span class="n">B1</span> <span class="o">=</span> <span class="n">bitrade</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_bitrade</span><span class="p">(</span><span class="n">B0</span><span class="p">,</span> <span class="n">B1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">B0</span><span class="p">)</span>
<span class="go">[-1  1  2 -1]</span>
<span class="go">[-1  2 -1  0]</span>
<span class="go">[-1 -1 -1 -1]</span>
<span class="go">[-1  0  1  2]</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">B1</span><span class="p">)</span>
<span class="go">[-1  2  1 -1]</span>
<span class="go">[-1  0 -1  2]</span>
<span class="go">[-1 -1 -1 -1]</span>
<span class="go">[-1  1  2  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.gcs">
<span class="sig-name descname"><span class="pre">gcs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.gcs" title="Permalink to this definition">¶</a></dt>
<dd><p>A greedy critical set of a latin square self is found by
successively removing elements in a row-wise (bottom-up) manner,
checking for unique completion at each step.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gcs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[0 1 2 3 4 5 6 7]</span>
<span class="go">[1 0 3 2 5 4 7 6]</span>
<span class="go">[2 3 0 1 6 7 4 5]</span>
<span class="go">[3 2 1 0 7 6 5 4]</span>
<span class="go">[4 5 6 7 0 1 2 3]</span>
<span class="go">[5 4 7 6 1 0 3 2]</span>
<span class="go">[6 7 4 5 2 3 0 1]</span>
<span class="go">[7 6 5 4 3 2 1 0]</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[ 0  1  2  3  4  5  6 -1]</span>
<span class="go">[ 1  0  3  2  5  4 -1 -1]</span>
<span class="go">[ 2  3  0  1  6 -1  4 -1]</span>
<span class="go">[ 3  2  1  0 -1 -1 -1 -1]</span>
<span class="go">[ 4  5  6 -1  0  1  2 -1]</span>
<span class="go">[ 5  4 -1 -1  1  0 -1 -1]</span>
<span class="go">[ 6 -1  4 -1  2 -1  0 -1]</span>
<span class="go">[-1 -1 -1 -1 -1 -1 -1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_completable">
<span class="sig-name descname"><span class="pre">is_completable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_completable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the partial latin square can be completed to a
latin square.</p>
<p>EXAMPLES:</p>
<p>The following partial latin square has no completion because there
is nowhere that we can place the symbol 0 in the third row:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span>
<span class="go">[ 0 -1 -1]</span>
<span class="go">[-1  0 -1]</span>
<span class="go">[-1 -1  1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_completable</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_completable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_empty_column">
<span class="sig-name descname"><span class="pre">is_empty_column</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_empty_column" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if column c of the partial latin square self is empty.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_empty_column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_empty_column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_empty_row">
<span class="sig-name descname"><span class="pre">is_empty_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_empty_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if row r of the partial latin square self is empty.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_empty_row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_empty_row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_latin_square">
<span class="sig-name descname"><span class="pre">is_latin_square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_latin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>self is a latin square if it is an n by n matrix, and each symbol
in [0, 1, …, n-1] appears exactly once in each row, and exactly
once in each column.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_latin_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forward_circulant</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">is_latin_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_partial_latin_square">
<span class="sig-name descname"><span class="pre">is_partial_latin_square</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_partial_latin_square" title="Permalink to this definition">¶</a></dt>
<dd><p>self is a partial latin square if it is an n by n matrix, and each
symbol in [0, 1, …, n-1] appears at most once in each row, and at
most once in each column.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_partial_latin_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcs</span><span class="p">()</span><span class="o">.</span><span class="n">is_partial_latin_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_partial_latin_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.is_uniquely_completable">
<span class="sig-name descname"><span class="pre">is_uniquely_completable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.is_uniquely_completable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if the partial latin square self has exactly one
completion to a latin square. This is just a wrapper for the
current best-known algorithm, Dancing Links by Knuth. See
dancing_links.spyx</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">gcs</span><span class="p">()</span><span class="o">.</span><span class="n">is_uniquely_completable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_uniquely_completable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">is_uniquely_completable</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.latex">
<span class="sig-name descname"><span class="pre">latex</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return LaTeX code for the latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">latex</span><span class="p">())</span>
<span class="go">\begin{array}{|c|c|c|}\hline 0 &amp; 1 &amp; 2\\\hline 1 &amp; 2 &amp; 0\\\hline 2 &amp; 0 &amp; 1\\\hline\end{array}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.list">
<span class="sig-name descname"><span class="pre">list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the latin square into a list, in a row-wise manner.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[0, 1, 2, 1, 2, 0, 2, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.ncols">
<span class="sig-name descname"><span class="pre">ncols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.ncols" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of columns in the latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.nr_distinct_symbols">
<span class="sig-name descname"><span class="pre">nr_distinct_symbols</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.nr_distinct_symbols" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of distinct symbols in the partial latin square
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nr_distinct_symbols</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">nr_distinct_symbols</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">nr_distinct_symbols</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.nr_filled_cells">
<span class="sig-name descname"><span class="pre">nr_filled_cells</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.nr_filled_cells" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of filled cells (i.e. cells with a positive
value) in the partial latin square self.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">LatinSquare</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span><span class="o">.</span><span class="n">nr_filled_cells</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.nrows">
<span class="sig-name descname"><span class="pre">nrows</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.nrows" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of rows in the latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.permissable_values">
<span class="sig-name descname"><span class="pre">permissable_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.permissable_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all values that do not appear in row r and column c of the
latin square self. If self[r, c] is filled then we return the empty
list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - LatinSquare</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">r</span></code> - int; row of the latin square</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> - int; column of the latin square</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">permissable_values</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.random_empty_cell">
<span class="sig-name descname"><span class="pre">random_empty_cell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.random_empty_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an empty cell of self, uniformly at random.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - LatinSquare</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">[r,</span> <span class="pre">c]</span></code> - cell such that self[r, c] is empty, or returns
None if self is a (full) latin square.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">random_empty_cell</span><span class="p">()</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.row">
<span class="sig-name descname"><span class="pre">row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.row" title="Permalink to this definition">¶</a></dt>
<dd><p>Return row x of the latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 1, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.set_immutable">
<span class="sig-name descname"><span class="pre">set_immutable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.set_immutable" title="Permalink to this definition">¶</a></dt>
<dd><p>A latin square is immutable if the underlying matrix is immutable.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">L</span> <span class="p">:</span> <span class="mi">0</span><span class="p">}</span>   <span class="c1"># this would fail without set_immutable()</span>
<span class="go">{[0 1]</span>
<span class="go">[2 3]: 0}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.top_left_empty_cell">
<span class="sig-name descname"><span class="pre">top_left_empty_cell</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.top_left_empty_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the least [r, c] such that self[r, c] is an empty cell. If
all cells are filled then we return None.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> - LatinSquare</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">top_left_empty_cell</span><span class="p">()</span>
<span class="go">[3, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.vals_in_col">
<span class="sig-name descname"><span class="pre">vals_in_col</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.vals_in_col" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary with key e if and only if column c of self has
the symbol e.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">vals_in_col</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: True, 1: True, 2: True}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare.vals_in_row">
<span class="sig-name descname"><span class="pre">vals_in_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare.vals_in_row" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary with key e if and only if row r of self has
the symbol e.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">vals_in_row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: True, 1: True, 2: True}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.LatinSquare_generator">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">LatinSquare_generator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_assertions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.LatinSquare_generator" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator for a sequence of uniformly distributed latin squares,
given L_start as the initial latin square.</p>
<p>This code implements
the Markov chain algorithm of Jacobson and Matthews (1996), see
below for the BibTex entry. This generator will never throw the
<code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception, so it provides an infinite sequence of
latin squares.</p>
<p>EXAMPLES:</p>
<p>Use the back circulant latin square of order 4 as the initial
square and print the next two latin squares given by the Markov
chain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">LatinSquare_generator</span><span class="p">(</span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">is_latin_square</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<dl class="citation">
<dt class="label" id="jacmat96"><span class="brackets">JacMat96</span></dt>
<dd><p>Mark T. Jacobson and Peter Matthews, “Generating uniformly
distributed random Latin squares”, Journal of Combinatorial Designs,
4 (1996)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.alternating_group_bitrade_generators">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">alternating_group_bitrade_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.alternating_group_bitrade_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct generators a, b, c for the alternating group on 3m+1
points, such that a*b*c = 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="go">((1,2,3), (1,4,2), (2,4,3), Permutation Group with generators [(1,2,3), (1,4,2)])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="o">*</span><span class="n">c</span>
<span class="go">()</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0 -1  3  1]</span>
<span class="go">[-1  1  0  2]</span>
<span class="go">[ 1  3  2 -1]</span>
<span class="go">[ 2  0 -1  3]</span>
<span class="gp">sage: </span><span class="n">T2</span>
<span class="go">[ 1 -1  0  3]</span>
<span class="go">[-1  0  2  1]</span>
<span class="go">[ 2  1  3 -1]</span>
<span class="go">[ 0  3 -1  2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.back_circulant">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">back_circulant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.back_circulant" title="Permalink to this definition">¶</a></dt>
<dd><p>The back-circulant latin square of order n is the Cayley table for
(Z_n, +), the integers under addition modulo n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – int; order of the latin square.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[0 1 2 3 4]</span>
<span class="go">[1 2 3 4 0]</span>
<span class="go">[2 3 4 0 1]</span>
<span class="go">[3 4 0 1 2]</span>
<span class="go">[4 0 1 2 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.beta1">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">beta1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.beta1" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique (x, c, e) in T2 such that (r, c, e) is in T1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rce</span></code> - tuple (or list) (r, c, e) in T1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T1,</span> <span class="pre">T2</span></code> - latin bitrade</p></li>
</ul>
<p>OUTPUT: (x, c, e) in T2.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">beta1</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">(1, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.beta2">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">beta2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.beta2" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique (r, x, e) in T2 such that (r, c, e) is in T1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rce</span></code> - tuple (or list) (r, c, e) in T1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T1,</span> <span class="pre">T2</span></code> - latin bitrade</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>(r, x, e) in T2.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">beta2</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">(0, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.beta3">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">beta3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rce</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.beta3" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique (r, c, x) in T2 such that (r, c, e) is in T1.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">rce</span></code> - tuple (or list) (r, c, e) in T1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T1,</span> <span class="pre">T2</span></code> - latin bitrade</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>(r, c, x) in T2.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">beta3</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">(0, 0, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.bitrade">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">bitrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.bitrade" title="Permalink to this definition">¶</a></dt>
<dd><p>Form the bitrade (Q1, Q2) from (T1, T2) by setting empty the cells
(r, c) such that T1[r, c] == T2[r, c].</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">B1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">beta</span>  <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B2</span> <span class="o">=</span> <span class="n">B1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span> <span class="o">=</span> <span class="n">bitrade</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0  1 -1  3  4]</span>
<span class="go">[ 1 -1 -1  4  0]</span>
<span class="go">[ 2 -1  4  0  1]</span>
<span class="go">[ 3  4  0  1  2]</span>
<span class="go">[ 4  0  1  2  3]</span>
<span class="gp">sage: </span><span class="n">T2</span>
<span class="go">[ 3  4 -1  0  1]</span>
<span class="go">[ 0 -1 -1  1  4]</span>
<span class="go">[ 1 -1  0  4  2]</span>
<span class="go">[ 4  0  1  2  3]</span>
<span class="go">[ 2  1  4  3  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.bitrade_from_group">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">bitrade_from_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.bitrade_from_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Given group elements a, b, c in G such that abc = 1 and the
subgroups a, b, c intersect (pairwise) only in the identity,
construct a bitrade (T1, T2) where rows, columns, and symbols
correspond to cosets of a, b, and c, respectively.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0 -1  3  1]</span>
<span class="go">[-1  1  0  2]</span>
<span class="go">[ 1  3  2 -1]</span>
<span class="go">[ 2  0 -1  3]</span>
<span class="gp">sage: </span><span class="n">T2</span>
<span class="go">[ 1 -1  0  3]</span>
<span class="go">[-1  0  2  1]</span>
<span class="go">[ 2  1  3 -1]</span>
<span class="go">[ 0  3 -1  2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.cells_map_as_square">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">cells_map_as_square</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cells_map</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.cells_map_as_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a LatinSquare with cells numbered from 1, 2, … to given
the dictionary cells_map.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value n should be the maximum of the number of rows and
columns of the original partial latin square</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0 -1  3  1]</span>
<span class="go">[-1  1  0  2]</span>
<span class="go">[ 1  3  2 -1]</span>
<span class="go">[ 2  0 -1  3]</span>
</pre></div>
</div>
<p>There are 12 filled cells in T:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cells_map_as_square</span><span class="p">(</span><span class="n">T1</span><span class="o">.</span><span class="n">filled_cells_map</span><span class="p">(),</span> <span class="nb">max</span><span class="p">(</span><span class="n">T1</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">T1</span><span class="o">.</span><span class="n">ncols</span><span class="p">()))</span>
<span class="go">[ 1 -1  2  3]</span>
<span class="go">[-1  4  5  6]</span>
<span class="go">[ 7  8  9 -1]</span>
<span class="go">[10 11 -1 12]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.check_bitrade_generators">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">check_bitrade_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.check_bitrade_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Three group elements a, b, c will generate a bitrade if a*b*c = 1
and the subgroups a, b, c intersect (pairwise) in just the
identity.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span> <span class="o">=</span> <span class="n">p3_group_bitrade_generators</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">check_bitrade_generators</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">check_bitrade_generators</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">gap</span><span class="p">(</span><span class="s1">&#39;()&#39;</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.coin">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">coin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.coin" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate a fair coin (returns True or False) using
ZZ.random_element(2).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="n">coin</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">coin</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.column_containing_sym">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">column_containing_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.column_containing_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an improper latin square L with L[r, c1] = L[r, c2] = x,
return c1 or c2 with equal probability. This is an internal
function and should only be used in LatinSquare_generator().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[1 0 2 3]</span>
<span class="go">[0 2 3 0]</span>
<span class="go">[2 3 0 1]</span>
<span class="go">[3 0 1 2]</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">column_containing_sym</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.direct_product">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">direct_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L4</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.direct_product" title="Permalink to this definition">¶</a></dt>
<dd><p>The ‘direct product’ of four latin squares L1, L2, L3, L4 of order
n is the latin square of order 2n consisting of</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gt">-----------</span>
<span class="o">|</span> <span class="n">L1</span> <span class="o">|</span> <span class="n">L2</span> <span class="o">|</span>
<span class="gt">-----------</span>
<span class="o">|</span> <span class="n">L3</span> <span class="o">|</span> <span class="n">L4</span> <span class="o">|</span>
<span class="gt">-----------</span>
</pre></div>
</div>
<p>where the subsquares L2 and L3 have entries offset by n.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">direct_product</span><span class="p">(</span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[0 1 2 3 4 5 6 7]</span>
<span class="go">[1 2 3 0 5 6 7 4]</span>
<span class="go">[2 3 0 1 6 7 4 5]</span>
<span class="go">[3 0 1 2 7 4 5 6]</span>
<span class="go">[4 5 6 7 0 1 2 3]</span>
<span class="go">[5 4 7 6 1 0 3 2]</span>
<span class="go">[6 7 4 5 2 3 0 1]</span>
<span class="go">[7 6 5 4 3 2 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.dlxcpp_find_completions">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">dlxcpp_find_completions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nr_to_find</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.dlxcpp_find_completions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all latin squares L of the same order as P such
that P is contained in L. The optional parameter nr_to_find
limits the number of latin squares that are found.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">dlxcpp_find_completions</span><span class="p">(</span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[[0 1]</span>
<span class="go">[1 0], [1 0]</span>
<span class="go">[0 1]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dlxcpp_find_completions</span><span class="p">(</span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[[0 1]</span>
<span class="go">[1 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.dlxcpp_rows_and_map">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">dlxcpp_rows_and_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">P</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.dlxcpp_rows_and_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal function for <code class="docutils literal notranslate"><span class="pre">dlxcpp_find_completions</span></code>. Given a partial
latin square P we construct a list of rows of a 0-1 matrix M such
that an exact cover of M corresponds to a completion of P to a
latin square.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">dlxcpp_rows_and_map</span><span class="p">(</span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">([[0, 4, 8],</span>
<span class="go">  [1, 5, 8],</span>
<span class="go">  [2, 4, 9],</span>
<span class="go">  [3, 5, 9],</span>
<span class="go">  [0, 6, 10],</span>
<span class="go">  [1, 7, 10],</span>
<span class="go">  [2, 6, 11],</span>
<span class="go">  [3, 7, 11]],</span>
<span class="go"> {(0, 4, 8): (0, 0, 0),</span>
<span class="go">  (0, 6, 10): (1, 0, 0),</span>
<span class="go">  (1, 5, 8): (0, 0, 1),</span>
<span class="go">  (1, 7, 10): (1, 0, 1),</span>
<span class="go">  (2, 4, 9): (0, 1, 0),</span>
<span class="go">  (2, 6, 11): (1, 1, 0),</span>
<span class="go">  (3, 5, 9): (0, 1, 1),</span>
<span class="go">  (3, 7, 11): (1, 1, 1)})</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.elementary_abelian_2group">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">elementary_abelian_2group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.elementary_abelian_2group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the latin square based on the Cayley table for the
elementary abelian 2-group of order 2s.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – int; order of the latin square will be 2s.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[0 1 2 3 4 5 6 7]</span>
<span class="go">[1 0 3 2 5 4 7 6]</span>
<span class="go">[2 3 0 1 6 7 4 5]</span>
<span class="go">[3 2 1 0 7 6 5 4]</span>
<span class="go">[4 5 6 7 0 1 2 3]</span>
<span class="go">[5 4 7 6 1 0 3 2]</span>
<span class="go">[6 7 4 5 2 3 0 1]</span>
<span class="go">[7 6 5 4 3 2 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.forward_circulant">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">forward_circulant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.forward_circulant" title="Permalink to this definition">¶</a></dt>
<dd><p>The forward-circulant latin square of order n is the Cayley table
for the operation r + c = (n-c+r) mod n.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> – int; order of the latin square.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">forward_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[0 4 3 2 1]</span>
<span class="go">[1 0 4 3 2]</span>
<span class="go">[2 1 0 4 3]</span>
<span class="go">[3 2 1 0 4]</span>
<span class="go">[4 3 2 1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.genus">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">genus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.genus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the genus of hypermap embedding associated with the bitrade
(T1, T2).</p>
<p>Informally, we compute the [tau_1, tau_2, tau_3]
permutation representation of the bitrade. Each cycle of tau_1,
tau_2, and tau_3 gives a rotation scheme for a black, white, and
star vertex (respectively). The genus then comes from Euler’s
formula.</p>
<p>For more details see Carlo Hamalainen: <em>Partitioning
3-homogeneous latin bitrades</em>. To appear in Geometriae Dedicata,
available at <a class="reference external" href="https://arxiv.org/abs/0710.0938">arXiv 0710.0938</a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">alternating_group_bitrade_generators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">genus</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">pq_group_bitrade_generators</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">genus</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.group_to_LatinSquare">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">group_to_LatinSquare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.group_to_LatinSquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a latin square on the symbols [0, 1, …, n-1] for a
group with an n by n Cayley table.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="n">group_to_LatinSquare</span>

<span class="gp">sage: </span><span class="n">group_to_LatinSquare</span><span class="p">(</span><span class="n">DihedralGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[0 1 2 3]</span>
<span class="go">[1 0 3 2]</span>
<span class="go">[2 3 0 1]</span>
<span class="go">[3 2 1 0]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">gap</span><span class="o">.</span><span class="n">Group</span><span class="p">(</span><span class="n">PermutationGroupElement</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">group_to_LatinSquare</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">[0 1 2]</span>
<span class="go">[1 2 0]</span>
<span class="go">[2 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.is_bitrade">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">is_bitrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.is_bitrade" title="Permalink to this definition">¶</a></dt>
<dd><p>Combinatorially, a pair (T1, T2) of partial latin squares is a
bitrade if they are disjoint, have the same shape, and have row and
column balance. For definitions of each of these terms see the
relevant function in this file.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.is_disjoint">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">is_disjoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.is_disjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>The partial latin squares T1 and T2 are disjoint if T1[r, c] !=
T2[r, c] or T1[r, c] == T2[r, c] == -1 for each cell [r, c].</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="n">is_disjoint</span><span class="p">,</span> <span class="n">back_circulant</span><span class="p">,</span> <span class="n">isotopism</span>
<span class="gp">sage: </span><span class="n">is_disjoint</span><span class="p">(</span><span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_disjoint</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.is_primary_bitrade">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">is_primary_bitrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.is_primary_bitrade" title="Permalink to this definition">¶</a></dt>
<dd><p>A bitrade generated from elements a, b, c is primary if a, b, c =
G.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">p3_group_bitrade_generators</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_primary_bitrade</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.is_row_and_col_balanced">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">is_row_and_col_balanced</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.is_row_and_col_balanced" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial latin squares T1 and T2 are balanced if the symbols
appearing in row r of T1 are the same as the symbols appearing in
row r of T2, for each r, and if the same condition holds on
columns.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">is_row_and_col_balanced</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">is_row_and_col_balanced</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.is_same_shape">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">is_same_shape</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.is_same_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Two partial latin squares T1, T2 have the same shape if T1[r, c] =
0 if and only if T2[r, c] = 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">is_same_shape</span><span class="p">(</span><span class="n">elementary_abelian_2group</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_same_shape</span><span class="p">(</span><span class="n">LatinSquare</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_same_shape</span><span class="p">(</span><span class="n">forward_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">LatinSquare</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.isotopism">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">isotopism</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.isotopism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Permutation object that represents an isotopism (for rows,
columns or symbols of a partial latin square).</p>
<p>Technically, all this function does is take as input a
representation of a permutation of <span class="math notranslate nohighlight">\(0,...,n-1\)</span> and return a
<a class="reference internal" href="../permutation.html#sage.combinat.permutation.Permutation" title="sage.combinat.permutation.Permutation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Permutation</span></code></a> object defined on <span class="math notranslate nohighlight">\(1,...,n\)</span>.</p>
<p>For a definition of isotopism, see the <a class="reference external" href="https://en.wikipedia.org/wiki/Latin_square#Equivalence_classes_of_Latin_squares">wikipedia section on
isotopism</a>.</p>
<p>INPUT:</p>
<p>According to the type of input (see examples below):</p>
<ul class="simple">
<li><p>an integer <span class="math notranslate nohighlight">\(n\)</span> – the function returns the identity on <span class="math notranslate nohighlight">\(1,...,n\)</span>.</p></li>
<li><p>a string representing a permutation in disjoint cycles notation,
e.g. <span class="math notranslate nohighlight">\((0,1,2)(3,4,5)\)</span> – the corresponding permutation is returned,
shifted by 1 to act on <span class="math notranslate nohighlight">\(1,...,n\)</span>.</p></li>
<li><p>list/tuple of tuples – assumes disjoint cycle notation, see previous
entry.</p></li>
<li><p>a list of integers – the function adds <span class="math notranslate nohighlight">\(1\)</span> to each member of the
list, and returns the corresponding permutation.</p></li>
<li><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">PermutationGroupElement</span></code> <code class="docutils literal notranslate"><span class="pre">p</span></code> – returns a permutation
describing <code class="docutils literal notranslate"><span class="pre">p</span></code> <strong>without</strong> any shift.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity on 5 points</span>
<span class="go">[1, 2, 3, 4, 5]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">PermutationGroup</span><span class="p">([</span><span class="s1">&#39;(1,2,3)(4,5)&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isotopism</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[2, 3, 1, 5, 4]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isotopism</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># 0 goes to 0, 1 goes to 3, etc.</span>
<span class="go">[1, 4, 3, 2]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span> <span class="c1"># single cycle, presented as a tuple</span>
<span class="go">[2, 3, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="p">)</span> <span class="c1"># tuple of cycles</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">[2, 3, 1, 5, 4]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 2, 3), (4, 5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.next_conjugate">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">next_conjugate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.next_conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Permute L[r, c] = e to the conjugate L[c, e] = r.</p>
<p>We assume that L is an n by n matrix and has values in the range 0,
1, …, n-1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[0 1 2 3 4 5]</span>
<span class="go">[1 2 3 4 5 0]</span>
<span class="go">[2 3 4 5 0 1]</span>
<span class="go">[3 4 5 0 1 2]</span>
<span class="go">[4 5 0 1 2 3]</span>
<span class="go">[5 0 1 2 3 4]</span>
<span class="gp">sage: </span><span class="n">next_conjugate</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">[0 1 2 3 4 5]</span>
<span class="go">[5 0 1 2 3 4]</span>
<span class="go">[4 5 0 1 2 3]</span>
<span class="go">[3 4 5 0 1 2]</span>
<span class="go">[2 3 4 5 0 1]</span>
<span class="go">[1 2 3 4 5 0]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">==</span> <span class="n">next_conjugate</span><span class="p">(</span><span class="n">next_conjugate</span><span class="p">(</span><span class="n">next_conjugate</span><span class="p">(</span><span class="n">L</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.p3_group_bitrade_generators">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">p3_group_bitrade_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.p3_group_bitrade_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Generators for a group of order p3 where p is a prime.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">p3_group_bitrade_generators</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((2,6,7)(3,8,9), (1,2,3)(4,7,8)(5,6,9), (1,9,2)(3,7,4)(5,8,6), Permutation Group with generators [(2,6,7)(3,8,9), (1,2,3)(4,7,8)(5,6,9)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.pq_group_bitrade_generators">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">pq_group_bitrade_generators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.pq_group_bitrade_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Generators for a group of order pq where p and q are primes such
that (q % p) == 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">pq_group_bitrade_generators</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">((2,3,5)(4,7,6), (1,2,3,4,5,6,7), (1,4,2)(3,5,6), Permutation Group with generators [(2,3,5)(4,7,6), (1,2,3,4,5,6,7)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.row_containing_sym">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">row_containing_sym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.row_containing_sym" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an improper latin square L with L[r1, c] = L[r2, c] = x,
return r1 or r2 with equal probability. This is an internal
function and should only be used in LatinSquare_generator().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[0 1 0 3]</span>
<span class="go">[3 0 2 1]</span>
<span class="go">[1 0 3 2]</span>
<span class="go">[2 3 1 0]</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">row_containing_sym</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.tau1">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">tau1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.tau1" title="Permalink to this definition">¶</a></dt>
<dd><p>The definition of <span class="math notranslate nohighlight">\(\tau_1\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tau_1 : T1 \rightarrow T1 \\
\tau_1 = \beta_2^{-1} \beta_3\end{split}\]</div>
<p>where the composition is left to right and <span class="math notranslate nohighlight">\(\beta_i : T2 \rightarrow T1\)</span>
changes just the <span class="math notranslate nohighlight">\(i^{th}\)</span> coordinate of a triple.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">cells_map</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tau123</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t1</span> <span class="o">=</span> <span class="n">tau1</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">cells_map</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t1</span>
<span class="go">[2, 3, 4, 5, 1, 7, 8, 9, 10, 6, 12, 13, 14, 15, 11, 17, 18, 19, 20, 16, 22, 23, 24, 25, 21]</span>
<span class="gp">sage: </span><span class="n">t1</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 2, 3, 4, 5), (6, 7, 8, 9, 10), (11, 12, 13, 14, 15), (16, 17, 18, 19, 20), (21, 22, 23, 24, 25)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.tau123">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">tau123</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.tau123" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the tau_i representation for a bitrade (T1, T2).</p>
<p>See the
functions tau1, tau2, and tau3 for the mathematical definitions.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>(cells_map, t1, t2, t3)</p></li>
</ul>
<p>where cells_map is a map to/from the filled cells of T1, and t1,
t2, t3 are the tau1, tau2, tau3 permutations.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span> <span class="o">=</span> <span class="n">pq_group_bitrade_generators</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span> <span class="o">=</span> <span class="n">bitrade_from_group</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T1</span>
<span class="go">[ 0  1  3 -1 -1 -1 -1]</span>
<span class="go">[ 1  2  4 -1 -1 -1 -1]</span>
<span class="go">[ 2  3  5 -1 -1 -1 -1]</span>
<span class="go">[ 3  4  6 -1 -1 -1 -1]</span>
<span class="go">[ 4  5  0 -1 -1 -1 -1]</span>
<span class="go">[ 5  6  1 -1 -1 -1 -1]</span>
<span class="go">[ 6  0  2 -1 -1 -1 -1]</span>
<span class="gp">sage: </span><span class="n">T2</span>
<span class="go">[ 1  3  0 -1 -1 -1 -1]</span>
<span class="go">[ 2  4  1 -1 -1 -1 -1]</span>
<span class="go">[ 3  5  2 -1 -1 -1 -1]</span>
<span class="go">[ 4  6  3 -1 -1 -1 -1]</span>
<span class="go">[ 5  0  4 -1 -1 -1 -1]</span>
<span class="go">[ 6  1  5 -1 -1 -1 -1]</span>
<span class="go">[ 0  2  6 -1 -1 -1 -1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">cells_map</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tau123</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">cells_map</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">}</span>
<span class="go">{1: (0, 0),</span>
<span class="go"> 2: (0, 1),</span>
<span class="go"> 3: (0, 2),</span>
<span class="go"> 4: (1, 0),</span>
<span class="go"> 5: (1, 1),</span>
<span class="go"> 6: (1, 2),</span>
<span class="go"> 7: (2, 0),</span>
<span class="go"> 8: (2, 1),</span>
<span class="go"> 9: (2, 2),</span>
<span class="go"> 10: (3, 0),</span>
<span class="go"> 11: (3, 1),</span>
<span class="go"> 12: (3, 2),</span>
<span class="go"> 13: (4, 0),</span>
<span class="go"> 14: (4, 1),</span>
<span class="go"> 15: (4, 2),</span>
<span class="go"> 16: (5, 0),</span>
<span class="go"> 17: (5, 1),</span>
<span class="go"> 18: (5, 2),</span>
<span class="go"> 19: (6, 0),</span>
<span class="go"> 20: (6, 1),</span>
<span class="go"> 21: (6, 2)}</span>
<span class="gp">sage: </span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ZZ</span><span class="p">}</span>
<span class="go">{(0, 0): 1,</span>
<span class="go"> (0, 1): 2,</span>
<span class="go"> (0, 2): 3,</span>
<span class="go"> (1, 0): 4,</span>
<span class="go"> (1, 1): 5,</span>
<span class="go"> (1, 2): 6,</span>
<span class="go"> (2, 0): 7,</span>
<span class="go"> (2, 1): 8,</span>
<span class="go"> (2, 2): 9,</span>
<span class="go"> (3, 0): 10,</span>
<span class="go"> (3, 1): 11,</span>
<span class="go"> (3, 2): 12,</span>
<span class="go"> (4, 0): 13,</span>
<span class="go"> (4, 1): 14,</span>
<span class="go"> (4, 2): 15,</span>
<span class="go"> (5, 0): 16,</span>
<span class="go"> (5, 1): 17,</span>
<span class="go"> (5, 2): 18,</span>
<span class="go"> (6, 0): 19,</span>
<span class="go"> (6, 1): 20,</span>
<span class="go"> (6, 2): 21}</span>
<span class="gp">sage: </span><span class="n">cells_map_as_square</span><span class="p">(</span><span class="n">cells_map</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">T1</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">T1</span><span class="o">.</span><span class="n">ncols</span><span class="p">()))</span>
<span class="go">[ 1  2  3 -1 -1 -1 -1]</span>
<span class="go">[ 4  5  6 -1 -1 -1 -1]</span>
<span class="go">[ 7  8  9 -1 -1 -1 -1]</span>
<span class="go">[10 11 12 -1 -1 -1 -1]</span>
<span class="go">[13 14 15 -1 -1 -1 -1]</span>
<span class="go">[16 17 18 -1 -1 -1 -1]</span>
<span class="go">[19 20 21 -1 -1 -1 -1]</span>
<span class="gp">sage: </span><span class="n">t1</span>
<span class="go">[3, 1, 2, 6, 4, 5, 9, 7, 8, 12, 10, 11, 15, 13, 14, 18, 16, 17, 21, 19, 20]</span>
<span class="gp">sage: </span><span class="n">t2</span>
<span class="go">[4, 8, 15, 7, 11, 18, 10, 14, 21, 13, 17, 3, 16, 20, 6, 19, 2, 9, 1, 5, 12]</span>
<span class="gp">sage: </span><span class="n">t3</span>
<span class="go">[20, 18, 10, 2, 21, 13, 5, 3, 16, 8, 6, 19, 11, 9, 1, 14, 12, 4, 17, 15, 7]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t1</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 3, 2), (4, 6, 5), (7, 9, 8), (10, 12, 11), (13, 15, 14), (16, 18, 17), (19, 21, 20)]</span>
<span class="gp">sage: </span><span class="n">t2</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 4, 7, 10, 13, 16, 19), (2, 8, 14, 20, 5, 11, 17), (3, 15, 6, 18, 9, 21, 12)]</span>
<span class="gp">sage: </span><span class="n">t3</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 20, 15), (2, 18, 4), (3, 10, 8), (5, 21, 7), (6, 13, 11), (9, 16, 14), (12, 19, 17)]</span>
</pre></div>
</div>
<p>The product t1*t2*t3 is the identity, i.e. it fixes every point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">((</span><span class="n">t1</span><span class="o">*</span><span class="n">t2</span><span class="o">*</span><span class="n">t3</span><span class="p">)</span><span class="o">.</span><span class="n">fixed_points</span><span class="p">())</span> <span class="o">==</span> <span class="n">T1</span><span class="o">.</span><span class="n">nr_filled_cells</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.tau2">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">tau2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.tau2" title="Permalink to this definition">¶</a></dt>
<dd><p>The definition of <span class="math notranslate nohighlight">\(\tau_2\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tau_2 : T1 \rightarrow T1 \\
\tau_2 = \beta_3^{-1} \beta_1\end{split}\]</div>
<p>where the composition is left to right and <span class="math notranslate nohighlight">\(\beta_i : T2 \rightarrow T1\)</span>
changes just the <span class="math notranslate nohighlight">\(i^{th}\)</span> coordinate of a triple.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">cells_map</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tau123</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t2</span> <span class="o">=</span> <span class="n">tau2</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">cells_map</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t2</span>
<span class="go">[21, 22, 23, 24, 25, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]</span>
<span class="gp">sage: </span><span class="n">t2</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 21, 16, 11, 6), (2, 22, 17, 12, 7), (3, 23, 18, 13, 8), (4, 24, 19, 14, 9), (5, 25, 20, 15, 10)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.tau3">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">tau3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cells_map</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.tau3" title="Permalink to this definition">¶</a></dt>
<dd><p>The definition of <span class="math notranslate nohighlight">\(\tau_3\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tau_3 : T1 \rightarrow T1 \\
\tau_3 = \beta_1^{-1} \beta_2\end{split}\]</div>
<p>where the composition is left to right and <span class="math notranslate nohighlight">\(\beta_i : T2 \rightarrow T1\)</span>
changes just the <span class="math notranslate nohighlight">\(i^{th}\)</span> coordinate of a triple.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_bitrade</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">cells_map</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span> <span class="o">=</span> <span class="n">tau123</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t3</span> <span class="o">=</span> <span class="n">tau3</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">cells_map</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t3</span>
<span class="go">[10, 6, 7, 8, 9, 15, 11, 12, 13, 14, 20, 16, 17, 18, 19, 25, 21, 22, 23, 24, 5, 1, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">t3</span><span class="o">.</span><span class="n">to_cycles</span><span class="p">()</span>
<span class="go">[(1, 10, 14, 18, 22), (2, 6, 15, 19, 23), (3, 7, 11, 20, 24), (4, 8, 12, 16, 25), (5, 9, 13, 17, 21)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.combinat.matrices.latin.tau_to_bitrade">
<span class="sig-prename descclassname"><span class="pre">sage.combinat.matrices.latin.</span></span><span class="sig-name descname"><span class="pre">tau_to_bitrade</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.latin.tau_to_bitrade" title="Permalink to this definition">¶</a></dt>
<dd><p>Given permutations t1, t2, t3 that represent a latin bitrade,
convert them to an explicit latin bitrade (T1, T2). The result is
unique up to isotopism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.latin</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">sage: </span><span class="n">T1</span> <span class="o">=</span> <span class="n">back_circulant</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">isotopism</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># identity</span>
<span class="gp">sage: </span><span class="n">T2</span> <span class="o">=</span> <span class="n">T1</span><span class="o">.</span><span class="n">apply_isotopism</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">tau123</span><span class="p">(</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U1</span><span class="p">,</span> <span class="n">U2</span> <span class="o">=</span> <span class="n">tau_to_bitrade</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_bitrade</span><span class="p">(</span><span class="n">U1</span><span class="p">,</span> <span class="n">U2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U1</span>
<span class="go">[0 1 2 3 4]</span>
<span class="go">[1 2 3 4 0]</span>
<span class="go">[2 3 4 0 1]</span>
<span class="go">[3 4 0 1 2]</span>
<span class="go">[4 0 1 2 3]</span>
<span class="gp">sage: </span><span class="n">U2</span>
<span class="go">[4 0 1 2 3]</span>
<span class="go">[0 1 2 3 4]</span>
<span class="go">[1 2 3 4 0]</span>
<span class="go">[2 3 4 0 1]</span>
<span class="go">[3 4 0 1 2]</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="hadamard_matrix.html"
                        title="previous chapter">Hadamard matrices</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../misc.html"
                        title="next chapter">Miscellaneous</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/matrices/latin.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../misc.html" title="Miscellaneous"
             >next</a> |</li>
        <li class="right" >
          <a href="hadamard_matrix.html" title="Hadamard matrices"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Latin Squares</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>