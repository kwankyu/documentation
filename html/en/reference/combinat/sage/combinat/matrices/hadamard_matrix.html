
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Hadamard matrices &#8212; Sage Reference Manual v8.3: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Latin Squares" href="latin.html" />
    <link rel="prev" title="Dancing links C++ wrapper" href="dlxcpp.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="latin.html" title="Latin Squares"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dlxcpp.html" title="Dancing links C++ wrapper"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="hadamard-matrices">
<span id="sage-combinat-matrices-hadamard-matrix"></span><h1>Hadamard matrices<a class="headerlink" href="#hadamard-matrices" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.matrices.hadamard_matrix"></span><p>A Hadamard matrix is an <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(H\)</span> whose entries are either <span class="math notranslate nohighlight">\(+1\)</span> or <span class="math notranslate nohighlight">\(-1\)</span>
and whose rows are mutually orthogonal. For example, the matrix <span class="math notranslate nohighlight">\(H_2\)</span>
defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left(\begin{array}{rr}
1 &amp; 1 \\
1 &amp; -1
\end{array}\right)\end{split}\]</div>
<p>is a Hadamard matrix. An <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(H\)</span> whose entries are either <span class="math notranslate nohighlight">\(+1\)</span> or
<span class="math notranslate nohighlight">\(-1\)</span> is a Hadamard matrix if and only if:</p>
<ol class="loweralpha simple">
<li><span class="math notranslate nohighlight">\(|det(H)|=n^{n/2}\)</span> or</li>
<li><span class="math notranslate nohighlight">\(H*H^t = n\cdot I_n\)</span>, where <span class="math notranslate nohighlight">\(I_n\)</span> is the identity matrix.</li>
</ol>
<p>In general, the tensor product of an <span class="math notranslate nohighlight">\(m\times m\)</span> Hadamard matrix and an
<span class="math notranslate nohighlight">\(n\times n\)</span> Hadamard matrix is an <span class="math notranslate nohighlight">\((mn)\times (mn)\)</span> matrix. In
particular, if there is an <span class="math notranslate nohighlight">\(n\times n\)</span> Hadamard matrix then there is a
<span class="math notranslate nohighlight">\((2n)\times (2n)\)</span> Hadamard matrix (since one may tensor with <span class="math notranslate nohighlight">\(H_2\)</span>).
This particular case is sometimes called the Sylvester construction.</p>
<p>The Hadamard conjecture (possibly due to Paley) states that a Hadamard
matrix of order <span class="math notranslate nohighlight">\(n\)</span> exists if and only if <span class="math notranslate nohighlight">\(n= 1, 2\)</span> or <span class="math notranslate nohighlight">\(n\)</span> is a multiple
of <span class="math notranslate nohighlight">\(4\)</span>.</p>
<p>The module below implements the Paley constructions (see for example
<a class="reference internal" href="#hora" id="id1">[Hora]</a>) and the Sylvester construction. It also allows you to pull a
Hadamard matrix from the database at <a class="reference internal" href="#hadasloa" id="id2">[HadaSloa]</a>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Joyner (2009-05-17): initial version</li>
</ul>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="hadasloa" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[HadaSloa]</a></td><td>N.J.A. Sloane’s Library of Hadamard Matrices, at
<a class="reference external" href="http://neilsloane.com/hadamard/">http://neilsloane.com/hadamard/</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hadawiki" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HadaWiki]</td><td>Hadamard matrices on Wikipedia, <a class="reference external" href="https://en.wikipedia.org/wiki/Hadamard_matrix">Wikipedia article Hadamard_matrix</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hora" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Hora]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id7">2</a>, <a class="fn-backref" href="#id8">3</a>)</em> K. J. Horadam, Hadamard Matrices and Their Applications,
Princeton University Press, 2006.</td></tr>
</tbody>
</table>
<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.GS_skew_hadamard_smallcases">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">GS_skew_hadamard_smallcases</code><span class="sig-paren">(</span><em>n</em>, <em>existence=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.GS_skew_hadamard_smallcases" title="Permalink to this definition">¶</a></dt>
<dd><p>Data for Williamson-Goethals-Seidel construction of skew Hadamard matrices</p>
<p>Here we keep the data for this construction.
Namely, it needs 4 circulant matrices with extra properties, as described in
<a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.williamson_goethals_seidel_skew_hadamard_matrix" title="sage.combinat.matrices.hadamard_matrix.williamson_goethals_seidel_skew_hadamard_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.combinat.matrices.hadamard_matrix.williamson_goethals_seidel_skew_hadamard_matrix()</span></code></a>
Matrices for <span class="math notranslate nohighlight">\(n=36\)</span> and <span class="math notranslate nohighlight">\(52\)</span> are given in <a class="reference internal" href="#gs70s" id="id3">[GS70s]</a>. Matrices for <span class="math notranslate nohighlight">\(n=92\)</span> are given
in <a class="reference internal" href="#wall71" id="id4">[Wall71]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – the order of the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">existence</span></code> – if true (default), only check that we can do the construction</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> – if true (default), check the result.</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.RSHCD_324">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">RSHCD_324</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.RSHCD_324" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a size 324x324 Regular Symmetric Hadamard Matrix with Constant Diagonal.</p>
<p>We build the matrix <span class="math notranslate nohighlight">\(M\)</span> for the case <span class="math notranslate nohighlight">\(n=324\)</span>, <span class="math notranslate nohighlight">\(\epsilon=1\)</span> directly from
<a class="reference external" href="../../../../graphs/sage/graphs/graph_generators.html#sage.graphs.graph_generators.GraphGenerators.JankoKharaghaniTonchevGraph" title="(in Sage Reference Manual: Graph Theory v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">JankoKharaghaniTonchevGraph</span></code></a>
and for the case <span class="math notranslate nohighlight">\(\epsilon=-1\)</span> from the “twist” <span class="math notranslate nohighlight">\(M'\)</span> of <span class="math notranslate nohighlight">\(M\)</span>, using Lemma 11
in <a class="reference internal" href="#hx10" id="id5">[HX10]</a>. Namely, it turns out that the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}M'=\begin{pmatrix} M_{12} &amp; M_{11}\\ M_{11}^\top &amp; M_{21} \end{pmatrix},
\quad\text{where}\quad
M=\begin{pmatrix} M_{11} &amp; M_{12}\\ M_{21} &amp; M_{22} \end{pmatrix},\end{split}\]</div>
<p>and the <span class="math notranslate nohighlight">\(M_{ij}\)</span> are 162x162-blocks, also RSHCD, its diagonal blocks having zero row
sums, as needed by [loc.cit.]. Interestingly, the corresponding
<span class="math notranslate nohighlight">\((324,152,70,72)\)</span>-strongly regular graph
has a vertex-transitive automorphism group of order 2592, twice the order of the
(intransitive) automorphism group of the graph corresponding to <span class="math notranslate nohighlight">\(M\)</span>. Cf. <a class="reference internal" href="#cp16" id="id6">[CP16]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">e</span></code> – one of <span class="math notranslate nohighlight">\(-1\)</span> or <span class="math notranslate nohighlight">\(+1\)</span>, equal to the value of <span class="math notranslate nohighlight">\(\epsilon\)</span></li>
</ul>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="cp16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[CP16]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> N. Cohen, D. Pasechnik,
Implementing Brouwer’s database of strongly regular graphs,
Designs, Codes, and Cryptography, 2016
<a class="reference external" href="https://doi.org/10.1007/s10623-016-0264-x">doi:10.1007/s10623-016-0264-x</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.hadamard_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">hadamard_matrix</code><span class="sig-paren">(</span><em>n</em>, <em>existence=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.hadamard_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is available as hadamard_matrix(…) and matrix.hadamard(…).</p>
<p>Tries to construct a Hadamard matrix using a combination of Paley
and Sylvester constructions.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer) – dimension of the matrix</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">existence</span></code> (boolean) – whether to build the matrix or merely query if
a construction is available in Sage. When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the function
returns:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> – meaning that Sage knows how to build the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">Unknown</span></code> – meaning that Sage does not know how to build the
matrix, although the matrix may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> – meaning that the matrix does not exist.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">2985984</span>
<span class="gp">sage: </span><span class="mi">12</span><span class="o">^</span><span class="mi">6</span>
<span class="go">2985984</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 1  1]</span>
<span class="go">[ 1 -1]</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">[ 1  1  1  1  1  1  1  1]</span>
<span class="go">[ 1 -1  1 -1  1 -1  1 -1]</span>
<span class="go">[ 1  1 -1 -1  1  1 -1 -1]</span>
<span class="go">[ 1 -1 -1  1  1 -1 -1  1]</span>
<span class="go">[ 1  1  1  1 -1 -1 -1 -1]</span>
<span class="go">[ 1 -1  1 -1 -1  1 -1  1]</span>
<span class="go">[ 1  1 -1 -1 -1 -1  1  1]</span>
<span class="go">[ 1 -1 -1  1 -1  1  1 -1]</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="o">==</span> <span class="mi">8</span><span class="o">^</span><span class="mi">4</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We note that <a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.hadamard_matrix" title="sage.combinat.matrices.hadamard_matrix.hadamard_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">hadamard_matrix()</span></code></a> returns a normalised Hadamard matrix
(the entries in the first row and column are all +1)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">[ 1  1| 1  1| 1  1| 1  1| 1  1| 1  1]</span>
<span class="go">[ 1 -1|-1  1|-1  1|-1  1|-1  1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1 -1| 1  1|-1 -1|-1 -1| 1  1]</span>
<span class="go">[ 1  1|-1 -1| 1 -1|-1  1|-1  1| 1 -1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1  1| 1 -1| 1  1|-1 -1|-1 -1]</span>
<span class="go">[ 1  1| 1 -1|-1 -1| 1 -1|-1  1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1|-1 -1| 1  1| 1 -1| 1  1|-1 -1]</span>
<span class="go">[ 1  1|-1  1| 1 -1|-1 -1| 1 -1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1|-1 -1|-1 -1| 1  1| 1 -1| 1  1]</span>
<span class="go">[ 1  1|-1  1|-1  1| 1 -1|-1 -1| 1 -1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1  1|-1 -1|-1 -1| 1  1| 1 -1]</span>
<span class="go">[ 1  1| 1 -1|-1  1|-1  1| 1 -1|-1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.hadamard_matrix_paleyI">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">hadamard_matrix_paleyI</code><span class="sig-paren">(</span><em>n</em>, <em>normalize=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.hadamard_matrix_paleyI" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the Paley type I construction.</p>
<p>The Paley type I case corresponds to the case <span class="math notranslate nohighlight">\(p \cong 3 \mod{4}\)</span> for a
prime <span class="math notranslate nohighlight">\(p\)</span> (see <a class="reference internal" href="#hora" id="id7">[Hora]</a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – the matrix size</li>
<li><code class="docutils literal notranslate"><span class="pre">normalize</span></code> (boolean) – whether to normalize the result.</li>
</ul>
<p>EXAMPLES:</p>
<p>We note that this method by default returns a normalised Hadamard matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">hadamard_matrix_paleyI</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix_paleyI</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[ 1  1  1  1]</span>
<span class="go">[ 1 -1  1 -1]</span>
<span class="go">[ 1 -1 -1  1]</span>
<span class="go">[ 1  1 -1 -1]</span>
</pre></div>
</div>
<p>Otherwise, it returns a skew Hadamard matrix <span class="math notranslate nohighlight">\(H\)</span>, i.e. <span class="math notranslate nohighlight">\(H=S+I\)</span>, with
<span class="math notranslate nohighlight">\(S=-S^      op\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">hadamard_matrix_paleyI</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 1  1  1  1]</span>
<span class="go">[-1  1  1 -1]</span>
<span class="go">[-1 -1  1  1]</span>
<span class="go">[-1  1 -1  1]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">=</span><span class="n">M</span><span class="o">-</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="o">-</span><span class="n">S</span><span class="o">==</span><span class="n">S</span><span class="o">.</span><span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.hadamard_matrix_paleyII">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">hadamard_matrix_paleyII</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.hadamard_matrix_paleyII" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the Paley type II construction.</p>
<p>The Paley type II case corresponds to the case <span class="math notranslate nohighlight">\(p \cong 1 \mod{4}\)</span> for a
prime <span class="math notranslate nohighlight">\(p\)</span> (see <a class="reference internal" href="#hora" id="id8">[Hora]</a>).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">matrices</span><span class="o">.</span><span class="n">hadamard_matrix</span><span class="o">.</span><span class="n">hadamard_matrix_paleyII</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">2985984</span>
<span class="gp">sage: </span><span class="mi">12</span><span class="o">^</span><span class="mi">6</span>
<span class="go">2985984</span>
</pre></div>
</div>
<p>We note that the method returns a normalised Hadamard matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">matrices</span><span class="o">.</span><span class="n">hadamard_matrix</span><span class="o">.</span><span class="n">hadamard_matrix_paleyII</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">[ 1  1| 1  1| 1  1| 1  1| 1  1| 1  1]</span>
<span class="go">[ 1 -1|-1  1|-1  1|-1  1|-1  1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1 -1| 1  1|-1 -1|-1 -1| 1  1]</span>
<span class="go">[ 1  1|-1 -1| 1 -1|-1  1|-1  1| 1 -1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1  1| 1 -1| 1  1|-1 -1|-1 -1]</span>
<span class="go">[ 1  1| 1 -1|-1 -1| 1 -1|-1  1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1|-1 -1| 1  1| 1 -1| 1  1|-1 -1]</span>
<span class="go">[ 1  1|-1  1| 1 -1|-1 -1| 1 -1|-1  1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1|-1 -1|-1 -1| 1  1| 1 -1| 1  1]</span>
<span class="go">[ 1  1|-1  1|-1  1| 1 -1|-1 -1| 1 -1]</span>
<span class="go">[-----+-----+-----+-----+-----+-----]</span>
<span class="go">[ 1 -1| 1  1|-1 -1|-1 -1| 1  1| 1 -1]</span>
<span class="go">[ 1  1| 1 -1|-1  1|-1  1| 1 -1|-1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.hadamard_matrix_www">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">hadamard_matrix_www</code><span class="sig-paren">(</span><em>url_file</em>, <em>comments=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.hadamard_matrix_www" title="Permalink to this definition">¶</a></dt>
<dd><p>Pulls file from Sloane’s database and returns the corresponding Hadamard
matrix as a Sage matrix.</p>
<p>You must input a filename of the form “had.n.xxx.txt” as described
on the webpage <a class="reference external" href="http://neilsloane.com/hadamard/">http://neilsloane.com/hadamard/</a>, where
“xxx” could be empty or a number of some characters.</p>
<p>If comments=True then the “Automorphism…” line of the had.n.xxx.txt
file is printed if it exists. Otherwise nothing is done.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">hadamard_matrix_www</span><span class="p">(</span><span class="s2">&quot;had.4.txt&quot;</span><span class="p">)</span>      <span class="c1"># optional - internet</span>
<span class="go">[ 1  1  1  1]</span>
<span class="go">[ 1 -1  1 -1]</span>
<span class="go">[ 1  1 -1 -1]</span>
<span class="go">[ 1 -1 -1  1]</span>
<span class="gp">sage: </span><span class="n">hadamard_matrix_www</span><span class="p">(</span><span class="s2">&quot;had.16.2.txt&quot;</span><span class="p">,</span><span class="n">comments</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># optional - internet</span>
<span class="go">Automorphism group has order = 49152 = 2^14 * 3</span>
<span class="go">[ 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1]</span>
<span class="go">[ 1 -1  1 -1  1 -1  1 -1  1 -1  1 -1  1 -1  1 -1]</span>
<span class="go">[ 1  1 -1 -1  1  1 -1 -1  1  1 -1 -1  1  1 -1 -1]</span>
<span class="go">[ 1 -1 -1  1  1 -1 -1  1  1 -1 -1  1  1 -1 -1  1]</span>
<span class="go">[ 1  1  1  1 -1 -1 -1 -1  1  1  1  1 -1 -1 -1 -1]</span>
<span class="go">[ 1 -1  1 -1 -1  1 -1  1  1 -1  1 -1 -1  1 -1  1]</span>
<span class="go">[ 1  1 -1 -1 -1 -1  1  1  1  1 -1 -1 -1 -1  1  1]</span>
<span class="go">[ 1 -1 -1  1 -1  1  1 -1  1 -1 -1  1 -1  1  1 -1]</span>
<span class="go">[ 1  1  1  1  1  1  1  1 -1 -1 -1 -1 -1 -1 -1 -1]</span>
<span class="go">[ 1  1  1  1 -1 -1 -1 -1 -1 -1 -1 -1  1  1  1  1]</span>
<span class="go">[ 1  1 -1 -1  1 -1  1 -1 -1 -1  1  1 -1  1 -1  1]</span>
<span class="go">[ 1  1 -1 -1 -1  1 -1  1 -1 -1  1  1  1 -1  1 -1]</span>
<span class="go">[ 1 -1  1 -1  1 -1 -1  1 -1  1 -1  1 -1  1  1 -1]</span>
<span class="go">[ 1 -1  1 -1 -1  1  1 -1 -1  1 -1  1  1 -1 -1  1]</span>
<span class="go">[ 1 -1 -1  1  1  1 -1 -1 -1  1  1 -1 -1 -1  1  1]</span>
<span class="go">[ 1 -1 -1  1 -1 -1  1  1 -1  1  1 -1  1  1 -1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.is_hadamard_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">is_hadamard_matrix</code><span class="sig-paren">(</span><em>M</em>, <em>normalized=False</em>, <em>skew=False</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.is_hadamard_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Test if <span class="math notranslate nohighlight">\(M\)</span> is a hadamard matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> – a matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">normalized</span></code> (boolean) – whether to test if <code class="docutils literal notranslate"><span class="pre">M</span></code> is a normalized
Hadamard matrix, i.e. has its first row/column filled with +1.</li>
<li><code class="docutils literal notranslate"><span class="pre">skew</span></code> (boolean) – whether to test if <code class="docutils literal notranslate"><span class="pre">M</span></code> is a skew
Hadamard matrix, i.e. <span class="math notranslate nohighlight">\(M=S+I\)</span> for <span class="math notranslate nohighlight">\(-S=S^\top\)</span>, and <span class="math notranslate nohighlight">\(I\)</span> the identity matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean) – whether to be verbose when the matrix is not
Hadamard.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">is_hadamard_matrix</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">skew_hadamard_matrix</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">=</span><span class="n">skew_hadamard_matrix</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">skew</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">The matrix does not only contain +1 and -1 entries, e.g. 2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">hadamard</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">):</span>
<span class="go">....:     h[i,2] = -h[i,2]</span>
<span class="gp">sage: </span><span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">normalized</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">The matrix is not normalized</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.normalise_hadamard">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">normalise_hadamard</code><span class="sig-paren">(</span><em>H</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.normalise_hadamard" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normalised Hadamard matrix corresponding to <code class="docutils literal notranslate"><span class="pre">H</span></code>.</p>
<p>The normalised Hadamard matrix corresponding to a Hadamard matrix <span class="math notranslate nohighlight">\(H\)</span> is a
matrix whose every entry in the first row and column is +1.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">matrices</span><span class="o">.</span><span class="n">hadamard_matrix</span><span class="o">.</span><span class="n">normalise_hadamard</span><span class="p">(</span><span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">hadamard_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">regular_symmetric_hadamard_matrix_with_constant_diagonal</code><span class="sig-paren">(</span><em>n</em>, <em>e</em>, <em>existence=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Regular Symmetric Hadamard Matrix with Constant Diagonal.</p>
<p>A Hadamard matrix is said to be <em>regular</em> if its rows all sum to the same
value.</p>
<p>For <span class="math notranslate nohighlight">\(\epsilon\in\{-1,+1\}\)</span>, we say that <span class="math notranslate nohighlight">\(M\)</span> is a <span class="math notranslate nohighlight">\((n,\epsilon)-RSHCD\)</span> if
<span class="math notranslate nohighlight">\(M\)</span> is a regular symmetric Hadamard matrix with constant diagonal
<span class="math notranslate nohighlight">\(\delta\in\{-1,+1\}\)</span> and row sums all equal to <span class="math notranslate nohighlight">\(\delta \epsilon
\sqrt(n)\)</span>. For more information, see <a class="reference internal" href="#hx10" id="id9">[HX10]</a> or 10.5.1 in
<a class="reference internal" href="#bh12" id="id10">[BH12]</a>. For the case <span class="math notranslate nohighlight">\(n=324\)</span>, see <a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.RSHCD_324" title="sage.combinat.matrices.hadamard_matrix.RSHCD_324"><code class="xref py py-func docutils literal notranslate"><span class="pre">RSHCD_324()</span></code></a> and <a class="reference internal" href="#cp16" id="id11">[CP16]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer) – side of the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">e</span></code> – one of <span class="math notranslate nohighlight">\(-1\)</span> or <span class="math notranslate nohighlight">\(+1\)</span>, equal to the value of <span class="math notranslate nohighlight">\(\epsilon\)</span></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span>
<span class="gp">sage: </span><span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[ 1  1  1 -1]</span>
<span class="go">[ 1  1 -1  1]</span>
<span class="go">[ 1 -1  1  1]</span>
<span class="go">[-1  1  1  1]</span>
<span class="gp">sage: </span><span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[ 1 -1 -1 -1]</span>
<span class="go">[-1  1 -1 -1]</span>
<span class="go">[-1 -1  1 -1]</span>
<span class="go">[-1 -1 -1  1]</span>
</pre></div>
</div>
<p>Other hardcoded values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">36</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">36</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">100</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">196</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]:</span>  <span class="c1"># long time</span>
<span class="go">....:     print(repr(regular_symmetric_hadamard_matrix_with_constant_diagonal(n,e)))</span>
<span class="go">36 x 36 dense matrix over Integer Ring</span>
<span class="go">36 x 36 dense matrix over Integer Ring</span>
<span class="go">100 x 100 dense matrix over Integer Ring</span>
<span class="go">100 x 100 dense matrix over Integer Ring</span>
<span class="go">196 x 196 dense matrix over Integer Ring</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">324</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">324</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]:</span> <span class="c1"># not tested - long time, tested in RSHCD_324</span>
<span class="go">....:     print(repr(regular_symmetric_hadamard_matrix_with_constant_diagonal(n,e)))</span>
<span class="go">324 x 324 dense matrix over Integer Ring</span>
<span class="go">324 x 324 dense matrix over Integer Ring</span>
</pre></div>
</div>
<p>From two close prime powers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">64 x 64 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
</pre></div>
</div>
<p>From a prime power and a conference matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span><span class="p">(</span><span class="mi">676</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">676 x 676 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
</pre></div>
</div>
<p>Recursive construction:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">regular_symmetric_hadamard_matrix_with_constant_diagonal</span><span class="p">(</span><span class="mi">144</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">144 x 144 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="bh12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[BH12]</td><td><em>(<a class="fn-backref" href="#id10">1</a>, <a class="fn-backref" href="#id19">2</a>)</em> A. Brouwer and W. Haemers,
Spectra of graphs,
Springer, 2012,
<a class="reference external" href="http://homepages.cwi.nl/~aeb/math/ipm/ipm.pdf">http://homepages.cwi.nl/~aeb/math/ipm/ipm.pdf</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hx10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[HX10]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id9">2</a>)</em> W. Haemers and Q. Xiang,
Strongly regular graphs with parameters <span class="math notranslate nohighlight">\((4m^4,2m^4+m^2,m^4+m^2,m^4+m^2)\)</span> exist for all <span class="math notranslate nohighlight">\(m&gt;1\)</span>,
European Journal of Combinatorics,
Volume 31, Issue 6, August 2010, Pages 1553-1559,
<a class="reference external" href="https://doi.org/10.1016/j.ejc.2009.07.009">doi:10.1016/j.ejc.2009.07.009</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.rshcd_from_close_prime_powers">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">rshcd_from_close_prime_powers</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.rshcd_from_close_prime_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math notranslate nohighlight">\((n^2,1)\)</span>-RSHCD when <span class="math notranslate nohighlight">\(n-1\)</span> and <span class="math notranslate nohighlight">\(n+1\)</span> are odd prime powers and <span class="math notranslate nohighlight">\(n=0\pmod{4}\)</span>.</p>
<p>The construction implemented here appears in Theorem 4.3 from <a class="reference internal" href="../../../../graphs/sage/graphs/strongly_regular_db.html#gs70" id="id12">[GS70]</a>.</p>
<p>Note that the authors of <a class="reference internal" href="#sww72" id="id13">[SWW72]</a> claim in Corollary 5.12 (page 342) to have
proved the same result without the <span class="math notranslate nohighlight">\(n=0\pmod{4}\)</span> restriction with a <em>very</em>
similar construction. So far, however, I (Nathann Cohen) have not been able
to make it work.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer congruent to <span class="math notranslate nohighlight">\(0\pmod{4}\)</span></li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal" title="sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal"><code class="xref py py-func docutils literal notranslate"><span class="pre">regular_symmetric_hadamard_matrix_with_constant_diagonal()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">rshcd_from_close_prime_powers</span>
<span class="gp">sage: </span><span class="n">rshcd_from_close_prime_powers</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[-1 -1  1 -1  1 -1 -1  1 -1  1 -1 -1  1 -1  1 -1]</span>
<span class="go">[-1 -1  1  1 -1 -1 -1 -1 -1  1  1 -1 -1  1 -1  1]</span>
<span class="go">[ 1  1 -1  1  1 -1 -1 -1 -1 -1  1 -1 -1 -1  1 -1]</span>
<span class="go">[-1  1  1 -1  1  1 -1 -1 -1 -1 -1  1 -1 -1 -1  1]</span>
<span class="go">[ 1 -1  1  1 -1  1  1 -1 -1 -1 -1 -1  1 -1 -1 -1]</span>
<span class="go">[-1 -1 -1  1  1 -1  1  1 -1 -1 -1  1 -1  1 -1 -1]</span>
<span class="go">[-1 -1 -1 -1  1  1 -1 -1  1 -1  1 -1  1  1 -1 -1]</span>
<span class="go">[ 1 -1 -1 -1 -1  1 -1 -1 -1  1 -1  1 -1  1  1 -1]</span>
<span class="go">[-1 -1 -1 -1 -1 -1  1 -1 -1 -1  1  1  1 -1  1  1]</span>
<span class="go">[ 1  1 -1 -1 -1 -1 -1  1 -1 -1 -1 -1  1  1 -1  1]</span>
<span class="go">[-1  1  1 -1 -1 -1  1 -1  1 -1 -1 -1 -1  1  1 -1]</span>
<span class="go">[-1 -1 -1  1 -1  1 -1  1  1 -1 -1 -1 -1 -1  1  1]</span>
<span class="go">[ 1 -1 -1 -1  1 -1  1 -1  1  1 -1 -1 -1 -1 -1  1]</span>
<span class="go">[-1  1 -1 -1 -1  1  1  1 -1  1  1 -1 -1 -1 -1 -1]</span>
<span class="go">[ 1 -1  1 -1 -1 -1 -1  1  1 -1  1  1 -1 -1 -1 -1]</span>
<span class="go">[-1  1 -1  1 -1 -1 -1 -1  1  1 -1  1  1 -1 -1 -1]</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="sww72" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[SWW72]</td><td><em>(<a class="fn-backref" href="#id13">1</a>, <a class="fn-backref" href="#id15">2</a>, <a class="fn-backref" href="#id21">3</a>)</em> A Street, W. Wallis, J. Wallis,
Combinatorics: Room squares, sum-free sets, Hadamard matrices.
Lecture notes in Mathematics 292 (1972).</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.rshcd_from_prime_power_and_conference_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">rshcd_from_prime_power_and_conference_matrix</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.rshcd_from_prime_power_and_conference_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math notranslate nohighlight">\(((n-1)^2,1)\)</span>-RSHCD if <span class="math notranslate nohighlight">\(n\)</span> is prime power, and symmetric <span class="math notranslate nohighlight">\((n-1)\)</span>-conference matrix exists</p>
<p>The construction implemented here is Theorem 16 (and Corollary 17) from <a class="reference internal" href="#ww72" id="id14">[WW72]</a>.</p>
<p>In <a class="reference internal" href="#sww72" id="id15">[SWW72]</a> this construction (Theorem 5.15 and Corollary 5.16)
is reproduced with a typo. Note that <a class="reference internal" href="#ww72" id="id16">[WW72]</a> refers to <a class="reference internal" href="#sz69" id="id17">[Sz69]</a> for the construction,
provided by <a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.szekeres_difference_set_pair" title="sage.combinat.matrices.hadamard_matrix.szekeres_difference_set_pair"><code class="xref py py-func docutils literal notranslate"><span class="pre">szekeres_difference_set_pair()</span></code></a>,
of complementary difference sets, and the latter has a typo.</p>
<p>From a <a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.symmetric_conference_matrix" title="sage.combinat.matrices.hadamard_matrix.symmetric_conference_matrix"><code class="xref py py-func docutils literal notranslate"><span class="pre">symmetric_conference_matrix()</span></code></a>, we only need the Seidel
adjacency matrix of the underlying strongly regular conference (i.e. Paley
type) graph, which we construct directly.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal" title="sage.combinat.matrices.hadamard_matrix.regular_symmetric_hadamard_matrix_with_constant_diagonal"><code class="xref py py-func docutils literal notranslate"><span class="pre">regular_symmetric_hadamard_matrix_with_constant_diagonal()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>A 36x36 example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">rshcd_from_prime_power_and_conference_matrix</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">is_hadamard_matrix</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">rshcd_from_prime_power_and_conference_matrix</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span> <span class="n">H</span>
<span class="go">36 x 36 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">==</span><span class="n">H</span><span class="o">.</span><span class="n">T</span> <span class="ow">and</span> <span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="ow">and</span> <span class="n">H</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">==</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">36</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">==</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="mi">36</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Bigger examples, only provided by this construction</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">rshcd_from_prime_power_and_conference_matrix</span><span class="p">(</span><span class="mi">27</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">T</span> <span class="ow">and</span> <span class="n">is_hadamard_matrix</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>                    <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span><span class="o">==</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">676</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">==</span><span class="p">[</span><span class="mi">26</span><span class="p">]</span><span class="o">*</span><span class="mi">676</span>      <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In this example the conference matrix is not Paley, as 45 is not a prime power</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">rshcd_from_prime_power_and_conference_matrix</span><span class="p">(</span><span class="mi">47</span><span class="p">)</span>  <span class="c1"># not tested (long time)</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="ww72" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[WW72]</td><td><em>(<a class="fn-backref" href="#id14">1</a>, <a class="fn-backref" href="#id16">2</a>)</em> J. Wallis and A.L. Whiteman,
Some classes of Hadamard matrices with constant diagonal,
Bull. Austral. Math. Soc. 7(1972), 233-249</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.skew_hadamard_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">skew_hadamard_matrix</code><span class="sig-paren">(</span><em>n</em>, <em>existence=False</em>, <em>skew_normalize=True</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.skew_hadamard_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to construct a skew Hadamard matrix</p>
<p>A Hadamard matrix <span class="math notranslate nohighlight">\(H\)</span> is called skew if <span class="math notranslate nohighlight">\(H=S-I\)</span>, for <span class="math notranslate nohighlight">\(I\)</span> the identity matrix
and <span class="math notranslate nohighlight">\(-S=S^\top\)</span>. Currently constructions from Section 14.1 of <a class="reference internal" href="#ha83" id="id18">[Ha83]</a> and few
more exotic ones are implemented.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer) – dimension of the matrix</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">existence</span></code> (boolean) – whether to build the matrix or merely query if
a construction is available in Sage. When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the function
returns:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> – meaning that Sage knows how to build the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">Unknown</span></code> – meaning that Sage does not know how to build the
matrix, but that the design may exist (see <a class="reference external" href="../../../../misc/sage/misc/unknown.html#module-sage.misc.unknown" title="(in Sage Reference Manual: Utilities v8.3)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.unknown</span></code></a>).</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> – meaning that the matrix does not exist.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">skew_normalize</span></code> (boolean) – whether to make the 1st row all-one, and
adjust the 1st column accordingly. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">skew_hadamard_matrix</span>
<span class="gp">sage: </span><span class="n">skew_hadamard_matrix</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">2985984</span>
<span class="gp">sage: </span><span class="mi">12</span><span class="o">^</span><span class="mi">6</span>
<span class="go">2985984</span>
<span class="gp">sage: </span><span class="n">skew_hadamard_matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">skew_hadamard_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[ 1  1]</span>
<span class="go">[-1  1]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="ha83" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[Ha83]</a></td><td>M. Hall,
Combinatorial Theory,
2nd edition,
Wiley, 1983</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.symmetric_conference_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">symmetric_conference_matrix</code><span class="sig-paren">(</span><em>n</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.symmetric_conference_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to construct a symmetric conference matrix</p>
<p>A conference matrix is an <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(C\)</span> with 0s on the main diagonal
and 1s and -1s elsewhere, satisfying <span class="math notranslate nohighlight">\(CC^\top=(n-1)I\)</span>.
If <span class="math notranslate nohighlight">\(C=C^\top\)</span> then <span class="math notranslate nohighlight">\(n \cong 2 \mod 4\)</span> and <span class="math notranslate nohighlight">\(C\)</span> is Seidel adjacency matrix of
a graph, whose descendent graphs are strongly regular graphs with parameters
<span class="math notranslate nohighlight">\((n-1,(n-2)/2,(n-6)/4,(n-2)/4)\)</span>, see Sec.10.4 of <a class="reference internal" href="#bh12" id="id19">[BH12]</a>. Thus we build <span class="math notranslate nohighlight">\(C\)</span>
from the Seidel adjacency matrix of the latter by adding row and column of 1s.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer) – dimension of the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (boolean) – whether to check that output is correct before
returning it. As this is expected to be useless (but we are cautious
guys), you may want to disable it whenever you want speed. Set to <code class="docutils literal notranslate"><span class="pre">True</span></code>
by default.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">symmetric_conference_matrix</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">=</span><span class="n">symmetric_conference_matrix</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[ 0  1  1  1  1  1  1  1  1  1]</span>
<span class="go">[ 1  0 -1 -1  1 -1  1  1  1 -1]</span>
<span class="go">[ 1 -1  0 -1  1  1 -1 -1  1  1]</span>
<span class="go">[ 1 -1 -1  0 -1  1  1  1 -1  1]</span>
<span class="go">[ 1  1  1 -1  0 -1 -1  1 -1  1]</span>
<span class="go">[ 1 -1  1  1 -1  0 -1  1  1 -1]</span>
<span class="go">[ 1  1 -1  1 -1 -1  0 -1  1  1]</span>
<span class="go">[ 1  1 -1  1  1  1 -1  0 -1 -1]</span>
<span class="go">[ 1  1  1 -1 -1  1  1 -1  0 -1]</span>
<span class="go">[ 1 -1  1  1  1 -1  1 -1 -1  0]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">^</span><span class="mi">2</span><span class="o">==</span><span class="mi">9</span><span class="o">*</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="ow">and</span> <span class="n">C</span><span class="o">==</span><span class="n">C</span><span class="o">.</span><span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.szekeres_difference_set_pair">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">szekeres_difference_set_pair</code><span class="sig-paren">(</span><em>m</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.szekeres_difference_set_pair" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct Szekeres <span class="math notranslate nohighlight">\((2m+1,m,1)\)</span>-cyclic difference family</p>
<p>Let <span class="math notranslate nohighlight">\(4m+3\)</span> be a prime power. Theorem 3 in <a class="reference internal" href="#sz69" id="id20">[Sz69]</a> contains a construction of a pair
of <em>complementary difference sets</em> <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> in the subgroup <span class="math notranslate nohighlight">\(G\)</span> of the quadratic
residues in <span class="math notranslate nohighlight">\(F_{4m+3}^*\)</span>. Namely <span class="math notranslate nohighlight">\(|A|=|B|=m\)</span>, <span class="math notranslate nohighlight">\(a\in A\)</span> whenever <span class="math notranslate nohighlight">\(a-1\in G\)</span>, <span class="math notranslate nohighlight">\(b\in B\)</span>
whenever <span class="math notranslate nohighlight">\(b+1 \in G\)</span>. See also Theorem 2.6 in <a class="reference internal" href="#sww72" id="id21">[SWW72]</a> (there the formula for <span class="math notranslate nohighlight">\(B\)</span> is
correct, as opposed to (4.2) in <a class="reference internal" href="#sz69" id="id22">[Sz69]</a>, where the sign before <span class="math notranslate nohighlight">\(1\)</span> is wrong.</p>
<p>In modern terminology, for <span class="math notranslate nohighlight">\(m&gt;1\)</span> the sets <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> form a
<a class="reference internal" href="../designs/difference_family.html#module-sage.combinat.designs.difference_family" title="sage.combinat.designs.difference_family"><code class="xref py py-func docutils literal notranslate"><span class="pre">difference</span> <span class="pre">family</span></code></a> with parameters <span class="math notranslate nohighlight">\((2m+1,m,1)\)</span>.
I.e. each non-identity <span class="math notranslate nohighlight">\(g \in G\)</span> can be expressed uniquely as <span class="math notranslate nohighlight">\(xy^{-1}\)</span> for <span class="math notranslate nohighlight">\(x,y \in A\)</span> or <span class="math notranslate nohighlight">\(x,y \in B\)</span>.
Other, specific to this construction, properties of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are: for <span class="math notranslate nohighlight">\(a\)</span> in <span class="math notranslate nohighlight">\(A\)</span> one has
<span class="math notranslate nohighlight">\(a^{-1}\)</span> not in <span class="math notranslate nohighlight">\(A\)</span>, whereas for <span class="math notranslate nohighlight">\(b\)</span> in <span class="math notranslate nohighlight">\(B\)</span> one has <span class="math notranslate nohighlight">\(b^{-1}\)</span> in <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">m</span></code> (integer) – dimension of the matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – whether to check <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> for correctness</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">szekeres_difference_set_pair</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="o">=</span><span class="n">szekeres_difference_set_pair</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="o">=</span><span class="n">szekeres_difference_set_pair</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<table class="docutils citation" frame="void" id="sz69" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Sz69]</td><td><em>(<a class="fn-backref" href="#id17">1</a>, <a class="fn-backref" href="#id20">2</a>, <a class="fn-backref" href="#id22">3</a>)</em> G. Szekeres,
Tournaments and Hadamard matrices,
Enseignement Math. (2) 15(1969), 269-278</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.typeI_matrix_difference_set">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">typeI_matrix_difference_set</code><span class="sig-paren">(</span><em>G</em>, <em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.typeI_matrix_difference_set" title="Permalink to this definition">¶</a></dt>
<dd><p>(1,-1)-incidence type I matrix of a difference set <span class="math notranslate nohighlight">\(A\)</span> in <span class="math notranslate nohighlight">\(G\)</span></p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be a difference set in a group <span class="math notranslate nohighlight">\(G\)</span> of order <span class="math notranslate nohighlight">\(n\)</span>. Return <span class="math notranslate nohighlight">\(n\times n\)</span>
matrix <span class="math notranslate nohighlight">\(M\)</span> with <span class="math notranslate nohighlight">\(M_{ij}=1\)</span> if <span class="math notranslate nohighlight">\(A_i A_j^{-1} \in A\)</span>, and <span class="math notranslate nohighlight">\(M_{ij}=-1\)</span> otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">szekeres_difference_set_pair</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">typeI_matrix_difference_set</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="o">=</span><span class="n">szekeres_difference_set_pair</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">typeI_matrix_difference_set</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="go">[-1  1 -1 -1  1]</span>
<span class="go">[-1 -1 -1  1  1]</span>
<span class="go">[ 1  1 -1 -1 -1]</span>
<span class="go">[ 1 -1  1 -1 -1]</span>
<span class="go">[-1 -1  1  1 -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.matrices.hadamard_matrix.williamson_goethals_seidel_skew_hadamard_matrix">
<code class="descclassname">sage.combinat.matrices.hadamard_matrix.</code><code class="descname">williamson_goethals_seidel_skew_hadamard_matrix</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>c</em>, <em>d</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.matrices.hadamard_matrix.williamson_goethals_seidel_skew_hadamard_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Williamson-Goethals-Seidel construction of a skew Hadamard matrix</p>
<p>Given <span class="math notranslate nohighlight">\(n\times n\)</span> (anti)circulant matrices <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span>, <span class="math notranslate nohighlight">\(D\)</span> with 1,-1 entries,
and satisfying <span class="math notranslate nohighlight">\(A+A^\top = 2I\)</span>, <span class="math notranslate nohighlight">\(AA^\top + BB^\top + CC^\top + DD^\top = 4nI\)</span>,
one can construct a skew Hadamard matrix of order <span class="math notranslate nohighlight">\(4n\)</span>, cf. <a class="reference internal" href="#gs70s" id="id23">[GS70s]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">a</span></code> – 1,-1 list specifying the 1st row of <span class="math notranslate nohighlight">\(A\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">b</span></code> – 1,-1 list specifying the 1st row of <span class="math notranslate nohighlight">\(B\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">d</span></code> – 1,-1 list specifying the 1st row of <span class="math notranslate nohighlight">\(C\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">c</span></code> – 1,-1 list specifying the 1st row of <span class="math notranslate nohighlight">\(D\)</span></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.matrices.hadamard_matrix</span> <span class="kn">import</span> <span class="n">williamson_goethals_seidel_skew_hadamard_matrix</span> <span class="k">as</span> <span class="n">WGS</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">=</span><span class="p">[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">WGS</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="gs70s" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[GS70s]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id23">2</a>)</em> J.M. Goethals and J. J. Seidel,
A skew Hadamard matrix of order 36,
J. Aust. Math. Soc. 11(1970), 343-344</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wall71" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Wall71]</a></td><td>J. Wallis,
A skew-Hadamard matrix of order 92,
Bull. Aust. Math. Soc. 5(1971), 203-204</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="kost08" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[KoSt08]</td><td>C. Koukouvinos, S. Stylianou
On skew-Hadamard matrices,
Discrete Math. 308(2008) 2723-2731</td></tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="dlxcpp.html"
                        title="previous chapter">Dancing links C++ wrapper</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="latin.html"
                        title="next chapter">Latin Squares</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/combinat/matrices/hadamard_matrix.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="latin.html" title="Latin Squares"
             >next</a> |</li>
        <li class="right" >
          <a href="dlxcpp.html" title="Dancing links C++ wrapper"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>