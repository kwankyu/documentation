
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Difference families &#8212; Sage Reference Manual v8.2: Combinatorics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Difference Matrices" href="difference_matrices.html" />
    <link rel="prev" title="Cython functions for combinatorial designs" href="designs_pyx.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="difference_matrices.html" title="Difference Matrices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="designs_pyx.html" title="Cython functions for combinatorial designs"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" accesskey="U">Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="difference-families">
<span id="sage-combinat-designs-difference-family"></span><h1>Difference families<a class="headerlink" href="#difference-families" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.combinat.designs.difference_family"></span><p>This module gathers everything related to difference families. One can build a
difference family (or check that it can be built) with <a class="reference internal" href="#sage.combinat.designs.difference_family.difference_family" title="sage.combinat.designs.difference_family.difference_family"><code class="xref py py-func docutils literal"><span class="pre">difference_family()</span></code></a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">F</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>It defines the following functions:</p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.are_hadamard_difference_set_parameters" title="sage.combinat.designs.difference_family.are_hadamard_difference_set_parameters"><code class="xref py py-func docutils literal"><span class="pre">are_hadamard_difference_set_parameters()</span></code></a></td>
<td>Check whether <code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code> is of the form <code class="docutils literal"><span class="pre">(4N^2,</span> <span class="pre">2N^2</span> <span class="pre">-</span> <span class="pre">N,</span> <span class="pre">N^2</span> <span class="pre">-</span> <span class="pre">N)</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.are_mcfarland_1973_parameters" title="sage.combinat.designs.difference_family.are_mcfarland_1973_parameters"><code class="xref py py-func docutils literal"><span class="pre">are_mcfarland_1973_parameters()</span></code></a></td>
<td>Test whether <code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code> is a triple that can be obtained from the construction from <a class="reference internal" href="#mcf1973" id="id1">[McF1973]</a>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.block_stabilizer" title="sage.combinat.designs.difference_family.block_stabilizer"><code class="xref py py-func docutils literal"><span class="pre">block_stabilizer()</span></code></a></td>
<td>Compute the left stabilizer of the block <code class="docutils literal"><span class="pre">B</span></code> under the action of <code class="docutils literal"><span class="pre">G</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.df_q_6_1" title="sage.combinat.designs.difference_family.df_q_6_1"><code class="xref py py-func docutils literal"><span class="pre">df_q_6_1()</span></code></a></td>
<td>Return a <span class="math">\((q,6,1)\)</span>-difference family over the finite field <span class="math">\(K\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.difference_family" title="sage.combinat.designs.difference_family.difference_family"><code class="xref py py-func docutils literal"><span class="pre">difference_family()</span></code></a></td>
<td>Return a (<code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">l</span></code>)-difference family on an Abelian group of cardinality <code class="docutils literal"><span class="pre">v</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.group_law" title="sage.combinat.designs.difference_family.group_law"><code class="xref py py-func docutils literal"><span class="pre">group_law()</span></code></a></td>
<td>Return a triple <code class="docutils literal"><span class="pre">(identity,</span> <span class="pre">operation,</span> <span class="pre">inverse)</span></code> that define the operations on the group <code class="docutils literal"><span class="pre">G</span></code>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.hadamard_difference_set_product" title="sage.combinat.designs.difference_family.hadamard_difference_set_product"><code class="xref py py-func docutils literal"><span class="pre">hadamard_difference_set_product()</span></code></a></td>
<td>Make a product of two Hadamard difference sets.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.is_difference_family" title="sage.combinat.designs.difference_family.is_difference_family"><code class="xref py py-func docutils literal"><span class="pre">is_difference_family()</span></code></a></td>
<td>Check wether <code class="docutils literal"><span class="pre">D</span></code> forms a difference family in the group <code class="docutils literal"><span class="pre">G</span></code>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.mcfarland_1973_construction" title="sage.combinat.designs.difference_family.mcfarland_1973_construction"><code class="xref py py-func docutils literal"><span class="pre">mcfarland_1973_construction()</span></code></a></td>
<td>Return a difference set.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.one_cyclic_tiling" title="sage.combinat.designs.difference_family.one_cyclic_tiling"><code class="xref py py-func docutils literal"><span class="pre">one_cyclic_tiling()</span></code></a></td>
<td>Given a subset <code class="docutils literal"><span class="pre">A</span></code> of the cyclic additive group <span class="math">\(G = Z / nZ\)</span> return another subset <span class="math">\(B\)</span> so that <span class="math">\(A + B = G\)</span> and <span class="math">\(|A| |B| = n\)</span> (i.e. any element of <span class="math">\(G\)</span> is uniquely expressed as a sum <span class="math">\(a+b\)</span> with <span class="math">\(a\)</span> in <span class="math">\(A\)</span> and <span class="math">\(b\)</span> in <span class="math">\(B\)</span>).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.one_radical_difference_family" title="sage.combinat.designs.difference_family.one_radical_difference_family"><code class="xref py py-func docutils literal"><span class="pre">one_radical_difference_family()</span></code></a></td>
<td>Search for a radical difference family on <code class="docutils literal"><span class="pre">K</span></code> using dancing links algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.radical_difference_family" title="sage.combinat.designs.difference_family.radical_difference_family"><code class="xref py py-func docutils literal"><span class="pre">radical_difference_family()</span></code></a></td>
<td>Return a <code class="docutils literal"><span class="pre">(v,k,l)</span></code>-radical difference family.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.radical_difference_set" title="sage.combinat.designs.difference_family.radical_difference_set"><code class="xref py py-func docutils literal"><span class="pre">radical_difference_set()</span></code></a></td>
<td>Return a difference set made of a cyclotomic coset in the finite field <code class="docutils literal"><span class="pre">K</span></code> and with parameters <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">l</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.singer_difference_set" title="sage.combinat.designs.difference_family.singer_difference_set"><code class="xref py py-func docutils literal"><span class="pre">singer_difference_set()</span></code></a></td>
<td>Return a difference set associated to the set of hyperplanes in a projective space of dimension <span class="math">\(d\)</span> over <span class="math">\(GF(q)\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.turyn_1965_3x3xK" title="sage.combinat.designs.difference_family.turyn_1965_3x3xK"><code class="xref py py-func docutils literal"><span class="pre">turyn_1965_3x3xK()</span></code></a></td>
<td>Return a difference set in either <span class="math">\(C_3 \times C_3 \times C_4\)</span> or <span class="math">\(C_3 \times C_3 \times C_2 \times C_2\)</span> with parameters <span class="math">\(v=36\)</span>, <span class="math">\(k=15\)</span>, <span class="math">\(\lambda=6\)</span>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.combinat.designs.difference_family.twin_prime_powers_difference_set" title="sage.combinat.designs.difference_family.twin_prime_powers_difference_set"><code class="xref py py-func docutils literal"><span class="pre">twin_prime_powers_difference_set()</span></code></a></td>
<td>Return a difference set on <span class="math">\(GF(p) \times GF(p+2)\)</span>.</td>
</tr>
</tbody>
</table>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bjl99-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[BJL99-1]</td><td>T. Beth, D. Jungnickel, H. Lenz “Design theory Vol. I.”
Second edition. Encyclopedia of Mathematics and its Applications, 69. Cambridge
University Press, (1999).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="blj99-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[BLJ99-2]</td><td>T. Beth, D. Jungnickel, H. Lenz “Design theory Vol. II.”
Second edition. Encyclopedia of Mathematics and its Applications, 78. Cambridge
University Press, (1999).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bo39" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Bo39]</td><td>R. C. Bose, “On the construction of balanced incomplete block
designs”, Ann. Eugenics, 9 (1939), 353–399.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bu95" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Bu95]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> M. Buratti “On simple radical difference families”, J.
Combinatorial Designs, 3 (1995) 161–168.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tu1965" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[Tu1965]</a></td><td>R. J. Turyn “Character sum and difference sets”
Pacific J. Math. 15 (1965) 319–346.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="tu1984" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Tu1984]</a></td><td>R. J. Turyn “A special class of Williamson matrices and
difference sets” J. Combinatorial Theory (A) 36 (1984) 111–115.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wi72" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Wi72]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> R. M. Wilson “Cyclotomy and difference families in elementary Abelian
groups”, J. Number Theory, 4 (1972) 17–47.</td></tr>
</tbody>
</table>
<div class="section" id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="sage.combinat.designs.difference_family.are_hadamard_difference_set_parameters">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">are_hadamard_difference_set_parameters</code><span class="sig-paren">(</span><em>v</em>, <em>k</em>, <em>lmbda</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.are_hadamard_difference_set_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code> is of the form <code class="docutils literal"><span class="pre">(4N^2,</span> <span class="pre">2N^2</span> <span class="pre">-</span> <span class="pre">N,</span> <span class="pre">N^2</span> <span class="pre">-</span> <span class="pre">N)</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code> – parameters of a difference set</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">are_hadamard_difference_set_parameters</span>
<span class="gp">sage: </span><span class="n">are_hadamard_difference_set_parameters</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">are_hadamard_difference_set_parameters</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.are_mcfarland_1973_parameters">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">are_mcfarland_1973_parameters</code><span class="sig-paren">(</span><em>v</em>, <em>k</em>, <em>lmbda</em>, <em>return_parameters=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.are_mcfarland_1973_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code> is a triple that can be obtained from the
construction from <a class="reference internal" href="#mcf1973" id="id2">[McF1973]</a>.</p>
<p>See <a class="reference internal" href="#sage.combinat.designs.difference_family.mcfarland_1973_construction" title="sage.combinat.designs.difference_family.mcfarland_1973_construction"><code class="xref py py-func docutils literal"><span class="pre">mcfarland_1973_construction()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code>, <code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">lmbda</span></code> - (integers) parameters of the difference family</li>
<li><code class="docutils literal"><span class="pre">return_parameters</span></code> – (boolean, default <code class="docutils literal"><span class="pre">False</span></code>) if <code class="docutils literal"><span class="pre">True</span></code> return a
pair <code class="docutils literal"><span class="pre">(True,</span> <span class="pre">(q,</span> <span class="pre">s))</span></code> so that <code class="docutils literal"><span class="pre">(q,s)</span></code> can be used in the function
<a class="reference internal" href="#sage.combinat.designs.difference_family.mcfarland_1973_construction" title="sage.combinat.designs.difference_family.mcfarland_1973_construction"><code class="xref py py-func docutils literal"><span class="pre">mcfarland_1973_construction()</span></code></a> to actually build a
<code class="docutils literal"><span class="pre">(v,k,lmbda)</span></code>-difference family. Or <code class="docutils literal"><span class="pre">(False,</span> <span class="pre">None)</span></code> if the
construction is not possible.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">are_mcfarland_1973_parameters</span>
<span class="gp">sage: </span><span class="n">are_mcfarland_1973_parameters</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">are_mcfarland_1973_parameters</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">return_parameters</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (2, 2))</span>
<span class="gp">sage: </span><span class="n">are_mcfarland_1973_parameters</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">are_mcfarland_1973_parameters</span><span class="p">(</span><span class="mi">98125</span><span class="p">,</span> <span class="mi">19500</span><span class="p">,</span> <span class="mi">3875</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">are_mcfarland_1973_parameters</span><span class="p">(</span><span class="mi">98125</span><span class="p">,</span> <span class="mi">19500</span><span class="p">,</span> <span class="mi">3875</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(True, (5, 3))</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">are_mcfarland_1973_parameters</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
<span class="go">....:     for k in range(1,30):</span>
<span class="go">....:         for l in range(1,15):</span>
<span class="go">....:             if are_mcfarland_1973_parameters(v,k,l):</span>
<span class="go">....:                 answer, (q,s) = are_mcfarland_1973_parameters(v,k,l,return_parameters=True)</span>
<span class="go">....:                 print(&quot;{} {} {} {} {}&quot;.format(v,k,l,q,s))</span>
<span class="go">....:                 assert answer is True</span>
<span class="go">....:                 assert designs.difference_family(v,k,l,existence=True) is True</span>
<span class="go">....:                 G,D = designs.difference_family(v,k,l)</span>
<span class="go">16 6 2 2 1</span>
<span class="go">45 12 3 3 1</span>
<span class="go">64 28 12 2 2</span>
<span class="go">96 20 4 4 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.block_stabilizer">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">block_stabilizer</code><span class="sig-paren">(</span><em>G</em>, <em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.block_stabilizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the left stabilizer of the block <code class="docutils literal"><span class="pre">B</span></code> under the action of <code class="docutils literal"><span class="pre">G</span></code>.</p>
<p>This function return the list of all <span class="math">\(x\in G\)</span> such that <span class="math">\(x\cdot B=B\)</span> (as a
set).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">G</span></code> – a group (additive or multiplicative).</li>
<li><code class="docutils literal"><span class="pre">B</span></code> – a subset of <code class="docutils literal"><span class="pre">G</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">block_stabilizer</span>

<span class="gp">sage: </span><span class="n">Z8</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">block_stabilizer</span><span class="p">(</span><span class="n">Z8</span><span class="p">,</span> <span class="p">[</span><span class="n">Z8</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Z8</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">Z8</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Z8</span><span class="p">(</span><span class="mi">6</span><span class="p">)])</span>
<span class="go">[0, 2, 4, 6]</span>
<span class="gp">sage: </span><span class="n">block_stabilizer</span><span class="p">(</span><span class="n">Z8</span><span class="p">,</span> <span class="p">[</span><span class="n">Z8</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span><span class="n">Z8</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">[0]</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">cartesian_product</span><span class="p">([</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">block_stabilizer</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[</span><span class="n">C</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span><span class="n">C</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)),</span><span class="n">C</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span><span class="n">C</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))])</span>
<span class="go">[(0, 0), (2, 0)]</span>

<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">45</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">44</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">block_stabilizer</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">45</span><span class="p">),</span><span class="n">b</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.df_q_6_1">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">df_q_6_1</code><span class="sig-paren">(</span><em>K</em>, <em>existence=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.df_q_6_1" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <span class="math">\((q,6,1)\)</span>-difference family over the finite field <span class="math">\(K\)</span>.</p>
<p>The construction uses Theorem 11 of <a class="reference internal" href="#wi72" id="id3">[Wi72]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">is_difference_family</span><span class="p">,</span> <span class="n">df_q_6_1</span>
<span class="gp">sage: </span><span class="n">prime_powers</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span> <span class="k">if</span> <span class="n">is_prime_power</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">parameters</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">prime_powers</span> <span class="k">if</span> <span class="n">df_q_6_1</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">parameters</span>
<span class="go">[31, 151, 181, 211, 241, 271, 331, 361, 421]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
<span class="go">....:     K = GF(v, &#39;a&#39;)</span>
<span class="go">....:     df = df_q_6_1(K, check=True)</span>
<span class="go">....:     assert is_difference_family(K, df, v, 6, 1)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Do improvements due to Zhen and Wu 1999.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.difference_family">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">difference_family</code><span class="sig-paren">(</span><em>v</em>, <em>k</em>, <em>l=1</em>, <em>existence=False</em>, <em>explain_construction=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.difference_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a (<code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">l</span></code>)-difference family on an Abelian group of cardinality <code class="docutils literal"><span class="pre">v</span></code>.</p>
<p>Let <span class="math">\(G\)</span> be a finite Abelian group. For a given subset <span class="math">\(D\)</span> of <span class="math">\(G\)</span>, we define
<span class="math">\(\Delta D\)</span> to be the multi-set of differences <span class="math">\(\Delta D = \{x - y; x \in D,
y \in D, x \not= y\}\)</span>. A <span class="math">\((G,k,\lambda)\)</span>-<em>difference family</em> is a collection
of <span class="math">\(k\)</span>-subsets of <span class="math">\(G\)</span>, <span class="math">\(D = \{D_1, D_2, \ldots, D_b\}\)</span> such that the union
of the difference sets <span class="math">\(\Delta D_i\)</span> for <span class="math">\(i=1,...b\)</span>, seen as a multi-set,
contains each element of <span class="math">\(G \backslash \{0\}\)</span> exactly <span class="math">\(\lambda\)</span>-times.</p>
<p>When there is only one block, i.e. <span class="math">\(\lambda(v - 1) = k(k-1)\)</span>, then a
<span class="math">\((G,k,\lambda)\)</span>-difference family is also called a <em>difference set</em>.</p>
<p>See also <a class="reference external" href="https://en.wikipedia.org/wiki/Difference_set">Wikipedia article Difference_set</a>.</p>
<p>If there is no such difference family, an <code class="docutils literal"><span class="pre">EmptySetError</span></code> is raised and if
there is no construction at the moment <code class="docutils literal"><span class="pre">NotImplementedError</span></code> is raised.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v,k,l</span></code> – parameters of the difference family. If <code class="docutils literal"><span class="pre">l</span></code> is not provided
it is assumed to be <code class="docutils literal"><span class="pre">1</span></code>.</li>
<li><code class="docutils literal"><span class="pre">existence</span></code> – if <code class="docutils literal"><span class="pre">True</span></code>, then return either <code class="docutils literal"><span class="pre">True</span></code> if Sage knows
how to build such design, <code class="docutils literal"><span class="pre">Unknown</span></code> if it does not and <code class="docutils literal"><span class="pre">False</span></code> if it
knows that the design does not exist.</li>
<li><code class="docutils literal"><span class="pre">explain_construction</span></code> – instead of returning a difference family,
returns a string that explains the construction used.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal"><span class="pre">True</span></code>). If <code class="docutils literal"><span class="pre">True</span></code> then the result of
the computation is checked before being returned. This should not be
needed but ensures that the output is correct.</li>
</ul>
<p>OUTPUT:</p>
<p>A pair <code class="docutils literal"><span class="pre">(G,D)</span></code> made of a group <span class="math">\(G\)</span> and a difference family <span class="math">\(D\)</span> on that
group. Or, if <code class="docutils literal"><span class="pre">existence</span></code> is <code class="docutils literal"><span class="pre">True</span></code> a troolean or if
<code class="docutils literal"><span class="pre">explain_construction</span></code> is <code class="docutils literal"><span class="pre">True</span></code> a string.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">73</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Finite Field of size 73</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[[0, 1, 5, 18],</span>
<span class="go"> [0, 3, 15, 54],</span>
<span class="go"> [0, 9, 45, 16],</span>
<span class="go"> [0, 27, 62, 48],</span>
<span class="go"> [0, 8, 40, 71],</span>
<span class="go"> [0, 24, 47, 67]]</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">73</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">The database contains a (73,4)-evenly distributed set</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Ring of integers modulo 15</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[[0, 1, 2, 4, 5, 8, 10]]</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Singer difference set</span>

<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">91</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Singer difference set</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span> <span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">McFarland 1973 construction</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">576</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="n">explain_construction</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">Hadamard difference set product from N1=2 and N2=3</span>
</pre></div>
</div>
<p>For <span class="math">\(k=6,7\)</span> we look at the set of small prime powers for which a
construction is available:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">prime_power_mod</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">m</span><span class="p">):</span>
<span class="go">....:     k = m+r</span>
<span class="go">....:     while True:</span>
<span class="go">....:         if is_prime_power(k):</span>
<span class="go">....:             yield k</span>
<span class="go">....:         k += m</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">islice</span>
<span class="gp">sage: </span><span class="n">l6</span> <span class="o">=</span> <span class="p">{</span><span class="bp">True</span><span class="p">:[],</span> <span class="bp">False</span><span class="p">:</span> <span class="p">[],</span> <span class="n">Unknown</span><span class="p">:</span> <span class="p">[]}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">prime_power_mod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">30</span><span class="p">),</span> <span class="mi">60</span><span class="p">):</span>
<span class="go">....:     l6[designs.difference_family(q,6,existence=True)].append(q)</span>
<span class="gp">sage: </span><span class="n">l6</span><span class="p">[</span><span class="bp">True</span><span class="p">]</span>
<span class="go">[31, 121, 151, 181, 211, ...,  3061, 3121, 3181]</span>
<span class="gp">sage: </span><span class="n">l6</span><span class="p">[</span><span class="n">Unknown</span><span class="p">]</span>
<span class="go">[61]</span>
<span class="gp">sage: </span><span class="n">l6</span><span class="p">[</span><span class="bp">False</span><span class="p">]</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">l7</span> <span class="o">=</span> <span class="p">{</span><span class="bp">True</span><span class="p">:</span> <span class="p">[],</span> <span class="bp">False</span><span class="p">:</span> <span class="p">[],</span> <span class="n">Unknown</span><span class="p">:</span> <span class="p">[]}</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">islice</span><span class="p">(</span><span class="n">prime_power_mod</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">42</span><span class="p">),</span> <span class="mi">60</span><span class="p">):</span>
<span class="go">....:     l7[designs.difference_family(q,7,existence=True)].append(q)</span>
<span class="gp">sage: </span><span class="n">l7</span><span class="p">[</span><span class="bp">True</span><span class="p">]</span>
<span class="go">[169, 337, 379, 421, 463, 547, 631, 673, 757, 841, 883, 967, ...,  4621, 4957, 5167]</span>
<span class="gp">sage: </span><span class="n">l7</span><span class="p">[</span><span class="n">Unknown</span><span class="p">]</span>
<span class="go">[43, 127, 211, 2017, 2143, 2269, 2311, 2437, 2521, 2647, ..., 4999, 5041, 5209]</span>
<span class="gp">sage: </span><span class="n">l7</span><span class="p">[</span><span class="bp">False</span><span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>List available constructions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">100</span><span class="p">):</span>
<span class="go">....:     constructions = []</span>
<span class="go">....:     for k in range(2,10):</span>
<span class="go">....:         for l in range(1,10):</span>
<span class="go">....:             if designs.difference_family(v,k,l,existence=True):</span>
<span class="go">....:                 constructions.append((k,l))</span>
<span class="go">....:                 _ = designs.difference_family(v,k,l)</span>
<span class="go">....:     if constructions:</span>
<span class="go">....:         print(&quot;%2d: %s&quot;%(v, &#39;, &#39;.join(&#39;(%d,%d)&#39;%(k,l) for k,l in constructions)))</span>
<span class="go"> 3: (2,1)</span>
<span class="go"> 4: (3,2)</span>
<span class="go"> 5: (2,1), (4,3)</span>
<span class="go"> 6: (5,4)</span>
<span class="go"> 7: (2,1), (3,1), (3,2), (4,2), (6,5)</span>
<span class="go"> 8: (7,6)</span>
<span class="go"> 9: (2,1), (4,3), (8,7)</span>
<span class="go">10: (9,8)</span>
<span class="go">11: (2,1), (4,6), (5,2), (5,4), (6,3)</span>
<span class="go">13: (2,1), (3,1), (3,2), (4,1), (4,3), (5,5), (6,5)</span>
<span class="go">15: (3,1), (4,6), (5,6), (7,3)</span>
<span class="go">16: (3,2), (5,4), (6,2)</span>
<span class="go">17: (2,1), (4,3), (5,5), (8,7)</span>
<span class="go">19: (2,1), (3,1), (3,2), (4,2), (6,5), (9,4), (9,8)</span>
<span class="go">21: (3,1), (4,3), (5,1), (6,3), (6,5)</span>
<span class="go">22: (4,2), (6,5), (7,4), (8,8)</span>
<span class="go">23: (2,1)</span>
<span class="go">25: (2,1), (3,1), (3,2), (4,1), (4,3), (6,5), (7,7), (8,7)</span>
<span class="go">27: (2,1), (3,1)</span>
<span class="go">28: (3,2), (6,5)</span>
<span class="go">29: (2,1), (4,3), (7,3), (7,6), (8,4), (8,6)</span>
<span class="go">31: (2,1), (3,1), (3,2), (4,2), (5,2), (5,4), (6,1), (6,5)</span>
<span class="go">33: (3,1), (5,5), (6,5)</span>
<span class="go">34: (4,2)</span>
<span class="go">35: (5,2)</span>
<span class="go">37: (2,1), (3,1), (3,2), (4,1), (4,3), (6,5), (9,2), (9,8)</span>
<span class="go">39: (3,1), (6,5)</span>
<span class="go">40: (3,2), (4,1)</span>
<span class="go">41: (2,1), (4,3), (5,1), (5,4), (6,3), (8,7)</span>
<span class="go">43: (2,1), (3,1), (3,2), (4,2), (6,5), (7,2), (7,3), (7,6), (8,4)</span>
<span class="go">45: (3,1), (5,1)</span>
<span class="go">46: (4,2), (6,2)</span>
<span class="go">47: (2,1)</span>
<span class="go">49: (2,1), (3,1), (3,2), (4,1), (4,3), (6,5), (8,7), (9,3)</span>
<span class="go">51: (3,1), (5,2), (6,3)</span>
<span class="go">52: (4,1)</span>
<span class="go">53: (2,1), (4,3)</span>
<span class="go">55: (3,1), (9,4)</span>
<span class="go">57: (3,1), (7,3), (8,1)</span>
<span class="go">59: (2,1)</span>
<span class="go">61: (2,1), (3,1), (3,2), (4,1), (4,3), (5,1), (5,4), (6,2), (6,3), (6,5)</span>
<span class="go">63: (3,1)</span>
<span class="go">64: (3,2), (4,1), (7,2), (7,6), (9,8)</span>
<span class="go">65: (5,1)</span>
<span class="go">67: (2,1), (3,1), (3,2), (6,5)</span>
<span class="go">69: (3,1)</span>
<span class="go">71: (2,1), (5,2), (5,4), (7,3), (7,6), (8,4)</span>
<span class="go">73: (2,1), (3,1), (3,2), (4,1), (4,3), (6,5), (8,7), (9,1), (9,8)</span>
<span class="go">75: (3,1), (5,2)</span>
<span class="go">76: (4,1)</span>
<span class="go">79: (2,1), (3,1), (3,2), (6,5)</span>
<span class="go">81: (2,1), (3,1), (4,3), (5,1), (5,4), (8,7)</span>
<span class="go">83: (2,1)</span>
<span class="go">85: (4,1), (7,2), (7,3), (8,2)</span>
<span class="go">89: (2,1), (4,3), (8,7)</span>
<span class="go">91: (6,1), (7,1)</span>
<span class="go">97: (2,1), (3,1), (3,2), (4,1), (4,3), (6,5), (8,7), (9,3)</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Implement recursive constructions from Buratti “Recursive for difference
matrices and relative difference families” (1998) and Jungnickel
“Composition theorems for difference families and regular planes” (1978)</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.group_law">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">group_law</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.group_law" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a triple <code class="docutils literal"><span class="pre">(identity,</span> <span class="pre">operation,</span> <span class="pre">inverse)</span></code> that define the
operations on the group <code class="docutils literal"><span class="pre">G</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">group_law</span>
<span class="gp">sage: </span><span class="n">group_law</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(0, &lt;built-in function add&gt;, &lt;built-in function neg&gt;)</span>
<span class="gp">sage: </span><span class="n">group_law</span><span class="p">(</span><span class="n">SymmetricGroup</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">((), &lt;built-in function mul&gt;, &lt;built-in function inv&gt;)</span>
<span class="gp">sage: </span><span class="n">group_law</span><span class="p">(</span><span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">((0, 0, 0), &lt;built-in function add&gt;, &lt;built-in function neg&gt;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.hadamard_difference_set_product">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">hadamard_difference_set_product</code><span class="sig-paren">(</span><em>G1</em>, <em>D1</em>, <em>G2</em>, <em>D2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.hadamard_difference_set_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a product of two Hadamard difference sets.</p>
<p>This product construction appears in <a class="reference internal" href="#tu1984" id="id4">[Tu1984]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">G1,D1</span></code>, <code class="docutils literal"><span class="pre">G2,D2</span></code> – two Hadamard difference sets</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">hadamard_difference_set_product</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">is_difference_family</span>

<span class="gp">sage: </span><span class="n">G1</span><span class="p">,</span><span class="n">D1</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="p">,</span><span class="n">D2</span> <span class="o">=</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G11</span><span class="p">,</span><span class="n">D11</span> <span class="o">=</span> <span class="n">hadamard_difference_set_product</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">D1</span><span class="p">,</span><span class="n">G1</span><span class="p">,</span><span class="n">D1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G11</span><span class="p">,</span> <span class="n">D11</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">56</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G12</span><span class="p">,</span><span class="n">D12</span> <span class="o">=</span> <span class="n">hadamard_difference_set_product</span><span class="p">(</span><span class="n">G1</span><span class="p">,</span><span class="n">D1</span><span class="p">,</span><span class="n">G2</span><span class="p">,</span><span class="n">D2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G12</span><span class="p">,</span> <span class="n">D12</span><span class="p">,</span> <span class="mi">576</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">132</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">designs</span><span class="o">.</span><span class="n">difference_family</span><span class="p">(</span><span class="mi">576</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="n">existence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.combinat.designs.difference_family.hadamard_difference_set_product_parameters">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">hadamard_difference_set_product_parameters</code><a class="headerlink" href="#sage.combinat.designs.difference_family.hadamard_difference_set_product_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>A decorator that creates a cached version of an instance
method of a class.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For proper behavior, the method must be a pure function (no side
effects). Arguments to the method must be hashable or transformed into
something hashable using <code class="docutils literal"><span class="pre">key</span></code> or they must define
<a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject._cache_key" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-meth docutils literal"><span class="pre">sage.structure.sage_object.SageObject._cache_key()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">Foo</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="go">....:     @cached_method</span>
<span class="go">....:     def f(self, t, x=2):</span>
<span class="go">....:         print(&#39;computing&#39;)</span>
<span class="go">....:         return t**x</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">()</span>
</pre></div>
</div>
<p>The example shows that the actual computation
takes place only once, and that the result is
identical for equivalent input:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">res</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">res</span>
<span class="go">computing</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="n">t</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">is</span> <span class="n">res</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="ow">is</span> <span class="n">res</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note, however, that the <code class="xref py py-class docutils literal"><span class="pre">CachedMethod</span></code> is replaced by a
<code class="xref py py-class docutils literal"><span class="pre">CachedMethodCaller</span></code> or <code class="xref py py-class docutils literal"><span class="pre">CachedMethodCallerNoArgs</span></code>
as soon as it is bound to an instance or class:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">I</span> <span class="o">=</span> <span class="n">P</span><span class="o">*</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">I</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">gens</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.misc.cachefunc.CachedMethodCallerNoArgs&#39;&gt;</span>
</pre></div>
</div>
<p>So, you would hardly ever see an instance of this class alive.</p>
<p>The parameter <code class="docutils literal"><span class="pre">key</span></code> can be used to pass a function which creates a
custom cache key for inputs. In the following example, this parameter is
used to ignore the <code class="docutils literal"><span class="pre">algorithm</span></code> keyword for caching:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="go">....:     def _f_normalize(self, x, algorithm): return x</span>
<span class="go">....:     @cached_method(key=_f_normalize)</span>
<span class="go">....:     def f(self, x, algorithm=&#39;default&#39;): return x</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;algorithm&quot;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The parameter <code class="docutils literal"><span class="pre">do_pickle</span></code> can be used to enable pickling of the cache.
Usually the cache is not stored when pickling:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="go">....:     @cached_method</span>
<span class="go">....:     def f(self, x): return None</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">__main__</span>
<span class="gp">sage: </span><span class="n">__main__</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>When <code class="docutils literal"><span class="pre">do_pickle</span></code> is set, the pickle contains the contents of the cache:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="go">....:     @cached_method(do_pickle=True)</span>
<span class="go">....:     def f(self, x): return None</span>
<span class="gp">sage: </span><span class="n">__main__</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">f</span><span class="o">.</span><span class="n">cache</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Cached methods can not be copied like usual methods, see <a class="reference external" href="https://trac.sagemath.org/12603">trac ticket #12603</a>.
Copying them can lead to very surprising results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
<span class="go">....:     @cached_method</span>
<span class="go">....:     def f(self):</span>
<span class="go">....:         return 1</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">B</span><span class="p">:</span>
<span class="go">....:     g=A.f</span>
<span class="go">....:     def f(self):</span>
<span class="go">....:         return 2</span>

<span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="n">B</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">f</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">g</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">f</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.is_difference_family">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">is_difference_family</code><span class="sig-paren">(</span><em>G</em>, <em>D</em>, <em>v=None</em>, <em>k=None</em>, <em>l=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.is_difference_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Check wether <code class="docutils literal"><span class="pre">D</span></code> forms a difference family in the group <code class="docutils literal"><span class="pre">G</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">G</span></code> - group of cardinality <code class="docutils literal"><span class="pre">v</span></code></li>
<li><code class="docutils literal"><span class="pre">D</span></code> - a set of <code class="docutils literal"><span class="pre">k</span></code>-subsets of <code class="docutils literal"><span class="pre">G</span></code></li>
<li><code class="docutils literal"><span class="pre">v</span></code>, <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">l</span></code> - optional parameters of the difference family</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> - whether to print additional information</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.combinat.designs.difference_family.difference_family" title="sage.combinat.designs.difference_family.difference_family"><code class="xref py py-func docutils literal"><span class="pre">difference_family()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">is_difference_family</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">29</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">21</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Too few:</span>
<span class="go">  5 is obtained 0 times in blocks []</span>
<span class="go">  14 is obtained 0 times in blocks []</span>
<span class="go">  27 is obtained 0 times in blocks []</span>
<span class="go">  36 is obtained 0 times in blocks []</span>
<span class="go">Too much:</span>
<span class="go">  4 is obtained 2 times in blocks [0, 1]</span>
<span class="go">  13 is obtained 2 times in blocks [0, 1]</span>
<span class="go">  28 is obtained 2 times in blocks [0, 1]</span>
<span class="go">  37 is obtained 2 times in blocks [0, 1]</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">29</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">22</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">61</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">34</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">45</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">32</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">AdditiveAbelianGroup</span><span class="p">([</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="o">-</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">,</span> <span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="o">-</span><span class="n">d</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="o">+</span><span class="n">d</span><span class="p">],</span>
<span class="go">....:      [c, a+b-d, -b+c, a-b+d, a+b+c],</span>
<span class="go">....:      [-a-b+c+d, a-b-c-d, -a+c-d, b-c+d, a+b],</span>
<span class="go">....:      [-b-d, a+b+d, a-b+c-d, a-b+c, -b+c+d]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following example has a third block with a non-trivial stabilizer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">It is a (15,3,1)-difference family</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The function also supports multiplicative groups (non necessarily Abelian):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DihedralGroup</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">i</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D1</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span><span class="p">,</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.bibd</span> <span class="kn">import</span> <span class="n">BIBD_from_difference_family</span>
<span class="gp">sage: </span><span class="n">bibd</span> <span class="o">=</span> <span class="n">BIBD_from_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D1</span><span class="p">,</span><span class="n">lambd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.mcfarland_1973_construction">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">mcfarland_1973_construction</code><span class="sig-paren">(</span><em>q</em>, <em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.mcfarland_1973_construction" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a difference set.</p>
<p>The difference set returned has the following parameters</p>
<div class="math">
\[v = \frac{q^{s+1}(q^{s+1}+q-2)}{q-1},
k = \frac{q^s (q^{s+1}-1)}{q-1},
\lambda = \frac{q^s(q^s-1)}{q-1}\]</div>
<p>This construction is due to <a class="reference internal" href="#mcf1973" id="id5">[McF1973]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code>, <code class="docutils literal"><span class="pre">s</span></code> - (integers) parameters for the difference set (see the above
formulas for the expression of <code class="docutils literal"><span class="pre">v</span></code>, <code class="docutils literal"><span class="pre">k</span></code>, <code class="docutils literal"><span class="pre">l</span></code> in terms of <code class="docutils literal"><span class="pre">q</span></code> and
<code class="docutils literal"><span class="pre">s</span></code>)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The function <a class="reference internal" href="#sage.combinat.designs.difference_family.are_mcfarland_1973_parameters" title="sage.combinat.designs.difference_family.are_mcfarland_1973_parameters"><code class="xref py py-func docutils literal"><span class="pre">are_mcfarland_1973_parameters()</span></code></a> makes the translation
between the parameters <span class="math">\((q,s)\)</span> corresponding to a given triple
<span class="math">\((v,k,\lambda)\)</span>.</p>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="mcf1973" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[McF1973]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>, <a class="fn-backref" href="#id5">3</a>)</em> Robert L. McFarland
“A family of difference sets in non-cyclic groups”
J. Combinatorial Theory (A) 15 (1973) 1–10.
<a class="reference external" href="https://doi.org/10.1016/0097-3165(73)90031-9">doi:10.1016/0097-3165(73)90031-9</a></td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="p">(</span>
<span class="go">....:    mcfarland_1973_construction, is_difference_family)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">mcfarland_1973_construction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">mcfarland_1973_construction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.one_cyclic_tiling">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">one_cyclic_tiling</code><span class="sig-paren">(</span><em>A</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.one_cyclic_tiling" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a subset <code class="docutils literal"><span class="pre">A</span></code> of the cyclic additive group <span class="math">\(G = Z / nZ\)</span> return
another subset <span class="math">\(B\)</span> so that <span class="math">\(A + B = G\)</span> and <span class="math">\(|A| |B| = n\)</span> (i.e. any element
of <span class="math">\(G\)</span> is uniquely expressed as a sum <span class="math">\(a+b\)</span> with <span class="math">\(a\)</span> in <span class="math">\(A\)</span> and <span class="math">\(b\)</span> in <span class="math">\(B\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">one_cyclic_tiling</span>
<span class="gp">sage: </span><span class="n">tile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">one_cyclic_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span> <span class="n">m</span>
<span class="go">[0, 3]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">((</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">6</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tile</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">m</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5]</span>

<span class="gp">sage: </span><span class="k">def</span> <span class="nf">print_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">translat</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="go">....:     for x in translat:</span>
<span class="go">....:         print(&#39;&#39;.join(&#39;X&#39; if (i-x)%n in tile else &#39;.&#39; for i in range(n)))</span>

<span class="gp">sage: </span><span class="n">tile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">one_cyclic_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">print_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">XXX....X....</span>
<span class="go">....XXX....X</span>
<span class="go">...X....XXX.</span>

<span class="gp">sage: </span><span class="n">tile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">one_cyclic_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">print_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="go">XX...X......</span>
<span class="go">...XX...X...</span>
<span class="go">......XX...X</span>
<span class="go">..X......XX.</span>

<span class="gp">sage: </span><span class="n">tile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">one_cyclic_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">print_tiling</span><span class="p">(</span><span class="n">tile</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="go">X.X.....</span>
<span class="go">....X.X.</span>
<span class="go">.X.X....</span>
<span class="go">.....X.X</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses dancing links <a class="reference internal" href="../dlx.html#module-sage.combinat.dlx" title="sage.combinat.dlx"><code class="xref py py-mod docutils literal"><span class="pre">sage.combinat.dlx</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.one_radical_difference_family">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">one_radical_difference_family</code><span class="sig-paren">(</span><em>K</em>, <em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.one_radical_difference_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Search for a radical difference family on <code class="docutils literal"><span class="pre">K</span></code> using dancing links
algorithm.</p>
<p>For the definition of radical difference family, see
<a class="reference internal" href="#sage.combinat.designs.difference_family.radical_difference_family" title="sage.combinat.designs.difference_family.radical_difference_family"><code class="xref py py-func docutils literal"><span class="pre">radical_difference_family()</span></code></a>. Here, we consider only radical difference
family with <span class="math">\(\lambda = 1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> – a finite field of cardinality <span class="math">\(q\)</span>.</li>
<li><code class="docutils literal"><span class="pre">k</span></code> – a positive integer so that <span class="math">\(k(k-1)\)</span> divides <span class="math">\(q-1\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>Either a difference family or <code class="docutils literal"><span class="pre">None</span></code> if it does not exist.</p>
<p>ALGORITHM:</p>
<p>The existence of a radical difference family is equivalent to a one
dimensional tiling (or packing) problem in a cyclic group. This subsequent
problem is solved by a call to the function <a class="reference internal" href="#sage.combinat.designs.difference_family.one_cyclic_tiling" title="sage.combinat.designs.difference_family.one_cyclic_tiling"><code class="xref py py-func docutils literal"><span class="pre">one_cyclic_tiling()</span></code></a>.</p>
<blockquote>
<div><p>Let <span class="math">\(K^*\)</span> be the multiplicative group of the finite field <span class="math">\(K\)</span>. A radical
family has the form <span class="math">\(\mathcal B = \{x_1 B, \ldots, x_k B\}\)</span>, where
<span class="math">\(B=\{x:x^{k}=1\}\)</span> (for <span class="math">\(k\)</span> odd) or <span class="math">\(B=\{x:x^{k-1}=1\}\cup \{0\}\)</span> (for
<span class="math">\(k\)</span> even). Equivalently, <span class="math">\(K^*\)</span> decomposes as:</p>
<div class="math">
\[K^* = \Delta (x_1 B) \cup ... \cup \Delta (x_k B) = x_1 \Delta B \cup ... \cup x_k \Delta B\]</div>
<p>We observe that <span class="math">\(C=B\backslash 0\)</span> is a subgroup of the (cyclic) group
<span class="math">\(K^*\)</span>, that can thus be generated by some element <span class="math">\(r\)</span>. Furthermore, we
observe that <span class="math">\(\Delta B\)</span> is always a union of cosets of <span class="math">\(\pm C\)</span> (which is
twice larger than <span class="math">\(C\)</span>).</p>
<div class="math">
\[\begin{split}\begin{array}{llll}
(k\text{ odd} ) &amp; \Delta B &amp;= \{r^i-r^j:r^i\neq r^j\} &amp;= \pm C\cdot \{r^i-1: 0 &lt; i \leq m\}\\
(k\text{ even}) &amp; \Delta B &amp;= \{r^i-r^j:r^i\neq r^j\}\cup C &amp;= \pm C\cdot \{r^i-1: 0 &lt; i &lt; m\}\cup \pm C
\end{array}\end{split}\]</div>
<p>where</p>
<div class="math">
\[(k\text{ odd})\ m = (k-1)/2 \quad \text{and} \quad (k\text{ even})\ m = k/2.\]</div>
<p>Consequently, <span class="math">\(\mathcal B = \{x_1 B, \ldots, x_k B\}\)</span> is a radical
difference family if and only if <span class="math">\(\{x_1 (\Delta B/(\pm C)), \ldots, x_k
(\Delta B/(\pm C))\}\)</span> is a partition of the cyclic group <span class="math">\(K^*/(\pm C)\)</span>.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="p">(</span>
<span class="go">....:    one_radical_difference_family,</span>
<span class="go">....:    is_difference_family)</span>

<span class="gp">sage: </span><span class="n">one_radical_difference_family</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">13</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[0, 1, 3, 9]]</span>
</pre></div>
</div>
<p>The parameters that appear in <a class="reference internal" href="#bu95" id="id6">[Bu95]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">df</span> <span class="o">=</span> <span class="n">one_radical_difference_family</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">449</span><span class="p">),</span> <span class="mi">8</span><span class="p">);</span> <span class="n">df</span>
<span class="go">[[0, 1, 18, 25, 176, 324, 359, 444],</span>
<span class="go"> [0, 9, 88, 162, 222, 225, 237, 404],</span>
<span class="go"> [0, 11, 140, 198, 275, 357, 394, 421],</span>
<span class="go"> [0, 40, 102, 249, 271, 305, 388, 441],</span>
<span class="go"> [0, 49, 80, 93, 161, 204, 327, 433],</span>
<span class="go"> [0, 70, 99, 197, 230, 362, 403, 435],</span>
<span class="go"> [0, 121, 141, 193, 293, 331, 335, 382],</span>
<span class="go"> [0, 191, 285, 295, 321, 371, 390, 392]]</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">449</span><span class="p">),</span> <span class="n">df</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.radical_difference_family">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">radical_difference_family</code><span class="sig-paren">(</span><em>K</em>, <em>k</em>, <em>l=1</em>, <em>existence=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.radical_difference_family" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="docutils literal"><span class="pre">(v,k,l)</span></code>-radical difference family.</p>
<p>Let fix an integer <span class="math">\(k\)</span> and a prime power <span class="math">\(q = t k(k-1) + 1\)</span>. Let <span class="math">\(K\)</span> be a
field of cardinality <span class="math">\(q\)</span>. A <span class="math">\((q,k,1)\)</span>-difference family is <em>radical</em> if
its base blocks are either: a coset of the <span class="math">\(k\)</span>-th root of unity for <span class="math">\(k\)</span> odd
or a coset of <span class="math">\(k-1\)</span>-th root of unity and <span class="math">\(0\)</span> if <span class="math">\(k\)</span> is even (the number <span class="math">\(t\)</span>
is the number of blocks of that difference family).</p>
<p>The terminology comes from M. Buratti article <a class="reference internal" href="#bu95" id="id7">[Bu95]</a> but the first
constructions go back to R. Wilson <a class="reference internal" href="#wi72" id="id8">[Wi72]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">K</span></code> - a finite field</li>
<li><code class="docutils literal"><span class="pre">k</span></code> – positive integer, the size of the blocks</li>
<li><code class="docutils literal"><span class="pre">l</span></code> – the <span class="math">\(\lambda\)</span> parameter (default to <span class="math">\(1\)</span>)</li>
<li><code class="docutils literal"><span class="pre">existence</span></code> – if <code class="docutils literal"><span class="pre">True</span></code>, then return either <code class="docutils literal"><span class="pre">True</span></code> if Sage knows
how to build such design, <code class="docutils literal"><span class="pre">Unknown</span></code> if it does not and <code class="docutils literal"><span class="pre">False</span></code> if it
knows that the design does not exist.</li>
<li><code class="docutils literal"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal"><span class="pre">True</span></code>). If <code class="docutils literal"><span class="pre">True</span></code> then the result of
the computation is checked before being returned. This should not be
needed but ensures that the output is correct.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">radical_difference_family</span>

<span class="gp">sage: </span><span class="n">radical_difference_family</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">73</span><span class="p">),</span><span class="mi">9</span><span class="p">)</span>
<span class="go">[[1, 2, 4, 8, 16, 32, 37, 55, 64]]</span>

<span class="gp">sage: </span><span class="n">radical_difference_family</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">281</span><span class="p">),</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[1, 86, 90, 153, 232],</span>
<span class="go"> [4, 50, 63, 79, 85],</span>
<span class="go"> [5, 36, 149, 169, 203],</span>
<span class="go"> [7, 40, 68, 219, 228],</span>
<span class="go"> [9, 121, 212, 248, 253],</span>
<span class="go"> [29, 81, 222, 246, 265],</span>
<span class="go"> [31, 137, 167, 247, 261],</span>
<span class="go"> [32, 70, 118, 119, 223],</span>
<span class="go"> [39, 56, 66, 138, 263],</span>
<span class="go"> [43, 45, 116, 141, 217],</span>
<span class="go"> [98, 101, 109, 256, 279],</span>
<span class="go"> [106, 124, 145, 201, 267],</span>
<span class="go"> [111, 123, 155, 181, 273],</span>
<span class="go"> [156, 209, 224, 264, 271]]</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
<span class="go">....:     print(&quot;k = {}&quot;.format(k))</span>
<span class="go">....:     list_q = []</span>
<span class="go">....:     for q in range(k*(k-1)+1, 2000, k*(k-1)):</span>
<span class="go">....:          if is_prime_power(q):</span>
<span class="go">....:              K = GF(q,&#39;a&#39;)</span>
<span class="go">....:              if radical_difference_family(K, k, existence=True):</span>
<span class="go">....:                  list_q.append(q)</span>
<span class="go">....:                  _ = radical_difference_family(K,k)</span>
<span class="go">....:     print(&quot; &quot;.join([str(p) for p in list_q]))</span>
<span class="go">k = 5</span>
<span class="go">41 61 81 241 281 401 421 601 641 661 701 761 821 881 1181 1201 1301 1321</span>
<span class="go">1361 1381 1481 1601 1681 1801 1901</span>
<span class="go">k = 6</span>
<span class="go">181 211 241 631 691 1531 1831 1861</span>
<span class="go">k = 7</span>
<span class="go">337 421 463 883 1723</span>
<span class="go">k = 8</span>
<span class="go">449 1009</span>
<span class="go">k = 9</span>
<span class="go">73 1153 1873</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.radical_difference_set">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">radical_difference_set</code><span class="sig-paren">(</span><em>K</em>, <em>k</em>, <em>l=1</em>, <em>existence=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.radical_difference_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a difference set made of a cyclotomic coset in the finite field
<code class="docutils literal"><span class="pre">K</span></code> and with parameters <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">l</span></code>.</p>
<p>Most of these difference sets appear in chapter VI.18.48 of the Handbook of
combinatorial designs.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">radical_difference_set</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">radical_difference_set</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">D</span>
<span class="go">[[1, 2, 4]]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">radical_difference_set</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">x</span> <span class="o">!=</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[1,</span>
<span class="go"> 1,</span>
<span class="go"> a,</span>
<span class="go"> a,</span>
<span class="go"> a + 1,</span>
<span class="go"> a + 1,</span>
<span class="go"> a^2,</span>
<span class="go"> a^2,</span>
<span class="go"> ...</span>
<span class="go"> a^3 + a^2 + a + 1,</span>
<span class="go"> a^3 + a^2 + a + 1]</span>

<span class="gp">sage: </span><span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">):</span>
<span class="go">....:     for l in reversed(divisors(k*(k-1))):</span>
<span class="go">....:         v = k*(k-1)//l + 1</span>
<span class="go">....:         if is_prime_power(v) and radical_difference_set(GF(v,&#39;a&#39;),k,l,existence=True):</span>
<span class="go">....:             _ = radical_difference_set(GF(v,&#39;a&#39;),k,l)</span>
<span class="go">....:             print(&quot;{:3} {:3} {:3}&quot;.format(v,k,l))</span>
<span class="go">  3   2   1</span>
<span class="go">  4   3   2</span>
<span class="go">  7   3   1</span>
<span class="go">  5   4   3</span>
<span class="go">  7   4   2</span>
<span class="go"> 13   4   1</span>
<span class="go"> 11   5   2</span>
<span class="go">  7   6   5</span>
<span class="go"> 11   6   3</span>
<span class="go"> 16   6   2</span>
<span class="go">  8   7   6</span>
<span class="go">  9   8   7</span>
<span class="go"> 19   9   4</span>
<span class="go"> 37   9   2</span>
<span class="go"> 73   9   1</span>
<span class="go"> 11  10   9</span>
<span class="go"> 19  10   5</span>
<span class="go"> 23  11   5</span>
<span class="go"> 13  12  11</span>
<span class="go"> 23  12   6</span>
<span class="go"> 27  13   6</span>
<span class="go"> 27  14   7</span>
<span class="go"> 16  15  14</span>
<span class="go"> 31  15   7</span>
<span class="gp">...</span>
<span class="go"> 41  40  39</span>
<span class="go"> 79  40  20</span>
<span class="go"> 83  41  20</span>
<span class="go"> 43  42  41</span>
<span class="go"> 83  42  21</span>
<span class="go"> 47  46  45</span>
<span class="go"> 49  48  47</span>
<span class="go">197  49  12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.singer_difference_set">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">singer_difference_set</code><span class="sig-paren">(</span><em>q</em>, <em>d</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.singer_difference_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a difference set associated to the set of hyperplanes in a projective
space of dimension <span class="math">\(d\)</span> over <span class="math">\(GF(q)\)</span>.</p>
<p>A Singer difference set has parameters:</p>
<div class="math">
\[v = \frac{q^{d+1}-1}{q-1}, \quad
k = \frac{q^d-1}{q-1}, \quad
\lambda = \frac{q^{d-1}-1}{q-1}.\]</div>
<p>The idea of the construction is as follows. One consider the finite field
<span class="math">\(GF(q^{d+1})\)</span> as a vector space of dimension <span class="math">\(d+1\)</span> over <span class="math">\(GF(q)\)</span>. The set of
<span class="math">\(GF(q)\)</span>-lines in <span class="math">\(GF(q^{d+1})\)</span> is a projective plane and its set of
hyperplanes form a balanced incomplete block design.</p>
<p>Now, considering a multiplicative generator <span class="math">\(z\)</span> of <span class="math">\(GF(q^{d+1})\)</span>, we get a
transitive action of a cyclic group on our projective plane from which it is
possible to build a difference set.</p>
<p>The construction is given in details in <a class="reference internal" href="latin_squares.html#stinson2004" id="id9">[Stinson2004]</a>, section 3.3.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">singer_difference_set</span><span class="p">,</span> <span class="n">is_difference_family</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">singer_difference_set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">It is a (13,4,1)-difference family</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">singer_difference_set</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">It is a (21,5,1)-difference family</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">singer_difference_set</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">It is a (40,13,4)-difference family</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">singer_difference_set</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">It is a (820,91,10)-difference family</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.turyn_1965_3x3xK">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">turyn_1965_3x3xK</code><span class="sig-paren">(</span><em>k=4</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.turyn_1965_3x3xK" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a difference set in either <span class="math">\(C_3 \times C_3 \times C_4\)</span> or <span class="math">\(C_3 \times
C_3 \times C_2 \times C_2\)</span> with parameters <span class="math">\(v=36\)</span>, <span class="math">\(k=15\)</span>, <span class="math">\(\lambda=6\)</span>.</p>
<p>This example appears in <a class="reference internal" href="#tu1965" id="id10">[Tu1965]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k</span></code> – either <code class="docutils literal"><span class="pre">2</span></code> (to get a difference set in <span class="math">\(C_3 \times C_3 \times
C_2 \times C_2\)</span>) or <code class="docutils literal"><span class="pre">4</span></code> (to get a difference set in <span class="math">\(C_3 \times C_3
\times C_3 \times C_4\)</span>).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">turyn_1965_3x3xK</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">is_difference_family</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">turyn_1965_3x3xK</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">turyn_1965_3x3xK</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">assert</span> <span class="n">is_difference_family</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.combinat.designs.difference_family.twin_prime_powers_difference_set">
<code class="descclassname">sage.combinat.designs.difference_family.</code><code class="descname">twin_prime_powers_difference_set</code><span class="sig-paren">(</span><em>p</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.combinat.designs.difference_family.twin_prime_powers_difference_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a difference set on <span class="math">\(GF(p) \times GF(p+2)\)</span>.</p>
<p>The difference set is built from the following element of the Cartesian
product of finite fields <span class="math">\(GF(p) \times GF(p+2)\)</span>:</p>
<ul class="simple">
<li><span class="math">\((x,0)\)</span> with any <span class="math">\(x\)</span></li>
<li><span class="math">\((x,y)\)</span> with <span class="math">\(x\)</span> and <span class="math">\(y\)</span> squares</li>
<li><span class="math">\((x,y)\)</span> with <span class="math">\(x\)</span> and <span class="math">\(y\)</span> non-squares</li>
</ul>
<p>For more information see <a class="reference external" href="https://en.wikipedia.org/wiki/Difference_set">Wikipedia article Difference_set</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal"><span class="pre">True</span></code>). If <code class="docutils literal"><span class="pre">True</span></code> then the result of
the computation is checked before being returned. This should not be
needed but ensures that the output is correct.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.designs.difference_family</span> <span class="kn">import</span> <span class="n">twin_prime_powers_difference_set</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span><span class="n">D</span> <span class="o">=</span> <span class="n">twin_prime_powers_difference_set</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">The Cartesian product of (Finite Field of size 3, Finite Field of size 5)</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[[(1, 1), (1, 4), (2, 2), (2, 3), (0, 0), (1, 0), (2, 0)]]</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../../../index.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference internal" href="#">Difference families</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="designs_pyx.html"
                                  title="previous chapter">Cython functions for combinatorial designs</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="difference_matrices.html"
                                  title="next chapter">Difference Matrices</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/combinat/designs/difference_family.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="difference_matrices.html" title="Difference Matrices"
             >next</a> |</li>
        <li class="right" >
          <a href="designs_pyx.html" title="Cython functions for combinatorial designs"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Combinatorics</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../module_list.html" >Comprehensive Module list</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>