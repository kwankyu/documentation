
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Utilities for Sage-mpmath interaction &#8212; C/C++ Library Interfaces</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Victor Shoup’s NTL C++ Library" href="../ntl/all.html" />
    <link rel="prev" title="An interface to Anders Buch’s Littlewood-Richardson Calculator lrcalc" href="../lrcalc/lrcalc.html" />
  <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
  <!-- <script src="../../../../_static/thebe.js" type="text/javascript"></script> -->
  <!-- <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script> -->

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ntl/all.html" title="Victor Shoup’s NTL C++ Library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../lrcalc/lrcalc.html" title="An interface to Anders Buch’s Littlewood-Richardson Calculator lrcalc"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">C/C++ Library Interfaces</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Utilities for Sage-mpmath interaction</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="utilities-for-sage-mpmath-interaction">
<span id="sage-libs-mpmath-utils"></span><h1>Utilities for Sage-mpmath interaction<a class="headerlink" href="#utilities-for-sage-mpmath-interaction" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.libs.mpmath.utils"></span><p>Also patches some mpmath functions for speed</p>
<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.bitcount">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">bitcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.bitcount" title="Permalink to this definition">¶</a></dt>
<dd><p>Bitcount of a Sage Integer or Python int/long.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">mpmath.libmp</span> <span class="kn">import</span> <span class="n">bitcount</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="mi">2</span><span class="n">r</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">bitcount</span><span class="p">(</span><span class="mi">2</span><span class="n">L</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.call">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.call" title="Permalink to this definition">¶</a></dt>
<dd><p>Call an mpmath function with Sage objects as inputs and
convert the result back to a Sage real or complex number.</p>
<p>By default, a RealNumber or ComplexNumber with the current
working precision of mpmath (mpmath.mp.prec) will be returned.</p>
<p>If prec=n is passed among the keyword arguments, the temporary
working precision will be set to n and the result will also
have this precision.</p>
<p>If parent=P is passed, P.prec() will be used as working
precision and the result will be coerced to P (or the
corresponding complex field if necessary).</p>
<p>Arguments should be Sage objects that can be coerced into RealField
or ComplexField elements. Arguments may also be tuples, lists or
dicts (which are converted recursively), or any type that mpmath
understands natively (e.g. Python floats, strings for options).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.libs.mpmath.all</span> <span class="k">as</span> <span class="nn">a</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">53</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">erf</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">-120.186991395079 - 27.7503372936239*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">0.153548951541433 + 0.875114412499637*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">barnesg</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">-0.000676375932234244 - 0.0000442236140124728*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">barnesg</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">0.000000000000000</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">hyper</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1.10703578162508</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">hyper</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1.95762943509305</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">quad</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">erf</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">0.486064958112256</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">gammainc</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">-274.18871130777160922270612331 + 101.59521032382593402947725236*I</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">gammainc</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">-274.18871130777160922270612331 + 101.59521032382593402947725236*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">erf</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">erf</span><span class="p">,</span> <span class="o">-</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">-1.00000000000000</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">gamma</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">+infinity</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">RR</span><span class="p">)</span>
<span class="go">0.582240526465012</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">RR</span><span class="p">)</span>
<span class="go">2.46740110027234 - 2.17758609030360*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">0.58224052646501250590265632016</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="go">2.4674011002723396547086227500 - 2.1775860903036021305006888982*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">CC</span><span class="p">)</span>
<span class="go">0.582240526465012</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.complex_mpfr.ComplexNumber&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">polylog</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="n">RDF</span><span class="p">)</span>
<span class="go">0.5822405264650125</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.rings.real_double...RealDoubleElement...&#39;&gt;</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/11885">trac ticket #11885</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">ei</span><span class="p">,</span> <span class="mf">1.0</span><span class="n">r</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="go">1.8951178163559366</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/14984">trac ticket #14984</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="n">r</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="go">3.141592653589793j</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.from_man_exp">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">from_man_exp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'d'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.from_man_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create normalized mpf value tuple from mantissa and exponent.</p>
<p>With prec &gt; 0, rounds the result in the desired direction
if necessary.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">mpmath.libmp</span> <span class="kn">import</span> <span class="n">from_man_exp</span>
<span class="gp">sage: </span><span class="n">from_man_exp</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, 3, 0, 2)</span>
<span class="gp">sage: </span><span class="n">from_man_exp</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">)</span>
<span class="go">(1, 1, 1, 1)</span>
<span class="gp">sage: </span><span class="n">from_man_exp</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="go">(1, 1, 2, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.isqrt">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">isqrt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.isqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Square root (rounded to floor) of a Sage Integer or Python int/long.
The result is a Sage Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">mpmath.libmp</span> <span class="kn">import</span> <span class="n">isqrt</span>
<span class="gp">sage: </span><span class="n">isqrt</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">isqrt</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">isqrt</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">isqrt</span><span class="p">(</span><span class="mi">10</span><span class="n">r</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">isqrt</span><span class="p">(</span><span class="mi">10</span><span class="n">L</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.mpmath_to_sage">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">mpmath_to_sage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.mpmath_to_sage" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert any mpmath number (mpf or mpc) to a Sage RealNumber or
ComplexNumber of the given precision.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.libs.mpmath.all</span> <span class="k">as</span> <span class="nn">a</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpf</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">2.50000000000000</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpc</span><span class="p">(</span><span class="s1">&#39;2.5&#39;</span><span class="p">,</span><span class="s1">&#39;-3.5&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">2.50000000000000 - 3.50000000000000*I</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpf</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">+infinity</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpf</span><span class="p">(</span><span class="s1">&#39;-inf&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">-infinity</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpf</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">NaN</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">mpf</span><span class="p">(</span><span class="s1">&#39;0&#39;</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
<p>A real example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">3.1415926535897932384626433833</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">_mpmath_</span><span class="p">();</span> <span class="n">t</span>
<span class="go">mpf(&#39;3.1415926535897932&#39;)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">3.1415926535897932384626433833</span>
</pre></div>
</div>
<p>We can ask for more precision, but the result is undefined:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">140</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">3.1415926535897932384626433832793333156440</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">140</span><span class="p">)(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">3.1415926535897932384626433832795028841972</span>
</pre></div>
</div>
<p>A complex example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)([</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">])</span>
<span class="go">3.1415926535897932384626433833*I</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)([</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">])</span><span class="o">.</span><span class="n">_mpmath_</span><span class="p">();</span> <span class="n">t</span>
<span class="go">mpc(real=&#39;0.0&#39;, imag=&#39;3.1415926535897932&#39;)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">libs</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">3.1415926535897932384626433833*I</span>
</pre></div>
</div>
<p>Again, we can ask for more precision, but the result is undefined:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">libs</span><span class="o">.</span><span class="n">mpmath</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">mpmath_to_sage</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">140</span><span class="p">)</span> <span class="c1"># random</span>
<span class="go">3.1415926535897932384626433832793333156440*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">140</span><span class="p">)([</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">])</span>
<span class="go">3.1415926535897932384626433832795028841972*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.normalize">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sign</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">man</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rnd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Create normalized mpf value tuple from full list of components.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">mpmath.libmp</span> <span class="kn">import</span> <span class="n">normalize</span>
<span class="gp">sage: </span><span class="n">normalize</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>
<span class="go">(0, 1, 7, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.libs.mpmath.utils.sage_to_mpmath">
<span class="sig-prename descclassname"><span class="pre">sage.libs.mpmath.utils.</span></span><span class="sig-name descname"><span class="pre">sage_to_mpmath</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.libs.mpmath.utils.sage_to_mpmath" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert any Sage number that can be coerced into a RealNumber
or ComplexNumber of the given precision into an mpmath mpf or mpc.
Integers are currently converted to int.</p>
<p>Lists, tuples and dicts passed as input are converted
recursively.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.libs.mpmath.all</span> <span class="k">as</span> <span class="nn">a</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">mp</span><span class="o">.</span><span class="n">dps</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">53</span><span class="p">))</span>
<span class="go">0.666666666666667</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="mf">2.</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">53</span><span class="p">))</span>
<span class="go">0.666666666666667</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">53</span><span class="p">))</span>
<span class="go">(3.0 + 4.0j)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">pi</span><span class="p">,</span> <span class="mi">53</span><span class="p">))</span>
<span class="go">4.14159265358979</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">mpf(&#39;+inf&#39;)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">mpf(&#39;-inf&#39;)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="n">NaN</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">mpf(&#39;nan&#39;)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">[mpf(&#39;0.5&#39;), mpf(&#39;1.5&#39;)]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">),</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">(mpf(&#39;0.5&#39;), mpf(&#39;1.5&#39;))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage_to_mpmath</span><span class="p">({</span><span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">},</span> <span class="mi">53</span><span class="p">)</span>
<span class="go">{&#39;n&#39;: mpf(&#39;0.5&#39;)}</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="../lrcalc/lrcalc.html"
                          title="previous chapter">An interface to Anders Buch’s Littlewood-Richardson Calculator <code class="docutils literal notranslate"><span class="pre">lrcalc</span></code></a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="../ntl/all.html"
                          title="next chapter">Victor Shoup’s NTL C++ Library</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/libs/mpmath/utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ntl/all.html" title="Victor Shoup’s NTL C++ Library"
             >next</a> |</li>
        <li class="right" >
          <a href="../lrcalc/lrcalc.html" title="An interface to Anders Buch’s Littlewood-Richardson Calculator lrcalc"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">C/C++ Library Interfaces</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Utilities for Sage-mpmath interaction</a></li> 
      </ul>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
  </script>
  <script type="text/javascript">
/* detex the document title by removing "\(", "\)", "\", "$" */
document.title = document.title.replace(/\\\(/g, '').replace(/\\\)/g, '').replace(/\\/g, '').replace(/\$/g, '');
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>