
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Canonical augmentation &#8212; Sage 9.1 Reference Manual: Groups</title>
    <link rel="stylesheet" href="../../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Data structures" href="data_structures.html" />
    <link rel="prev" title="Nilpotent Lie groups" href="../../lie_gps/nilpotent_lie_group.html" />
    <link rel="icon" href="../../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_structures.html" title="Data structures"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../lie_gps/nilpotent_lie_group.html" title="Nilpotent Lie groups"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../../index.html"><img src="../../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Sage 9.1 Reference Manual: Groups</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="canonical-augmentation">
<span id="sage-groups-perm-gps-partn-ref-canonical-augmentation"></span><h1>Canonical augmentation<a class="headerlink" href="#canonical-augmentation" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.groups.perm_gps.partn_ref.canonical_augmentation"></span><p>This module implements a general algorithm for generating isomorphism classes
of objects. The class of objects in question must be some kind of structure
which can be built up out of smaller objects by a process of augmentation,
and for which an automorphism is a permutation in <span class="math notranslate nohighlight">\(S_n\)</span> for some <span class="math notranslate nohighlight">\(n\)</span>. This
process consists of starting with a finite number of “seed objects” and
building up to more complicated objects by a sequence of “augmentations.” It
should be noted that the word “canonical” in the term canonical augmentation
is used loosely. Given an object <span class="math notranslate nohighlight">\(X\)</span>, one must define a canonical parent
<span class="math notranslate nohighlight">\(M(X)\)</span>, which is essentially an arbitrary choice.</p>
<p>The class of objects in question must satisfy the assumptions made in the
module <code class="docutils literal notranslate"><span class="pre">automorphism_group_canonical_label</span></code>, in particular the three
custom functions mentioned there must be implemented:</p>
<ol class="upperalpha">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">refine_and_return_invariant</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">refine_and_return_invariant(PartitionStack</span> <span class="pre">*PS,</span> <span class="pre">void</span> <span class="pre">*S,</span> <span class="pre">int</span> <span class="pre">*cells_to_refine_by,</span> <span class="pre">int</span> <span class="pre">ctrb_len)</span></code></p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">compare_structures</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">compare_structures(int</span> <span class="pre">*gamma_1,</span> <span class="pre">int</span> <span class="pre">*gamma_2,</span> <span class="pre">void</span> <span class="pre">*S1,</span> <span class="pre">void</span> <span class="pre">*S2,</span> <span class="pre">int</span> <span class="pre">degree)</span></code></p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">all_children_are_equivalent</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">bint</span> <span class="pre">all_children_are_equivalent(PartitionStack</span> <span class="pre">*PS,</span> <span class="pre">void</span> <span class="pre">*S)</span></code></p>
</div></blockquote>
</li>
</ol>
<p>In the following functions there is frequently a mem_err input. This is a
pointer to an integer which must be set to a nonzero value in case of an
allocation failure. Other functions have an int return value which serves the
same purpose. The idea is that if a memory error occurs, the canonical
generator should still be able to iterate over the objects already generated
before it terminates.</p>
<p>More details about these functions can be found in that module. In addition,
several other functions must be implemented, which will make use of the
following:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">ctypedef struct iterator:</span>
<span class="go">    void *data</span>
<span class="go">    void *(*next)(void *data, int *degree, int *mem_err)</span>
</pre></div>
</div>
<p>The following functions must be implemented for each specific type of object to
be generated. Each function following which takes a <code class="docutils literal notranslate"><span class="pre">mem_err</span></code> variable as
input should make use of this variable.</p>
<ol class="upperalpha" start="4">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">generate_children</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">generate_children(void</span> <span class="pre">*S,</span> <span class="pre">aut_gp_and_can_lab</span> <span class="pre">*group,</span> <span class="pre">iterator</span> <span class="pre">*it)</span></code></p>
<p>This function receives a pointer to an iterator <code class="docutils literal notranslate"><span class="pre">it</span></code>. The iterator
has two fields: <code class="docutils literal notranslate"><span class="pre">data</span></code> and <code class="docutils literal notranslate"><span class="pre">next</span></code>. The function <code class="docutils literal notranslate"><span class="pre">generate_children</span></code>
should set these two fields, returning 1 to indicate a memory error, or 0
for no error.</p>
<p>The function that <code class="docutils literal notranslate"><span class="pre">next</span></code> points to takes <code class="docutils literal notranslate"><span class="pre">data</span></code> as an argument, and
should return a (<code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>) pointer to the next object to be iterated. It
also takes a pointer to an int, and must update that int to reflect the
degree of each generated object. The objects to be iterated over should
satisfy the property that if <span class="math notranslate nohighlight">\(\gamma\)</span> is an automorphism of the parent
object <span class="math notranslate nohighlight">\(S\)</span>, then for any two child objects <span class="math notranslate nohighlight">\(C_1, C_2\)</span> given by the iterator,
it is not the case that <span class="math notranslate nohighlight">\(\gamma(C_1) = C_2\)</span>, where in the latter <span class="math notranslate nohighlight">\(\gamma\)</span> is
appropriately extended if necessary to operate on <span class="math notranslate nohighlight">\(C_1\)</span> and <span class="math notranslate nohighlight">\(C_2\)</span>. It is
essential for this iterator to handle its own <code class="docutils literal notranslate"><span class="pre">data</span></code>. If the <code class="docutils literal notranslate"><span class="pre">next</span></code>
function is called and no suitable object is yielded, a NULL pointer
indicates a termination of the iteration. At this point, the data pointed to
by the <code class="docutils literal notranslate"><span class="pre">data</span></code> variable should be cleared by the <code class="docutils literal notranslate"><span class="pre">next</span></code> function, because
the iterator struct itself will be deallocated.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">next</span></code> function must check <code class="docutils literal notranslate"><span class="pre">mem_err[0]</span></code> before proceeding. If it is
nonzero then the function should deallocate the iterator right away and
return NULL to end the iteration. This ensures that the canonical
augmentation software will finish iterating over the objects found before
finishing, and the <code class="docutils literal notranslate"><span class="pre">mem_err</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">canonical_generator_data</span></code>
will reflect this.</p>
<p>The objects which the iterator generates can be thought of as augmentations,
which the following function must turn into objects.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">apply_augmentation</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*apply_augmentation(void</span> <span class="pre">*parent,</span> <span class="pre">void</span> <span class="pre">*aug,</span> <span class="pre">void</span> <span class="pre">*child,</span> <span class="pre">int</span> <span class="pre">*degree,</span> <span class="pre">bint</span> <span class="pre">*mem_err)</span></code></p>
<p>This function takes the <code class="docutils literal notranslate"><span class="pre">parent</span></code>, applies the augmentation <code class="docutils literal notranslate"><span class="pre">aug</span></code> and
returns a pointer to the corresponding child object (freeing aug if
necessary). Should also update degree[0] to be the degree of the new child.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">free_object</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">free_object(void</span> <span class="pre">*child)</span></code></p>
<p>This function is a simple deallocation function for children which are not
canonically generated, and therefore rejected in the canonical augmentation
process. They should deallocate the contents of <code class="docutils literal notranslate"><span class="pre">child</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">free_iter_data</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">free_iter_data(void</span> <span class="pre">*data)</span></code></p>
<p>This function deallocates the data part of the iterator which is set up by
<code class="docutils literal notranslate"><span class="pre">generate_children</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">free_aug</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">free_aug(void</span> <span class="pre">*aug)</span></code></p>
<p>This function frees an augmentation as generated by the iterator returned
by <code class="docutils literal notranslate"><span class="pre">generate_children</span></code>.</p>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">canonical_parent</span></code>:</p>
<blockquote>
<div><p>Signature:</p>
<p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*canonical_parent(void</span> <span class="pre">*child,</span> <span class="pre">void</span> <span class="pre">*parent,</span> <span class="pre">int</span> <span class="pre">*permutation,</span> <span class="pre">int</span> <span class="pre">*degree,</span> <span class="pre">bint</span> <span class="pre">*mem_err)</span></code></p>
<p>Apply the <code class="docutils literal notranslate"><span class="pre">permutation</span></code> to the <code class="docutils literal notranslate"><span class="pre">child</span></code>, determine an arbitrary but fixed
parent, apply the inverse of <code class="docutils literal notranslate"><span class="pre">permutation</span></code> to that parent, and return the
resulting object. Must also set the integer <code class="docutils literal notranslate"><span class="pre">degree</span></code> points to the
degree of the returned object.</p>
</div></blockquote>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is a good idea to try to implement an augmentation scheme where the
degree of objects on each level of the augmentation tree is constant. The
iteration will be more efficient in this case, as the relevant work spaces
will never need to be reallocated. Otherwise, one should at least strive to
iterate over augmentations in such a way that all children of the same degree
are given in the same segment of iteration.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.groups.perm_gps.partn_ref.canonical_augmentation</span>
</pre></div>
</div>
<p>REFERENCE:</p>
<ul class="simple">
<li>[1] McKay, Brendan D. Isomorph-free exhaustive generation. J Algorithms,
Vol. 26 (1998), pp. 306-324.</li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../lie_gps/nilpotent_lie_group.html"
                        title="previous chapter">Nilpotent Lie groups</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="data_structures.html"
                        title="next chapter">Data structures</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../../_sources/sage/groups/perm_gps/partn_ref/canonical_augmentation.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="data_structures.html" title="Data structures"
             >next</a> |</li>
        <li class="right" >
          <a href="../../lie_gps/nilpotent_lie_group.html" title="Nilpotent Lie groups"
             >previous</a> |</li>
  
    
      <a href="../../../../../../index.html"><img src="../../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../../index.html">Sage 9.1 Reference Manual: Groups</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>