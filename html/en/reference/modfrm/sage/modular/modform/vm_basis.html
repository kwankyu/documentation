
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>The Victor Miller Basis &#8212; Sage 9.4 Reference Manual: Modular Forms</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Compute spaces of half-integral weight modular forms" href="half_integral.html" />
    <link rel="prev" title="Numerical computation of newforms" href="numerical.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="half_integral.html" title="Compute spaces of half-integral weight modular forms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="numerical.html" title="Numerical computation of newforms"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Modular Forms</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">The Victor Miller Basis</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-victor-miller-basis">
<span id="sage-modular-modform-vm-basis"></span><h1>The Victor Miller Basis<a class="headerlink" href="#the-victor-miller-basis" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.modform.vm_basis"></span><p>This module contains functions for quick calculation of a basis of
<span class="math notranslate nohighlight">\(q\)</span>-expansions for the space of modular forms of level 1 and any weight. The
basis returned is the Victor Miller basis, which is the unique basis of
elliptic modular forms <span class="math notranslate nohighlight">\(f_1, \dots, f_d\)</span> for which <span class="math notranslate nohighlight">\(a_i(f_j) = \delta_{ij}\)</span>
for <span class="math notranslate nohighlight">\(1 \le i, j \le d\)</span> (where <span class="math notranslate nohighlight">\(d\)</span> is the dimension of the space).</p>
<p>This basis is calculated using a standard set of generators for the ring of
modular forms, using the fast multiplication algorithms for polynomials and
power series provided by the FLINT library. (This is far quicker than using
modular symbols).</p>
<dl class="py function">
<dt class="sig sig-object py" id="sage.modular.modform.vm_basis.delta_qexp">
<span class="sig-prename descclassname"><span class="pre">sage.modular.modform.vm_basis.</span></span><span class="sig-name descname"><span class="pre">delta_qexp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">prec=10</span></em>, <em class="sig-param"><span class="pre">var='q'</span></em>, <em class="sig-param"><span class="pre">K=Integer</span> <span class="pre">Ring</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.modform.vm_basis.delta_qexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(q\)</span>-expansion of the weight 12 cusp form <span class="math notranslate nohighlight">\(\Delta\)</span> as a power
series with coefficients in the ring K (<span class="math notranslate nohighlight">\(= \ZZ\)</span> by default).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – integer (default 10), the absolute precision of the output
(must be positive)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: ‘q’), variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> – ring (default: <span class="math notranslate nohighlight">\(\ZZ\)</span>), base ring of answer</p></li>
</ul>
<p>OUTPUT:</p>
<p>a power series over K in the variable <code class="docutils literal notranslate"><span class="pre">var</span></code></p>
<p>ALGORITHM:</p>
<p>Compute the theta series</p>
<div class="math notranslate nohighlight">
\[\sum_{n \ge 0} (-1)^n (2n+1) q^{n(n+1)/2},\]</div>
<p>a very simple explicit modular form whose 8th power is <span class="math notranslate nohighlight">\(\Delta\)</span>. Then
compute the 8th power. All computations are done over <span class="math notranslate nohighlight">\(\ZZ\)</span> or <span class="math notranslate nohighlight">\(\ZZ\)</span>
modulo <span class="math notranslate nohighlight">\(N\)</span> depending on the characteristic of the given coefficient
ring <span class="math notranslate nohighlight">\(K\)</span>, and coerced into <span class="math notranslate nohighlight">\(K\)</span> afterwards.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 - 6048*q^6 + O(q^7)</span>
<span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">z - 24*z^2 + 252*z^3 - 1472*z^4 + 4830*z^5 - 6048*z^6 + O(z^7)</span>
<span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: prec must be positive</span>
<span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">q + q^4 + 2*q^7 + 2*q^13 + q^16 + 2*q^19 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">))</span>
<span class="go">q + q^4 + 2*q^7 + 2*q^13 + q^16 + 2*q^19 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">delta_qexp</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">60</span><span class="p">))</span>
<span class="go">q + 36*q^2 + 12*q^3 + 28*q^4 + 30*q^5 + 12*q^6 + 56*q^7 + 57*q^9 + O(q^10)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein: original code</p></li>
<li><p>David Harvey (2007-05): sped up first squaring step</p></li>
<li><p>Martin Raum (2009-08-02): use FLINT for polynomial arithmetic (instead of NTL)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.modular.modform.vm_basis.victor_miller_basis">
<span class="sig-prename descclassname"><span class="pre">sage.modular.modform.vm_basis.</span></span><span class="sig-name descname"><span class="pre">victor_miller_basis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cusp_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.modform.vm_basis.victor_miller_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute and return the Victor Miller basis for modular forms of
weight <span class="math notranslate nohighlight">\(k\)</span> and level 1 to precision <span class="math notranslate nohighlight">\(O(q^{prec})\)</span>.  If
<code class="docutils literal notranslate"><span class="pre">cusp_only</span></code> is True, return only a basis for the cuspidal
subspace.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – an integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – (default: 10) a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cusp_only</span></code> – bool (default: False)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> – string (default: ‘q’)</p></li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div><p>A sequence whose entries are power series in <code class="docutils literal notranslate"><span class="pre">ZZ[[var]]</span></code>.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 + 240*q + 2160*q^2 + 6720*q^3 + 17520*q^4 + 30240*q^5 + O(q^6)</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 - 504*w - 16632*w^2 - 122976*w^3 - 532728*w^4 - 1575504*w^5 + O(w^6)</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 - 504*q - 16632*q^2 - 122976*q^3 - 532728*q^4 - 1575504*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 + 196560*q^2 + 16773120*q^3 + 398034000*q^4 + 4629381120*q^5 + O(q^6),</span>
<span class="go">q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 + O(q^6)</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">cusp_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">q - 24*q^2 + 252*q^3 - 1472*q^4 + 4830*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">cusp_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">q + 195660*q^3 + 12080128*q^4 + 44656110*q^5 + O(q^6),</span>
<span class="go">q^2 - 48*q^3 + 1080*q^4 - 15040*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 + 52416000*q^3 + 39007332000*q^4 + 6609020221440*q^5 + O(q^6),</span>
<span class="go">q + 195660*q^3 + 12080128*q^4 + 44656110*q^5 + O(q^6),</span>
<span class="go">q^2 - 48*q^3 + 1080*q^4 - 15040*q^5 + O(q^6)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">1 + 2611200*q^3 + 19524758400*q^4 + 19715347537920*q^5 + O(q^6),</span>
<span class="go">q + 50220*q^3 + 87866368*q^4 + 18647219790*q^5 + O(q^6),</span>
<span class="go">q^2 + 432*q^3 + 39960*q^4 - 1418560*q^5 + O(q^6)</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">200</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">cusp_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">40</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">==</span> <span class="n">victor_miller_basis</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">cusp_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein, Craig Citro: original code</p></li>
<li><p>Martin Raum (2009-08-02): use FLINT for polynomial arithmetic (instead of NTL)</p></li>
</ul>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="numerical.html"
                        title="previous chapter">Numerical computation of newforms</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="half_integral.html"
                        title="next chapter">Compute spaces of half-integral weight modular forms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/modular/modform/vm_basis.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="half_integral.html" title="Compute spaces of half-integral weight modular forms"
             >next</a> |</li>
        <li class="right" >
          <a href="numerical.html" title="Numerical computation of newforms"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.4 Reference Manual: Modular Forms</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">The Victor Miller Basis</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>