<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Elements of the ring \(\ZZ\) of integers &#8212; Sage Reference Manual v8.0: Standard Commutative Rings</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Cython wrapper for bernmm library" href="bernmm.html" />
    <link rel="prev" title="Ring \(\ZZ\) of Integers" href="integer_ring.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bernmm.html" title="Cython wrapper for bernmm library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="integer_ring.html" title="Ring \(\ZZ\) of Integers"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Standard Commutative Rings</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="elements-of-the-ring-of-integers">
<span id="sage-rings-integer"></span><h1>Elements of the ring <span class="math">\(\ZZ\)</span> of integers<a class="headerlink" href="#elements-of-the-ring-of-integers" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="module-sage.rings.integer"></span><p>Sage has highly optimized and extensive functionality about arithmetic with integers
and the ring of integers.</p>
<ul class="simple">
<li>Vincent Delecroix (2017-05-03): faster integer-rational comparisons</li>
</ul>
<p>EXAMPLES:</p>
<p>Add 2 integers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">7</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Add an integer and a real number:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">+</span> <span class="mf">4.0</span>
<span class="go">7.00000000000000</span>
</pre></div>
</div>
<p>Add an integer and a rational number:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">+</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span>
<span class="go">17/5</span>
</pre></div>
</div>
<p>Add an integer and a complex number:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">ComplexField</span><span class="p">()</span><span class="o">.</span><span class="mi">0</span> <span class="o">+</span> <span class="mf">1.5</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">((</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">a</span><span class="o">+</span><span class="n">b</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">32</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">z</span>
<span class="go">-32</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">-</span><span class="n">z</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">0</span><span class="p">;</span> <span class="o">-</span><span class="n">z</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="n">z</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Multiplication:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">12</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">((</span><span class="n">a</span> <span class="o">*</span> <span class="mf">4.0</span><span class="p">)</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">b</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">*</span> <span class="n">Rational</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span>
<span class="go">6/5</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="mi">4</span>
<span class="go">[2, 3, 2, 3, 2, 3, 2, 3]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="s1">&#39;sage&#39;</span><span class="o">*</span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;sagesagesage&#39;</span>
</pre></div>
</div>
<p>COERCIONS:</p>
<p>Returns version of this integer in the multi-precision floating
real field R:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">9390823</span>
<span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="go">9.3908230000000000000000000000000000000000000000000000000000e6</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2005): initial version</li>
<li>Gonzalo Tornaria (2006-03-02): vastly improved python/GMP
conversion; hashing</li>
<li>Didier Deshommes (2006-03-06): numerous examples
and docstrings</li>
<li>William Stein (2006-03-31): changes to reflect GMP bug fixes</li>
<li>William Stein (2006-04-14): added GMP factorial method (since it&#8217;s
now very fast).</li>
<li>David Harvey (2006-09-15): added nth_root, exact_log</li>
<li>David Harvey (2006-09-16): attempt to optimise Integer constructor</li>
<li>Rishikesh (2007-02-25): changed quo_rem so that the rem is positive</li>
<li>David Harvey, Martin Albrecht, Robert Bradshaw (2007-03-01):
optimized Integer constructor and pool</li>
<li>Pablo De Napoli (2007-04-01): multiplicative_order should return
+infinity for non zero numbers</li>
<li>Robert Bradshaw (2007-04-12): is_perfect_power, Jacobi symbol (with
Kronecker extension).  Convert some methods to use GMP directly
rather than PARI, Integer(), PY_NEW(Integer)</li>
<li>David Roe (2007-03-21): sped up valuation and is_square, added
val_unit, is_power, is_power_of and divide_knowing_divisible_by</li>
<li>Robert Bradshaw (2008-03-26): gamma function, multifactorials</li>
<li>Robert Bradshaw (2008-10-02): bounded squarefree part</li>
<li>David Loeffler (2011-01-15): fixed bug #10625 (inverse_mod should accept an ideal as argument)</li>
<li>Vincent Delecroix (2010-12-28): added unicode in Integer.__init__</li>
<li>David Roe (2012-03): deprecate <code class="xref py py-meth docutils literal"><span class="pre">is_power()</span></code>
in favour of <a class="reference internal" href="#sage.rings.integer.Integer.is_perfect_power" title="sage.rings.integer.Integer.is_perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">is_perfect_power()</span></code></a> (see
<a class="reference external" href="https://trac.sagemath.org/12116">trac ticket #12116</a>)</li>
</ul>
<dl class="function">
<dt id="sage.rings.integer.GCD_list">
<code class="descclassname">sage.rings.integer.</code><code class="descname">GCD_list</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.GCD_list" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the greatest common divisor of a list of integers.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> &#8211; list or tuple</li>
</ul>
<p>Elements of <span class="math">\(v\)</span> are converted to Sage integers.  An empty list has
GCD zero.</p>
<p>This function is used, for example, by <code class="docutils literal"><span class="pre">rings/arith.py</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.integer</span> <span class="kn">import</span> <span class="n">GCD_list</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">GCD_list</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">30</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>Check that the bug reported in <a class="reference external" href="https://trac.sagemath.org/3118">trac ticket #3118</a> has been fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">integer</span><span class="o">.</span><span class="n">GCD_list</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The inputs are converted to Sage integers.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">GCD_list</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span> <span class="s1">&#39;30&#39;</span><span class="p">]);</span> <span class="n">w</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>Check that the GCD of the empty list is zero (<a class="reference external" href="https://trac.sagemath.org/17257">trac ticket #17257</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">GCD_list</span><span class="p">([])</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.integer.Integer">
<em class="property">class </em><code class="descclassname">sage.rings.integer.</code><code class="descname">Integer</code><a class="headerlink" href="#sage.rings.integer.Integer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.EuclideanDomainElement" title="(in Sage Reference Manual: Parents and Elements v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.EuclideanDomainElement</span></code></a></p>
<p>The <code class="docutils literal"><span class="pre">Integer</span></code> class represents arbitrary precision
integers. It derives from the <code class="docutils literal"><span class="pre">Element</span></code> class, so
integers can be used as ring elements anywhere in Sage.</p>
<p>Integer() interprets strings that begin with <code class="docutils literal"><span class="pre">0o</span></code> as octal numbers,
strings that begin with <code class="docutils literal"><span class="pre">0x</span></code> as hexadecimal numbers and strings
that begin with <code class="docutils literal"><span class="pre">0b</span></code> as binary numbers.</p>
<p>The class <code class="docutils literal"><span class="pre">Integer</span></code> is implemented in Cython, as a wrapper of the
GMP <code class="docutils literal"><span class="pre">mpz_t</span></code> integer type.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="go">123</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="s2">&quot;123&quot;</span><span class="p">)</span>
<span class="go">123</span>
</pre></div>
</div>
<p>Sage Integers support <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-3127"><strong>PEP 3127</strong></a> literals:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="s1">&#39;0x12&#39;</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="s1">&#39;-0o12&#39;</span><span class="p">)</span>
<span class="go">-10</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="s1">&#39;+0b101010&#39;</span><span class="p">)</span>
<span class="go">42</span>
</pre></div>
</div>
<p>Conversion from PARI:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="n">pari</span><span class="p">(</span><span class="s1">&#39;-10380104371593008048799446356441519384&#39;</span><span class="p">))</span>
<span class="go">-10380104371593008048799446356441519384</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="n">pari</span><span class="p">(</span><span class="s1">&#39;Pol([-3])&#39;</span><span class="p">))</span>
<span class="go">-3</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.rings.integer.Integer.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.additive_order" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the additive order of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">additive_order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.binary">
<code class="descname">binary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.binary" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the binary digits of self as a string.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">binary</span><span class="p">())</span>
<span class="go">1111</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">binary</span><span class="p">())</span>
<span class="go">10000</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">16938402384092843092843098243</span><span class="p">)</span><span class="o">.</span><span class="n">binary</span><span class="p">())</span>
<span class="go">1101101011101100011110001110010010100111010001101010001111111000101000000000101111000010000011</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.binomial">
<code class="descname">binomial</code><span class="sig-paren">(</span><em>m</em>, <em>algorithm='mpir'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.binomial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the binomial coefficient &#8220;self choose m&#8221;.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> &#8211; an integer</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> &#8211; <code class="docutils literal"><span class="pre">'mpir'</span></code> (default) or <code class="docutils literal"><span class="pre">'pari'</span></code>; <code class="docutils literal"><span class="pre">'mpir'</span></code> is
faster for small <code class="docutils literal"><span class="pre">m</span></code>, and <code class="docutils literal"><span class="pre">'pari'</span></code> tends to be faster for
large <code class="docutils literal"><span class="pre">m</span></code></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">10.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">45</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">45</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">binomial</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The argument <code class="docutils literal"><span class="pre">m</span></code> or (<code class="docutils literal"><span class="pre">self-m</span></code>) must fit into unsigned long:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">115792089237316195423570985008687907853269984665640564039457584007913129639936</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">256</span><span class="p">)</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">128</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">OverflowError</span>: <span class="n">m must fit in an unsigned long</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.bits">
<code class="descname">bits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.bits" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the bits in self as a list, least significant first. The
result satisfies the identity</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="mi">2</span><span class="o">^</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">bits</span><span class="p">()))</span>
</pre></div>
</div>
<p>Negative numbers will have negative &#8220;bits&#8221;. (So, strictly
speaking, the entries of the returned list are not really
members of <span class="math">\(\ZZ/2\ZZ\)</span>.)</p>
<p>This method just calls <a class="reference internal" href="#sage.rings.integer.Integer.digits" title="sage.rings.integer.Integer.digits"><code class="xref py py-func docutils literal"><span class="pre">digits()</span></code></a> with <code class="docutils literal"><span class="pre">base=2</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.rings.integer.Integer.nbits" title="sage.rings.integer.Integer.nbits"><code class="xref py py-func docutils literal"><span class="pre">nbits()</span></code></a> (number of bits; a faster way to compute
<code class="docutils literal"><span class="pre">len(x.bits())</span></code>; and <a class="reference internal" href="#sage.rings.integer.Integer.binary" title="sage.rings.integer.Integer.binary"><code class="xref py py-func docutils literal"><span class="pre">binary()</span></code></a>, which returns a string in
more-familiar notation.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">500.</span><span class="n">bits</span><span class="p">()</span>
<span class="go">[0, 0, 1, 0, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="mf">11.</span><span class="n">bits</span><span class="p">()</span>
<span class="go">[1, 1, 0, 1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">99</span><span class="p">)</span><span class="o">.</span><span class="n">bits</span><span class="p">()</span>
<span class="go">[-1, -1, 0, 0, 0, -1, -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.ceil">
<code class="descname">ceil</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.ceil" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the ceiling of self, which is self since self is an
integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ceil</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.class_number">
<code class="descname">class_number</code><span class="sig-paren">(</span><em>proof=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.class_number" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the class number of the quadratic order with this discriminant.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; an integer congruent to <span class="math">\(0\)</span> or <span class="math">\(1\mod4\)</span> which is
not a square</li>
<li><code class="docutils literal"><span class="pre">proof</span></code> (boolean, default <code class="docutils literal"><span class="pre">True</span></code>) &#8211; if <code class="docutils literal"><span class="pre">False</span></code> then
for negative disscriminants a faster algorithm is used by
the PARI library which is known to give incorrect results
when the class group has many cyclic factors.</li>
</ul>
<p>OUTPUT:</p>
<p>(integer) the class number of the quadratic order with this
discriminant.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is not always equal to the number of classes of
primitive binary quadratic forms of discriminant <span class="math">\(D\)</span>, which
is equal to the narrow class number. The two notions are
the same when <span class="math">\(D&lt;0\)</span>, or <span class="math">\(D&gt;0\)</span> and the fundamental unit of
the order has negative norm; otherwise the number of
classes of forms is twice this class number.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">163</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">104</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="p">[((</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">),(</span><span class="mi">4</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">class_number</span><span class="p">())</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">21.</span><span class="o">.</span><span class="mi">29</span><span class="p">]]</span>
<span class="go">[(85, 2),</span>
<span class="go">(89, 1),</span>
<span class="go">(93, 1),</span>
<span class="go">(97, 1),</span>
<span class="go">(101, 1),</span>
<span class="go">(105, 2),</span>
<span class="go">(109, 1),</span>
<span class="go">(113, 1),</span>
<span class="go">(117, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.conjugate">
<code class="descname">conjugate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.conjugate" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the complex conjugate of this integer, which is the
integer itself.</p>
<dl class="docutils">
<dt>EXAMPLES:</dt>
<dd>sage: n = 205
sage: n.conjugate()
205</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.coprime_integers">
<code class="descname">coprime_integers</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.coprime_integers" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the positive integers <span class="math">\(&lt; m\)</span> that are coprime to
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">coprime_integers</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[1, 3, 5, 7]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">coprime_integers</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[1, 3, 5, 7, 9]</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span> <span class="n">n</span><span class="o">.</span><span class="n">coprime_integers</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 6, 7, 8, 9]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">coprime_integers</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">99</span><span class="p">;</span> <span class="n">n</span><span class="o">.</span><span class="n">coprime_integers</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="go">[1, 2, 4, 5, 7, 8, 10, 13, 14, 16, 17, 19, 20, 23, 25, 26, 28, 29, 31, 32, 34, 35, 37, 38, 40, 41, 43, 46, 47, 49, 50, 52, 53, 56, 58, 59, 61, 62, 64, 65, 67, 68, 70, 71, 73, 74, 76, 79, 80, 82, 83, 85, 86, 89, 91, 92, 94, 95, 97, 98]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Naqi Jaffery (2006-01-24): examples</li>
</ul>
<p>ALGORITHM: Naive - compute lots of GCD&#8217;s. If this isn&#8217;t good enough
for you, please code something better and submit a patch.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.crt">
<code class="descname">crt</code><span class="sig-paren">(</span><em>y</em>, <em>m</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.crt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the unique integer between <span class="math">\(0\)</span> and <span class="math">\(mn\)</span> that is congruent to
the integer modulo <span class="math">\(m\)</span> and to <span class="math">\(y\)</span> modulo <span class="math">\(n\)</span>. We assume that <span class="math">\(m\)</span> and
<span class="math">\(n\)</span> are coprime.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">17</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">crt</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span> <span class="n">m</span>
<span class="go">247</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">%</span><span class="mi">23</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">%</span><span class="mi">11</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.denominator">
<code class="descname">denominator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.denominator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the denominator of this integer, which of course is
always 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.digits">
<code class="descname">digits</code><span class="sig-paren">(</span><em>base=10</em>, <em>digits=None</em>, <em>padto=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.digits" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of digits for <code class="docutils literal"><span class="pre">self</span></code> in the given base in little
endian order.</p>
<p>The returned value is unspecified if self is a negative number
and the digits are given.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">base</span></code> - integer (default: 10)</li>
<li><code class="docutils literal"><span class="pre">digits</span></code> - optional indexable object as source for
the digits</li>
<li><code class="docutils literal"><span class="pre">padto</span></code> - the minimal length of the returned list,
sufficient number of zeros are added to make the list minimum that
length (default: 0)</li>
</ul>
<p>As a shorthand for <code class="docutils literal"><span class="pre">digits(2)</span></code>, you can use <a class="reference internal" href="#sage.rings.integer.Integer.bits" title="sage.rings.integer.Integer.bits"><code class="xref py py-meth docutils literal"><span class="pre">bits()</span></code></a>.</p>
<p>Also see <a class="reference internal" href="#sage.rings.integer.Integer.ndigits" title="sage.rings.integer.Integer.ndigits"><code class="xref py py-meth docutils literal"><span class="pre">ndigits()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">17.</span><span class="n">digits</span><span class="p">()</span>
<span class="go">[7, 1]</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">digits</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;zero&quot;</span><span class="p">,</span><span class="s2">&quot;one&quot;</span><span class="p">])</span>
<span class="go">[&#39;one&#39;, &#39;zero&#39;, &#39;one&#39;]</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">digits</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[2, 1]</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># 0 has 0 digits</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># 0 has 0 digits</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;0123456789abcdef&#39;</span><span class="p">)</span>
<span class="go">[&#39;a&#39;]</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;0123456789abcdef&#39;</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">digits</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="s1">&#39;0123456789abcdef&#39;</span><span class="p">,</span><span class="n">padto</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;0&#39;]</span>
<span class="gp">sage: </span><span class="mf">123.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">padto</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[3, 2, 1, 0, 0]</span>
<span class="gp">sage: </span><span class="mf">123.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">padto</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>       <span class="c1"># padto is the minimal length</span>
<span class="go">[1, 1, 0, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="mf">123.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">padto</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">digits</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[-1, -1, 1, -1, -1, -1, -1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="mi">9939082340</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[0, 4, 3, 2, 8, 0, 9, 3, 9, 9]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">512</span><span class="p">)</span>
<span class="go">[100, 302, 26, 74]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[-2, -1]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[0, 0, -1, -1]</span>
</pre></div>
</div>
<p>We support large bases.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="o">^</span><span class="mi">6000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3000</span><span class="p">)</span>
<span class="go">[0, 0, 1]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">base</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">n</span><span class="o">=</span><span class="mi">25</span>
<span class="gp">sage: </span><span class="n">l</span><span class="o">=</span><span class="n">n</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
<span class="gp">sage: </span><span class="c1"># the next relationship should hold for all n,base</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">base</span><span class="o">^</span><span class="n">i</span><span class="o">*</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span><span class="o">==</span><span class="n">n</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">base</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">n</span><span class="o">=-</span><span class="mi">30</span><span class="p">;</span> <span class="n">l</span><span class="o">=</span><span class="n">n</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="p">);</span> <span class="nb">sum</span><span class="p">(</span><span class="n">base</span><span class="o">^</span><span class="n">i</span><span class="o">*</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)))</span><span class="o">==</span><span class="n">n</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The inverse of this method &#8211; constructing an integer from a
list of digits and a base &#8211; can be done using the above method
or by simply using <a class="reference internal" href="integer_ring.html#sage.rings.integer_ring.IntegerRing_class" title="sage.rings.integer_ring.IntegerRing_class"><code class="xref py py-class docutils literal"><span class="pre">ZZ()</span></code></a> with a base:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">123</span><span class="p">;</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">digits</span><span class="p">(),</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">123</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">==</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">25</span><span class="p">),</span> <span class="mi">25</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Using <a class="reference external" href="https://docs.python.org/library/functions.html#sum" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">sum()</span></code></a> and <a class="reference external" href="https://docs.python.org/library/functions.html#enumerate" title="(in Python v2.7)"><code class="xref py py-func docutils literal"><span class="pre">enumerate()</span></code></a> to do the same thing is
slightly faster in many cases (and
<a class="reference external" href="../../../misc/sage/misc/misc_c.html#sage.misc.misc_c.balanced_sum" title="(in Sage Reference Manual: Utilities v8.0)"><code class="xref py py-func docutils literal"><span class="pre">balanced_sum()</span></code></a> may be faster yet). Of
course it gives the same result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">base</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">digit</span> <span class="o">*</span> <span class="n">base</span><span class="o">^</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">digit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="p">)))</span> <span class="o">==</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="p">),</span> <span class="n">base</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note: In some cases it is faster to give a digits collection. This
would be particularly true for computing the digits of a series of
small numbers. In these cases, the code is careful to allocate as
few python objects as reasonably possible.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">digits</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZZ</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">l</span><span class="p">[</span><span class="mi">16</span><span class="p">]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
<p>This function is comparable to <code class="docutils literal"><span class="pre">str</span></code> for speed.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="o">^</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># slightly slower than str</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="mi">10000</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">digits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">10</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># slightly faster than str</span>
<span class="go">1</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Joel B. Mohler (2008-03-02):  significantly rewrote this entire function</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.divide_knowing_divisible_by">
<code class="descname">divide_knowing_divisible_by</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.divide_knowing_divisible_by" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the integer self / right when self is divisible by right.</p>
<p>If self is not divisible by right, the return value is undefined,
and may not even be close to self/right for multi-word integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">8</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">divide_knowing_divisible_by</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">divide_knowing_divisible_by</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">4000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span><span class="o">.</span><span class="n">divide_knowing_divisible_by</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span> <span class="c1"># close (random)</span>
<span class="go">3846</span>
</pre></div>
</div>
<p>However, often it&#8217;s way off.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">70</span><span class="p">;</span> <span class="n">a</span>
<span class="go">1180591620717411303424</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">//</span> <span class="mi">11</span>  <span class="c1"># floor divide</span>
<span class="go">107326510974310118493</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">divide_knowing_divisible_by</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># way off and possibly random</span>
<span class="go">43215361478743422388970455040</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.divides">
<code class="descname">divides</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.divides" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return True if self divides n.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">IntegerRing</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">Z</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.divisors">
<code class="descname">divisors</code><span class="sig-paren">(</span><em>method=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.divisors" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a list of all positive integer divisors of the integer
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 3]</span>
<span class="gp">sage: </span><span class="mf">6.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 2, 3, 6]</span>
<span class="gp">sage: </span><span class="mf">28.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 2, 4, 7, 14, 28]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 2, 4, 8, 16, 32]</span>
<span class="gp">sage: </span><span class="mf">100.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 2, 4, 5, 10, 20, 25, 50, 100]</span>
<span class="gp">sage: </span><span class="mf">1.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">divisors</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n must be nonzero</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="mi">3</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">divisors</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 6, 8, 9, 12, 17, 18, 24, 34, 36, 51, 68, 72, 102, 136, 153, 204, 306, 408, 612, 1224]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">odd_part</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">divisors</span><span class="p">();</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">172800</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">e</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="n">factor</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">172800</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">t</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">v</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">551</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">divisors</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">256</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">n</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If one first computes all the divisors and then sorts it,
the sorting step can easily dominate the runtime. Note,
however, that (non-negative) multiplication on the left
preserves relative order. One can leverage this fact to
keep the list in order as one computes it using a process
similar to that of the merge sort algorithm.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.euclidean_degree">
<code class="descname">euclidean_degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.euclidean_degree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the degree of this element as an element of an Euclidean domain.</p>
<p>If this is an element in the ring of integers, this is simply its
absolute value.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">euclidean_degree</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.exact_log">
<code class="descname">exact_log</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.exact_log" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the largest integer <span class="math">\(k\)</span> such that <span class="math">\(m^k \leq \text{self}\)</span>,
i.e., the floor of <span class="math">\(\log_m(\text{self})\)</span>.</p>
<p>This is guaranteed to return the correct answer even when the usual
log function doesn&#8217;t have sufficient precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> - integer &gt;= 2</li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-15)</li>
<li><dl class="first docutils">
<dt>Joel B. Mohler (2009-04-08) &#8211; rewrote this to handle small cases</dt>
<dd>and/or easy cases up to 100x faster..</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">126</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">178</span><span class="o">^</span><span class="mi">1700</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">178</span><span class="p">)</span>
<span class="go">1700</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">178</span><span class="o">^</span><span class="mi">1700</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">178</span><span class="p">)</span>
<span class="go">1699</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">178</span><span class="o">^</span><span class="mi">1700</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">178</span><span class="p">)</span>
<span class="go">1700</span>
<span class="gp">sage: </span><span class="c1"># we need to exercise the large base code path too</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">1780</span><span class="o">^</span><span class="mi">1700</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">1780</span><span class="p">)</span>
<span class="go">1699</span>

<span class="gp">sage: </span><span class="c1"># The following are very very fast.</span>
<span class="gp">sage: </span><span class="c1"># Note that for base m a perfect power of 2, we get the exact log by counting bits.</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">2983579823750185701375109835</span><span class="p">;</span> <span class="n">m</span><span class="o">=</span><span class="mi">32</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="c1"># The next is a favorite of mine.  The log2 approximate is exact and immediately provable.</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">=</span><span class="mi">90153710570912709517902579010793251709257901270941709247901209742124</span><span class="p">;</span><span class="n">m</span><span class="o">=</span><span class="mi">213509721309572</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span><span class="o">^</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">100000.000000000</span>
<span class="gp">sage: </span><span class="n">RR</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">RR</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">100000</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">100000.000000000</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">100000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">100000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">99999</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Attempt to coerce non-integral RealNumber to Integer</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.exp" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the exponential function of self as a real number.</p>
<p>This function is provided only so that Sage integers may be treated
in the same manner as real numbers when convenient.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> - integer (default: None): if None, returns
symbolic, else to given bits of precision as in RealField</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">e^8</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2980.9579870417282747435920995</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
<span class="go">e^8</span>
</pre></div>
</div>
<p>For even fairly large numbers, this may not be useful.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">145</span><span class="o">^</span><span class="mi">145</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">e^25024207011349079210459585279553675697932183658421565260323592409432707306554163224876110094014450895759296242775250476115682350821522931225499163750010280453185147546962559031653355159703678703793369785727108337766011928747055351280379806937944746847277089168867282654496776717056860661614337004721164703369140625</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">53</span><span class="p">)</span> <span class="c1"># default RealField precision</span>
<span class="go">+infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.factor">
<code class="descname">factor</code><span class="sig-paren">(</span><em>algorithm='pari'</em>, <em>proof=None</em>, <em>limit=None</em>, <em>int_=False</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.factor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the prime factorization of this integer as a
formal Factorization object.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">algorithm</span></code> - string<ul>
<li><code class="docutils literal"><span class="pre">'pari'</span></code> - (default) use the PARI library</li>
<li><code class="docutils literal"><span class="pre">'kash'</span></code> - use the KASH computer algebra system (requires
the optional kash package)</li>
<li><code class="docutils literal"><span class="pre">'magma'</span></code> - use the MAGMA computer algebra system (requires
an installation of MAGMA)</li>
<li><code class="docutils literal"><span class="pre">'qsieve'</span></code> - use Bill Hart&#8217;s quadratic sieve code;
WARNING: this may not work as expected, see qsieve? for
more information</li>
<li><code class="docutils literal"><span class="pre">'ecm'</span></code> - use ECM-GMP, an implementation of Hendrik
Lenstra&#8217;s elliptic curve method.</li>
</ul>
</li>
<li><code class="docutils literal"><span class="pre">proof</span></code> - bool (default: True) whether or not to prove
primality of each factor (only applicable for <code class="docutils literal"><span class="pre">'pari'</span></code>
and <code class="docutils literal"><span class="pre">'ecm'</span></code>).</li>
<li><code class="docutils literal"><span class="pre">limit</span></code> - int or None (default: None) if limit is
given it must fit in a signed int, and the factorization is done
using trial division and primes up to limit.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a Factorization object containing the prime factors and
their multiplicities</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">100</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">3 * 5^3 * 11 * 31 * 41 * 101 * 251 * 601 * 1801 * 4051 * 8101 * 268501</span>
</pre></div>
</div>
<p>This factorization can be converted into a list of pairs <span class="math">\((p,
e)\)</span>, where <span class="math">\(p\)</span> is prime and <span class="math">\(e\)</span> is a positive integer.  Each
pair can also be accessed directly by its index (ordered by
increasing size of the prime):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mf">60.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">[(2, 2), (3, 1), (5, 1)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">(5, 1)</span>
</pre></div>
</div>
<p>Similarly, the factorization can be converted to a dictionary
so the exponent can be extracted for each prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">dict</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">{3: 6}</span>
<span class="gp">sage: </span><span class="nb">dict</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We use proof=False, which doesn&#8217;t prove correctness of the primes
that appear in the factorization:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">920384092842390423848290348203948092384082349082</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">2 * 11 * 1531 * 4402903 * 10023679 * 619162955472170540533894518173</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2 * 11 * 1531 * 4402903 * 10023679 * 619162955472170540533894518173</span>
</pre></div>
</div>
<p>We factor using trial division only:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">2 * 11 * 41835640583745019265831379463815822381094652231</span>
</pre></div>
</div>
<p>We factor using a quadratic sieve algorithm:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;qsieve&#39;</span><span class="p">)</span>
<span class="go">doctest:... RuntimeWarning: the factorization returned</span>
<span class="go">by qsieve may be incomplete (the factors may not be prime)</span>
<span class="go">or even wrong; see qsieve? for details</span>
<span class="go">100000000000000000039 * 1000000000000000000117</span>
</pre></div>
</div>
<p>We factor using the elliptic curve method:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">factor</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;ecm&#39;</span><span class="p">)</span>
<span class="go">1000000000000037 * 1000000000000000000117</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.factorial">
<code class="descname">factorial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.factorial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the factorial <span class="math">\(n! = 1 \cdot 2 \cdot 3 \cdots n\)</span>.</p>
<p>If the input does not fit in an <code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">long</span> <span class="pre">int</span></code> a symbolic
expression is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
<span class="go">....:     print(&quot;{} {}&quot;.format(n, n.factorial()))</span>
<span class="go">0 1</span>
<span class="go">1 1</span>
<span class="go">2 2</span>
<span class="go">3 6</span>
<span class="go">4 24</span>
<span class="go">5 120</span>
<span class="go">6 720</span>
<span class="gp">sage: </span><span class="mf">234234209384023842034.</span><span class="n">factorial</span><span class="p">()</span>
<span class="go">factorial(234234209384023842034)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.floor">
<code class="descname">floor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.floor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the floor of self, which is just self since self is an
integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">floor</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.gamma">
<code class="descname">gamma</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.gamma" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The gamma function on integers is the factorial function (shifted by
one) on positive integers, and <span class="math">\(\pm \infty\)</span> on non-positive integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gamma</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">gamma</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">^</span><span class="mi">150</span><span class="p">)</span>
<span class="go">Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.gcd">
<code class="descname">gcd</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.gcd" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the greatest common divisor of self and <span class="math">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.global_height">
<code class="descname">global_height</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.global_height" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the absolute logarithmic height of this rational integer.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> (int) &#8211; desired floating point precision (default:
default RealField precision).</li>
</ul>
<p>OUTPUT:</p>
<p>(real) The absolute logarithmic height of this rational integer.</p>
<p>ALGORITHM:</p>
<p>The height of the integer <span class="math">\(n\)</span> is <span class="math">\(\log |n|\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">global_height</span><span class="p">()</span>
<span class="go">1.60943791243410</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">global_height</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.69314718055994530941723212146</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">2.0000000000000000000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.imag">
<code class="descname">imag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.imag" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the imaginary part of self, which is zero.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">imag</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.inverse_mod">
<code class="descname">inverse_mod</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.inverse_mod" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the inverse of self modulo <span class="math">\(n\)</span>, if this inverse exists.
Otherwise, raises a <code class="docutils literal"><span class="pre">ZeroDivisionError</span></code> exception.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> - Integer</li>
<li><code class="docutils literal"><span class="pre">n</span></code> - Integer, or ideal of integer ring</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">x</span></code> - Integer such that x*self = 1 (mod m), or
raises ZeroDivisionError.</li>
</ul>
<p>IMPLEMENTATION:</p>
<p>Call the mpz_invert GMP library function.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">189</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="go">4709</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">)</span>
<span class="go">4709</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="mi">1890</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Inverse does not exist.</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">**</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">*</span><span class="n">a</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Inverse does not exist.</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/10625">trac ticket #10625</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_mod</span><span class="p">(</span><span class="n">ZZ</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/9955">trac ticket #9955</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Rational</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">%</span><span class="n">Rational</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.inverse_of_unit">
<code class="descname">inverse_of_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.inverse_of_unit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return inverse of self if self is a unit in the integers, i.e.,
self is -1 or 1. Otherwise, raise a ZeroDivisionError.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">inverse does not exist</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">inverse_of_unit</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">inverse does not exist</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_integer">
<code class="descname">is_integer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_integer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> as they are integers</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_integer</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_integral">
<code class="descname">is_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_integral" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> since integers are integral, i.e.,
satisfy a monic polynomial with integer coefficients.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_irreducible">
<code class="descname">is_irreducible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_irreducible" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if self is irreducible, i.e. +/-
prime</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_norm">
<code class="descname">is_norm</code><span class="sig-paren">(</span><em>K</em>, <em>element=False</em>, <em>proof=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_norm" title="Permalink to this definition">Â¶</a></dt>
<dd><p>See <code class="docutils literal"><span class="pre">QQ(self).is_norm()</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">7.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, -4*beta + 6)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="bp">True</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(False, None)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_norm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_one">
<code class="descname">is_one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_one" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if the integer is <span class="math">\(1\)</span>, otherwise <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_perfect_power">
<code class="descname">is_perfect_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_perfect_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is a perfect power, ie if there exist integers
<span class="math">\(a\)</span> and <span class="math">\(b\)</span>, <span class="math">\(b &gt; 1\)</span> with <code class="docutils literal"><span class="pre">self</span></code> <span class="math">\(= a^b\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.perfect_power" title="sage.rings.integer.Integer.perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">perfect_power()</span></code></a>: Finds the minimal base for which this
integer is a perfect power.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_power_of" title="sage.rings.integer.Integer.is_power_of"><code class="xref py py-meth docutils literal"><span class="pre">is_power_of()</span></code></a>: If you know the base already this method is
the fastest option.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>: Checks whether the base is prime.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">27</span><span class="p">)</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">8</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">144.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span> <span class="o">-</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span> <span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_power_of">
<code class="descname">is_power_of</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_power_of" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if there is an integer b with
<span class="math">\(\mathtt{self} = n^b\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.perfect_power" title="sage.rings.integer.Integer.perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">perfect_power()</span></code></a>: Finds the minimal base for which this
integer is a perfect power.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_perfect_power" title="sage.rings.integer.Integer.is_perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">is_perfect_power()</span></code></a>: If you don&#8217;t know the base but just
want to know if this integer is a perfect power, use this
function.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>: Checks whether the base is prime.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For large integers self, is_power_of() is faster than
is_perfect_power(). The following examples gives some indication of
how much faster.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">lcm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10000</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">14446</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.53203299999999976</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.0</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.032002000000000308</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">lcm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">exact_log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1437</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_perfect_power</span><span class="p">()</span> <span class="c1"># note that we change the range from the example above</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.17201100000000036</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">();</span> <span class="n">TWO</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="n">TWO</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.0040000000000000036</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.040003000000000011</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">cputime</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10000</span><span class="p">):</span> <span class="n">k</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">is_power_of</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cputime</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>      <span class="c1"># random</span>
<span class="go">0.02800199999999986</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_prime">
<code class="descname">is_prime</code><span class="sig-paren">(</span><em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_prime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Test whether <code class="docutils literal"><span class="pre">self</span></code> is prime.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> &#8211; Boolean or <code class="docutils literal"><span class="pre">None</span></code> (default). If False, use a
strong pseudo-primality test (see <a class="reference internal" href="#sage.rings.integer.Integer.is_pseudoprime" title="sage.rings.integer.Integer.is_pseudoprime"><code class="xref py py-meth docutils literal"><span class="pre">is_pseudoprime()</span></code></a>).
If True, use a provable primality test.  If unset, use the
<a class="reference external" href="../../../structure/sage/structure/proof/proof.html#module-sage.structure.proof.proof" title="(in Sage Reference Manual: Parents and Elements v8.0)"><code class="xref py py-mod docutils literal"><span class="pre">default</span> <span class="pre">arithmetic</span> <span class="pre">proof</span> <span class="pre">flag</span></code></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Integer primes are by definition <em>positive</em>! This is
different than Magma, but the same as in PARI. See also the
<a class="reference internal" href="#sage.rings.integer.Integer.is_irreducible" title="sage.rings.integer.Integer.is_irreducible"><code class="xref py py-meth docutils literal"><span class="pre">is_irreducible()</span></code></a> method.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">7</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_irreducible</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">80</span> <span class="o">+</span> <span class="mi">129</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_prime</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When starting Sage the arithmetic proof flag is True. We can change
it to False as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">100</span> <span class="o">+</span> <span class="mi">267</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s2">&quot;n.is_prime()&quot;</span><span class="p">)</span>  <span class="c1"># not tested</span>
<span class="go">5 loops, best of 3: 163 ms per loop</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">timeit</span><span class="p">(</span><span class="s2">&quot;n.is_prime()&quot;</span><span class="p">)</span>  <span class="c1"># not tested</span>
<span class="go">1000 loops, best of 3: 573 us per loop</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Calls the PARI <code class="docutils literal"><span class="pre">isprime</span></code> function.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_prime_power">
<code class="descname">is_prime_power</code><span class="sig-paren">(</span><em>flag=None</em>, <em>proof=None</em>, <em>get_data=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_prime_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">True</span></code> if this integer is a prime power, and <code class="docutils literal"><span class="pre">False</span></code> otherwise.</p>
<p>A prime power is a prime number raised to a positive power. Hence <span class="math">\(1\)</span> is
not a prime power.</p>
<p>For a method that uses a pseudoprimality test instead see
<a class="reference internal" href="#sage.rings.integer.Integer.is_pseudoprime_power" title="sage.rings.integer.Integer.is_pseudoprime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_pseudoprime_power()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> &#8211; Boolean or <code class="docutils literal"><span class="pre">None</span></code> (default). If <code class="docutils literal"><span class="pre">False</span></code>, use a strong
pseudo-primality test (see <a class="reference internal" href="#sage.rings.integer.Integer.is_pseudoprime" title="sage.rings.integer.Integer.is_pseudoprime"><code class="xref py py-meth docutils literal"><span class="pre">is_pseudoprime()</span></code></a>).  If <code class="docutils literal"><span class="pre">True</span></code>, use
a provable primality test. If unset, use the default arithmetic proof
flag.</li>
<li><code class="docutils literal"><span class="pre">get_data</span></code> &#8211; (default <code class="docutils literal"><span class="pre">False</span></code>), if <code class="docutils literal"><span class="pre">True</span></code> return a pair
<code class="docutils literal"><span class="pre">(p,k)</span></code> such that this integer equals <code class="docutils literal"><span class="pre">p^k</span></code> with <code class="docutils literal"><span class="pre">p</span></code> a prime
and <code class="docutils literal"><span class="pre">k</span></code> a positive integer or the pair <code class="docutils literal"><span class="pre">(self,0)</span></code> otherwise.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.perfect_power" title="sage.rings.integer.Integer.perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">perfect_power()</span></code></a>: Finds the minimal base for which integer
is a perfect power.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_perfect_power" title="sage.rings.integer.Integer.is_perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">is_perfect_power()</span></code></a>: Doesn&#8217;t test whether the base is prime.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_power_of" title="sage.rings.integer.Integer.is_power_of"><code class="xref py py-meth docutils literal"><span class="pre">is_power_of()</span></code></a>: If you know the base already this method is
the fastest option.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_pseudoprime_power" title="sage.rings.integer.Integer.is_pseudoprime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_pseudoprime_power()</span></code></a>: If the entry is very large.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">17.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">10.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">64.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">1.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">20</span><span class="p">);</span> <span class="n">p</span>
<span class="go">100000000000000000039</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">97</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>With the <code class="docutils literal"><span class="pre">get_data</span></code> keyword set to <code class="docutils literal"><span class="pre">True</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(3, 100)</span>
<span class="gp">sage: </span><span class="mf">12.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(12, 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">97</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(100000000000000000039, 97)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">next_prime</span><span class="p">();</span> <span class="n">q</span>
<span class="go">100000000000000000129</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p</span><span class="o">*</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(10000000000000000016800000000000000005031, 0)</span>
</pre></div>
</div>
<p>The method works for large entries when <span class="math">\(proof=False\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">((</span><span class="mi">10</span><span class="o">^</span><span class="mi">500</span> <span class="o">+</span> <span class="mi">961</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">proof</span><span class="o">.</span><span class="n">arithmetic</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>We check that <a class="reference external" href="https://trac.sagemath.org/4777">trac ticket #4777</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">150607571</span><span class="o">^</span><span class="mi">14</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_prime_power</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_pseudoprime">
<code class="descname">is_pseudoprime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_pseudoprime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Test whether self is a pseudoprime</p>
<p>This uses PARI&#8217;s Baillie-PSW probabilistic primality
test. Currently, there are no known pseudoprimes for
Baille-PSW that are not actually prime. However it is
conjectured that there are infinitely many.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_pseudoprime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span><span class="o">^</span><span class="mi">31</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">is_pseudoprime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_pseudoprime_power">
<code class="descname">is_pseudoprime_power</code><span class="sig-paren">(</span><em>get_data=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_pseudoprime_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Test if this number is a power of a pseudoprime number.</p>
<p>For large numbers, this method might be faster than
<a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">get_data</span></code> &#8211; (default <code class="docutils literal"><span class="pre">False</span></code>) if <code class="docutils literal"><span class="pre">True</span></code> return a pair <span class="math">\((p,k)\)</span>
such that this number equals <span class="math">\(p^k\)</span> with <span class="math">\(p\)</span> a pseudoprime and <span class="math">\(k\)</span> a
positive integer or the pair <code class="docutils literal"><span class="pre">(self,0)</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">200</span> <span class="o">+</span> <span class="mi">357</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_pseudoprime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">is_pseudoprime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">is_pseudoprime_power</span><span class="p">(</span><span class="n">get_data</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1000...000357, 12)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">997</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">is_pseudoprime_power</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">998</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">is_pseudoprime_power</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">((</span><span class="mi">10</span><span class="o">^</span><span class="mi">1000</span> <span class="o">+</span> <span class="mi">453</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_pseudoprime_power</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_square">
<code class="descname">is_square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_square" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if self is a perfect square.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_squarefree">
<code class="descname">is_squarefree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_squarefree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns True if this integer is not divisible by the square of any
prime and False otherwise.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">100.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mf">102.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.is_unit">
<code class="descname">is_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.is_unit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">true</span></code> if this integer is a unit, i.e., 1 or <span class="math">\(-1\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
<span class="go">....:     print(&quot;{} {}&quot;.format(n, n.is_unit()))</span>
<span class="go">-2 False</span>
<span class="go">-1 True</span>
<span class="go">0 False</span>
<span class="go">1 True</span>
<span class="go">2 False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.isqrt">
<code class="descname">isqrt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.isqrt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the integer floor of the square root of self, or raises an
<code class="docutils literal"><span class="pre">ValueError</span></code> if self is negative.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">isqrt</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">102</span><span class="p">)</span><span class="o">.</span><span class="n">isqrt</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">square root of negative integer not defined.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.jacobi">
<code class="descname">jacobi</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.jacobi" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate the Jacobi symbol <span class="math">\(\left(\frac{self}{b}\right)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="mi">19</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="mi">19</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">b</span><span class="o">.</span><span class="n">jacobi</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.kronecker">
<code class="descname">kronecker</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.kronecker" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Calculate the Kronecker symbol <span class="math">\(\left(\frac{self}{b}\right)\)</span>
with the Kronecker extension <span class="math">\((self/2)=(2/self)\)</span> when <span class="math">\(self\)</span> is odd,
or <span class="math">\((self/2)=0\)</span> when <span class="math">\(self\)</span> is even.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">==</span> <span class="n">b</span><span class="o">.</span><span class="n">kronecker</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.list">
<code class="descname">list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.list" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list with this integer in it, to be compatible with the
method for number fields.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>m=None</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.log" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns symbolic log by default, unless the logarithm is exact (for
an integer argument). When precision is given, the RealField
approximation to that bit precision is used.</p>
<p>This function is provided primarily so that Sage integers may be
treated in the same manner as real numbers when convenient. Direct
use of exact_log is probably best for arithmetic log computation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> - default: natural log base e</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> - integer (default: None): if None, returns
symbolic, else to given bits of precision as in RealField</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">log(124)/log(5)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">2.9950093311241087454822446806</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">53</span><span class="p">)</span>
<span class="go">3.00000000000000</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="go">log(125)</span>
</pre></div>
</div>
<p>For extremely large numbers, this works:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span><span class="o">^</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">100000</span>
</pre></div>
</div>
<p>With the new Pynac symbolic backend, log(x) also
works in a reasonable amount of time for this x:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span><span class="o">^</span><span class="mi">100000</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">log(1334971414230...5522000001)</span>
</pre></div>
</div>
<p>But approximations are probably more useful in this
case, and work to as high a precision as we desire:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">53</span><span class="p">)</span> <span class="c1"># default precision for RealField</span>
<span class="go">100000.000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">53</span><span class="p">)</span>
<span class="go">100000.000000000</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">100000.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</span>
</pre></div>
</div>
<p>We can use non-integer bases, with default e:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">53</span><span class="p">)</span>
<span class="go">119897.784671579</span>
</pre></div>
</div>
<p>We also get logarithms of negative integers, via the
symbolic ring, using the branch from <span class="math">\(-pi\)</span> to <span class="math">\(pi\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">I*pi</span>
</pre></div>
</div>
<p>The logarithm of zero is done likewise:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-Infinity</span>
</pre></div>
</div>
<p>Some rational bases yield integer logarithms (<a class="reference external" href="https://trac.sagemath.org/21517">trac ticket #21517</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-3</span>
</pre></div>
</div>
<p>Check that Python ints are accepted (<a class="reference external" href="https://trac.sagemath.org/21518">trac ticket #21518</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.multifactorial">
<code class="descname">multifactorial</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.multifactorial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the k-th factorial <span class="math">\(n!^{(k)}\)</span> of self.</p>
<p>For k=1 this is the standard factorial, and for k greater than
one it is the product of every k-th terms down from self to
k. The recursive definition is used to extend this function to
the negative integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">5.</span><span class="n">multifactorial</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">120</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">multifactorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">multifactorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="mf">23.</span><span class="n">multifactorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">316234143225</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">23</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">])</span>
<span class="go">316234143225</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">multifactorial</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">1/2640</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.multiplicative_order">
<code class="descname">multiplicative_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.multiplicative_order" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the multiplicative order of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.nbits">
<code class="descname">nbits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.nbits" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the number of bits in self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">500.</span><span class="n">nbits</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">nbits</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">nbits</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="mf">0.</span><span class="n">bits</span><span class="p">())</span> <span class="o">==</span> <span class="mf">0.</span><span class="n">ndigits</span><span class="p">(</span><span class="n">base</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">12345.</span><span class="n">nbits</span><span class="p">()</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="mf">12345.</span><span class="n">binary</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.ndigits">
<code class="descname">ndigits</code><span class="sig-paren">(</span><em>base=10</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.ndigits" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the number of digits of self expressed in the given base.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">base</span></code> - integer (default: 10)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">52</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10003</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">**</span><span class="mi">1000000</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">()</span>
<span class="go">3000001</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">**</span><span class="mi">1000000</span><span class="o">-</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">()</span>
<span class="go">3000000</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="mi">10000000</span><span class="o">-</span><span class="mi">10</span><span class="o">**</span><span class="mi">9999990</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">ndigits</span><span class="p">()</span>
<span class="go">10000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.next_prime">
<code class="descname">next_prime</code><span class="sig-paren">(</span><em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.next_prime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the next prime after self.</p>
<p>This method calls the PARI <code class="docutils literal"><span class="pre">nextprime</span></code> function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> - bool or None (default: None, see
proof.arithmetic or sage.structure.proof) Note that the global Sage
default is proof=True</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">100.</span><span class="n">next_prime</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">next_prime</span><span class="p">()</span>
<span class="go">100000000000000000000000000000000000000000000000151</span>
</pre></div>
</div>
<p>Use <code class="docutils literal"><span class="pre">proof=False</span></code>, which is way faster since it does not need
a primality proof:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">next_prime</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">-</span> <span class="mi">2</span><span class="o">^</span><span class="mi">1024</span>
<span class="go">643</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">next_prime</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">1001</span><span class="p">)</span><span class="o">.</span><span class="n">next_prime</span><span class="p">()</span>
<span class="go">1009</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.next_prime_power">
<code class="descname">next_prime_power</code><span class="sig-paren">(</span><em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.next_prime_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the next prime power after self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> - if <code class="docutils literal"><span class="pre">True</span></code> ensure that the returned value is the next
prime power and if set to <code class="docutils literal"><span class="pre">False</span></code> uses probabilistic methods
(i.e. the result is not guaranteed). By default it uses global
configuration variables to determine which alternative to use (see
<code class="xref py py-mod docutils literal"><span class="pre">proof.arithmetic</span></code> or <code class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof</span></code>).</li>
</ul>
<p>ALGORITHM:</p>
<p>The algorithm is naive. It computes the next power of 2 and go through
the odd numbers calling <a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.previous_prime_power" title="sage.rings.integer.Integer.previous_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">previous_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.next_prime" title="sage.rings.integer.Integer.next_prime"><code class="xref py py-meth docutils literal"><span class="pre">next_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.previous_prime" title="sage.rings.integer.Integer.previous_prime"><code class="xref py py-meth docutils literal"><span class="pre">previous_prime()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">2.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="mf">103.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">107</span>
<span class="gp">sage: </span><span class="mf">107.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">109</span>
<span class="gp">sage: </span><span class="mf">2044.</span><span class="n">next_prime_power</span><span class="p">()</span>
<span class="go">2048</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.next_probable_prime">
<code class="descname">next_probable_prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.next_probable_prime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the next probable prime after self, as determined by PARI.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">37</span><span class="p">)</span><span class="o">.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">512</span><span class="p">)</span><span class="o">.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084171</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">126.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">127</span>
<span class="gp">sage: </span><span class="mf">144168.</span><span class="n">next_probable_prime</span><span class="p">()</span>
<span class="go">144169</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.nth_root">
<code class="descname">nth_root</code><span class="sig-paren">(</span><em>n</em>, <em>truncate_mode=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.nth_root" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the (possibly truncated) n&#8217;th root of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> - integer &gt;= 1 (must fit in C int type).</li>
<li><code class="docutils literal"><span class="pre">truncate_mode</span></code> - boolean, whether to allow truncation if
self is not an n&#8217;th power.</li>
</ul>
<p>OUTPUT:</p>
<p>If truncate_mode is 0 (default), then returns the exact n&#8217;th root
if self is an n&#8217;th power, or raises a ValueError if it is not.</p>
<p>If truncate_mode is 1, then if either n is odd or self is
positive, returns a pair (root, exact_flag) where root is the
truncated nth root (rounded towards zero) and exact_flag is a
boolean indicating whether the root extraction was exact;
otherwise raises a ValueError.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey (2006-09-15)</li>
<li>Interface changed by John Cremona (2009-04-04)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">124 is not a 3rd power</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(4, False)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(5, True)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">126</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(5, False)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-5</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-5, True)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">124</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-4, False)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">126</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-5, False)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(11, False)</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">(5, True)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">125</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">n (=-5) must be positive</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">cannot take even root of negative number</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="mi">9</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">9 is not a 3rd power</span>

<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">22</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">9 is not a 22nd power</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">1048576 is not a 21st power</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="n">truncate_mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, False)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.numerator">
<code class="descname">numerator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.numerator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the numerator of this integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.odd_part">
<code class="descname">odd_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.odd_part" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The odd part of the integer <span class="math">\(n\)</span>. This is <span class="math">\(n / 2^v\)</span>,
where <span class="math">\(v = \mathrm{valuation}(n,2)\)</span>.</p>
<p>IMPLEMENTATION:</p>
<p>Currently returns 0 when self is 0.  This behaviour is fairly arbitrary,
and in Sage 4.6 this special case was not handled at all, eventually
propagating a TypeError.  The caller should not rely on the behaviour
in case self is 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">odd_part</span><span class="p">(</span><span class="n">factorial</span><span class="p">(</span><span class="mi">31</span><span class="p">))</span>
<span class="go">122529844256906551386796875</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.ord">
<code class="descname">ord</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.ord" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the p-adic valuation of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - an integer at least 2.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You can only compute the valuation with respect to a integer larger than 1.</span>
</pre></div>
</div>
<p>We do not require that p is a prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.ordinal_str">
<code class="descname">ordinal_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.ordinal_str" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a string representation of the ordinal associated to self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">ZZ</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">ordinal_str</span><span class="p">()</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">)]</span>
<span class="go">[&#39;0th&#39;,</span>
<span class="go">&#39;1st&#39;,</span>
<span class="go">&#39;2nd&#39;,</span>
<span class="go">&#39;3rd&#39;,</span>
<span class="go">&#39;4th&#39;,</span>
<span class="gp">...</span>
<span class="go">&#39;10th&#39;,</span>
<span class="go">&#39;11th&#39;,</span>
<span class="go">&#39;12th&#39;,</span>
<span class="go">&#39;13th&#39;,</span>
<span class="go">&#39;14th&#39;,</span>
<span class="gp">...</span>
<span class="go">&#39;20th&#39;,</span>
<span class="go">&#39;21st&#39;,</span>
<span class="go">&#39;22nd&#39;,</span>
<span class="go">&#39;23rd&#39;,</span>
<span class="go">&#39;24th&#39;]</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">1001</span><span class="p">)</span><span class="o">.</span><span class="n">ordinal_str</span><span class="p">()</span>
<span class="go">&#39;1001st&#39;</span>

<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">113</span><span class="p">)</span><span class="o">.</span><span class="n">ordinal_str</span><span class="p">()</span>
<span class="go">&#39;113th&#39;</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">112</span><span class="p">)</span><span class="o">.</span><span class="n">ordinal_str</span><span class="p">()</span>
<span class="go">&#39;112th&#39;</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span><span class="o">.</span><span class="n">ordinal_str</span><span class="p">()</span>
<span class="go">&#39;111th&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.perfect_power">
<code class="descname">perfect_power</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.perfect_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">(a,</span> <span class="pre">b)</span></code>, where this integer is <span class="math">\(a^b\)</span> and <span class="math">\(b\)</span> is maximal.</p>
<p>If called on <span class="math">\(-1\)</span>, <span class="math">\(0\)</span> or <span class="math">\(1\)</span>, <span class="math">\(b\)</span> will be <span class="math">\(1\)</span>, since there is no
maximal value of <span class="math">\(b\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_perfect_power" title="sage.rings.integer.Integer.is_perfect_power"><code class="xref py py-meth docutils literal"><span class="pre">is_perfect_power()</span></code></a>: testing whether an integer is a perfect
power is usually faster than finding <span class="math">\(a\)</span> and <span class="math">\(b\)</span>.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>: checks whether the base is prime.</li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_power_of" title="sage.rings.integer.Integer.is_power_of"><code class="xref py py-meth docutils literal"><span class="pre">is_power_of()</span></code></a>: if you know the base already, this method is
the fastest option.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">144.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(12, 2)</span>
<span class="gp">sage: </span><span class="mf">1.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(-1, 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(-2, 3)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(-4, 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">101</span><span class="o">^</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(101, 29)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">243</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(-3, 5)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">64</span><span class="p">)</span><span class="o">.</span><span class="n">perfect_power</span><span class="p">()</span>
<span class="go">(-4, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.popcount">
<code class="descname">popcount</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.popcount" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the number of 1 bits in the binary representation.
If self&lt;0, we return Infinity.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;1111011&#39;</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">popcount</span><span class="p">()</span>
<span class="go">6</span>

<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="mi">17</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">popcount</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.powermod">
<code class="descname">powermod</code><span class="sig-paren">(</span><em>exp</em>, <em>mod</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.powermod" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute self**exp modulo mod.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">powermod</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">powermod</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">powermod</span><span class="p">(</span><span class="o">-</span><span class="mi">31</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">^-</span><span class="mi">31</span> <span class="o">%</span> <span class="mi">31</span>
<span class="go">True</span>
</pre></div>
</div>
<p>As expected, the following is invalid:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">powermod</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">cannot raise to a power modulo 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.powermodm_ui">
<code class="descname">powermodm_ui</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.powermodm_ui" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Deprecated: Use <a class="reference internal" href="#sage.rings.integer.Integer.powermod" title="sage.rings.integer.Integer.powermod"><code class="xref py py-meth docutils literal"><span class="pre">powermod()</span></code></a> instead.
See <a class="reference external" href="https://trac.sagemath.org/17852">trac ticket #17852</a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.previous_prime">
<code class="descname">previous_prime</code><span class="sig-paren">(</span><em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.previous_prime" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the previous prime before self.</p>
<p>This method calls the PARI <code class="docutils literal"><span class="pre">precprime</span></code> function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> - if <code class="docutils literal"><span class="pre">True</span></code> ensure that the returned value is the next
prime power and if set to <code class="docutils literal"><span class="pre">False</span></code> uses probabilistic methods
(i.e. the result is not guaranteed). By default it uses global
configuration variables to determine which alternative to use (see
<code class="xref py py-mod docutils literal"><span class="pre">proof.arithmetic</span></code> or <code class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof</span></code>).</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.next_prime" title="sage.rings.integer.Integer.next_prime"><code class="xref py py-meth docutils literal"><span class="pre">next_prime()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">10.</span><span class="n">previous_prime</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="mf">7.</span><span class="n">previous_prime</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="mf">14376485.</span><span class="n">previous_prime</span><span class="p">()</span>
<span class="go">14376463</span>

<span class="gp">sage: </span><span class="mf">2.</span><span class="n">previous_prime</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no prime less than 2</span>
</pre></div>
</div>
<p>An example using <code class="docutils literal"><span class="pre">proof=False</span></code>, which is way faster since it does not
need a primality proof:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">previous_prime</span><span class="p">(</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">1024</span> <span class="o">-</span> <span class="n">b</span>
<span class="go">105</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.previous_prime_power">
<code class="descname">previous_prime_power</code><span class="sig-paren">(</span><em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.previous_prime_power" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the previous prime power before self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">proof</span></code> - if <code class="docutils literal"><span class="pre">True</span></code> ensure that the returned value is the next
prime power and if set to <code class="docutils literal"><span class="pre">False</span></code> uses probabilistic methods
(i.e. the result is not guaranteed). By default it uses global
configuration variables to determine which alternative to use (see
<code class="xref py py-mod docutils literal"><span class="pre">proof.arithmetic</span></code> or <code class="xref py py-mod docutils literal"><span class="pre">sage.structure.proof</span></code>).</li>
</ul>
<p>ALGORITHM:</p>
<p>The algorithm is naive. It computes the previous power of 2 and go
through the odd numbers calling the method <a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.rings.integer.Integer.next_prime_power" title="sage.rings.integer.Integer.next_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">next_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.is_prime_power" title="sage.rings.integer.Integer.is_prime_power"><code class="xref py py-meth docutils literal"><span class="pre">is_prime_power()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.previous_prime" title="sage.rings.integer.Integer.previous_prime"><code class="xref py py-meth docutils literal"><span class="pre">previous_prime()</span></code></a></li>
<li><a class="reference internal" href="#sage.rings.integer.Integer.next_prime" title="sage.rings.integer.Integer.next_prime"><code class="xref py py-meth docutils literal"><span class="pre">next_prime()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">3.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="mf">103.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">101</span>
<span class="gp">sage: </span><span class="mf">107.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">103</span>
<span class="gp">sage: </span><span class="mf">2044.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="go">2039</span>

<span class="gp">sage: </span><span class="mf">2.</span><span class="n">previous_prime_power</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">no prime power less than 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.prime_divisors">
<code class="descname">prime_divisors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.prime_divisors" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The prime divisors of self, sorted in increasing order. If n is
negative, we do <em>not</em> include -1 among the prime divisors, since
-1 is not a prime number.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2004</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.prime_factors">
<code class="descname">prime_factors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.prime_factors" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The prime divisors of self, sorted in increasing order. If n is
negative, we do <em>not</em> include -1 among the prime divisors, since
-1 is not a prime number.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">2004</span><span class="p">;</span> <span class="n">a</span><span class="o">.</span><span class="n">prime_divisors</span><span class="p">()</span>
<span class="go">[2, 3, 167]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.prime_to_m_part">
<code class="descname">prime_to_m_part</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.prime_to_m_part" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the prime-to-m part of self, i.e., the largest divisor of
<code class="docutils literal"><span class="pre">self</span></code> that is coprime to <code class="docutils literal"><span class="pre">m</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m</span></code> - Integer</li>
</ul>
<p>OUTPUT: Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">43434.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">21717</span>
<span class="gp">sage: </span><span class="mf">2048.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="mf">2048.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">2048</span>

<span class="gp">sage: </span><span class="mf">0.</span><span class="n">prime_to_m_part</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">self must be nonzero</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.quo_rem">
<code class="descname">quo_rem</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.quo_rem" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the quotient and the remainder of self divided by other.
Note that the remainder returned is always either zero or of the
same sign as other.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">other</span></code> - the divisor</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code> - the quotient of self/other</li>
<li><code class="docutils literal"><span class="pre">r</span></code> - the remainder of self/other</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">231</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(115, 1)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-116, -1)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ZeroDivisionError</span>: <span class="n">Integer division by zero</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">random_element</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">15</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="n">r</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="mf">3.</span><span class="n">quo_rem</span><span class="p">(</span><span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.radical">
<code class="descname">radical</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.radical" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the product of the prime divisors of self. Computing
the radical of zero gives an error.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">radical</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Radical of 0 not defined.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.rational_reconstruction">
<code class="descname">rational_reconstruction</code><span class="sig-paren">(</span><em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.rational_reconstruction" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the rational reconstruction of this integer modulo m, i.e.,
the unique (if it exists) rational number that reduces to self
modulo m and whose numerator and denominator is bounded by
sqrt(m/2).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">self</span></code> &#8211; Integer</li>
<li><code class="docutils literal"><span class="pre">m</span></code> &#8211; Integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="rational.html#sage.rings.rational.Rational" title="sage.rings.rational.Rational"><code class="xref py py-class docutils literal"><span class="pre">Rational</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">%</span><span class="mi">100</span>
<span class="go">29</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">29</span><span class="p">)</span><span class="o">.</span><span class="n">rational_reconstruction</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">3/7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.real">
<code class="descname">real</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.real" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the real part of self, which is self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">real</span><span class="p">()</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.sign">
<code class="descname">sign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.sign" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the sign of this integer, which is -1, 0, or 1
depending on whether this number is negative, zero, or positive
respectively.</p>
<p>OUTPUT: Integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">500.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">^</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.sqrt">
<code class="descname">sqrt</code><span class="sig-paren">(</span><em>prec=None</em>, <em>extend=True</em>, <em>all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.sqrt" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The square root function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> - integer (default: None): if None, returns
an exact square root; otherwise returns a numerical square root if
necessary, to the given bits of precision.</li>
<li><code class="docutils literal"><span class="pre">extend</span></code> - bool (default: True); if True, return a
square root in an extension ring, if necessary. Otherwise, raise a
ValueError if the square is not in the base ring. Ignored if prec
is not None.</li>
<li><code class="docutils literal"><span class="pre">all</span></code> - bool (default: False); if True, return all
square roots of self, instead of just one.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">144</span><span class="p">))</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">102</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">sqrt(102)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[sqrt(2), -sqrt(2)]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1.4</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1.4142135623730950488016887242</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1.4142135623730950488016887242, -1.4142135623730950488016887242]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">square root of 2 not an integer</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">144</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[12, -12]</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">53</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.real_mpfr.RealNumber&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">53</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.complex_number.ComplexNumber&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.sqrtrem">
<code class="descname">sqrtrem</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.sqrtrem" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return (s, r) where s is the integer square root of self and
r is the remainder such that <span class="math">\(\text{self} = s^2 + r\)</span>.
Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if self is negative.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">25.</span><span class="n">sqrtrem</span><span class="p">()</span>
<span class="go">(5, 0)</span>
<span class="gp">sage: </span><span class="mf">27.</span><span class="n">sqrtrem</span><span class="p">()</span>
<span class="go">(5, 2)</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">sqrtrem</span><span class="p">()</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">102</span><span class="p">)</span><span class="o">.</span><span class="n">sqrtrem</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">square root of negative integer not defined.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.squarefree_part">
<code class="descname">squarefree_part</code><span class="sig-paren">(</span><em>bound=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.squarefree_part" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the square free part of <span class="math">\(x\)</span> (=self), i.e., the unique integer
<span class="math">\(z\)</span> that <span class="math">\(x = z y^2\)</span>, with <span class="math">\(y^2\)</span> a perfect square and <span class="math">\(z\)</span> square-free.</p>
<p>Use <code class="docutils literal"><span class="pre">self.radical()</span></code> for the product of the primes that divide self.</p>
<p>If self is 0, just returns 0.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="mi">17</span><span class="o">*</span><span class="mi">37</span><span class="o">*</span><span class="mi">37</span><span class="p">)</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="o">*</span><span class="mi">32</span><span class="p">)</span>
<span class="go">-34</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">squarefree_part</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">5</span><span class="o">^</span><span class="mi">6</span> <span class="o">*</span> <span class="mi">101</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2 * 5^6 * 101^2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2 * 101^2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">2</span><span class="o">**</span><span class="mi">14</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">7</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">100</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">/</span> <span class="n">a</span><span class="o">.</span><span class="n">squarefree_part</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">49</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.str">
<code class="descname">str</code><span class="sig-paren">(</span><em>base=10</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.str" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the string representation of <code class="docutils literal"><span class="pre">self</span></code> in the
given base.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;10000000000&#39;</span>
<span class="gp">sage: </span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="go">&#39;394&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">two</span><span class="o">=</span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">two</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">base (=1) must be between 2 and 36</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">two</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">base (=37) must be between 2 and 36</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">big</span> <span class="o">=</span> <span class="mi">10</span><span class="o">^</span><span class="mi">5000000</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">big</span><span class="o">.</span><span class="n">str</span><span class="p">()</span>       <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>              <span class="c1"># long time (depends on above defn of s)</span>
<span class="go">5000001</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span>              <span class="c1"># long time (depends on above defn of s)</span>
<span class="go">&#39;1000000000&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.support">
<code class="descname">support</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.support" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a sorted list of the primes dividing this integer.</p>
<p>OUTPUT: The sorted list of primes appearing in the factorization of
this rational with positive exponent.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[2, 3, 5, 7]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">999</span><span class="p">)</span><span class="o">.</span><span class="n">support</span><span class="p">()</span>
<span class="go">[3, 37]</span>
</pre></div>
</div>
<p>Trying to find the support of 0 gives an arithmetic error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">0.</span><span class="n">support</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Support of 0 not defined.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.test_bit">
<code class="descname">test_bit</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.test_bit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the bit at <code class="docutils literal"><span class="pre">index</span></code>.</p>
<p>If the index is negative, returns 0.</p>
<p>Although internally a sign-magnitude representation is used
for integers, this method pretends to use a two&#8217;s complement
representation.  This is illustrated with a negative integer
below.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;110&#39;</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">test_bit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">test_bit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">str</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">&#39;-10100&#39;</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">test_bit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">test_bit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">test_bit</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.trailing_zero_bits">
<code class="descname">trailing_zero_bits</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.trailing_zero_bits" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the number of trailing zero bits in self, i.e.
the exponent of the largest power of 2 dividing self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">11.</span><span class="n">trailing_zero_bits</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">trailing_zero_bits</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">11</span><span class="o">&lt;&lt;</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">trailing_zero_bits</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="mi">11</span><span class="o">&lt;&lt;</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">trailing_zero_bits</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">trailing_zero_bits</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.trial_division">
<code class="descname">trial_division</code><span class="sig-paren">(</span><em>bound='LONG_MAX'</em>, <em>start=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.trial_division" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return smallest prime divisor of self up to bound, beginning
checking at start, or abs(self) if no such divisor is found.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">bound</span></code> &#8211; a positive integer that fits in a C signed long</li>
<li><code class="docutils literal"><span class="pre">start</span></code> &#8211; a positive integer that fits in a C signed long</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>a positive integer</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">7</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">1000003</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">1000003</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">10000049000057</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">bound</span><span class="o">=-</span><span class="mi">10</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">bound must be positive</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">bound must be positive</span>
<span class="gp">sage: </span><span class="n">ZZ</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">self must be nonzero</span>

<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">40</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">100003</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1000030000000000000000000000000000000012100363</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">bound</span><span class="o">=</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1000030000000000000000000000000000000012100363</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">100003</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">40</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">40</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">40</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">next_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">);</span> <span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<p>You can specify a starting point:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">101</span><span class="o">*</span><span class="mi">103</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">trial_division</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">101</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.val_unit">
<code class="descname">val_unit</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.val_unit" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns a pair: the p-adic valuation of self, and the p-adic unit
of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - an integer at least 2.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v_p(self)</span></code> - the p-adic valuation of <code class="docutils literal"><span class="pre">self</span></code></li>
<li><code class="docutils literal"><span class="pre">u_p(self)</span></code> - <code class="docutils literal"><span class="pre">self</span></code> / <span class="math">\(p^{v_p(\mathrm{self})}\)</span></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">val_unit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2, 15)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">val_unit</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 20)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">val_unit</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(0, 60)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">val_unit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(5, 2)</span>
<span class="gp">sage: </span><span class="mf">0.</span><span class="n">val_unit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(+Infinity, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.valuation" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the p-adic valuation of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - an integer at least 2.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You can only compute the valuation with respect to a integer larger than 1.</span>
</pre></div>
</div>
<p>We do not require that p is a prime:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.integer.Integer.xgcd">
<code class="descname">xgcd</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.Integer.xgcd" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the extended gcd of this element and <code class="docutils literal"><span class="pre">n</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">n</span></code> &#8211; an integer</li>
</ul>
<p>OUTPUT:</p>
<p>A triple <code class="docutils literal"><span class="pre">(g,</span> <span class="pre">s,</span> <span class="pre">t)</span></code> such that <code class="docutils literal"><span class="pre">g</span></code> is the non-negative gcd of
<code class="docutils literal"><span class="pre">self</span></code> and <code class="docutils literal"><span class="pre">n</span></code>, and <code class="docutils literal"><span class="pre">s</span></code> and <code class="docutils literal"><span class="pre">t</span></code> are cofactors satisfying the
Bezout identity</p>
<div class="math">
\[g = s \cdot \mathrm{self} + t \cdot n.\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is no guarantee that the cofactors will be minimal. If you
need the cofactors to be minimal use <code class="xref py py-meth docutils literal"><span class="pre">_xgcd()</span></code>. Also, using
<code class="xref py py-meth docutils literal"><span class="pre">_xgcd()</span></code> directly might be faster in some cases, see
<a class="reference external" href="https://trac.sagemath.org/13628">trac ticket #13628</a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">6.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(2, 1, -1)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.rings.integer.IntegerWrapper">
<em class="property">class </em><code class="descclassname">sage.rings.integer.</code><code class="descname">IntegerWrapper</code><a class="headerlink" href="#sage.rings.integer.IntegerWrapper" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.rings.integer.Integer" title="sage.rings.integer.Integer"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.integer.Integer</span></code></a></p>
<p>Rationale for the <code class="docutils literal"><span class="pre">IntegerWrapper</span></code> class:</p>
<p>With <code class="docutils literal"><span class="pre">Integers</span></code>, the allocation/deallocation function slots are
hijacked with custom functions that stick already allocated
<code class="docutils literal"><span class="pre">Integers</span></code> (with initialized <code class="docutils literal"><span class="pre">parent</span></code> and <code class="docutils literal"><span class="pre">mpz_t</span></code> fields)
into a pool on &#8220;deallocation&#8221; and then pull them out whenever a
new one is needed. Because <code class="docutils literal"><span class="pre">Integers</span></code> are so common, this is
actually a significant savings. However , this does cause issues
with subclassing a Python class directly from <code class="docutils literal"><span class="pre">Integer</span></code> (but
that&#8217;s ok for a Cython class).</p>
<p>As a workaround, one can instead derive a class from the
intermediate class <code class="docutils literal"><span class="pre">IntegerWrapper</span></code>, which sets statically its
alloc/dealloc methods to the <em>original</em> <code class="docutils literal"><span class="pre">Integer</span></code> alloc/dealloc
methods, before they are swapped manually for the custom ones.</p>
<p>The constructor of <code class="docutils literal"><span class="pre">IntegerWrapper</span></code> further allows for
specifying an alternative parent to <code class="docutils literal"><span class="pre">IntegerRing()</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="sage.rings.integer.free_integer_pool">
<code class="descclassname">sage.rings.integer.</code><code class="descname">free_integer_pool</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.free_integer_pool" title="Permalink to this definition">Â¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="sage.rings.integer.int_to_Z">
<em class="property">class </em><code class="descclassname">sage.rings.integer.</code><code class="descname">int_to_Z</code><a class="headerlink" href="#sage.rings.integer.int_to_Z" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></code></a></p>
<p>Morphism from Python ints to Sage integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="nb">int</span><span class="p">);</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.int_to_Z&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="n">r</span><span class="p">)</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">5</span><span class="n">r</span><span class="p">))</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage: </span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="n">r</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="n">r</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
</pre></div>
</div>
<p>This is intented for internal use by the coercion system,
to facilitate fast expressions mixing ints and more complex
Python types.  Note that (as with all morphisms) the input
is forcably coerced to the domain <code class="docutils literal"><span class="pre">int</span></code> if it is not
already of the correct type which may have undesirable results:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Set of Python objects of type &#39;int&#39;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mf">1.7</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="s2">&quot;10&quot;</span><span class="p">)</span>
<span class="go">10</span>
</pre></div>
</div>
<p>A pool is used for small integers:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="ow">is</span> <span class="n">f</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="ow">is</span> <span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.integer.is_Integer">
<code class="descclassname">sage.rings.integer.</code><code class="descname">is_Integer</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.is_Integer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return true if x is of the Sage integer type.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.integer</span> <span class="kn">import</span> <span class="n">is_Integer</span>
<span class="gp">sage: </span><span class="n">is_Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_Integer</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_Integer</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_Integer</span><span class="p">(</span><span class="nb">long</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">is_Integer</span><span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.rings.integer.long_to_Z">
<em class="property">class </em><code class="descclassname">sage.rings.integer.</code><code class="descname">long_to_Z</code><a class="headerlink" href="#sage.rings.integer.long_to_Z" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage Reference Manual: Category Framework v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.morphism.Morphism</span></code></a></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">coerce_map_from</span><span class="p">(</span><span class="nb">long</span><span class="p">);</span> <span class="n">f</span>
<span class="go">Native morphism:</span>
<span class="go">  From: Set of Python objects of type &#39;long&#39;</span>
<span class="go">  To:   Integer Ring</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="n">rL</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">10000000000000000000001</span><span class="n">r</span><span class="p">)</span>
<span class="go">-10000000000000000000001</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.rings.integer.make_integer">
<code class="descclassname">sage.rings.integer.</code><code class="descname">make_integer</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.integer.make_integer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Create a Sage integer from the base-32 Python <em>string</em> s. This is
used in unpickling integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.rings.integer</span> <span class="kn">import</span> <span class="n">make_integer</span>
<span class="gp">sage: </span><span class="n">make_integer</span><span class="p">(</span><span class="s1">&#39;-29&#39;</span><span class="p">)</span>
<span class="go">-73</span>
<span class="gp">sage: </span><span class="n">make_integer</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">expected string or Unicode object, sage.rings.integer.Integer found</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="integer_ring.html"
                                  title="previous chapter">Ring <span class="math">\(\ZZ\)</span> of Integers</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="bernmm.html"
                                  title="next chapter">Cython wrapper for bernmm library</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/rings/integer.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bernmm.html" title="Cython wrapper for bernmm library"
             >next</a> |</li>
        <li class="right" >
          <a href="integer_ring.html" title="Ring \(\ZZ\) of Integers"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Standard Commutative Rings</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2017, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>