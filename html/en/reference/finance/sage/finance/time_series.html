
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>Time Series &#8212; Sage 9.3 Reference Manual: Quantitative Finance</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Stock Market Price Series" href="stock.html" />
    <link rel="prev" title="Quantitative Finance" href="../../index.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stock.html" title="Stock Market Price Series"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quantitative Finance"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.3 Reference Manual: Quantitative Finance</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Time Series</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="time-series">
<span id="sage-finance-time-series"></span><h1>Time Series<a class="headerlink" href="#time-series" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.finance.time_series"></span><p>This is a module for working with discrete floating point time series.
It is designed so that every operation is very fast, typically much
faster than with other generic code, e.g., Python lists of doubles or
even NumPy arrays.  The semantics of time series is more similar to
Python lists of doubles than Sage real double vectors or NumPy 1-D
arrays.   In particular, time series are not endowed with much
algebraic structure and are always mutable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>NumPy arrays are faster at slicing, since slices return
references, and NumPy arrays have strides.  However, this speed at
slicing makes NumPy slower at certain other operations.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">random</span><span class="p">()</span><span class="o">-</span><span class="mf">0.5</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]);</span> <span class="n">t</span>
<span class="go">[0.3294, 0.0959, -0.0706, -0.4646, 0.4311, 0.2275, -0.3840, -0.3528, -0.4119, -0.2933]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span>
<span class="go">[0.3294, 0.4253, 0.3547, -0.1099, 0.3212, 0.5487, 0.1647, -0.1882, -0.6001, -0.8933]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>
<span class="go">[0.0000, 0.3294, 0.1660, 0.0003, -0.3251, 0.2042, 0.2205, -0.2027, -0.3078, -0.3807]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
<span class="go">0.33729638212891383</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">-0.08933425506929439</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">variance</span><span class="p">()</span>
<span class="go">0.1137688493972542...</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>William Stein</p></li>
</ul>
<dl class="py class">
<dt id="sage.finance.time_series.TimeSeries">
<em class="property">class </em><code class="sig-prename descclassname">sage.finance.time_series.</code><code class="sig-name descname">TimeSeries</code><a class="headerlink" href="#sage.finance.time_series.TimeSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Initialize new time series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code> – integer (number of values) or an iterable of
floats.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initialize</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, do not
bother to zero out the entries of the new time series.
For large series that you are going to just fill in,
this can be way faster.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>This implicitly calls init:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">18.2</span><span class="p">])</span>
<span class="go">[3.1416, 3.0000, 18.2000]</span>
</pre></div>
</div>
<p>Conversion from a NumPy 1-D array, which is very fast:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000]</span>
</pre></div>
</div>
<p>Conversion from an n-dimensional NumPy array also works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">);</span> <span class="n">v</span>
<span class="go">array([[1., 2.],</span>
<span class="go">       [3., 4.]])</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000]</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[1.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000]</span>
</pre></div>
</div>
<p>For speed purposes we don’t initialize (so value is garbage):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">initialize</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.abs">
<code class="sig-name descname">abs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series got by replacing all entries
of <code class="docutils literal notranslate"><span class="pre">self</span></code> by their absolute value.</p>
<p>OUTPUT:</p>
<p>A new time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mf">3.1908439</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mf">5.93932</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[1.0000, 3.1908, -4.0000, 5.9393]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">[1.0000, 3.1908, 4.0000, 5.9393]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.add_entries">
<code class="sig-name descname">add_entries</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.add_entries" title="Permalink to this definition">¶</a></dt>
<dd><p>Add corresponding entries of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code> together,
extending either <code class="docutils literal notranslate"><span class="pre">self</span></code> or <code class="docutils literal notranslate"><span class="pre">t</span></code> by 0’s if they do
not have the same length.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To add a single number to the entries of a time series,
use the <code class="docutils literal notranslate"><span class="pre">add_scalar</span></code> method.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> – a time series.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series with length the maxima of the lengths of
<code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">t</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">add_entries</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">[4.0000, 6.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">add_entries</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[2.0000, 4.0000, -10.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">add_entries</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mf">18.5</span><span class="p">])</span>
<span class="go">[4.0000, 6.0000, 2.0000, 18.5000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.add_scalar">
<code class="sig-name descname">add_scalar</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.add_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series obtained by adding a scalar to every
value in the series.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To add componentwise, use the <code class="docutils literal notranslate"><span class="pre">add_entries</span></code> method.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – a float.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new time series with <code class="docutils literal notranslate"><span class="pre">s</span></code> added to all values.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[5.5000, 4.5000, 1.8000, 2.5000, 8.5000, 10.5000, 3.5000, -4.5000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.autocorrelation">
<code class="sig-name descname">autocorrelation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-th sample autocorrelation of this time series
<span class="math notranslate nohighlight">\(x_i\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(\mu\)</span> be the sample mean.  Then the sample autocorrelation
function is</p>
<div class="math notranslate nohighlight">
\[\frac{\sum_{t=0}^{n-k-1} (x_t - \mu)(x_{t+k} - \mu) }
     {\sum_{t=0}^{n-1}   (x_t - \mu)^2}.\]</div>
<p>Note that the variance must be nonzero or you will get a
<code class="docutils literal notranslate"><span class="pre">ZeroDivisionError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a nonnegative integer (default: 1)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">()</span>
<span class="go">-0.1875</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-0.1875</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-0.20138888888888887</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0.18055555555555555</span>

<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">1000</span><span class="p">])</span><span class="o">.</span><span class="n">autocorrelation</span><span class="p">()</span>
<span class="go">0.997</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.autocovariance">
<code class="sig-name descname">autocovariance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.autocovariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-th autocovariance function <span class="math notranslate nohighlight">\(\gamma(k)\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
This is the covariance of <code class="docutils literal notranslate"><span class="pre">self</span></code> with <code class="docutils literal notranslate"><span class="pre">self</span></code> shifted by <span class="math notranslate nohighlight">\(k\)</span>, i.e.,</p>
<div class="math notranslate nohighlight">
\[\left.
\left( \sum_{t=0}^{n-k-1} (x_t - \mu)(x_{t + k} - \mu) \right)
\right/ n,\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the length of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Note the denominator of <span class="math notranslate nohighlight">\(n\)</span>, which gives a “better” sample
estimator.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a nonnegative integer (default: 0)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A float.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">13</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">14.4</span>
<span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">();</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">a</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">v</span><span class="p">])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">14.4</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2.7</span>
<span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">();</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">-2.7</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2.7</span>
</pre></div>
</div>
<p>We illustrate with a random sample that an independently and
identically distributed distribution with zero mean and
variance <span class="math notranslate nohighlight">\(\sigma^2\)</span> has autocovariance function <span class="math notranslate nohighlight">\(\gamma(h)\)</span>
with <span class="math notranslate nohighlight">\(\gamma(0) = \sigma^2\)</span> and <span class="math notranslate nohighlight">\(\gamma(h) = 0\)</span> for <span class="math notranslate nohighlight">\(h\neq 0\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">[3.3835, -2.0055, 1.7882, -2.9319, -4.6827 ... -5.1868, 9.2613, 0.9274, -6.2282, -8.7652]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">24.95410689...</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-0.00508390...</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.022056325...</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-0.01902000...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.autoregressive_fit">
<code class="sig-name descname">autoregressive_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">M</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.autoregressive_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>This method fits the time series to an autoregressive process
of order <code class="docutils literal notranslate"><span class="pre">M</span></code>. That is, we assume the process is given by
<span class="math notranslate nohighlight">\(X_t-\mu=a_1(X_{t-1}-\mu)+a_2(X_{t-1}-\mu)+\cdots+a_M(X_{t-M}-\mu)+Z_t\)</span>
where <span class="math notranslate nohighlight">\(\mu\)</span> is the mean of the process and <span class="math notranslate nohighlight">\(Z_t\)</span> is noise.
This method returns estimates for <span class="math notranslate nohighlight">\(a_1,\dots,a_M\)</span>.</p>
<p>The method works by solving the Yule-Walker equations
<span class="math notranslate nohighlight">\(\Gamma a =\gamma\)</span>, where <span class="math notranslate nohighlight">\(\gamma=(\gamma(1),\dots,\gamma(M))\)</span>,
<span class="math notranslate nohighlight">\(a=(a_1,\dots,a_M)\)</span>  with <span class="math notranslate nohighlight">\(\gamma(i)\)</span> the autocovariance of lag <span class="math notranslate nohighlight">\(i\)</span>
and <span class="math notranslate nohighlight">\(\Gamma_{ij}=\gamma(i-j)\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The input sequence is assumed to be stationary, which
means that the autocovariance <span class="math notranslate nohighlight">\(\langle y_j y_k \rangle\)</span> depends
only on the difference <span class="math notranslate nohighlight">\(|j-k|\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">M</span></code> – an integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series – the coefficients of the autoregressive process.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[0.6767, 0.2756, 0.6332, 0.0469, -0.8897 ... 87.6759, 87.6825, 87.4120, 87.6639, 86.3194]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">86.0177285042...</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[1.0148, -0.0029, -0.0105, 0.0067, -0.0232 ... -0.0106, -0.0068, 0.0085, -0.0131, 0.0092]</span>

<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">=</span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">2000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1.6767, 0.5989, 1.3576, 0.4136, 0.0635 ... 1.0057, -1.1467, 1.2809, 1.5705, 1.1095]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2000</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#recovers recurrence relation</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="c1">#should be close to [1,-0.5]</span>
<span class="go">[1.0371, -0.5199]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.autoregressive_forecast">
<code class="sig-name descname">autoregressive_forecast</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filter</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.autoregressive_forecast" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the autoregression coefficients as outputted by the
<code class="docutils literal notranslate"><span class="pre">autoregressive_fit</span></code> command, compute the forecast for the next
term in the series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">filter</span></code> – a time series outputted by the <code class="docutils literal notranslate"><span class="pre">autoregressive_fit</span></code>
command.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">F</span>
<span class="go">[1.0019, -0.0524, -0.0643, 0.1323, -0.0539]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">11.7820298611...</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[0.6767, 0.2756, 0.6332, 0.0469, -0.8897 ... 9.2447, 9.6709, 10.4037, 10.4836, 12.1960]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.central_moment">
<code class="sig-name descname">central_moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.central_moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-th central moment of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is just the mean
of the k-th powers of the differences <code class="docutils literal notranslate"><span class="pre">self[i]</span> <span class="pre">-</span> <span class="pre">mu</span></code>, where <code class="docutils literal notranslate"><span class="pre">mu</span></code> is
the mean of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">central_moment</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0.6666666666666666</span>
</pre></div>
</div>
<p>Note that the central moment is different from the moment
here, since the mean is not <span class="math notranslate nohighlight">\(0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>     <span class="c1"># doesn&#39;t subtract off mean</span>
<span class="go">4.666666666666667</span>
</pre></div>
</div>
<p>We compute the central moment directly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mu</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">();</span> <span class="n">mu</span>
<span class="go">2.0</span>
<span class="gp">sage: </span><span class="p">((</span><span class="mi">1</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="n">mu</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span>
<span class="go">0.6666666666666666</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.clip_remove">
<code class="sig-name descname">clip_remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">min</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.clip_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series obtained from <code class="docutils literal notranslate"><span class="pre">self</span></code> by removing all
values that are less than or equal to a certain minimum value
or greater than or equal to a certain maximum.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) <code class="docutils literal notranslate"><span class="pre">None</span></code> or double.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) <code class="docutils literal notranslate"><span class="pre">None</span></code> or double.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[3.0000, 4.0000, 5.0000, 6.0000, 7.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="nb">max</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.correlation">
<code class="sig-name descname">correlation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.correlation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the correlation of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>, which is the
covariance of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> divided by the product of their
standard deviation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, <code class="docutils literal notranslate"><span class="pre">other</span></code> – time series.</p></li>
</ul>
<p>Whichever time series has more terms is truncated.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">w</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">-0.558041609...</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">covariance</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span> <span class="o">*</span> <span class="n">w</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">())</span>
<span class="go">-0.558041609...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.covariance">
<code class="sig-name descname">covariance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">other</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.covariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the covariance of the time series <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, <code class="docutils literal notranslate"><span class="pre">other</span></code> – time series.</p></li>
</ul>
<p>Whichever time series has more terms is truncated.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">w</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">covariance</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">-11.777777777777779</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.diffs">
<code class="sig-name descname">diffs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.diffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new time series got by taking the differences of
successive terms in the time series.  So if <code class="docutils literal notranslate"><span class="pre">self</span></code> is the time
series <span class="math notranslate nohighlight">\(X_0, X_1, X_2, \dots\)</span>, then this function outputs the
series <span class="math notranslate nohighlight">\(X_1 - X_0, X_2 - X_1, \dots\)</span>.  The output series has one
less term than the input series.  If the optional parameter
<span class="math notranslate nohighlight">\(k\)</span> is given, return <span class="math notranslate nohighlight">\(X_k - X_0, X_{2k} - X_k, \dots\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – positive integer (default: 1)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">diffs</span><span class="p">()</span>
<span class="go">[-1.0000, -2.7000, 0.7000, 6.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.exp">
<code class="sig-name descname">exp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series got by applying the exponential map to
all the terms in the time series.</p>
<p>OUTPUT:</p>
<p>A new time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">[2.7183, 7.3891, 20.0855, 54.5982, 148.4132]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.exponential_moving_average">
<code class="sig-name descname">exponential_moving_average</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.exponential_moving_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponential moving average time series.  Assumes
the input time series was constant with its starting value for
negative time.  The t-th step of the output is the sum of the
previous k-1 steps of <code class="docutils literal notranslate"><span class="pre">self</span></code> and the k-th step divided by k.</p>
<p>The 0-th term is formally undefined, so we define it to be 0,
and we define the first term to be <code class="docutils literal notranslate"><span class="pre">self[0]</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code> – float; a smoothing factor with <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">alpha</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series with the same number of steps as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0.0000, 1.0000, 1.0000, 1.0000, 1.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0.0000, 1.0000, 1.0000, 1.0000, 2.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[0.0000, 1.0000, 1.0000, 1.0000, 1.5000]</span>
</pre></div>
</div>
<p>Some more examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0.0000, 1.0000, 2.0000, 3.0000, 4.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exponential_moving_average</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0.0000, 1.0000, 1.0000, 1.0000, 1.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.extend">
<code class="sig-name descname">extend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">right</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Extend this time series by appending elements from the iterable
<code class="docutils literal notranslate"><span class="pre">right</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">right</span></code> – iterable that can be converted to a time series.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="o">-</span><span class="mf">3.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[1.0000, 2.0000, -5.0000, -3.5000, 2.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.fft">
<code class="sig-name descname">fft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.fft" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the real discrete fast Fourier transform of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as a
real time series:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}[y(0),\Re(y(1)),\Im(y(1)),\dots,\Re(y(n/2))]  \text{ if $n$ is even}\\[y(0),\Re(y(1)),\Im(y(1)),\dots,\Re(y(n/2)),\Im(y(n/2))] \text{ if $n$ is odd}\end{aligned}\end{align} \]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[y(j) = \sum_{k=0}^{n-1} x[k] \cdot \exp(-\sqrt{-1} \cdot jk \cdot 2\pi/n)\]</div>
<p>for <span class="math notranslate nohighlight">\(j = 0,\dots,n-1\)</span>.  Note that <span class="math notranslate nohighlight">\(y(-j) = y(n-j)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">fft</span><span class="p">();</span> <span class="n">w</span>
<span class="go">[45.0000, -4.5000, 12.3636, -4.5000, 5.3629, -4.5000, 2.5981, -4.5000, 0.7935]</span>
</pre></div>
</div>
<p>We get just the series of real parts of</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[45.0000, -4.5000, -4.5000, -4.5000, -4.5000]</span>
</pre></div>
</div>
<p>An example with an even number of terms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000]</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">fft</span><span class="p">();</span> <span class="n">w</span>
<span class="go">[55.0000, -5.0000, 15.3884, -5.0000, 6.8819, -5.0000, 3.6327, -5.0000, 1.6246, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span><span class="o">.</span><span class="n">ifft</span><span class="p">()</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.histogram">
<code class="sig-name descname">histogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the frequency histogram of the values in
this time series divided up into the given
number of bins.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code> – a positive integer (default: 50)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalize</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) whether to normalize so the
total area in the bars of the histogram is 1.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>counts – list of counts of numbers of elements in
each bin.</p></li>
<li><p>endpoints – list of 2-tuples (a,b) that give the
endpoints of the bins.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([1, 4, 3], [(-5.0, 0.0), (0.0, 5.0), (5.0, 10.0)])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.hurst_exponent">
<code class="sig-name descname">hurst_exponent</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.hurst_exponent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an estimate of the Hurst exponent of this time series.</p>
<p>We use the algorithm from pages 61 – 63 of [Peteres, Fractal
Market Analysis (1994); see Google Books].</p>
<p>We define the Hurst exponent of a constant time series to be 1.</p>
<p>EXAMPLES:</p>
<p>The Hurst exponent of Brownian motion is 1/2.  We approximate
it with some specific samples.  Note that the estimator is
biased and slightly overestimates.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bm</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sums</span><span class="p">();</span> <span class="n">bm</span>
<span class="go">[0.6767, 0.2756, 0.6332, 0.0469, -0.8897 ... 152.2437, 151.5327, 152.7629, 152.9169, 152.9084]</span>
<span class="gp">sage: </span><span class="n">bm</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span>
<span class="go">0.527450972...</span>
</pre></div>
</div>
<p>We compute the Hurst exponent of a simulated fractional Brownian
motion with Hurst parameter 0.7.  This function estimates the
Hurst exponent as 0.706511951…</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fbm</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">fractional_brownian_motion_simulation</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fbm</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span>
<span class="go">0.706511951...</span>
</pre></div>
</div>
<p>Another example with small Hurst exponent (notice the overestimation).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fbm</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">fractional_brownian_motion_simulation</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">10</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">fbm</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span>
<span class="go">0.278997441...</span>
</pre></div>
</div>
<p>We compute the mean Hurst exponent of 100 simulated multifractal
cascade random walks:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">multifractal_cascade_random_walk_simulation</span><span class="p">(</span><span class="mi">3700</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">z</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">0.57984822577934...</span>
</pre></div>
</div>
<p>We compute the mean Hurst exponent of 100 simulated Markov switching
multifractal time series.  The Hurst exponent is quite small.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">msm</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">MarkovSwitchingMultifractal</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mf">1.4</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.95</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">simulations</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">z</span><span class="o">.</span><span class="n">hurst_exponent</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">0.286102325623705...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.ifft">
<code class="sig-name descname">ifft</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.ifft" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the real discrete inverse fast Fourier transform of
<code class="docutils literal notranslate"><span class="pre">self</span></code>, which is also a real time series.</p>
<p>This is the inverse of <code class="docutils literal notranslate"><span class="pre">fft()</span></code>.</p>
<p>The returned real array contains</p>
<div class="math notranslate nohighlight">
\[[y(0),y(1),\dots,y(n-1)]\]</div>
<p>where for <span class="math notranslate nohighlight">\(n\)</span> is even</p>
<div class="math notranslate nohighlight">
\[y(j)
=
1/n \left(
\sum_{k=1}^{n/2-1}
(x[2k-1]+\sqrt{-1} \cdot x[2k])
\cdot \exp(\sqrt{-1} \cdot jk \cdot 2pi/n)
+ c.c. + x[0] + (-1)^j x[n-1]
\right)\]</div>
<p>and for <span class="math notranslate nohighlight">\(n\)</span> is odd</p>
<div class="math notranslate nohighlight">
\[y(j)
=
1/n \left(
\sum_{k=1}^{(n-1)/2}
(x[2k-1]+\sqrt{-1} \cdot x[2k])
\cdot \exp(\sqrt{-1} \cdot jk \cdot 2pi/n)
+ c.c. + x[0]
\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(c.c.\)</span> denotes complex conjugate of preceding expression.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">ifft</span><span class="p">()</span>
<span class="go">[5.1000, -5.6876, 1.4764, -1.0774, 0.4249, -0.1000, -0.2249, 0.6663, -1.2764, 1.6988]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">ifft</span><span class="p">()</span><span class="o">.</span><span class="n">fft</span><span class="p">()</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000, 6.0000, 7.0000, 8.0000, 9.0000, 10.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.list">
<code class="sig-name descname">list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of elements of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">[1.0, -4.0, 3.0, -2.5, -4.0, 3.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.log">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series got by taking the logarithms of all the
terms in the time series.</p>
<p>OUTPUT:</p>
<p>A new time series.</p>
<p>EXAMPLES:</p>
<p>We exponentiate then log a time series and get back
the original series:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, -4.0000, 3.0000, -2.5000, -4.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">[2.7183, 0.0183, 20.0855, 0.0821, 0.0183, 20.0855]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">[1.0000, -4.0000, 3.0000, -2.5000, -4.0000, 3.0000]</span>
</pre></div>
</div>
<p>Log of 0 gives <code class="docutils literal notranslate"><span class="pre">-inf</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">log</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">-inf</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.max">
<code class="sig-name descname">max</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the largest value in this time series. If this series
has length 0 we raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return
index of maximum entry.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>float – largest value.</p></li>
<li><p>integer – index of largest value; only returned if <code class="docutils literal notranslate"><span class="pre">index=True</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="go">3.0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(3.0, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.mean">
<code class="sig-name descname">mean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean (average) of the elements of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">1.6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.min">
<code class="sig-name descname">min</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">index</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the smallest value in this time series. If this series
has length 0 we raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, also return
index of minimal entry.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>float – smallest value.</p></li>
<li><p>integer – index of smallest value; only returned if <code class="docutils literal notranslate"><span class="pre">index=True</span></code>.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="go">-4.0</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(-4.0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.moment">
<code class="sig-name descname">moment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.moment" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the k-th moment of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is just the
mean of the k-th powers of the elements of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1.6</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3.2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.numpy">
<code class="sig-name descname">numpy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">copy</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.numpy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a NumPy version of this time series.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If copy is <code class="docutils literal notranslate"><span class="pre">False</span></code>, return a NumPy 1-D array reference to
exactly the same block of memory as this time series.  This is
very, very fast and makes it easy to quickly use all
NumPy/SciPy functionality on <code class="docutils literal notranslate"><span class="pre">self</span></code>.  However, it is dangerous
because when this time series goes out of scope and is garbage
collected, the corresponding NumPy reference object will point
to garbage.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">copy</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A numpy 1-D array.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mf">4.5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">(</span><span class="n">copy</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">w</span>
<span class="go">array([ 1. , -3. ,  4.5, -2. ])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="go">&lt;... &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4,)</span>
</pre></div>
</div>
<p>Notice that changing <code class="docutils literal notranslate"><span class="pre">w</span></code> also changes <code class="docutils literal notranslate"><span class="pre">v</span></code> too!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">array([20. , -3. ,  4.5, -2. ])</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[20.0000, -3.0000, 4.5000, -2.0000]</span>
</pre></div>
</div>
<p>If you want a separate copy do not give the <code class="docutils literal notranslate"><span class="pre">copy=False</span></code> option.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">numpy</span><span class="p">();</span> <span class="n">z</span>
<span class="go">array([20. , -3. ,  4.5, -2. ])</span>
<span class="gp">sage: </span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[20.0000, -3.0000, 4.5000, -2.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">plot_points</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">points</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a plot of this time series as a line or points through
<span class="math notranslate nohighlight">\((i,T(i))\)</span>, where <span class="math notranslate nohighlight">\(i\)</span> ranges over nonnegative integers up to the
length of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">plot_points</span></code> – (default: 1000) 0 or positive integer. Only
plot the given number of equally spaced points in the time series.
If 0, plot all points.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">points</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return just
the points of the time series.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**kwds</span></code> – passed to the line or point command.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="o">+</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">rgbcolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">pointsize</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.plot_candlestick">
<code class="sig-name descname">plot_candlestick</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">30</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.plot_candlestick" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a candlestick plot of this time series with the given number
of bins.</p>
<p>A candlestick plot is a style of bar-chart used to view open, high,
low, and close stock data. At each bin, the line represents the
high / low range. The bar represents the open / close range. The
interval is colored blue if the open for that bin is less than the
close. If the close is less than the open, then that bin is colored
red instead.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code> – positive integer (default: 30), the number of bins
or candles.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A candlestick plot.</p>
<p>EXAMPLES:</p>
<p>Here we look at the candlestick plot for Brownian motion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot_candlestick</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">Graphics object consisting of 40 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.plot_histogram">
<code class="sig-name descname">plot_histogram</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bins</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.plot_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Return histogram plot of this time series with given number of bins.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bins</span></code> – positive integer (default: 50)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">normalize</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) whether to normalize so the
total area in the bars of the histogram is 1.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A histogram plot.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Graphics object consisting of 10 graphics primitives</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">plot_histogram</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">normalize</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">aspect_ratio</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Graphics object consisting of 3 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.pow">
<code class="sig-name descname">pow</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.pow" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new time series with every elements of <code class="docutils literal notranslate"><span class="pre">self</span></code> raised to the
k-th power.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a float.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1.0000, 1.0000, 1.0000, 4.0000, 9.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.prod">
<code class="sig-name descname">prod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.prod" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of all the entries of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  If <code class="docutils literal notranslate"><span class="pre">self</span></code> has
length 0, returns 1.</p>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">prod</span><span class="p">()</span>
<span class="go">6.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.randomize">
<code class="sig-name descname">randomize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distribution</span><span class="o">=</span><span class="default_value">'uniform'</span></em>, <em class="sig-param"><span class="n">loc</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">scale</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomize the entries in this time series, and return a reference
to <code class="docutils literal notranslate"><span class="pre">self</span></code>.  Thus this function both changes <code class="docutils literal notranslate"><span class="pre">self</span></code> in place, and
returns a copy of <code class="docutils literal notranslate"><span class="pre">self</span></code>, for convenience.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">distribution</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">&quot;uniform&quot;</span></code>); supported values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'uniform'</span></code> – from <code class="docutils literal notranslate"><span class="pre">loc</span></code> to <code class="docutils literal notranslate"><span class="pre">loc</span> <span class="pre">+</span> <span class="pre">scale</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'normal'</span></code> – mean <code class="docutils literal notranslate"><span class="pre">loc</span></code> and standard deviation <code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'semicircle'</span></code> – with center at <code class="docutils literal notranslate"><span class="pre">loc</span></code> (<code class="docutils literal notranslate"><span class="pre">scale</span></code> is ignored)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'lognormal'</span></code> – mean <code class="docutils literal notranslate"><span class="pre">loc</span></code> and standard deviation <code class="docutils literal notranslate"><span class="pre">scale</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code> – float (default: 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code> – float (default: 1)</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All random numbers are generated using algorithms that
build on the high quality GMP random number function
gmp_urandomb_ui.  Thus this function fully respects the Sage
<code class="docutils literal notranslate"><span class="pre">set_random_state</span></code> command.  It’s not quite as fast as the C
library random number generator, but is of course much better
quality, and is platform independent.</p>
</div>
<p>EXAMPLES:</p>
<p>We generate 5 uniform random numbers in the interval [0,1]:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="go">[0.8685, 0.2816, 0.0229, 0.1456, 0.7314]</span>
</pre></div>
</div>
<p>We generate 5 uniform random numbers from 5 to <span class="math notranslate nohighlight">\(5+2=7\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[6.7369, 5.5632, 5.0459, 5.2911, 6.4628, 5.2412, 5.2010, 5.2761, 5.5813, 5.5439]</span>
</pre></div>
</div>
<p>We generate 5 normal random values with mean 0 and variance 1.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="go">[0.6767, -0.4011, 0.3576, -0.5864, -0.9365]</span>
</pre></div>
</div>
<p>We generate 10 normal random values with mean 5 and variance 2.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[6.3534, 4.1978, 5.7153, 3.8273, 3.1269, 2.9598, 3.7484, 6.7472, 3.8986, 4.6271]</span>
</pre></div>
</div>
<p>We generate 5 values using the semicircle distribution.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;semicircle&#39;</span><span class="p">)</span>
<span class="go">[0.7369, -0.9541, 0.4628, -0.7990, -0.4187]</span>
</pre></div>
</div>
<p>We generate 1 million normal random values and create a frequency
histogram.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">[36, 1148, 19604, 130699, 340054, 347870, 137953, 21290, 1311, 35]</span>
</pre></div>
</div>
<p>We take the above values, and compute the proportion that lie within
1, 2, 3, 5, and 6 standard deviations of the mean (0):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">0.683094</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">0.954559</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">0.997228</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="mi">5</span><span class="o">*</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">0.999998</span>
</pre></div>
</div>
<p>There were no “six sigma events”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">clip_remove</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="mi">6</span><span class="o">*</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.range_statistic">
<code class="sig-name descname">range_statistic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">b</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.range_statistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rescaled range statistic <span class="math notranslate nohighlight">\(R/S\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is
defined as follows (see Hurst 1951).  If the optional
parameter <code class="docutils literal notranslate"><span class="pre">b</span></code> is given, return the average of <span class="math notranslate nohighlight">\(R/S\)</span> range
statistics of disjoint blocks of size <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(\sigma\)</span> be the standard deviation of the sequence of
differences of <code class="docutils literal notranslate"><span class="pre">self</span></code>, and let <span class="math notranslate nohighlight">\(Y_k\)</span> be the k-th term of <code class="docutils literal notranslate"><span class="pre">self</span></code>.
Let <span class="math notranslate nohighlight">\(n\)</span> be the number of terms of <code class="docutils literal notranslate"><span class="pre">self</span></code>, and set
<span class="math notranslate nohighlight">\(Z_k = Y_k - ((k+1)/n) \cdot Y_n\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[R/S = \big( \max(Z_k) - \min(Z_k) \big) / \sigma\]</div>
<p>where the max and min are over all <span class="math notranslate nohighlight">\(Z_k\)</span>.
Basically replacing <span class="math notranslate nohighlight">\(Y_k\)</span> by <span class="math notranslate nohighlight">\(Z_k\)</span> allows us to measure
the difference from the line from the origin to <span class="math notranslate nohighlight">\((n,Y_n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> – a time series  (<em>not</em> the series of differences).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if given instead divide the
input time series up into <code class="docutils literal notranslate"><span class="pre">j</span> <span class="pre">=</span> <span class="pre">floor(n/b)</span></code> disjoint
blocks, compute the <span class="math notranslate nohighlight">\(R/S\)</span> statistic for each block,
and return the average of those <span class="math notranslate nohighlight">\(R/S\)</span> statistics.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A float.</p>
<p>EXAMPLES:</p>
<p>Notice that if we make a Brownian motion random walk, there
is no difference if we change the standard deviation.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span><span class="o">.</span><span class="n">range_statistic</span><span class="p">()</span>
<span class="go">1897.8392602...</span>
<span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="mi">10</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="s1">&#39;normal&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span><span class="o">.</span><span class="n">range_statistic</span><span class="p">()</span>
<span class="go">1897.8392602...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.rescale">
<code class="sig-name descname">rescale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.rescale" title="Permalink to this definition">¶</a></dt>
<dd><p>Change <code class="docutils literal notranslate"><span class="pre">self</span></code> by multiplying every value in the series by <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – a float.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">rescale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">[2.5000, 2.0000, 0.6500, 1.0000, 4.0000, 5.0000, 1.5000, -2.5000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.reversed">
<code class="sig-name descname">reversed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.reversed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series obtain from this time series by
reversing the order of the entries in this time series.</p>
<p>OUTPUT:</p>
<p>A time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">reversed</span><span class="p">()</span>
<span class="go">[5.0000, 4.0000, 3.0000, 2.0000, 1.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new time series obtained by multiplying every value in the
series by <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – a float.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new time series with all values multiplied by <code class="docutils literal notranslate"><span class="pre">s</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[2.5000, 2.0000, 0.6500, 1.0000, 4.0000, 5.0000, 1.5000, -2.5000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.scale_time">
<code class="sig-name descname">scale_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.scale_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new time series at scale <code class="docutils literal notranslate"><span class="pre">k</span></code>.  If the input
time series is <span class="math notranslate nohighlight">\(X_0, X_1, X_2, \dots\)</span>, then this function
returns the shorter time series <span class="math notranslate nohighlight">\(X_0, X_k, X_{2k}, \dots\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – a positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[5.0000, 4.0000, 1.3000, 2.0000, 8.0000, 10.0000, 3.0000, -5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[5.0000, 1.3000, 8.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[5.0000, 2.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>A series of odd length:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">5</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 2.0000, 3.0000, 4.0000, 5.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">scale_time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1.0000, 3.0000, 5.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls plot and passes all arguments onto the plot function.  This is
thus just an alias for plot.</p>
<p>EXAMPLES:</p>
<p>Draw a plot of a time series:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.simple_moving_average">
<code class="sig-name descname">simple_moving_average</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.simple_moving_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the moving average time series over the last <code class="docutils literal notranslate"><span class="pre">k</span></code> time units.
Assumes the input time series was constant with its starting value
for negative time.  The t-th step of the output is the sum of
the previous <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">-</span> <span class="pre">1</span></code> steps of <code class="docutils literal notranslate"><span class="pre">self</span></code> and the <code class="docutils literal notranslate"><span class="pre">k</span></code>-th step
divided by <code class="docutils literal notranslate"><span class="pre">k</span></code>. Thus <code class="docutils literal notranslate"><span class="pre">k</span></code> values are averaged at each point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – positive integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series with the same number of steps as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">simple_moving_average</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">simple_moving_average</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">simple_moving_average</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1.0000, 1.0000, 1.0000, 1.5000, 2.5000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">simple_moving_average</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1.0000, 1.0000, 1.0000, 1.3333, 2.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.standard_deviation">
<code class="sig-name descname">standard_deviation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the standard deviation of the entries of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bias</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, divide by
<code class="docutils literal notranslate"><span class="pre">self.length()</span> <span class="pre">-</span> <span class="pre">1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.length()</span></code> to give a less
biased estimator for the variance.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">()</span>
<span class="go">0.8944271909...</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0.8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.sum">
<code class="sig-name descname">sum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum of all the entries of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  If <code class="docutils literal notranslate"><span class="pre">self</span></code> has
length 0, returns 0.</p>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="go">8.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.sums">
<code class="sig-name descname">sums</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.sums" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the new time series got by taking the running partial
sums of the terms of this time series.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – starting value for partial sums.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A time series.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span>
<span class="go">[1.0000, 2.0000, 3.0000, 5.0000, 8.0000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.variance">
<code class="sig-name descname">variance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the variance of the elements of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which is the mean
of the squares of the differences from the mean.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bias</span></code> – bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, divide by
<code class="docutils literal notranslate"><span class="pre">self.length()</span> <span class="pre">-</span> <span class="pre">1</span></code> instead of <code class="docutils literal notranslate"><span class="pre">self.length()</span></code> to give a less
biased estimator for the variance.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A double.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span>
<span class="go">[1.0000, 1.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">variance</span><span class="p">()</span>
<span class="go">0.8</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0.64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.finance.time_series.TimeSeries.vector">
<code class="sig-name descname">vector</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.TimeSeries.vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return real double vector whose entries are the values of this
time series.  This is useful since vectors have standard
algebraic structure and play well with matrices.</p>
<p>OUTPUT:</p>
<p>A real double vector.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mf">1.</span><span class="o">.</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">vector</span><span class="p">()</span>
<span class="go">(1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0, 10.0)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sage.finance.time_series.autoregressive_fit">
<code class="sig-prename descclassname">sage.finance.time_series.</code><code class="sig-name descname">autoregressive_fit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">acvs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.autoregressive_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a sequence of lagged autocovariances of length <span class="math notranslate nohighlight">\(M\)</span> produce
<span class="math notranslate nohighlight">\(a_1,\dots,a_p\)</span> so that the first <span class="math notranslate nohighlight">\(M\)</span> autocovariance coefficients
of the autoregressive processes <span class="math notranslate nohighlight">\(X_t=a_1X_{t_1}+\cdots+a_pX_{t-p}+Z_t\)</span>
are the same as the input sequence.</p>
<p>The function works by solving the Yule-Walker equations
<span class="math notranslate nohighlight">\(\Gamma a =\gamma\)</span>, where <span class="math notranslate nohighlight">\(\gamma=(\gamma(1),\dots,\gamma(M))\)</span>,
<span class="math notranslate nohighlight">\(a=(a_1,\dots,a_M)\)</span>, with <span class="math notranslate nohighlight">\(\gamma(i)\)</span> the autocovariance of lag <span class="math notranslate nohighlight">\(i\)</span>
and <span class="math notranslate nohighlight">\(\Gamma_{ij}=\gamma(i-j)\)</span>.</p>
<p>EXAMPLES:</p>
<p>In this example we consider the multifractal cascade random walk
of length 1000, and use simulations to estimate the
expected first few autocovariance parameters for this model, then
use them to construct a linear filter that works vastly better
than a linear filter constructed from the same data but not using
this model. The Monte-Carlo method illustrated below should work for
predicting one “time step” into the future for any
model that can be simulated.  To predict k time steps into the
future would require using a similar technique but would require
scaling time by k.</p>
<p>We create 100 simulations of a multifractal random walk.  This
models the logarithms of a stock price sequence.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">multifractal_cascade_random_walk_simulation</span><span class="p">(</span><span class="mi">3700</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>For each walk below we replace the walk by the walk but where each
step size is replaced by its absolute value – this is what we
expect to be able to predict given the model, which is only a
model for predicting volatility.  We compute the first 200
autocovariance values for every random walk:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="p">[[</span><span class="n">a</span><span class="o">.</span><span class="n">diffs</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span><span class="o">.</span><span class="n">autocovariance</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">)]</span>
</pre></div>
</div>
<p>We make a time series out of the expected values of the
autocovariances:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ac</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">c</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ac</span>
<span class="go">[3.9962, 3.9842, 3.9722, 3.9601, 3.9481 ... 1.7144, 1.7033, 1.6922, 1.6812, 1.6701]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">ac</span></code> looks like a line – one could best fit it to yield a lot
more approximate autocovariances.</p>
</div>
<p>We compute the autoregression coefficients matching the above
autocovariances:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="n">ac</span><span class="p">);</span> <span class="n">F</span>
<span class="go">[0.9982, -0.0002, -0.0002, 0.0003, 0.0001 ... 0.0002, -0.0002, -0.0000, -0.0002, -0.0014]</span>
</pre></div>
</div>
<p>Note that the sum is close to 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">0.99593284089454...</span>
</pre></div>
</div>
<p>Now we make up an ‘out of sample’ sequence:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y2</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">multifractal_cascade_random_walk_simulation</span><span class="p">(</span><span class="mi">3700</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">diffs</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">sums</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y2</span>
<span class="go">[0.0013, 0.0059, 0.0066, 0.0068, 0.0184 ... 6.8004, 6.8009, 6.8063, 6.8090, 6.8339]</span>
</pre></div>
</div>
<p>And we forecast the very last value using our linear filter; the forecast
is close:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">6.7836741372407...</span>
</pre></div>
</div>
<p>In fact it is closer than we would get by forecasting using a
linear filter made from all the autocovariances of our sequence:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y2</span><span class="p">)))</span>
<span class="go">6.770168705668...</span>
</pre></div>
</div>
<p>We record the last 20 forecasts, always using all correct values up to the
one we are forecasting:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">-</span><span class="n">y2</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
</pre></div>
</div>
<p>We do the same, but using the autocovariances of the sample sequence:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="mi">100</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">s2</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">y2</span><span class="p">[:</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span><span class="o">-</span><span class="n">y2</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
</pre></div>
</div>
<p>Our model gives us something that is 15 percent better in this case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s2</span><span class="o">/</span><span class="n">s1</span>
<span class="go">1.15464636102...</span>
</pre></div>
</div>
<p>How does it compare overall?  To find out we do 100 simulations
and for each we compute the percent that our model beats naively
using the autocovariances of the sample:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y_out</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">multifractal_cascade_random_walk_simulation</span><span class="p">(</span><span class="mi">3700</span><span class="p">,</span><span class="mf">0.02</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s1</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">s2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y_out</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">s1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">([(</span><span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F</span><span class="p">)</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)]))</span>
<span class="gp">....: </span>    <span class="n">F2</span> <span class="o">=</span> <span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">)]</span><span class="o">.</span><span class="n">autoregressive_fit</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
<span class="gp">....: </span>    <span class="n">s2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">sum</span><span class="p">([(</span><span class="n">v</span><span class="p">[:</span><span class="o">-</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">autoregressive_forecast</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">^</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">20</span><span class="p">)]))</span>
</pre></div>
</div>
<p>We find that overall the model beats naive linear forecasting by 35
percent!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="n">s2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">s1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="go">1.354073591877...</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.finance.time_series.unpickle_time_series_v1">
<code class="sig-prename descclassname">sage.finance.time_series.</code><code class="sig-name descname">unpickle_time_series_v1</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.finance.time_series.unpickle_time_series_v1" title="Permalink to this definition">¶</a></dt>
<dd><p>Version 1 unpickle method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – a raw char buffer</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">finance</span><span class="o">.</span><span class="n">TimeSeries</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">__reduce__</span><span class="p">()[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># py2</span>
<span class="go">&lt;type &#39;str&#39;&gt;</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>  <span class="c1"># py3</span>
<span class="go">&lt;type &#39;bytes&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">finance</span><span class="o">.</span><span class="n">time_series</span><span class="o">.</span><span class="n">unpickle_time_series_v1</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">finance</span><span class="o">.</span><span class="n">time_series</span><span class="o">.</span><span class="n">unpickle_time_series_v1</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="n">s</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1.0000, 2.0000, 3.0000, 1.0000, 2.0000, 3.0000]</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">finance</span><span class="o">.</span><span class="n">time_series</span><span class="o">.</span><span class="n">unpickle_time_series_v1</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../index.html"
                        title="previous chapter">Quantitative Finance</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="stock.html"
                        title="next chapter">Stock Market Price Series</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/finance/time_series.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stock.html" title="Stock Market Price Series"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quantitative Finance"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.3 Reference Manual: Quantitative Finance</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Time Series</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>