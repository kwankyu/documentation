
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>Solving ordinary differential equations &#8212; Sage 9.3 Reference Manual: Symbolic Calculus</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Discrete Wavelet Transform" href="transforms/dwt.html" />
    <link rel="prev" title="Further examples from Wester’s paper" href="wester.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transforms/dwt.html" title="Discrete Wavelet Transform"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="wester.html" title="Further examples from Wester’s paper"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.3 Reference Manual: Symbolic Calculus</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Solving ordinary differential equations</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="solving-ordinary-differential-equations">
<span id="sage-calculus-desolvers"></span><h1>Solving ordinary differential equations<a class="headerlink" href="#solving-ordinary-differential-equations" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.calculus.desolvers"></span><p>This file contains functions useful for solving differential equations
which occur commonly in a 1st semester differential equations
course. For another numerical solver see the <a class="reference internal" href="ode.html#sage.calculus.ode.ode_solver" title="sage.calculus.ode.ode_solver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ode_solver()</span></code></a> function
and the optional package Octave.</p>
<p>Solutions from the Maxima package can contain the three constants
<code class="docutils literal notranslate"><span class="pre">_C</span></code>, <code class="docutils literal notranslate"><span class="pre">_K1</span></code>, and <code class="docutils literal notranslate"><span class="pre">_K2</span></code> where the underscore is used to distinguish
them from symbolic variables that the user might have used. You can
substitute values for them, and make them into accessible usable
symbolic variables, for example with <code class="docutils literal notranslate"><span class="pre">var(&quot;_C&quot;)</span></code>.</p>
<p>Commands:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve" title="sage.calculus.desolvers.desolve"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve()</span></code></a> - Compute the “general solution” to a 1st or 2nd order
ODE via Maxima.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_laplace" title="sage.calculus.desolvers.desolve_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_laplace()</span></code></a> - Solve an ODE using Laplace transforms via
Maxima. Initial conditions are optional.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_rk4" title="sage.calculus.desolvers.desolve_rk4"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_rk4()</span></code></a> - Solve numerically an IVP for one first order
equation, return list of points or plot.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_system_rk4" title="sage.calculus.desolvers.desolve_system_rk4"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_system_rk4()</span></code></a> - Solve numerically an IVP for a system of first
order equations, return list of points.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_odeint" title="sage.calculus.desolvers.desolve_odeint"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_odeint()</span></code></a> - Solve numerically a system of first-order ordinary
differential equations using <code class="docutils literal notranslate"><span class="pre">odeint</span></code> from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate">scipy.integrate module.</a></p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_system" title="sage.calculus.desolvers.desolve_system"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_system()</span></code></a> - Solve a system of 1st order ODEs of any size using
Maxima. Initial conditions are optional.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.eulers_method" title="sage.calculus.desolvers.eulers_method"><code class="xref py py-func docutils literal notranslate"><span class="pre">eulers_method()</span></code></a> - Approximate solution to a 1st order DE,
presented as a table.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.eulers_method_2x2" title="sage.calculus.desolvers.eulers_method_2x2"><code class="xref py py-func docutils literal notranslate"><span class="pre">eulers_method_2x2()</span></code></a> - Approximate solution to a 1st order system
of DEs, presented as a table.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.eulers_method_2x2_plot" title="sage.calculus.desolvers.eulers_method_2x2_plot"><code class="xref py py-func docutils literal notranslate"><span class="pre">eulers_method_2x2_plot()</span></code></a> - Plot the sequence of points obtained
from Euler’s method.</p></li>
</ul>
<p>The following functions require the optional package <code class="docutils literal notranslate"><span class="pre">tides</span></code>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_mintides" title="sage.calculus.desolvers.desolve_mintides"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_mintides()</span></code></a> - Numerical solution of a system of 1st order ODEs via
the Taylor series integrator method implemented in TIDES.</p></li>
<li><p><a class="reference internal" href="#sage.calculus.desolvers.desolve_tides_mpfr" title="sage.calculus.desolvers.desolve_tides_mpfr"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_tides_mpfr()</span></code></a> - Arbitrary precision Taylor series integrator implemented in TIDES.</p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Joyner (3-2006) - Initial version of functions</p></li>
<li><p>Marshall Hampton (7-2007) - Creation of Python module and testing</p></li>
<li><p>Robert Bradshaw (10-2008) - Some interface cleanup.</p></li>
<li><p>Robert Marik (10-2009) - Some bugfixes and enhancements</p></li>
<li><p>Miguel Marco (06-2014) - Tides desolvers</p></li>
</ul>
<dl class="py function">
<dt id="sage.calculus.desolvers.desolve">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">de</span></em>, <em class="sig-param"><span class="n">dvar</span></em>, <em class="sig-param"><span class="n">ics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">show_method</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">contrib_ode</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'maxima'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a 1st or 2nd order linear ODE, including IVP and BVP.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">de</span></code> – an expression or equation representing the ODE</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dvar</span></code> – the dependent variable (hereafter called <span class="math notranslate nohighlight">\(y\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> – (optional) the initial or boundary conditions</p>
<ul>
<li><p>for a first-order equation, specify the initial <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span></p></li>
<li><p>for a second-order equation, specify the initial <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>,
and <span class="math notranslate nohighlight">\(dy/dx\)</span>, i.e. write <span class="math notranslate nohighlight">\([x_0, y(x_0), y'(x_0)]\)</span></p></li>
<li><p>for a second-order boundary solution, specify initial and
final <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> boundary conditions, i.e. write <span class="math notranslate nohighlight">\([x_0, y(x_0), x_1, y(x_1)]\)</span>.</p></li>
<li><p>gives an error if the solution is not SymbolicEquation (as happens for
example for a Clairaut equation)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> – (optional) the independent variable (hereafter called
<span class="math notranslate nohighlight">\(x\)</span>), which must be specified if there is more than one
independent variable in the equation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">show_method</span></code> – (optional) if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then Sage returns pair
<code class="docutils literal notranslate"><span class="pre">[solution,</span> <span class="pre">method]</span></code>, where method is the string describing
the method which has been used to get a solution (Maxima uses the
following order for first order equations: linear, separable,
exact (including exact with integrating factor), homogeneous,
bernoulli, generalized homogeneous) - use carefully in class,
see below the example of an equation which is separable but
this property is not recognized by Maxima and the equation is solved
as exact.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contrib_ode</span></code> – (optional) if <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">desolve</span></code> allows to solve
Clairaut, Lagrange, Riccati and some other equations. This may take
a long time and is thus turned off by default.  Initial conditions
can be used only if the result is one SymbolicEquation (does not
contain a singular solution, for example).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>) one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use maxima</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fricas'</span></code> - use FriCAS (the optional fricas spkg has to be installed)</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>In most cases return a SymbolicEquation which defines the solution
implicitly.  If the result is in the form <span class="math notranslate nohighlight">\(y(x)=\ldots\)</span> (happens for
linear eqs.), return the right-hand side only. The possible
constant solutions of separable ODEs are omitted.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">desolve?</span> <span class="pre">&lt;tab&gt;</span></code> if the output in the Sage notebook is truncated.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(_C + e^x)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">(e^10 + e^x)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>We can also solve second-order differential equations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span> <span class="o">==</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">_K2*e^(-x) + _K1*e^x - x</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">f</span>
<span class="go">-x + 7*e^(x - 10) + 5*e^(-x + 10)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">_K2*cos(x) + _K1*sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">cos(x) + 4*sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">-1/2*y(x)^2 == _C - cos(x)</span>
</pre></div>
</div>
<p>Clairaut equation: general and singular solutions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == _C^2 + _C*x, y(x) == -1/4*x^2], &#39;clairault&#39;]</span>
</pre></div>
</div>
<p>For equations involving more variables we specify an independent variable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b c n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == 0, (b*x^(n - 2) + a/x^2)*c^2*u == 0]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[[y(x) == 0, (b*x^(n - 2) + a/x^2)*c^2*u == 0]], &#39;riccati&#39;]</span>
</pre></div>
</div>
<p>Higher order equations, not involving independent variable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">1/6*y(x)^3 + _K1*y(x) == _K2 + x</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">1/6*y(x)^3 - 5/3*y(x) == x - 3/2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/6*y(x)^3 - 5/3*y(x) == x - 3/2, &#39;freeofx&#39;]</span>
</pre></div>
</div>
<p>Separable equations - Sage returns solution in implicit form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">-cos(y(x)) == _C + sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-cos(y(x)) == _C + sin(x), &#39;separable&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-cos(y(x)) == -cos(1) + sin(x) - 1</span>
</pre></div>
</div>
<p>Linear equation - Sage returns the expression on the right hand side only:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">1/2*((cos(x) + sin(x))*e^x + 2*_C)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/2*((cos(x) + sin(x))*e^x + 2*_C)*e^(-x), &#39;linear&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1/2*(cos(x)*e^x + e^x*sin(x) + 1)*e^(-x)</span>
</pre></div>
</div>
<p>This ODE with separated variables is solved as
exact. Explanation - factor does not split <span class="math notranslate nohighlight">\(e^{x-y}\)</span> in Maxima
into <span class="math notranslate nohighlight">\(e^{x}e^{y}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[-e^x + e^y(x) == _C, &#39;exact&#39;]</span>
</pre></div>
</div>
<p>You can solve Bessel equations, also using initial
conditions, but you cannot put (sometimes desired) the initial
condition at <span class="math notranslate nohighlight">\(x=0\)</span>, since this point is a singular point of the
equation. Anyway, if the solution should be bounded at <span class="math notranslate nohighlight">\(x=0\)</span>, then
<code class="docutils literal notranslate"><span class="pre">_K2=0</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">_K1*bessel_J(2, x) + _K2*bessel_Y(2, x)</span>
</pre></div>
</div>
<p>Example of difficult ODE producing an error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="c1"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="go">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<p>Another difficult ODE with error - moreover, it takes a long time:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># not tested</span>
</pre></div>
</div>
<p>Some more types of ODEs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[y(x) == _C + log(x), y(x) == _C*e^x], &#39;factor&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">==</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">contrib_ode</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[[x == _C - arctan(sqrt(t)), y(x) == -x - sqrt(t)], [x == _C + arctan(sqrt(t)), y(x) == -x + sqrt(t)]], &#39;lagrange&#39;]</span>
</pre></div>
</div>
<p>These two examples produce an error (as expected, Maxima 5.18 cannot
solve equations from initial conditions). Maxima 5.18
returns false answer in this case!</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span> <span class="c1"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="go">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">^</span><span class="mi">3</span><span class="o">==</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># not tested</span>
<span class="go">Traceback (click to the left for traceback)</span>
<span class="go">...</span>
<span class="go">NotImplementedError, &quot;Maxima was unable to solve this ODE. Consider to set option contrib_ode to True.&quot;</span>
</pre></div>
</div>
<p>Second order linear ODE:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">)</span>
<span class="go">(_K2*x + _K1)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(_K2*x + _K1)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">1/2*(7*x + 6)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1/2*(7*x + 6)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">3*(x*(e^(1/2*pi) - 2)/pi + 1)*e^(-x) + 1/2*sin(x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[3*(x*(e^(1/2*pi) - 2)/pi + 1)*e^(-x) + 1/2*sin(x), &#39;variationofparameters&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">(_K2*x + _K1)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(_K2*x + _K1)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(4*x + 3)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(4*x + 3)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(2*x*(2*e^(1/2*pi) - 3)/pi + 3)*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">show_method</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(2*x*(2*e^(1/2*pi) - 3)/pi + 3)*e^(-x), &#39;constcoeff&#39;]</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">algorithm='fricas'</span></code> we can invoke the differential
equation solver from FriCAS.  For example, it can solve higher
order linear equations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">);</span> <span class="n">Y</span>               <span class="c1"># optional - fricas</span>
<span class="go">(2*x^3 - 3*x^2 + 1)*_C0/x + (x^3 - 1)*_C1/x</span>
<span class="go"> + (x^3 - 3*x^2 - 1)*_C2/x + 1/15*(x^5 - 10*x^3 + 20*x^2 + 4)/x</span>
</pre></div>
</div>
<p>The initial conditions are then interpreted as <span class="math notranslate nohighlight">\([x_0, y(x_0),
y'(x_0), \ldots, y^(n)(x_0)]\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">);</span> <span class="n">Y</span>  <span class="c1"># optional - fricas</span>
<span class="go">1/15*(x^5 + 15*x^3 + 50*x^2 - 21)/x</span>
</pre></div>
</div>
<p>FriCAS can also solve some non-linear equations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">desolve</span><span class="p">(</span><span class="n">de</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">);</span> <span class="n">Y</span>               <span class="c1"># optional - fricas</span>
<span class="go">1/2*(log(y(x))^2*y(x) - 2*x)/y(x)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Joyner (1-2006)</p></li>
<li><p>Robert Bradshaw (10-2008)</p></li>
<li><p>Robert Marik (10-2009)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_laplace">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_laplace</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">de</span></em>, <em class="sig-param"><span class="n">dvar</span></em>, <em class="sig-param"><span class="n">ics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an ODE using Laplace transforms. Initial conditions are optional.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">de</span></code> - a lambda expression representing the ODE (e.g. <code class="docutils literal notranslate"><span class="pre">de</span> <span class="pre">=</span>
<span class="pre">diff(y,x,2)</span> <span class="pre">==</span> <span class="pre">diff(y,x)+sin(x)</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dvar</span></code> - the dependent variable (e.g. <code class="docutils literal notranslate"><span class="pre">y</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> - (optional) the independent variable (hereafter called
<span class="math notranslate nohighlight">\(x\)</span>), which must be specified if there is more than one
independent variable in the equation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> - a list of numbers representing initial conditions, (e.g.
<code class="docutils literal notranslate"><span class="pre">f(0)=1</span></code>, <code class="docutils literal notranslate"><span class="pre">f'(0)=2</span></code> corresponds to <code class="docutils literal notranslate"><span class="pre">ics</span> <span class="pre">=</span> <span class="pre">[0,1,2]</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>Solution of the ODE as symbolic expression</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="go">1/2*(2*u(0) + 1)*e^x - 1/2*e^(-x)</span>
</pre></div>
</div>
<p>We can use initial conditions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">-1/2*e^(-x) + 7/2*e^x</span>
</pre></div>
</div>
<p>The initial conditions do not persist in the system (as they persisted
in previous versions):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
<span class="go">1/2*(2*u(0) + 1)*e^x - 1/2*e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eq</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">f</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">e^(-x)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">f</span>
<span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">de</span><span class="p">,</span><span class="n">f</span><span class="p">)</span>
<span class="go">-x*e^x*f(0) + x*e^x*D[0](f)(0) + e^x*f(0)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_laplace</span><span class="p">(</span><span class="n">de</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">x*e^x + e^x</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Joyner (1-2006,8-2007)</p></li>
<li><p>Robert Marik (10-2009)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_mintides">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_mintides</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">initial</span></em>, <em class="sig-param"><span class="n">final</span></em>, <em class="sig-param"><span class="n">delta</span></em>, <em class="sig-param"><span class="n">tolrel</span><span class="o">=</span><span class="default_value">1e-16</span></em>, <em class="sig-param"><span class="n">tolabs</span><span class="o">=</span><span class="default_value">1e-16</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_mintides" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first order differential equations using the
taylor series integrator implemented in mintides.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – symbolic function. Its first argument will be the independent
variable. Its output should be de derivatives of the dependent variables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> – a list or tuple with the initial conditions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial</span></code> – the starting value for the independent variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">final</span></code> – the final value for the independent value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – the size of the steps in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolrel</span></code> – the relative tolerance for the method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolabs</span></code> – the absolute tolerance for the method.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list  with the positions of the IVP.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We integrate a periodic orbit of the Kepler problem along 50 periods:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t,x,y,X,Y&#39;</span><span class="p">)</span>
<span class="go">(t, x, y, X, Y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="o">-</span><span class="n">y</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">ics</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.22474487139159</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">pi</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_mintides</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ics</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">,</span> <span class="mf">1e-12</span><span class="p">)</span> <span class="c1"># optional -tides</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="c1"># optional -tides # abs tol 1e-5</span>
<span class="go">[[0.000000000000000,</span>
<span class="go">0.800000000000000,</span>
<span class="go">0.000000000000000,</span>
<span class="go">0.000000000000000,</span>
<span class="go">1.22474487139159],</span>
<span class="go">[314.159265358979,</span>
<span class="go">0.800000000028622,</span>
<span class="go">-5.91973525754241e-9,</span>
<span class="go">7.56887091890590e-9,</span>
<span class="go">1.22474487136329]]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses TIDES.</p>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>A. Abad, R. Barrio, F. Blesa, M. Rodriguez. Algorithm 924. <em>ACM
Transactions on Mathematical Software</em> , <em>39</em> (1), 1-28.</p></li>
<li><p>A. Abad, R. Barrio, F. Blesa, M. Rodriguez.
<a class="reference external" href="http://www.unizar.es/acz/05Publicaciones/Monografias/MonografiasPublicadas/Monografia36/IndMonogr36.htm">TIDES tutorial: Integrating ODEs by using the Taylor Series Method.</a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_odeint">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_odeint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">des</span></em>, <em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">times</span></em>, <em class="sig-param"><span class="n">dvars</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">compute_jac</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">args</span><span class="o">=</span><span class="default_value">()</span></em>, <em class="sig-param"><span class="n">rtol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">atol</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tcrit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h0</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">hmax</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">hmin</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">ixpr</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">mxstep</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">mxhnil</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">mxordn</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">mxords</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">printmessg</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_odeint" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first-order ordinary differential equations
using <code class="docutils literal notranslate"><span class="pre">odeint</span></code> from scipy.integrate module.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">des</span></code>  – right hand sides of the system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code>  – initial conditions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">times</span></code> – a sequence of time points in which the solution must be found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dvars</span></code> – dependent variables. ATTENTION: the order must be the same as
in <code class="docutils literal notranslate"><span class="pre">des</span></code>, that means: <code class="docutils literal notranslate"><span class="pre">d(dvars[i])/dt=des[i]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> – independent variable, optional.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">compute_jac</span></code> – boolean. If True, the Jacobian of des is computed and
used during the integration of Stiff Systems. Default value is False.</p></li>
</ul>
<p>Other Parameters (taken from the documentation of odeint function from <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/integrate.html#module-scipy.integrate">scipy.integrate module.</a>)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">rtol</span></code>, <code class="docutils literal notranslate"><span class="pre">atol</span></code> : float
The input parameters <code class="docutils literal notranslate"><span class="pre">rtol</span></code> and <code class="docutils literal notranslate"><span class="pre">atol</span></code> determine the error
control performed by the solver.  The solver will control the
vector, <span class="math notranslate nohighlight">\(e\)</span>, of estimated local errors in <span class="math notranslate nohighlight">\(y\)</span>, according to an
inequality of the form:</p>
<blockquote>
<div><p>max-norm of (e / ewt) &lt;= 1</p>
</div></blockquote>
<p>where ewt is a vector of positive error weights computed as:</p>
<blockquote>
<div><p>ewt = rtol * abs(y) + atol</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">rtol</span></code> and <code class="docutils literal notranslate"><span class="pre">atol</span></code> can be either vectors the same length as <span class="math notranslate nohighlight">\(y\)</span> or scalars.</p>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tcrit</span></code> : array
Vector of critical points (e.g. singularities) where integration
care should be taken.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h0</span></code> : float, (0: solver-determined)
The step size to be attempted on the first step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hmax</span></code> : float, (0: solver-determined)
The maximum absolute step size allowed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hmin</span></code> : float, (0: solver-determined)
The minimum absolute step size allowed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ixpr</span></code> : boolean.
Whether to generate extra printing at method switches.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mxstep</span></code> : integer, (0: solver-determined)
Maximum number of (internally defined) steps allowed for each
integration point in t.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mxhnil</span></code> : integer, (0: solver-determined)
Maximum number of messages printed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mxordn</span></code> : integer, (0: solver-determined)
Maximum order to be allowed for the nonstiff (Adams) method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mxords</span></code> : integer, (0: solver-determined)
Maximum order to be allowed for the stiff (BDF) method.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Return a list with the solution of the system at each time in <code class="docutils literal notranslate"><span class="pre">times</span></code>.</p>
<p>EXAMPLES:</p>
<p>Lotka Volterra Equations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_odeint</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">line</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">sol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Lorenz Equations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="c1"># Next we define the parameters</span>
<span class="gp">sage: </span><span class="n">sigma</span><span class="o">=</span><span class="mi">10</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">=</span><span class="mi">28</span>
<span class="gp">sage: </span><span class="n">beta</span><span class="o">=</span><span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="c1"># The Lorenz equations</span>
<span class="gp">sage: </span><span class="n">lorenz</span><span class="o">=</span><span class="p">[</span><span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">z</span><span class="p">]</span>
<span class="gp">sage: </span><span class="c1"># Time and initial conditions</span>
<span class="gp">sage: </span><span class="n">times</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">50.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">lorenz</span><span class="p">,</span><span class="n">ics</span><span class="p">,</span><span class="n">times</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">],</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-14</span><span class="p">)</span>
</pre></div>
</div>
<p>One-dimensional Stiff system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">epsilon</span><span class="o">=</span><span class="mf">0.01</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ic</span><span class="o">=</span><span class="n">epsilon</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="n">epsilon</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">,</span><span class="n">compute_jac</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="n">points</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">sol</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Another Stiff system with some optional parameters with no
default value:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;y1,y2,y3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f1</span><span class="o">=</span><span class="mf">77.27</span><span class="o">*</span><span class="p">(</span><span class="n">y2</span><span class="o">+</span><span class="n">y1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mf">8.375</span><span class="o">*</span><span class="mf">1e-6</span><span class="o">*</span><span class="n">y1</span><span class="o">-</span><span class="n">y2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f2</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="mf">77.27</span><span class="o">*</span><span class="p">(</span><span class="n">y3</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">y1</span><span class="p">)</span><span class="o">*</span><span class="n">y2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f3</span><span class="o">=</span><span class="mf">0.16</span><span class="o">*</span><span class="p">(</span><span class="n">y1</span><span class="o">-</span><span class="n">y3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="p">[</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="n">f3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">ci</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.7</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">=</span><span class="n">srange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.01</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">=</span><span class="p">[</span><span class="n">y1</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">y3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">sol</span><span class="o">=</span><span class="n">desolve_odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">ci</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span><span class="n">atol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span><span class="n">h0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">hmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hmin</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span><span class="n">mxstep</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">mxords</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Oriol Castejon (05-2010)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_rk4">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_rk4</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">de</span></em>, <em class="sig-param"><span class="n">dvar</span></em>, <em class="sig-param"><span class="n">ics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_points</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">output</span><span class="o">=</span><span class="default_value">'list'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_rk4" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically one first-order ordinary differential
equation.</p>
<p>INPUT:</p>
<p>Input is similar to <code class="docutils literal notranslate"><span class="pre">desolve</span></code> command. The differential equation can be
written in a form close to the <code class="docutils literal notranslate"><span class="pre">plot_slope_field</span></code> or <code class="docutils literal notranslate"><span class="pre">desolve</span></code> command.</p>
<ul class="simple">
<li><p>Variant 1 (function in two variables)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">de</span></code> - right hand side, i.e. the function <span class="math notranslate nohighlight">\(f(x,y)\)</span> from ODE <span class="math notranslate nohighlight">\(y'=f(x,y)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dvar</span></code> - dependent variable (symbolic variable declared by var)</p></li>
</ul>
</li>
<li><p>Variant 2 (symbolic equation)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">de</span></code> - equation, including term with <code class="docutils literal notranslate"><span class="pre">diff(y,x)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dvar</span></code> - dependent variable (declared as function of independent variable)</p></li>
</ul>
</li>
<li><p>Other parameters</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> - should be specified, if there are more variables or if the equation is autonomous</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> - initial conditions in the form <code class="docutils literal notranslate"><span class="pre">[x0,y0]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end_points</span></code> - the end points of the interval</p>
<ul>
<li><p>if <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is a or [a], we integrate between <code class="docutils literal notranslate"><span class="pre">min(ics[0],a)</span></code> and <code class="docutils literal notranslate"><span class="pre">max(ics[0],a)</span></code></p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is None, we use <code class="docutils literal notranslate"><span class="pre">end_points=ics[0]+10</span></code></p></li>
<li><p>if end_points is [a,b] we integrate between <code class="docutils literal notranslate"><span class="pre">min(ics[0],</span> <span class="pre">a)</span></code> and <code class="docutils literal notranslate"><span class="pre">max(ics[0],</span> <span class="pre">b)</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> - (optional, default:0.1) the length of the step (positive number)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output</span></code> - (optional, default: <code class="docutils literal notranslate"><span class="pre">'list'</span></code>) one of <code class="docutils literal notranslate"><span class="pre">'list'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'plot'</span></code>, <code class="docutils literal notranslate"><span class="pre">'slope_field'</span></code> (graph of the solution with slope field)</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>Return a list of points, or plot produced by <code class="docutils literal notranslate"><span class="pre">list_plot</span></code>,
optionally with slope field.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ode.html#sage.calculus.ode.ode_solver" title="sage.calculus.ode.ode_solver"><code class="xref py py-func docutils literal notranslate"><span class="pre">ode_solver()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_rk4</span>
</pre></div>
</div>
<p>Variant 2 for input - more common in numerics:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">end_points</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">[[0, 1], [0.5, 1.12419127424558], [1.0, 1.461590162288825]]</span>
</pre></div>
</div>
<p>Variant 1 for input - we can pass ODE in the form used by
desolve function In this example we integrate backwards, since
<code class="docutils literal notranslate"><span class="pre">end_points</span> <span class="pre">&lt;</span> <span class="pre">ics[0]</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">step</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">end_points</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[[0.0, 8.904257108962112], [0.5, 1.909327945361535], [1, 1]]</span>
</pre></div>
</div>
<p>Here we show how to plot simple pictures. For more advanced
applications use list_plot instead. To see the resulting picture
use <code class="docutils literal notranslate"><span class="pre">show(P)</span></code> in Sage notebook.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">desolve_rk4</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="n">y</span><span class="p">,</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">.</span><span class="mi">1</span><span class="p">],</span><span class="n">ivar</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;slope_field&#39;</span><span class="p">,</span><span class="n">end_points</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>4th order Runge-Kutta method. Wrapper for command <code class="docutils literal notranslate"><span class="pre">rk</span></code> in
Maxima’s dynamics package.  Perhaps could be faster by using
fast_float instead.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Marik (10-2009)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_rk4_determine_bounds">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_rk4_determine_bounds</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">end_points</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_rk4_determine_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to determine bounds for numerical integration.</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is None, the interval for integration is from <code class="docutils literal notranslate"><span class="pre">ics[0]</span></code>
to <code class="docutils literal notranslate"><span class="pre">ics[0]+10</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is <code class="docutils literal notranslate"><span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">[a]</span></code>, the interval for integration is from <code class="docutils literal notranslate"><span class="pre">min(ics[0],a)</span></code>
to <code class="docutils literal notranslate"><span class="pre">max(ics[0],a)</span></code></p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is <code class="docutils literal notranslate"><span class="pre">[a,b]</span></code>, the interval for integration is from <code class="docutils literal notranslate"><span class="pre">min(ics[0],a)</span></code>
to <code class="docutils literal notranslate"><span class="pre">max(ics[0],b)</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_rk4_determine_bounds</span>
<span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(0, 1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(0, 10)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="go">(-2, 0)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_rk4_determine_bounds</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="go">(-2, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_system">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_system</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">des</span></em>, <em class="sig-param"><span class="n">vars</span></em>, <em class="sig-param"><span class="n">ics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'maxima'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a system of any size of 1st order ODEs. Initial conditions
are optional.</p>
<p>One dimensional systems are passed to <a class="reference internal" href="#sage.calculus.desolvers.desolve_laplace" title="sage.calculus.desolvers.desolve_laplace"><code class="xref py py-meth docutils literal notranslate"><span class="pre">desolve_laplace()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">des</span></code> – list of ODEs</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vars</span></code> – list of dependent variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> – (optional) list of initial values for <code class="docutils literal notranslate"><span class="pre">ivar</span></code> and <code class="docutils literal notranslate"><span class="pre">vars</span></code>;
if <code class="docutils literal notranslate"><span class="pre">ics</span></code> is defined, it should provide initial conditions for each
variable, otherwise an exception would be raised</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> – (optional) the independent variable, which must be
specified if there is more than one independent variable in the
equation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>) one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use maxima</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fricas'</span></code> - use FriCAS (the optional fricas spkg has to be installed)</p></li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="go">[x(t) == (x(0) - 1)*cos(t) - (y(0) - 1)*sin(t) + 1,</span>
<span class="go"> y(t) == (y(0) - 1)*cos(t) + (x(0) - 1)*sin(t) + 1]</span>
</pre></div>
</div>
<p>The same system solved using FriCAS:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>  <span class="c1"># optional - fricas</span>
<span class="go">[x(t) == _C0*cos(t) + cos(t)^2 + _C1*sin(t) + sin(t)^2,</span>
<span class="go"> y(t) == -_C1*cos(t) + _C0*sin(t) + 1]</span>
</pre></div>
</div>
<p>Now we give some initial conditions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">sol</span>
<span class="go">[x(t) == -sin(t) + 1, y(t) == cos(t) + 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">solnx</span><span class="p">,</span> <span class="n">solny</span> <span class="o">=</span> <span class="n">sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">(),</span> <span class="n">sol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">plot</span><span class="p">([</span><span class="n">solnx</span><span class="p">,</span><span class="n">solny</span><span class="p">],(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># not tested</span>
<span class="gp">sage: </span><span class="n">parametric_plot</span><span class="p">((</span><span class="n">solnx</span><span class="p">,</span><span class="n">solny</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># not tested</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Bradshaw (10-2008)</p></li>
<li><p>Sergey Bykov (10-2014)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_system_rk4">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_system_rk4</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">des</span></em>, <em class="sig-param"><span class="n">vars</span></em>, <em class="sig-param"><span class="n">ics</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ivar</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_points</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_system_rk4" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first-order ordinary differential
equations using the 4th order Runge-Kutta method. Wrapper for
Maxima command <code class="docutils literal notranslate"><span class="pre">rk</span></code>.</p>
<p>INPUT:</p>
<p>input is similar to desolve_system and desolve_rk4 commands</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">des</span></code> - right hand sides of the system</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vars</span></code> - dependent variables</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ivar</span></code> - (optional) should be specified, if there are more variables or
if the equation is autonomous and the independent variable is
missing</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> - initial conditions in the form <code class="docutils literal notranslate"><span class="pre">[x0,y01,y02,y03,....]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end_points</span></code> - the end points of the interval</p>
<ul>
<li><p>if <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is a or [a], we integrate on between <code class="docutils literal notranslate"><span class="pre">min(ics[0],</span> <span class="pre">a)</span></code> and <code class="docutils literal notranslate"><span class="pre">max(ics[0],</span> <span class="pre">a)</span></code></p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is None, we use <code class="docutils literal notranslate"><span class="pre">end_points=ics[0]+10</span></code></p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">end_points</span></code> is [a,b] we integrate on between <code class="docutils literal notranslate"><span class="pre">min(ics[0],</span> <span class="pre">a)</span></code> and <code class="docutils literal notranslate"><span class="pre">max(ics[0],</span> <span class="pre">b)</span></code></p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> – (optional, default: 0.1) the length of the step</p></li>
</ul>
<p>OUTPUT:</p>
<p>Return a list of points.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="ode.html#sage.calculus.ode.ode_solver" title="sage.calculus.ode.ode_solver"><code class="xref py py-func docutils literal notranslate"><span class="pre">ode_solver()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_system_rk4</span>
</pre></div>
</div>
<p>Lotka Volterra system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">desolve_system_rk4</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="o">=</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">=</span><span class="n">desolve_system_rk4</span><span class="p">([</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">y</span><span class="p">),</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)],[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span><span class="n">ics</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">ivar</span><span class="o">=</span><span class="n">t</span><span class="p">,</span><span class="n">end_points</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="p">[</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">LP</span><span class="o">=</span><span class="n">list_plot</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="p">[</span> <span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">LP</span><span class="o">=</span><span class="n">list_plot</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>4th order Runge-Kutta method. Wrapper for command <code class="docutils literal notranslate"><span class="pre">rk</span></code> in Maxima’s
dynamics package.  Perhaps could be faster by using <code class="docutils literal notranslate"><span class="pre">fast_float</span></code>
instead.</p>
<p>AUTHOR:</p>
<ul class="simple">
<li><p>Robert Marik (10-2009)</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.desolve_tides_mpfr">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">desolve_tides_mpfr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">initial</span></em>, <em class="sig-param"><span class="n">final</span></em>, <em class="sig-param"><span class="n">delta</span></em>, <em class="sig-param"><span class="n">tolrel</span><span class="o">=</span><span class="default_value">1e-16</span></em>, <em class="sig-param"><span class="n">tolabs</span><span class="o">=</span><span class="default_value">1e-16</span></em>, <em class="sig-param"><span class="n">digits</span><span class="o">=</span><span class="default_value">50</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.desolve_tides_mpfr" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve numerically a system of first order differential equations using the
taylor series integrator in arbitrary precision implemented in tides.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – symbolic function. Its first argument will be the independent
variable. Its output should be de derivatives of the dependent variables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ics</span></code> – a list or tuple with the initial conditions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">initial</span></code> – the starting value for the independent variable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">final</span></code> – the final value for the independent value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">delta</span></code> – the size of the steps in the output.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolrel</span></code> – the relative tolerance for the method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tolabs</span></code> – the absolute tolerance for the method.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">digits</span></code> – the digits of precision used in the computation.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A list  with the positions of the IVP.</p></li>
</ul>
<p>EXAMPLES:</p>
<p>We integrate the Lorenz equations with Salztman values for the parameters
along 10 periodic orbits with 100 digits of precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t,x,y,z&#39;</span><span class="p">)</span>
<span class="go">(t, x, y, z)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="mi">28</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span><span class="o">=</span> <span class="p">[</span><span class="n">s</span><span class="o">*</span><span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">),</span><span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">-</span><span class="n">z</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="n">b</span><span class="o">*</span><span class="n">z</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346395038284</span>
<span class="gp">sage: </span><span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506704676171</span>
<span class="gp">sage: </span><span class="n">z0</span> <span class="o">=</span> <span class="mi">27</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="mf">15.586522107161747275678702092126960705284805489972439358895215783190198756258880854355851082660142374</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">desolve_tides_mpfr</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">z0</span><span class="p">],</span><span class="mi">0</span> <span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mf">1e-100</span><span class="p">,</span> <span class="mf">1e-100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="c1"># optional - tides</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="c1"># optional -tides # abs tol 1e-50</span>
<span class="go">[[0.000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000,</span>
<span class="go">-13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346395038,</span>
<span class="go">-19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506704676,</span>
<span class="go">27.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000],</span>
<span class="go">[15.5865221071617472756787020921269607052848054899724393588952157831901987562588808543558510826601424,</span>
<span class="go">-13.7636106821342005250144010543616538641008648540923684535378642921202827747268115852940239346315658,</span>
<span class="go">-19.5787519424517955388380414460095588661142400534276438649791334295426354746147526415973165506778440,</span>
<span class="go">26.9999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999636628]]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>Uses TIDES.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This requires the package tides.</p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../../references/index.html#abbr2011" id="id2"><span>[ABBR2011]</span></a></p></li>
<li><p><a class="reference internal" href="../../../references/index.html#abbr2012" id="id3"><span>[ABBR2012]</span></a></p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.eulers_method">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">eulers_method</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">h</span></em>, <em class="sig-param"><span class="n">x1</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'table'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.eulers_method" title="Permalink to this definition">¶</a></dt>
<dd><p>This implements Euler’s method for finding numerically the
solution of the 1st order ODE <span class="math notranslate nohighlight">\(y' = f(x,y)\)</span>, <span class="math notranslate nohighlight">\(y(a)=c\)</span>. The <code class="docutils literal notranslate"><span class="pre">x</span></code>
column of the table increments from <span class="math notranslate nohighlight">\(x_0\)</span> to <span class="math notranslate nohighlight">\(x_1\)</span> by <span class="math notranslate nohighlight">\(h\)</span> (so
<span class="math notranslate nohighlight">\((x_1-x_0)/h\)</span> must be an integer). In the <code class="docutils literal notranslate"><span class="pre">y</span></code> column, the new
<span class="math notranslate nohighlight">\(y\)</span>-value equals the old <span class="math notranslate nohighlight">\(y\)</span>-value plus the corresponding entry in the
last column.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is for pedagogical purposes only.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">     x                    y                  h*f(x,y)</span>
<span class="go">     0                    1                   -2</span>
<span class="go">   1/2                   -1                 -7/4</span>
<span class="go">     1                -11/4                -11/8</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1], [1, -11/4], [3/2, -33/8]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s1">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1.0], [1, -2.7], [3/2, -4.0]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s1">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">     x                    y                  h*f(x,y)</span>
<span class="go">     0                    1                 -2.0</span>
<span class="go">   1/2                 -1.0                 -1.7</span>
<span class="go">     1                 -2.7                 -1.3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;xy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">         x                    y                  h*f(x,y)</span>
<span class="go">         1                    1                  1/3</span>
<span class="go">       4/3                  4/3                    1</span>
<span class="go">       5/3                  7/3                 17/9</span>
<span class="go">         2                 38/9                83/27</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 1], [1/2, -1], [1, -11/4], [3/2, -33/8]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">eulers_method</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">list_plot</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">line</span><span class="p">(</span><span class="n">pts</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">P1</span><span class="o">+</span><span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Joyner</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.eulers_method_2x2">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">eulers_method_2x2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">h</span></em>, <em class="sig-param"><span class="n">t1</span></em>, <em class="sig-param"><span class="n">algorithm</span><span class="o">=</span><span class="default_value">'table'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.eulers_method_2x2" title="Permalink to this definition">¶</a></dt>
<dd><p>This implements Euler’s method for finding numerically the
solution of the 1st order system of two ODEs</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
x' &amp;= f(t, x, y), x(t_0)=x_0 \\
y' &amp;= g(t, x, y), y(t_0)=y_0.
\end{aligned}\end{split}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">t</span></code> column of the table increments from <span class="math notranslate nohighlight">\(t_0\)</span> to <span class="math notranslate nohighlight">\(t_1\)</span> by <span class="math notranslate nohighlight">\(h\)</span>
(so <span class="math notranslate nohighlight">\(\frac{t_1-t_0}{h}\)</span> must be an integer). In the <code class="docutils literal notranslate"><span class="pre">x</span></code> column,
the new <span class="math notranslate nohighlight">\(x\)</span>-value equals the old <span class="math notranslate nohighlight">\(x\)</span>-value plus the corresponding
entry in the next (third) column.  In the <code class="docutils literal notranslate"><span class="pre">y</span></code> column, the new
<span class="math notranslate nohighlight">\(y\)</span>-value equals the old <span class="math notranslate nohighlight">\(y\)</span>-value plus the corresponding entry in the
next (last) column.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is for pedagogical purposes only.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method_2x2</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="go">[[0, 0, 0], [1/3, 0, 0], [2/3, 1/9, 0], [1, 10/27, 1/27], [4/3, 68/81, 4/27]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    0                         0                    0                    0</span>
<span class="go">   1/3                    0                       1/9                    0                    0</span>
<span class="go">   2/3                  1/9                      7/27                    0                 1/27</span>
<span class="go">     1                10/27                     38/81                 1/27                  1/9</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s1">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">t</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    0                      0.00                    0                 0.00</span>
<span class="go">   1/3                 0.00                      0.13                 0.00                 0.00</span>
<span class="go">   2/3                 0.13                      0.29                 0.00                0.043</span>
<span class="go">     1                 0.41                      0.57                0.043                 0.15</span>
</pre></div>
</div>
<p>To numerically approximate <span class="math notranslate nohighlight">\(y(1)\)</span>, where <span class="math notranslate nohighlight">\((1+t^2)y''+y'-y=0\)</span>,
<span class="math notranslate nohighlight">\(y(0)=1\)</span>, <span class="math notranslate nohighlight">\(y'(0)=-1\)</span>, using 4 steps of Euler’s method, first
convert to a system: <span class="math notranslate nohighlight">\(y_1' = y_2\)</span>, <span class="math notranslate nohighlight">\(y_1(0)=1\)</span>; <span class="math notranslate nohighlight">\(y_2' =
\frac{y_1-y_2}{1+t^2}\)</span>, <span class="math notranslate nohighlight">\(y_2(0)=-1\)</span>.:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RR</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="n">sci_not</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rnd</span><span class="o">=</span><span class="s1">&#39;RNDU&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">    t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">    0                    1                     -0.25                   -1                 0.50</span>
<span class="go">  1/4                 0.75                     -0.12                -0.50                 0.29</span>
<span class="go">  1/2                 0.63                    -0.054                -0.21                 0.19</span>
<span class="go">  3/4                 0.63                   -0.0078               -0.031                 0.11</span>
<span class="go">    1                 0.63                     0.020                0.079                0.071</span>
</pre></div>
</div>
<p>To numerically approximate <span class="math notranslate nohighlight">\(y(1)\)</span>, where <span class="math notranslate nohighlight">\(y''+ty'+y=0\)</span>, <span class="math notranslate nohighlight">\(y(0)=1\)</span>, <span class="math notranslate nohighlight">\(y'(0)=0\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">PolynomialRing</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="s2">&quot;txy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">*</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">eulers_method_2x2</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">     t                    x                h*f(t,x,y)                    y           h*g(t,x,y)</span>
<span class="go">     0                    1                      0.00                    0                -0.25</span>
<span class="go">   1/4                  1.0                    -0.062                -0.25                -0.23</span>
<span class="go">   1/2                 0.94                     -0.11                -0.46                -0.17</span>
<span class="go">   3/4                 0.88                     -0.15                -0.62                -0.10</span>
<span class="go">     1                 0.75                     -0.17                -0.68               -0.015</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>David Joyner</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.eulers_method_2x2_plot">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">eulers_method_2x2_plot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">g</span></em>, <em class="sig-param"><span class="n">t0</span></em>, <em class="sig-param"><span class="n">x0</span></em>, <em class="sig-param"><span class="n">y0</span></em>, <em class="sig-param"><span class="n">h</span></em>, <em class="sig-param"><span class="n">t1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.eulers_method_2x2_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot solution of ODE.</p>
<p>This plots the solution in the rectangle with sides <code class="docutils literal notranslate"><span class="pre">(xrange[0],xrange[1])</span></code> and
<code class="docutils literal notranslate"><span class="pre">(yrange[0],yrange[1])</span></code>, and plots using Euler’s method the
numerical solution of the 1st order ODEs <span class="math notranslate nohighlight">\(x' = f(t,x,y)\)</span>,
<span class="math notranslate nohighlight">\(x(a)=x_0\)</span>, <span class="math notranslate nohighlight">\(y' = g(t,x,y)\)</span>, <span class="math notranslate nohighlight">\(y(a) = y_0\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is for pedagogical purposes only.</p>
</div>
<p>EXAMPLES:</p>
<p>The following example plots the solution to
<span class="math notranslate nohighlight">\(\theta''+\sin(\theta)=0\)</span>, <span class="math notranslate nohighlight">\(\theta(0)=\frac 34\)</span>, <span class="math notranslate nohighlight">\(\theta'(0) =
0\)</span>.  Type <code class="docutils literal notranslate"><span class="pre">P[0].show()</span></code> to plot the solution,
<code class="docutils literal notranslate"><span class="pre">(P[0]+P[1]).show()</span></code> to plot <span class="math notranslate nohighlight">\((t,\theta(t))\)</span> and
<span class="math notranslate nohighlight">\((t,\theta'(t))\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.desolvers</span> <span class="kn">import</span> <span class="n">eulers_method_2x2_plot</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span> <span class="p">:</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span> <span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span> <span class="p">:</span> <span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">eulers_method_2x2_plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.fricas_desolve">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">fricas_desolve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">de</span></em>, <em class="sig-param"><span class="n">dvar</span></em>, <em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">ivar</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.fricas_desolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve an ODE using FriCAS.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">)</span>             <span class="c1"># optional - fricas</span>
<span class="go">_C0*e^(-x) + 1</span>

<span class="gp">sage: </span><span class="n">desolve</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">==</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">)</span>  <span class="c1"># optional - fricas</span>
<span class="go">-1/5*(2*cos(x)*y(x)^2 + 4*sin(x)*y(x)^2 - 5)*e^(-2*x)/y(x)^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.calculus.desolvers.fricas_desolve_system">
<code class="sig-prename descclassname">sage.calculus.desolvers.</code><code class="sig-name descname">fricas_desolve_system</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">des</span></em>, <em class="sig-param"><span class="n">dvars</span></em>, <em class="sig-param"><span class="n">ics</span></em>, <em class="sig-param"><span class="n">ivar</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.desolvers.fricas_desolve_system" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve a system of first order ODEs using FriCAS.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">)</span>          <span class="c1"># optional - fricas</span>
<span class="go">[x(t) == _C0*cos(t) + cos(t)^2 + _C1*sin(t) + sin(t)^2,</span>
<span class="go"> y(t) == -_C1*cos(t) + _C0*sin(t) + 1]</span>

<span class="gp">sage: </span><span class="n">desolve_system</span><span class="p">([</span><span class="n">de1</span><span class="p">,</span> <span class="n">de2</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;fricas&quot;</span><span class="p">)</span>  <span class="c1"># optional - fricas</span>
<span class="go">[x(t) == cos(t)^2 + sin(t)^2 - sin(t), y(t) == cos(t) + 1]</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="wester.html"
                        title="previous chapter">Further examples from Wester’s paper</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="transforms/dwt.html"
                        title="next chapter">Discrete Wavelet Transform</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/calculus/desolvers.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transforms/dwt.html" title="Discrete Wavelet Transform"
             >next</a> |</li>
        <li class="right" >
          <a href="wester.html" title="Further examples from Wester’s paper"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.3 Reference Manual: Symbolic Calculus</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Solving ordinary differential equations</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>