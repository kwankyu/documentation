
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Symbolic Computation &#8212; Sage 9.4 Reference Manual: Symbolic Calculus</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sage.css" />
    <script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Units of measurement" href="../symbolic/units.html" />
    <link rel="prev" title="Symbolic Equations and Inequalities" href="../symbolic/relation.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../symbolic/units.html" title="Units of measurement"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../symbolic/relation.html" title="Symbolic Equations and Inequalities"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.4 Reference Manual: Symbolic Calculus</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Symbolic Computation</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="symbolic-computation">
<span id="sage-calculus-calculus"></span><h1>Symbolic Computation<a class="headerlink" href="#symbolic-computation" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.calculus.calculus"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Bobby Moretti and William Stein (2006-2007)</p></li>
<li><p>Robert Bradshaw (2007-10): minpoly(), numerical algorithm</p></li>
<li><p>Robert Bradshaw (2008-10): minpoly(), algebraic algorithm</p></li>
<li><p>Golam Mortuza Hossain (2009-06-15): _limit_latex()</p></li>
<li><p>Golam Mortuza Hossain (2009-06-22): _laplace_latex(), _inverse_laplace_latex()</p></li>
<li><p>Tom Coates (2010-06-11): fixed <a class="reference external" href="https://trac.sagemath.org/9217">trac ticket #9217</a></p></li>
</ul>
<p>EXAMPLES:</p>
<p>The basic units of the calculus package are symbolic expressions which
are elements of the symbolic expression ring (SR). To create a
symbolic variable object in Sage, use the <a class="reference internal" href="var.html#sage.calculus.var.var" title="sage.calculus.var.var"><code class="xref py py-func docutils literal notranslate"><span class="pre">var()</span></code></a> function, whose
argument is the text of that variable. Note that Sage is intelligent
about LaTeXing variable names.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x1</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x1&#39;</span><span class="p">);</span> <span class="n">x1</span>
<span class="go">x1</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
<span class="go">x_{1}</span>
<span class="gp">sage: </span><span class="n">theta</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">);</span> <span class="n">theta</span>
<span class="go">theta</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="go">\theta</span>
</pre></div>
</div>
<p>Sage predefines <code class="docutils literal notranslate"><span class="pre">x</span></code> to be a global indeterminate.
Thus the following works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="go">x^2</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>More complicated expressions in Sage can be built up using ordinary
arithmetic. The following are valid, and follow the rules of Python
arithmetic: (The ‘=’ operator represents assignment, and not
equality)</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">)</span>
<span class="go">(x, y, z)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">/</span><span class="mi">55</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">^</span><span class="n">f</span><span class="p">;</span> <span class="n">g</span>
<span class="go">(x + y + 1/2*z/sin(1/55*y*z))^(x + y + 1/2*z/sin(1/55*y*z))</span>
</pre></div>
</div>
<p>Differentiation and integration are available, but behind the
scenes through Maxima:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">2*sin(x)*sin(2*y)/cos(2*y)^2</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">integral</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">-cos(x)/cos(2*y)</span>
</pre></div>
</div>
<p>Note that these methods usually require an explicit variable name. If none
is given, Sage will try to find one for you.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">cos(x)</span>
</pre></div>
</div>
<p>If the expression is a callable symbolic expression (i.e., the
variable order is specified), then Sage can calculate the matrix
derivative (i.e., the gradient, Jacobian matrix, etc.) if no variables
are specified.  In the example below, we use the second derivative
test to determine that there is a saddle point at (0,-1/2).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">=</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="c1"># gradient</span>
<span class="go">(x, y) |--&gt; (2*x*y, x^2 + 2*y + 1)</span>
<span class="gp">sage: </span><span class="n">solve</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()),[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="go">[[x == -I, y == 0], [x == I, y == 0], [x == 0, y == (-1/2)]]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">=</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">H</span>  <span class="c1"># Hessian matrix</span>
<span class="go">[(x, y) |--&gt; 2*y (x, y) |--&gt; 2*x]</span>
<span class="go">[(x, y) |--&gt; 2*x   (x, y) |--&gt; 2]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0  2]</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">y</span><span class="o">=-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">[-1, 2]</span>
</pre></div>
</div>
<p>Here we calculate the Jacobian for the polar coordinate transformation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">theta</span><span class="p">)</span><span class="o">=</span><span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(r, theta) |--&gt; (r*cos(theta), r*sin(theta))</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="c1"># Jacobian matrix</span>
<span class="go">[   (r, theta) |--&gt; cos(theta) (r, theta) |--&gt; -r*sin(theta)]</span>
<span class="go">[   (r, theta) |--&gt; sin(theta)  (r, theta) |--&gt; r*cos(theta)]</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="c1"># Jacobian matrix</span>
<span class="go">[   (r, theta) |--&gt; cos(theta) (r, theta) |--&gt; -r*sin(theta)]</span>
<span class="go">[   (r, theta) |--&gt; sin(theta)  (r, theta) |--&gt; r*cos(theta)]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="c1"># Jacobian</span>
<span class="go">(r, theta) |--&gt; r*cos(theta)^2 + r*sin(theta)^2</span>
</pre></div>
</div>
<p>When the order of variables is ambiguous, Sage will raise an
exception when differentiating:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: No differentiation variable specified.</span>
</pre></div>
</div>
<p>Simplifying symbolic sums is also possible, using the
sum command, which also uses Maxima in the background:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;k, m&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">1/90*pi^4</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="go">2^m</span>
</pre></div>
</div>
<p>Symbolic matrices can be used as well in various ways,
including exponentiation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">^</span><span class="mi">2</span>
<span class="go">[x^2 + x   2*x^3]</span>
<span class="go">[      2 x^2 + x]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[          1/2*(e^(2*sqrt(x)) + 1)*e^(x - sqrt(x)) 1/2*(x*e^(2*sqrt(x)) - x)*sqrt(x)*e^(x - sqrt(x))]</span>
<span class="go">[  1/2*(e^(2*sqrt(x)) - 1)*e^(x - sqrt(x))/x^(3/2)           1/2*(e^(2*sqrt(x)) + 1)*e^(x - sqrt(x))]</span>
</pre></div>
</div>
<p>And complex exponentiation works now:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">matrix</span><span class="p">([[</span><span class="n">pi</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">matrix</span><span class="p">([[</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0  1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="n">pi</span><span class="p">],[</span><span class="o">-</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">^</span><span class="n">M</span>
<span class="go">[-1  0]</span>
<span class="go">[ 0 -1]</span>
</pre></div>
</div>
<p>Substitution works similarly. We can substitute with a python
dict:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">),</span> <span class="n">y</span><span class="p">:</span> <span class="n">z</span><span class="p">})</span>
<span class="go">sin(t*z - z)</span>
</pre></div>
</div>
<p>Also we can substitute with keywords:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>
<span class="go">sin(t*z - z)</span>
</pre></div>
</div>
<p>It was formerly the case that if there was no ambiguity of variable
names, we didn’t have to specify them; that still works for the moment,
but the behavior is deprecated:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: Substitution using function-call</span>
<span class="go">syntax and unnamed arguments is deprecated and will be removed</span>
<span class="go">from a future release of Sage; you can use named arguments instead,</span>
<span class="go">like EXPR(x=..., y=...)</span>
<span class="go">See http://trac.sagemath.org/5930 for details.</span>
<span class="go">sin(y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>However if there is ambiguity, we should explicitly state what
variables we’re substituting for:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">sin(8*pi/y)</span>
</pre></div>
</div>
<p>We can also make a <code class="docutils literal notranslate"><span class="pre">CallableSymbolicExpression</span></code>,
which is a <code class="docutils literal notranslate"><span class="pre">SymbolicExpression</span></code> that is a function of
specified variables in a fixed order. Each
<code class="docutils literal notranslate"><span class="pre">SymbolicExpression</span></code> has a
<code class="docutils literal notranslate"><span class="pre">function(...)</span></code> method that is used to create a
<code class="docutils literal notranslate"><span class="pre">CallableSymbolicExpression</span></code>, as illustrated below:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">log</span><span class="p">((</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(x, y) |--&gt; log(-(x - 2)/(y + 5))</span>
</pre></div>
</div>
<p>There is an easier way of creating a
<code class="docutils literal notranslate"><span class="pre">CallableSymbolicExpression</span></code>, which relies on the
Sage preparser.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">);</span> <span class="n">f</span>
<span class="go">(x, y) |--&gt; cos(y)*log(x)</span>
</pre></div>
</div>
<p>Then we have fixed an order of variables and there is no ambiguity
substituting or evaluating:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">log</span><span class="p">((</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="go">log(-5/(t + 5))</span>
</pre></div>
</div>
<p>Some further examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">5*sin(x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5*sin(2)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pi</span><span class="p">))</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">integrate</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">9</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">);</span> <span class="n">f</span>
<span class="go">arcsinh(1/3*x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">arcsinh(1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">1/sqrt(x^2 + 9)</span>
</pre></div>
</div>
<p>We compute the length of the parabola from 0 to 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">dy</span> <span class="o">=</span> <span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">integral</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">dy</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span>
<span class="go">sqrt(17) + 1/4*arcsinh(4)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span>
<span class="go">4.6467837624329358733826155674904591885104869874232887508703</span>
<span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">4.646783762432936</span>
</pre></div>
</div>
<p>We test pickling:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">f</span><span class="p">))</span> <span class="o">==</span> <span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Coercion examples:</p>
<p>We coerce various symbolic expressions into the complex numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">I</span><span class="p">)</span>
<span class="go">1.00000000000000*I</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">2.00000000000000*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">2.0000000000000000000000000000000000000000000000000000000000*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">sin</span><span class="p">(</span><span class="n">I</span><span class="p">))</span>
<span class="go">1.1752011936438014568823818505956008151557179813340958702296*I</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">I</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">I</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span> <span class="n">f</span>
<span class="go">cosh(1/2) + I*sinh(1)</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.12762596520638 + 1.17520119364380*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">200</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.1276259652063807852262251614026720125478471180986674836290 + 1.1752011936438014568823818505956008151557179813340958702296*I</span>
<span class="gp">sage: </span><span class="n">ComplexField</span><span class="p">(</span><span class="mi">100</span><span class="p">)(</span><span class="n">f</span><span class="p">)</span>
<span class="go">1.1276259652063807852262251614 + 1.1752011936438014568823818506*I</span>
</pre></div>
</div>
<p>We illustrate construction of an inverse sum where each denominator
has a new variable name:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;n</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span><span class="k">i</span>)^i for i in range(10))
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">1/n1 + 1/n2^2 + 1/n3^3 + 1/n4^4 + 1/n5^5 + 1/n6^6 + 1/n7^7 + 1/n8^8 + 1/n9^9 + 1</span>
</pre></div>
</div>
<p>Note that after calling var, the variables are immediately
available for use:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">n1</span> <span class="o">+</span> <span class="n">n2</span><span class="p">)</span><span class="o">^</span><span class="mi">5</span>
<span class="go">(n1 + n2)^5</span>
</pre></div>
</div>
<p>We can, of course, substitute:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">n9</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">n7</span><span class="o">=</span><span class="n">n6</span><span class="p">)</span>
<span class="go">1/n1 + 1/n2^2 + 1/n3^3 + 1/n4^4 + 1/n5^5 + 1/n6^6 + 1/n6^7 + 1/n8^8 + 387420490/387420489</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.at">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.at" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses <code class="docutils literal notranslate"><span class="pre">at</span></code> formulations from other systems, such as Maxima.
Replaces evaluation ‘at’ a point with substitution method of
a symbolic expression.</p>
<p>EXAMPLES:</p>
<p>We do not import <code class="docutils literal notranslate"><span class="pre">at</span></code> at the top level, but we can use it
as a synonym for substitution if we import it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>We find a formal Taylor expansion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">h</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;h,x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">h</span><span class="p">)</span>
<span class="go">u(h + x)</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">D[0](u)(h + x)</span>
<span class="gp">sage: </span><span class="n">taylor</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">h</span><span class="p">),</span><span class="n">h</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1/24*h^4*diff(u(x), x, x, x, x) + 1/6*h^3*diff(u(x), x, x, x) + 1/2*h^2*diff(u(x), x, x) + h*diff(u(x), x) + u(x)</span>
</pre></div>
</div>
<p>We compute a Laplace transform:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;s,t&#39;</span><span class="p">)</span>
<span class="go">(s, t)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">=</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">diff(f(t), t, t)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="go">s^2*laplace(f(t), t, s) - s*f(0) - D[0](f)(0)</span>
</pre></div>
</div>
<p>We can also accept a non-keyword list of expression substitutions,
like Maxima does (<a class="reference external" href="https://trac.sagemath.org/12796">trac ticket #12796</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">at</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">at</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="p">[</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">f(1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.dummy_diff">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">dummy_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.dummy_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called when ‘diff’ appears in a Maxima string.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_diff</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x,y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_diff</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="n">SR</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">-x*y^2*cos(x*y) - 2*y*sin(x*y)</span>
</pre></div>
</div>
<p>Here the function is used implicitly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;cr&#39;</span><span class="p">)(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">a</span><span class="p">);</span> <span class="n">g</span>
<span class="go">diff(cr(a), a)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.dummy_integrate">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">dummy_integrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.dummy_integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of integrals that
Maxima can’t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_integrate</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_integrate</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="go">integrate(f(x), x)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_integrate</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">integrate(f(x), x, a, b)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.dummy_inverse_laplace">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">dummy_inverse_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.dummy_inverse_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of inverse laplace
transforms that Maxima can’t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_inverse_laplace</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;s,t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_inverse_laplace</span><span class="p">(</span><span class="n">F</span><span class="p">(</span><span class="n">s</span><span class="p">),</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="go">ilt(F(s), s, t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.dummy_laplace">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">dummy_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.dummy_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is called to create formal wrappers of laplace transforms
that Maxima can’t compute:</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">dummy_laplace</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;s,t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dummy_laplace</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="p">)</span>
<span class="go">laplace(f(t), t, s)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.inverse_laplace">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">inverse_laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.inverse_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inverse Laplace transform with respect to the variable <span class="math notranslate nohighlight">\(t\)</span> and
transform parameter <span class="math notranslate nohighlight">\(s\)</span>, if possible.</p>
<p>If this function cannot find a solution, a formal function is returned.
The function that is returned may be viewed as a function of <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>DEFINITION:</p>
<p>The inverse Laplace transform of a function <span class="math notranslate nohighlight">\(F(s)\)</span> is the function
<span class="math notranslate nohighlight">\(f(t)\)</span>, defined by</p>
<div class="math notranslate nohighlight">
\[F(s) = \frac{1}{2\pi i} \int_{\gamma-i\infty}^{\gamma + i\infty} e^{st} F(s) dt,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma\)</span> is chosen so that the contour path of
integration is in the region of convergence of <span class="math notranslate nohighlight">\(F(s)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ex</span></code> - a symbolic expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> - transform parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> - independent variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>)  one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use Maxima (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code> - use SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'giac'</span></code> - use Giac</p></li>
</ul>
</li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.calculus.calculus.laplace" title="sage.calculus.calculus.laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">laplace()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;w, m&#39;</span><span class="p">)</span>
<span class="go">(w, m)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">m</span><span class="p">);</span> <span class="n">f</span>
<span class="go">1/10*sqrt(10)*sin(sqrt(10)*m)</span>
<span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="go">1/(w^2 + 10)</span>

<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">=</span> <span class="n">t</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">L</span>
<span class="go">t |--&gt; 2*s^2/(s^2 + 1)^2 - 1/(s^2 + 1)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">t |--&gt; t*cos(t)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">1/3*(sqrt(3)*sin(1/2*sqrt(3)*t) - cos(1/2*sqrt(3)*t))*e^(1/2*t) + 1/3*e^(-t)</span>
</pre></div>
</div>
<p>No explicit inverse Laplace transform, so one is returned formally a
function <code class="docutils literal notranslate"><span class="pre">ilt</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">ilt(cos(s), s, t)</span>
</pre></div>
</div>
<p>Transform an expression involving a time-shift, via SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">-(log(e^(-t)) + 1)*heaviside(t - 1)</span>
</pre></div>
</div>
<p>The same instance with Giac:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">(t - 1)*heaviside(t - 1)</span>
</pre></div>
</div>
<p>Transform a rational expression:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">)</span> <span class="o">-</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">s</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">s</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">-1/3*(sqrt(3)*e^(1/2*t - 1/2)*sin(1/2*sqrt(3)*(t - 1)) - cos(1/2*sqrt(3)*(t - 1))*e^(1/2*t - 1/2) +</span>
<span class="go">e^(-t + 1))*heaviside(t - 1) + 2/3*(2*cos(1/2*sqrt(3)*(t - 2))*e^(1/2*t - 1) + e^(-t + 2))*heaviside(t - 2)</span>

<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">s</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="n">s</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">e^x</span>
</pre></div>
</div>
<p>The inverse Laplace transform of a constant is a delta
distribution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">dirac_delta(t)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">dirac_delta(t)</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">dirac_delta(t)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.laplace">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">laplace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Laplace transform with respect to the variable <span class="math notranslate nohighlight">\(t\)</span> and
transform parameter <span class="math notranslate nohighlight">\(s\)</span>, if possible.</p>
<p>If this function cannot find a solution, a formal function is returned.
The function that is returned may be viewed as a function of <span class="math notranslate nohighlight">\(s\)</span>.</p>
<p>DEFINITION:</p>
<p>The Laplace transform of a function <span class="math notranslate nohighlight">\(f(t)\)</span>, defined for all real numbers
<span class="math notranslate nohighlight">\(t \geq 0\)</span>, is the function <span class="math notranslate nohighlight">\(F(s)\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[F(s) = \int_{0}^{\infty} e^{-st} f(t) dt.\]</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ex</span></code> - a symbolic expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> - independent variable</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> - transform parameter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>)  one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use Maxima (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code> - use SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'giac'</span></code> - use Giac</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'sympy'</span></code> algorithm returns the tuple (<span class="math notranslate nohighlight">\(F\)</span>, <span class="math notranslate nohighlight">\(a\)</span>, <code class="docutils literal notranslate"><span class="pre">cond</span></code>)
where <span class="math notranslate nohighlight">\(F\)</span> is the Laplace transform of <span class="math notranslate nohighlight">\(f(t)\)</span>,
<span class="math notranslate nohighlight">\(Re(s)&gt;a\)</span> is the half-plane of convergence, and <code class="docutils literal notranslate"><span class="pre">cond</span></code> are
auxiliary convergence conditions.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.calculus.calculus.inverse_laplace" title="sage.calculus.calculus.inverse_laplace"><code class="xref py py-func docutils literal notranslate"><span class="pre">inverse_laplace()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<p>We compute a few Laplace transforms:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, s, z, t, t0&#39;</span><span class="p">)</span>
<span class="go">(x, s, z, t, t0)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">1/(s^2 + 1)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">z/s + 1/(s - 1)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="n">t0</span><span class="p">)</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">-(euler_gamma + log(s) + log(t0))/s</span>
</pre></div>
</div>
<p>We do a formal calculation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">);</span> <span class="n">g</span>
<span class="go">diff(f(x), x)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(f(x), x, s) - f(0)</span>
</pre></div>
</div>
<p>A BATTLE BETWEEN the X-women and the Y-men (by David
Joyner): Solve</p>
<div class="math notranslate nohighlight">
\[x' = -16y, x(0)=270,  y' = -x + 1, y(0) = 90.\]</div>
<p>This models a fight between two sides, the “X-women” and the
“Y-men”, where the X-women have 270 initially and the Y-men have
90, but the Y-men are better at fighting, because of the higher
factor of “-16” vs “-1”, and also get an occasional reinforcement,
because of the “+1” term.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)(</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">de1</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mi">16</span><span class="o">*</span><span class="n">y</span>
<span class="gp">sage: </span><span class="n">de2</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">de1</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(x(t), t, s) + 16*laplace(y(t), t, s) - x(0)</span>
<span class="gp">sage: </span><span class="n">de2</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">s*laplace(y(t), t, s) - 1/s + laplace(x(t), t, s) - y(0)</span>
</pre></div>
</div>
<p>Next we form the augmented matrix of the above system:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">s</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">270</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="mi">90</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="n">s</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xt</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">yt</span> <span class="o">=</span> <span class="n">E</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">s</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xt</span>
<span class="go">-91/2*e^(4*t) + 629/2*e^(-4*t) + 1</span>
<span class="gp">sage: </span><span class="n">yt</span>
<span class="go">91/8*e^(4*t) + 629/8*e^(-4*t)</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="n">plot</span><span class="p">(</span><span class="n">yt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">rgbcolor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">p1</span><span class="o">+</span><span class="n">p2</span><span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SAGE_TMP</span><span class="p">,</span> <span class="s2">&quot;de_plot.png&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,s,t&#39;</span><span class="p">)</span>
<span class="go">(a, s, t)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">;</span> <span class="n">f</span>
<span class="go">t*e^(a + 2*t)*sin(t)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">laplace</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span> <span class="n">L</span>
<span class="go">2*(s - 2)*e^a/(s^2 - 4*s + 5)^2</span>
<span class="gp">sage: </span><span class="n">inverse_laplace</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">t*e^(a + 2*t)*sin(t)</span>
</pre></div>
</div>
<p>The Laplace transform of the exponential function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">1/(s - 1)</span>
</pre></div>
</div>
<p>Dirac’s delta distribution is handled (the output of SymPy is
related to a choice that has to be made when defining Laplace
transforms of distributions):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">dirac_delta</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">dirac_delta</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">(-heaviside(0) + 1, -oo, True)</span>
<span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">dirac_delta</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Heaviside step function can be handled with different interfaces.
Try with Maxima:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">heaviside</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">e^(-s)/s</span>
</pre></div>
</div>
<p>Try with giac:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">heaviside</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">e^(-s)/s</span>
</pre></div>
</div>
<p>Try with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">laplace</span><span class="p">(</span><span class="n">heaviside</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">(e^(-s)/s, 0, True)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.lim">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">lim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taylor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.lim" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limit as the variable <span class="math notranslate nohighlight">\(v\)</span> approaches <span class="math notranslate nohighlight">\(a\)</span>
from the given direction.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">expr.limit(x = a)</span>
<span class="go">expr.limit(x = a, dir=&#39;+&#39;)</span>
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span></code> - (default: None); dir may have the value
‘plus’ (or ‘+’ or ‘right’ or ‘above’) for a limit from above,
‘minus’ (or ‘-’ or ‘left’ or ‘below’) for a limit from below, or may be omitted
(implying a two-sided limit is to be computed).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taylor</span></code> - (default: False); if True, use Taylor
series, which allows more limits to be computed (but may also
crash in some obscure cases due to bugs in Maxima).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**argv</span></code> - 1 named parameter</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output may also use ‘und’ (undefined), ‘ind’
(indefinite but bounded), and ‘infinity’ (complex
infinity).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">7776/3125</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.06961575467...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.0696157546720...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
</pre></div>
</div>
<p>Notice that Maxima may ask for more information:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation</span>
<span class="go">*may* help (example of legal syntax is &#39;assume(a&gt;0)&#39;, see</span>
<span class="go">`assume?` for more details)</span>
<span class="go">Is a positive, negative or zero?</span>
</pre></div>
</div>
<p>With this example, Maxima is looking for a LOT of information:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an integer?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an even number?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;even&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="o">-</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">();</span> <span class="n">assume</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">lim</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>Here ind means “indefinite but bounded”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">ind</span>
</pre></div>
</div>
<p>We can use other packages than maxima, namely “sympy”, “giac”, “fricas”.</p>
<p>With the standard package Giac:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.libs.giac.giac</span> <span class="kn">import</span> <span class="n">libgiac</span>     <span class="c1"># random</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">^</span><span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>With the optional package FriCAS:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">^</span><span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>       <span class="c1"># optional - fricas</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>             <span class="c1"># optional - fricas</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>              <span class="c1"># optional - fricas</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>One can also call Mathematica’s online interface:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">pi</span><span class="o">+</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;mathematica_free&#39;</span><span class="p">)</span> <span class="c1"># optional - internet</span>
<span class="go">pi</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.limit">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">taylor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">argv</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limit as the variable <span class="math notranslate nohighlight">\(v\)</span> approaches <span class="math notranslate nohighlight">\(a\)</span>
from the given direction.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">expr.limit(x = a)</span>
<span class="go">expr.limit(x = a, dir=&#39;+&#39;)</span>
</pre></div>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dir</span></code> - (default: None); dir may have the value
‘plus’ (or ‘+’ or ‘right’ or ‘above’) for a limit from above,
‘minus’ (or ‘-’ or ‘left’ or ‘below’) for a limit from below, or may be omitted
(implying a two-sided limit is to be computed).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">taylor</span></code> - (default: False); if True, use Taylor
series, which allows more limits to be computed (but may also
crash in some obscure cases due to bugs in Maxima).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**argv</span></code> - 1 named parameter</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The output may also use ‘und’ (undefined), ‘ind’
(indefinite but bounded), and ‘infinity’ (complex
infinity).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">7776/3125</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.06961575467...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">2.0696157546720...</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">)</span>
<span class="go">(-I + 1)^I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
<span class="gp">sage: </span><span class="n">CDF</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">I</span><span class="p">))</span>
<span class="go">2.0628722350809046 + 0.7450070621797239*I</span>
</pre></div>
</div>
<p>Notice that Maxima may ask for more information:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation</span>
<span class="go">*may* help (example of legal syntax is &#39;assume(a&gt;0)&#39;, see</span>
<span class="go">`assume?` for more details)</span>
<span class="go">Is a positive, negative or zero?</span>
</pre></div>
</div>
<p>With this example, Maxima is looking for a LOT of information:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an integer?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="s1">&#39;integer&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Computation failed since Maxima requested additional</span>
<span class="go">constraints; using the &#39;assume&#39; command before evaluation *may* help</span>
<span class="go">(example of legal syntax is &#39;assume(a&gt;0)&#39;, see `assume?` for</span>
<span class="go"> more details)</span>
<span class="go">Is a an even number?</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="s1">&#39;even&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>More examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">e</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=-</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="o">-</span><span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">-Infinity</span>
<span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">();</span> <span class="n">assume</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span> <span class="n">lim</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">taylor</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
</pre></div>
</div>
<p>Here ind means “indefinite but bounded”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lim</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">ind</span>
</pre></div>
</div>
<p>We can use other packages than maxima, namely “sympy”, “giac”, “fricas”.</p>
<p>With the standard package Giac:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.libs.giac.giac</span> <span class="kn">import</span> <span class="n">libgiac</span>     <span class="c1"># random</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">^</span><span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>With the optional package FriCAS:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">^</span><span class="n">x</span><span class="o">+</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>       <span class="c1"># optional - fricas</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>             <span class="c1"># optional - fricas</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;fricas&#39;</span><span class="p">)</span>              <span class="c1"># optional - fricas</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>One can also call Mathematica’s online interface:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">limit</span><span class="p">(</span><span class="n">pi</span><span class="o">+</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;mathematica_free&#39;</span><span class="p">)</span> <span class="c1"># optional - internet</span>
<span class="go">pi</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.mapped_opts">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">mapped_opts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.mapped_opts" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally when creating a string of options to pass to
Maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - an object</p></li>
</ul>
<p>OUTPUT: a string.</p>
<p>The main use of this is to turn Python bools into lower case
strings.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="go">&#39;true&#39;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="go">&#39;false&#39;</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">mapped_opts</span><span class="p">(</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="go">&#39;bar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.maxima_options">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">maxima_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.maxima_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Used internally to create a string of options to pass to Maxima.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima_options</span><span class="p">(</span><span class="n">an_option</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">another</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">foo</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
<span class="go">&#39;an_option=true,another=false,foo=bar&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.minpoly">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">minpoly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.minpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimal polynomial of self, if possible.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code> - polynomial variable name (default ‘x’)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - ‘algebraic’ or ‘numerical’ (default
both, but with numerical first)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bits</span></code> - the number of bits to use in numerical
approx</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code> - the expected algebraic degree</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epsilon</span></code> - return without error as long as
f(self) epsilon, in the case that the result cannot be proven.</p>
<p>All of the above parameters are optional, with epsilon=0, bits and
degree tested up to 1000 and 24 by default respectively. The
numerical algorithm will be faster if bits and/or degree are given
explicitly. The algebraic algorithm ignores the last three
parameters.</p>
</li>
</ul>
<p>OUTPUT: The minimal polynomial of self. If the numerical algorithm
is used then it is proved symbolically when epsilon=0 (default).</p>
<p>If the minimal polynomial could not be found, two distinct kinds of
errors are raised. If no reasonable candidate was found with the
given bit/degree parameters, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> will be
raised. If a reasonable candidate was found but (perhaps due to
limits in the underlying symbolic package) was unable to be proved
correct, a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> will be raised.</p>
<p>ALGORITHM: Two distinct algorithms are used, depending on the
algorithm parameter. By default, the numerical algorithm is
attempted first, then the algebraic one.</p>
<p>Algebraic: Attempt to evaluate this expression in QQbar, using
cyclotomic fields to resolve exponential and trig functions at
rational multiples of pi, field extensions to handle roots and
rational exponents, and computing compositums to represent the full
expression as an element of a number field where the minimal
polynomial can be computed exactly. The bits, degree, and epsilon
parameters are ignored.</p>
<p>Numerical: Computes a numerical approximation of
<code class="docutils literal notranslate"><span class="pre">self</span></code> and use PARI’s algdep to get a candidate
minpoly <span class="math notranslate nohighlight">\(f\)</span>. If <span class="math notranslate nohighlight">\(f(\mathtt{self})\)</span>,
evaluated to a higher precision, is close enough to 0 then evaluate
<span class="math notranslate nohighlight">\(f(\mathtt{self})\)</span> symbolically, attempting to prove
vanishing. If this fails, and <code class="docutils literal notranslate"><span class="pre">epsilon</span></code> is non-zero,
return <span class="math notranslate nohighlight">\(f\)</span> if and only if
<span class="math notranslate nohighlight">\(f(\mathtt{self}) &lt; \mathtt{epsilon}\)</span>.
Otherwise raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> (if no suitable
candidate was found) or a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> (if a
likely candidate was found but could not be proved correct).</p>
<p>EXAMPLES: First some simple examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 - 2</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">x^3 - 2</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">x^4 - 2*x^2 + 9</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">x^6 - 6*x^4 + 6*x^3 + 12*x^2 + 36*x + 1</span>
</pre></div>
</div>
<p>Works with trig and exponential functions too.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^2 - 3/4</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^6 - 7/4*x^4 + 7/8*x^2 - 7/64</span>
<span class="gp">sage: </span><span class="n">minpoly</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">I</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">17</span><span class="p">))</span>
<span class="go">x^16 - x^15 + x^14 - x^13 + x^12 - x^11 + x^10 - x^9 + x^8 - x^7 + x^6 - x^5 + x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
<p>Here we verify it gives the same result as the abstract number
field.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^4 - 22*x^2 - 48*x - 23</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">([</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">absolute_minpoly</span><span class="p">()</span>
<span class="go">x^4 - 22*x^2 - 48*x - 23</span>
</pre></div>
</div>
<p>The minpoly function is used implicitly when creating
number fields:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">eqn</span> <span class="o">=</span>  <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">solve</span><span class="p">(</span><span class="n">eqn</span><span class="p">,</span> <span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">QQ</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="go">Number Field in a with defining polynomial x^6 + 10*x^3 - 2*x^2 + 25 with a = 0.7185272465828846? - 1.721353471724806?*I</span>
</pre></div>
</div>
<p>Here we solve a cubic and then recover it from its complicated
radical expansion.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rhs</span><span class="p">();</span> <span class="n">a</span>
<span class="go">-1/2*(1/18*sqrt(23)*sqrt(3) - 1/2)^(1/3)*(I*sqrt(3) + 1) - 1/6*(-I*sqrt(3) + 1)/(1/18*sqrt(23)*sqrt(3) - 1/2)^(1/3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - x + 1</span>
</pre></div>
</div>
<p>Note that simplification may be necessary to see that the minimal
polynomial is correct.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^8 - 40*x^6 + 352*x^4 - 960*x^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(sqrt(5) + sqrt(3) + sqrt(2))^8 - 40*(sqrt(5) + sqrt(3) + sqrt(2))^6 + 352*(sqrt(5) + sqrt(3) + sqrt(2))^4 - 960*(sqrt(5) + sqrt(3) + sqrt(2))^2 + 576</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^6 - 7/4*x^4 + 7/8*x^2 - 7/64</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">horner</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">0.00000000000000000000000000000</span>
</pre></div>
</div>
<p>The degree must be high enough (default tops out at 24).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Could not find minimal polynomial (100 bits, degree 3).</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">,</span> <span class="n">bits</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">x^4 - 10*x^2 + 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;algebraic&#39;</span><span class="p">)</span>
<span class="go">x^10 + 1/2*x^9 - 5/2*x^8 - 5/4*x^7 + 17/8*x^6 + 17/16*x^5 - 43/64*x^4 - 43/128*x^3 + 3/64*x^2 + 3/128*x + 1/1024</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">33</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">)</span>
<span class="go">x^10 + 1/2*x^9 - 5/2*x^8 - 5/4*x^7 + 17/8*x^6 + 17/16*x^5 - 43/64*x^4 - 43/128*x^3 + 3/64*x^2 + 3/128*x + 1/1024</span>
</pre></div>
</div>
<p>Sometimes it fails, as it must given that some numbers aren’t algebraic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;numerical&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Could not find minimal polynomial (1000 bits, degree 24).</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Of course, failure to produce a minimal polynomial does not
necessarily indicate that this number is transcendental.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.mma_free_limit">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">mma_free_limit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.mma_free_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Limit using Mathematica’s online interface.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">mma_free_limit</span>
<span class="gp">sage: </span><span class="n">mma_free_limit</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># optional - internet</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Another simple limit:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mma_free_limit</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">oo</span><span class="p">)</span> <span class="c1"># optional - internet</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.nintegral">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">nintegral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_relative_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1e-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_num_subintervals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.nintegral" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a floating point machine precision numerical approximation
to the integral of <code class="docutils literal notranslate"><span class="pre">self</span></code> from <span class="math notranslate nohighlight">\(a\)</span> to
<span class="math notranslate nohighlight">\(b\)</span>, computed using floating point arithmetic via maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - variable to integrate with respect to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> - lower endpoint of integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - upper endpoint of integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">desired_relative_error</span></code> - (default: ‘1e-8’) the
desired relative error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximum_num_subintervals</span></code> - (default: 200)
maxima number of subintervals</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>float: approximation to the integral</p></li>
<li><p>float: estimated absolute error of the
approximation</p></li>
<li><p>the number of integrand evaluations</p></li>
<li><p>an error code:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - no problems were encountered</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - too many subintervals were done</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - excessive roundoff error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> - extremely bad integrand behavior</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> - failed to converge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> - integral is probably divergent or slowly
convergent</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">6</span></code> - the input is invalid; this includes the case of</dt><dd><p>desired_relative_error being too small to be achieved</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
<p>ALIAS: nintegrate is the same as nintegral</p>
<p>REMARK: There is also a function
<code class="docutils literal notranslate"><span class="pre">numerical_integral</span></code> that implements numerical
integration using the GSL C library. It is potentially much faster
and applies to arbitrary user defined functions.</p>
<p>Also, there are limits to the precision to which Maxima can compute
the integral due to limitations in quadpack.
In the following example, remark that the last value of the returned
tuple is <code class="docutils literal notranslate"><span class="pre">6</span></code>, indicating that the input was invalid, in this case
because of a too high desired precision.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="go">(0.0, 0.0, 0, 6)</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.5284822353142306, 4.163...e-11, 231, 0)</span>
</pre></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">numerical_integral</span></code> function,
which calls the GSL C library.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">numerical_integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.528482232253147, 6.83928460...e-07)</span>
</pre></div>
</div>
<p>Note that in exotic cases where floating point evaluation of the
expression leads to the wrong value, then the output can be
completely wrong:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">163</span><span class="p">))</span> <span class="o">-</span> <span class="mi">262537412640768744</span>
</pre></div>
</div>
<p>Despite appearance, <span class="math notranslate nohighlight">\(f\)</span> is really very close to 0, but one
gets a nonzero value since the definition of
<code class="docutils literal notranslate"><span class="pre">float(f)</span></code> is that it makes all constants inside the
expression floats, then evaluates each function and each arithmetic
operation using float arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">-480.0</span>
</pre></div>
</div>
<p>Computing to higher precision we see the truth:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="go">-7.4992740280181431112064614366622348652078895136533593355718e-13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">-7.49927402801814311120646143662663009137292462589621789352095066181709095575681963967103004e-13</span>
</pre></div>
</div>
<p>Now numerically integrating, we see why the answer is wrong:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegrate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-480.0000000000001, 5.32907051820075...e-12, 21, 0)</span>
</pre></div>
</div>
<p>It is just because every floating point evaluation of return -480.0
in floating point.</p>
<p>Important note: using PARI/GP one can compute numerical integrals
to high precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.565728500561051474934096410 E-127&#39;            # 32-bit</span>
<span class="go">&#39;2.5657285005610514829176211363206621657 E-127&#39;  # 64-bit</span>
<span class="gp">sage: </span><span class="n">old_prec</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.5657285005610514829173563961304957417746108003917 E-127&#39;</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="n">old_prec</span><span class="p">)</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note that the input function above is a string in PARI syntax.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.nintegrate">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">nintegrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desired_relative_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1e-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maximum_num_subintervals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.nintegrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a floating point machine precision numerical approximation
to the integral of <code class="docutils literal notranslate"><span class="pre">self</span></code> from <span class="math notranslate nohighlight">\(a\)</span> to
<span class="math notranslate nohighlight">\(b\)</span>, computed using floating point arithmetic via maxima.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - variable to integrate with respect to</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> - lower endpoint of integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - upper endpoint of integration</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">desired_relative_error</span></code> - (default: ‘1e-8’) the
desired relative error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maximum_num_subintervals</span></code> - (default: 200)
maxima number of subintervals</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>float: approximation to the integral</p></li>
<li><p>float: estimated absolute error of the
approximation</p></li>
<li><p>the number of integrand evaluations</p></li>
<li><p>an error code:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> - no problems were encountered</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - too many subintervals were done</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - excessive roundoff error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> - extremely bad integrand behavior</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> - failed to converge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> - integral is probably divergent or slowly
convergent</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">6</span></code> - the input is invalid; this includes the case of</dt><dd><p>desired_relative_error being too small to be achieved</p>
</dd>
</dl>
</li>
</ul>
</li>
</ul>
<p>ALIAS: nintegrate is the same as nintegral</p>
<p>REMARK: There is also a function
<code class="docutils literal notranslate"><span class="pre">numerical_integral</span></code> that implements numerical
integration using the GSL C library. It is potentially much faster
and applies to arbitrary user defined functions.</p>
<p>Also, there are limits to the precision to which Maxima can compute
the integral due to limitations in quadpack.
In the following example, remark that the last value of the returned
tuple is <code class="docutils literal notranslate"><span class="pre">6</span></code>, indicating that the input was invalid, in this case
because of a too high desired precision.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="go">(0.0, 0.0, 0, 6)</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegral</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.5284822353142306, 4.163...e-11, 231, 0)</span>
</pre></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">numerical_integral</span></code> function,
which calls the GSL C library.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">numerical_integral</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(0.528482232253147, 6.83928460...e-07)</span>
</pre></div>
</div>
<p>Note that in exotic cases where floating point evaluation of the
expression leads to the wrong value, then the output can be
completely wrong:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">163</span><span class="p">))</span> <span class="o">-</span> <span class="mi">262537412640768744</span>
</pre></div>
</div>
<p>Despite appearance, <span class="math notranslate nohighlight">\(f\)</span> is really very close to 0, but one
gets a nonzero value since the definition of
<code class="docutils literal notranslate"><span class="pre">float(f)</span></code> is that it makes all constants inside the
expression floats, then evaluates each function and each arithmetic
operation using float arithmetic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">-480.0</span>
</pre></div>
</div>
<p>Computing to higher precision we see the truth:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="go">-7.4992740280181431112064614366622348652078895136533593355718e-13</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">n</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="go">-7.49927402801814311120646143662663009137292462589621789352095066181709095575681963967103004e-13</span>
</pre></div>
</div>
<p>Now numerically integrating, we see why the answer is wrong:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">nintegrate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(-480.0000000000001, 5.32907051820075...e-12, 21, 0)</span>
</pre></div>
</div>
<p>It is just because every floating point evaluation of return -480.0
in floating point.</p>
<p>Important note: using PARI/GP one can compute numerical integrals
to high precision:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.565728500561051474934096410 E-127&#39;            # 32-bit</span>
<span class="go">&#39;2.5657285005610514829176211363206621657 E-127&#39;  # 64-bit</span>
<span class="gp">sage: </span><span class="n">old_prec</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="s1">&#39;intnum(x=17,42,exp(-x^2)*log(x))&#39;</span><span class="p">)</span>
<span class="go">&#39;2.5657285005610514829173563961304957417746108003917 E-127&#39;</span>
<span class="gp">sage: </span><span class="n">gp</span><span class="o">.</span><span class="n">set_real_precision</span><span class="p">(</span><span class="n">old_prec</span><span class="p">)</span>
<span class="go">57</span>
</pre></div>
</div>
<p>Note that the input function above is a string in PARI syntax.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.symbolic_expression_from_maxima_string">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">symbolic_expression_from_maxima_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equals_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxima</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">Maxima_lib</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.symbolic_expression_from_maxima_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string representation of a Maxima expression, parse it and
return the corresponding Sage symbolic expression.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> - a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">equals_sub</span></code> - (default: False) if True, replace
‘=’ by ‘==’ in self</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxima</span></code> - (default: the calculus package’s
Maxima) the Maxima interpreter to use.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_expression_from_maxima_string</span> <span class="k">as</span> <span class="n">sefms</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s1">&#39;x^</span><span class="si">%e</span><span class="s1"> + </span><span class="si">%e</span><span class="s1">^%pi + </span><span class="si">%i</span><span class="s1"> + sin(0)&#39;</span><span class="p">)</span>
<span class="go">x^e + e^pi + I</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sefms</span><span class="p">(</span><span class="s1">&#39;?%at(f(x),x=2)#1&#39;</span><span class="p">)</span>
<span class="go">f(2) != 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">maxima</span><span class="p">(</span><span class="s2">&quot;x#0&quot;</span><span class="p">);</span> <span class="n">a</span>
<span class="go">x#0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">sage</span><span class="p">()</span>
<span class="go">x != 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.symbolic_expression_from_string">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">symbolic_expression_from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">syms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_sequence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.symbolic_expression_from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a string, (attempt to) parse it and return the
corresponding Sage symbolic expression.  Normally used
to return Maxima output to the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> - a string</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">syms</span></code> - (default: {}) dictionary of
strings to be regarded as symbols or functions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">accept_sequence</span></code> - (default: False) controls whether
to allow a (possibly nested) set of lists and tuples
as input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parser</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">SR_parser</span></code>) parser for internal use</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">calculus</span><span class="o">.</span><span class="n">symbolic_expression_from_string</span><span class="p">(</span><span class="s1">&#39;[sin(0)*x^2,3*spam+e^pi]&#39;</span><span class="p">,</span><span class="n">syms</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;spam&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">},</span><span class="n">accept_sequence</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[0, 3*y + e^pi]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.symbolic_product">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">symbolic_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.symbolic_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symbolic product <span class="math notranslate nohighlight">\(\prod_{v = a}^b expression\)</span> with respect
to the variable <span class="math notranslate nohighlight">\(v\)</span> with endpoints <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> - a symbolic expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - a variable or variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> - lower endpoint of the product</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - upper endpoint of the prduct</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>)  one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use Maxima (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'giac'</span></code> - use Giac</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code> - use SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mathematica'</span></code> - (optional) use Mathematica</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">hold</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <code class="docutils literal notranslate"><span class="pre">True</span></code> don’t evaluate</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;i,k,n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_product</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">factorial(n)</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 + 20*x^3 + 127*x^2 + 288*x + 180</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">i</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">25401600</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">f(7)*f(6)*f(5)*f(4)*f(3)*f(2)*f(1)</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">product(f(i), i, 1, n)</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">k</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">integrate</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">1/factorial(n + 1)</span>
<span class="gp">sage: </span><span class="n">symbolic_product</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">log_expand</span><span class="p">()</span>
<span class="go">sum(log(f(i)), i, 1, n)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.calculus.calculus.symbolic_sum">
<span class="sig-prename descclassname"><span class="pre">sage.calculus.calculus.</span></span><span class="sig-name descname"><span class="pre">symbolic_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'maxima'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.calculus.calculus.symbolic_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symbolic sum <span class="math notranslate nohighlight">\(\sum_{v = a}^b expression\)</span> with respect
to the variable <span class="math notranslate nohighlight">\(v\)</span> with endpoints <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> - a symbolic expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> - a variable or variable name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code> - lower endpoint of the sum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> - upper endpoint of the sum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">'maxima'</span></code>)  one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'maxima'</span></code> - use Maxima (the default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'maple'</span></code> - (optional) use Maple</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'mathematica'</span></code> - (optional) use Mathematica</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'giac'</span></code> - (optional) use Giac</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code> - use SymPy</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">hold</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if <code class="docutils literal notranslate"><span class="pre">True</span></code> don’t evaluate</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;k,n&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.calculus.calculus</span> <span class="kn">import</span> <span class="n">symbolic_sum</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">1/2*(n + 1)*n</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">1/90*pi^4</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">k</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">zeta(5)</span>
</pre></div>
</div>
<p>A well known binomial identity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">2^n</span>
</pre></div>
</div>
<p>And some truncations thereof:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">n</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">2^n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="go">2^n - n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2^n - 1</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">k</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2^n - 2</span>
</pre></div>
</div>
<p>The binomial theorem:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x, y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">k</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">(x + y)^n</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">2^(n - 1)*n</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">k</span><span class="o">*</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-log(2) + 1</span>
</pre></div>
</div>
<p>Summing a hypergeometric term:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">/</span> <span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">1/2*sqrt(pi)/factorial(n + 1/2)</span>
</pre></div>
</div>
<p>We check a well known identity:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">==</span> <span class="n">symbolic_sum</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A geometric sum:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;a, q&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="go">(a*q^(n + 1) - a)/(q - 1)</span>
</pre></div>
</div>
<p>For the geometric series, we will have to assume
the right values for the sum to converge:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">-a/(q - 1)</span>
</pre></div>
</div>
<p>A divergent geometric series.  Don’t forget
to forget your assumptions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">assume</span><span class="p">(</span><span class="n">q</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">q</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">oo</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Sum is divergent.</span>
<span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">assumptions</span><span class="p">()</span> <span class="c1"># check the assumptions were really forgotten</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>A summation performed by Mathematica:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;mathematica&#39;</span><span class="p">)</span>     <span class="c1"># optional - mathematica</span>
<span class="go">pi*coth(pi)</span>
</pre></div>
</div>
<p>An example of this summation with Giac:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;giac&#39;</span><span class="p">)</span>
<span class="go">(pi*e^(2*pi) - pi*e^(-2*pi))/(e^(2*pi) + e^(-2*pi) - 2)</span>
</pre></div>
</div>
<p>The same summation is solved by SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">k</span><span class="o">^</span><span class="mi">2</span><span class="p">),</span> <span class="n">k</span><span class="p">,</span> <span class="o">-</span><span class="n">oo</span><span class="p">,</span> <span class="n">oo</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">pi/tanh(pi)</span>
</pre></div>
</div>
<p>SymPy and Maxima 5.39.0 can do the following (see
<a class="reference external" href="https://trac.sagemath.org/22005">trac ticket #22005</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Infinity</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">1/64*pi^2</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">4</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Infinity</span><span class="p">)</span>
<span class="go">1/64*pi^2</span>
</pre></div>
</div>
<p>Use Maple as a backend for summation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbolic_sum</span><span class="p">(</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">k</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;maple&#39;</span><span class="p">)</span>      <span class="c1"># optional - maple</span>
<span class="go">(x + 1)^n</span>
</pre></div>
</div>
<p>If you don’t want to evaluate immediately give the <code class="docutils literal notranslate"><span class="pre">hold</span></code> keyword:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">hold</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">s</span>
<span class="go">sum(n, n, 1, k)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
<span class="go">1/2*k^2 + 1/2*k</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">sum(n, n, 1, 10)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">unhold</span><span class="p">()</span>
<span class="go">55</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">k</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">55.0000000000000</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sage can currently only understand a subset of the output of Maxima,
Maple and Mathematica, so even if the chosen backend can perform
the summation the result might not be convertible into a Sage
expression.</p>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../symbolic/relation.html"
                        title="previous chapter">Symbolic Equations and Inequalities</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../symbolic/units.html"
                        title="next chapter">Units of measurement</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/calculus/calculus.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../symbolic/units.html" title="Units of measurement"
             >next</a> |</li>
        <li class="right" >
          <a href="../symbolic/relation.html" title="Symbolic Equations and Inequalities"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.4 Reference Manual: Symbolic Calculus</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Symbolic Computation</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.1.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>