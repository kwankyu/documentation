
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Canonical heights for elliptic curves over number fields &#8212; Elliptic curves</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Saturation of Mordell-Weil groups of elliptic curves over number fields" href="saturation.html" />
    <link rel="prev" title="Elliptic curves over number fields" href="ell_number_field.html" />
  <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
  <!-- <script src="../../../../_static/thebe.js" type="text/javascript"></script> -->
  <!-- <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script> -->

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="saturation.html" title="Saturation of Mordell-Weil groups of elliptic curves over number fields"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ell_number_field.html" title="Elliptic curves over number fields"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">Elliptic curves</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Canonical heights for elliptic curves over number fields</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="canonical-heights-for-elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-height"></span><h1>Canonical heights for elliptic curves over number fields<a class="headerlink" href="#canonical-heights-for-elliptic-curves-over-number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.height"></span><p>Also, rigorous lower bounds for the canonical height of non-torsion
points, implementing the algorithms in <a class="reference internal" href="../../../../references/index.html#cs2006" id="id1"><span>[CS2006]</span></a> (over <span class="math notranslate nohighlight">\(\QQ\)</span>) and <a class="reference internal" href="../../../../references/index.html#tho2010" id="id2"><span>[Tho2010]</span></a>,
which also refer to <a class="reference internal" href="../../../../references/index.html#cps2006" id="id3"><span>[CPS2006]</span></a>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Robert Bradshaw (2010): initial version</p></li>
<li><p>John Cremona (2014): added many docstrings and doctests</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">EllipticCurveCanonicalHeight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for computing canonical heights of points on elliptic curves
defined over number fields, including rigorous lower bounds for
the canonical height of non-torsion points.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">EllipticCurveCanonicalHeight</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">EllipticCurveCanonicalHeight</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">EllipticCurveCanonicalHeight object associated to Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
</pre></div>
</div>
<p>Normally this object would be created like this:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="go">EllipticCurveCanonicalHeight object associated to Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.B">
<span class="sig-name descname"><span class="pre">B</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value <span class="math notranslate nohighlight">\(B_n(\mu)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> (int) – a positive integer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> (real) – a positive real number</p></li>
</ul>
<p>OUTPUT:</p>
<p>The real value <span class="math notranslate nohighlight">\(B_n(\mu)\)</span> as defined in <a class="reference internal" href="../../../../references/index.html#tho2010" id="id4"><span>[Tho2010]</span></a>, section 5.</p>
<p>EXAMPLES:</p>
<p>Example 10.2 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id5"><span>[Tho2010]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
</pre></div>
</div>
<p>In <a class="reference internal" href="../../../../references/index.html#tho2010" id="id6"><span>[Tho2010]</span></a> the value is given as 0.772:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">RealField</span><span class="p">(</span><span class="mi">12</span><span class="p">)(</span> <span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span> <span class="p">)</span>
<span class="go">0.777</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.DE">
<span class="sig-name descname"><span class="pre">DE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.DE" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value <span class="math notranslate nohighlight">\(D_E(n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> (int) – a positive integer</p></li>
</ul>
<p>OUTPUT:</p>
<p>The value <span class="math notranslate nohighlight">\(D_E(n)\)</span> as defined in <a class="reference internal" href="../../../../references/index.html#tho2010" id="id7"><span>[Tho2010]</span></a>, section 4.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">H</span><span class="o">.</span><span class="n">DE</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[0, 2*log(5) + 2*log(2), 0, 2*log(13) + 2*log(5) + 4*log(2), 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.ME">
<span class="sig-name descname"><span class="pre">ME</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.ME" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the norm of the ideal <span class="math notranslate nohighlight">\(M_E\)</span>.</p>
<p>OUTPUT:</p>
<p>The norm of the ideal <span class="math notranslate nohighlight">\(M_E\)</span> as defined in <a class="reference internal" href="../../../../references/index.html#tho2010" id="id8"><span>[Tho2010]</span></a>, section 3.1.
This is <span class="math notranslate nohighlight">\(1\)</span> if <span class="math notranslate nohighlight">\(E\)</span> is a global minimal model, and in general
measures the non-minimality of <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">ME</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">ME</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">64</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">ME</span><span class="p">()</span>
<span class="go">4096</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span><span class="o">/</span><span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span><span class="o">.</span><span class="n">discriminant</span><span class="p">()</span>
<span class="go">4096</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.S">
<span class="sig-name descname"><span class="pre">S</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.S" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of intervals <span class="math notranslate nohighlight">\(S^{(v)}(\xi_1,\xi_2)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi1,</span> <span class="pre">xi2</span></code> (real) – real numbers with <span class="math notranslate nohighlight">\(\xi_1\le\xi_2\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real embedding of the field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The union of intervals <span class="math notranslate nohighlight">\(S^{(v)}(\xi_1,\xi_2)\)</span> defined in <a class="reference internal" href="../../../../references/index.html#tho2010" id="id9"><span>[Tho2010]</span></a>
section 6.1.</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">([0.224512677391895, 0.274544821597130] U [0.725455178402870, 0.775487322608105])</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">([0.0781194447253472, 0.0823423732016403] U [0.917657626798360, 0.921880555274653])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.Sn">
<span class="sig-name descname"><span class="pre">Sn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.Sn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of intervals <span class="math notranslate nohighlight">\(S_n^{(v)}(\xi_1,\xi_2)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi1,</span> <span class="pre">xi2</span></code> (real) – real numbers with <span class="math notranslate nohighlight">\(\xi_1\le\xi_2\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code> (integer) – a positive integer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real embedding of the field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The union of intervals <span class="math notranslate nohighlight">\(S_n^{(v)}(\xi_1,\xi_2)\)</span> defined in <a class="reference internal" href="../../../../references/index.html#tho2010" id="id10"><span>[Tho2010]</span></a>
(Lemma 6.1).</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">Sn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">(([0.224512677391895, 0.274544821597130] U [0.725455178402870, 0.775487322608105]),</span>
<span class="go">([0.224512677391895, 0.274544821597130] U [0.725455178402870, 0.775487322608105]))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">Sn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">([0.0374187795653158, 0.0457574702661884] U [0.120909196400478, 0.129247887101351] U [0.204085446231982, 0.212424136932855] U [0.287575863067145, 0.295914553768017] U [0.370752112898649, 0.379090803599522] U [0.454242529733812, 0.462581220434684] U [0.537418779565316, 0.545757470266188] U [0.620909196400478, 0.629247887101351] U [0.704085446231982, 0.712424136932855] U [0.787575863067145, 0.795914553768017] U [0.870752112898649, 0.879090803599522] U [0.954242529733812, 0.962581220434684])</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">S</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">Sn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">(([0.142172065860075, 0.172845716928584] U [0.827154283071416, 0.857827934139925]),</span>
<span class="go">([0.142172065860075, 0.172845716928584] U [0.827154283071416, 0.857827934139925]))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">Sn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">([0.0236953443100124, 0.0288076194880974] U [0.137859047178569, 0.142971322356654] U [0.190362010976679, 0.195474286154764] U [0.304525713845236, 0.309637989023321] U [0.357028677643346, 0.362140952821431] U [0.471192380511903, 0.476304655689988] U [0.523695344310012, 0.528807619488097] U [0.637859047178569, 0.642971322356654] U [0.690362010976679, 0.695474286154764] U [0.804525713845236, 0.809637989023321] U [0.857028677643346, 0.862140952821431] U [0.971192380511903, 0.976304655689988])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.alpha">
<span class="sig-name descname"><span class="pre">alpha</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constant <span class="math notranslate nohighlight">\(\alpha_v\)</span> associated to the embedding <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> – an embedding of the base field into <span class="math notranslate nohighlight">\(\RR\)</span> or <span class="math notranslate nohighlight">\(\CC\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>The constant <span class="math notranslate nohighlight">\(\alpha_v\)</span>.  In the notation of <a class="reference internal" href="../../../../references/index.html#cps2006" id="id11"><span>[CPS2006]</span></a> and
<a class="reference internal" href="../../../../references/index.html#tho2010" id="id12"><span>[Tho2010]</span></a> (section 3.2), <span class="math notranslate nohighlight">\(\alpha_v^3=\epsilon_v\)</span>.  The result is
cached since it only depends on the curve.</p>
<p>EXAMPLES:</p>
<p>Example 1 from <a class="reference internal" href="../../../../references/index.html#cps2006" id="id13"><span>[CPS2006]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">alpha</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">alpha</span>
<span class="go">1.12272013439355</span>
</pre></div>
</div>
<p>Compare with <span class="math notranslate nohighlight">\(\log(\epsilon_v)=0.344562...\)</span> in <a class="reference internal" href="../../../../references/index.html#cps2006" id="id14"><span>[CPS2006]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mi">3</span><span class="o">*</span><span class="n">alpha</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">0.347263296676126</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.base_field">
<span class="sig-name descname"><span class="pre">base_field</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.base_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.complex_intersection_is_empty">
<span class="sig-name descname"><span class="pre">complex_intersection_is_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Bk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.complex_intersection_is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True iff an intersection of <span class="math notranslate nohighlight">\(T_n^{(v)}\)</span> sets is empty.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bk</span></code> (list) – a list of reals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a complex embedding of the number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean, default False) – verbosity flag.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_half</span></code> (boolean, default False) – if True, use only half
the fundamental region.</p></li>
</ul>
<p>OUTPUT:</p>
<p>True or False, according as the intersection of the unions of
intervals <span class="math notranslate nohighlight">\(T_n^{(v)}(-b,b)\)</span> for <span class="math notranslate nohighlight">\(b\)</span> in the list <code class="docutils literal notranslate"><span class="pre">Bk</span></code> (see
<a class="reference internal" href="../../../../references/index.html#tho2010" id="id15"><span>[Tho2010]</span></a>, section 7) is empty or not.  When <code class="docutils literal notranslate"><span class="pre">Bk</span></code> is the list of
<span class="math notranslate nohighlight">\(b=\sqrt{B_n(\mu)}\)</span> for <span class="math notranslate nohighlight">\(n=1,2,3,\dots\)</span> for some <span class="math notranslate nohighlight">\(\mu&gt;0\)</span> this
means that all non-torsion points on <span class="math notranslate nohighlight">\(E\)</span> with everywhere good
reduction have canonical height strictly greater than <span class="math notranslate nohighlight">\(\mu\)</span>,
by <a class="reference internal" href="../../../../references/index.html#tho2010" id="id16"><span>[Tho2010]</span></a>, Proposition 7.8.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">complex_embeddings</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
</pre></div>
</div>
<p>The following two lines prove that the heights of non-torsion
points on <span class="math notranslate nohighlight">\(E\)</span> with everywhere good reduction have canonical
height strictly greater than 0.02, but fail to prove the same
for 0.03.  For the first proof, using only <span class="math notranslate nohighlight">\(n=1,2,3\)</span> is not
sufficient:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">complex_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.02</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]],</span><span class="n">v</span><span class="p">)</span> <span class="c1"># long time (~6s)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">complex_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.02</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">complex_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.03</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span><span class="n">v</span><span class="p">)</span> <span class="c1"># long time (4s)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Using <span class="math notranslate nohighlight">\(n\le6\)</span> enables us to prove the lower bound 0.03.  Note
that it takes longer when the result is <code class="docutils literal notranslate"><span class="pre">False</span></code> than when it
is <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">complex_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.03</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">1..6</span><span class="p">]],</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.curve">
<span class="sig-name descname"><span class="pre">curve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.e_p">
<span class="sig-name descname"><span class="pre">e_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.e_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the exponent of the group over the residue field at <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime ideal of <span class="math notranslate nohighlight">\(K\)</span> (or a prime number if <span class="math notranslate nohighlight">\(K=\QQ\)</span>).</p></li>
</ul>
<p>OUTPUT:</p>
<p>A positive integer <span class="math notranslate nohighlight">\(e_p\)</span>, the exponent of the group of
nonsingular points on the reduction of the elliptic curve
modulo <span class="math notranslate nohighlight">\(p\)</span>.  The result is cached.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">e_p</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">e_p</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">e_p</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">2^10 * 20921</span>
<span class="gp">sage: </span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">20921</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="go">Local data at Fractional ideal (-40*i + 139):</span>
<span class="go">Reduction type: bad split multiplicative</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">e_p</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
<span class="go">20920</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">local_data</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="go">Local data at Fractional ideal (40*i + 139):</span>
<span class="go">Reduction type: good</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">e_p</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span>
<span class="go">20815</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.fk_intervals">
<span class="sig-name descname"><span class="pre">fk_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N=20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">domain=Complex</span> <span class="pre">Interval</span> <span class="pre">Field</span> <span class="pre">with</span> <span class="pre">53</span> <span class="pre">bits</span> <span class="pre">of</span> <span class="pre">precision</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.fk_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function approximating the Weierstrass function, with error.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – an embedding of the number field.  If
None (default) use the real embedding if the field is <span class="math notranslate nohighlight">\(\QQ\)</span>
and raise an error for other fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (int) – The number of terms to use in the
<span class="math notranslate nohighlight">\(q\)</span>-expansion of <span class="math notranslate nohighlight">\(\wp\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">domain</span></code> (complex field) – the model of <span class="math notranslate nohighlight">\(\CC\)</span> to use, for
example <code class="docutils literal notranslate"><span class="pre">CDF</span></code> of <code class="docutils literal notranslate"><span class="pre">CIF</span></code> (default).</p></li>
</ul>
<p>OUTPUT:</p>
<p>A pair of functions fk, err which can be evaluated at complex
numbers <span class="math notranslate nohighlight">\(z\)</span> (in the correct <code class="docutils literal notranslate"><span class="pre">domain</span></code>) to give an
approximation to <span class="math notranslate nohighlight">\(\wp(z)\)</span> and an upper bound on the error,
respectively.  The Weierstrass function returned is with
respect to the normalised lattice <span class="math notranslate nohighlight">\([1,\tau]\)</span> associated to the
given embedding.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
</pre></div>
</div>
<p>Compare the value give by the standard elliptic exponential
(scaled since <code class="docutils literal notranslate"><span class="pre">fk</span></code> is with respect to the normalised
lattice):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w2</span> <span class="o">**</span> <span class="mi">2</span>
<span class="go">-1.82543539306049 - 2.49336319992847*I</span>
</pre></div>
</div>
<p>to the value given by this function, and see the error:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fk</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">fk_intervals</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fk</span><span class="p">(</span><span class="n">CIF</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">-1.82543539306049? - 2.49336319992847?*I</span>
<span class="gp">sage: </span><span class="n">err</span><span class="p">(</span><span class="n">CIF</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">2.71750621458744e-31</span>
</pre></div>
</div>
<p>The same, but in the domain <code class="docutils literal notranslate"><span class="pre">CDF</span></code> instead of <code class="docutils literal notranslate"><span class="pre">CIF</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fk</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">fk_intervals</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">domain</span><span class="o">=</span><span class="n">CDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fk</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">-1.8254353930604... - 2.493363199928...*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.min" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a lower bound for all points of infinite order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tol</span></code> – tolerance in output (see below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_max</span></code> – how many multiples to use in iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean, default False) – verbosity flag.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A positive real <span class="math notranslate nohighlight">\(\mu\)</span> for which it has been established
rigorously that every point of infinite order on the elliptic
curve (defined over its ground field) has canonical height
greater than <span class="math notranslate nohighlight">\(\mu\)</span>, and such that it is not possible (at least
without increasing <code class="docutils literal notranslate"><span class="pre">n_max</span></code>) to prove the same for
<span class="math notranslate nohighlight">\(\mu\cdot\text{tol}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Example 1 from <a class="reference internal" href="../../../../references/index.html#cs2006" id="id17"><span>[CS2006]</span></a> (where the same lower bound of 0.1126 was
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">421152067</span><span class="p">,</span> <span class="mi">105484554028056</span><span class="p">])</span> <span class="c1"># 60490d1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">.0001</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">0.0011263287309893311</span>
</pre></div>
</div>
<p>Example 10.1 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id18"><span>[Tho2010]</span></a> (where a lower bound of 0.18 was
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">91</span><span class="o">-</span><span class="mi">26</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">144</span><span class="o">-</span><span class="mi">323</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># long time (8.1s)</span>
<span class="go">0.1621049443313762</span>
</pre></div>
</div>
<p>Example 10.2 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id19"><span>[Tho2010]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># long time (4s)</span>
<span class="go">0.020153685521979152</span>
</pre></div>
</div>
<p>In this example the point <span class="math notranslate nohighlight">\(P=(0,0)\)</span> has height 0.023 so our
lower bound is quite good:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0230242154471211</span>
</pre></div>
</div>
<p>Example 10.3 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id20"><span>[Tho2010]</span></a> (where the same bound of 0.0625 is
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># long time (7s)</span>
<span class="go">0.0625</span>
</pre></div>
</div>
<p>More examples over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">.01</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">0.03987318057488725</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0511114082399688</span>
</pre></div>
</div>
<p>After base change the lower bound can decrease:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># long time (8s)</span>
<span class="go">0.04419417382415922</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">h</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">0.05731275270029196</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()]</span>
<span class="go">[0.686667083305587, 0.327000773651605]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.min_gr">
<span class="sig-name descname"><span class="pre">min_gr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.min_gr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a lower bound for points of infinite order with good reduction.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">tol</span></code> – tolerance in output (see below).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n_max</span></code> – how many multiples to use in iteration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean, default False) – verbosity flag.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A positive real <span class="math notranslate nohighlight">\(\mu\)</span> for which it has been established
rigorously that every point of infinite order on the elliptic
curve (defined over its ground field), which has good
reduction at all primes, has canonical height greater than
<span class="math notranslate nohighlight">\(\mu\)</span>, and such that it is not possible (at least without
increasing <code class="docutils literal notranslate"><span class="pre">n_max</span></code>) to prove the same for
<span class="math notranslate nohighlight">\(\mu\cdot\text{tol}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Example 1 from <a class="reference internal" href="../../../../references/index.html#cs2006" id="id21"><span>[CS2006]</span></a> (where a lower bound of 1.9865 was
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">421152067</span><span class="p">,</span> <span class="mi">105484554028056</span><span class="p">])</span> <span class="c1"># 60490d1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">min_gr</span><span class="p">(</span><span class="mf">.0001</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">1.98684388146518</span>
</pre></div>
</div>
<p>Example 10.1 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id22"><span>[Tho2010]</span></a> (where a lower bound of 0.18 was
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">91</span><span class="o">-</span><span class="mi">26</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="mi">144</span><span class="o">-</span><span class="mi">323</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min_gr</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># long time (8.1s)</span>
<span class="go">0.1621049443313762</span>
</pre></div>
</div>
<p>Example 10.2 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id23"><span>[Tho2010]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="o">-</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min_gr</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">0.020153685521979152</span>
</pre></div>
</div>
<p>In this example the point <span class="math notranslate nohighlight">\(P=(0,0)\)</span> has height 0.023 so our
lower bound is quite good:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">0.0230242154471211</span>
</pre></div>
</div>
<p>Example 10.3 from <a class="reference internal" href="../../../../references/index.html#tho2010" id="id24"><span>[Tho2010]</span></a> (where the same bound of 0.25 is
given):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">min_gr</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># long time (7.2s)</span>
<span class="go">0.25</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.psi">
<span class="sig-name descname"><span class="pre">psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.psi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normalised elliptic log of a point with this x-coordinate.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">xi</span></code> (real) – the real x-coordinate of a point on the
curve in the connected component with respect to a real
embedding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real embedding of the number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A real number in the interval [0.5,1] giving the elliptic
logarithm of a point on <span class="math notranslate nohighlight">\(E\)</span> with <span class="math notranslate nohighlight">\(x\)</span>-coordinate <code class="docutils literal notranslate"><span class="pre">xi</span></code>, on the
connected component with respect to the embedding <span class="math notranslate nohighlight">\(v\)</span>, scaled
by the real period.</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">1.53151606047462</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span>
<span class="go">0.615014189772115</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="mi">10</span><span class="o">/</span><span class="mi">9</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">0.615014189772115</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">3.51086196882538</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">/</span> <span class="n">L</span><span class="o">.</span><span class="n">real_period</span><span class="p">()</span>
<span class="go">0.867385122699931</span>
<span class="gp">sage: </span><span class="n">xP</span> <span class="o">=</span> <span class="n">v</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">xy</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="n">xP</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">0.867385122699931</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">psi</span><span class="p">(</span><span class="mf">1.23</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">0.785854718241495</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.real_intersection_is_empty">
<span class="sig-name descname"><span class="pre">real_intersection_is_empty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Bk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.real_intersection_is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True iff an intersection of <span class="math notranslate nohighlight">\(S_n^{(v)}\)</span> sets is empty.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bk</span></code> (list) – a list of reals.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real embedding of the number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>True or False, according as the intersection of the unions of
intervals <span class="math notranslate nohighlight">\(S_n^{(v)}(-b,b)\)</span> for <span class="math notranslate nohighlight">\(b\)</span> in the list <code class="docutils literal notranslate"><span class="pre">Bk</span></code> is
empty or not.  When <code class="docutils literal notranslate"><span class="pre">Bk</span></code> is the list of <span class="math notranslate nohighlight">\(b=B_n(\mu)\)</span> for
<span class="math notranslate nohighlight">\(n=1,2,3,\dots\)</span> for some <span class="math notranslate nohighlight">\(\mu&gt;0\)</span> this means that all
non-torsion points on <span class="math notranslate nohighlight">\(E\)</span> with everywhere good reduction have
canonical height strictly greater than <span class="math notranslate nohighlight">\(\mu\)</span>, by <a class="reference internal" href="../../../../references/index.html#tho2010" id="id25"><span>[Tho2010]</span></a>,
Proposition 6.2.</p>
<p>EXAMPLES:</p>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
</pre></div>
</div>
<p>The following two lines prove that the heights of non-torsion
points on <span class="math notranslate nohighlight">\(E\)</span> with everywhere good reduction have canonical
height strictly greater than 0.2, but fail to prove the same
for 0.3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">real_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">real_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.3</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)],</span><span class="n">v</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>An example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">real_places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
</pre></div>
</div>
<p>The following two lines prove that the heights of non-torsion
points on <span class="math notranslate nohighlight">\(E\)</span> with everywhere good reduction have canonical
height strictly greater than 0.07, but fail to prove the same
for 0.08:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">real_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.07</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)],</span><span class="n">v</span><span class="p">)</span> <span class="c1"># long time (3.3s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">real_intersection_is_empty</span><span class="p">([</span><span class="n">H</span><span class="o">.</span><span class="n">B</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mf">0.08</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">srange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)],</span><span class="n">v</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.tau">
<span class="sig-name descname"><span class="pre">tau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the normalised upper half-plane parameter <span class="math notranslate nohighlight">\(\tau\)</span> for
the period lattice with respect to the embedding <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real or complex embedding of the number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(Complex) <span class="math notranslate nohighlight">\(\tau = \omega_1/\omega_2\)</span> in the fundamental region
of the upper half-plane.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">tau</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">1.22112736076463*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.test_mu">
<span class="sig-name descname"><span class="pre">test_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.test_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if we can prove that <span class="math notranslate nohighlight">\(\mu\)</span> is a lower bound.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code> (real) – a positive real number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (integer) – upper bound on the multiples to be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> (boolean, default True) – verbosity flag.</p></li>
</ul>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>, according to whether we succeed in
proving that <span class="math notranslate nohighlight">\(\mu\)</span> is a lower bound for the canonical heights
of points of infinite order with everywhere good reduction.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A <code class="docutils literal notranslate"><span class="pre">True</span></code> result is rigorous; <code class="docutils literal notranslate"><span class="pre">False</span></code> only means that
the attempt failed: trying again with larger <span class="math notranslate nohighlight">\(N\)</span> may yield
<code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
</pre></div>
</div>
<p>This curve does have a point of good reduction whose canonical
point is approximately 1.68:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">(</span><span class="n">lim3</span><span class="o">=</span><span class="mi">5</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span> <span class="n">P</span>
<span class="go">(1/3*a^2 + a + 5/3 : -2*a^2 - 4/3*a - 5/3 : 1)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
<span class="go">1.68038085233673</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">has_good_reduction</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Using <span class="math notranslate nohighlight">\(N=5\)</span> we can prove that 0.1 is a lower bound (in fact we
only need <span class="math notranslate nohighlight">\(N=2\)</span>), but not that 0.2 is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">test_mu</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">B_1(0.100000000000000) = 1.51580969677387</span>
<span class="go">B_2(0.100000000000000) = 0.932072561526720</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">test_mu</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">B_1(0.200000000000000) = 2.04612906979932</span>
<span class="go">B_2(0.200000000000000) = 3.09458988474327</span>
<span class="go">B_3(0.200000000000000) = 27.6251108409484</span>
<span class="go">B_4(0.200000000000000) = 1036.24722370223</span>
<span class="go">B_5(0.200000000000000) = 3.67090854562318e6</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Since 0.1 is a lower bound we can deduce that the point <span class="math notranslate nohighlight">\(P\)</span> is
either primitive or divisible by either 2 or 3.  In fact it is
primitive:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">height</span><span class="p">()</span><span class="o">/</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">4.09924487233530</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">division_points</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_c">
<span class="sig-name descname"><span class="pre">wp_c</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a bound for the Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – a real or complex embedding of the number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>(Real) <span class="math notranslate nohighlight">\(c&gt;0\)</span> such that</p>
<div class="math notranslate nohighlight">
\[|\wp(z) - z^-2| \le \frac{c^2|z|^2}{1-c|z|^2}\]</div>
<p>whenever <span class="math notranslate nohighlight">\(c|z|^2&lt;1\)</span>. Given the recurrence relations for the
Laurent series expansion of <span class="math notranslate nohighlight">\(\wp\)</span>, it is easy to see that
there is such a constant <span class="math notranslate nohighlight">\(c\)</span>.  [Reference?]</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">wp_c</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.68744508779950</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;=</span><span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span><span class="p">,</span><span class="mi">3</span><span class="o">+</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">wp_c</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">2.66213425640096</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_intervals">
<span class="sig-name descname"><span class="pre">wp_intervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function approximating the Weierstrass function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – an embedding of the number field.  If
None (default) use the real embedding if the field is <span class="math notranslate nohighlight">\(\QQ\)</span>
and raise an error for other fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (int, default 20) – The number of terms to use in the
<span class="math notranslate nohighlight">\(q\)</span>-expansion of <span class="math notranslate nohighlight">\(\wp\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">abs_only</span></code> (boolean, default False) – flag to determine
whether (if True) the error adjustment should use the
absolute value or (if False) the real and imaginary parts.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A function wp which can be evaluated at complex numbers <span class="math notranslate nohighlight">\(z\)</span> to
give an approximation to <span class="math notranslate nohighlight">\(\wp(z)\)</span>.  The Weierstrass function
returned is with respect to the normalised lattice <span class="math notranslate nohighlight">\([1,\tau]\)</span>
associated to the given embedding.  For <span class="math notranslate nohighlight">\(z\)</span> which are not near
a lattice point the function <code class="docutils literal notranslate"><span class="pre">fk</span></code> is used, otherwise a
better approximation is used.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">wp</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span><span class="o">.</span><span class="n">wp_intervals</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">wp</span><span class="p">(</span><span class="n">CIF</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">-1.82543539306049? - 2.4933631999285?*I</span>

<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">period_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">normalised_basis</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w2</span><span class="o">^</span><span class="mi">2</span>
<span class="go">-1.82543539306049 - 2.49336319992847*I</span>

<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">CDF</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">wp</span><span class="p">(</span><span class="n">CIF</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">8.5918243572165? - 5.4751982004351?*I</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">elliptic_exponential</span><span class="p">(</span><span class="n">z</span><span class="o">*</span><span class="n">w2</span><span class="p">,</span> <span class="n">to_curve</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">w2</span><span class="o">^</span><span class="mi">2</span>
<span class="go">8.59182435721650 - 5.47519820043503*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_on_grid">
<span class="sig-name descname"><span class="pre">wp_on_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.EllipticCurveCanonicalHeight.wp_on_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of the values of <span class="math notranslate nohighlight">\(\wp\)</span> on an <span class="math notranslate nohighlight">\(N\times N\)</span> grid.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">v</span></code> (embedding) – an embedding of the number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> (int) – The number of terms to use in the
<span class="math notranslate nohighlight">\(q\)</span>-expansion of <span class="math notranslate nohighlight">\(\wp\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">half</span></code> (boolean, default False) – if True, use an array of
size <span class="math notranslate nohighlight">\(N\times N/2\)</span> instead of <span class="math notranslate nohighlight">\(N\times N\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An array of size either <span class="math notranslate nohighlight">\(N\times N/2\)</span> or <span class="math notranslate nohighlight">\(N\times N\)</span> whose
<span class="math notranslate nohighlight">\((i,j)\)</span> entry is the value of the Weierstrass <span class="math notranslate nohighlight">\(\wp\)</span>-function
at <span class="math notranslate nohighlight">\((i+.5)/N + (j+.5)*\tau/N\)</span>, a grid of points in the
fundamental region for the lattice <span class="math notranslate nohighlight">\([1,\tau]\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">height_function</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">.</span><span class="n">places</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>The array of values on the grid shows symmetry, since <span class="math notranslate nohighlight">\(\wp\)</span> is
even:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">wp_on_grid</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">array([[25.43920182,  5.28760943,  5.28760943, 25.43920182],</span>
<span class="go">       [ 6.05099485,  1.83757786,  1.83757786,  6.05099485],</span>
<span class="go">       [ 6.05099485,  1.83757786,  1.83757786,  6.05099485],</span>
<span class="go">       [25.43920182,  5.28760943,  5.28760943, 25.43920182]])</span>
</pre></div>
</div>
<p>The array of values on the half-grid:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">wp_on_grid</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
<span class="go">array([[25.43920182,  5.28760943],</span>
<span class="go">       [ 6.05099485,  1.83757786],</span>
<span class="go">       [ 6.05099485,  1.83757786],</span>
<span class="go">       [25.43920182,  5.28760943]])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">UnionOfIntervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endpoints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class representing a finite union of closed intervals in
<span class="math notranslate nohighlight">\(\RR\)</span> which can be scaled, shifted, intersected, etc.</p>
<p>The intervals are represented as an ordered list of their
endpoints, which may include <span class="math notranslate nohighlight">\(-\infty\)</span> and <span class="math notranslate nohighlight">\(+\infty\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">infinity</span><span class="p">]);</span> <span class="n">R</span>
<span class="go">([1, 2] U [3, +Infinity])</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">+</span> <span class="mi">5</span>
<span class="go">([6, 7] U [8, +Infinity])</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">R</span>
<span class="go">([-Infinity, 1] U [2, 3])</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">R</span> <span class="o">|</span> <span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">R</span> <span class="o">+</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">([-Infinity, 1] U [2, 3] U [110, 120] U [130, +Infinity])</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="id26">
<p class="admonition-title">Todo</p>
<p>Unify <a class="reference internal" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals" title="sage.schemes.elliptic_curves.height.UnionOfIntervals"><code class="xref py py-class docutils literal notranslate"><span class="pre">UnionOfIntervals</span></code></a> with the class <code class="docutils literal notranslate"><span class="pre">RealSet</span></code>
introduced by <a class="reference external" href="https://trac.sagemath.org/13125">trac ticket #13125</a>; see <a class="reference external" href="https://trac.sagemath.org/16063">trac ticket #16063</a>.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.finite_endpoints">
<span class="sig-name descname"><span class="pre">finite_endpoints</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.finite_endpoints" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the finite endpoints of this union of intervals.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">finite_endpoints</span><span class="p">()</span>
<span class="go">[0, 1]</span>
<span class="gp">sage: </span><span class="n">UnionOfIntervals</span><span class="p">([</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">infinity</span><span class="p">])</span><span class="o">.</span><span class="n">finite_endpoints</span><span class="p">()</span>
<span class="go">[0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.intersection">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">intersection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.intersection" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the intersection of a list of UnionOfIntervals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">L</span></code> (list) – a list of UnionOfIntervals instances</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new UnionOfIntervals instance representing the intersection
of the UnionOfIntervals in the list.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a class method.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">([1, 3] U [5, 7])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">B</span>
<span class="go">([2, 4] U [6, 8])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">intersection</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">])</span>
<span class="go">([2, 3] U [6, 7])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.intervals">
<span class="sig-name descname"><span class="pre">intervals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the intervals in self, as a list of 2-tuples.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">UnionOfIntervals</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)))</span><span class="o">.</span><span class="n">intervals</span><span class="p">()</span>
<span class="go">[(0, 1), (2, 3), (4, 5), (6, 7), (8, 9)]</span>
<span class="gp">sage: </span><span class="n">UnionOfIntervals</span><span class="p">([</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="n">infinity</span><span class="p">])</span><span class="o">.</span><span class="n">intervals</span><span class="p">()</span>
<span class="go">[(-Infinity, pi), (17, +Infinity)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.is_empty">
<span class="sig-name descname"><span class="pre">is_empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.is_empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether self is empty.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="nb">all</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="o">-</span><span class="n">infinity</span><span class="p">,</span> <span class="n">infinity</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">~</span><span class="nb">all</span><span class="p">)</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="o">&amp;</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_empty</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.join">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.join" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility function to form the union or intersection of a list of UnionOfIntervals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">L</span></code> (list) – a list of UnionOfIntervals instances</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">condition</span></code> (function) – either <code class="docutils literal notranslate"><span class="pre">any</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span></code>, or
some other boolean function of a list of boolean values.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new UnionOfIntervals instance representing the subset of
‘RR’ equal to those reals in any/all/condition of the
UnionOfIntervals in the list.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a static method for the class.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">([1, 3] U [5, 7])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">B</span>
<span class="go">([2, 4] U [6, 8])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">],</span><span class="nb">any</span><span class="p">)</span> <span class="c1"># union</span>
<span class="go">([1, 4] U [5, 8])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">],</span><span class="nb">all</span><span class="p">)</span> <span class="c1"># intersection</span>
<span class="go">([2, 3] U [6, 7])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">],</span><span class="nb">sum</span><span class="p">)</span> <span class="c1"># symmetric difference</span>
<span class="go">([1, 2] U [3, 4] U [5, 6] U [7, 8])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.UnionOfIntervals.union">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">union</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.UnionOfIntervals.union" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the union of a list of UnionOfIntervals.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">L</span></code> (list) – a list of UnionOfIntervals instances</p></li>
</ul>
<p>OUTPUT:</p>
<p>A new UnionOfIntervals instance representing the union of the
UnionOfIntervals in the list.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a class method.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">([1, 3] U [5, 7])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span> <span class="n">B</span>
<span class="go">([2, 4] U [6, 8])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">union</span><span class="p">([</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">])</span>
<span class="go">([1, 4] U [5, 8])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.eps">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_real</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.eps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Real or Complex interval centered on 0 with radius err.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">err</span></code> (real) – a positive real number, the radius of the interval</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_real</span></code> (boolean) – if True, returns a real interval in
RIF, else a complex interval in CIF</p></li>
</ul>
<p>OUTPUT:</p>
<p>An element of RIF or CIF (as specified), centered on 0, with given radius.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">eps</span>
<span class="gp">sage: </span><span class="n">eps</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">0.0?</span>
<span class="gp">sage: </span><span class="n">eps</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">0.0? + 0.0?*I</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.inf_max_abs">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">inf_max_abs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">D</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.inf_max_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(\inf_D(\max(|f|, |g|))\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code> (polynomials) – real univariate polynomials</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> (UnionOfIntervals) – a subset of <span class="math notranslate nohighlight">\(\RR\)</span></p></li>
</ul>
<p>OUTPUT:</p>
<p>A real number approximating the value of <span class="math notranslate nohighlight">\(\inf_D(\max(|f|, |g|))\)</span>.</p>
<p>ALGORITHM:</p>
<p>The extreme values must occur at an endpoint of a subinterval of
<span class="math notranslate nohighlight">\(D\)</span> or at a point where one of <span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(f'\)</span>, <span class="math notranslate nohighlight">\(g\)</span>, <span class="math notranslate nohighlight">\(g'\)</span>, <span class="math notranslate nohighlight">\(f\pm g\)</span> is
zero.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">inf_max_abs</span><span class="p">,</span> <span class="n">UnionOfIntervals</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">100</span>
<span class="gp">sage: </span><span class="n">inf_max_abs</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">UnionOfIntervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]))</span>
<span class="go">425.638201706391</span>
<span class="gp">sage: </span><span class="n">r0</span> <span class="o">=</span> <span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">r0</span>
<span class="go">5.46053402234697</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">r0</span><span class="p">)),</span><span class="nb">abs</span><span class="p">(</span><span class="n">g</span><span class="p">(</span><span class="n">r0</span><span class="p">)))</span>
<span class="go">425.638201706391</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.min_on_disk">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">min_on_disk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.min_on_disk" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum of a real-valued complex function on a square.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – a function from CIF to RIF</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tol</span></code> (real) – a positive real number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code> (integer, default 10000) – a positive integer
bounding the number of iterations to be used</p></li>
</ul>
<p>OUTPUT:</p>
<p>A 2-tuple <span class="math notranslate nohighlight">\((s,t)\)</span>, where <span class="math notranslate nohighlight">\(t=f(s)\)</span> and <span class="math notranslate nohighlight">\(s\)</span> is a CIF element
contained in the disk <span class="math notranslate nohighlight">\(|z|\le1\)</span>, at which <span class="math notranslate nohighlight">\(f\)</span> takes its minimum
value.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">min_on_disk</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span> <span class="n">t</span> <span class="o">=</span> <span class="n">min_on_disk</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">t</span>
<span class="go">(0.01? + 1.00?*I, 99.01?, 99.0000000000000)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.nonneg_region">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">nonneg_region</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.nonneg_region" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the UnionOfIntervals representing the region where <code class="docutils literal notranslate"><span class="pre">f</span></code> is non-negative.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> (polynomial) – a univariate polynomial over <span class="math notranslate nohighlight">\(\RR\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A UnionOfIntervals representing the set <span class="math notranslate nohighlight">\(\{x \in\RR mid f(x) \ge 0\}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">nonneg_region</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">([-Infinity, -1.00000000000000] U [1.00000000000000, +Infinity])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">([-1.00000000000000, 1.00000000000000])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="go">([-Infinity, 1.00000000000000])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">([1.00000000000000, +Infinity])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">([-Infinity, 1.00000000000000] U [2.00000000000000, +Infinity])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="go">([1.00000000000000, 2.00000000000000])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">([1.00000000000000, 2.00000000000000] U [3.00000000000000, +Infinity])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">3</span><span class="p">))</span>
<span class="go">([-Infinity, 1.00000000000000] U [2.00000000000000, 3.00000000000000])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="go">([-Infinity, +Infinity])</span>
<span class="gp">sage: </span><span class="n">nonneg_region</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.height.rat_term_CIF">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.height.</span></span><span class="sig-name descname"><span class="pre">rat_term_CIF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.height.rat_term_CIF" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of <span class="math notranslate nohighlight">\(u/(1-u)^2\)</span> in <code class="docutils literal notranslate"><span class="pre">CIF</span></code>, where <span class="math notranslate nohighlight">\(u=\exp(2\pi i z)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">z</span></code> (complex) – a CIF element</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">try_strict</span></code> (bool) – flag</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.height</span> <span class="kn">import</span> <span class="n">rat_term_CIF</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">CIF</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rat_term_CIF</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="go">-0.172467461182437? + 0.?e-16*I</span>
<span class="gp">sage: </span><span class="n">rat_term_CIF</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="go">-0.172467461182437? + 0.?e-16*I</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="ell_number_field.html"
                          title="previous chapter">Elliptic curves over number fields</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="saturation.html"
                          title="next chapter">Saturation of Mordell-Weil groups of elliptic curves over number fields</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/elliptic_curves/height.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="saturation.html" title="Saturation of Mordell-Weil groups of elliptic curves over number fields"
             >next</a> |</li>
        <li class="right" >
          <a href="ell_number_field.html" title="Elliptic curves over number fields"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">Elliptic curves</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Canonical heights for elliptic curves over number fields</a></li> 
      </ul>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
  </script>
  <script type="text/javascript">
/* detex the document title by removing "\(", "\)", "\", "$" */
document.title = document.title.replace(/\\\(/g, '').replace(/\\\)/g, '').replace(/\\/g, '').replace(/\$/g, '');
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>