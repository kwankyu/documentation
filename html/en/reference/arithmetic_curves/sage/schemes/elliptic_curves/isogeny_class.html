
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Isogeny class of elliptic curves over number fields &#8212; Elliptic curves</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/thebelab.css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Tate-Shafarevich group" href="sha_tate.html" />
    <link rel="prev" title="Galois representations for elliptic curves over number fields" href="gal_reps_number_field.html" />
  <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
  <!-- <script src="../../../../_static/thebe.js" type="text/javascript"></script> -->
  <!-- <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script> -->

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sha_tate.html" title="Tate-Shafarevich group"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gal_reps_number_field.html" title="Galois representations for elliptic curves over number fields"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">Elliptic curves</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Isogeny class of elliptic curves over number fields</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="isogeny-class-of-elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-isogeny-class"></span><h1>Isogeny class of elliptic curves over number fields<a class="headerlink" href="#isogeny-class-of-elliptic-curves-over-number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.isogeny_class"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>David Roe (2012-03-29) – initial version.</p></li>
<li><p>John Cremona (2014-08) – extend to number fields.</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.</span></span><span class="sig-name descname"><span class="pre">IsogenyClass_EC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Parents and Elements v9.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>Isogeny class of an elliptic curve.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The current implementation chooses a curve from each isomorphism
class in the isogeny class. Over <span class="math notranslate nohighlight">\(\QQ\)</span> this is a unique reduced
minimal model in each isomorphism class.  Over number fields the
model chosen may change in future.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.graph">
<span class="sig-name descname"><span class="pre">graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a graph whose vertices correspond to curves in this
class, and whose edges correspond to prime degree isogenies.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are only finitely many possible isogeny graphs for
curves over <span class="math notranslate nohighlight">\(\QQ\)</span> [Maz1978b].  This function tries to lay out
the graph nicely by special casing each isogeny graph.
This could also be done over other number fields, such as
quadratic fields.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The vertices are labeled 1 to n rather than 0 to n-1 to
match LMFDB and Cremona labels for curves over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">_pos</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
<span class="go">[(1, [-0.8660254, 0.5]), (2, [-0.8660254, 1.5]), (3, [-1.7320508, 0]), (4, [0, 0]), (5, [0, -1]), (6, [0.8660254, 0.5]), (7, [0.8660254, 1.5]), (8, [1.7320508, 0])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a curve in this class.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> – an elliptic curve in this isogeny class.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> – an integer so that the <code class="docutils literal notranslate"><span class="pre">i</span></code> th curve in the class
is isomorphic to <code class="docutils literal notranslate"><span class="pre">C</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;990j1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iso</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">(</span><span class="n">order</span><span class="o">=</span><span class="s2">&quot;lmfdb&quot;</span><span class="p">)</span> <span class="c1"># orders lexicographically on a-invariants</span>
<span class="gp">sage: </span><span class="n">iso</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">short_weierstrass_model</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.isogenies">
<span class="sig-name descname"><span class="pre">isogenies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.isogenies" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of lists of isogenies and 0s, corresponding to
the entries of <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">matrix()</span></code></a></p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> – boolean (default <code class="docutils literal notranslate"><span class="pre">False</span></code>).  Whether to only return
prime degree isogenies.  Currently only implemented for
<code class="docutils literal notranslate"><span class="pre">fill=False</span></code>.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of lists, where the <code class="docutils literal notranslate"><span class="pre">j</span></code> th entry of the <code class="docutils literal notranslate"><span class="pre">i</span></code> th list
is either zero or a prime degree isogeny from the <code class="docutils literal notranslate"><span class="pre">i</span></code> th curve
in this class to the <code class="docutils literal notranslate"><span class="pre">j</span></code> th curve.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The domains and codomains of the isogenies will have the same
Weierstrass equation as the curves in this class, but they
may not be identical python objects in the current
implementation.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">isogenies</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">];</span> <span class="n">f</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field to Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">f</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix whose entries give the minimal degrees of
isogenies between curves in this class.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fill</span></code> – boolean (default <code class="docutils literal notranslate"><span class="pre">True</span></code>).  If <code class="docutils literal notranslate"><span class="pre">False</span></code> then the
matrix will contain only zeros and prime entries; if <code class="docutils literal notranslate"><span class="pre">True</span></code> it
will fill in the other degrees.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isocls</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 1  2  2  2  4  4  8  8]</span>
<span class="go">[ 2  1  4  4  8  8 16 16]</span>
<span class="go">[ 2  4  1  4  8  8 16 16]</span>
<span class="go">[ 2  4  4  1  2  2  4  4]</span>
<span class="go">[ 4  8  8  2  1  4  8  8]</span>
<span class="go">[ 4  8  8  2  4  1  2  2]</span>
<span class="go">[ 8 16 16  4  8  2  1  4]</span>
<span class="go">[ 8 16 16  4  8  2  4  1]</span>
<span class="gp">sage: </span><span class="n">isocls</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[0 2 2 2 0 0 0 0]</span>
<span class="go">[2 0 0 0 0 0 0 0]</span>
<span class="go">[2 0 0 0 0 0 0 0]</span>
<span class="go">[2 0 0 0 2 2 0 0]</span>
<span class="go">[0 0 0 2 0 0 0 0]</span>
<span class="go">[0 0 0 2 0 0 2 2]</span>
<span class="go">[0 0 0 0 0 2 0 0]</span>
<span class="go">[0 0 0 0 0 2 0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.qf_matrix">
<span class="sig-name descname"><span class="pre">qf_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.qf_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the array whose entries are quadratic forms
representing the degrees of isogenies between curves in this
class (CM case only).</p>
<p>OUTPUT:</p>
<p>a <span class="math notranslate nohighlight">\(2x2\)</span> array (list of lists) of list, each of the form [2] or
[2,1,3] representing the coefficients of an integral quadratic
form in 1 or 2 variables whose values are the possible isogeny
degrees between the i’th and j’th curve in the class.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1480640</span><span class="o">+</span><span class="mi">565760</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">qf_matrix</span><span class="p">()</span>
<span class="go">[[[1], [2, 2, 3]], [[2, 2, 3], [1]]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.reorder">
<span class="sig-name descname"><span class="pre">reorder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC.reorder" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new isogeny class with the curves reordered.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code> – None, a string or an iterable over all curves
in this class.  See
<a class="reference internal" href="ell_rational_field.html#sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class" title="sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.schemes.elliptic_curves.ell_rational_field.EllipticCurve_rational_field.isogeny_class()</span></code></a>
for more details.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>Another <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC"><code class="xref py py-class docutils literal notranslate"><span class="pre">IsogenyClass_EC</span></code></a> with the curves reordered
(and matrices and maps changed as appropriate)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">isocls</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;15a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">isocls</span><span class="o">.</span><span class="n">curves</span><span class="p">))</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 10*x - 10 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + 35*x - 28 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 135*x - 660 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 110*x - 880 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 2160*x - 39540 over Rational Field</span>
<span class="gp">sage: </span><span class="n">isocls2</span> <span class="o">=</span> <span class="n">isocls</span><span class="o">.</span><span class="n">reorder</span><span class="p">(</span><span class="s1">&#39;lmfdb&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">isocls2</span><span class="o">.</span><span class="n">curves</span><span class="p">))</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 2160*x - 39540 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 135*x - 660 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 110*x - 880 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 80*x + 242 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 10*x - 10 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 - 5*x + 2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 over Rational Field</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + x^2 + 35*x - 28 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.</span></span><span class="sig-name descname"><span class="pre">IsogenyClass_EC_NumberField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reducible_primes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Billerey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minimal_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC</span></code></a></p>
<p>Isogeny classes for elliptic curves over number fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy (mostly used in reordering).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">C2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.</span></span><span class="sig-name descname"><span class="pre">IsogenyClass_EC_Rational</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sage'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField" title="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_NumberField</span></code></a></p>
<p>Isogeny classes for elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.IsogenyClass_EC_Rational.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a copy (mostly used in reordering).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="ow">is</span> <span class="n">C2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">C2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.isogeny_degrees_cm">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.</span></span><span class="sig-name descname"><span class="pre">isogeny_degrees_cm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.isogeny_degrees_cm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(\ell\)</span> sufficient to generate the
isogeny class of <span class="math notranslate nohighlight">\(E\)</span>, where <span class="math notranslate nohighlight">\(E\)</span> has CM.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – An elliptic curve defined over a number field.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A finite list of primes <span class="math notranslate nohighlight">\(\ell\)</span> such that every curve isogenous to
this curve can be obtained by a finite sequence of isogenies of
degree one of the primes in the list.</p>
<p>ALGORITHM:</p>
<p>For curves with CM by the order <span class="math notranslate nohighlight">\(O\)</span> of discriminant <span class="math notranslate nohighlight">\(d\)</span>, the
Galois representation is always non-surjective and the curve will
admit <span class="math notranslate nohighlight">\(\ell\)</span>-isogenies for infinitely many primes <span class="math notranslate nohighlight">\(\ell\)</span>, but
there are only finitely many codomains <span class="math notranslate nohighlight">\(E'\)</span>.  The primes can be
divided according to the discriminant <span class="math notranslate nohighlight">\(d'\)</span> of the CM order <span class="math notranslate nohighlight">\(O'\)</span>
associated to <span class="math notranslate nohighlight">\(E\)</span>: either <span class="math notranslate nohighlight">\(O=O'\)</span>, or one contains the other with
index <span class="math notranslate nohighlight">\(\ell\)</span>, since <span class="math notranslate nohighlight">\(\ell O\subset O'\)</span> and vice versa.</p>
<p>Case (1): <span class="math notranslate nohighlight">\(O=O'\)</span>.  The degrees of all isogenies between <span class="math notranslate nohighlight">\(E\)</span> and
<span class="math notranslate nohighlight">\(E'\)</span> are precisely the integers represented by one of the classes
of binary quadratic forms <span class="math notranslate nohighlight">\(Q\)</span> of discriminant <span class="math notranslate nohighlight">\(d\)</span>.  Hence to
obtain all possible isomorphism classes of codomain <span class="math notranslate nohighlight">\(E'\)</span>, we need
only use one prime <span class="math notranslate nohighlight">\(\ell\)</span> represented by each such class <span class="math notranslate nohighlight">\(Q\)</span>.  It
would in fact suffice to use primes represented by forms which
generate the class group.  Here we simply omit the principal class
and one from each pair of inverse classes, and include a prime
represented by each of the remaining forms.</p>
<p>Case (2): <span class="math notranslate nohighlight">\([O':O]=\ell\)</span>: so <span class="math notranslate nohighlight">\(d=\ell^2d;\)</span>.  We include all prime
divisors of <span class="math notranslate nohighlight">\(d\)</span>.</p>
<p>Case (3): <span class="math notranslate nohighlight">\([O:O']=\ell\)</span>: we may assume that <span class="math notranslate nohighlight">\(\ell\)</span> does not divide
<span class="math notranslate nohighlight">\(d\)</span> as we have already included these, so <span class="math notranslate nohighlight">\(\ell\)</span> either splits or
is inert in <span class="math notranslate nohighlight">\(O\)</span>; the class numbers satisfy <span class="math notranslate nohighlight">\(h(O')=(\ell\pm1)h(O)\)</span>
accordingly.  We include all primes <span class="math notranslate nohighlight">\(\ell\)</span> such that <span class="math notranslate nohighlight">\(\ell\pm1\)</span>
divides the degree <span class="math notranslate nohighlight">\([K:\QQ]\)</span>.</p>
<p>For curves with only potential CM we proceed as in the CM case,
using <span class="math notranslate nohighlight">\(2[K:\QQ]\)</span> instead of <span class="math notranslate nohighlight">\([K:\QQ]\)</span>.</p>
<p>EXAMPLES:</p>
<p>For curves with CM by a quadratic order of class number greater
than <span class="math notranslate nohighlight">\(1\)</span>, we use the structure of the class group to only give one
prime in each ideal class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.isogeny_class</span> <span class="kn">import</span> <span class="n">isogeny_degrees_cm</span>
<span class="gp">sage: </span><span class="n">isogeny_degrees_cm</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">CM case, discriminant = -23</span>
<span class="go">initial primes: {2}</span>
<span class="go">upward primes: {}</span>
<span class="go">downward ramified primes: {}</span>
<span class="go">downward split primes: {2, 3}</span>
<span class="go">downward inert primes: {5}</span>
<span class="go">primes generating the class group: [2]</span>
<span class="go">Complete set of primes: {2, 3, 5}</span>
<span class="go">[2, 3, 5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees">
<span class="sig-prename descclassname"><span class="pre">sage.schemes.elliptic_curves.isogeny_class.</span></span><span class="sig-name descname"><span class="pre">possible_isogeny_degrees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">E</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Billerey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_l</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(\ell\)</span> sufficient to generate the
isogeny class of <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code> – An elliptic curve defined over a number field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (string, default ‘Billerey’) – Algorithm to be
used for non-CM curves: either ‘Billerey’, ‘Larson’, or
‘heuristic’.  Only relevant for non-CM curves and base fields
other than <span class="math notranslate nohighlight">\(\QQ\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – only relevant for non-CM curves
and algorithms ‘Billerey’ and ‘heuristic.  Controls the maximum
prime used in either algorithm.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, use the default
for that algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code>) – only relevant for non-CM curves
and algorithm ‘Billerey’.  Controls the maximum number of primes
used in the algorithm.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, use the default for that
algorithm.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">exact</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">True</span></code>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code>, perform an
additional check that the primes returned are all reducible.  If
<code class="docutils literal notranslate"><span class="pre">False</span></code>, skip this step, in which case some of the primes
returned may be irreducible.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A finite list of primes <span class="math notranslate nohighlight">\(\ell\)</span> such that every curve isogenous to
this curve can be obtained by a finite sequence of isogenies of
degree one of the primes in the list.</p>
<p>ALGORITHM:</p>
<p>For curves without CM, the set may be taken to be the finite set
of primes at which the Galois representation is not surjective,
since the existence of an <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny is equivalent to the
image of the mod-<span class="math notranslate nohighlight">\(\ell\)</span> Galois representation being contained in a
Borel subgroup.  Two rigorous algorithms have been implemented to
determine this set, due to Larson and Billeray respectively.  We
also provide a non-rigorous ‘heuristic’ algorithm which only tests
reducible primes up to a bound depending on the degree of the
base field.</p>
<p>For curves with CM see the documentation for <a class="reference internal" href="#sage.schemes.elliptic_curves.isogeny_class.isogeny_degrees_cm" title="sage.schemes.elliptic_curves.isogeny_class.isogeny_degrees_cm"><code class="xref py py-meth docutils literal notranslate"><span class="pre">isogeny_degrees_cm()</span></code></a>.</p>
<p>EXAMPLES:</p>
<p>For curves without CM we determine the primes at which the mod <span class="math notranslate nohighlight">\(p\)</span>
Galois representation is reducible, i.e. contained in a Borel
subgroup:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.isogeny_class</span> <span class="kn">import</span> <span class="n">possible_isogeny_degrees</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Larson&#39;</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Billerey&#39;</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;heuristic&#39;</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>We check that in this case <span class="math notranslate nohighlight">\(E\)</span> really does have rational
<span class="math notranslate nohighlight">\(5\)</span>-isogenies:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
</pre></div>
</div>
<p>Over an extension field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E3</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E3</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E3</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
</pre></div>
</div>
<p>A higher degree example (LMFDB curve 5.5.170701.1-4.1-b1):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;heuristic&#39;</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Billerey&#39;</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Larson&#39;</span><span class="p">)</span>
<span class="go">[2]</span>
</pre></div>
</div>
<p>LMFDB curve 4.4.8112.1-108.1-a5:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">95</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">67</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Billerey&#39;</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;Larson&#39;</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;heuristic&#39;</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[2, 5]</span>
</pre></div>
</div>
<p>This function only returns the primes which are isogeny degrees:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Set</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogeny_class</span><span class="p">()</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">())</span>
<span class="go">{1, 2, 4, 5, 20, 10}</span>
</pre></div>
</div>
<p>For curves with CM by a quadratic order of class number greater
than <span class="math notranslate nohighlight">\(1\)</span>, we use the structure of the class group to only give one
prime in each ideal class:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">multiplicities</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.isogeny_class</span> <span class="kn">import</span> <span class="n">possible_isogeny_degrees</span>
<span class="gp">sage: </span><span class="n">possible_isogeny_degrees</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">CM case, discriminant = -23</span>
<span class="go">initial primes: {2}</span>
<span class="go">upward primes: {}</span>
<span class="go">downward ramified primes: {}</span>
<span class="go">downward split primes: {2, 3}</span>
<span class="go">downward inert primes: {5}</span>
<span class="go">primes generating the class group: [2]</span>
<span class="go">Complete set of primes: {2, 3, 5}</span>
<span class="go">[2, 3, 5]</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="gal_reps_number_field.html"
                          title="previous chapter">Galois representations for elliptic curves over number fields</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="sha_tate.html"
                          title="next chapter">Tate-Shafarevich group</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/elliptic_curves/isogeny_class.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="sha_tate.html" title="Tate-Shafarevich group"
             >next</a> |</li>
        <li class="right" >
          <a href="gal_reps_number_field.html" title="Galois representations for elliptic curves over number fields"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../../index.html">Elliptic curves</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Isogeny class of elliptic curves over number fields</a></li> 
      </ul>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
  </script>
  <script type="text/javascript">
/* detex the document title by removing "\(", "\)", "\", "$" */
document.title = document.title.replace(/\\\(/g, '').replace(/\\\)/g, '').replace(/\\/g, '').replace(/\$/g, '');
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>