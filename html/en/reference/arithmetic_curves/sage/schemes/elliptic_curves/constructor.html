
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="viewport" content="width=600, initial-scale=1">
    <title>Elliptic curve constructor &#8212; Sage 9.3 Reference Manual: Elliptic curves</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <script src="../../../../_static/language_data.js"></script>
    <script async="async" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Construct elliptic curves as Jacobians" href="jacobian.html" />
    <link rel="prev" title="Elliptic curves" href="../../../index.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="jacobian.html" title="Construct elliptic curves as Jacobians"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Elliptic curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.3 Reference Manual: Elliptic curves</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Elliptic curve constructor</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="elliptic-curve-constructor">
<span id="sage-schemes-elliptic-curves-constructor"></span><h1>Elliptic curve constructor<a class="headerlink" href="#elliptic-curve-constructor" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.constructor"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein (2005): Initial version</p></li>
<li><p>John Cremona (2008-01): EllipticCurve(j) fixed for all cases</p></li>
</ul>
<dl class="py class">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurveFactory">
<em class="property">class </em><code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurveFactory</code><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurveFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/factory.html#sage.structure.factory.UniqueFactory" title="(in Sage 9.3 Reference Manual: Parents and Elements v9.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.factory.UniqueFactory</span></code></a></p>
<p>Construct an elliptic curve.</p>
<p>In Sage, an elliptic curve is always specified by
(the coefficients of) a long Weierstrass equation</p>
<div class="math notranslate nohighlight">
\[y^2 + a_1 xy + a_3 y = x^3 + a_2 x^2 + a_4 x + a_6.\]</div>
<p>INPUT:</p>
<p>There are several ways to construct an elliptic curve:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve([a1,a2,a3,a4,a6])</span></code>: Elliptic curve with given
<span class="math notranslate nohighlight">\(a\)</span>-invariants. The invariants are coerced into a common parent.
If all are integers, they are coerced into the rational numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve([a4,a6])</span></code>: Same as above, but <span class="math notranslate nohighlight">\(a_1=a_2=a_3=0\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve(label)</span></code>: Returns the elliptic curve over <span class="math notranslate nohighlight">\(\QQ\)</span>
from the Cremona database with the given label. The label is a
string, such as <code class="docutils literal notranslate"><span class="pre">&quot;11a&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;37b2&quot;</span></code>. The letters in the
label <em>must</em> be lower case (Cremona’s new labeling).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve(R,</span> <span class="pre">[a1,a2,a3,a4,a6])</span></code>: Create the elliptic
curve over <span class="math notranslate nohighlight">\(R\)</span> with given <span class="math notranslate nohighlight">\(a\)</span>-invariants. Here <span class="math notranslate nohighlight">\(R\)</span> can be an
arbitrary commutative ring, although most functionality is only
implemented over fields.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve(j=j0)</span></code> or <code class="docutils literal notranslate"><span class="pre">EllipticCurve_from_j(j0)</span></code>: Return
an elliptic curve with <span class="math notranslate nohighlight">\(j\)</span>-invariant <code class="docutils literal notranslate"><span class="pre">j0</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve(polynomial)</span></code>: Read off the <span class="math notranslate nohighlight">\(a\)</span>-invariants from
the polynomial coefficients, see
<a class="reference internal" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_Weierstrass_polynomial" title="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_Weierstrass_polynomial"><code class="xref py py-func docutils literal notranslate"><span class="pre">EllipticCurve_from_Weierstrass_polynomial()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EllipticCurve(cubic,</span> <span class="pre">point)</span></code>: The elliptic curve defined by a
plane cubic (homogeneous polynomial in three variables), with a
rational point.</p></li>
</ul>
<p>Instead of giving the coefficients as a <em>list</em> of length 2 or 5,
one can also give a <em>tuple</em>.</p>
<p>EXAMPLES:</p>
<p>We illustrate creating elliptic curves:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - x over Rational Field</span>
</pre></div>
</div>
<p>We create a curve from a Cremona label:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37b2&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 1873*x - 31833 over Rational Field</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - 7*x + 6 over Rational Field</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
</pre></div>
</div>
<p>Old Cremona labels are allowed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;2400FF&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x^2 + 2*x + 8 over Rational Field</span>
</pre></div>
</div>
<p>Unicode labels are allowed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
</pre></div>
</div>
<p>We create curves over a finite field as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + 4*x over Finite Field of size 5</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + 4*x over Finite Field of size 5</span>
</pre></div>
</div>
<p>Elliptic curves over <span class="math notranslate nohighlight">\(\ZZ/N\ZZ\)</span> with <span class="math notranslate nohighlight">\(N\)</span> prime are of type
“elliptic curve over a finite field”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 3 over Ring of integers modulo 101</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of schemes over Ring of integers modulo 101</span>
</pre></div>
</div>
<p>In contrast, elliptic curves over <span class="math notranslate nohighlight">\(\ZZ/N\ZZ\)</span> with <span class="math notranslate nohighlight">\(N\)</span> composite
are of type “generic elliptic curve”:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Zmod</span><span class="p">(</span><span class="mi">95</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 2*x + 3 over Ring of integers modulo 95</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_generic.EllipticCurve_generic_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of schemes over Ring of integers modulo 95</span>
</pre></div>
</div>
<p>The following is a curve over the complex numbers:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 + 1.00000000000000*y = x^3 + (-1.00000000000000)*x over Complex Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">2988.97297297297</span>
</pre></div>
</div>
<p>We can also create elliptic curves by giving the Weierstrass equation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R2</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="p">(</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">9</span> <span class="p">))</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 + x - 9 over Rational Field</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y  = x^3 + x^2 + 2 over Finite Field of size 5</span>
</pre></div>
</div>
<p>We can also create elliptic curves by giving a smooth plane cubic with a rational point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R3</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">30</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="n">P</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 - 270*y = x^3 - 24300 over Rational Field</span>
</pre></div>
</div>
<p>We can explicitly specify the <span class="math notranslate nohighlight">\(j\)</span>-invariant:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">);</span> <span class="n">E</span><span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">();</span> <span class="n">E</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - x over Rational Field</span>
<span class="go">1728</span>
<span class="go">&#39;32a2&#39;</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">2</span><span class="p">));</span> <span class="n">E</span><span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x + 1 over Finite Field of size 5</span>
<span class="go">2</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://trac.sagemath.org/6657">trac ticket #6657</a></p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">144169</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="mi">1728</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x over Finite Field of size 144169</span>
</pre></div>
</div>
<p>Elliptic curves over the same ring with the same Weierstrass
coefficients are identical, even when they are constructed in
different ways (see <a class="reference external" href="https://trac.sagemath.org/11474">trac ticket #11474</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a3&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>By default, when a rational value of <span class="math notranslate nohighlight">\(j\)</span> is given, the constructed
curve is a minimal twist (minimal conductor for curves with that
<span class="math notranslate nohighlight">\(j\)</span>-invariant).  This can be changed by setting the optional
parameter <code class="docutils literal notranslate"><span class="pre">minimal_twist</span></code>, which is True by default, to False:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x^2 + 3392*x + 307888 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">100</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x^2 + 3392*x + 307888 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">33129800</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">minimal_twist</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 488400*x - 530076800 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">298168200</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">100</span>
</pre></div>
</div>
<p>Without this option, constructing the curve could take a long time
since both <span class="math notranslate nohighlight">\(j\)</span> and <span class="math notranslate nohighlight">\(j-1728\)</span> have to be factored to compute the
minimal twist (see <a class="reference external" href="https://trac.sagemath.org/13100">trac ticket #13100</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">minimal_twist</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="o">+</span><span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args">
<code class="sig-name descname">create_key_and_extra_args</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">j</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">minimal_twist</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_key_and_extra_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a <code class="docutils literal notranslate"><span class="pre">UniqueFactory</span></code> key and possibly extra parameters.</p>
<p>INPUT:</p>
<p>See the documentation for <a class="reference internal" href="#sage.schemes.elliptic_curves.constructor.EllipticCurveFactory" title="sage.schemes.elliptic_curves.constructor.EllipticCurveFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">EllipticCurveFactory</span></code></a>.</p>
<p>OUTPUT:</p>
<p>A pair <code class="docutils literal notranslate"><span class="pre">(key,</span> <span class="pre">extra_args)</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> has the form <span class="math notranslate nohighlight">\((R, (a_1, a_2, a_3, a_4, a_6))\)</span>,
representing a ring and the Weierstrass coefficients of an
elliptic curve over that ring;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">extra_args</span></code> is a dictionary containing additional data to
be inserted into the elliptic curve structure.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">8000</span><span class="p">)</span>
<span class="go">((Rational Field, (0, 1, 0, -3, 1)), {})</span>
</pre></div>
</div>
<p>When constructing a curve over <span class="math notranslate nohighlight">\(\QQ\)</span> from a Cremona or LMFDB
label, the invariants from the database are returned as
<code class="docutils literal notranslate"><span class="pre">extra_args</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="s1">&#39;389.a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">key</span>
<span class="go">(Rational Field, (0, 1, 1, -2, 0))</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;conductor&#39;</span><span class="p">]</span>
<span class="go">389</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;cremona_label&#39;</span><span class="p">]</span>
<span class="go">&#39;389a1&#39;</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lmfdb_label&#39;</span><span class="p">]</span>
<span class="go">&#39;389.a1&#39;</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;torsion_order&#39;</span><span class="p">]</span>
<span class="go">1</span>
</pre></div>
</div>
<p>User-specified keywords are also included in <code class="docutils literal notranslate"><span class="pre">extra_args</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">23737</span><span class="p">,</span> <span class="mi">960366</span><span class="p">),</span> <span class="n">rank</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Furthermore, keywords takes precedence over data from the
database, which can be used to specify an alternative set of
generators for the Mordell-Weil group:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">key</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="s1">&#39;5077a1&#39;</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;gens&#39;</span><span class="p">]</span>
<span class="go">[[1, -1], [-2, 3], [4, -7]]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">data</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(-2 : 3 : 1), (1 : -1 : 1), (4 : -7 : 1)]</span>
</pre></div>
</div>
<p>Note that elliptic curves are equal if and only they have the
same base ring and Weierstrass equation; the data in
<code class="docutils literal notranslate"><span class="pre">extra_args</span></code> do not influence comparison of elliptic curves.
A consequence of this is that passing keyword arguments only
works when constructing an elliptic curve the first time:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;433a1&#39;</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(-1 : 1 : 1), (3 : 4 : 1)]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;433a1&#39;</span><span class="p">,</span> <span class="n">gens</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">[(-1 : 1 : 1), (3 : 4 : 1)]</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Manually specifying extra data is almost never necessary
and is not guaranteed to have any effect, as the above
example shows.  Almost no checking is done, so specifying
incorrect data may lead to wrong results of computations
instead of errors or warnings.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_object">
<code class="sig-name descname">create_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">version</span></em>, <em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurveFactory.create_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an object from a <code class="docutils literal notranslate"><span class="pre">UniqueFactory</span></code> key.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.schemes.elliptic_curves.ell_finite_field.EllipticCurve_finite_field_with_category&#39;&gt;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Keyword arguments are currently only passed to the
constructor for elliptic curves over <span class="math notranslate nohighlight">\(\QQ\)</span>; elliptic
curves over other fields do not support them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_Weierstrass_polynomial">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurve_from_Weierstrass_polynomial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_Weierstrass_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve defined by a cubic in (long) Weierstrass
form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> – a inhomogeneous cubic polynomial in long Weierstrass
form.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The elliptic curve defined by it.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 6 over Rational Field</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">a_invariants</span><span class="p">()</span>
<span class="go">(1, 2, 3, 4, 6)</span>
</pre></div>
</div>
<p>The polynomial ring may have extra variables as long as they
do not occur in the polynomial itself:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="o">-</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 1 over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_c4c6">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurve_from_c4c6</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">c4</span></em>, <em class="sig-param"><span class="n">c6</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_c4c6" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an elliptic curve with given <span class="math notranslate nohighlight">\(c_4\)</span> and
<span class="math notranslate nohighlight">\(c_6\)</span> invariants.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_c4c6</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="o">-</span><span class="mi">2005</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2  = x^3 - 17/48*x + 2005/864 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">c_invariants</span><span class="p">()</span>
<span class="go">(17, -2005)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_cubic">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurve_from_cubic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">P</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">morphism</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct an elliptic curve from a ternary cubic with a rational point.</p>
<p>If you just want the Weierstrass form and are not interested in
the morphism then it is easier to use the function
<a class="reference internal" href="jacobian.html#sage.schemes.elliptic_curves.jacobian.Jacobian" title="sage.schemes.elliptic_curves.jacobian.Jacobian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Jacobian()</span></code></a>
instead. If there is a rational point on the given cubic, this
function will construct the same elliptic curve but you do not have to
supply the point <code class="docutils literal notranslate"><span class="pre">P</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> – a homogeneous cubic in three variables with rational
coefficients, as a polynomial ring element, defining a smooth
plane cubic curve <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a 3-tuple <span class="math notranslate nohighlight">\((x,y,z)\)</span> defining a projective point on <span class="math notranslate nohighlight">\(C\)</span>,
or <code class="docutils literal notranslate"><span class="pre">None</span></code>.  If <code class="docutils literal notranslate"><span class="pre">None</span></code> then a rational flex will be used as a
base point if one exists, otherwise an error will be raised.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">morphism</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>).  If <code class="docutils literal notranslate"><span class="pre">True</span></code>
returns a birational isomorphism from <span class="math notranslate nohighlight">\(C\)</span> to a Weierstrass
elliptic curve <span class="math notranslate nohighlight">\(E\)</span>, otherwise just returns <span class="math notranslate nohighlight">\(E\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Either (when <code class="docutils literal notranslate"><span class="pre">morphism``=``False</span></code>) an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> in long
Weierstrass form isomorphic to the plane cubic curve <span class="math notranslate nohighlight">\(C\)</span> defined
by the equation <span class="math notranslate nohighlight">\(F=0\)</span>.</p>
<p>Or (when <code class="docutils literal notranslate"><span class="pre">morphism=True</span></code>), a birational isomorphism from <span class="math notranslate nohighlight">\(C\)</span> to
the elliptic curve <span class="math notranslate nohighlight">\(E\)</span>. If the given point is a flex, this is a
linear isomorphism.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The function
<a class="reference internal" href="jacobian.html#sage.schemes.elliptic_curves.jacobian.Jacobian" title="sage.schemes.elliptic_curves.jacobian.Jacobian"><code class="xref py py-func docutils literal notranslate"><span class="pre">Jacobian()</span></code></a> may be
used instead.  It constructs the same elliptic curve (which is in
all cases the Jacobian of <span class="math notranslate nohighlight">\((F=0)\)</span>) and needs no base point to be
provided, but also returns no isomorphism since in general there
is none: the plane cubic is only isomorphic to its Jacobian when
it has a rational point.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">morphism=True</span></code>, a birational isomorphism between the
curve <span class="math notranslate nohighlight">\(F=0\)</span> and the Weierstrass curve is returned. If the point
happens to be a flex, then this is a linear isomorphism.  The
morphism does not necessarily take the given point <span class="math notranslate nohighlight">\(P\)</span> to the
point at infinity on <span class="math notranslate nohighlight">\(E\)</span>, since we always use a rational flex
on <span class="math notranslate nohighlight">\(C\)</span> as base-point when one exists.</p>
</div>
<p>EXAMPLES:</p>
<p>First we find that the Fermat cubic is isomorphic to the curve
with Cremona label 27a1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 - 9*y = x^3 - 27 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">cremona_label</span><span class="p">()</span>
<span class="go">&#39;27a1&#39;</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">cremona_label</span><span class="p">()</span>
<span class="go">&#39;27a1&#39;</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span><span class="o">.</span><span class="n">cremona_label</span><span class="p">()</span>
<span class="go">&#39;27a1&#39;</span>
</pre></div>
</div>
<p>Next we find the minimal model and conductor of the Jacobian of the
Selmer curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">60</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">False</span><span class="p">);</span>  <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 - 540*y = x^3 - 97200 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - 24300 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">24300</span>
</pre></div>
</div>
<p>We can also get the birational isomorphism to and from the
Weierstrass form. We start with an example where <code class="docutils literal notranslate"><span class="pre">P</span></code> is a flex
and the equivalence is a linear isomorphism:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Rational Field defined by a^3 + b^3 + 60*c^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 - 540*y = x^3 - 97200 over Rational Field</span>
<span class="go">  Defn: Defined on coordinates by sending (a : b : c) to</span>
<span class="go">        (-c : 3*a : 1/180*a + 1/180*b)</span>

<span class="gp">sage: </span><span class="n">finv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">inverse</span><span class="p">();</span>  <span class="n">finv</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Elliptic Curve defined by y^2 - 540*y = x^3 - 97200 over Rational Field</span>
<span class="go">  To:   Projective Plane Curve over Rational Field defined by a^3 + b^3 + 60*c^3</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (1/3*y : -1/3*y + 180*z : -x)</span>

<span class="go">Scheme morphism:</span>
<span class="go">  From: Elliptic Curve defined by y^2 + 2*x*y + 20*y = x^3 - x^2 - 20*x - 400/3</span>
<span class="go">        over Rational Field</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2 over Rational Field defined by:</span>
<span class="go">  a^3 + b^3 + 60*c^3</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (x + y + 20*z : -x - y : -x)</span>
</pre></div>
</div>
<p>We verify that <span class="math notranslate nohighlight">\(f\)</span> maps the chosen point <span class="math notranslate nohighlight">\(P=(1,-1,0)\)</span> on the cubic
to the origin of the elliptic curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">finv</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(-1 : 1 : 0)</span>
</pre></div>
</div>
<p>To verify the output, we plug in the polynomials to check that
this indeed transforms the cubic into Weierstrass form:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cubic</span><span class="p">(</span><span class="n">finv</span><span class="o">.</span><span class="n">defining_polynomials</span><span class="p">())</span> <span class="o">*</span> <span class="n">finv</span><span class="o">.</span><span class="n">post_rescaling</span><span class="p">()</span>
<span class="go">-x^3 + y^2*z - 540*y*z^2 + 97200*z^3</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()(</span><span class="n">f</span><span class="o">.</span><span class="n">defining_polynomials</span><span class="p">())</span> <span class="o">*</span> <span class="n">f</span><span class="o">.</span><span class="n">post_rescaling</span><span class="p">()</span>
<span class="go">a^3 + b^3 + 60*c^3</span>
</pre></div>
</div>
<p>If the given point is not a flex and the cubic has no rational
flexes, then the cubic can not be transformed to a Weierstrass
equation by a linear transformation. The general birational
transformation is still a birational isomorphism, but is
quadratic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Rational Field defined by x^2*y + 4*x*y^2 + x^2*z + 8*x*y*z + 4*y^2*z + 9*x*z^2 + 9*y*z^2</span>
<span class="go">  To:   Elliptic Curve defined by y^2 + 7560/19*x*y + 552960000000/2352637*y = x^3 - 3445200/133*x^2 over Rational Field</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (2527/17280*x^2 + 133/2160*x*y + 133/108000*y^2 + 133/2880*x*z + 931/18000*y*z - 3857/48000*z^2 : -6859/288*x^2 + 323/36*x*y + 359/1800*y^2 + 551/48*x*z + 2813/300*y*z + 24389/800*z^2 : -2352637/99532800000*x^2 - 2352637/124416000000*x*y - 2352637/622080000000*y^2 + 2352637/82944000000*x*z + 2352637/207360000000*y*z - 2352637/276480000000*z^2)</span>
</pre></div>
</div>
<p>Note that the morphism returned cannot be evaluated directly at
the given point <code class="docutils literal notranslate"><span class="pre">P=(1:-1:1)</span></code> since the polynomials defining it
all vanish there:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: [0, 0, 0] does not define a valid point since all entries are 0</span>
</pre></div>
</div>
<p>Using the group law on the codomain elliptic curve, which has rank
1 and full 2-torsion, and the inverse morphism, we can find many
points on the cubic.  First we find the preimages of multiples of
the generator:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">&#39;720e2&#39;</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">gens</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span> <span class="n">R</span>
<span class="go">(-17280000/2527 : 9331200000/6859 : 1)</span>
<span class="gp">sage: </span><span class="n">finv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">finv</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">R</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[(-4 : 1 : 0),</span>
<span class="go">(-1 : 4 : 1),</span>
<span class="go">(-20 : -55/76 : 1),</span>
<span class="go">(319/399 : -11339/7539 : 1),</span>
<span class="go">(159919/14360 : -4078139/1327840 : 1),</span>
<span class="go">(-27809119/63578639 : 1856146436/3425378659 : 1),</span>
<span class="go">(-510646582340/56909753439 : 424000923715/30153806197284 : 1),</span>
<span class="go">(-56686114363679/4050436059492161 : -2433034816977728281/1072927821085503881 : 1),</span>
<span class="go">(650589589099815846721/72056273157352822480 : -347376189546061993109881/194127383495944026752320 : 1)]</span>
</pre></div>
</div>
<p>The elliptic curve also has torsion, which we can map back:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="go">[(-144000000/17689 : 3533760000000/2352637 : 1),</span>
<span class="go">(-92160000/17689 : 2162073600000/2352637 : 1),</span>
<span class="go">(-5760000/17689 : -124070400000/2352637 : 1),</span>
<span class="go">(0 : 1 : 0)]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">finv</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span> <span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span> <span class="k">if</span> <span class="n">Q</span><span class="p">]</span>
<span class="go">[(9 : -9/4 : 1), (-9 : 0 : 1), (0 : 1 : 0)]</span>
</pre></div>
</div>
<p>In this example, the given point <code class="docutils literal notranslate"><span class="pre">P</span></code> is not a flex but the cubic
does have a rational flex, <code class="docutils literal notranslate"><span class="pre">(-4:0:1)</span></code>.  We return a linear
isomorphism which maps this flex to the point at infinity on the
Weierstrass model:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span>  <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">64</span><span class="o">*</span><span class="n">c</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">codomain</span><span class="p">();</span>  <span class="n">E</span>
<span class="go">Elliptic Curve defined by y^2 - 258048*y = x^3 - 22196256768 over Rational Field</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 - 331 over Rational Field</span>

<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Rational Field defined by a^3 + 7*b^3 + 64*c^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 - 258048*y = x^3 - 22196256768 over Rational Field</span>
<span class="go">  Defn: Defined on coordinates by sending (a : b : c) to</span>
<span class="go">        (b : -48*a : -1/5376*a - 1/1344*c)</span>

<span class="gp">sage: </span><span class="n">finv</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">inverse</span><span class="p">();</span>  <span class="n">finv</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Elliptic Curve defined by y^2 - 258048*y = x^3 - 22196256768 over Rational Field</span>
<span class="go">  To:   Projective Plane Curve over Rational Field defined by a^3 + 7*b^3 + 64*c^3</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (-1/48*y : x : 1/192*y - 1344*z)</span>

<span class="gp">sage: </span><span class="n">cubic</span><span class="p">(</span><span class="n">finv</span><span class="o">.</span><span class="n">defining_polynomials</span><span class="p">())</span> <span class="o">*</span> <span class="n">finv</span><span class="o">.</span><span class="n">post_rescaling</span><span class="p">()</span>
<span class="go">-x^3 + y^2*z - 258048*y*z^2 + 22196256768*z^3</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">defining_polynomial</span><span class="p">()(</span><span class="n">f</span><span class="o">.</span><span class="n">defining_polynomials</span><span class="p">())</span> <span class="o">*</span> <span class="n">f</span><span class="o">.</span><span class="n">post_rescaling</span><span class="p">()</span>
<span class="go">a^3 + 7*b^3 + 64*c^3</span>

<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(5376 : -258048 : 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
<p>It is possible to not provide a base point <code class="docutils literal notranslate"><span class="pre">P</span></code> provided that the
cubic has a rational flex.  In this case the flexes will be found
and one will be used as a base point:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Rational Field defined by x^3 + y^3 + z^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 - 9*y = x^3 - 27 over Rational Field</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (y : -3*x : -1/3*x - 1/3*z)</span>
</pre></div>
</div>
<p>An error will be raised if no point is given and there are no rational flexes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: A point must be given when the cubic has no rational flexes</span>
</pre></div>
</div>
<p>An example over a finite field, using a flex:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Finite Field of size 17 defined by 2*x^3 + 3*y^3 + 4*z^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 + 16*y = x^3 + 11 over Finite Field of size 17</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (-x : 4*y : 4*y + 5*z)</span>
</pre></div>
</div>
<p>An example in characteristic 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Finite Field of size 3 defined by x^3 + y^3 + x*y*z + z^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 + x*y = x^3 + 1 over Finite Field of size 3</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (y + z : -y : x)</span>
</pre></div>
</div>
<p>An example over a number field, using a non-flex and where there are no rational flexes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: Projective Plane Curve over Number Field in a with defining polynomial x^2 + 3 with a = 1.732050807568878?*I defined by 2*x^3 + 3*y^3 + 5*z^3</span>
<span class="go">  To:   Elliptic Curve defined by y^2 + 1754460/2053*x*y + 5226454388736000/8653002877*y = x^3 + (-652253285700/4214809)*x^2 over Number Field in a with defining polynomial x^2 + 3 with a = 1.732050807568878?*I</span>
<span class="go">  Defn: Defined on coordinates by sending (x : y : z) to</span>
<span class="go">        (-16424/127575*x^2 - 231989/680400*x*y - 14371/64800*y^2 - 26689/81648*x*z - 10265/27216*y*z - 2053/163296*z^2 : 24496/315*x^2 + 119243/840*x*y + 4837/80*y^2 + 67259/504*x*z + 25507/168*y*z + 5135/1008*z^2 : 8653002877/2099914709760000*x^2 + 8653002877/699971569920000*x*y + 8653002877/933295426560000*y^2 + 8653002877/419982941952000*x*z + 8653002877/279988627968000*y*z + 8653002877/335986353561600*z^2)</span>
</pre></div>
</div>
<p>An example over a function field, using a non-flex:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">cubic</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">t</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_cubic</span><span class="p">(</span><span class="n">cubic</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">morphism</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + ((162*t^6+486*t^5+810*t^4+810*t^3+486*t^2+162*t)/(t^6+12*t^5-3*t^4-20*t^3-3*t^2+12*t+1))*x*y + ((314928*t^14+4094064*t^13+23462136*t^12+78102144*t^11+167561379*t^10+243026001*t^9+243026001*t^8+167561379*t^7+78102144*t^6+23462136*t^5+4094064*t^4+314928*t^3)/(t^14+40*t^13+577*t^12+3524*t^11+8075*t^10+5288*t^9-8661*t^8-17688*t^7-8661*t^6+5288*t^5+8075*t^4+3524*t^3+577*t^2+40*t+1))*y = x^3 + ((2187*t^12+13122*t^11-17496*t^10-207765*t^9-516132*t^8-673596*t^7-516132*t^6-207765*t^5-17496*t^4+13122*t^3+2187*t^2)/(t^12+24*t^11+138*t^10-112*t^9-477*t^8+72*t^7+708*t^6+72*t^5-477*t^4-112*t^3+138*t^2+24*t+1))*x^2 over Rational function field in t over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_j">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurve_from_j</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">minimal_twist</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an elliptic curve with given <span class="math notranslate nohighlight">\(j\)</span>-invariant.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">j</span></code> – an element of some field.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minimal_twist</span></code> (boolean, default True) – If True and <code class="docutils literal notranslate"><span class="pre">j</span></code>
is in <span class="math notranslate nohighlight">\(\QQ\)</span>, the curve returned is a minimal twist, i.e. has
minimal conductor; when there is more than one curve with
minimal conductor, the curve returned is the one whose label
comes first if the curves are in the CremonaDatabase, otherwise
the one whose minimal a-invarinats are first lexicographically.
If <span class="math notranslate nohighlight">\(j\)</span> is not in <span class="math notranslate nohighlight">\(\QQ\)</span> this parameter is ignored.</p></li>
</ul>
<p>OUTPUT:</p>
<p>An elliptic curve with <span class="math notranslate nohighlight">\(j\)</span>-invariant <span class="math notranslate nohighlight">\(j\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">E</span><span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">();</span> <span class="n">E</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + y = x^3 over Rational Field</span>
<span class="go">0</span>
<span class="go">&#39;27a3&#39;</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">);</span> <span class="n">E</span><span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">();</span> <span class="n">E</span><span class="o">.</span><span class="n">label</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - x over Rational Field</span>
<span class="go">1728</span>
<span class="go">&#39;32a2&#39;</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">E</span><span class="p">;</span> <span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + x*y = x^3 + 36*x + 3455 over Rational Field</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">minimal_twist</span></code> parameter (ignored except over <span class="math notranslate nohighlight">\(\QQ\)</span> and
True by default) controls whether or not a minimal twist is
computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + x^2 + 3392*x + 307888 over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">33129800</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">minimal_twist</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 488400*x - 530076800 over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span>
<span class="go">298168200</span>
</pre></div>
</div>
<p>Since computing the minimal twist requires factoring both <span class="math notranslate nohighlight">\(j\)</span> and
<span class="math notranslate nohighlight">\(j-1728\)</span> the following example would take a long time without
setting <code class="docutils literal notranslate"><span class="pre">minimal_twist</span></code> to False:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">minimal_twist</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">j_invariant</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span><span class="o">^</span><span class="mi">256</span><span class="o">+</span><span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.EllipticCurves_with_good_reduction_outside_S">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">EllipticCurves_with_good_reduction_outside_S</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">S</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">proof</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.EllipticCurves_with_good_reduction_outside_S" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of all elliptic curves defined over <span class="math notranslate nohighlight">\(Q\)</span>
with good reduction outside the set <span class="math notranslate nohighlight">\(S\)</span> of primes.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code> – list of primes (default: empty list)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">proof</span></code> – boolean (default <code class="docutils literal notranslate"><span class="pre">True</span></code>): the MW basis for
auxiliary curves will be computed with this proof flag</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – boolean (default <code class="docutils literal notranslate"><span class="pre">False</span></code>): if <code class="docutils literal notranslate"><span class="pre">True</span></code>, some details
of the computation will be output</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Proof flag: The algorithm used requires determining all
S-integral points on several auxiliary curves, which in turn
requires the computation of their generators.  This is not
always possible (even in theory) using current knowledge.</p>
<p>The value of this flag is passed to the function which
computes generators of various auxiliary elliptic curves, in
order to find their S-integral points.  Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if the
default (<code class="docutils literal notranslate"><span class="pre">True</span></code>) causes warning messages, but note that you can
then not rely on the set of curves returned being
complete.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurves_with_good_reduction_outside_S</span><span class="p">([])</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">elist</span> <span class="o">=</span> <span class="n">EllipticCurves_with_good_reduction_outside_S</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">elist</span>
<span class="go">[Elliptic Curve defined by y^2 = x^3 + 4*x over Rational Field,</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - x over Rational Field,</span>
<span class="go">...</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - x^2 - 13*x + 21 over Rational Field]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">elist</span><span class="p">)</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">label</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elist</span><span class="p">)</span>
<span class="go">&#39;32a1, 32a2, 32a3, 32a4, 64a1, 64a2, 64a3, 64a4, 128a1, 128a2, 128b1, 128b2, 128c1, 128c2, 128d1, 128d2, 256a1, 256a2, 256b1, 256b2, 256c1, 256c2, 256d1, 256d2&#39;</span>
</pre></div>
</div>
<p>Without <code class="docutils literal notranslate"><span class="pre">Proof=False</span></code>, this example gives two warnings:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">elist</span> <span class="o">=</span> <span class="n">EllipticCurves_with_good_reduction_outside_S</span><span class="p">([</span><span class="mi">11</span><span class="p">],</span><span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># long time (14s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">elist</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">label</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elist</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">&#39;11a1, 11a2, 11a3, 121a1, 121a2, 121b1, 121b2, 121c1, 121c2, 121d1, 121d2, 121d3&#39;</span>

<span class="gp">sage: </span><span class="n">elist</span> <span class="o">=</span> <span class="n">EllipticCurves_with_good_reduction_outside_S</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="c1"># long time (26s on sage.math, 2011)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">elist</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">752</span>
<span class="gp">sage: </span><span class="n">conds</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">elist</span><span class="p">]))</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">conds</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">62208</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">N</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="n">conds</span><span class="p">]</span> <span class="c1"># long time</span>
<span class="go">[2^3 * 3,</span>
<span class="go"> 3^3,</span>
<span class="go"> 2^5,</span>
<span class="go"> 2^2 * 3^2,</span>
<span class="go"> 2^4 * 3,</span>
<span class="go"> 2 * 3^3,</span>
<span class="go"> 2^6,</span>
<span class="go"> 2^3 * 3^2,</span>
<span class="go"> 2^5 * 3,</span>
<span class="go"> 2^2 * 3^3,</span>
<span class="go"> 2^7,</span>
<span class="go"> 2^4 * 3^2,</span>
<span class="go"> 2 * 3^4,</span>
<span class="go"> 2^6 * 3,</span>
<span class="go"> 2^3 * 3^3,</span>
<span class="go"> 3^5,</span>
<span class="go"> 2^8,</span>
<span class="go"> 2^5 * 3^2,</span>
<span class="go"> 2^2 * 3^4,</span>
<span class="go"> 2^7 * 3,</span>
<span class="go"> 2^4 * 3^3,</span>
<span class="go"> 2 * 3^5,</span>
<span class="go"> 2^6 * 3^2,</span>
<span class="go"> 2^3 * 3^4,</span>
<span class="go"> 2^8 * 3,</span>
<span class="go"> 2^5 * 3^3,</span>
<span class="go"> 2^2 * 3^5,</span>
<span class="go"> 2^7 * 3^2,</span>
<span class="go"> 2^4 * 3^4,</span>
<span class="go"> 2^6 * 3^3,</span>
<span class="go"> 2^3 * 3^5,</span>
<span class="go"> 2^8 * 3^2,</span>
<span class="go"> 2^5 * 3^4,</span>
<span class="go"> 2^7 * 3^3,</span>
<span class="go"> 2^4 * 3^5,</span>
<span class="go"> 2^6 * 3^4,</span>
<span class="go"> 2^8 * 3^3,</span>
<span class="go"> 2^5 * 3^5,</span>
<span class="go"> 2^7 * 3^4,</span>
<span class="go"> 2^6 * 3^5,</span>
<span class="go"> 2^8 * 3^4,</span>
<span class="go"> 2^7 * 3^5,</span>
<span class="go"> 2^8 * 3^5]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.are_projectively_equivalent">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">are_projectively_equivalent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">P</span></em>, <em class="sig-param"><span class="n">Q</span></em>, <em class="sig-param"><span class="n">base_ring</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.are_projectively_equivalent" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> are projectively equivalent.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">Q</span></code> – list/tuple of projective coordinates.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – the base ring.</p></li>
</ul>
<p>OUTPUT:</p>
<p>Boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">are_projectively_equivalent</span>
<span class="gp">sage: </span><span class="n">are_projectively_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">are_projectively_equivalent</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.chord_and_tangent">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">chord_and_tangent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">F</span></em>, <em class="sig-param"><span class="n">P</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.chord_and_tangent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the third point of intersection of a cubic with the tangent at one point.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> – a homogeneous cubic in three variables with rational
coefficients, as a polynomial ring element, defining a smooth
plane cubic curve.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a 3-tuple <span class="math notranslate nohighlight">\((x,y,z)\)</span> defining a projective point on the
curve <span class="math notranslate nohighlight">\(F=0\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A point <code class="docutils literal notranslate"><span class="pre">Q</span></code> such that <code class="docutils literal notranslate"><span class="pre">F(Q)=0</span></code>, namely the third point of
intersection of the tangent at <code class="docutils literal notranslate"><span class="pre">P</span></code> with the curve <code class="docutils literal notranslate"><span class="pre">F=0</span></code>, so
<code class="docutils literal notranslate"><span class="pre">Q=P</span></code> if and only if <code class="docutils literal notranslate"><span class="pre">P</span></code> is a flex.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">chord_and_tangent</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">60</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">chord_and_tangent</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(-1 : 1 : 0)</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">64</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">p0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="n">chord_and_tangent</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">p0</span><span class="p">);</span>  <span class="n">p1</span>
<span class="go">(5 : -3 : 1)</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="n">chord_and_tangent</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="n">p1</span><span class="p">);</span>  <span class="n">p2</span>
<span class="go">(-1265/314 : 183/314 : 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.coefficients_from_Weierstrass_polynomial">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">coefficients_from_Weierstrass_polynomial</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.coefficients_from_Weierstrass_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coefficients <span class="math notranslate nohighlight">\([a_1, a_2, a_3, a_4, a_6]\)</span> of a cubic in
Weierstrass form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">coefficients_from_Weierstrass_polynomial</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">w</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">coefficients_from_Weierstrass_polynomial</span><span class="p">(</span><span class="o">-</span><span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[0, 0, 0, 0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.coefficients_from_j">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">coefficients_from_j</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">j</span></em>, <em class="sig-param"><span class="n">minimal_twist</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.coefficients_from_j" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Weierstrass coefficients <span class="math notranslate nohighlight">\((a_1, a_2, a_3, a_4, a_6)\)</span> for an
elliptic curve with given <span class="math notranslate nohighlight">\(j\)</span>-invariant.</p>
<p>INPUT:</p>
<p>See <a class="reference internal" href="#sage.schemes.elliptic_curves.constructor.EllipticCurve_from_j" title="sage.schemes.elliptic_curves.constructor.EllipticCurve_from_j"><code class="xref py py-func docutils literal notranslate"><span class="pre">EllipticCurve_from_j()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">coefficients_from_j</span>
<span class="gp">sage: </span><span class="n">coefficients_from_j</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 0, 1, 0, 0]</span>
<span class="gp">sage: </span><span class="n">coefficients_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">)</span>
<span class="go">[0, 0, 0, -1, 0]</span>
<span class="gp">sage: </span><span class="n">coefficients_from_j</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1, 0, 0, 36, 3455]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">minimal_twist</span></code> parameter (ignored except over <span class="math notranslate nohighlight">\(\QQ\)</span> and
True by default) controls whether or not a minimal twist is
computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">coefficients_from_j</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="go">[0, 1, 0, 3392, 307888]</span>
<span class="gp">sage: </span><span class="n">coefficients_from_j</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">minimal_twist</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0, 0, 0, 488400, -530076800]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.projective_point">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">projective_point</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.projective_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return equivalent point with denominators removed</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code>, <code class="docutils literal notranslate"><span class="pre">Q</span></code> – list/tuple of projective coordinates.</p></li>
</ul>
<p>OUTPUT:</p>
<p>List of projective coordinates.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">projective_point</span>
<span class="gp">sage: </span><span class="n">projective_point</span><span class="p">([</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="go">[2, 3, 4]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">projective_point</span><span class="p">([</span><span class="n">F</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">[4, 8, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="sage.schemes.elliptic_curves.constructor.tangent_at_smooth_point">
<code class="sig-prename descclassname">sage.schemes.elliptic_curves.constructor.</code><code class="sig-name descname">tangent_at_smooth_point</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">C</span></em>, <em class="sig-param"><span class="n">P</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.constructor.tangent_at_smooth_point" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tangent at the smooth point <span class="math notranslate nohighlight">\(P\)</span> of projective curve <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> – a projective plane curve.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a 3-tuple <span class="math notranslate nohighlight">\((x,y,z)\)</span> defining a projective point on <span class="math notranslate nohighlight">\(C\)</span>.</p></li>
</ul>
<p>OUTPUT:</p>
<p>The linear form defining the tangent at <span class="math notranslate nohighlight">\(P\)</span> to <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">tangent_at_smooth_point</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">60</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tangent_at_smooth_point</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">x + y</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Curve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.constructor</span> <span class="kn">import</span> <span class="n">tangent_at_smooth_point</span>
<span class="gp">sage: </span><span class="n">tangent_at_smooth_point</span><span class="p">(</span><span class="n">C</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go">3*x + 6*y + 9*z</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../../index.html"
                        title="previous chapter">Elliptic curves</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="jacobian.html"
                        title="next chapter">Construct elliptic curves as Jacobians</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/elliptic_curves/constructor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="jacobian.html" title="Construct elliptic curves as Jacobians"
             >next</a> |</li>
        <li class="right" >
          <a href="../../../index.html" title="Elliptic curves"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.3 Reference Manual: Elliptic curves</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Elliptic curve constructor</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2021, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.1.2.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>