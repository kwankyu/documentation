
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Quadratic Forms Overview &#8212; Sage 9.5 Reference Manual: Quadratic Forms</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Binary Quadratic Forms with Integer Coefficients" href="binary_qf.html" />
    <link rel="prev" title="Quadratic Forms" href="../../index.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="binary_qf.html" title="Binary Quadratic Forms with Integer Coefficients"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quadratic Forms"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Quadratic Forms</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Quadratic Forms Overview</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="quadratic-forms-overview">
<span id="sage-quadratic-forms-quadratic-form"></span><h1>Quadratic Forms Overview<a class="headerlink" href="#quadratic-forms-overview" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.quadratic_forms.quadratic_form"></span><p>AUTHORS:</p>
<ul class="simple">
<li><p>Jon Hanke (2007-06-19)</p></li>
<li><p>Anna Haensch (2010-07-01): Formatting and ReSTification</p></li>
<li><p>Simon Brandhorst (2019-10-15): <a class="reference internal" href="#sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants" title="sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants"><code class="xref py py-meth docutils literal notranslate"><span class="pre">quadratic_form_from_invariants()</span></code></a></p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">DiagonalQuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.DiagonalQuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a quadratic form over <span class="math notranslate nohighlight">\(R\)</span> which is a sum of squares.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R\)</span> – ring</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diag</span></code> – list/tuple of elements coercible to R</p></li>
</ul>
<p>OUTPUT:</p>
<p>quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">QuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unsafe_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_automorphisms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">QuadraticForm</span></code> class represents a quadratic form in n variables with
coefficients in the ring R.</p>
<p>INPUT:</p>
<p>The constructor may be called in any of the following ways.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R,</span> <span class="pre">n,</span> <span class="pre">entries)</span></code>, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R\)</span> – ring for which the quadratic form is defined</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> – an integer &gt;= 0</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entries</span></code> – a list of <span class="math notranslate nohighlight">\(n(n+1)/2\)</span> coefficients of the quadratic form
in <span class="math notranslate nohighlight">\(R\)</span> (given lexicographically, or equivalently, by rows of the
matrix)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R,</span> <span class="pre">n)</span></code>, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R\)</span> – a ring</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> – a symmetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix with even diagonal (relative to
<span class="math notranslate nohighlight">\(R\)</span>)</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">QuadraticForm(R)</span></code>, where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R\)</span> – a symmetric <span class="math notranslate nohighlight">\(n \times n\)</span> matrix with even diagonal (relative to
its base ring)</p></li>
</ul>
</li>
</ol>
<p>If the keyword argument <code class="docutils literal notranslate"><span class="pre">unsafe_initialize</span></code> is True, then the subsequent
fields may by used to force the external initialization of various fields
of the quadratic form. Currently the only fields which can be set are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">number_of_automorphisms</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<p>quadratic form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span> <span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4/3 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 7 variables over Rational Field with coefficients:</span>
<span class="go">[ 0 1 2 3 4 5 6 ]</span>
<span class="go">[ * 7 8 9 10 11 12 ]</span>
<span class="go">[ * * 13 14 15 16 17 ]</span>
<span class="go">[ * * * 18 19 20 21 ]</span>
<span class="go">[ * * * * 22 23 24 ]</span>
<span class="go">[ * * * * * 25 26 ]</span>
<span class="go">[ * * * * * * 27 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 -2 ]</span>
<span class="go">[ * 3 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[2 5]</span>
<span class="go">[5 8]</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="n">m</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 5 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list">
<span class="sig-name descname"><span class="pre">CS_genus_symbol_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">force_recomputation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.CS_genus_symbol_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of Conway-Sloane genus symbols in increasing order of primes dividing 2*det.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">CS_genus_symbol_list</span><span class="p">()</span>
<span class="go">[Genus symbol at 2:    [2^-2 4^1 8^1]_6, Genus symbol at 3:     1^3 3^-1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal">
<span class="sig-name descname"><span class="pre">GHY_mass__maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.GHY_mass__maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the GHY formula to compute the mass of a (maximal?) quadratic
lattice. This works for any number field.</p>
<p>Reference:  See [GHY, Prop 7.4 and 7.5, p121] and [GY, Thrm 10.20, p25].</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">GHY_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det">
<span class="sig-name descname"><span class="pre">Gram_det</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the determinant of the Gram matrix of Q.</p>
<p>(Note: This is defined over the fraction field of the ring of
the quadratic form, but is often not defined over the same
ring as the quadratic form.)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Gram_det</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix">
<span class="sig-name descname"><span class="pre">Gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a (symmetric) Gram matrix A for the quadratic form Q,
meaning that</p>
<div class="math notranslate nohighlight">
\[Q(x) = x^t * A * x,\]</div>
<p>defined over the base ring of Q.  If this is not possible,
then a TypeError is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational">
<span class="sig-name descname"><span class="pre">Gram_matrix_rational</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Gram_matrix_rational" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a (symmetric) Gram matrix A for the quadratic form Q,
meaning that</p>
<div class="math notranslate nohighlight">
\[Q(x) = x^t * A * x,\]</div>
<p>defined over the fraction field of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix_rational</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 3 0 0]</span>
<span class="go">[0 0 5 0]</span>
<span class="go">[0 0 0 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix">
<span class="sig-name descname"><span class="pre">Hessian_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Hessian_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hessian matrix A for which Q(X) = <span class="math notranslate nohighlight">\((1/2) * X^t * A * X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 3 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="go">[2 2]</span>
<span class="go">[2 6]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2">
<span class="sig-name descname"><span class="pre">Kitaoka_mass_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Kitaoka_mass_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local mass of the quadratic form when <span class="math notranslate nohighlight">\(p=2\)</span>, according
to Theorem 5.6.3 on pp108–9 of Kitaoka’s Book “The Arithmetic of
Quadratic Forms”.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number &gt; 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Kitaoka_mass_at_2</span><span class="p">()</span>   <span class="c1">## WARNING:  WE NEED TO CHECK THIS CAREFULLY!</span>
<span class="go">1/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime">
<span class="sig-name descname"><span class="pre">Pall_mass_density_at_odd_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Pall_mass_density_at_odd_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local representation density of a form (for
representing itself) defined over <span class="math notranslate nohighlight">\(ZZ\)</span>, at some prime <span class="math notranslate nohighlight">\(p&gt;2\)</span>.</p>
<p>REFERENCES:</p>
<blockquote>
<div><p>Pall’s article “The Weight of a Genus of Positive n-ary Quadratic Forms”
appearing in Proc. Symp. Pure Math. VIII (1965), pp95–105.</p>
</div></blockquote>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 2.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Pall_mass_density_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 1 ])] [(0, 3, 8)] [8/9] 8/9</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2">
<span class="sig-name descname"><span class="pre">Watson_mass_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.Watson_mass_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the local mass of the quadratic form when <span class="math notranslate nohighlight">\(p=2\)</span>, according
to Watson’s Theorem 1 of “The 2-adic density of a quadratic form”
in Mathematika 23 (1976), pp 94–106.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Watson_mass_at_2</span><span class="p">()</span>               <span class="c1">## WARNING:  WE NEED TO CHECK THIS CAREFULLY!</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric">
<span class="sig-name descname"><span class="pre">add_symmetric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.add_symmetric" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the substitution <span class="math notranslate nohighlight">\(x_j --&gt; x_j + c*x_i\)</span>, which has the
effect (on associated matrices) of symmetrically adding
<span class="math notranslate nohighlight">\(c * j\)</span>-th row/column to the <span class="math notranslate nohighlight">\(i\)</span>-th row/column.</p>
<p>NOTE: This is meant for compatibility with previous code,
which implemented a matrix model for this class.  It is used
in the local_normal_form() method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> – an element of Q.base_ring()</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> – integers &gt;= 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a QuadraticForm (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 3 ]</span>
<span class="go">[ * 3 2 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1">## ERROR: -3/2 isn&#39;t in the base ring ZZ</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">RuntimeError: Oops!  This coefficient can...t be coerced to an element of the base ring for the quadratic form.</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">add_symmetric</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 0 ]</span>
<span class="go">[ * 4 2 ]</span>
<span class="go">[ * * 15/4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint">
<span class="sig-name descname"><span class="pre">adjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives the adjoint (integral) quadratic form associated to the
given form, essentially defined by taking the adjoint of the matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 -2 ]</span>
<span class="go">[ * 1 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 39 2 8 ]</span>
<span class="go">[ * 19 4 ]</span>
<span class="go">[ * * 8 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive">
<span class="sig-name descname"><span class="pre">adjoint_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.adjoint_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the primitive adjoint of the quadratic form, which is
the smallest discriminant integer-valued quadratic form whose
matrix is a scalar multiple of the inverse of the matrix of
the given quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint_primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 -2 ]</span>
<span class="go">[ *  1 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes">
<span class="sig-name descname"><span class="pre">anisotropic_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.anisotropic_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with all of the anisotropic primes of the quadratic form.</p>
<p>The infinite place is denoted by <span class="math notranslate nohighlight">\(-1\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[2, -1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[2, -1]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">anisotropic_primes</span><span class="p">()</span>
<span class="go">[-1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint">
<span class="sig-name descname"><span class="pre">antiadjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.antiadjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives an (integral) form such that its adjoint is the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 -1 ]</span>
<span class="go">[ * 2 -1 ]</span>
<span class="go">[ * * 5 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">antiadjoint</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: not an adjoint</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group">
<span class="sig-name descname"><span class="pre">automorphism_group</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphism_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the group of automorphisms of the quadratic form.</p>
<p>OUTPUT: a <code class="xref py py-class docutils literal notranslate"><span class="pre">MatrixGroup</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 3 generators (</span>
<span class="go">[-1  0  0]  [0 0 1]  [ 0  0  1]</span>
<span class="go">[ 0 -1  0]  [0 1 0]  [-1  0  0]</span>
<span class="go">[ 0  0 -1], [1 0 0], [ 0  1  0]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 4 generators (</span>
<span class="go">[-1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]  [ 1  0  0  0]</span>
<span class="go">[ 0 -1  0  0]  [ 0 -1  0  0]  [ 0  1  0  0]  [ 0  1  0  0]</span>
<span class="go">[ 0  0 -1  0]  [ 0  0  1  0]  [ 0  0 -1  0]  [ 0  0  1  0]</span>
<span class="go">[ 0  0  0 -1], [ 0  0  0  1], [ 0  0  0  1], [ 0  0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The smallest possible automorphism group has order two, since we
can always change all signs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">automorphism_group</span><span class="p">()</span>
<span class="go">Matrix group over Rational Field with 1 generators (</span>
<span class="go">[-1  0  0]</span>
<span class="go">[ 0 -1  0]</span>
<span class="go">[ 0  0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms">
<span class="sig-name descname"><span class="pre">automorphisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of the automorphisms of the quadratic form.</p>
<p>OUTPUT: a list of matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="n">aut</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">aut</span><span class="p">)</span>
<span class="go">16</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q</span> <span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">aut</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">automorphisms</span><span class="p">())</span>
<span class="go">[</span>
<span class="go">[-1  0  0]  [1 0 0]</span>
<span class="go">[ 0 -1  0]  [0 1 0]</span>
<span class="go">[ 0  0 -1], [0 0 1]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to">
<span class="sig-name descname"><span class="pre">base_change_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_change_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Alters the quadratic form to have all coefficients
defined over the new base_ring R.  Here R must be
coercible to from the current base ring.</p>
<p>Note: This is preferable to performing an explicit
coercion through the base_ring() method, which does
not affect the individual coefficients.  This is
particularly useful for performing fast modular
arithmetic evaluations.</p>
<dl class="simple">
<dt>INPUT:</dt><dd><p>R – a ring</p>
</dd>
<dt>OUTPUT:</dt><dd><p>quadratic form</p>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">base_change_to</span><span class="p">(</span><span class="n">IntegerModRing</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">Q1</span>
<span class="go">Quadratic form in 2 variables over Ring of integers modulo 5 with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 1 ]</span>

<span class="gp">sage: </span><span class="n">Q1</span><span class="p">([</span><span class="mi">35</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring">
<span class="sig-name descname"><span class="pre">base_ring</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.base_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the ring over which the quadratic form is defined.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma">
<span class="sig-name descname"><span class="pre">basiclemma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemma" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a number represented by self and coprime to M.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemma</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">71</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec">
<span class="sig-name descname"><span class="pre">basiclemmavec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basiclemmavec" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a vector where the value of the quadratic form is coprime to M.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basiclemmavec</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(6, 5)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">227</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors">
<span class="sig-name descname"><span class="pre">basis_of_short_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_lengths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.basis_of_short_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a basis for <span class="math notranslate nohighlight">\(\ZZ^n\)</span> made of vectors with minimal lengths Q(<span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>OUTPUT:</p>
<p>a tuple of vectors, and optionally a tuple of values for each vector.</p>
<p>This uses <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfminim">pari:qfminim</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">()</span>
<span class="go">((1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(((1, 0, 0, 0), (0, 1, 0, 0), (0, 0, 1, 0), (0, 0, 0, 1)), (1, 3, 5, 7))</span>
</pre></div>
</div>
<p>The returned vectors are immutable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">basis_of_short_vectors</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">v</span>
<span class="go">(1, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: vector is immutable; please change a copy instead (use copy())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map">
<span class="sig-name descname"><span class="pre">bilinear_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.bilinear_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the associated bilinear map on two vectors</p>
<p>Given a quadratic form <span class="math notranslate nohighlight">\(Q\)</span> over some base ring <span class="math notranslate nohighlight">\(R\)</span> with
characteristic not equal to 2, this gives the image of two
vectors with coefficients in <span class="math notranslate nohighlight">\(R\)</span> under the associated bilinear
map <span class="math notranslate nohighlight">\(B\)</span>, given by the relation <span class="math notranslate nohighlight">\(2 B(v,w) = Q(v) + Q(w) - Q(v+w)\)</span>.</p>
<p>INPUT:</p>
<p><span class="math notranslate nohighlight">\(v, w\)</span> – two vectors</p>
<p>OUTPUT:</p>
<p>an element of the base ring <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<p>First, an example over <span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<p>This also works over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">19/4</span>
</pre></div>
</div>
<p>The vectors must have the correct length:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: vectors must have length 3</span>
</pre></div>
</div>
<p>This does not work if the characteristic is 2:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">vector</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">bilinear_map</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: not defined for rings of characteristic 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition">
<span class="sig-name descname"><span class="pre">cholesky_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bit_prec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">53</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.cholesky_decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Give the Cholesky decomposition of this quadratic form <span class="math notranslate nohighlight">\(Q\)</span> as a real matrix
of precision <code class="docutils literal notranslate"><span class="pre">bit_prec</span></code>.</p>
<p>RESTRICTIONS:</p>
<blockquote>
<div><p>Q must be given as a QuadraticForm defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>, <span class="math notranslate nohighlight">\(\QQ\)</span>, or some
real field. If it is over some real field, then an error is raised if
the precision given is not less than the defined precision of the real
field defining the quadratic form!</p>
</div></blockquote>
<p>REFERENCE:</p>
<blockquote>
<div><p>From Cohen’s “A Course in Computational Algebraic Number Theory” book,
p 103.</p>
</div></blockquote>
<p>INPUT:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">bit_prec</span></code> – a natural number (default 53).</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>an upper triangular real matrix of precision <code class="docutils literal notranslate"><span class="pre">bit_prec</span></code>.</p>
</div></blockquote>
<dl class="simple">
<dt>TO DO:</dt><dd><p>If we only care about working over the real double field (RDF), then we
can use the <code class="docutils literal notranslate"><span class="pre">cholesky()</span></code> method present for square matrices over that.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a note in the original code reading</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">##/////////////////////////////////////////////////////////////////////////////////////////////////</span>
<span class="go">##/// Finds the Cholesky decomposition of a quadratic form -- as an upper-triangular matrix!</span>
<span class="go">##/// (It&#39;s assumed to be global, hence twice the form it refers to.)  &lt;-- Python revision asks:  Is this true?!? =|</span>
<span class="go">##/////////////////////////////////////////////////////////////////////////////////////////////////</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000 0.000000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.00000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000 0.000000000000000  1.00000000000000]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 2 3 ]</span>
<span class="go">[ * 4 5 ]</span>
<span class="go">[ * * 6 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">cholesky_decomposition</span><span class="p">()</span>
<span class="go">[ 1.00000000000000  1.00000000000000  1.50000000000000]</span>
<span class="go">[0.000000000000000  3.00000000000000 0.333333333333333]</span>
<span class="go">[0.000000000000000 0.000000000000000  3.41666666666667]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor">
<span class="sig-name descname"><span class="pre">clifford_conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all primes where the Clifford invariant is -1</p>
<p>Note: For ternary forms, this is the discriminant of the
quaternion algebra associated to the quadratic space
(i.e. the even Clifford algebra)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">37</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">30</span>
</pre></div>
</div>
<p>For hyperbolic spaces, the clifford conductor is 1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant">
<span class="sig-name descname"><span class="pre">clifford_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.clifford_invariant" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the Clifford invariant, i.e. the class in the Brauer group of the
Clifford algebra for even dimension, of the even Clifford Algebra for odd dimension.</p>
<p>See Lam (AMS GSM 67) p. 117 for the definition, and p. 119 for the formula
relating it to the Hasse invariant.</p>
<p>EXAMPLES:</p>
<p>For hyperbolic spaces, the clifford invariant is +1:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">H</span><span class="p">)</span><span class="o">.</span><span class="n">clifford_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients">
<span class="sig-name descname"><span class="pre">coefficients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.coefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the matrix of upper triangular coefficients,
by reading across the rows from the main diagonal.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">coefficients</span><span class="p">()</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector">
<span class="sig-name descname"><span class="pre">complementary_subform_to_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.complementary_subform_to_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the <span class="math notranslate nohighlight">\((n-1)\)</span>-dim’l quadratic form orthogonal to the vector <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>Note: This is usually not a direct summand!</p>
<p>Technical Notes: There is a minor difference in the cancellation
code here (form the C++ version) since the notation Q <span class="math notranslate nohighlight">\([i,j]\)</span> indexes
coefficients of the quadratic polynomial here, not the symmetric
matrix.  Also, it produces a better splitting now, for the full
lattice (as opposed to a sublattice in the C++ code) since we
now extend <span class="math notranslate nohighlight">\(v\)</span> to a unimodular matrix.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(v\)</span> – a list of self.dim() integers</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a QuadraticForm over <span class="math notranslate nohighlight">\(ZZ\)</span></p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 7 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 3 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 7 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 12 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">complementary_subform_to_vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 880 -480 -160 ]</span>
<span class="go">[ * 624 -96 ]</span>
<span class="go">[ * * 240 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness">
<span class="sig-name descname"><span class="pre">compute_definiteness</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes whether the given quadratic form is positive-definite,
negative-definite, indefinite, degenerate, or the zero form.</p>
<p>This caches one of the following strings in self.__definiteness_string:
“pos_def”, “neg_def”, “indef”, “zero”, “degenerate”.  It is called
from all routines like:</p>
<blockquote>
<div><p>is_positive_definite(), is_negative_definite(), is_indefinite(), etc.</p>
</div></blockquote>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim’l form is considered both positive definite and negative definite.</p>
<p>INPUT:</p>
<blockquote>
<div><p>QuadraticForm</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants">
<span class="sig-name descname"><span class="pre">compute_definiteness_string_by_determinants</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.compute_definiteness_string_by_determinants" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the (positive) definiteness of a quadratic form by looking
at the signs of all of its upper-left subdeterminants.  See also
self.compute_definiteness() for more documentation.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>string describing the definiteness</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;pos_def&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;zero&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;degenerate&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;indefinite&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">compute_definiteness_string_by_determinants</span><span class="p">()</span>
<span class="go">&#39;neg_def&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.content">
<span class="sig-name descname"><span class="pre">content</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.content" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the GCD of the coefficients of the quadratic form.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only works over Euclidean domains (probably just <span class="math notranslate nohighlight">\(\ZZ\)</span>).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">content</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power">
<span class="sig-name descname"><span class="pre">conway_cross_product_doubled_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_cross_product_doubled_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes twice the power of p which evaluates the ‘cross product’
term in Conway’s mass formula.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">18</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_cross_product_doubled_power</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor">
<span class="sig-name descname"><span class="pre">conway_diagonal_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_diagonal_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the diagonal factor of Conway’s <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number &gt; 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_diagonal_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">81/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass">
<span class="sig-name descname"><span class="pre">conway_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mass by using the Conway-Sloane mass formula.</p>
<p>OUTPUT:</p>
<p>a rational number &gt; 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">1/48</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">3/16</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">3/32</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="go">1/12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2">
<span class="sig-name descname"><span class="pre">conway_octane_of_this_unimodular_Jordan_block_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_octane_of_this_unimodular_Jordan_block_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the ‘octane’ of this full unimodular Jordan block at
the prime <span class="math notranslate nohighlight">\(p=2\)</span>.  This is an invariant defined <span class="math notranslate nohighlight">\((mod 8)\)</span>, ad.</p>
<p>This assumes that the form is given as a block diagonal form with
unimodular blocks of size &lt;= 2 and the 1x1 blocks are all in the upper
leftmost position.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>an integer 0 &lt;= x &lt;= 7</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">13</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_octane_of_this_unimodular_Jordan_block_at_2</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass">
<span class="sig-name descname"><span class="pre">conway_p_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_p_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Conway’s <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number &gt; 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">16/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_p_mass</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">729/256</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2">
<span class="sig-name descname"><span class="pre">conway_species_list_at_2</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer called the ‘species’ which determines the type
of the orthogonal group over the finite field <span class="math notranslate nohighlight">\(F_p\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math notranslate nohighlight">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative.</p>
<p>Note: The species of a zero dim’l form is always 0+, so we
interpret the return value of zero as positive here! =)</p>
<p>OUTPUT:</p>
<blockquote>
<div><p>a list of integers</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 5, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_2</span><span class="p">()</span>
<span class="go">[1, 3, 1, 1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime">
<span class="sig-name descname"><span class="pre">conway_species_list_at_odd_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_species_list_at_odd_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an integer called the ‘species’ which determines the type
of the orthogonal group over the finite field <span class="math notranslate nohighlight">\(F_p\)</span>.</p>
<p>This assumes that the given quadratic form is a unimodular Jordan
block at an odd prime <span class="math notranslate nohighlight">\(p\)</span>.  When the dimension is odd then this
number is always positive, otherwise it may be positive or
negative (or zero, but that is considered positive by convention).</p>
<p>Note: The species of a zero dim’l form is always 0+, so we
interpret the return value of zero as positive here! =)</p>
<p>INPUT:</p>
<blockquote>
<div><p>a positive prime number</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a list of integers</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[6, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[5, 2]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_species_list_at_odd_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[-6, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass">
<span class="sig-name descname"><span class="pre">conway_standard_mass</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the infinite product of the standard mass factors.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number &gt; 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>
<span class="go">1/6</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_mass</span><span class="p">()</span>
<span class="go">1/6</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass">
<span class="sig-name descname"><span class="pre">conway_standard_p_mass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_standard_p_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the standard (generic) Conway-Sloane <span class="math notranslate nohighlight">\(p\)</span>-mass.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number &gt; 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_standard_p_mass</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor">
<span class="sig-name descname"><span class="pre">conway_type_factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.conway_type_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a special factor only present in the mass formula when <span class="math notranslate nohighlight">\(p=2\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conway_type_factor</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions">
<span class="sig-name descname"><span class="pre">count_congruence_solutions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts all solutions of Q(<span class="math notranslate nohighlight">\(x\)</span>) <span class="math notranslate nohighlight">\(= m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers in range(self.dim()), or None</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">15</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-type solutions of Q(<span class="math notranslate nohighlight">\(x\)</span>) <span class="math notranslate nohighlight">\(= m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type_I</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_I" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-typeI solutions of Q(<span class="math notranslate nohighlight">\(x\)</span>) = <span class="math notranslate nohighlight">\(m (mod p^k)\)</span> satisfying
the additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_I</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__bad_type_II</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__bad_type_II" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the bad-typeII solutions of Q(<span class="math notranslate nohighlight">\(x\)</span>) <span class="math notranslate nohighlight">\(= m (mod p^k)\)</span> satisfying
the additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__bad_type_II</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__good_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__good_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the good-type solutions of Q(x) = m (mod p^k) satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__good_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type">
<span class="sig-name descname"><span class="pre">count_congruence_solutions__zero_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions__zero_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Counts the zero-type solutions of Q(<span class="math notranslate nohighlight">\(x\)</span>) = <span class="math notranslate nohighlight">\(m (mod p^k)\)</span> satisfying the
additional congruence conditions described in
QuadraticForm.count_congruence_solutions_as_vector().</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p>
<p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p>
<p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p>
<p>zvec, nzvec – a list of integers up to dim(Q)</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions__zero_type</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector">
<span class="sig-name descname"><span class="pre">count_congruence_solutions_as_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nzvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_congruence_solutions_as_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the number of integer solution vectors <span class="math notranslate nohighlight">\(x\)</span> satisfying the
congruence Q(<span class="math notranslate nohighlight">\(x\)</span>) <span class="math notranslate nohighlight">\(= m (mod p^k)\)</span> of each solution type (i.e. All,
Good, Zero, Bad, BadI, BadII) which satisfy the additional
congruence conditions of having certain coefficients = 0 (mod <span class="math notranslate nohighlight">\(p\)</span>)
and certain collections of coefficients not congruent to the zero
vector (mod <span class="math notranslate nohighlight">\(p\)</span>).</p>
<p>A solution vector <span class="math notranslate nohighlight">\(x\)</span> satisfies the additional congruence conditions
specified by zvec and nzvec (and therefore is counted) iff both of
the following conditions hold:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(x[i] == 0 (mod p)\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> in zvec</p></li>
<li><p><span class="math notranslate nohighlight">\(x[i] != 0 (mod p) for all i\)</span> in nzvec</p></li>
</ol>
</div></blockquote>
<p>REFERENCES:</p>
<p>See Hanke’s (????) paper “Local Densities and explicit bounds…”, p??? for
the definitions of the solution types and congruence conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – prime number &gt; 0</p></li>
<li><p><span class="math notranslate nohighlight">\(k\)</span> – an integer &gt; 0</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer (depending only on mod <span class="math notranslate nohighlight">\(p^k\)</span>)</p></li>
<li><p>zvec, nzvec – a list of integers in range(self.dim()), or None</p></li>
</ul>
<p>OUTPUT:</p>
<p>a list of six integers &gt;= 0 representing the solution types:
[All, Good, Zero, Bad, BadI, BadII]</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[])</span>
<span class="go">[0, 0, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[],</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[6, 6, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">count_congruence_solutions_as_vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">[15, 12, 1, 2, 0, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum">
<span class="sig-name descname"><span class="pre">count_modp_solutions__by_Gauss_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.count_modp_solutions__by_Gauss_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of solutions of <span class="math notranslate nohighlight">\(Q(x) = m (mod p)\)</span> of a
non-degenerate quadratic form over the finite field <span class="math notranslate nohighlight">\(Z/pZ\)</span>,
where <span class="math notranslate nohighlight">\(p\)</span> is a prime number &gt; 2.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We adopt the useful convention that a zero-dimensional
quadratic form has exactly one solution always (i.e. the empty
vector).</p>
</div>
<p>These are defined in Table 1 on p363 of Hanke’s “Local Densities…” paper.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 2</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
</ul>
<p>OUTPUT: an integer &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 6, 12]</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">count_modp_solutions__by_Gauss_sum</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[9, 12, 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.delta">
<span class="sig-name descname"><span class="pre">delta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.delta" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the omega of the adjoint form,
which is the same as the omega of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">delta</span><span class="p">()</span>
<span class="go">148</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.det">
<span class="sig-name descname"><span class="pre">det</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.det" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the determinant of the Gram matrix of 2*Q, or
equivalently the determinant of the Hessian matrix of Q.</p>
<p>(Note: This is always defined over the same ring as the
quadratic form.)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.dim">
<span class="sig-name descname"><span class="pre">dim</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the number of variables of the quadratic form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">())</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.disc">
<span class="sig-name descname"><span class="pre">disc</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.disc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the quadratic form, defined as</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\((-1)^n {\rm det}(B)\)</span> for even dimension <span class="math notranslate nohighlight">\(2n\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\({\rm det}(B)/2\)</span> for odd dimension</p></li>
</ul>
<p>where <span class="math notranslate nohighlight">\(2Q(x) = x^t B x\)</span>.</p>
<p>This agrees with the usual discriminant for binary and ternary quadratic forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">-4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.discrec">
<span class="sig-name descname"><span class="pre">discrec</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.discrec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">disc</span><span class="p">()</span>
<span class="go">148</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">discrec</span><span class="p">()</span>
<span class="go">5476</span>
<span class="gp">sage: </span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">37</span><span class="o">^</span><span class="mi">2</span><span class="p">]</span>
<span class="go">[148, 5476]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable">
<span class="sig-name descname"><span class="pre">divide_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.divide_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the variables <span class="math notranslate nohighlight">\(x_i\)</span> by <span class="math notranslate nohighlight">\((x_i)/c\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<p>Here <span class="math notranslate nohighlight">\(c\)</span> must be an element of the base_ring defining the
quadratic form, and the division must be defined in the base
ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> – an element of Q.base_ring()</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span> – an integer &gt;= 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a QuadraticForm (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">divide_variable</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution">
<span class="sig-name descname"><span class="pre">elementary_substitution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">j</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.elementary_substitution" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the substitution <span class="math notranslate nohighlight">\(x_i --&gt; x_i + c*x_j\)</span> (replacing the
original form if the in_place flag is True).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> – an element of Q.base_ring()</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> – integers &gt;= 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a QuadraticForm (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">elementary_substitution</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[1 0 0 1]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 6 ]</span>
<span class="go">[ * 5 6 9 ]</span>
<span class="go">[ * * 8 12 ]</span>
<span class="go">[ * * * 15 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables">
<span class="sig-name descname"><span class="pre">extract_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">QF</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_indices</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.extract_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the variables (in order) whose indices are listed in
<code class="docutils literal notranslate"><span class="pre">var_indices</span></code>, to give a new quadratic form.</p>
<p>INPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">var_indices</span></code> – a list of integers &gt;= 0</p>
<p>OUTPUT:</p>
<p>a QuadraticForm</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">extract_variables</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 6 ]</span>
<span class="go">[ * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime">
<span class="sig-name descname"><span class="pre">find_entry_with_minimal_scale_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_entry_with_minimal_scale_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the entry of the quadratic form with minimal scale at the
prime p, preferring diagonal entries in case of a tie.  (I.e.  If
we write the quadratic form as a symmetric matrix M, then this
entry M[i,j] has the minimal valuation at the prime p.)</p>
<p>Note: This answer is independent of the kind of matrix (Gram or
Hessian) associated to the form.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a pair of integers &gt;= 0</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 6 2 ]</span>
<span class="go">[ * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(0, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_entry_with_minimal_scale_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec">
<span class="sig-name descname"><span class="pre">find_p_neighbor_from_vec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_p_neighbor_from_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(p\)</span>-neighbor of <code class="docutils literal notranslate"><span class="pre">self</span></code> defined by <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\((L,q)\)</span> be a lattice with <span class="math notranslate nohighlight">\(b(L,L) \subseteq \ZZ\)</span> which is maximal at <span class="math notranslate nohighlight">\(p\)</span>.
Let <span class="math notranslate nohighlight">\(y \in L\)</span> with <span class="math notranslate nohighlight">\(b(y,y) \in p^2\ZZ\)</span> then the <span class="math notranslate nohighlight">\(p\)</span>-neighbor of
<span class="math notranslate nohighlight">\(L\)</span> at <span class="math notranslate nohighlight">\(y\)</span> is given by
<span class="math notranslate nohighlight">\(\ZZ y/p + L_y\)</span> where <span class="math notranslate nohighlight">\(L_y = \{x \in L | b(x,y) \in p \ZZ \}\)</span>
and <span class="math notranslate nohighlight">\(b(x,y) = q(x+y)-q(x)-q(y)\)</span> is the bilinear form associated to <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> – a vector with <span class="math notranslate nohighlight">\(q(y) \in p \ZZ\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">odd</span></code> – (default=``False``) if <span class="math notranslate nohighlight">\(p=2\)</span> return also odd neighbors</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_p_neighbor_from_vec</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">v</span><span class="p">);</span> <span class="n">X</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 4 4 ]</span>
<span class="go">[ * * 5 12 ]</span>
<span class="go">[ * * * 9 ]</span>
</pre></div>
</div>
<p>Since the base ring and the domain are not yet separate,
for rational, half integral forms we just pretend
the base ring is <span class="math notranslate nohighlight">\(ZZ\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">find_p_neighbor_from_vec</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/2 1 1 1 ]</span>
<span class="go">[ * 1 1 2 ]</span>
<span class="go">[ * * 1 2 ]</span>
<span class="go">[ * * * 2 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next">
<span class="sig-name descname"><span class="pre">find_primitive_p_divisible_vector__next</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__next" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the next <span class="math notranslate nohighlight">\(p\)</span>-primitive vector (up to scaling) in <span class="math notranslate nohighlight">\(L/pL\)</span> whose
value is <span class="math notranslate nohighlight">\(p\)</span>-divisible, where the last vector returned was <span class="math notranslate nohighlight">\(v\)</span>.  For
an initial call, no <span class="math notranslate nohighlight">\(v\)</span> needs to be passed.</p>
<p>Returns vectors whose last non-zero entry is normalized to 0 or 1 (so no
lines are counted repeatedly).  The ordering is by increasing the
first non-normalized entry.  If we have tested all (lines of)
vectors, then return None.</p>
<p>OUTPUT:</p>
<p>vector or None</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span> <span class="n">v</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__next</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random">
<span class="sig-name descname"><span class="pre">find_primitive_p_divisible_vector__random</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.find_primitive_p_divisible_vector__random" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a random <span class="math notranslate nohighlight">\(p\)</span>-primitive vector in <span class="math notranslate nohighlight">\(L/pL\)</span> whose value is <span class="math notranslate nohighlight">\(p\)</span>-divisible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since there are about <span class="math notranslate nohighlight">\(p^{(n-2)}\)</span> of these lines, we have a <span class="math notranslate nohighlight">\(1/p\)</span>
chance of randomly finding an appropriate vector.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="mf">5.</span><span class="n">divides</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">find_primitive_p_divisible_vector__random</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.gcd">
<span class="sig-name descname"><span class="pre">gcd</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the greatest common divisor of the coefficients of the
quadratic form (as a polynomial).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">gcd</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.genera">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">genera</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sig_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">determinant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.genera" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of all global genera with the given conditions.</p>
<p>Here a genus is called global if it is non-empty.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sig_pair</span></code> – a pair of non-negative integers giving the signature</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">determinant</span></code> – an integer; the sign is ignored</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_scale</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) an integer; the maximum scale of a
jordan block</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">even</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of all (non-empty) global genera with the given conditions.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="o">.</span><span class="n">genera</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="mi">125</span><span class="p">,</span> <span class="n">even</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^1 5^3, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^-2 5^1 25^-1, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^2 5^1 25^1, Genus of</span>
<span class="go">None</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 5:     1^3 125^1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol">
<span class="sig-name descname"><span class="pre">global_genus_symbol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.global_genus_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the genus of two times a quadratic form over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>These are defined by a collection of local genus symbols (a la
Chapter 15 of Conway-Sloane <a class="reference internal" href="../../../references/index.html#cs1999" id="id1"><span>[CS1999]</span></a>), and a signature.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of</span>
<span class="go">[2 0 0 0]</span>
<span class="go">[0 4 0 0]</span>
<span class="go">[0 0 6 0]</span>
<span class="go">[0 0 0 8]</span>
<span class="go">Signature:  (4, 0)</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">global_genus_symbol</span><span class="p">()</span>
<span class="go">Genus of</span>
<span class="go">[ 0  1  2  3]</span>
<span class="go">[ 1  8  5  6]</span>
<span class="go">[ 2  5 14  8]</span>
<span class="go">[ 3  6  8 18]</span>
<span class="go">Signature:  (3, 1)</span>
<span class="go">Genus symbol at 2:    1^-4</span>
<span class="go">Genus symbol at 563:     1^3 563^-1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime">
<span class="sig-name descname"><span class="pre">has_equivalent_Jordan_decomposition_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_equivalent_Jordan_decomposition_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form has a Jordan decomposition
equivalent to that of self.</p>
<p>INPUT:</p>
<p>a QuadraticForm</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">level</span><span class="p">(),</span> <span class="n">Q3</span><span class="o">.</span><span class="n">level</span><span class="p">()]</span>
<span class="go">[44, 44, 44]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">has_equivalent_Jordan_decomposition_at_prime</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix">
<span class="sig-name descname"><span class="pre">has_integral_Gram_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.has_integral_Gram_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the quadratic form has an integral Gram matrix (with respect to its base ring).</p>
<p>A warning is issued if the form is defined over a field, since in that case the return is trivially true.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">has_integral_Gram_matrix</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor">
<span class="sig-name descname"><span class="pre">hasse_conductor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_conductor" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the product of all primes where the Hasse invariant equals -1</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">74</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span><span class="o">.</span><span class="n">hasse_conductor</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant">
<span class="sig-name descname"><span class="pre">hasse_invariant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Hasse invariant at a prime <span class="math notranslate nohighlight">\(p\)</span> or at infinity, as given on p55 of
Cassels’s book.  If Q is diagonal with coefficients <span class="math notranslate nohighlight">\(a_i\)</span>, then the
(Cassels) Hasse invariant is given by</p>
<div class="math notranslate nohighlight">
\[c_p = \prod_{i &lt; j} (a_i, a_j)_p\]</div>
<p>where <span class="math notranslate nohighlight">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math notranslate nohighlight">\(p\)</span>.  The underlying
quadratic form must be non-degenerate over <span class="math notranslate nohighlight">\(Q_p\)</span> for this to make
sense.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is different from the O’Meara Hasse invariant, which
allows <span class="math notranslate nohighlight">\(i &lt;= j\)</span> in the product.  That is given by the method
hasse_invariant__OMeara(p).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We should really rename this hasse_invariant__Cassels(), and
set hasse_invariant() as a front-end to it.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT:</p>
<p>1 or -1</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>
<span class="go">[-1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara">
<span class="sig-name descname"><span class="pre">hasse_invariant__OMeara</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.hasse_invariant__OMeara" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the O’Meara Hasse invariant at a prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is defined on
p167 of O’Meara’s book. If Q is diagonal with coefficients <span class="math notranslate nohighlight">\(a_i\)</span>,
then the (Cassels) Hasse invariant is given by</p>
<div class="math notranslate nohighlight">
\[c_p = \prod_{i &lt;= j} (a_i, a_j)_p\]</div>
<p>where <span class="math notranslate nohighlight">\((a,b)_p\)</span> is the Hilbert symbol at <span class="math notranslate nohighlight">\(p\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is different from the (Cassels) Hasse invariant, which
only allows <span class="math notranslate nohighlight">\(i &lt; j\)</span> in the product.  That is given by the method
hasse_invariant(p).</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT:</p>
<p>1 or -1</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 2 ]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="go">[-1, 1, 1, 1, 1, 1, 1, 1]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;=</span><span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q</span><span class="o">.</span><span class="n">hasse_invariant__OMeara</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">K</span><span class="o">.</span><span class="n">primes_above</span><span class="p">(</span><span class="mi">19</span><span class="p">)]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint">
<span class="sig-name descname"><span class="pre">is_adjoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given form is the adjoint of another form</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span><span class="o">.</span><span class="n">is_adjoint</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic">
<span class="sig-name descname"><span class="pre">is_anisotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_anisotropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the quadratic form is anisotropic over the p-adic numbers <span class="math notranslate nohighlight">\(\QQ_p\)</span> or <span class="math notranslate nohighlight">\(\RR\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_anisotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[True, True, True, True, True, True, True, True, True]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite">
<span class="sig-name descname"><span class="pre">is_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is (positive or negative) definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim’l form is considered indefinite.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean – True or False</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_even">
<span class="sig-name descname"><span class="pre">is_even</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_even" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true iff after rescaling by some appropriate factor, the
form represents no odd integers.  For more details, see parity().</p>
<p>Requires that Q is defined over <span class="math notranslate nohighlight">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to">
<span class="sig-name descname"><span class="pre">is_globally_equivalent_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_globally_equivalent_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the current quadratic form is equivalent to the
given form over ZZ.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is True, then we return the transformation
matrix <span class="math notranslate nohighlight">\(M\)</span> so that <code class="docutils literal notranslate"><span class="pre">self(M)</span> <span class="pre">==</span> <span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code>, <code class="docutils literal notranslate"><span class="pre">other</span></code> – positive definite integral quadratic forms</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) return
the transformation matrix instead of a boolean</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>: a boolean</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>: either <code class="docutils literal notranslate"><span class="pre">False</span></code> or the
transformation matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">Q</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">MM</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q1</span><span class="p">,</span> <span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">MM</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q1</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">,</span> <span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q3</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[-1 -1  0]</span>
<span class="go">[ 1  1  1]</span>
<span class="go">[-1  0  0]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="p">(</span><span class="n">M</span><span class="p">)</span> <span class="o">==</span> <span class="n">Q3</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: not a definite form in QuadraticForm.is_globally_equivalent_to()</span>
</pre></div>
</div>
<p>ALGORITHM: this uses the PARI function <a class="reference external" href="https://pari.math.u-bordeaux.fr/dochtml/help/qfisom">pari:qfisom</a>, implementing
an algorithm by Plesken and Souvignier.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic">
<span class="sig-name descname"><span class="pre">is_hyperbolic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_hyperbolic" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the quadratic form is a sum of hyperbolic planes over
the <span class="math notranslate nohighlight">\(p\)</span>-adic numbers <span class="math notranslate nohighlight">\(\QQ_p\)</span> or over the real numbers <span class="math notranslate nohighlight">\(\RR\)</span>.</p>
<p>REFERENCES:</p>
<p>This criteria follows from Cassels’s “Rational Quadratic Forms”:</p>
<ul class="simple">
<li><p>local invariants for hyperbolic plane (Lemma 2.4, p58)</p></li>
<li><p>direct sum formulas (Lemma 2.3, p58)</p></li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>     <span class="c1">## Here -1 is a square, so it&#39;s true.</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_hyperbolic</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>    <span class="c1">## Here -1 is a square, so it&#39;s true.</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite">
<span class="sig-name descname"><span class="pre">is_indefinite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_indefinite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is indefinite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim’l form is not considered indefinite.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean – True or False</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_indefinite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic">
<span class="sig-name descname"><span class="pre">is_isotropic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_isotropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if Q is isotropic over the p-adic numbers <span class="math notranslate nohighlight">\(Q_p\)</span> or <span class="math notranslate nohighlight">\(RR\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or <span class="math notranslate nohighlight">\(-1\)</span> for the infinite place</p></li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="o">-</span><span class="n">p</span><span class="o">*</span><span class="n">least_quadratic_nonresidue</span><span class="p">(</span><span class="n">p</span><span class="p">)])</span><span class="o">.</span><span class="n">is_isotropic</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>  <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="go">[False, False, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to">
<span class="sig-name descname"><span class="pre">is_locally_equivalent_to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_primes_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_jordan_equivalence_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_equivalent_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the current quadratic form (defined over ZZ) is
locally equivalent to the given form over the real numbers and the
<span class="math notranslate nohighlight">\(p\)</span>-adic integers for every prime p.</p>
<p>This works by comparing the local Jordan decompositions at every
prime, and the dimension and signature at the real place.</p>
<p>INPUT:</p>
<p>a QuadraticForm</p>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_globally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number">
<span class="sig-name descname"><span class="pre">is_locally_represented_number</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the rational number m is locally represented by the quadratic form.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place">
<span class="sig-name descname"><span class="pre">is_locally_represented_number_at_place</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_represented_number_at_place" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the rational number m is locally represented by the
quadratic form at the (possibly infinite) prime <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p>
<p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0 or ‘infinity’</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">infinity</span><span class="p">)</span>     <span class="c1"># long time (8.5 s)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_represented_number_at_place</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>            <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_all_places</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_places" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the quadratic form represents <span class="math notranslate nohighlight">\(Z_p\)</span> for all
finite/non-archimedean primes, and represents all real numbers.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_places</span><span class="p">()</span>        <span class="c1"># long time (8.5 s)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_all_primes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_all_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the quadratic form represents <span class="math notranslate nohighlight">\(Z_p\)</span> for all finite/non-archimedean primes.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_all_primes</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime">
<span class="sig-name descname"><span class="pre">is_locally_universal_at_prime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_locally_universal_at_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the (integer-valued/rational) quadratic form represents all of <span class="math notranslate nohighlight">\(Z_p\)</span>.</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a positive prime number or “infinity”.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_locally_universal_at_prime</span><span class="p">(</span><span class="n">infinity</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite">
<span class="sig-name descname"><span class="pre">is_negative_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_negative_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is negative-definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim’l form is considered both positive definite and negative definite.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean – True or False</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_negative_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd">
<span class="sig-name descname"><span class="pre">is_odd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true iff after rescaling by some appropriate factor, the
form represents some odd integers.  For more details, see parity().</p>
<p>Requires that Q is defined over <span class="math notranslate nohighlight">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite">
<span class="sig-name descname"><span class="pre">is_positive_definite</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_positive_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given quadratic form is positive-definite.</p>
<p>Note:  A degenerate form is considered neither definite nor indefinite.
Note:  The zero-dim’l form is considered both positive definite and negative definite.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>boolean – True or False</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive">
<span class="sig-name descname"><span class="pre">is_primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the given integer-valued form is primitive
(i.e. not an integer (&gt;1) multiple of another integer-valued
quadratic form).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_primitive</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_rationally_isometric">
<span class="sig-name descname"><span class="pre">is_rationally_isometric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_rationally_isometric" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if two regular quadratic forms over a number field are isometric.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> – a quadratic form over a number field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default <code class="docutils literal notranslate"><span class="pre">False</span></code>) return
the transformation matrix instead of a boolean; this is currently only implemented for forms over <code class="docutils literal notranslate"><span class="pre">QQ</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>: a boolean</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>: either <code class="docutils literal notranslate"><span class="pre">False</span></code> or the
transformation matrix</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">V</span>
<span class="go">Quadratic form in 4 variables over Number Field in a with defining polynomial x^2 - 3 with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 2*a 0 0 ]</span>
<span class="go">[ * * a 0 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">]);</span> <span class="n">W</span>
<span class="go">Quadratic form in 4 variables over Number Field in a with defining polynomial x^2 - 3 with coefficients:</span>
<span class="go">[ 1 2*a 4 6 ]</span>
<span class="go">[ * 3 10 2 ]</span>
<span class="go">[ * * 1 2 ]</span>
<span class="go">[ * * * 5 ]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">V</span>
<span class="go">Quadratic form in 5 variables over Number Field in a with defining polynomial x^4 + 2*x + 6 with coefficients:</span>
<span class="go">[ a 0 0 0 0 ]</span>
<span class="go">[ * 2 0 0 0 ]</span>
<span class="go">[ * * 3 0 0 ]</span>
<span class="go">[ * * * 2 0 ]</span>
<span class="go">[ * * * * 1 ]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">W</span>
<span class="go">Quadratic form in 5 variables over Number Field in a with defining polynomial x^4 + 2*x + 6 with   coefficients:</span>
<span class="go">[ a 0 0 0 0 ]</span>
<span class="go">[ * a 0 0 0 ]</span>
<span class="go">[ * * a 0 0 ]</span>
<span class="go">[ * * * 2 0 ]</span>
<span class="go">[ * * * * 1 ]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[   0    0    1]</span>
<span class="go">[-1/2 -1/2    0]</span>
<span class="go">[ 1/2 -1/2    0]</span>
<span class="gp">sage: </span><span class="n">V</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">W</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[ 0 -1  1]</span>
<span class="go">[ 0 -1 -1]</span>
<span class="go">[ 1  0  0]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">V</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">81</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[  1  -2]</span>
<span class="go">[  0 1/3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">B</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[   0 -5/6  1/2]</span>
<span class="go">[   0  1/6  1/2]</span>
<span class="go">[  -1    0    0]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">is_rationally_isometric</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="kc">True</span><span class="p">);</span> <span class="n">T</span>
<span class="go">[     -4 -189/17]</span>
<span class="go">[     -1  -43/17]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero">
<span class="sig-name descname"><span class="pre">is_zero</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector v is on the conic Q(x) = 0 (mod p).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular">
<span class="sig-name descname"><span class="pre">is_zero_nonsingular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_nonsingular" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector <span class="math notranslate nohighlight">\(v\)</span> is on the conic Q(<span class="math notranslate nohighlight">\(x\)</span>) = 0 (mod <span class="math notranslate nohighlight">\(p\)</span>),
and that this point is non-singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_nonsingular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular">
<span class="sig-name descname"><span class="pre">is_zero_singular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.is_zero_singular" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the vector <span class="math notranslate nohighlight">\(v\)</span> is on the conic Q(<span class="math notranslate nohighlight">\(x\)</span>) = 0 (mod <span class="math notranslate nohighlight">\(p\)</span>),
and that this point is singular point of the conic.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_zero_singular</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">37</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular">
<span class="sig-name descname"><span class="pre">jordan_blocks_by_scale_and_unimodular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_by_scale_and_unimodular" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of pairs <span class="math notranslate nohighlight">\((s_i, L_i)\)</span> where <span class="math notranslate nohighlight">\(L_i\)</span> is a maximal
<span class="math notranslate nohighlight">\(p^{s_i}\)</span>-unimodular Jordan component which is further decomposed into
block diagonals of block size <span class="math notranslate nohighlight">\(\le 2\)</span>.</p>
<p>For each <span class="math notranslate nohighlight">\(L_i\)</span> the 2x2 blocks are listed after the 1x1 blocks
(which follows from the convention of the
<a class="reference internal" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">local_normal_form()</span></code></a> method).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The decomposition of each <span class="math notranslate nohighlight">\(L_i\)</span> into smaller blocks is not unique!</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">safe_flag</span></code> argument allows us to select whether we want a copy of
the output, or the original output.  By default <code class="docutils literal notranslate"><span class="pre">safe_flag</span> <span class="pre">=</span> <span class="pre">True</span></code>, so we
return a copy of the cached information.  If this is set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, then
the routine is much faster but the return values are vulnerable to being
corrupted by the user.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of pairs <span class="math notranslate nohighlight">\((s_i, L_i)\)</span> where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(s_i\)</span> is an integer,</p></li>
<li><p><span class="math notranslate nohighlight">\(L_i\)</span> is a block-diagonal unimodular quadratic form over <span class="math notranslate nohighlight">\(\ZZ_p\)</span>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These forms <span class="math notranslate nohighlight">\(L_i\)</span> are defined over the <span class="math notranslate nohighlight">\(p\)</span>-adic integers, but by a
matrix over <span class="math notranslate nohighlight">\(\ZZ\)</span> (or <span class="math notranslate nohighlight">\(\QQ\)</span>?).</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[(0, Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]), (2, Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 ])]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ])]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">Q2</span> <span class="o">+</span> <span class="n">Q2</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_by_scale_and_unimodular</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(-1, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ]), (0, Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 2 ]</span>
<span class="go">[ * 2 ])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power">
<span class="sig-name descname"><span class="pre">jordan_blocks_in_unimodular_list_by_scale_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.jordan_blocks_in_unimodular_list_by_scale_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of Jordan components, whose component at index i
should be scaled by the factor p^i.</p>
<p>This is only defined for integer-valued quadratic forms
(i.e. forms with base_ring ZZ), and the indexing only works
correctly for p=2 when the form has an integer Gram matrix.</p>
<p>INPUT:</p>
<blockquote>
<div><p>self – a quadratic form over ZZ, which has integer Gram matrix if p == 2
<span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a list of p-unimodular quadratic forms</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: Oops!  The given quadratic form has a Jordan component with a negative scale exponent!</span>
<span class="go">This routine requires an integer-matrix quadratic form for the output indexing to work properly!</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 2 ]</span>
<span class="go">[ * 0 ], Quadratic form in 0 variables over Integer Ring with coefficients:</span>
<span class="go">, Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 345 ]]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">jordan_blocks_in_unimodular_list_by_scale_power</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 0 ]</span>
<span class="go">[ * 10 ], Quadratic form in 1 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level">
<span class="sig-name descname"><span class="pre">level</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the level of the quadratic form over a PID, which is a
generator for the smallest ideal <span class="math notranslate nohighlight">\(N\)</span> of <span class="math notranslate nohighlight">\(R\)</span> such that N * (the matrix of
2*Q)^(-1) is in R with diagonal in 2*R.</p>
<p>Over <span class="math notranslate nohighlight">\(\ZZ\)</span> this returns a non-negative number.</p>
<p>(Caveat: This always returns the unit ideal when working over a field!)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">8</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>      <span class="c1"># random</span>
<span class="go">UserWarning: Warning -- The level of a quadratic form over a field is always 1.  Do you really want to do this?!?</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">420</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria">
<span class="sig-name descname"><span class="pre">level__Tornaria</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level__Tornaria" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of the quadratic form,
defined as</p>
<blockquote>
<div><p>level(B)    for even dimension
level(B)/4  for odd dimension</p>
</div></blockquote>
<p>where 2Q(<span class="math notranslate nohighlight">\(x\)</span>) <span class="math notranslate nohighlight">\(= x^t * B * x\)</span>.</p>
<p>This agrees with the usual level for even dimension…</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">level__Tornaria</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal">
<span class="sig-name descname"><span class="pre">level_ideal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.level_ideal" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the level of the quadratic form (over R), which is the
smallest ideal N of R such that N * (the matrix of 2*Q)^(-1) is
in R with diagonal in 2*R.
(Caveat: This always returns the principal ideal when working over a field!)</p>
<dl class="simple">
<dt>WARNING:  THIS ONLY WORKS OVER A PID RING OF INTEGERS FOR NOW!</dt><dd><p>(Waiting for Sage fractional ideal support.)</p>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (8) of Integer Ring</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (1) of Rational Field</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">level_ideal</span><span class="p">()</span>
<span class="go">Principal ideal (420) of Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations">
<span class="sig-name descname"><span class="pre">list_external_initializations</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.list_external_initializations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the fields which were set externally at
creation, and not created through the usual QuadraticForm
methods.  These fields are as good as the external process
that made them, and are thus not guaranteed to be correct.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">number_of_automorphisms</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">determinant</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[&#39;number_of_automorphisms&#39;, &#39;determinant&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.lll">
<span class="sig-name descname"><span class="pre">lll</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.lll" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an LLL-reduced form of Q (using Pari).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">lll</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 1 0 ]</span>
<span class="go">[ * 4 3 3 ]</span>
<span class="go">[ * * 6 3 ]</span>
<span class="go">[ * * * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence">
<span class="sig-name descname"><span class="pre">local_badII_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badII_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Bad-type II local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that <span class="math notranslate nohighlight">\(p\)</span> &gt; 2 and Q is given in local diagonal form.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badII_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence">
<span class="sig-name descname"><span class="pre">local_badI_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_badI_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Bad-type I local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that p &gt; 2 and Q is given in local diagonal form.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_badI_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence">
<span class="sig-name descname"><span class="pre">local_bad_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_bad_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Bad-type local density of Q representing
<span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>, allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_bad_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density">
<span class="sig-name descname"><span class="pre">local_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the local density – should be called by the user. =)</p>
<p>NOTE: This screens for imprimitive forms, and puts the quadratic
form in local normal form, which is a <em>requirement</em> of the
routines performing the computations!</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0
<span class="math notranslate nohighlight">\(m\)</span> – an integer</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>   <span class="c1">## NOTE: This is already in local normal form for *all* primes p!</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence">
<span class="sig-name descname"><span class="pre">local_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>,
allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">14/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol">
<span class="sig-name descname"><span class="pre">local_genus_symbol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_genus_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Conway-Sloane genus symbol of 2 times a quadratic form
defined over <span class="math notranslate nohighlight">\(\ZZ\)</span> at a prime number <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>This is defined (in the
Genus_Symbol_p_adic_ring() class in the quadratic_forms/genera
subfolder) to be a list of tuples (one for each Jordan component
p^m*A at p, where A is a unimodular symmetric matrix with
coefficients the p-adic integers) of the following form:</p>
<blockquote>
<div><ol class="arabic">
<li><p>If p&gt;2 then return triples of the form [<span class="math notranslate nohighlight">\(m\)</span>, <span class="math notranslate nohighlight">\(n\)</span>, <span class="math notranslate nohighlight">\(d\)</span>] where</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(m\)</span> = valuation of the component</p>
<p><span class="math notranslate nohighlight">\(n\)</span> = rank of A</p>
<p><span class="math notranslate nohighlight">\(d\)</span> = det(A) in {1,u} for normalized quadratic non-residue u.</p>
</div></blockquote>
</li>
<li><p>If p=2 then return quintuples of the form [<span class="math notranslate nohighlight">\(m\)</span>,`n`,`s`, <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(o\)</span>] where</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(m\)</span> = valuation of the component</p>
<p><span class="math notranslate nohighlight">\(n\)</span> = rank of A</p>
<p><span class="math notranslate nohighlight">\(d\)</span> = det(A) in {1,3,5,7}</p>
<p><span class="math notranslate nohighlight">\(s\)</span> = 0 (or 1) if A is even (or odd)</p>
<dl class="simple">
<dt><span class="math notranslate nohighlight">\(o\)</span> = oddity of A (= 0 if s = 0) in Z/8Z</dt><dd><p>= the trace of the diagonalization of A</p>
</dd>
</dl>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Conway-Sloane convention for describing the prime ‘p = -1’
is not supported here, and neither is the convention for
including the ‘prime’ Infinity.  See note on p370 of Conway-Sloane
(3rd ed) <a class="reference internal" href="../../../references/index.html#cs1999" id="id2"><span>[CS1999]</span></a> for a discussion of this convention.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a Conway-Sloane genus symbol at <span class="math notranslate nohighlight">\(p\)</span>, which is an
instance of the Genus_Symbol_p_adic_ring class.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_genus_symbol</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Genus symbol at 5:     1^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence">
<span class="sig-name descname"><span class="pre">local_good_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Good-type local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Front end routine for parity specific routines for p.)</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Add Documentation about the additional congruence
conditions Zvec and NZvec.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even">
<span class="sig-name descname"><span class="pre">local_good_density_congruence_even</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_even" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Good-type local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p=2\)</span>.
(Assuming Q is given in local diagonal form.)</p>
<p>The additional congruence condition arguments Zvec and NZvec can
be either a list of indices or None.  Zvec = [] is equivalent to
Zvec = None which both impose no additional conditions, but NZvec
= [] returns no solutions always while NZvec = None imposes no
additional condition.</p>
<p>WARNING: Here the indices passed in Zvec and NZvec represent
indices of the solution vector <span class="math notranslate nohighlight">\(x\)</span> of Q(<span class="math notranslate nohighlight">\(x\)</span>) = <span class="math notranslate nohighlight">\(m (mod p^k)\)</span>, and <em>not</em>
the Jordan components of Q.  They therefore are required (and
assumed) to include either all or none of the indices of a given
Jordan component of Q.  This is only important when <span class="math notranslate nohighlight">\(p=2\)</span> since
otherwise all Jordan blocks are 1x1, and so there the indices and
Jordan blocks coincide.</p>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<p>Add type checking for Zvec, NZvec, and that Q is in local
normal form.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and 2-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_even</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd">
<span class="sig-name descname"><span class="pre">local_good_density_congruence_odd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_good_density_congruence_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Good-type local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>.
(Assuming that <span class="math notranslate nohighlight">\(p\)</span> &gt; 2 and Q is given in local diagonal form.)</p>
<p>The additional congruence condition arguments Zvec and NZvec can
be either a list of indices or None.  Zvec = [] is equivalent to
Zvec = None which both impose no additional conditions, but NZvec
= [] returns no solutions always while NZvec = None imposes no
additional condition.</p>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<p>Add type checking for Zvec, NZvec, and that Q is in local
normal form.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_good_density_congruence_odd</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form">
<span class="sig-name descname"><span class="pre">local_normal_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a locally integrally equivalent quadratic form over
the <span class="math notranslate nohighlight">\(p\)</span>-adic integers <span class="math notranslate nohighlight">\(\ZZ_p\)</span> which gives the Jordan decomposition.</p>
<p>The Jordan components are written as sums of blocks of size &lt;= 2
and are arranged by increasing scale, and then by increasing norm.
This is equivalent to saying that we put the 1x1 blocks before
the 2x2 blocks in each Jordan component.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a positive prime number.</p></li>
</ul>
<p>OUTPUT:</p>
<p>a quadratic form over <span class="math notranslate nohighlight">\(\ZZ\)</span></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently this only works for quadratic forms defined over <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 6 ]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 10 0 ]</span>
<span class="go">[ * 15 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * 6 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density">
<span class="sig-name descname"><span class="pre">local_primitive_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the local primitive density – should be called by the user. =)</p>
<p>NOTE: This screens for imprimitive forms, and puts the
quadratic form in local normal form, which is a <em>requirement</em> of
the routines performing the computations!</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number &gt; 0
<span class="math notranslate nohighlight">\(m\)</span> – an integer</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">15</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 5 1 2 3 ]</span>
<span class="go">[ * 10 5 6 ]</span>
<span class="go">[ * * 15 8 ]</span>
<span class="go">[ * * * 20 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1 + 2*q^5 + 2*q^10 + 2*q^14 + 2*q^15 + 2*q^16 + 2*q^18 + O(q^20)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_normal_form</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 0 0 ]</span>
<span class="go">[ * 0 0 0 ]</span>
<span class="go">[ * * 0 1 ]</span>
<span class="go">[ * * * 0 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">24/25</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3/4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence">
<span class="sig-name descname"><span class="pre">local_primitive_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_primitive_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the primitive local density of Q representing
<span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>, allowing certain congruence conditions mod <span class="math notranslate nohighlight">\(p\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following routine is not used internally, but is included for consistency.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and p-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">8/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">24/25</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">48/49</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zvec</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">NZvec</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">120/121</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">4/9</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_primitive_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/27</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions">
<span class="sig-name descname"><span class="pre">local_representation_conditions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">recompute_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">silent_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_representation_conditions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>WARNING: THIS ONLY WORKS CORRECTLY FOR FORMS IN &gt;=3 VARIABLES,</dt><dd><p>WHICH ARE LOCALLY UNIVERSAL AT ALMOST ALL PRIMES!</p>
</dd>
</dl>
<p>This class finds the local conditions for a number to be integrally
represented by an integer-valued quadratic form.  These conditions
are stored in “self.__local_representability_conditions” and
consist of a list of 9 element vectors, with one for each prime
with a local obstruction (though only the first 5 are meaningful
unless <span class="math notranslate nohighlight">\(p=2\)</span> ).  The first element is always the prime <span class="math notranslate nohighlight">\(p\)</span> where the
local obstruction occurs, and the next 8 (or 4) entries represent
square-classes in the <span class="math notranslate nohighlight">\(p\)</span>-adic integers <span class="math notranslate nohighlight">\(Z_p\)</span>, and are labeled by the
<span class="math notranslate nohighlight">\(Q_p\)</span> square-classes <span class="math notranslate nohighlight">\(t*(Q_p)^2\)</span> with <span class="math notranslate nohighlight">\(t\)</span> given as follows:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(p &gt; 2\)</span>  ==&gt;  [ *  1  u  p  u p  *  *  *  * ]</p>
<p><span class="math notranslate nohighlight">\(p = 2\)</span>  ==&gt;  [ *  1  3  5  7  2  6  10  14 ]</p>
</div></blockquote>
<p>The integer appearing in each place tells us how <span class="math notranslate nohighlight">\(p\)</span>-divisible a
number needs to be in that square-class in order to be locally
represented by Q.  A negative number indicates that the entire <span class="math notranslate nohighlight">\(Q_p\)</span>
square-class is not represented, while a positive number <span class="math notranslate nohighlight">\(x\)</span> indicates
that <span class="math notranslate nohighlight">\(t*p^{(2*x)} (Z_p)^2\)</span> is locally represented but <span class="math notranslate nohighlight">\(t*p^{(2*(x-1))}\)</span>
<span class="math notranslate nohighlight">\((Z_p)^2\)</span> is not.</p>
<p>As an example, the vector</p>
<blockquote>
<div><p>[2  3  0  0  0  0  2  0  infinity]</p>
</div></blockquote>
<p>tells us that all positive integers are locally represented at p=2
except those of the forms:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(2^6 * u * r^2\)</span> with  <span class="math notranslate nohighlight">\(u = 1 (mod 8)\)</span></p>
<p><span class="math notranslate nohighlight">\(2^5 * u * r^2\)</span> with <span class="math notranslate nohighlight">\(u = 3 (mod 8)\)</span></p>
<p><span class="math notranslate nohighlight">\(2 * u * r^2\)</span> with <span class="math notranslate nohighlight">\(u = 7 (mod 8)\)</span></p>
</div></blockquote>
<p>At the real numbers, the vector which looks like</p>
<blockquote>
<div><p>[infinity, 0, infinity, None, None, None, None, None, None]</p>
</div></blockquote>
<p>means that Q is negative definite (i.e. the 0 tells us all
positive reals are represented).  The real vector always appears,
and is listed before the other ones.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>A list of 9-element vectors describing the representation
obstructions at primes dividing the level.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 0-dimensional form only represents zero.</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 1-dimensional form only represents square multiples of 5.</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This 2-dimensional form represents the p-adic integers of even</span>
<span class="go">valuation for all primes p except [2].</span>
<span class="go">For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, +Infinity, 0, +Infinity, 0, +Infinity, 0, +Infinity]</span>


<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[2].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 2:   [0, 0, 0, +Infinity, 0, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>

<span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [0, 1, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[3].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
<span class="go"> p = 3:   [1, 0, 0, 0]</span>

<span class="gp">sage: </span><span class="n">Q3</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q3</span><span class="o">.</span><span class="n">local_representation_conditions</span><span class="p">()</span>
<span class="go">This form represents the p-adic integers Z_p for all primes p except</span>
<span class="go">[].  For these and the reals, we have:</span>
<span class="go"> Reals:   [0, +Infinity]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence">
<span class="sig-name descname"><span class="pre">local_zero_density_congruence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Zvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">NZvec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.local_zero_density_congruence" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the Zero-type local density of Q representing <span class="math notranslate nohighlight">\(m\)</span> at <span class="math notranslate nohighlight">\(p\)</span>,
allowing certain congruence conditions mod p.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p>Q – quadratic form assumed to be block diagonal and <span class="math notranslate nohighlight">\(p\)</span>-integral</p></li>
<li><p><span class="math notranslate nohighlight">\(p\)</span> – a prime number</p></li>
<li><p><span class="math notranslate nohighlight">\(m\)</span> – an integer</p></li>
<li><p>Zvec, NZvec – non-repeating lists of integers in range(self.dim()) or None</p></li>
</ul>
<p>OUTPUT: a rational number</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/2</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">2/9</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">1/4</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_zero_density_congruence</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="go">8/81</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities">
<span class="sig-name descname"><span class="pre">mass__by_Siegel_densities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">odd_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Pall'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">even_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Watson'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass__by_Siegel_densities" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives the mass of transformations (det 1 and -1).</p>
<p>WARNING: THIS IS BROKEN RIGHT NOW… =(</p>
<p>Optional Arguments:</p>
<ul class="simple">
<li><p>When p &gt; 2  –  odd_algorithm = “Pall” (only one choice for now)</p></li>
<li><p>When p = 2  –  even_algorithm = “Kitaoka” or “Watson”</p></li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Nipp’s Book “Tables of Quaternary Quadratic Forms”.</p></li>
<li><p>Papers of Pall (only for p&gt;2) and Watson (for <span class="math notranslate nohighlight">\(p=2\)</span> – tricky!).</p></li>
<li><p>Siegel, Milnor-Hussemoller, Conway-Sloane Paper IV, Kitoaka (all of which
have problems…)</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">();</span> <span class="n">m</span>
<span class="go">1/384</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">mass__by_Siegel_densities</span><span class="p">();</span> <span class="n">m</span>
<span class="go">1/48</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">-</span> <span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">dim</span><span class="p">()))</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power">
<span class="sig-name descname"><span class="pre">mass_at_two_by_counting_mod_power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.mass_at_two_by_counting_mod_power" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the local mass at <span class="math notranslate nohighlight">\(p=2\)</span> assuming that it’s stable <span class="math notranslate nohighlight">\((mod 2^k)\)</span>.</p>
<p>Note: This is <strong>way</strong> too slow to be useful, even when k=1!!!</p>
<p>TO DO: Remove this routine, or try to compile it!</p>
<p>INPUT:</p>
<blockquote>
<div><p>k – an integer &gt;= 1</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">mass_at_two_by_counting_mod_power</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.matrix">
<span class="sig-name descname"><span class="pre">matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hessian matrix A for which Q(X) =  <span class="math notranslate nohighlight">\((1/2) * X^t * A * X\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 1  6  4]</span>
<span class="go">[ 2  4 10]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction">
<span class="sig-name descname"><span class="pre">minkowski_reduction</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<div class="math notranslate nohighlight">
\[Q(v_k) &lt;= Q(s_1 * v_1 + ... + s_n * v_n)\]</div>
<p>for all <span class="math notranslate nohighlight">\(s_i\)</span> where GCD`(s_k, … s_n) = 1`.</p>
<p>Note: When Q has dim &lt;= 4 we can take all <span class="math notranslate nohighlight">\(s_i\)</span> in {1, 0, -1}.</p>
<dl class="simple">
<dt>References:</dt><dd><dl class="simple">
<dt>Schulze-Pillot’s paper on “An algorithm for computing genera</dt><dd><p>of ternary and quaternary quadratic forms”, p138.</p>
</dd>
<dt>Donaldson’s 1979 paper “Minkowski Reduction of Integral</dt><dd><p>Matrices”, p203.</p>
</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 -5 ]</span>
<span class="go">[ * 29 25 4 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 -2 0 0 ]</span>
<span class="go">[ * 2 0 0 ]</span>
<span class="go">[ * * 2 0 ]</span>
<span class="go">[ * * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 2 0 ]</span>
<span class="go">[ * * * 2 ]                                                        ,</span>

<span class="go">[1 1 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">=</span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">Gram_matrix</span><span class="p">()</span>
<span class="go">[2 1 0 0 0]</span>
<span class="go">[1 2 1 0 0]</span>
<span class="go">[0 1 2 1 0]</span>
<span class="go">[0 0 1 2 1]</span>
<span class="go">[0 0 0 1 2]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: This algorithm is only for dimensions less than 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP">
<span class="sig-name descname"><span class="pre">minkowski_reduction_for_4vars__SP</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.minkowski_reduction_for_4vars__SP" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a Minkowski-reduced form equivalent to the given one.
This means that</p>
<blockquote>
<div><p>Q(<span class="math notranslate nohighlight">\(v_k\)</span>) &lt;= Q(<span class="math notranslate nohighlight">\(s_1 * v_1 + ... + s_n * v_n\)</span>)</p>
</div></blockquote>
<p>for all <span class="math notranslate nohighlight">\(s_i\)</span> where GCD(<span class="math notranslate nohighlight">\(s_k, ... s_n\)</span>) = 1.</p>
<p>Note: When Q has dim &lt;= 4 we can take all <span class="math notranslate nohighlight">\(s_i\)</span> in {1, 0, -1}.</p>
<dl class="simple">
<dt>References:</dt><dd><dl class="simple">
<dt>Schulze-Pillot’s paper on “An algorithm for computing genera</dt><dd><p>of ternary and quaternary quadratic forms”, p138.</p>
</dd>
<dt>Donaldson’s 1979 paper “Minkowski Reduction of Integral</dt><dd><p>Matrices”, p203.</p>
</dd>
</dl>
</dd>
</dl>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">30</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">110</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 30 17 11 12 ]</span>
<span class="go">[ * 29 25 62 ]</span>
<span class="go">[ * * 64 25 ]</span>
<span class="go">[ * * * 110 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">minkowski_reduction_for_4vars__SP</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 29 -17 25 4 ]</span>
<span class="go">[ * 30 -11 5 ]</span>
<span class="go">[ * * 64 0 ]</span>
<span class="go">[ * * * 77 ]                                                       ,</span>

<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 1  0  0 -1]</span>
<span class="go">[ 0  0  1  0]</span>
<span class="go">[ 0  0  0  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable">
<span class="sig-name descname"><span class="pre">multiply_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.multiply_variable" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace the variables <span class="math notranslate nohighlight">\(x_i\)</span> by <span class="math notranslate nohighlight">\(c*x_i\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<p>Here <span class="math notranslate nohighlight">\(c\)</span> must be an element of the base_ring defining the
quadratic form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(c\)</span> – an element of Q.base_ring()</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span> – an integer &gt;= 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a QuadraticForm (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">multiply_variable</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 25 0 0 0 ]</span>
<span class="go">[ * 9 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.neighbor_iteration">
<span class="sig-name descname"><span class="pre">neighbor_iteration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seeds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.neighbor_iteration" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all classes in the <span class="math notranslate nohighlight">\(p\)</span>-neighbor graph of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Starting from the given seeds, this function successively
finds p-neighbors until no new quadratic form (class) is obtained.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">seeds</span></code> – a list of quadratic forms in the same genus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mass</span></code> – (optional) a rational number; the mass of this genus</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_classes</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>) break the computation when <code class="docutils literal notranslate"><span class="pre">max_classes</span></code> are found</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – (optional) one of ‘orbits’, ‘random’, ‘exaustion’</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">max_random_trys</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>) the maximum number of neighbors</dt><dd><p>computed for a single lattice</p>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of quadratic forms</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form__neighbors</span> <span class="kn">import</span> <span class="n">neighbor_iteration</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">46</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">conway_mass</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g1</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;random&#39;</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">g2</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;exaustion&#39;</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">g3</span> <span class="o">=</span> <span class="n">neighbor_iteration</span><span class="p">([</span><span class="n">Q</span><span class="p">],</span><span class="mi">3</span><span class="p">,</span> <span class="n">algorithm</span> <span class="o">=</span> <span class="s1">&#39;orbits&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g1</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g2</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">mass</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span> <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">g3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms">
<span class="sig-name descname"><span class="pre">number_of_automorphisms</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.number_of_automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of automorphisms (of det 1 and -1) of
the quadratic form.</p>
<p>OUTPUT:</p>
<p>an integer &gt;= 2.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">unsafe_initialization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">48</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">384</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">factorial</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">384</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.omega">
<span class="sig-name descname"><span class="pre">omega</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.omega" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the content of the adjoint of the primitive associated quadratic form.</p>
<p>Ref: See Dickson’s “Studies in Number Theory”.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">omega</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.orbits_lines_mod_p">
<span class="sig-name descname"><span class="pre">orbits_lines_mod_p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.orbits_lines_mod_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Let <span class="math notranslate nohighlight">\((L, q)\)</span> be a lattice. This returns representatives of the
orbits of lines in <span class="math notranslate nohighlight">\(L/pL\)</span> under the orthogonal group of <span class="math notranslate nohighlight">\(q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime number</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a list of vectors over <code class="docutils literal notranslate"><span class="pre">GF(p)</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form__neighbors</span> <span class="kn">import</span> <span class="n">orbits_lines_mod_p</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">orbits_lines_mod_p</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(0, 0, 1),</span>
<span class="go">(0, 1, 0),</span>
<span class="go">(0, 1, 1),</span>
<span class="go">(1, 0, 0),</span>
<span class="go">(1, 0, 1),</span>
<span class="go">(1, 1, 0),</span>
<span class="go">(1, 1, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.parity">
<span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">allow_rescaling_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.parity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the parity (“even” or “odd”) of an integer-valued quadratic
form over <span class="math notranslate nohighlight">\(ZZ\)</span>, defined up to similitude/rescaling of the form so that
its Jordan component of smallest scale is unimodular.  After this
rescaling, we say a form is even if it only represents even numbers,
and odd if it represents some odd number.</p>
<p>If the ‘allow_rescaling_flag’ is set to False, then we require that
the quadratic form have a Gram matrix with coefficients in <span class="math notranslate nohighlight">\(ZZ\)</span>, and
look at the unimodular Jordan block to determine its parity.  This
returns an error if the form is not integer-matrix, meaning that it
has Jordan components at <span class="math notranslate nohighlight">\(p=2\)</span> which do not have an integer scale.</p>
<p>We determine the parity by looking for a 1x1 block in the 0-th
Jordan component, after a possible rescaling.</p>
<p>INPUT:</p>
<blockquote>
<div><dl class="simple">
<dt>self – a quadratic form with base_ring <span class="math notranslate nohighlight">\(ZZ\)</span>, which we may</dt><dd><p>require to have integer Gram matrix.</p>
</dd>
</dl>
</div></blockquote>
<p>OUTPUT:</p>
<p>One of the strings: “even” or “odd”</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 3 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 2 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;even&#39;</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">Q</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 4 -2 0 ]</span>
<span class="go">[ * 2 2 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">parity</span><span class="p">()</span>
<span class="go">&#39;odd&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial">
<span class="sig-name descname"><span class="pre">polynomial</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'x'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomial in ‘n’ variables of the quadratic form in the ring ‘R[names].’</p>
<p>INPUT:</p>
<blockquote>
<div><p>-‘self’ - a quadratic form over a commutative ring.
-‘names’ - the name of the variables. Digits will be appended to the name for each different canonical
variable e.g x1, x2, x3 etc.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>The polynomial form of the quadratic form.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">();</span> <span class="n">P</span>
<span class="go">x0^2 + 3*x1^2 + 5*x2^2 + 7*x3^2</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">2*a*y0^2 + 3*a*y0*y1 + (-a + 1)*y1^2 + (2*a + 4)*y2^2</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">a*z0^2 + (3*a)*z0*z1 + (a - 3)*z1^2 + (a + 4)*z2^2 + (-a + 1)*z0*z3 + (2*a + 4)*z1*z3 + z3^2</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="n">F</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Can only create polynomial rings over commutative rings.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.primitive">
<span class="sig-name descname"><span class="pre">primitive</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.primitive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a primitive version of an integer-valued quadratic form, defined over <span class="math notranslate nohighlight">\(ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 3 ]</span>
<span class="go">[ * 4 ]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">primitive</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 ]</span>
<span class="go">[ * 4 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form">
<span class="sig-name descname"><span class="pre">rational_diagonal_form</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_matrix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.rational_diagonal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a diagonal form equivalent to the given quadratic from
over the fraction field of its defining ring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> – (boolean, default: False) also return the
transformation matrix</p></li>
</ul>
<p>OUTPUT: either <code class="docutils literal notranslate"><span class="pre">D</span></code> (if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is false) or <code class="docutils literal notranslate"><span class="pre">(D,T)</span></code>
(if <code class="docutils literal notranslate"><span class="pre">return_matrix</span></code> is true) where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> – the diagonalized form of this quadratic form.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">T</span></code> – transformation matrix. This is such that
<code class="docutils literal notranslate"><span class="pre">T.transpose()</span> <span class="pre">*</span> <span class="pre">self.matrix()</span> <span class="pre">*</span> <span class="pre">T</span></code> gives <code class="docutils literal notranslate"><span class="pre">D.matrix()</span></code>.</p></li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">D</span></code> and <code class="docutils literal notranslate"><span class="pre">T</span></code> are defined over the fraction field of the
base ring of the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 ]</span>
<span class="go">[ * -1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/4 0 ]</span>
<span class="go">[ * -1 ]</span>
</pre></div>
</div>
<p>If we start with a diagonal form, we get back the same form defined
over the fraction field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 5 0 ]</span>
<span class="go">[ * * * 7 ]</span>
</pre></div>
</div>
<p>In the following example, we check the consistency of the
transformation matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ -1/16 0 0 0 ]</span>
<span class="go">[ * 4 0 0 ]</span>
<span class="go">[ * * 13 0 ]</span>
<span class="go">[ * * * 563/52 ]</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">[     1      0     11 149/26]</span>
<span class="go">[  -1/8      1     -2 -10/13]</span>
<span class="go">[     0      0      1 -29/26]</span>
<span class="go">[     0      0      0      1]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span> <span class="o">*</span> <span class="n">T</span>
<span class="go">[  -1/8      0      0      0]</span>
<span class="go">[     0      8      0      0]</span>
<span class="go">[     0      0     26      0]</span>
<span class="go">[     0      0      0 563/26]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">matrix</span><span class="p">()</span>
<span class="go">[  -1/8      0      0      0]</span>
<span class="go">[     0      8      0      0]</span>
<span class="go">[     0      0     26      0]</span>
<span class="go">[     0      0      0 563/26]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 1 0 0 ]</span>
<span class="go">[ * 1 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">(</span><span class="n">return_matrix</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3/4 0 0 ]</span>
<span class="go">[ * * 1 0 ]</span>
<span class="go">[ * * * 18 ]                                                         ,</span>

<span class="go">[   1 -1/2    0    0]</span>
<span class="go">[   0    1    0    0]</span>
<span class="go">[   0    0    1    0]</span>
<span class="go">[   0    0    0    1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>PARI returns a singular transformation matrix for this case:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1/2 0 ]</span>
<span class="go">[ * 0 ]</span>
</pre></div>
</div>
<p>This example cannot be computed by PARI:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">RIF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">rational_diagonal_form</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Real Interval Field with 53 bits of precision with coefficients:</span>
<span class="go">[ 5 0.?e-14 0.?e-13 0.?e-13 ]</span>
<span class="go">[ * -0.05000000000000? 0.?e-12 0.?e-12 ]</span>
<span class="go">[ * * 13.00000000000? 0.?e-10 ]</span>
<span class="go">[ * * * 10.8269230769? ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal">
<span class="sig-name descname"><span class="pre">reciprocal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reciprocal" title="Permalink to this definition">¶</a></dt>
<dd><p>This gives the reciprocal quadratic form associated to the given form.
This is defined as the multiple of the primitive adjoint with the same
content as the given form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">37</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 37 0 0 ]</span>
<span class="go">[ * 37 0 ]</span>
<span class="go">[ * * 1 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 ]</span>
<span class="go">[ * 1 0 ]</span>
<span class="go">[ * * 37 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">()</span> <span class="o">==</span> <span class="n">Q</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form">
<span class="sig-name descname"><span class="pre">reduced_binary_form</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a form which is reduced in the sense that no further binary
form reductions can be done to reduce the original form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1">
<span class="sig-name descname"><span class="pre">reduced_binary_form1</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_binary_form1" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce the form <span class="math notranslate nohighlight">\(ax^2 + bxy+cy^2\)</span> to satisfy the reduced condition <span class="math notranslate nohighlight">\(|b| \le
a \le c\)</span>, with <span class="math notranslate nohighlight">\(b \ge 0\)</span> if <span class="math notranslate nohighlight">\(a = c\)</span>. This reduction occurs within the
proper class, so all transformations are taken to have determinant 1.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">reduced_binary_form1</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 -1 ]</span>
<span class="go">[ * 2 ]                                                            ,</span>

<span class="go">[ 0 -1]</span>
<span class="go">[ 1  1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson">
<span class="sig-name descname"><span class="pre">reduced_ternary_form__Dickson</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.reduced_ternary_form__Dickson" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the unique reduced ternary form according to the conditions
of Dickson’s “Studies in the Theory of Numbers”, pp164-171.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">reduced_ternary_form__Dickson</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: TO DO</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list">
<span class="sig-name descname"><span class="pre">representation_number_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_number_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector of representation numbers &lt; B.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 16, 112, 448, 1136, 2016, 3136, 5504, 9328, 12112]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list">
<span class="sig-name descname"><span class="pre">representation_vector_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">B</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxvectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.representation_vector_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Find all vectors <span class="math notranslate nohighlight">\(v\)</span> where <span class="math notranslate nohighlight">\(Q(v) &lt; B\)</span>.</p>
<p>This only works for positive definite quadratic forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_vector_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[[(0, 0)],</span>
<span class="go"> [(0, 1), (0, -1), (1, 0), (-1, 0)],</span>
<span class="go"> [(1, 1), (-1, -1), (1, -1), (-1, 1)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 2), (0, -2), (2, 0), (-2, 0)],</span>
<span class="go"> [(1, 2), (-1, -2), (1, -2), (-1, 2), (2, 1), (-2, -1), (2, -1), (-2, 1)],</span>
<span class="go"> [],</span>
<span class="go"> [],</span>
<span class="go"> [(2, 2), (-2, -2), (2, -2), (-2, 2)],</span>
<span class="go"> [(0, 3), (0, -3), (3, 0), (-3, 0)]]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">_</span><span class="p">))</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">representation_number_list</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[1, 4, 4, 0, 4, 8, 0, 0, 4, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor">
<span class="sig-name descname"><span class="pre">scale_by_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">change_value_ring_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.scale_by_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the values of the quadratic form by the number <span class="math notranslate nohighlight">\(c\)</span>, if
this is possible while still being defined over its base ring.</p>
<p>If the flag is set to true, then this will alter the value ring
to be the field of fractions of the original ring (if necessary).</p>
<p>INPUT:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(c\)</span> – a scalar in the fraction field of the value ring of the form.</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>A quadratic form of the same dimension</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">27</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 9 0 0 0 ]</span>
<span class="go">[ * 27 0 0 ]</span>
<span class="go">[ * * 54 0 ]</span>
<span class="go">[ * * * 81 ]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">scale_by_factor</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 0 0 0 ]</span>
<span class="go">[ * 3 0 0 ]</span>
<span class="go">[ * * 6 0 ]</span>
<span class="go">[ * * * 9 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms">
<span class="sig-name descname"><span class="pre">set_number_of_automorphisms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_autos</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.set_number_of_automorphisms" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of automorphisms to be the value given.  No error
checking is performed, to this may lead to erroneous results.</p>
<p>The fact that this result was set externally is recorded in the
internal list of external initializations, accessible by the
method list_external_initializations().</p>
<p>OUTPUT: None</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">set_number_of_automorphisms</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">number_of_automorphisms</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">list_external_initializations</span><span class="p">()</span>
<span class="go">[&#39;number_of_automorphisms&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal">
<span class="sig-name descname"><span class="pre">shimura_mass__maximal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.shimura_mass__maximal" title="Permalink to this definition">¶</a></dt>
<dd><p>Use Shimura’s exact mass formula to compute the mass of a maximal
quadratic lattice. This works for any totally real number field,
but has a small technical restriction when <span class="math notranslate nohighlight">\(n\)</span> is odd.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a rational number</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">shimura_mass__maximal</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length">
<span class="sig-name descname"><span class="pre">short_primitive_vector_list_up_to_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">len_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_to_sign_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_primitive_vector_list_up_to_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of lists of short primitive vectors <span class="math notranslate nohighlight">\(v\)</span>, sorted by length, with
Q(<span class="math notranslate nohighlight">\(v\)</span>) &lt; len_bound.  The list in output <span class="math notranslate nohighlight">\([i]\)</span> indexes all vectors of
length <span class="math notranslate nohighlight">\(i\)</span>.  If the up_to_sign_flag is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then only one of
the vectors of the pair <span class="math notranslate nohighlight">\([v, -v]\)</span> is listed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This processes the PARI/GP output to always give elements of type <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
</div>
<p>OUTPUT: a list of lists of vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (1, -1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_primitive_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[], [(1, 0, 0, 0)], [], [(0, 1, 0, 0)], [(1, 1, 0, 0), (1, -1, 0, 0)]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length">
<span class="sig-name descname"><span class="pre">short_vector_list_up_to_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">len_bound</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">up_to_sign_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.short_vector_list_up_to_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of lists of short vectors <span class="math notranslate nohighlight">\(v\)</span>, sorted by length, with
Q(<span class="math notranslate nohighlight">\(v\)</span>) &lt; len_bound.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">len_bound</span></code> – bound for the length of the vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">up_to_sign_flag</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) if set to True, then
only one of the vectors of the pair <span class="math notranslate nohighlight">\([v, -v]\)</span> is listed.</p></li>
</ul>
<p>OUTPUT:</p>
<p>A list of lists of vectors such that entry <span class="math notranslate nohighlight">\([i]\)</span> contains all
vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)], [(1, 0, 0, 0), (-1, 0, 0, 0)], []]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0), (-1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0), (0, -1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0),</span>
<span class="go">  (-1, -1, 0, 0),</span>
<span class="go">  (1, -1, 0, 0),</span>
<span class="go">  (-1, 1, 0, 0),</span>
<span class="go">  (2, 0, 0, 0),</span>
<span class="go">  (-2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0)],</span>
<span class="go"> [(1, 0, 0, 0)],</span>
<span class="go"> [],</span>
<span class="go"> [(0, 1, 0, 0)],</span>
<span class="go"> [(1, 1, 0, 0), (1, -1, 0, 0), (2, 0, 0, 0)]]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600]</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>  <span class="c1"># long time (28s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))]</span>       <span class="c1"># long time</span>
<span class="go">[1, 72, 270, 720, 936, 2160, 2214, 3600, 4590, 6552, 5184, 10800, 9360, 12240, 13500, 17712, 14760, 25920, 19710, 26064, 28080, 36000, 25920, 47520, 37638, 43272, 45900, 59040, 46800, 75600]</span>
</pre></div>
</div>
<p>The cases of <code class="docutils literal notranslate"><span class="pre">len_bound</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> led to exception or infinite runtime before.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[[(0, 0, 0, 0, 0, 0)]]</span>
</pre></div>
</div>
<p>In the case of quadratic forms that are not positive definite an error is raised.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]))</span><span class="o">.</span><span class="n">short_vector_list_up_to_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Quadratic form must be positive definite in order to enumerate short vectors</span>
</pre></div>
</div>
<p>Check that PARI does not return vectors which are too long:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">72</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">120</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">len_bound_pari</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="mi">22953421</span> <span class="o">-</span> <span class="mi">2</span><span class="p">;</span> <span class="n">len_bound_pari</span>
<span class="go">45906840</span>
<span class="gp">sage: </span><span class="n">vs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span><span class="o">.</span><span class="n">qfminim</span><span class="p">(</span><span class="n">len_bound_pari</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>  <span class="c1"># long time (18s on sage.math, 2014)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vs</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span>  <span class="c1"># long time</span>
<span class="go">[66, -623]~</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">Vec</span><span class="p">()</span> <span class="o">*</span> <span class="n">Q</span><span class="o">.</span><span class="n">__pari__</span><span class="p">()</span> <span class="o">*</span> <span class="n">v</span>  <span class="c1"># long time</span>
<span class="go">45902280</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product">
<span class="sig-name descname"><span class="pre">siegel_product</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">u</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.siegel_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the infinite product of local densities of the quadratic
form for the number <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6 + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10 + O(q^11)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>      <span class="c1">## This one is wrong -- expect 24, and the higher powers of 2 don&#39;t work... =(</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">32</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">48</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">96</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">64</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">siegel_product</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">104</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">local_density</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>
<span class="go">3/2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="mi">16</span><span class="p">;</span> <span class="nb">len</span><span class="p">([</span><span class="n">v</span>  <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">mrange</span><span class="p">([</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">,</span><span class="n">M</span><span class="p">])</span>  <span class="k">if</span> <span class="n">Q</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">%</span> <span class="n">M</span> <span class="o">==</span> <span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="n">M</span><span class="o">^</span><span class="mi">3</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">3/2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature">
<span class="sig-name descname"><span class="pre">signature</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the signature of the quadratic form, defined as:</p>
<blockquote>
<div><p>number of positive eigenvalues - number of negative eigenvalues</p>
</div></blockquote>
<p>of the matrix of the quadratic form.</p>
<p>INPUT:</p>
<blockquote>
<div><p>None</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>an integer</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector">
<span class="sig-name descname"><span class="pre">signature_vector</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.signature_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the triple <span class="math notranslate nohighlight">\((p, n, z)\)</span> of integers where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(p\)</span> = number of positive eigenvalues</p></li>
<li><p><span class="math notranslate nohighlight">\(n\)</span> = number of negative eigenvalues</p></li>
<li><p><span class="math notranslate nohighlight">\(z\)</span> = number of zero eigenvalues</p></li>
</ul>
<p>for the symmetric matrix associated to Q.</p>
<p>INPUT:</p>
<p>(none)</p>
<p>OUTPUT:</p>
<p>a triple of integers &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(1, 1, 2)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(2, 2, 0)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">));</span> <span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 1 2 3 ]</span>
<span class="go">[ * 4 5 6 ]</span>
<span class="go">[ * * 7 8 ]</span>
<span class="go">[ * * * 9 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">signature_vector</span><span class="p">()</span>
<span class="go">(3, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vector <span class="math notranslate nohighlight">\(x\)</span> such that <code class="docutils literal notranslate"><span class="pre">self(x)</span> <span class="pre">==</span> <span class="pre">c</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> – (default: 0) a rational number.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>A non-zero vector <span class="math notranslate nohighlight">\(x\)</span> satisfying <code class="docutils literal notranslate"><span class="pre">self(x)</span> <span class="pre">==</span> <span class="pre">c</span></code>.</p></li>
</ul>
<p>ALGORITHM:</p>
<p>Uses PARI’s qfsolve(). Algorithm described by Jeroen Demeyer; see comments on <a class="reference external" href="https://trac.sagemath.org/19112">trac ticket #19112</a></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">F</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 1 0 ]</span>
<span class="go">[ * -1 ]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">(1, 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(1, 0)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(3/2, -1/2)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(2, -1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(1, 2, -1, -1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: no solution found (local obstruction at -1)</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">x</span>
<span class="go">(17, -6)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">5</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ArithmeticError: no solution found (local obstruction at 3)</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">x</span>
<span class="go">(3/2, -1/2, 1/2)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">10</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">();</span> <span class="n">x</span>
<span class="go">(2, 1)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">F</span>
<span class="go">Quadratic form in 4 variables over Rational Field with coefficients:</span>
<span class="go">[ 0 0 1 0 ]</span>
<span class="go">[ * 0 0 1 ]</span>
<span class="go">[ * * 0 0 ]</span>
<span class="go">[ * * * 0 ]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
<span class="go">(23, 0, 1, 0)</span>
</pre></div>
</div>
<p>Other fields besides the rationals are currently not supported:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: solving quadratic forms is only implemented over QQ</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover">
<span class="sig-name descname"><span class="pre">split_local_cover</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.split_local_cover" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to find subform of the given (positive definite quaternary)
quadratic form Q of the form</p>
<div class="math notranslate nohighlight">
\[d*x^2 + T(y,z,w)\]</div>
<p>where <span class="math notranslate nohighlight">\(d &gt; 0\)</span> is as small as possible.</p>
<p>This is done by exhaustive search on small vectors, and then
comparing the local conditions of its sum with it’s complementary
lattice and the original quadratic form Q.</p>
<p>INPUT:</p>
<blockquote>
<div><p>none</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a QuadraticForm over ZZ</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">split_local_cover</span><span class="p">()</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 0 ]</span>
<span class="go">[ * 5 0 ]</span>
<span class="go">[ * * 7 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with">
<span class="sig-name descname"><span class="pre">sum_by_coefficients_with</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.sum_by_coefficients_with" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sum (on coefficients) of two quadratic forms of the same size.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 ]</span>
<span class="go">[ * 10 ]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">+</span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 4 0 0 ]</span>
<span class="go">[ * 10 0 0 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>

<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">sum_by_coefficients_with</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>
<span class="go">Quadratic form in 2 variables over Integer Ring with coefficients:</span>
<span class="go">[ 2 8 ]</span>
<span class="go">[ * 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables">
<span class="sig-name descname"><span class="pre">swap_variables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.swap_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>Switch the variables <span class="math notranslate nohighlight">\(x_r\)</span> and <span class="math notranslate nohighlight">\(x_s\)</span> in the quadratic form
(replacing the original form if the in_place flag is True).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(r\)</span>, <span class="math notranslate nohighlight">\(s\)</span> – integers &gt;= 0</p></li>
</ul>
<p>OUTPUT:</p>
<p>a QuadraticForm (by default, otherwise none)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>


<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 8 6 3 9 ]</span>
<span class="go">[ * 5 2 7 ]</span>
<span class="go">[ * * 1 4 ]</span>
<span class="go">[ * * * 10 ]</span>


<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">swap_variables</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 1 2 3 4 ]</span>
<span class="go">[ * 5 6 7 ]</span>
<span class="go">[ * * 8 9 ]</span>
<span class="go">[ * * * 10 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky">
<span class="sig-name descname"><span class="pre">theta_by_cholesky</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_cholesky" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the real Cholesky decomposition to compute (the <span class="math notranslate nohighlight">\(q\)</span>-expansion of) the
theta function of the quadratic form as a power series in <span class="math notranslate nohighlight">\(q\)</span> with terms
correct up to the power <span class="math notranslate nohighlight">\(q^{\text{q\_prec}}\)</span>. (So its error is <span class="math notranslate nohighlight">\(O(q^
{\text{q\_prec} + 1})\)</span>.)</p>
<p>REFERENCE:</p>
<blockquote>
<div><p>From Cohen’s “A Course in Computational Algebraic Number Theory” book,
p 102.</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">## Check the sum of 4 squares form against Jacobi&#39;s formula</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Theta</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_cholesky</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Theta</span>
<span class="go">1 + 8*q + 24*q^2 + 32*q^3 + 24*q^4 + 48*q^5 + 96*q^6 + 64*q^7 + 24*q^8 + 104*q^9 + 144*q^10</span>
<span class="gp">sage: </span><span class="n">Expected</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="nb">sum</span><span class="p">([</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">divisors</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">if</span> <span class="n">d</span><span class="o">%</span><span class="k">4</span> != 0])  for n in range(1,11)]
<span class="gp">sage: </span><span class="n">Expected</span>
<span class="go">[1, 8, 24, 32, 24, 48, 96, 64, 24, 104, 144]</span>
<span class="gp">sage: </span><span class="n">Theta</span><span class="o">.</span><span class="n">list</span><span class="p">()</span> <span class="o">==</span> <span class="n">Expected</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="go">## Check the form x^2 + 3y^2 + 5z^2 + 7w^2 represents everything except 2 and 22.</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Theta</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_cholesky</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Theta_list</span> <span class="o">=</span> <span class="n">Theta</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">m</span>  <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Theta_list</span><span class="p">))</span>  <span class="k">if</span> <span class="n">Theta_list</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
<span class="go">[2, 22]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari">
<span class="sig-name descname"><span class="pre">theta_by_pari</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Max</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_by_pari" title="Permalink to this definition">¶</a></dt>
<dd><p>Use PARI/GP to compute the theta function as a power series (or
vector) up to the precision <span class="math notranslate nohighlight">\(O(q^Max)\)</span>.  This also caches the result
for future computations.</p>
<p>If var_str = ‘’, then we return a vector <span class="math notranslate nohighlight">\(v\)</span> where <span class="math notranslate nohighlight">\(v[i]\)</span> counts the
number of vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>The safe_flag allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default safe_flag = True, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<p>INPUT:</p>
<blockquote>
<div><p>Max – an integer &gt;=0
var_str – a string</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>a power series or a vector</p>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Prec</span> <span class="o">=</span> <span class="mi">100</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">theta_by_pari</span><span class="p">(</span><span class="n">Prec</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">exact</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">8</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([</span><span class="n">d</span>  <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">divisors</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>  <span class="k">if</span> <span class="n">d</span> <span class="o">%</span> <span class="mi">4</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">])</span>  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Prec</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">compute</span> <span class="o">==</span> <span class="n">exact</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series">
<span class="sig-name descname"><span class="pre">theta_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_str</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'q'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">safe_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the theta series as a power series in the variable given
in var_str (which defaults to ‘<span class="math notranslate nohighlight">\(q\)</span>’), up to the specified precision
<span class="math notranslate nohighlight">\(O(q^max)\)</span>.</p>
<p>This uses the PARI/GP function qfrep, wrapped by the
theta_by_pari() method.  This caches the result for future
computations.</p>
<p>The safe_flag allows us to select whether we want a copy of the
output, or the original output.  It is only meaningful when a
vector is returned, otherwise a copy is automatically made in
creating the power series.  By default safe_flag = True, so we
return a copy of the cached information.  If this is set to False,
then the routine is much faster but the return values are
vulnerable to being corrupted by the user.</p>
<p>TO DO: Allow the option Max=’mod_form’ to give enough coefficients
to ensure we determine the theta series as a modular form.  This
is related to the Sturm bound, but we’ll need to be careful about
this (particularly for half-integral weights!).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">()</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + O(q^10)</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">theta_series</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>
<span class="go">1 + 2*q + 2*q^3 + 6*q^4 + 2*q^5 + 4*q^6 + 6*q^7 + 8*q^8 + 14*q^9 + 4*q^10 + 12*q^11 + 18*q^12 + 12*q^13 + 12*q^14 + 8*q^15 + 34*q^16 + 12*q^17 + 8*q^18 + 32*q^19 + 10*q^20 + 28*q^21 + 16*q^23 + 44*q^24 + O(q^25)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2">
<span class="sig-name descname"><span class="pre">theta_series_degree_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prec</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.theta_series_degree_2" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the theta series of degree 2 for the quadratic form Q.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer.</p></li>
</ul>
<p>OUTPUT:</p>
<p>dictionary, where:</p>
<ul class="simple">
<li><p>keys are <span class="math notranslate nohighlight">\({\rm GL}_2(\ZZ)\)</span>-reduced binary quadratic forms (given as triples of
coefficients)</p></li>
<li><p>values are coefficients</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">Q2</span><span class="o">.</span><span class="n">theta_series_degree_2</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">24</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">144</span>
<span class="gp">sage: </span><span class="n">S</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">192</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Gonzalo Tornaria (2010-03-23)</p></li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li><p>Raum, Ryan, Skoruppa, Tornaria, ‘On Formal Siegel Modular Forms’
(preprint)</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length">
<span class="sig-name descname"><span class="pre">vectors_by_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.vectors_by_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of short vectors together with their values.</p>
<p>This is a naive algorithm which uses the Cholesky decomposition,
but does not use the LLL-reduction algorithm.</p>
<p>INPUT:</p>
<blockquote>
<div><p>bound – an integer &gt;= 0</p>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><p>A list L of length (bound + 1) whose entry L <span class="math notranslate nohighlight">\([i]\)</span> is a list of
all vectors of length <span class="math notranslate nohighlight">\(i\)</span>.</p>
</div></blockquote>
<p>Reference: This is a slightly modified version of Cohn’s Algorithm
2.7.5 in “A Course in Computational Number Theory”, with the
increment step moved around and slightly re-indexed to allow clean
looping.</p>
<p>Note: We could speed this up for very skew matrices by using LLL
first, and then changing coordinates back, but for our purposes
the simpler method is efficient enough. =)</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[[0, 0]],</span>
<span class="go"> [[0, -1], [-1, 0]],</span>
<span class="go"> [[-1, -1], [1, -1]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -2], [-2, 0]],</span>
<span class="go"> [[-1, -2], [1, -2], [-2, -1], [2, -1]]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[[[0, 0, 0, 0]],</span>
<span class="go"> [[-1, 0, 0, 0]],</span>
<span class="go"> [],</span>
<span class="go"> [[0, -1, 0, 0]],</span>
<span class="go"> [[-1, -1, 0, 0], [1, -1, 0, 0], [-2, 0, 0, 0]],</span>
<span class="go"> [[0, 0, -1, 0]]]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">[1, 12, 12]</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">len</span><span class="p">,</span> <span class="n">Q</span><span class="o">.</span><span class="n">vectors_by_length</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">[1, 3, 0, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi">
<span class="sig-name descname"><span class="pre">xi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the genus characters Xi_p… which may be missing one character.
We allow -1 as a prime.</p>
<p>Reference: Dickson’s “Studies in the Theory of Numbers”</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">omega</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">omega</span><span class="p">()]</span>
<span class="go">[5, 5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>    <span class="c1"># equivalent over Q_5</span>
<span class="go">[1, 1]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">xi</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>                              <span class="c1"># not equivalent over Z_5</span>
<span class="go">[1, -1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec">
<span class="sig-name descname"><span class="pre">xi_rec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm.xi_rec" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Xi(<span class="math notranslate nohighlight">\(p\)</span>) for the reciprocal form.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q1</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q2</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">clifford_conductor</span><span class="p">()]</span>   <span class="c1"># equivalent over Q</span>
<span class="go">[3, 3]</span>
<span class="gp">sage: </span><span class="n">Q1</span><span class="o">.</span><span class="n">is_locally_equivalent_to</span><span class="p">(</span><span class="n">Q2</span><span class="p">)</span>                <span class="c1"># not in the same genus</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Q1</span><span class="o">.</span><span class="n">delta</span><span class="p">(),</span> <span class="n">Q2</span><span class="o">.</span><span class="n">delta</span><span class="p">()]</span>
<span class="go">[480, 480]</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="mi">480</span><span class="p">)</span>
<span class="go">2^5 * 3 * 5</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Q1</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span>
<span class="go">[-1, -1, -1, 1]</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">Q2</span><span class="o">.</span><span class="n">xi_rec</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]))</span>
<span class="go">[-1, -1, -1, -1]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.QuadraticForm__constructor">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">QuadraticForm__constructor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.QuadraticForm__constructor" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper for the QuadraticForm class constructor.  This is meant
for internal use within the QuadraticForm class code only.  You
should instead directly call QuadraticForm().</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form</span> <span class="kn">import</span> <span class="n">QuadraticForm__constructor</span>
<span class="gp">sage: </span><span class="n">QuadraticForm__constructor</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>   <span class="c1"># Makes a generic quadratic form over the integers</span>
<span class="go">Quadratic form in 3 variables over Integer Ring with coefficients:</span>
<span class="go">[ 0 0 0 ]</span>
<span class="go">[ * 0 0 ]</span>
<span class="go">[ * * 0 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.is_QuadraticForm">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">is_QuadraticForm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Q</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.is_QuadraticForm" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if the object Q is an element of the QuadraticForm class.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.quadratic_form</span> <span class="kn">import</span> <span class="n">is_QuadraticForm</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>  <span class="c1">##random</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">is_QuadraticForm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">##random</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants">
<span class="sig-prename descclassname"><span class="pre">sage.quadratic_forms.quadratic_form.</span></span><span class="sig-name descname"><span class="pre">quadratic_form_from_invariants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">F</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sminus</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.quadratic_form.quadratic_form_from_invariants" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a rational quadratic form with given invariants.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> – the base field; currently only <code class="docutils literal notranslate"><span class="pre">QQ</span></code> is allowed</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rk</span></code> – integer; the rank</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">det</span></code> – rational; the determinant</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">P</span></code> – a list of primes where Cassel’s Hasse invariant
is negative</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sminus</span></code> – integer; the number of negative eigenvalues
of any Gram matrix</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a quadratic form with the specified invariants</p></li>
</ul>
<p>Let <span class="math notranslate nohighlight">\((a_1, \ldots, a_n)\)</span> be the gram marix of a regular quadratic space.
Then Cassel’s Hasse invariant is defined as</p>
<div class="math notranslate nohighlight">
\[\prod_{i&lt;j} (a_i,a_j),\]</div>
<p>where <span class="math notranslate nohighlight">\((a_i,a_j)\)</span> denotes the Hilbert symbol.</p>
<p>ALGORITHM:</p>
<p>We follow <a class="reference internal" href="../../../references/index.html#kir2016" id="id6"><span>[Kir2016]</span></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">quadratic_form_from_invariants</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="n">P</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span>
<span class="go">Quadratic form in 2 variables over Rational Field with coefficients:</span>
<span class="go">[ 5 0 ]</span>
<span class="go">[ * -3 ]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">q</span><span class="o">.</span><span class="n">hasse_invariant</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../index.html"
                        title="previous chapter">Quadratic Forms</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="binary_qf.html"
                        title="next chapter">Binary Quadratic Forms with Integer Coefficients</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/quadratic_forms/quadratic_form.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="binary_qf.html" title="Binary Quadratic Forms with Integer Coefficients"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Quadratic Forms"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Quadratic Forms</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">Quadratic Forms Overview</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>