
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Genus &#8212; Sage Reference Manual v8.2: Quadratic Forms</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Normal forms for \(p\)-adic quadratic and bilinear forms." href="normal_form.html" />
    <link rel="prev" title="Quadratic form extras" href="../extras.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="normal_form.html" title="Normal forms for \(p\)-adic quadratic and bilinear forms."
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../extras.html" title="Quadratic form extras"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Quadratic Forms</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="genus">
<span id="sage-quadratic-forms-genera-genus"></span><h1>Genus<a class="headerlink" href="#genus" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.quadratic_forms.genera.genus"></span><dl class="function">
<dt id="sage.quadratic_forms.genera.genus.Genus">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">Genus</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a nonsingular symmetric matrix <span class="math">\(A\)</span>, return the genus of <span class="math">\(A\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(A\)</span> – a symmetric matrix with coefficients in <span class="math">\(\ZZ\)</span></li>
</ul>
<p>OUTPUT:</p>
<p>A <code class="docutils literal"><span class="pre">GenusSymbol_global_ring</span></code> object, encoding the Conway-Sloane
genus symbol of the quadratic form whose Gram matrix is <span class="math">\(A\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Genus</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Genus of</span>
<span class="go">[1 1]</span>
<span class="go">[1 2]</span>
<span class="go">Genus symbol at 2:    [1^2]_2</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.quadratic_forms.genera.genus.GenusSymbol_global_ring">
<em class="property">class </em><code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">GenusSymbol_global_ring</code><span class="sig-paren">(</span><em>A</em>, <em>max_elem_divisors=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.GenusSymbol_global_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This represents a collection of local genus symbols (at primes)
and signature information which represent the genus of a
non-degenerate integral lattice.</p>
<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.GenusSymbol_global_ring.determinant">
<code class="descname">determinant</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.GenusSymbol_global_ring.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the determinant of this genus, where the determinant
is the Hessian determinant of the quadratic form whose Gram
matrix is the Gram matrix giving rise to this global genus
symbol.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">GenusSymbol_global_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">GS</span> <span class="o">=</span> <span class="n">GenusSymbol_global_ring</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GS</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-384</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.GenusSymbol_global_ring.signature_pair_of_matrix">
<code class="descname">signature_pair_of_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.GenusSymbol_global_ring.signature_pair_of_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the signature pair (p, n) of the (non-degenerate)
global genus symbol, where p is the number of positive
eigenvalues and n is the number of negative eigenvalues.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>a pair of integers (p, n) each &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">GenusSymbol_global_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">GS</span> <span class="o">=</span> <span class="n">GenusSymbol_global_ring</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">GS</span><span class="o">.</span><span class="n">signature_pair_of_matrix</span><span class="p">()</span>
<span class="go">(4, 2)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring">
<em class="property">class </em><code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">Genus_Symbol_p_adic_ring</code><span class="sig-paren">(</span><em>prime</em>, <em>symbol</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Local genus symbol over a p-adic ring.</p>
<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.canonical_symbol">
<code class="descname">canonical_symbol</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.canonical_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Return (and cache) the canonical p-adic genus symbol.  This is
only really affects the 2-adic symbol, since when p &gt; 2 the
symbol is already canonical.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>a list of lists of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">canonical_symbol</span><span class="p">()</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 1, 1, 1, 1], [1, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">canonical_symbol</span><span class="p">()</span>   <span class="c1">## Oddity fusion occurred here!</span>
<span class="go">[[0, 1, 1, 1, 2], [1, 1, 1, 1, 0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">canonical_symbol</span><span class="p">()</span>   <span class="c1">## Oddity fusion occurred here!</span>
<span class="go">[[1, 2, -1, 1, 6], [2, 1, 1, 1, 0], [3, 1, 1, 1, 0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 3, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">canonical_symbol</span><span class="p">()</span>
<span class="go">[[0, 2, -1, 0, 0]]</span>


<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 3, 1], [1, 1, -1]]</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">canonical_symbol</span><span class="p">()</span>
<span class="go">[[0, 3, 1], [1, 1, -1]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See Conway-Sloane 3rd edition, pp. 381-382 for definitions and examples.</p>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Add an example where sign walking occurs!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.compartments">
<code class="descname">compartments</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.compartments" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the indices for each of the compartments in this local genus
symbol if it is associated to the prime p=2 (and raise an
error for all other primes).</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>a list of integers &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">compartments</span><span class="p">()</span>
<span class="go">[[0, 1, 2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.determinant">
<code class="descname">determinant</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the (p-part of the) determinant (square-class) of the
Hessian matrix of the quadratic form (given by regarding the
integral symmetric matrix which generated this genus symbol as
the Gram matrix of Q) associated to this local genus symbol.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">128</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dimension of a quadratic form associated to this genus symbol.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>an integer &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.excess">
<code class="descname">excess</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.excess" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the p-excess of the quadratic form whose Hessian
matrix is the symmetric matrix A.  When p = 2 the p-excess is
called the oddity.</p>
<p>WARNING/NOTE: This normalization seems non-standard, and we
should review this entire class to make sure that we have our
doubling conventions straight throughout!</p>
<p>REFERENCE:</p>
<p>Conway and Sloane Book, 3rd edition, pp 370-371.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">AC</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">AC</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">AC</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">;</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">excess</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.number_of_blocks">
<code class="descname">number_of_blocks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.number_of_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of positive dimensional symbols/Jordan blocks</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>integer &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">()</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 3, 1], [1, 1, -1]]</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">number_of_blocks</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.rank">
<code class="descname">rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dimension of a quadratic form associated to this genus symbol.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">DELETE THIS METHOD IN FAVOR OF THE dimension() METHOD BELOW!</p>
</div>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>an integer &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.symbol_tuple_list">
<code class="descname">symbol_tuple_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.symbol_tuple_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the underlying list of lists of integers defining the genus symbol.</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>list of lists of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G3</span>
<span class="go">Genus symbol at 3:     1^3 3^-1</span>
<span class="gp">sage: </span><span class="n">G3</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 3, 1], [1, 1, -1]]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">G3</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">&lt;... &#39;list&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">&lt;... &#39;list&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.trains">
<code class="descname">trains</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.Genus_Symbol_p_adic_ring.trains" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the indices for each of the trains in this local genus
symbol if it is associated to the prime p=2 (and raise an
error for all other primes).</p>
<p>INPUT:</p>
<p>None</p>
<p>OUTPUT:</p>
<p>a list of integers &gt;= 0</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus_Symbol_p_adic_ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">Genus_Symbol_p_adic_ring</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="mi">2</span><span class="p">));</span> <span class="n">G2</span>
<span class="go">Genus symbol at 2:    [2^-2 4^1 8^1]_6</span>
<span class="gp">sage: </span><span class="n">G2</span><span class="o">.</span><span class="n">trains</span><span class="p">()</span>
<span class="go">[[0, 1, 2]]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.LocalGenusSymbol">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">LocalGenusSymbol</code><span class="sig-paren">(</span><em>A</em>, <em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.LocalGenusSymbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a nonsingular symmetric matrix A, return the local symbol of A at the prime p.</p>
<p>INPUT:</p>
<ul class="simple">
<li>A – a symmetric matrix with coefficients in ZZ</li>
<li>p – an integer prime p &gt; 0</li>
</ul>
<p>OUTPUT:</p>
<p>A Genus_Symbol_p_adic_ring object, encoding the Conway-Sloane
genus symbol at p of the quadratic form whose Gram matrix is A.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">LocalGenusSymbol</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Genus symbol at 2:    [1^2]_2</span>
<span class="gp">sage: </span><span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Genus symbol at 3:     1^2</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Genus symbol at 2:    [1^1 2^1]_2</span>
<span class="gp">sage: </span><span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Genus symbol at 3:     1^-2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.basis_complement">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">basis_complement</code><span class="sig-paren">(</span><em>B</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.basis_complement" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an echelonized basis matrix (over a field), calculate a
matrix whose rows form a basis complement (to the rows of B).</p>
<p>INPUT:</p>
<ul class="simple">
<li>B – matrix over a field in row echelon form</li>
</ul>
<p>OUTPUT:</p>
<p>a rectangular matrix over a field</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">basis_complement</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span><span class="o">.</span><span class="n">echelonized_basis_matrix</span><span class="p">();</span> <span class="n">B</span>
<span class="go">[ 1 -1]</span>
<span class="gp">sage: </span><span class="n">basis_complement</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.canonical_2_adic_compartments">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">canonical_2_adic_compartments</code><span class="sig-paren">(</span><em>genus_symbol_quintuple_list</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.canonical_2_adic_compartments" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 2-adic local symbol (as the underlying list of quintuples)
this returns a list of lists of indices of the
genus_symbol_quintuple_list which are in the same compartment.  A
compartment is defined to be a maximal interval of Jordan
components all (scaled) of type I (i.e. odd).</p>
<p>INPUT:</p>
<ul class="simple">
<li>genus_symbol_quintuple_list – a quintuple of integers (with certain
restrictions).</li>
</ul>
<p>OUTPUT:</p>
<p>a list of lists of integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">LocalGenusSymbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">canonical_2_adic_compartments</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_compartments</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 1, 1, 1, 1], [1, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_compartments</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 1]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_compartments</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 1, 2]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 3, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_compartments</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>   <span class="c1">## No compartments here!</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>NOTES:</p>
<blockquote>
<div>See Conway-Sloane 3rd edition, pp. 381-382 for definitions and examples.</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.canonical_2_adic_reduction">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">canonical_2_adic_reduction</code><span class="sig-paren">(</span><em>genus_symbol_quintuple_list</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.canonical_2_adic_reduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 2-adic local symbol (as the underlying list of quintuples)
this returns a canonical 2-adic symbol (again as a raw list of
quintuples of integers) which has at most one minus sign per train
and this sign appears on the smallest dimensional Jordan component
in each train.  This results from applying the “sign-walking” and
“oddity fusion” equivalences.</p>
<p>INPUT:</p>
<ul class="simple">
<li>genus_symbol_quintuple_list – a quintuple of integers (with certain
restrictions).</li>
<li>compartments – a list of lists of distinct integers (optional)</li>
</ul>
<p>OUTPUT:</p>
<p>a list of lists of distinct integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">LocalGenusSymbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">canonical_2_adic_reduction</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_reduction</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 1, 1, 1, 1], [1, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_reduction</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>   <span class="c1">## Oddity fusion occurred here!</span>
<span class="go">[[0, 1, 1, 1, 2], [1, 1, 1, 1, 0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_reduction</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>   <span class="c1">## Oddity fusion occurred here!</span>
<span class="go">[[1, 2, -1, 1, 6], [2, 1, 1, 1, 0], [3, 1, 1, 1, 0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 3, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_reduction</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 2, -1, 0, 0]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See Conway-Sloane 3rd edition, pp. 381-382 for definitions and examples.</p>
</div>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">Add an example where sign walking occurs!</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.canonical_2_adic_trains">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">canonical_2_adic_trains</code><span class="sig-paren">(</span><em>genus_symbol_quintuple_list</em>, <em>compartments=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.canonical_2_adic_trains" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 2-adic local symbol (as the underlying list of quintuples)
this returns a list of lists of indices of the
genus_symbol_quintuple_list which are in the same train.  A train
is defined to be a maximal interval of Jordan components so that
at least one of each adjacent pair (allowing zero-dimensional
Jordan components) is (scaled) of type I (i.e. odd).
Note that an interval of length one respects this condition as
there is no pair in this interval.
In particular, every Jordan component is part of a train.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">genus_symbol_quintuple_list</span></code> – a quintuple of integers (with certain
restrictions).</li>
<li><code class="docutils literal"><span class="pre">compartments</span></code> – this argument is deprecated</li>
</ul>
<p>OUTPUT:</p>
<p>a list of lists of distinct integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">LocalGenusSymbol</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">canonical_2_adic_compartments</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">canonical_2_adic_trains</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 1, 1, 2]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_trains</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 1, 1, 1, 1], [1, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_compartments</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 1]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_trains</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0, 1, 2]]</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">()</span>
<span class="go">[[0, 2, 3, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_trains</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">[[0]]</span>
<span class="gp">sage: </span><span class="n">symbol</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_trains</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
<span class="go">[[0, 1, 2, 3, 4, 5], [6], [7, 8, 9]]</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/24818">trac ticket #24818</a> is fixed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">symbol</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">canonical_2_adic_trains</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
<span class="go">[[0, 1]]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="../../../../references/index.html#co1999" id="id1">[Co1999]</a>, pp. 381-382 for definitions and examples.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.is_2_adic_genus">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">is_2_adic_genus</code><span class="sig-paren">(</span><em>genus_symbol_quintuple_list</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.is_2_adic_genus" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a 2-adic local symbol (as the underlying list of quintuples)
check whether it is the 2-adic symbol of a 2-adic form.</p>
<p>INPUT:</p>
<ul class="simple">
<li>genus_symbol_quintuple_list – a quintuple of integers (with certain
restrictions).</li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">LocalGenusSymbol</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_2_adic_genus</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G3</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_2_adic_genus</span><span class="p">(</span><span class="n">G3</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>  <span class="c1">## This raises an error</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">The genus symbols are not quintuples, so it&#39;s not a genus symbol for the prime p=2.</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G2</span> <span class="o">=</span> <span class="n">LocalGenusSymbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_2_adic_genus</span><span class="p">(</span><span class="n">G2</span><span class="o">.</span><span class="n">symbol_tuple_list</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.is_GlobalGenus">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">is_GlobalGenus</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.is_GlobalGenus" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a genus symbol G (specified by a collection of local symbols), return
True in G represents the genus of a global quadratic form or lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li>G – GenusSymbol_global_ring object</li>
</ul>
<p>OUTPUT:</p>
<p>boolean</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">GenusSymbol_global_ring</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus</span><span class="p">,</span> <span class="n">is_GlobalGenus</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Genus</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_GlobalGenus</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">Genus</span><span class="p">,</span><span class="n">is_GlobalGenus</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">=</span><span class="n">Genus</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">diagonal</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">_local_symbols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_symbol</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">_representative</span><span class="o">=</span><span class="bp">None</span>
<span class="gp">sage: </span><span class="n">is_GlobalGenus</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.is_even_matrix">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">is_even_matrix</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.is_even_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the integral symmetric matrix A is even
(i.e. represents only even numbers).  If not, then it returns the
index of an odd diagonal entry.  If it is even, then we return the
index -1.</p>
<p>INPUT:</p>
<ul class="simple">
<li>A – symmetric integer matrix</li>
</ul>
<p>OUTPUT:</p>
<p>a pair of the form (boolean, integer)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">is_even_matrix</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">is_even_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(False, 0)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">is_even_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(True, -1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.p_adic_symbol">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">p_adic_symbol</code><span class="sig-paren">(</span><em>A</em>, <em>p</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.p_adic_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a symmetric matrix A and prime p, return the genus symbol at p.</p>
<p>val = valuation of the maximal elementary divisor of A
needed to obtain enough precision
calculation is modulo p to the val+3</p>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Some description of the definition of the genus symbol.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li>A – symmetric matrix with integer coefficients</li>
<li>p – prime number &gt; 0</li>
<li>val – integer &gt;= 0</li>
</ul>
<p>OUTPUT:</p>
<p>a list of lists of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">p_adic_symbol</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">DiagonalQuadraticForm</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">Hessian_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[[1, 2, 3, 1, 4], [2, 1, 1, 1, 1], [3, 1, 1, 1, 1]]</span>

<span class="gp">sage: </span><span class="n">p_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[[0, 3, 1], [1, 1, -1]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.signature_pair_of_matrix">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">signature_pair_of_matrix</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.signature_pair_of_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the signature pair (p, n) of a non-degenerate symmetric
matrix, where</p>
<ul class="simple">
<li>p = number of positive eigenvalues of A</li>
<li>n = number of negative eigenvalues of A</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li>A – symmetric matrix (assumed to be non-degenerate)</li>
</ul>
<p>OUTPUT:</p>
<p>a pair (tuple) of integers.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">signature_pair_of_matrix</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">signature_pair_of_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, 1)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">signature_pair_of_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, 1)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">signature_pair_of_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(2, 0)</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">signature_pair_of_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(0, 2)</span>


<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">signature_pair_of_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">given matrix is not invertible</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.split_odd">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">split_odd</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.split_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a non-degenerate Gram matrix A (mod 8), return a splitting [u] + B
such that u is odd and B is not even.</p>
<p>INPUT:</p>
<ul class="simple">
<li>A – an odd symmetric matrix with integer coefficients (which admits a
splitting as above).</li>
</ul>
<p>OUTPUT:</p>
<p>a pair (u, B) consisting of an odd integer u and an odd
integral symmetric matrix B.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">is_even_matrix</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">split_odd</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">is_even_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, [-1])</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, [1])</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">is_even_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>      <span class="c1">## This fails because no such splitting exists. =(</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The matrix A does not admit a non-even splitting.</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>      <span class="c1">## This fails because no such splitting exists. =(</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">The matrix A does not admit a non-even splitting.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.trace_diag_mod_8">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">trace_diag_mod_8</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.trace_diag_mod_8" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of the diagonalised form of A of an integral
symmetric matrix which is diagonalizable mod 8.  (Note that since
the Jordan decomposition into blocks of size &lt;= 2 is not unique
here, this is not the same as saying that A is always diagonal in
any 2-adic Jordan decomposition!)</p>
<p>INPUT:</p>
<ul class="simple">
<li>A – symmetric matrix with coefficients in Z which is odd in Z/2Z and has
determinant not divisible by 8.</li>
</ul>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">is_even_matrix</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">split_odd</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">trace_diag_mod_8</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">is_even_matrix</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, [-1])</span>
<span class="gp">sage: </span><span class="n">trace_diag_mod_8</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">split_odd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">(1, [1])</span>
<span class="gp">sage: </span><span class="n">trace_diag_mod_8</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.quadratic_forms.genera.genus.two_adic_symbol">
<code class="descclassname">sage.quadratic_forms.genera.genus.</code><code class="descname">two_adic_symbol</code><span class="sig-paren">(</span><em>A</em>, <em>val</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.quadratic_forms.genera.genus.two_adic_symbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a symmetric matrix A and prime p, return the genus symbol at p.</p>
<p>val = valuation of maximal 2-elementary divisor</p>
<p>The genus symbol of a component 2^m*f is of the form (m,n,s,d[,o]),
where</p>
<ul class="simple">
<li>m = valuation of the component</li>
<li>n = dimension of f</li>
<li>d = det(f) in {1,3,5,7}</li>
<li>s = 0 (or 1) if even (or odd)</li>
<li>o = oddity of f (= 0 if s = 0) in Z/8Z</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li>A – symmetric matrix with integer coefficients</li>
<li>val – integer &gt;=0</li>
</ul>
<p>OUTPUT:</p>
<p>a list of lists of integers (representing a Conway-Sloane 2-adic symbol)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.quadratic_forms.genera.genus</span> <span class="kn">import</span> <span class="n">two_adic_symbol</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">two_adic_symbol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">[[0, 2, 3, 1, 4], [1, 1, 1, 1, 1], [2, 1, 1, 1, 1]]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../extras.html"
                                  title="previous chapter">Quadratic form extras</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="normal_form.html"
                                  title="next chapter">Normal forms for <span class="math">\(p\)</span>-adic quadratic and bilinear forms.</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/quadratic_forms/genera/genus.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="normal_form.html" title="Normal forms for \(p\)-adic quadratic and bilinear forms."
             >next</a> |</li>
        <li class="right" >
          <a href="../extras.html" title="Quadratic form extras"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Quadratic Forms</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>