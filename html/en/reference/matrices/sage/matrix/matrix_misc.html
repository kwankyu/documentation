<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Miscellaneous matrix functions &#8212; Sage Reference Manual v8.0: Matrices and Spaces of Matrices</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Constructors for special matrices" href="special.html" />
    <link rel="prev" title="Matrices over an arbitrary ring" href="docs.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="special.html" title="Constructors for special matrices"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="docs.html" title="Matrices over an arbitrary ring"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Matrices and Spaces of Matrices</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="miscellaneous-matrix-functions">
<span id="sage-matrix-matrix-misc"></span><h1>Miscellaneous matrix functions<a class="headerlink" href="#miscellaneous-matrix-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.matrix.matrix_misc"></span><dl class="function">
<dt id="sage.matrix.matrix_misc.permanental_minor_polynomial">
<code class="descclassname">sage.matrix.matrix_misc.</code><code class="descname">permanental_minor_polynomial</code><span class="sig-paren">(</span><em>A</em>, <em>permanent_only=False</em>, <em>var='t'</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_misc.permanental_minor_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the polynomial of the sums of permanental minors of <code class="docutils literal"><span class="pre">A</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(A\)</span> &#8211; a matrix</li>
<li><span class="math">\(permanent_only\)</span> &#8211; if True, return only the permanent of <span class="math">\(A\)</span></li>
<li><span class="math">\(var\)</span> &#8211; name of the polynomial variable</li>
<li><span class="math">\(prec\)</span> &#8211; if prec is not None, truncate the polynomial at precision <span class="math">\(prec\)</span></li>
</ul>
<p>The polynomial of the sums of permanental minors is</p>
<div class="math">
\[\sum_{i=0}^{min(nrows, ncols)} p_i(A) x^i\]</div>
<p>where <span class="math">\(p_i(A)\)</span> is the <span class="math">\(i\)</span>-th permanental minor of <span class="math">\(A\)</span> (that can also be
obtained through the method
<a class="reference internal" href="matrix2.html#sage.matrix.matrix2.Matrix.permanental_minor" title="sage.matrix.matrix2.Matrix.permanental_minor"><code class="xref py py-meth docutils literal"><span class="pre">permanental_minor()</span></code></a> via
<code class="docutils literal"><span class="pre">A.permanental_minor(i)</span></code>).</p>
<p>The algorithm implemented by that function has been developed by P. Butera
and M. Pernici, see [BP2015]. Its complexity is <span class="math">\(O(2^n m^2 n)\)</span> where <span class="math">\(m\)</span> and
<span class="math">\(n\)</span> are the number of rows and columns of <span class="math">\(A\)</span>.  Moreover, if <span class="math">\(A\)</span> is a banded
matrix with width <span class="math">\(w\)</span>, that is <span class="math">\(A_{ij}=0\)</span> for <span class="math">\(|i - j| &gt; w\)</span> and <span class="math">\(w &lt; n/2\)</span>,
then the complexity of the algorithm is <span class="math">\(O(4^w (w+1) n^2)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A</span></code> &#8211; matrix</li>
<li><code class="docutils literal"><span class="pre">permanent_only</span></code> &#8211; optional boolean. If <code class="docutils literal"><span class="pre">True</span></code>, only the permanent
is computed (might be faster).</li>
<li><code class="docutils literal"><span class="pre">var</span></code> &#8211; a variable name</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.matrix.matrix_misc</span> <span class="kn">import</span> <span class="n">permanental_minor_polynomial</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="go">3*t^2 + 5*t + 1</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">permanent_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5*t + 1</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">84*t^3 + 114*t^2 + 28*t + 1</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="go">[1, 28, 114, 84, 0]</span>
</pre></div>
</div>
<p>An example over <span class="math">\(\QQ\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">103/175</span>
</pre></div>
</div>
<p>An example with polynomial coefficients:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">)([[</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="go">a^2 + 2*a</span>
</pre></div>
</div>
<p>A usage of the <code class="docutils literal"><span class="pre">var</span></code> argument:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">permanental_minor_polynomial</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">164*x^4 + 384*x^3 + 172*x^2 + 24*x + 1</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<blockquote>
<div><p>The permanent <span class="math">\(perm(A)\)</span> of a <span class="math">\(n \times n\)</span> matrix <span class="math">\(A\)</span> is the coefficient
of the <span class="math">\(x_1 x_2 \ldots x_n\)</span> monomial in</p>
<div class="math">
\[\prod_{i=1}^n \left( \sum_{j=1}^n A_{ij} x_j \right)\]</div>
<p>Evaluating this product one can neglect <span class="math">\(x_i^2\)</span>, that is <span class="math">\(x_i\)</span>
can be considered to be nilpotent of order <span class="math">\(2\)</span>.</p>
<p>To formalize this procedure, consider the algebra
<span class="math">\(R = K[\eta_1, \eta_2, \ldots, \eta_n]\)</span> where the <span class="math">\(\eta_i\)</span> are
commuting, nilpotent of order <span class="math">\(2\)</span> (i.e. <span class="math">\(\eta_i^2 = 0\)</span>).
Formally it is the quotient ring of the polynomial
ring in <span class="math">\(\eta_1, \eta_2, \ldots, \eta_n\)</span> quotiented by the ideal
generated by the <span class="math">\(\eta_i^2\)</span>.</p>
<p>We will mostly consider the ring <span class="math">\(R[t]\)</span> of polynomials over <span class="math">\(R\)</span>. We
denote a generic element of <span class="math">\(R[t]\)</span> by <span class="math">\(p(\eta_1, \ldots, \eta_n)\)</span> or
<span class="math">\(p(\eta_{i_1}, \ldots, \eta_{i_k})\)</span> if we want to emphasize that some
monomials in the <span class="math">\(\eta_i\)</span> are missing.</p>
<p>Introduce an &#8220;integration&#8221; operation <span class="math">\(\langle p \rangle\)</span> over <span class="math">\(R\)</span> and
<span class="math">\(R[t]\)</span> consisting in the sum of the coefficients of the non-vanishing
monomials in <span class="math">\(\eta_i\)</span> (i.e. the result of setting all variables <span class="math">\(\eta_i\)</span>
to <span class="math">\(1\)</span>). Let us emphasize that this is <em>not</em> a morphism of algebras as
<span class="math">\(\langle \eta_1 \rangle^2 = 1\)</span> while <span class="math">\(\langle \eta_1^2 \rangle = 0\)</span>!</p>
<p>Let us consider an example of computation.
Let <span class="math">\(p_1 = 1 + t \eta_1 + t \eta_2\)</span> and
<span class="math">\(p_2 = 1 + t \eta_1 + t \eta_3\)</span>. Then</p>
<div class="math">
\[p_1 p_2 = 1 + 2t \eta_1 +
        t (\eta_2 + \eta_3) +
        t^2 (\eta_1 \eta_2 + \eta_1 \eta_3 + \eta_2 \eta_3)\]</div>
<p>and</p>
<div class="math">
\[\langle p_1 p_2 \rangle = 1 + 4t + 3t^2\]</div>
<p>In this formalism, the permanent is just</p>
<div class="math">
\[perm(A) = \langle \prod_{i=1}^n \sum_{j=1}^n A_{ij} \eta_j \rangle\]</div>
<p>A useful property of <span class="math">\(\langle . \rangle\)</span> which makes this algorithm
efficient for band matrices is the following: let
<span class="math">\(p_1(\eta_1, \ldots, \eta_n)\)</span> and <span class="math">\(p_2(\eta_j, \ldots, \eta_n)\)</span> be
polynomials in <span class="math">\(R[t]\)</span> where <span class="math">\(j \ge 1\)</span>.  Then one has</p>
<div class="math">
\[\langle p_1(\eta_1, \ldots, \eta_n) p_2 \rangle =
\langle p_1(1, \ldots, 1, \eta_j, \ldots, \eta_n) p_2 \rangle\]</div>
<p>where <span class="math">\(\eta_1,..,\eta_{j-1}\)</span> are replaced by <span class="math">\(1\)</span> in <span class="math">\(p_1\)</span>. Informally,
we can &#8220;integrate&#8221; these variables <em>before</em> performing the product. More
generally, if a monomial <span class="math">\(\eta_i\)</span> is missing in one of the terms of a
product of two terms, then it can be integrated in the other term.</p>
<p>Now let us consider an <span class="math">\(m \times n\)</span> matrix with <span class="math">\(m \leq n\)</span>. The <em>sum of
permanental `k`-minors of `A`</em> is</p>
<div class="math">
\[perm(A, k) = \sum_{r,c} perm(A_{r,c})\]</div>
<p>where the sum is over the <span class="math">\(k\)</span>-subsets <span class="math">\(r\)</span> of rows and <span class="math">\(k\)</span>-subsets <span class="math">\(c\)</span> of
columns and <span class="math">\(A_{r,c}\)</span> is the submatrix obtained from <span class="math">\(A\)</span> by keeping only
the rows <span class="math">\(r\)</span> and columns <span class="math">\(c\)</span>. Of course
<span class="math">\(perm(A, \min(m,n)) = perm(A)\)</span> and note that <span class="math">\(perm(A,1)\)</span> is just the sum
of all entries of the matrix.</p>
<p>The generating function of these sums of permanental minors is</p>
<div class="math">
\[g(t) = \left\langle
\prod_{i=1}^m \left(1 + t \sum_{j=1}^n A_{ij} \eta_j\right)
\right\rangle\]</div>
<p>In fact the <span class="math">\(t^k\)</span> coefficient of <span class="math">\(g(t)\)</span> corresponds to choosing
<span class="math">\(k\)</span> rows of <span class="math">\(A\)</span>;  <span class="math">\(\eta_i\)</span> is associated to the i-th column;
nilpotency avoids having twice the same column in a product of <span class="math">\(A\)</span>&#8216;s.</p>
<p>For more details, see the article <a class="reference internal" href="../../../references/index.html#bp2015" id="id1">[BP2015]</a>.</p>
<p>From a technical point of view, the product in
<span class="math">\(K[\eta_1, \ldots, \eta_n][t]\)</span> is implemented as a subroutine in
<a class="reference internal" href="#sage.matrix.matrix_misc.prm_mul" title="sage.matrix.matrix_misc.prm_mul"><code class="xref py py-func docutils literal"><span class="pre">prm_mul()</span></code></a>. The indices of the rows and columns actually start at
<span class="math">\(0\)</span>, so the variables are  <span class="math">\(\eta_0, \ldots, \eta_{n-1}\)</span>. Polynomials are
represented in dictionary form: to a variable <span class="math">\(\eta_i\)</span> is associated
the key <span class="math">\(2^i\)</span> (or in Python <code class="docutils literal"><span class="pre">1</span> <span class="pre">&lt;&lt;</span> <span class="pre">i</span></code>). The keys associated to products
are obtained by considering the development in base <span class="math">\(2\)</span>: to the monomial
<span class="math">\(\eta_{i_1} \ldots \eta_{i_k}\)</span> is associated the key
<span class="math">\(2^{i_1} + \ldots + 2^{i_k}\)</span>. So the product <span class="math">\(\eta_1 \eta_2\)</span> corresponds
to the key <span class="math">\(6 = (110)_2\)</span> while <span class="math">\(\eta_0 \eta_3\)</span> has key <span class="math">\(9 = (1001)_2\)</span>.
In particular all operations on monomials are implemented via bitwise
operations on the keys.</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="sage.matrix.matrix_misc.prm_mul">
<code class="descclassname">sage.matrix.matrix_misc.</code><code class="descname">prm_mul</code><span class="sig-paren">(</span><em>p1</em>, <em>p2</em>, <em>mask_free</em>, <em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_misc.prm_mul" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the product of <code class="docutils literal"><span class="pre">p1</span></code> and <code class="docutils literal"><span class="pre">p2</span></code>, putting free variables in
<code class="docutils literal"><span class="pre">mask_free</span></code> to <span class="math">\(1\)</span>.</p>
<p>This function is mainly use as a subroutine of
<a class="reference internal" href="#sage.matrix.matrix_misc.permanental_minor_polynomial" title="sage.matrix.matrix_misc.permanental_minor_polynomial"><code class="xref py py-func docutils literal"><span class="pre">permanental_minor_polynomial()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(p1,p2\)</span> &#8211; polynomials as dictionaries</li>
<li><span class="math">\(mask_free\)</span> &#8211; an integer mask that give the list of free variables
(the <span class="math">\(i\)</span>-th variable is free if the <span class="math">\(i\)</span>-th bit of <code class="docutils literal"><span class="pre">mask_free</span></code> is <span class="math">\(1\)</span>)</li>
<li><span class="math">\(prec\)</span> &#8211; if <span class="math">\(prec\)</span> is not None, truncate the product at precision <span class="math">\(prec\)</span></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.matrix.matrix_misc</span> <span class="kn">import</span> <span class="n">prm_mul</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p1</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="n">t</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">p2</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">t</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">prm_mul</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="go">{0: 2*t + 1, 2: t^2 + t, 4: t^2 + t, 6: t^2}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.matrix.matrix_misc.row_iterator">
<code class="descclassname">sage.matrix.matrix_misc.</code><code class="descname">row_iterator</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_misc.row_iterator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="sage.matrix.matrix_misc.row_reduced_form">
<code class="descclassname">sage.matrix.matrix_misc.</code><code class="descname">row_reduced_form</code><span class="sig-paren">(</span><em>M</em>, <em>transformation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix_misc.row_reduced_form" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes a row reduced form of a matrix over a rational
function field <span class="math">\(k(x)\)</span>, for <span class="math">\(k\)</span> a field.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(M\)</span> - a matrix over <span class="math">\(k(x)\)</span> or <span class="math">\(k[x]\)</span> for <span class="math">\(k\)</span> a field.</li>
<li><span class="math">\(transformation\)</span> - A boolean (default: <span class="math">\(False\)</span>). If this boolean is set to <span class="math">\(True\)</span> a second matrix is output (see OUTPUT).</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<p>If <span class="math">\(transformation\)</span> is <span class="math">\(False\)</span>, the output is <span class="math">\(W\)</span>, a row reduced form of <span class="math">\(M\)</span>.</p>
<p>If <span class="math">\(transformation\)</span> is <span class="math">\(True\)</span>, this function will output a pair <span class="math">\((W,N)\)</span> consisting of two matrices over <span class="math">\(k(x)\)</span>:</p>
<ol class="arabic simple">
<li><span class="math">\(W\)</span> - a row reduced form of <span class="math">\(M\)</span>.</li>
<li><span class="math">\(N\)</span> - an invertible matrix over <span class="math">\(k(x)\)</span> satisfying <span class="math">\(NW = M\)</span>.</li>
</ol>
<p>EXAMPLES:</p>
<p>The function expects matrices over the rational function field, but
other examples below show how one can provide matrices over the ring
of polynomials (whose quotient field is the rational function field).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">FractionField</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">sage.matrix.matrix_misc</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">matrix</span><span class="o">.</span><span class="n">matrix_misc</span><span class="o">.</span><span class="n">row_reduced_form</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">/</span><span class="n">t</span><span class="p">],[(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">)]]))</span>
<span class="go">doctest:...: DeprecationWarning: Row reduced form will soon be supported only for matrices of polynomials.</span>
<span class="go">See http://trac.sagemath.org/21024 for details.</span>
<span class="go">[        0]</span>
<span class="go">[(t + 2)/t]</span>
</pre></div>
</div>
<p>The last example shows the usage of the transformation parameter.</p>
<dl class="docutils">
<dt>::</dt>
<dd>sage: Fq.&lt;a&gt; = GF(2^3)
sage: Fx.&lt;x&gt; = Fq[]
sage: A = matrix(Fx,[[x^2+a,x^4+a],[x^3,a*x^4]])
sage: from sage.matrix.matrix_misc import row_reduced_form
sage: row_reduced_form(A,transformation=True)
(
[          x^2 + a           x^4 + a]  [1 0]
[x^3 + a*x^2 + a^2               a^2], [a 1]
)</dd>
</dl>
<p>NOTES:</p>
<p>See docstring for row_reduced_form method of matrices for
more information.</p>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="docs.html"
                                  title="previous chapter">Matrices over an arbitrary ring</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="special.html"
                                  title="next chapter">Constructors for special matrices</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/matrix/matrix_misc.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="special.html" title="Constructors for special matrices"
             >next</a> |</li>
        <li class="right" >
          <a href="docs.html" title="Matrices over an arbitrary ring"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Matrices and Spaces of Matrices</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2017, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>