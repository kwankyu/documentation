
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Base class for matrices, part 2 &#8212; Sage Reference Manual v8.5: Matrices and Spaces of Matrices</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Generic Asymptotically Fast Strassen Algorithms" href="strassen.html" />
    <link rel="prev" title="Base class for matrices, part 1" href="matrix1.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="strassen.html" title="Generic Asymptotically Fast Strassen Algorithms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="matrix1.html" title="Base class for matrices, part 1"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Matrices and Spaces of Matrices</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="base-class-for-matrices-part-2">
<span id="sage-matrix-matrix2"></span><h1>Base class for matrices, part 2<a class="headerlink" href="#base-class-for-matrices-part-2" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.matrix.matrix2"></span><p>For design documentation see matrix/docs.py.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein: initial version</li>
<li>Miguel Marco (2010-06-19): modified eigenvalues and eigenvectors functions to
allow the option extend=False</li>
<li>Rob Beezer (2011-02-05): refactored all of the matrix kernel routines</li>
</ul>
<dl class="class">
<dt id="sage.matrix.matrix2.Matrix">
<em class="property">class </em><code class="descclassname">sage.matrix.matrix2.</code><code class="descname">Matrix</code><a class="headerlink" href="#sage.matrix.matrix2.Matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix" title="sage.matrix.matrix1.Matrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.matrix.matrix1.Matrix</span></code></a></p>
<dl class="attribute">
<dt id="sage.matrix.matrix2.Matrix.C">
<code class="descname">C</code><a class="headerlink" href="#sage.matrix.matrix2.Matrix.C" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conjugate matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>     <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">7</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                    [7 + 3*I, -1 + 6*I, 3 + 5*I],</span>
<span class="go">....:                    [3 + 3*I, -3 + 6*I, 5 +   I]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">C</span>
<span class="go">[      -3  5 + 3*I  7 + 4*I]</span>
<span class="go">[ 7 - 3*I -1 - 6*I  3 - 5*I]</span>
<span class="go">[ 3 - 3*I -3 - 6*I  5 - 1*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="sage.matrix.matrix2.Matrix.H">
<code class="descname">H</code><a class="headerlink" href="#sage.matrix.matrix2.Matrix.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conjugate-transpose (Hermitian) matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>     <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">7</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                    [7 + 3*I, -1 + 6*I, 3 + 5*I],</span>
<span class="go">....:                    [3 + 3*I, -3 + 6*I, 5 +   I]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">H</span>
<span class="go">[      -3  7 - 3*I  3 - 3*I]</span>
<span class="go">[ 5 + 3*I -1 - 6*I -3 - 6*I]</span>
<span class="go">[ 7 + 4*I  3 - 5*I  5 - 1*I]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.LU">
<code class="descname">LU</code><span class="sig-paren">(</span><em>pivot=None</em>, <em>format='plu'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.LU" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds a decomposition into a lower-triangular matrix and
an upper-triangular matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">pivot</span></code> - pivoting strategy<ul>
<li>‘auto’ (default) - see if the matrix entries are
ordered (i.e. if they have an absolute value method),
and if so, use a the partial pivoting strategy.
Otherwise, fall back to the nonzero strategy.  This
is the best choice for general routines that may
call this for matrix entries of a variety of types.</li>
<li>‘partial’ - each column is examined for
the element with the largest absolute value and the
row containing this element is swapped into place.</li>
<li>‘nonzero’ - the first nonzero element in a column
is located and the row with this element is used.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - contents of output, see more discussion
below about output.<ul>
<li>‘plu’ (default) - a triple; matrices P, L and U
such that A = P*L*U.</li>
<li>‘compact’ - a pair; row permutation as a tuple, and the
matrices L and U combined into one matrix.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>Suppose that <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix, then an LU
decomposition is a lower-triangular <span class="math notranslate nohighlight">\(m\times m\)</span> matrix
<span class="math notranslate nohighlight">\(L\)</span> with every diagonal element equal to 1, and an
upper-triangular <span class="math notranslate nohighlight">\(m\times n\)</span> matrix, <span class="math notranslate nohighlight">\(U\)</span> such that the
product <span class="math notranslate nohighlight">\(LU\)</span>, after a permutation of the rows, is then
equal to <span class="math notranslate nohighlight">\(A\)</span>.  For the ‘plu’ format the permutation is
returned as an <span class="math notranslate nohighlight">\(m\times m\)</span> permutation matrix <span class="math notranslate nohighlight">\(P\)</span> such
that</p>
<div class="math notranslate nohighlight">
\[A = PLU\]</div>
<p>It is more common to place the permutation matrix just
to the left of <span class="math notranslate nohighlight">\(A\)</span>.  If you desire this version, then
use the inverse of <span class="math notranslate nohighlight">\(P\)</span> which is computed most efficiently
as its transpose.</p>
<p>If the ‘partial’ pivoting strategy is used, then the
non-diagonal entries of <span class="math notranslate nohighlight">\(L\)</span> will be less than or equal
to 1 in absolute value.  The ‘nonzero’ pivot strategy may
be faster, but the growth of data structures for elements of
the decomposition might counteract the advantage.</p>
<p>By necessity, returned matrices have a base ring equal
to the fraction field of the base ring of the original matrix.</p>
<p>In the ‘compact’ format, the first returned value is a
tuple that is a permutation of the rows of <span class="math notranslate nohighlight">\(LU\)</span> that yields
<span class="math notranslate nohighlight">\(A\)</span>.  See the doctest for how you might employ this
permutation.  Then the matrices <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> are merged
into one matrix – remove the diagonal of ones in <span class="math notranslate nohighlight">\(L\)</span>
and the remaining nonzero entries can replace the
entries of <span class="math notranslate nohighlight">\(U\)</span> beneath the diagonal.</p>
<p>The results are cached, only in the compact format, separately
for each pivot strategy called.  Repeated requests for the
‘plu’ format will require just a small amount of overhead
in each call to bust out the compact format to the three
matrices.  Since only the compact format is cached, the
components of the compact format are immutable, while the
components of the ‘plu’ format are regenerated, and hence
are mutable.</p>
<p>Notice that while <span class="math notranslate nohighlight">\(U\)</span> is similar to row-echelon form and the
rows of <span class="math notranslate nohighlight">\(U\)</span> span the row space of <span class="math notranslate nohighlight">\(A\)</span>, the rows of <span class="math notranslate nohighlight">\(U\)</span> are not
generally linearly independent.  Nor are the pivot columns
(or rank) immediately obvious.  However for rings without
specialized echelon form routines, this method is about
twice as fast as the generic echelon form routine since
it only acts “below the diagonal”, as would be predicted
from a theoretical analysis of the algorithms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is an exact computation, so limited to exact
rings. If you need numerical results, convert the
base ring to the field of real double numbers,
<code class="docutils literal notranslate"><span class="pre">RDF</span></code> or the field of complex double numbers,
<code class="docutils literal notranslate"><span class="pre">CDF</span></code>, which will use a faster routine that
is careful about numerical subtleties.</p>
</div>
<p>ALGORITHM:</p>
<blockquote>
<div>“Gaussian Elimination with Partial Pivoting,”
Algorithm 21.1 of <a class="reference internal" href="../../../references/index.html#tb1997" id="id1">[TB1997]</a>.</div></blockquote>
<p>EXAMPLES:</p>
<p>Notice the difference in the <span class="math notranslate nohighlight">\(L\)</span> matrix as a result of different
pivoting strategies.  With partial pivoting, every entry of <span class="math notranslate nohighlight">\(L\)</span>
has absolute value 1 or less.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [2, -1,  0,  6,  4,  8, -2],</span>
<span class="go">....:                 [2,  0,  1,  4,  2,  6,  0],</span>
<span class="go">....:                 [1,  0, -1,  8, -1, -1, -3],</span>
<span class="go">....:                 [1,  1,  2, -2, -1,  1,  3]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;partial&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[0 0 0 0 1]</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[   1    0    0    0    0]</span>
<span class="go">[ 1/2    1    0    0    0]</span>
<span class="go">[ 1/2  1/3    1    0    0]</span>
<span class="go">[   1  2/3  1/5    1    0]</span>
<span class="go">[ 1/2 -1/3 -2/5    0    1]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[    2    -1     0     6     4     8    -2]</span>
<span class="go">[    0   3/2     2    -5    -3    -3     4]</span>
<span class="go">[    0     0  -5/3  20/3    -2    -4 -10/3]</span>
<span class="go">[    0     0     0     0   2/5   4/5     0]</span>
<span class="go">[    0     0     0     0   1/5   2/5     0]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;nonzero&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="go">[0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[ 1  0  0  0  0]</span>
<span class="go">[ 2  1  0  0  0]</span>
<span class="go">[ 2  2  1  0  0]</span>
<span class="go">[ 1  1 -1  1  0]</span>
<span class="go">[ 1  2  2  0  1]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[ 1 -1  0  2  4  7 -1]</span>
<span class="go">[ 0  1  0  2 -4 -6  0]</span>
<span class="go">[ 0  0  1 -4  2  4  2]</span>
<span class="go">[ 0  0  0  0  1  2  0]</span>
<span class="go">[ 0  0  0  0 -1 -2  0]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example of the compact format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span>  <span class="mi">5</span><span class="p">],</span>
<span class="go">....:                 [ 1,  4,  7,  8],</span>
<span class="go">....:                 [-1, -4, -6, -6],</span>
<span class="go">....:                 [ 0, -2, -5, -8],</span>
<span class="go">....:                 [-2, -6, -6, -2]])</span>
<span class="gp">sage: </span><span class="n">perm</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;compact&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">perm</span>
<span class="go">(4, 3, 0, 1, 2)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[  -2   -6   -6   -2]</span>
<span class="go">[   0   -2   -5   -8]</span>
<span class="go">[-1/2    0    2    4]</span>
<span class="go">[-1/2 -1/2  3/4    0]</span>
<span class="go">[ 1/2  1/2 -1/4    0]</span>
</pre></div>
</div>
<p>We can easily illustrate the relationships between
the two formats with a square matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span>
<span class="go">....:                 [ 1, -2,  1,  3],</span>
<span class="go">....:                 [-4,  7, -3, -8],</span>
<span class="go">....:                 [-3,  8, -1, -5]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;plu&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">perm</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;compact&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">L</span> <span class="o">-</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">+</span> <span class="n">U</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">perm</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">perm</span><span class="p">))]</span>
<span class="gp">sage: </span><span class="n">PP</span> <span class="o">=</span> <span class="n">Permutation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">PP</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a nonsingular matrix, and the ‘nonzero’ pivot
strategy there is no need to permute rows, so the
permutation matrix will be the identity.  Furthermore,
it can be shown that then the <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(U\)</span> matrices
are uniquely determined by requiring <span class="math notranslate nohighlight">\(L\)</span> to have ones
on the diagonal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [ 3, -2,  3, -1,  0,  6],</span>
<span class="go">....:                 [-4,  2, -3,  1, -1, -8],</span>
<span class="go">....:                 [-2,  2, -3,  2,  1,  0],</span>
<span class="go">....:                 [ 0, -1, -1,  0,  2,  5],</span>
<span class="go">....:                 [-1,  2, -4, -1,  5, -3]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;nonzero&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0 0 0 0 0]</span>
<span class="go">[0 1 0 0 0 0]</span>
<span class="go">[0 0 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 0]</span>
<span class="go">[0 0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[   1    0    0    0    0    0]</span>
<span class="go">[   3    1    0    0    0    0]</span>
<span class="go">[  -4   -1    1    0    0    0]</span>
<span class="go">[  -2   -1   -1    1    0    0]</span>
<span class="go">[   0  1/2  1/4  1/2    1    0]</span>
<span class="go">[  -1   -1 -5/2   -2   -6    1]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[   1    0    2    0   -2   -1]</span>
<span class="go">[   0   -2   -3   -1    6    9]</span>
<span class="go">[   0    0    2    0   -3   -3]</span>
<span class="go">[   0    0    0    1    0    4]</span>
<span class="go">[   0    0    0    0 -1/4 -3/4]</span>
<span class="go">[   0    0    0    0    0    1]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The base ring of the matrix may be any field, or a ring
which has a fraction field implemented in Sage. The ring
needs to be exact (there is a numerical LU decomposition
for matrices over <code class="docutils literal notranslate"><span class="pre">RDF</span></code> and <code class="docutils literal notranslate"><span class="pre">CDF</span></code>).  Matrices returned
are over the original field, or the fraction field of the
ring.  If the field is not ordered (i.e. the absolute value
function is not implemented), then the pivot strategy needs
to be ‘nonzero’.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">base ring of the matrix must be exact, not Real Field with 100 bits of precision</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">base ring of the matrix needs a field of fractions, not Ring of integers modulo 6</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;partial&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">cannot take absolute value of matrix entries, try &#39;pivot=nonzero&#39;</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;nonzero&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[          1           0]</span>
<span class="go">[y^2/(y + 1)           1]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  y + 1 y^2 + y]</span>
<span class="go">[      0       0]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Fraction Field of Univariate Polynomial Ring in y over Rational Field</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                [3, 2*a + 4, 2*a + 4, 2*a + 1],</span>
<span class="go">....:                [3*a + 1, a + 3, 2*a + 4, 4*a + 3],</span>
<span class="go">....:                [a, 3, 3*a + 1, a]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">pivot</span><span class="o">=</span><span class="s1">&#39;nonzero&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[      1       0       0       0]</span>
<span class="go">[3*a + 3       1       0       0]</span>
<span class="go">[    2*a 4*a + 2       1       0]</span>
<span class="go">[2*a + 3       2 2*a + 4       1]</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[  a + 3 4*a + 4       2 4*a + 2]</span>
<span class="go">[      0   a + 1   a + 3 2*a + 4]</span>
<span class="go">[      0       0       1 4*a + 2]</span>
<span class="go">[      0       0       0       0]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field in a of size 5^2</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">L</span><span class="o">*</span><span class="n">U</span>
<span class="go">True</span>
</pre></div>
</div>
<p>With no pivoting strategy given (i.e. <code class="docutils literal notranslate"><span class="pre">pivot=None</span></code>)
the routine will try to use partial pivoting, but then
fall back to the nonzero strategy. For the nonsingular
matrix below, we see evidence of pivoting when viewed
over the rationals, and no pivoting over the integers
mod 29.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">perm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;compact&#39;</span><span class="p">);</span> <span class="n">perm</span>
<span class="go">(0, 1, 2, 3)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">perm</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">LU</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;compact&#39;</span><span class="p">);</span> <span class="n">perm</span>
<span class="go">(2, 0, 1, 3)</span>
</pre></div>
</div>
<p>The <span class="math notranslate nohighlight">\(U\)</span> matrix is only guaranteed to be upper-triangular.
The rows are not necessarily linearly independent, nor are
the pivots columns or rank in evidence.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-1,  4,  0, -4,  0, -4, 5, -7, -7],</span>
<span class="go">....:                 [ 0,  0,  1, -4, -1, -3, 6, -5, -6],</span>
<span class="go">....:                 [-2,  8, -1, -4,  2, -4, 1, -8, -7],</span>
<span class="go">....:                 [ 1, -4,  2, -4, -3,  2, 5,  6,  4]])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">LU</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">U</span>
<span class="go">[   -2     8    -1    -4     2    -4     1    -8    -7]</span>
<span class="go">[    0     0   1/2    -2    -1    -2   9/2    -3  -7/2]</span>
<span class="go">[    0     0   3/2    -6    -2     0  11/2     2   1/2]</span>
<span class="go">[    0     0     0     0  -1/3    -1   5/3  -5/3  -5/3]</span>
<span class="go">[    0     0     0     0   1/3    -3   7/3 -19/3 -19/3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[ 1 -4  0  4  0  0 -1 -1 -1]</span>
<span class="go">[ 0  0  1 -4  0  0  1  0 -1]</span>
<span class="go">[ 0  0  0  0  1  0 -2 -1 -1]</span>
<span class="go">[ 0  0  0  0  0  1 -1  2  2]</span>
<span class="go">[ 0  0  0  0  0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pivots</span><span class="p">()</span>
<span class="go">(0, 2, 4, 5)</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-04-26)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.QR">
<code class="descname">QR</code><span class="sig-paren">(</span><em>full=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.QR" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a factorization of <code class="docutils literal notranslate"><span class="pre">self</span></code> as a unitary matrix
and an upper-triangular matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">full</span></code> - default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code> then the
returned matrices have dimensions as described below.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> the <code class="docutils literal notranslate"><span class="pre">R</span></code> matrix has no zero rows and the
columns of <code class="docutils literal notranslate"><span class="pre">Q</span></code> are a basis for the column space of
<code class="docutils literal notranslate"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix and <code class="docutils literal notranslate"><span class="pre">full=True</span></code> then this
method returns a pair of matrices: <span class="math notranslate nohighlight">\(Q\)</span> is an <span class="math notranslate nohighlight">\(m\times m\)</span> unitary
matrix (meaning its inverse is its conjugate-transpose) and <span class="math notranslate nohighlight">\(R\)</span>
is an <span class="math notranslate nohighlight">\(m\times n\)</span> upper-triangular matrix with non-negative entries
on the diagonal.  For a matrix of full rank this factorization is
unique (due to the restriction to positive entries on the diagonal).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">full=False</span></code> then <span class="math notranslate nohighlight">\(Q\)</span> has <span class="math notranslate nohighlight">\(m\)</span> rows and the columns form an
orthonormal basis for the column space of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  So, in particular,
the conjugate-transpose of <span class="math notranslate nohighlight">\(Q\)</span> times <span class="math notranslate nohighlight">\(Q\)</span> will be an identity matrix.
The matrix <span class="math notranslate nohighlight">\(R\)</span> will still be upper-triangular but will also have full
rank, in particular it will lack the zero rows present in a full
factorization of a rank-deficient matrix.</p>
<p>The results obtained when <code class="docutils literal notranslate"><span class="pre">full=True</span></code> are cached,
hence <span class="math notranslate nohighlight">\(Q\)</span> and <span class="math notranslate nohighlight">\(R\)</span> are immutable matrices in this case.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is an exact computation, so limited to exact rings.
Also the base ring needs to have a fraction field implemented
in Sage and this field must contain square roots.  One example
is the field of algebraic numbers, <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>, as used in the
examples below.  If you need numerical results, convert the
base ring to the field of complex double numbers, <code class="docutils literal notranslate"><span class="pre">CDF</span></code>,
which will use a faster routine that is careful about
numerical subtleties.</p>
</div>
<p>ALGORITHM:</p>
<p>“Modified Gram-Schmidt,” Algorithm 8.1 of <a class="reference internal" href="../../../references/index.html#tb1997" id="id2">[TB1997]</a>.</p>
<p>EXAMPLES:</p>
<p>For a nonsingular matrix, the QR decomposition is unique.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                    [-2, 1, -6, -3, -1],</span>
<span class="go">....:                    [1, 1, 7, 4, 5],</span>
<span class="go">....:                    [3, 0, 8, 3, 3],</span>
<span class="go">....:                    [-1, 1, -6, -6, 5]])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[ -0.4588314677411235?  -0.1260506983326509?   0.3812120831224489?   -0.394573711338418?     -0.6874400625964?]</span>
<span class="go">[ -0.4588314677411235?   0.4726901187474409? -0.05198346588033394?   0.7172941251646595?     -0.2209628772631?]</span>
<span class="go">[  0.2294157338705618?   0.6617661662464172?   0.6619227988762521?  -0.1808720937375480?      0.1964114464561?]</span>
<span class="go">[  0.6882472016116853?   0.1890760474989764?  -0.2044682991293135?   0.0966302966543065?     -0.6628886317894?]</span>
<span class="go">[ -0.2294157338705618?   0.5357154679137663?   -0.609939332995919?   -0.536422031427112?      0.0245514308070?]</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">[  4.358898943540674? -0.4588314677411235?   13.07669683062202?   6.194224814505168?   2.982404540317303?]</span>
<span class="go">[                   0   1.670171752907625?  0.5987408170800917?  -1.292019657909672?   6.207996892883057?]</span>
<span class="go">[                   0                    0   5.444401659866974?   5.468660610611130? -0.6827161852283857?]</span>
<span class="go">[                   0                    0                    0   1.027626039419836?  -3.619300149686620?]</span>
<span class="go">[                   0                    0                    0                    0   0.024551430807012?]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span><span class="o">*</span><span class="n">Q</span>
<span class="go">[1.000000000000000?            0.?e-18            0.?e-17            0.?e-16            0.?e-13]</span>
<span class="go">[           0.?e-18 1.000000000000000?            0.?e-17            0.?e-16            0.?e-13]</span>
<span class="go">[           0.?e-17            0.?e-17 1.000000000000000?            0.?e-16            0.?e-13]</span>
<span class="go">[           0.?e-16            0.?e-16            0.?e-16 1.000000000000000?            0.?e-13]</span>
<span class="go">[           0.?e-13            0.?e-13            0.?e-13            0.?e-13   1.0000000000000?]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">*</span><span class="n">R</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example with complex numbers in <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>, the field of algebraic
numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="n">I</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                    [1, -2*I - 1, -I + 3, -I + 1],</span>
<span class="go">....:                    [I + 7, 2*I + 1, -2*I + 7, -I + 1],</span>
<span class="go">....:                    [I + 2, 0, I + 12, -1]])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[                          -0.7302967433402215?    0.2070566455055649? + 0.5383472783144687?*I    0.2463049809998642? - 0.0764456358723292?*I    0.2381617683194332? - 0.1036596032779695?*I]</span>
<span class="go">[                           0.0912870929175277?   -0.2070566455055649? - 0.3778783780476559?*I    0.3786559533863033? - 0.1952221495524667?*I     0.701244450214469? - 0.3643711650986595?*I]</span>
<span class="go">[   0.6390096504226938? + 0.0912870929175277?*I    0.1708217325420910? + 0.6677576817554466?*I -0.03411475806452072? + 0.04090198741767143?*I    0.3140171085506764? - 0.0825191718705412?*I]</span>
<span class="go">[   0.1825741858350554? + 0.0912870929175277?*I  -0.03623491296347385? + 0.0724698259269477?*I   0.8632284069415110? + 0.06322839976356195?*I   -0.4499694867611521? - 0.0116119181208918?*I]</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">[                          10.95445115010333?               0.?e-18 - 1.917028951268082?*I    5.385938482134133? - 2.190890230020665?*I  -0.2738612787525831? - 2.190890230020665?*I]</span>
<span class="go">[                                           0               4.829596256417300? + 0.?e-18*I   -0.869637911123373? - 5.864879483945125?*I   0.993871898426712? - 0.3054085521207082?*I]</span>
<span class="go">[                                           0                                            0               12.00160760935814? + 0.?e-16*I -0.2709533402297273? + 0.4420629644486323?*I]</span>
<span class="go">[                                           0                                            0                                            0               1.942963944258992? + 0.?e-16*I]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span><span class="o">*</span><span class="n">Q</span>
<span class="go">[1.000000000000000? + 0.?e-19*I            0.?e-18 + 0.?e-17*I            0.?e-17 + 0.?e-17*I            0.?e-16 + 0.?e-16*I]</span>
<span class="go">[           0.?e-18 + 0.?e-17*I 1.000000000000000? + 0.?e-17*I            0.?e-17 + 0.?e-17*I            0.?e-16 + 0.?e-16*I]</span>
<span class="go">[           0.?e-17 + 0.?e-17*I            0.?e-17 + 0.?e-17*I 1.000000000000000? + 0.?e-17*I            0.?e-16 + 0.?e-16*I]</span>
<span class="go">[           0.?e-16 + 0.?e-16*I            0.?e-16 + 0.?e-16*I            0.?e-16 + 0.?e-16*I 1.000000000000000? + 0.?e-16*I]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">*</span><span class="n">R</span> <span class="o">-</span> <span class="n">A</span>
<span class="go">[            0.?e-17 0.?e-17 + 0.?e-17*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]</span>
<span class="go">[            0.?e-18 0.?e-17 + 0.?e-17*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]</span>
<span class="go">[0.?e-17 + 0.?e-18*I 0.?e-17 + 0.?e-17*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]</span>
<span class="go">[0.?e-18 + 0.?e-18*I 0.?e-18 + 0.?e-18*I 0.?e-16 + 0.?e-16*I 0.?e-16 + 0.?e-16*I]</span>
</pre></div>
</div>
<p>A rank-deficient rectangular matrix, with both values of the <code class="docutils literal notranslate"><span class="pre">full</span></code> keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                    [-1, 1, -1],</span>
<span class="go">....:                    [-1, 3, -3],</span>
<span class="go">....:                    [-5, 1, -1]])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[  0.3592106040535498?  -0.5693261797050169?   0.7239227659930268?   0.1509015305256380?]</span>
<span class="go">[ -0.1796053020267749?   0.1445907757980996?                     0   0.9730546968377341?]</span>
<span class="go">[ -0.1796053020267749?   0.7048800320157352?    0.672213996993525?  -0.1378927778941174?]</span>
<span class="go">[ -0.8980265101338745?  -0.3976246334447737?   0.1551263069985058? -0.10667177157846818?]</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">[ 5.567764362830022? -2.694079530401624?  2.694079530401624?]</span>
<span class="go">[                  0  3.569584777515583? -3.569584777515583?]</span>
<span class="go">[                  0                   0                   0]</span>
<span class="go">[                  0                   0                   0]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span><span class="o">*</span><span class="n">Q</span>
<span class="go">[                 1            0.?e-18            0.?e-18            0.?e-18]</span>
<span class="go">[           0.?e-18                  1            0.?e-18            0.?e-18]</span>
<span class="go">[           0.?e-18            0.?e-18 1.000000000000000?            0.?e-18]</span>
<span class="go">[           0.?e-18            0.?e-18            0.?e-18 1.000000000000000?]</span>

<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[ 0.3592106040535498? -0.5693261797050169?]</span>
<span class="go">[-0.1796053020267749?  0.1445907757980996?]</span>
<span class="go">[-0.1796053020267749?  0.7048800320157352?]</span>
<span class="go">[-0.8980265101338745? -0.3976246334447737?]</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">[ 5.567764362830022? -2.694079530401624?  2.694079530401624?]</span>
<span class="go">[                  0  3.569584777515583? -3.569584777515583?]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span><span class="o">*</span><span class="n">Q</span>
<span class="go">[      1 0.?e-18]</span>
<span class="go">[0.?e-18       1]</span>
</pre></div>
</div>
<p>Another rank-deficient rectangular matrix, with complex entries,
as a reduced decomposition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="n">I</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                    [-I - 1, -2, 5*I - 1, -I - 2],</span>
<span class="go">....:                    [-4*I - 4, I - 5, -7*I, -I - 4]])</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">(</span><span class="n">full</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[ -0.4160251471689219? - 0.4160251471689219?*I   0.5370861555295747? + 0.1790287185098583?*I]</span>
<span class="go">[ -0.1386750490563073? - 0.1386750490563073?*I  -0.7519206177414046? - 0.2506402059138015?*I]</span>
<span class="go">[ -0.5547001962252291? - 0.5547001962252291?*I -0.2148344622118299? - 0.07161148740394329?*I]</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">[                        7.211102550927979?  3.328201177351375? - 5.269651864139676?*I   7.904477796209515? + 8.45917799243475?*I  4.021576422632911? - 2.634825932069838?*I]</span>
<span class="go">[                                         0                         1.074172311059150?  -1.611258466588724? - 9.13046464400277?*I 1.611258466588724? + 0.5370861555295747?*I]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span><span class="o">*</span><span class="n">Q</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">*</span><span class="n">R</span><span class="o">-</span><span class="n">A</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
</pre></div>
</div>
<p>Results of full decompositions are cached and thus returned
immutable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">is_mutable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">is_mutable</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Trivial cases return trivial results of the correct size,
and we check <span class="math notranslate nohighlight">\(Q\)</span> itself in one case.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">R</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">(0, 10)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="p">,</span> <span class="n">R</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">QR</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">Q</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">(3, 3)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">R</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">(3, 0)</span>
<span class="gp">sage: </span><span class="n">Q</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-02-17)</li>
</ul>
</dd></dl>

<dl class="attribute">
<dt id="sage.matrix.matrix2.Matrix.T">
<code class="descname">T</code><a class="headerlink" href="#sage.matrix.matrix2.Matrix.T" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the transpose of a matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">T</span>
<span class="go">[ 0  5 10 15 20]</span>
<span class="go">[ 1  6 11 16 21]</span>
<span class="go">[ 2  7 12 17 22]</span>
<span class="go">[ 3  8 13 18 23]</span>
<span class="go">[ 4  9 14 19 24]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.adjoint">
<code class="descname">adjoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the adjoint matrix of self (matrix of cofactors).</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">N</span></code> - the adjoint matrix, such that
N * M = M * N = M.parent(M.det())</li>
</ul>
<p>ALGORITHM:</p>
<p>Use PARI whenever the method <code class="docutils literal notranslate"><span class="pre">self._adjoint</span></code> is included to do so
in an inheriting class.  Otherwise, use a generic division-free
algorithm to compute the characteristic polynomial and hence the
adjoint.</p>
<p>The result is cached.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span> <span class="p">;</span> <span class="n">M</span>
<span class="go">[5 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="p">;</span> <span class="n">N</span>
<span class="go">[ 4 -2]</span>
<span class="go">[-3  5]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">N</span>
<span class="go">[14  0]</span>
<span class="go">[ 0 14]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">*</span> <span class="n">M</span>
<span class="go">[14  0]</span>
<span class="go">[ 0 14]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">56</span><span class="p">,</span><span class="mi">33</span><span class="o">/</span><span class="mi">13</span><span class="p">,</span><span class="mi">41</span><span class="o">/</span><span class="mi">10</span><span class="p">])</span> <span class="p">;</span> <span class="n">M</span>
<span class="go">[  5/3  1/28]</span>
<span class="go">[33/13 41/10]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">adjoint</span><span class="p">()</span> <span class="p">;</span> <span class="n">N</span>
<span class="go">[ 41/10  -1/28]</span>
<span class="go">[-33/13    5/3]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">N</span>
<span class="go">[7363/1092         0]</span>
<span class="go">[        0 7363/1092]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Unknown: No author specified in the file from 2009-06-25</li>
<li>Sebastian Pancratz (2009-06-25): Reflecting the change that
<code class="docutils literal notranslate"><span class="pre">_adjoint</span></code> is now implemented in this class</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.apply_map">
<code class="descname">apply_map</code><span class="sig-paren">(</span><em>phi</em>, <em>R=None</em>, <em>sparse=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.apply_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the given map phi (an arbitrary Python function or callable
object) to this dense matrix. If R is not given, automatically
determine the base ring of the resulting matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">sparse</span></code> – True to make the output a sparse matrix; default False</li>
<li><code class="docutils literal notranslate"><span class="pre">phi</span></code> - arbitrary Python function or callable object</li>
<li><code class="docutils literal notranslate"><span class="pre">R</span></code> - (optional) ring</li>
</ul>
<p>OUTPUT: a matrix over R</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">k</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="n">f</span><span class="p">);</span> <span class="n">n</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 1 2]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 3 by 3 dense matrices over Finite Field in a of size 3^2</span>
</pre></div>
</div>
<p>In this example, we explicitly specify the codomain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">s</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">k</span><span class="p">);</span> <span class="n">n</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 1 2]</span>
<span class="go">[0 1 2]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 3 by 3 dense matrices over Finite Field in a of size 3^2</span>
</pre></div>
</div>
<p>If self is subdivided, the result will be as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">srange</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> <span class="n">m</span>
<span class="go">[0|1]</span>
<span class="go">[2|3]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">[0|1]</span>
<span class="go">[4|9]</span>
</pre></div>
</div>
<p>If the matrix is sparse, the result will be as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">6</span>
<span class="gp">sage: </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">83</span><span class="p">]</span> <span class="o">=</span> <span class="mi">19</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="nb">abs</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span>
<span class="go">{(1, 83): 19, (18, 32): 6}</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If the map sends most of the matrix to zero, then it may be useful
to get the result as a sparse matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">//</span><span class="n">x</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">n</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">n</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 3 by 3 sparse matrices over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.apply_morphism">
<code class="descname">apply_morphism</code><span class="sig-paren">(</span><em>phi</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.apply_morphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the morphism phi to the coefficients of this dense matrix.</p>
<p>The resulting matrix is over the codomain of phi.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">phi</span></code> - a morphism, so phi is callable and
phi.domain() and phi.codomain() are defined. The codomain must be a
ring.</li>
</ul>
<p>OUTPUT: a matrix over the codomain of phi</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">apply_morphism</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 0]</span>
<span class="go">[1 2 3]</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">apply_morphism</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
<span class="go">Full MatrixSpace of 3 by 3 dense matrices over Finite Field of size 5</span>
</pre></div>
</div>
<p>We apply a morphism to a matrix over a polynomial ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">]);</span> <span class="n">m</span>
<span class="go">[          x     x^2 + y]</span>
<span class="go">[2/3*y^2 - x           x]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">hom</span><span class="p">([</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">apply_morphism</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">[          y     y^2 + x]</span>
<span class="go">[2/3*x^2 - y           y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.as_bipartite_graph">
<code class="descname">as_bipartite_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.as_bipartite_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a bipartite graph <code class="docutils literal notranslate"><span class="pre">B</span></code> representing
the matrix uniquely.</p>
<p>Vertices are labeled 1 to <code class="docutils literal notranslate"><span class="pre">nrows</span></code>
on the left and <code class="docutils literal notranslate"><span class="pre">nrows</span></code> + 1 to <code class="docutils literal notranslate"><span class="pre">nrows</span></code> + <code class="docutils literal notranslate"><span class="pre">ncols</span></code> on
the right, representing rows and columns correspondingly.
Each row is connected to each column with an edge
weighted by the value of the corresponding matrix entry.</p>
<p>This graph is a helper for calculating automorphisms of
a matrix under row and column permutations. See
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns" title="sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">automorphisms_of_rows_and_columns()</span></code></a>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A bipartite graph.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[1/3   7]</span>
<span class="go">[  6 1/4]</span>
<span class="go">[  8  -5]</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">as_bipartite_graph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">Bipartite graph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 4, 1/3), (1, 5, 7), (2, 4, 6), (2, 5, 1/4), (3, 4, 8), (3, 5, -5)]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">left</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">right</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.as_sum_of_permutations">
<code class="descname">as_sum_of_permutations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.as_sum_of_permutations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current matrix as a sum of permutation matrices</p>
<p>According to the Birkhoff-von Neumann Theorem, any bistochastic matrix
can be written as a positive sum of permutation matrices, which also
means that the polytope of bistochastic matrices is integer.</p>
<p>As a non-bistochastic matrix can obviously not be written as a sum of
permutations, this theorem is an equivalence.</p>
<p>This function, given a bistochastic matrix, returns the corresponding
decomposition.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="../../../combinat/sage/combinat/permutation.html#sage.combinat.permutation.bistochastic_as_sum_of_permutations" title="(in Sage Reference Manual: Combinatorics v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">bistochastic_as_sum_of_permutations</span></code></a>
– for more information on this method.</li>
<li><a class="reference external" href="../../../discrete_geometry/sage/geometry/polyhedron/library.html#sage.geometry.polyhedron.library.Polytopes.Birkhoff_polytope" title="(in Sage Reference Manual: Combinatorial and Discrete Geometry v8.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Birkhoff_polytope()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>We create a bistochastic matrix from a convex sum of permutations, then
try to deduce the decomposition from the matrix</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">9</span><span class="p">,</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">c</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">()</span> <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">p</span><span class="p">)</span> <span class="ow">in</span> <span class="n">L</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">decomp</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">permutation</span><span class="o">.</span><span class="n">bistochastic_as_sum_of_permutations</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">decomp</span><span class="p">)</span>
<span class="go">2*B[[1, 4, 2, 3, 5]] + 3*B[[3, 1, 4, 2, 5]] + 9*B[[4, 1, 3, 5, 2]] + 6*B[[5, 3, 4, 1, 2]]</span>
</pre></div>
</div>
<p>An exception is raised when the matrix is not bistochastic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">decomp</span> <span class="o">=</span> <span class="n">sage</span><span class="o">.</span><span class="n">combinat</span><span class="o">.</span><span class="n">permutation</span><span class="o">.</span><span class="n">bistochastic_as_sum_of_permutations</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The matrix is not bistochastic</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns">
<code class="descname">automorphisms_of_rows_and_columns</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.automorphisms_of_rows_and_columns" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the automorphisms of <code class="docutils literal notranslate"><span class="pre">self</span></code> under
permutations of rows and columns as a list of
pairs of <code class="docutils literal notranslate"><span class="pre">PermutationGroupElement</span></code> objects.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[1 0]</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">automorphisms_of_rows_and_columns</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[((), ()), ((1,2), ())]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">automorphisms_of_rows_and_columns</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">48</span>
</pre></div>
</div>
<p>One can now apply these automorphisms to <code class="docutils literal notranslate"><span class="pre">M</span></code> to show
that it leaves it invariant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">with_permuted_rows_and_columns</span><span class="p">(</span><span class="o">*</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.characteristic_polynomial">
<code class="descname">characteristic_polynomial</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.characteristic_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for self.charpoly(…).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">T^2 - 5*T - 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.charpoly">
<code class="descname">charpoly</code><span class="sig-paren">(</span><em>var='x'</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.charpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the characteristic polynomial of self, as a polynomial over
the base ring.</p>
<p>ALGORITHM:</p>
<p>In the generic case of matrices over a ring (commutative and with
unity), there is a division-free algorithm, which can be accessed
using <code class="docutils literal notranslate"><span class="pre">&quot;df&quot;</span></code>, with complexity <span class="math notranslate nohighlight">\(O(n^4)\)</span>.  Alternatively, by
specifying <code class="docutils literal notranslate"><span class="pre">&quot;hessenberg&quot;</span></code>, this method computes the Hessenberg
form of the matrix and then reads off the characteristic polynomial.
Moreover, for matrices over number fields, this method can use
PARI’s charpoly implementation instead.</p>
<p>The method’s logic is as follows:  If no algorithm is specified,
first check if the base ring is a number field (and then use PARI),
otherwise check if the base ring is the ring of integers modulo n (in
which case compute the characteristic polynomial of a lift of the
matrix to the integers, and then coerce back to the base), next check
if the base ring is an exact field (and then use the Hessenberg form),
or otherwise, use the generic division-free algorithm.
If an algorithm is specified explicitly, if
<code class="docutils literal notranslate"><span class="pre">algorithm</span> <span class="pre">==</span> <span class="pre">&quot;hessenberg&quot;</span></code>, use the Hessenberg form, or otherwise
use the generic division-free algorithm.</p>
<p>The result is cached.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - a variable name (default: ‘x’)</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string:</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">&quot;df&quot;</span></code> - Generic <span class="math notranslate nohighlight">\(O(n^4)\)</span> division-free algorithm</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;hessenberg&quot;</span></code> - Use the Hessenberg form of the matrix</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<p>First a matrix over <span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">x^2 - 5*x - 2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
<p>An example over <span class="math notranslate nohighlight">\(\QQ\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">x^3 - 12*x^2 - 18*x</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<p>We compute the characteristic polynomial of a matrix over the
polynomial ring <span class="math notranslate nohighlight">\(\ZZ[a]\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>  <span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[    a     1]</span>
<span class="go">[    a a + 1]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^2 + (-2*a - 1)*x + a^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Univariate Polynomial Ring in a over Integer Ring</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">2*a + 1</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">a^2</span>
</pre></div>
</div>
<p>We compute the characteristic polynomial of a matrix over the
multi-variate polynomial ring <span class="math notranslate nohighlight">\(\ZZ[x,y]\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^2 + (-y^2 - x)*x - x^2*y + x*y^2</span>
</pre></div>
</div>
<p>It’s a little difficult to distinguish the variables. To fix this,
we temporarily view the indeterminate as <span class="math notranslate nohighlight">\(Z\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">with</span> <span class="n">localvars</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="s1">&#39;Z&#39;</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">Z^2 + (-y^2 - x)*Z - x^2*y + x*y^2</span>
</pre></div>
</div>
<p>We could also compute f in terms of Z from the start:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="go">Z^2 + (-y^2 - x)*Z - x^2*y + x*y^2</span>
</pre></div>
</div>
<p>Here is an example over a number field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[[</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
<span class="go">Z^2 - 2*a*Z - 2*a + 1</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)(</span><span class="n">m</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over integers modulo <span class="math notranslate nohighlight">\(n\)</span> with composite <span class="math notranslate nohighlight">\(n\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Mat</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3</span>
</pre></div>
</div>
<p>Here is an example over a general commutative ring, that is to say,
as of version 4.0.2, SAGE does not even positively determine that
<code class="docutils literal notranslate"><span class="pre">S</span></code> in the following example is an integral domain.  But the
computation of the characteristic polynomial succeeds as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">quo</span><span class="p">((</span><span class="n">b</span><span class="o">^</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="p">[[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span><span class="o">*</span><span class="n">y</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[ x*y^2    2*x]</span>
<span class="go">[     2 x^10*y]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">T^2 + (-x^10*y - x*y^2)*T - 4*x</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Unknown: No author specified in the file from 2009-06-25</li>
<li>Sebastian Pancratz (2009-06-25): Include the division-free algorithm</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.cholesky">
<code class="descname">cholesky</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.cholesky" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Cholesky decomposition of a symmetric or Hermitian matrix.</p>
<p>INPUT:</p>
<p>A square matrix that is real, symmetric and positive definite.
Or a square matrix that is complex, Hermitian and positive
definite.  Generally, the base ring for the entries of the
matrix needs to be a subfield of the algebraic numbers
(<code class="docutils literal notranslate"><span class="pre">QQbar</span></code>).  Examples include the rational numbers (<code class="docutils literal notranslate"><span class="pre">QQ</span></code>),
some number fields, and real algebraic numbers and the
algebraic numbers themselves.</p>
<p>OUTPUT:</p>
<p>For a matrix <span class="math notranslate nohighlight">\(A\)</span> the routine returns a lower triangular
matrix <span class="math notranslate nohighlight">\(L\)</span> such that,</p>
<div class="math notranslate nohighlight">
\[A = LL^\ast\]</div>
<p>where <span class="math notranslate nohighlight">\(L^\ast\)</span> is the conjugate-transpose in the complex case,
and just the transpose in the real case. If the matrix
fails to be positive definite (perhaps because it is not
symmetric or Hermitian), then a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> results.</p>
<p>ALGORITHM:</p>
<p>Whether or not the matrix is positive definite is checked
first in every case.  This is accomplished with an
indefinite factorization (see <a class="reference internal" href="#sage.matrix.matrix2.Matrix.indefinite_factorization" title="sage.matrix.matrix2.Matrix.indefinite_factorization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">indefinite_factorization()</span></code></a>)
which caches its result.  This algorithm is of an order <span class="math notranslate nohighlight">\(n^3/3\)</span>.
If the matrix is positive definite, this computation always
succeeds, using just field operations.  The transition to a
Cholesky decomposition “only” requires computing square roots
of the positive (real) entries of the diagonal matrix produced in
the indefinite factorization.  Hence, there is no real penalty
in the positive definite check (here, or prior to calling this
routine), but a field extension with square roots may not be
implemented in all reasonable cases.</p>
<p>EXAMPLES:</p>
<p>This simple example has a result with entries that remain
in the field of rational numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-2, 10, -2, -7],</span>
<span class="go">....:                 [ 4, -2,  8,  4],</span>
<span class="go">....:                 [ 2, -7,  4,  7]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[ 2  0  0  0]</span>
<span class="go">[-1  3  0  0]</span>
<span class="go">[ 2  0  2  0]</span>
<span class="go">[ 1 -2  1  1]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 4 by 4 dense matrices over Rational Field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This seemingly simple example requires first moving to
the rational numbers for field operations, and then square
roots necessitate that the result has entries in the field
of algebraic numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">78</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">37</span><span class="p">,</span>  <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-30, 102, 179, -18],</span>
<span class="go">....:                 [-37, 179, 326, -38],</span>
<span class="go">....:                 [ -2, -18, -38,  15]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[   8.83176086632785?                    0                    0                    0]</span>
<span class="go">[ -3.396831102433787?    9.51112708681461?                    0                    0]</span>
<span class="go">[ -4.189425026335004?   17.32383862241232?   2.886751345948129?                    0]</span>
<span class="go">[-0.2264554068289192?  -1.973397116652010?  -1.649572197684645?   2.886751345948129?]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 4 by 4 dense matrices over Algebraic Real Field</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some subfields of the complex numbers, such as this number
field of complex numbers with rational real and imaginary parts,
allow for this computation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>        <span class="mi">23</span><span class="p">,</span>  <span class="mi">17</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">24</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>     <span class="mi">21</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                [ -17*I + 3,        38, -69*I + 89, 7*I + 15],</span>
<span class="go">....:                [-24*I + 25, 69*I + 89,        976, 24*I + 6],</span>
<span class="go">....:                [     -21*I, -7*I + 15,  -24*I + 6,       28]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[                4.79...?                         0                       0        0]</span>
<span class="go">[   0.62...? - 3.54...?*I                  5.00...?                       0        0]</span>
<span class="go">[   5.21...? - 5.00...?*I   13.58...? + 10.72...?*I               24.98...?        0]</span>
<span class="go">[             -4.37...?*I   -0.10...? -  0.85...?*I  -0.21...? + 0.37...?*I 2.81...?]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 4 by 4 dense matrices over Algebraic Field</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span> <span class="o">-</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQbar</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The field of algebraic numbers is an ideal setting for this
computation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>        <span class="mi">2</span><span class="p">,</span>   <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>   <span class="mi">6</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                    [ -2*I + 4,        11, 10 - 12*I],</span>
<span class="go">....:                    [  4*I + 6, 10 + 12*I,        37]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[                       1.414213562373095?          0                    0]</span>
<span class="go">[2.828427124746190? - 1.414213562373095?*I          1                    0]</span>
<span class="go">[4.242640687119285? + 2.828427124746190?*I   -2*I + 2   1.732050807568878?]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 3 by 3 dense matrices over Algebraic Field</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">L</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span> <span class="o">-</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQbar</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Results are cached, hence immutable.  Use the <code class="docutils literal notranslate"><span class="pre">copy</span></code> function
if you need to make a change.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-2, 10, -2, -7],</span>
<span class="go">....:                 [ 4, -2,  8,  4],</span>
<span class="go">....:                 [ 2, -7,  4,  7]])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="gp">sage: </span><span class="n">LC</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">LC</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="gp">sage: </span><span class="n">LC</span>
<span class="go">[1000    0    0    0]</span>
<span class="go">[  -1    3    0    0]</span>
<span class="go">[   2    0    2    0]</span>
<span class="go">[   1   -2    1    1]</span>
</pre></div>
</div>
<p>There are a variety of situations which will prevent the computation of a Cholesky decomposition.</p>
<p>The base ring must be exact.  For numerical work, create a
matrix with a base ring of <code class="docutils literal notranslate"><span class="pre">RDF</span></code> or <code class="docutils literal notranslate"><span class="pre">CDF</span></code> and use the
<a class="reference internal" href="matrix_double_dense.html#sage.matrix.matrix_double_dense.Matrix_double_dense.cholesky" title="sage.matrix.matrix_double_dense.Matrix_double_dense.cholesky"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cholesky()</span></code></a>
method for matrices of that type.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">base ring of the matrix must be exact, not Real Field with 100 bits of precision</span>
</pre></div>
</div>
<p>The base ring may not have a fraction field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Could not see Ring of integers modulo 6 as a subring of</span>
<span class="go">the real or complex numbers</span>
</pre></div>
</div>
<p>The base field may not have elements that are comparable to zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Could not see Finite Field in a of size 5^4 as a subring</span>
<span class="go">of the real or complex numbers</span>
</pre></div>
</div>
<p>The algebraic closure of the fraction field of the base ring may not be implemented.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Could not see Ring of integers modulo 7 as a subring of</span>
<span class="go">the real or complex numbers</span>
</pre></div>
</div>
<p>The matrix may not be positive definite.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>      <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                [4 + 2*I,       8,    10*I],</span>
<span class="go">....:                [2 - 2*I,   -10*I,      -3]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix is not positive definite,</span>
<span class="go">so cannot compute Cholesky decomposition</span>
</pre></div>
</div>
<p>The matrix could be positive semi-definite, and thus
lack a Cholesky decomposition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [15, 12,  9,  12],</span>
<span class="go">....:                 [12,  9,  7,  3],</span>
<span class="go">....:                 [-3,  12,  3,  8]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[21, 27, 0, 0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">cholesky</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix is not positive definite,</span>
<span class="go">so cannot compute Cholesky decomposition</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2012-05-27)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.column_module">
<code class="descname">column_module</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.column_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the free module over the base ring spanned by the columns of
this matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">t</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">column_module</span><span class="p">()</span>
<span class="go">Vector space of degree 3 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.column_space">
<code class="descname">column_space</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.column_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector space over the base ring spanned by the columns
of this matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">column_space</span><span class="p">()</span>
<span class="go">Vector space of degree 3 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">W</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="mi">9</span><span class="p">]);</span> <span class="n">B</span>
<span class="go">[                     1.00000000000000 2.00000000000000 + 3.00000000000000*I]</span>
<span class="go">[4.00000000000000 + 5.00000000000000*I                      9.00000000000000]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">column_space</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 2 over Complex Field with 53 bits of precision</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1.00000000000000 0.000000000000000]</span>
<span class="go">[0.000000000000000  1.00000000000000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.conjugate">
<code class="descname">conjugate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.conjugate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the conjugate of self, i.e. the matrix whose entries are the
conjugates of the entries of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">[1.0 - 1.0*I         1.0]</span>
<span class="go">[        0.0      -2.0*I]</span>
</pre></div>
</div>
<p>A matrix over a not-totally-real number field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">j</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">j</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">[-j + 1      1]</span>
<span class="go">[     0   -2*j]</span>
</pre></div>
</div>
<p>There is a shortcut for the conjugate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">C</span>
<span class="go">[-j + 1      1]</span>
<span class="go">[     0   -2*j]</span>
</pre></div>
</div>
<p>There is also a shortcut for the conjugate transpose, or “Hermitian transpose”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">H</span>
<span class="go">[-j + 1      0]</span>
<span class="go">[     1   -2*j]</span>
</pre></div>
</div>
<p>Conjugates work (trivially) for matrices over rings that embed
canonically into the real numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.conjugate_transpose">
<code class="descname">conjugate_transpose</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.conjugate_transpose" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the transpose of <code class="docutils literal notranslate"><span class="pre">self</span></code> after each entry has been
converted to its complex conjugate.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is sometimes known as the “adjoint” of a matrix,
though there is substantial variation and some confusion with
the use of that term.</p>
</div>
<p>OUTPUT:</p>
<p>A matrix formed by taking the complex conjugate of every entry
of <code class="docutils literal notranslate"><span class="pre">self</span></code> and then transposing the resulting matrix.</p>
<p>Complex conjugation is implemented for many subfields
of the complex numbers.  See the examples below, or more
at <a class="reference internal" href="#sage.matrix.matrix2.Matrix.conjugate" title="sage.matrix.matrix2.Matrix.conjugate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">conjugate()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="o">-</span><span class="n">I</span><span class="p">,</span> <span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="o">-</span><span class="mi">6</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">I</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Symbolic Ring</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="go"> [   I + 2  6*I + 9]</span>
<span class="go">[-4*I + 3     -5*I]</span>

<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.95</span><span class="o">-</span><span class="mf">0.63</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mf">0.84</span><span class="o">+</span><span class="mf">0.13</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mf">0.94</span><span class="o">+</span><span class="mf">0.23</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mf">0.23</span><span class="o">+</span><span class="mf">0.59</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mf">0.52</span><span class="o">-</span><span class="mf">0.41</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.50</span><span class="o">+</span><span class="mf">0.90</span><span class="o">*</span><span class="n">I</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Complex Field with 53 bits of precision</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="go">[ 0.950... + 0.630...*I  0.940... - 0.230...*I  0.520... + 0.410...*I]</span>
<span class="go">[ 0.840... - 0.130...*I  0.230... - 0.590...*I -0.500... - 0.900...*I]</span>
</pre></div>
</div>
<p>There is also a shortcut for the conjugate transpose, or “Hermitian transpose”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">H</span>
<span class="go"> [   I + 2  6*I + 9]</span>
<span class="go">[-4*I + 3     -5*I]</span>
</pre></div>
</div>
<p>Matrices over base rings that can be embedded in the
real numbers will behave as expected.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The conjugate of a matrix is formed by taking conjugates of
all the entries.  Some specialized subfields of the complex numbers
are implemented in Sage and complex conjugation can be applied.
(Matrices over quadratic number fields are another
class of examples.)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">gen</span><span class="p">();</span> <span class="n">a</span>
<span class="go">zeta5</span>
<span class="gp">sage: </span><span class="n">CC</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.309016994374947 + 0.951056516295154*I</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">a</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="go">[             zeta5^3]</span>
<span class="go">[-zeta5^3 - zeta5 - 1]</span>
</pre></div>
</div>
<p>Furthermore, this method can be applied to matrices over
quadratic extensions of finite fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">N</span>
<span class="go">[  0   a]</span>
<span class="go">[2*a   1]</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="go">[      0   a + 2]</span>
<span class="go">[2*a + 1       1]</span>
</pre></div>
</div>
<p>Conjugation does not make sense over rings not containing complex
numbers or finite fields which are not a qadratic extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;sage.rings.finite_rings.integer_mod.IntegerMod_int&#39; object has no attribute &#39;conjugate&#39;</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<blockquote>
<div>Rob Beezer (2010-12-13)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.cyclic_subspace">
<code class="descname">cyclic_subspace</code><span class="sig-paren">(</span><em>v</em>, <em>var=None</em>, <em>basis='echelon'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.cyclic_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a cyclic subspace for a vector, and optionally,
a minimal polynomial for the iterated powers.</p>
<p>These subspaces are also known as Krylov subspaces.  They are
spanned by the vectors</p>
<div class="math notranslate nohighlight">
\[\{v, Av, A^2v, A^3v, \dots \}\]</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix with entries from a field.</li>
<li><code class="docutils literal notranslate"><span class="pre">v</span></code> - a vector with a degree equal to the size of the matrix
and entries compatible with the entries of the matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code> - if specified as a string or
a generator of a polynomial ring, then this will be used
to construct a polynomial reflecting a relation of linear
dependence on the powers <span class="math notranslate nohighlight">\(A^iv\)</span> <em>and</em> this will cause
the polynomial to be returned along with the subspace.
A generator must create polynomials with coefficients from
the same field as the matrix entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">basis</span></code> - default: <code class="docutils literal notranslate"><span class="pre">echelon</span></code> - the basis for the
subspace is “echelonized” by default, but the keyword
‘iterates’ will return a subspace with a user basis
equal to the largest linearly independent
set <span class="math notranslate nohighlight">\(\{v, Av, A^2v, A^3v, \dots, A^{k-1}v \}\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>Suppose <span class="math notranslate nohighlight">\(k\)</span> is the smallest power such that
<span class="math notranslate nohighlight">\(\{v, Av, A^2v, A^3v, \dots, A^{k}v \}\)</span> is linearly
dependent.  Then the subspace returned will have
dimension <span class="math notranslate nohighlight">\(k\)</span> and be spanned by the powers <span class="math notranslate nohighlight">\(0\)</span> through
<span class="math notranslate nohighlight">\(k-1\)</span>.</p>
<p>If a polynomial is requested through the use of the
<code class="docutils literal notranslate"><span class="pre">var</span></code> keyword, then a pair is returned, with the
polynomial first and the subspace second.  The polynomial
is the unique monic polynomial whose coefficients provide
a relation of linear dependence on the first <span class="math notranslate nohighlight">\(k\)</span> powers.</p>
<p>For less convenient, but more flexible output, see the
helper method “_cyclic_subspace” in this module.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cyclic_subspace</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">E</span>
<span class="go">Vector space of degree 4 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 0  0  1 -1]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cyclic_subspace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;iterates&#39;</span><span class="p">);</span> <span class="n">F</span>
<span class="go">Vector space of degree 4 and dimension 3 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 4  1 -1  1]</span>
<span class="go">[23  1 -8  8]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">F</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cyclic_subspace</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;T&#39;</span><span class="p">);</span> <span class="n">p</span>
<span class="go">T^3 - 9*T^2 + 24*T - 16</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The polynomial has coefficients that yield a non-trivial
relation of linear dependence on the iterates.  Or,
equivalently, evaluating the polynomial with the matrix
will create a matrix that annihilates the vector.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">37</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">104</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [ 2, 9, -1, -6, -6, 0, 7, 0, -2, 0],</span>
<span class="go">....:                 [24, 74/3, -29, -208/3, -58, -14/3, 70, 4/3, -58/3, -2/3],</span>
<span class="go">....:                 [-6, -19, 3, 21, 19, 0, -21, 0, 6, 0],</span>
<span class="go">....:                 [2, 6, -1, -6, -3, 0, 7, 0, -2, 0],</span>
<span class="go">....:                 [-96, -296/3, 128, 832/3, 232, 65/3, -279, -16/3, 232/3, 8/3],</span>
<span class="go">....:                 [0, 0, 0, 0, 0, 0, 3, 0, 0, 0],</span>
<span class="go">....:                 [20, 26/3, -30, -199/3, -42, -14/3, 70, 13/3, -55/3, -2/3],</span>
<span class="go">....:                 [18, 57, -9, -54, -57, 0, 63, 0, -15, 0],</span>
<span class="go">....:                 [0, 0, 0, 0, 0, 0, 0, 0, 0, 3]])</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">zero_vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">u</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">S</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">cyclic_subspace</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">var</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;iterates&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span>
<span class="go">Vector space of degree 10 and dimension 3 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[   1    0    0    0    0    0    0    0    0    0]</span>
<span class="go">[  15    2   24   -6    2  -96    0   20   18    0]</span>
<span class="go">[  79   12  140  -36   12 -560    0  116  108    0]</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">t^3 - 9*t^2 + 27*t - 27</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">iterates</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">A</span><span class="o">^</span><span class="n">k</span><span class="o">*</span><span class="n">u</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">iterates</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(0, 0, 0, 0, 0, 0, 0, 0, 0, 0)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="ow">in</span> <span class="n">p</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-05-20)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.decomposition">
<code class="descname">decomposition</code><span class="sig-paren">(</span><em>algorithm='spin'</em>, <em>is_diagonalizable=False</em>, <em>dual=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.decomposition" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the decomposition of the free module on which this matrix A
acts from the right (i.e., the action is x goes to x A), along with
whether this matrix acts irreducibly on each factor. The factors
are guaranteed to be sorted in the same way as the corresponding
factors of the characteristic polynomial.</p>
<p>Let A be the matrix acting from the on the vector space V of column
vectors. Assume that A is square. This function computes maximal
subspaces W_1, …, W_n corresponding to Galois conjugacy classes
of eigenvalues of A. More precisely, let <span class="math notranslate nohighlight">\(f(X)\)</span> be the characteristic
polynomial of A. This function computes the subspace
<span class="math notranslate nohighlight">\(W_i = ker(g_(A)^n)\)</span>, where <span class="math notranslate nohighlight">\(g_i(X)\)</span> is an irreducible
factor of <span class="math notranslate nohighlight">\(f(X)\)</span> and <span class="math notranslate nohighlight">\(g_i(X)\)</span> exactly divides <span class="math notranslate nohighlight">\(f(X)\)</span>. If the optional
parameter is_diagonalizable is True, then we let <span class="math notranslate nohighlight">\(W_i = ker(g(A))\)</span>,
since then we know that <span class="math notranslate nohighlight">\(ker(g(A)) = ker(g(A)^n)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - ‘spin’ (default): algorithm involves
iterating the action of self on a vector. ‘kernel’: naively just
compute <span class="math notranslate nohighlight">\(ker(f_i(A))\)</span> for each factor <span class="math notranslate nohighlight">\(f_i\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">dual</span></code> - bool (default: False): If True, also
returns the corresponding decomposition of V under the action of
the transpose of A. The factors are guaranteed to correspond.</li>
<li><code class="docutils literal notranslate"><span class="pre">is_diagonalizable</span></code> - if the matrix is known to
be diagonalizable, set this to True, which might speed up the
algorithm in some cases.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the base ring is not a field, the kernel algorithm is
used.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Sequence</span></code> - list of pairs (V,t), where V is a vector
spaces and t is a bool, and t is True exactly when the
charpoly of self on V is irreducible.</li>
<li>(optional) list - list of pairs (W,t), where W is a vector
space and t is a bool, and t is True exactly when the
charpoly of the transpose of self on W is irreducible.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">*</span><span class="mi">11</span>
<span class="go">[  0  11  22  33  44  55]</span>
<span class="go">[ 66  77  88  99 110 121]</span>
<span class="go">[132 143 154 165 176 187]</span>
<span class="go">[198 209 220 231 242 253]</span>
<span class="go">[264 275 286 297 308 319]</span>
<span class="go">[330 341 352 363 374 385]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(Ambient free module of rank 4 over the principal ideal domain Integer Ring, True)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(Vector space of degree 6 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1 -2 -3 -4]</span>
<span class="go">[ 0  1  2  3  4  5], True),</span>
<span class="go">(Vector space of degree 6 and dimension 4 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0  0  0 -5  4]</span>
<span class="go">[ 0  1  0  0 -4  3]</span>
<span class="go">[ 0  0  1  0 -3  2]</span>
<span class="go">[ 0  0  0  1 -2  1], False)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.decomposition_of_subspace">
<code class="descname">decomposition_of_subspace</code><span class="sig-paren">(</span><em>M</em>, <em>check_restrict=True</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.decomposition_of_subspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Suppose the right action of self on M leaves M invariant. Return
the decomposition of M as a list of pairs (W, is_irred) where
is_irred is True if the charpoly of self acting on the factor W is
irreducible.</p>
<p>Additional inputs besides M are passed onto the decomposition
command.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math notranslate nohighlight">\(M\)</span>                – A subspace of the free module <code class="docutils literal notranslate"><span class="pre">self</span></code> acts on.</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">check_restrict</span></code> – A boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); Call restrict</dt>
<dd>with or without check.</dd>
</dl>
</li>
<li><code class="docutils literal notranslate"><span class="pre">kwds</span></code>           – Keywords that will be forwarded to <a class="reference internal" href="#sage.matrix.matrix2.Matrix.decomposition" title="sage.matrix.matrix2.Matrix.decomposition"><code class="xref py py-meth docutils literal notranslate"><span class="pre">decomposition()</span></code></a>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">t</span>
<span class="go">[ 3  0 -2]</span>
<span class="go">[ 0 -2  0]</span>
<span class="go">[ 0  0  0]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">fcp</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>   <span class="c1"># factored charpoly</span>
<span class="go">(X - 3) * X * (X + 2)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">kernel</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">2</span><span class="p">));</span> <span class="n">v</span>   <span class="c1"># an invariant subspace</span>
<span class="go">Vector space of degree 3 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">decomposition_of_subspace</span><span class="p">(</span><span class="n">v</span><span class="p">);</span> <span class="n">D</span>
<span class="go">[</span>
<span class="go">(Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[0 0 1], True),</span>
<span class="go">(Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[0 1 0], True)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[-2]</span>
</pre></div>
</div>
<p>We do a decomposition over ZZ:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">6</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">decomposition_of_subspace</span><span class="p">(</span><span class="n">ZZ</span><span class="o">^</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(Free module of degree 6 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0  1 -1  1 -1]</span>
<span class="go">[ 0  1  0 -1  2 -1], False),</span>
<span class="go">(Free module of degree 6 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0 -1  0  1  0]</span>
<span class="go">[ 0  1  0  0  0  0]</span>
<span class="go">[ 0  0  0  1  0  0]</span>
<span class="go">[ 0  0  0  0  0  1], False)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.denominator">
<code class="descname">denominator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the least common multiple of the denominators of the
elements of self.</p>
<p>If there is no denominator function for the base field, or no LCM
function for the denominators, raise a TypeError.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">210</span>
</pre></div>
</div>
<p>A trivial example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Denominators are not defined for real numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">RealField</span><span class="p">(),</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">denominator not defined for elements of the base ring</span>
</pre></div>
</div>
<p>We can even compute the denominator of matrix over the fraction
field of <span class="math notranslate nohighlight">\(\ZZ[x]\)</span>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Frac</span><span class="p">(</span><span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">x^4 + x^3</span>
</pre></div>
</div>
<p>Here’s an example involving a cyclotomic field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([(</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,(</span><span class="mi">2</span><span class="o">+</span><span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="n">z</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">z</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[1/3*z + 1/3 1/3*z + 2/3       1/3*z]</span>
<span class="go">[          1       z + 1          -2]</span>
<span class="go">[          1           5       z - 1]</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">denominator</span><span class="p">())</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.density">
<code class="descname">density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.density" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the density of the matrix.</p>
<p>By density we understand the ratio of the number of nonzero
positions and the self.nrows() * self.ncols(), i.e. the number of
possible nonzero positions.</p>
<p>EXAMPLES:</p>
<p>First, note that the density parameter does not ensure the density
of a matrix, it is only an upper bound.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">127</span><span class="p">),</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="n">density</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">5211/20000</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">2/3</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[],[],[],[]])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">density</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.derivative">
<code class="descname">derivative</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Derivative with respect to variables supplied in args.</p>
<p>Multiple variables and iteration counts may be supplied; see
documentation for the global derivative() function for more
details.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(0, 1, 2*x)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">(0, 1, 2*x)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="go">(0, 0, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.det">
<code class="descname">det</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.det" title="Permalink to this definition">¶</a></dt>
<dd><p>Synonym for self.determinant(…).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.determinant">
<code class="descname">determinant</code><span class="sig-paren">(</span><em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.determinant" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the determinant of self.</p>
<p>ALGORITHM:</p>
<p>If the base ring has a method <code class="xref py py-meth docutils literal notranslate"><span class="pre">_matrix_determinant()</span></code>, we call it.</p>
<p>Otherwise, for small matrices (n less than 4), this is computed using the 
naive formula. In the specific case of matrices over the integers modulo a
non-prime, the determinant of a lift is computed over the integers.
In general, the characteristic polynomial is computed either using
the Hessenberg form (specified by <code class="docutils literal notranslate"><span class="pre">&quot;hessenberg&quot;</span></code>) or the generic
division-free algorithm (specified by <code class="docutils literal notranslate"><span class="pre">&quot;df&quot;</span></code>).  When the base ring
is an exact field, the default choice is <code class="docutils literal notranslate"><span class="pre">&quot;hessenberg&quot;</span></code>, otherwise
it is <code class="docutils literal notranslate"><span class="pre">&quot;df&quot;</span></code>.  Note that for matrices over most rings, more
sophisticated algorithms can be used. (Type <code class="docutils literal notranslate"><span class="pre">A.determinant?</span></code> to
see what is done for a specific matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string:</dt>
<dd><ul class="first last">
<li><code class="docutils literal notranslate"><span class="pre">&quot;df&quot;</span></code> - Generic O(n^4) division-free algorithm</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;hessenberg&quot;</span></code> - Use the Hessenberg form of the matrix</li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">3</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="ow">is</span> <span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<p>We compute the determinant of the arbitrary 3x3 matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[x0 x1 x2]</span>
<span class="go">[x3 x4 x5]</span>
<span class="go">[x6 x7 x8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-x2*x4*x6 + x1*x5*x6 + x2*x3*x7 - x0*x5*x7 - x1*x3*x8 + x0*x4*x8</span>
</pre></div>
</div>
<p>We create a matrix over <span class="math notranslate nohighlight">\(\ZZ[x,y]\)</span> and compute its
determinant.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">)([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">-x^2*y + x*y^2</span>
</pre></div>
</div>
<p>A matrix over a non-domain:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<blockquote>
<div><ul class="simple">
<li>Unknown: No author specified in the file from 2009-06-25</li>
<li>Sebastian Pancratz (2009-06-25): Use the division-free
algorithm for charpoly</li>
<li>Thierry Monteil (2010-10-05): Bugfix for <a class="reference external" href="https://trac.sagemath.org/10063">trac ticket #10063</a>,
so that the determinant is computed even for rings for which
the is_field method is not implemented.</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.diagonal">
<code class="descname">diagonal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.diagonal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the diagonal entries of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>A list containing the entries of the matrix that
have equal row and column indices, in order of the
indices.  Behavior is not limited to square matrices.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">]]);</span> <span class="n">A</span>
<span class="go">[2 5]</span>
<span class="go">[3 7]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>
<span class="go">[2, 7]</span>
</pre></div>
</div>
<p>Two rectangular matrices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">21</span><span class="p">));</span> <span class="n">B</span>
<span class="go">[ 0  1  2  3  4  5  6]</span>
<span class="go">[ 7  8  9 10 11 12 13]</span>
<span class="go">[14 15 16 17 18 19 20]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>
<span class="go">[0, 8, 16]</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">));</span> <span class="n">C</span>
<span class="go">[0 1]</span>
<span class="go">[2 3]</span>
<span class="go">[4 5]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>
<span class="go">[0, 3]</span>
</pre></div>
</div>
<p>Empty matrices behave properly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">[]);</span> <span class="n">E</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">diagonal</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.echelon_form">
<code class="descname">echelon_form</code><span class="sig-paren">(</span><em>algorithm='default'</em>, <em>cutoff=0</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.echelon_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the echelon form of self.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This row reduction does not use division if the
matrix is not over a field (e.g., if the matrix is over
the integers).  If you want to calculate the echelon form
using division, then use <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rref" title="sage.matrix.matrix2.Matrix.rref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rref()</span></code></a>, which assumes that
the matrix entries are in a field (specifically, the field
of fractions of the base ring of the matrix).</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string. Which algorithm to use. Choices are<ul>
<li><code class="docutils literal notranslate"><span class="pre">'default'</span></code>: Let Sage choose an algorithm (default).</li>
<li><code class="docutils literal notranslate"><span class="pre">'classical'</span></code>: Gauss elimination.</li>
<li><code class="docutils literal notranslate"><span class="pre">'partial_pivoting'</span></code>: Gauss elimination, using partial pivoting
(if base ring has absolute value)</li>
<li><code class="docutils literal notranslate"><span class="pre">'scaled_partial_pivoting'</span></code>: Gauss elimination, using scaled
partial pivoting (if base ring has absolute value)</li>
<li><code class="docutils literal notranslate"><span class="pre">'strassen'</span></code>: use a Strassen divide and conquer
algorithm (if available)</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">cutoff</span></code> – integer. Only used if the Strassen algorithm is selected.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – boolean. Whether to also return the
transformation matrix. Some matrix backends do not provide
this information, in which case this option is ignored.</li>
</ul>
<p>OUTPUT:</p>
<p>The reduced row echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code>, as an immutable
matrix. Note that self is <em>not</em> changed by this command. Use
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.echelonize" title="sage.matrix.matrix2.Matrix.echelonize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">echelonize()</span></code></a> to change <code class="docutils literal notranslate"><span class="pre">self</span></code> in place.</p>
<p>If the optional parameter <code class="docutils literal notranslate"><span class="pre">transformation=True</span></code> is
specified, the output consists of a pair <span class="math notranslate nohighlight">\((E,T)\)</span> of matrices
where <span class="math notranslate nohighlight">\(E\)</span> is the echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <span class="math notranslate nohighlight">\(T\)</span> is the
transformation matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MS</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">MS</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1  2]</span>
</pre></div>
</div>
<p>The matrix library used for <span class="math notranslate nohighlight">\(\ZZ/p\)</span>-matrices does not return
the transformation matrix, so the <code class="docutils literal notranslate"><span class="pre">transformation</span></code> option is
ignored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[ 1  0 18]</span>
<span class="go">[ 0  1  2]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[1 2 3]  [ 1  0]</span>
<span class="go">[0 3 6], [ 4 -1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">*</span><span class="n">D</span> <span class="o">==</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.echelonize">
<code class="descname">echelonize</code><span class="sig-paren">(</span><em>algorithm='default'</em>, <em>cutoff=0</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.echelonize" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform <code class="docutils literal notranslate"><span class="pre">self</span></code> into a matrix in echelon form over the same
base ring as self.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This row reduction does not use division if the
matrix is not over a field (e.g., if the matrix is over
the integers).  If you want to calculate the echelon form
using division, then use <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rref" title="sage.matrix.matrix2.Matrix.rref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rref()</span></code></a>, which assumes that
the matrix entries are in a field (specifically, the field
of fractions of the base ring of the matrix).</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string. Which algorithm to use. Choices are<ul>
<li><code class="docutils literal notranslate"><span class="pre">'default'</span></code>: Let Sage choose an algorithm (default).</li>
<li><code class="docutils literal notranslate"><span class="pre">'classical'</span></code>: Gauss elimination.</li>
<li><code class="docutils literal notranslate"><span class="pre">'partial_pivoting'</span></code>: Gauss elimination, using partial pivoting
(if base ring has absolute value)</li>
<li><code class="docutils literal notranslate"><span class="pre">'scaled_partial_pivoting'</span></code>: Gauss elimination, using scaled
partial pivoting (if base ring has absolute value)</li>
<li><code class="docutils literal notranslate"><span class="pre">'strassen'</span></code>: use a Strassen divide and conquer
algorithm (if available)</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">cutoff</span></code> – integer. Only used if the Strassen algorithm
is selected.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – boolean. Whether to also return the
transformation matrix. Some matrix backends do not provide
this information, in which case this option is ignored.</li>
</ul>
<p>OUTPUT:</p>
<p>The matrix <code class="docutils literal notranslate"><span class="pre">self</span></code> is put into echelon form. Nothing is
returned unless the keyword option <code class="docutils literal notranslate"><span class="pre">transformation=True</span></code> is
specified, in which case the transformation matrix is
returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelonize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
<p>An immutable matrix cannot be transformed into echelon form. Use
<code class="docutils literal notranslate"><span class="pre">self.echelon_form()</span></code> instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelonize</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix is immutable; please change a copy instead</span>
<span class="go">(i.e., use copy(M) to change a copy of M).</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
<p>Echelon form over the integers is what is also classically often
known as Hermite normal form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelonize</span><span class="p">();</span> <span class="n">a</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
<p>We compute an echelon form both over a domain and fraction field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>               <span class="c1"># not very useful? -- why two copies of the same row?</span>
<span class="go">[x y]</span>
<span class="go">[x y]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>               <span class="c1"># potentially useful</span>
<span class="go">[  1 y/x]</span>
<span class="go">[  0   0]</span>
</pre></div>
</div>
<p>We check that the echelon form works for matrices over p-adics.
See <a class="reference external" href="https://trac.sagemath.org/17272">trac ticket #17272</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">print_mode</span><span class="o">=</span><span class="s1">&#39;val-unit&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">250</span><span class="p">,</span><span class="mi">2369</span><span class="p">,</span><span class="mi">1147</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span><span class="mi">927</span><span class="p">,</span><span class="mi">362</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">398</span><span class="p">,</span><span class="mi">2483</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[5^3 * 2 + O(5^5)    2369 + O(5^5)    1147 + O(5^5)]</span>
<span class="go">[    106 + O(5^5)     927 + O(5^5)     362 + O(5^5)]</span>
<span class="go">[ 5 * 18 + O(5^5)     398 + O(5^5)    2483 + O(5^5)]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">augment</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="n">K</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[      1 + O(5^5)           O(5^5)           O(5^5) 5 * 212 + O(5^5)    3031 + O(5^5)    2201 + O(5^5)]</span>
<span class="go">[          O(5^5)       1 + O(5^5)           O(5^5)    1348 + O(5^5) 5 * 306 + O(5^5)    2648 + O(5^5)]</span>
<span class="go">[          O(5^5)           O(5^5)       1 + O(5^5)    1987 + O(5^5) 5 * 263 + O(5^5)     154 + O(5^5)]</span>
</pre></div>
</div>
<p>Echelon form is not defined over arbitrary rings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">9</span><span class="p">),</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Echelon form not implemented over &#39;Ring of integers modulo 9&#39;.</span>
</pre></div>
</div>
<p>Involving a sparse matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">m</span>
<span class="go">[1 1 1]</span>
<span class="go">[1 0 2]</span>
<span class="go">[1 2 0]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 1  0  2]</span>
<span class="go">[ 0  1 -1]</span>
<span class="go">[ 0  0  0]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">echelonize</span><span class="p">();</span> <span class="n">m</span>
<span class="go">[ 1  0  2]</span>
<span class="go">[ 0  1 -1]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
<p>The transformation matrix is optionally returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m_original</span> <span class="o">=</span> <span class="n">m</span>
<span class="gp">sage: </span><span class="n">transformation_matrix</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">echelonize</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">==</span> <span class="n">transformation_matrix</span> <span class="o">*</span> <span class="n">m_original</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenmatrix_left">
<code class="descname">eigenmatrix_left</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenmatrix_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrices D and P, where D is a diagonal matrix of
eigenvalues and P is the corresponding matrix where the rows are
corresponding eigenvectors (or zero vectors) so that P*self =
D*P.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[                  0                   0                   0]</span>
<span class="go">[                  0 -1.348469228349535?                   0]</span>
<span class="go">[                  0                   0  13.34846922834954?]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[                   1                   -2                    1]</span>
<span class="go">[                   1  0.3101020514433644? -0.3797958971132713?]</span>
<span class="go">[                   1   1.289897948556636?   1.579795897113272?]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Because P is invertible, A is diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="p">(</span><span class="o">~</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The matrix P may contain zero rows corresponding to eigenvalues for
which the algebraic multiplicity is greater than the geometric
multiplicity. In these cases, the matrix is not diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[2 1 0]</span>
<span class="go">[0 2 1]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenmatrix_right">
<code class="descname">eigenmatrix_right</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenmatrix_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrices D and P, where D is a diagonal matrix of
eigenvalues and P is the corresponding matrix where the columns are
corresponding eigenvectors (or zero vectors) so that self*P =
P*D.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[                  0                   0                   0]</span>
<span class="go">[                  0 -1.348469228349535?                   0]</span>
<span class="go">[                  0                   0  13.34846922834954?]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[                   1                    1                    1]</span>
<span class="go">[                  -2  0.1303061543300932?   3.069693845669907?]</span>
<span class="go">[                   1 -0.7393876913398137?   5.139387691339814?]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Because P is invertible, A is diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="o">~</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The matrix P may contain zero columns corresponding to eigenvalues
for which the algebraic multiplicity is greater than the geometric
multiplicity. In these cases, the matrix is not diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[2 1 0]</span>
<span class="go">[0 2 1]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenspaces_left">
<code class="descname">eigenspaces_left</code><span class="sig-paren">(</span><em>format='all'</em>, <em>var='a'</em>, <em>algebraic_multiplicity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenspaces_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the left eigenspaces of a matrix.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">eigenspaces_left()</span></code> and <code class="docutils literal notranslate"><span class="pre">left_eigenspaces()</span></code>
are identical methods.  Here “left” refers to the eigenvectors
being placed to the left of the matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix over an exact field.  For inexact
matrices consult the numerical or symbolic matrix classes.</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">'all'</span></code> - attempts to create every eigenspace.  This will
always be possible for matrices with rational entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">'galois'</span></code> - for each irreducible factor of the characteristic
polynomial, a single eigenspace will be output for a
single root/eigenvalue for the irreducible factor.</li>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> - Uses the ‘all’ format if the base ring is contained
in an algebraically closed field which is implemented.
Otherwise, uses the ‘galois’ format.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - default: ‘a’ - variable name used to
represent elements of the root field of each
irreducible factor of the characteristic polynomial.
If var=’a’, then the root fields will be in terms of
a0, a1, a2, …., where the numbering runs across all
the irreducible factors of the characteristic polynomial,
even for linear factors.</li>
<li><code class="docutils literal notranslate"><span class="pre">algebraic_multiplicity</span></code> - default: False - whether or
not to include the algebraic multiplicity of each eigenvalue
in the output.  See the discussion below.</li>
</ul>
<p>OUTPUT:</p>
<p>If algebraic_multiplicity=False, return a list of pairs (e, V)
where e is an eigenvalue of the matrix, and V is the corresponding
left eigenspace.  For Galois conjugates of eigenvalues, there
may be just one representative eigenspace, depending on the
<code class="docutils literal notranslate"><span class="pre">format</span></code> keyword.</p>
<p>If algebraic_multiplicity=True, return a list of triples (e, V, n)
where e and V are as above and n is the algebraic multiplicity of
the eigenvalue.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Uses a somewhat naive algorithm (simply factors the
characteristic polynomial and computes kernels directly
over the extension field).</p>
</div>
<p>EXAMPLES:</p>
<p>We compute the left eigenspaces of a <span class="math notranslate nohighlight">\(3\times 3\)</span>
rational matrix. First, we request <span class="math notranslate nohighlight">\(all\)</span> of the eigenvalues,
so the results are in the field of algebraic numbers, <span class="math notranslate nohighlight">\(QQbar\)</span>.
Then we request just one eigenspace per irreducible factor of
the characteristic polynomial with the <span class="math notranslate nohighlight">\(galois\)</span> keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(-1.348469228349535?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   1  0.3101020514433644? -0.3797958971132713?]),</span>
<span class="go">(13.34846922834954?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                 1 1.289897948556636? 1.579795897113272?])</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1], 1),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5], 1)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">v</span><span class="o">*</span><span class="n">A</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same computation, but with implicit base change to a field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>We compute the left eigenspaces of the matrix of the Hecke operator
<span class="math notranslate nohighlight">\(T_2\)</span> on level 43 modular symbols, both with all eigenvalues (the default)
and with one subspace per factor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[ 3  0  0  0  0  0 -1]</span>
<span class="go">[ 0 -2  1  0  0  0  0]</span>
<span class="go">[ 0 -1  1  1  0 -1  0]</span>
<span class="go">[ 0 -1  0 -1  2 -1  1]</span>
<span class="go">[ 0 -1  0  1  1 -1  1]</span>
<span class="go">[ 0  0 -2  0  2 -2  1]</span>
<span class="go">[ 0  0 -1  0  1  0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^7 + x^6 - 12*x^5 - 16*x^4 + 36*x^3 + 52*x^2 - 32*x - 48</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">(x - 3) * (x + 2)^2 * (x^2 - 2)^2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(3, Vector space of degree 7 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[   1    0  1/7    0 -1/7    0 -2/7], 1),</span>
<span class="go">(-2, Vector space of degree 7 and dimension 2 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 0  1  0  1 -1  1 -1]</span>
<span class="go">[ 0  0  1  0 -1  2 -1], 2),</span>
<span class="go">(-1.414213562373095?, Vector space of degree 7 and dimension 2 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                  0                   1                   0                  -1 0.4142135623730951?                   1                  -1]</span>
<span class="go">[                  0                   0                   1                   0                  -1                   0  2.414213562373095?], 2),</span>
<span class="go">(1.414213562373095?, Vector space of degree 7 and dimension 2 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   0                    1                    0                   -1  -2.414213562373095?                    1                   -1]</span>
<span class="go">[                   0                    0                    1                    0                   -1                    0 -0.4142135623730951?], 2)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(3, Vector space of degree 7 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[   1    0  1/7    0 -1/7    0 -2/7], 1),</span>
<span class="go">(-2, Vector space of degree 7 and dimension 2 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 0  1  0  1 -1  1 -1]</span>
<span class="go">[ 0  0  1  0 -1  2 -1], 2),</span>
<span class="go">(a2, Vector space of degree 7 and dimension 2 over Number Field in a2 with defining polynomial x^2 - 2</span>
<span class="go">User basis matrix:</span>
<span class="go">[      0       1       0      -1 -a2 - 1       1      -1]</span>
<span class="go">[      0       0       1       0      -1       0 -a2 + 1], 2)</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Next we compute the left eigenspaces over the finite field of order 11.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[ 3  9  0  0]</span>
<span class="go">[ 0  9  0  1]</span>
<span class="go">[ 0 10  9  2]</span>
<span class="go">[ 0  9  0  2]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field of size 11</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^4 + 10*x^3 + 3*x^2 + 2*x + 1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(9, Vector space of degree 4 and dimension 1 over Finite Field of size 11</span>
<span class="go">User basis matrix:</span>
<span class="go">[0 0 1 5]),</span>
<span class="go">(3, Vector space of degree 4 and dimension 1 over Finite Field of size 11</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 6 0 6]),</span>
<span class="go">(beta2, Vector space of degree 4 and dimension 1 over Univariate Quotient Polynomial Ring in beta2 over Finite Field of size 11 with modulus x^2 + 9</span>
<span class="go">User basis matrix:</span>
<span class="go">[           0            1            0 5*beta2 + 10])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This method is only applicable to exact matrices.
The “eigenmatrix” routines for matrices with double-precision
floating-point entries (<code class="docutils literal notranslate"><span class="pre">RDF</span></code>, <code class="docutils literal notranslate"><span class="pre">CDF</span></code>) are the best
alternative.  (Since some platforms return eigenvectors
that are the negatives of those given here, this one example
is not tested here.)  There are also “eigenmatrix” routines for
matrices with symbolic entries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">eigenspaces cannot be computed reliably for inexact rings such as Real Field with 53 bits of precision,</span>
<span class="go">consult numerical or symbolic matrix classes for other options</span>

<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span> <span class="c1"># abs tol 1e-13</span>
<span class="go">[13.348469228349522                0.0                 0.0]</span>
<span class="go">[               0.0 -1.348469228349534                 0.0]</span>
<span class="go">[               0.0                0.0                 0.0]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span> <span class="c1"># not tested</span>
<span class="go">[ 0.440242867...  0.567868371...  0.695493875...]</span>
<span class="go">[ 0.897878732...  0.278434036... -0.341010658...]</span>
<span class="go">[ 0.408248290... -0.816496580...  0.408248290...]</span>

<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span>
<span class="go">[3/2*x^2 + 1/2*x - 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)                                                       0]</span>
<span class="go">[                                                      0 3/2*x^2 + 1/2*x + 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span>
<span class="go">[                                                    1 1/2*(3*x^2 - x - sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
<span class="go">[                                                    1 1/2*(3*x^2 - x + sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
</pre></div>
</div>
<p>A request for <code class="docutils literal notranslate"><span class="pre">'all'</span></code> the eigenvalues, when it is not
possible, will raise an error.  Using the <code class="docutils literal notranslate"><span class="pre">'galois'</span></code>
format option is more likely to be successful.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">unable to construct eigenspaces for eigenvalues outside the base field,</span>
<span class="go">try the keyword option: format=&#39;galois&#39;</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(a0, Vector space of degree 2 and dimension 1 over Univariate Quotient Polynomial Ring in a0 over Finite Field in b of size 11^2 with modulus x^2 + (5*b + 6)*x + 8*b + 10</span>
<span class="go">User basis matrix:</span>
<span class="go">[               1 6*b*a0 + 3*b + 1])</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenspaces_right">
<code class="descname">eigenspaces_right</code><span class="sig-paren">(</span><em>format='all'</em>, <em>var='a'</em>, <em>algebraic_multiplicity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenspaces_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the right eigenspaces of a matrix.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">eigenspaces_right()</span></code> and <code class="docutils literal notranslate"><span class="pre">right_eigenspaces()</span></code>
are identical methods.  Here “right” refers to the eigenvectors
being placed to the right of the matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix over an exact field.  For inexact
matrices consult the numerical or symbolic matrix classes.</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">'all'</span></code> - attempts to create every eigenspace.  This will
always be possible for matrices with rational entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">'galois'</span></code> - for each irreducible factor of the characteristic
polynomial, a single eigenspace will be output for a
single root/eigenvalue for the irreducible factor.</li>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> - Uses the ‘all’ format if the base ring is contained
in an algebraically closed field which is implemented.
Otherwise, uses the ‘galois’ format.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - default: ‘a’ - variable name used to
represent elements of the root field of each
irreducible factor of the characteristic polynomial.
If var=’a’, then the root fields will be in terms of
a0, a1, a2, …., where the numbering runs across all
the irreducible factors of the characteristic polynomial,
even for linear factors.</li>
<li><code class="docutils literal notranslate"><span class="pre">algebraic_multiplicity</span></code> - default: False - whether or
not to include the algebraic multiplicity of each eigenvalue
in the output.  See the discussion below.</li>
</ul>
<p>OUTPUT:</p>
<p>If algebraic_multiplicity=False, return a list of pairs (e, V)
where e is an eigenvalue of the matrix, and V is the corresponding
left eigenspace.  For Galois conjugates of eigenvalues, there
may be just one representative eigenspace, depending on the
<code class="docutils literal notranslate"><span class="pre">format</span></code> keyword.</p>
<p>If algebraic_multiplicity=True, return a list of triples (e, V, n)
where e and V are as above and n is the algebraic multiplicity of
the eigenvalue.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Uses a somewhat naive algorithm (simply factors the
characteristic polynomial and computes kernels directly
over the extension field).</p>
</div>
<p>EXAMPLES:</p>
<p>Right eigenspaces are computed from the left eigenspaces of the
transpose of the matrix.  As such, there is a greater collection
of illustrative examples at the <a class="reference internal" href="#sage.matrix.matrix2.Matrix.eigenspaces_left" title="sage.matrix.matrix2.Matrix.eigenspaces_left"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eigenspaces_left()</span></code></a>.</p>
<p>We compute the right eigenspaces of a <span class="math notranslate nohighlight">\(3\times 3\)</span> rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(-1.348469228349535?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   1  0.1303061543300932? -0.7393876913398137?]),</span>
<span class="go">(13.34846922834954?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                 1 3.069693845669907? 5.139387691339814?])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1], 1),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5], 1)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">v</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">v</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same computation, but with implicit base change to a field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This method is only applicable to exact matrices.
The “eigenmatrix” routines for matrices with double-precision
floating-point entries (<code class="docutils literal notranslate"><span class="pre">RDF</span></code>, <code class="docutils literal notranslate"><span class="pre">CDF</span></code>) are the best
alternative.  (Since some platforms return eigenvectors
that are the negatives of those given here, this one example
is not tested here.)  There are also “eigenmatrix” routines for
matrices with symbolic entries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">eigenspaces cannot be computed reliably for inexact rings such as Real Field with 53 bits of precision,</span>
<span class="go">consult numerical or symbolic matrix classes for other options</span>

<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span> <span class="c1"># abs tol 1e-13</span>
<span class="go">[13.348469228349522                0.0                0.0]</span>
<span class="go">[               0.0 -1.348469228349534                0.0]</span>
<span class="go">[               0.0                0.0                0.0]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span> <span class="c1"># not tested</span>
<span class="go">[ 0.164763817...  0.799699663...  0.408248290...]</span>
<span class="go">[ 0.505774475...  0.104205787... -0.816496580...]</span>
<span class="go">[ 0.846785134... -0.591288087...  0.408248290...]</span>

<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span>
<span class="go">[3/2*x^2 + 1/2*x - 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)                                                       0]</span>
<span class="go">[                                                      0 3/2*x^2 + 1/2*x + 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span>
<span class="go">[                                                    1                                                     1]</span>
<span class="go">[1/2*(3*x^2 - x - sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y 1/2*(3*x^2 - x + sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenvalue_multiplicity">
<code class="descname">eigenvalue_multiplicity</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenvalue_multiplicity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the multiplicity of <code class="docutils literal notranslate"><span class="pre">s</span></code> as a generalized eigenvalue
of the matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalue_multiplicity</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalue_multiplicity</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">posets</span><span class="o">.</span><span class="n">DiamondPoset</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">coxeter_transformation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalue_multiplicity</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="go">[3, 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenvalues">
<code class="descname">eigenvalues</code><span class="sig-paren">(</span><em>extend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sequence of the eigenvalues of a matrix, with
multiplicity. If the eigenvalues are roots of polynomials in QQ,
then QQbar elements are returned that represent each separate
root.</p>
<p>If the option extend is set to False, only eigenvalues in the base
ring are considered.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[ 0  1  2  3]</span>
<span class="go">[ 4  5  6  7]</span>
<span class="go">[ 8  9 10 11]</span>
<span class="go">[12 13 14 15]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[32.46424919657298?, 0, 0, -2.464249196572981?]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">[-0.9386318578049146?, 15.50655435353258?, 0.2160387521361705? - 4.713151979747493?*I, 0.2160387521361705? + 4.713151979747493?*I]</span>
</pre></div>
</div>
<p>A symmetric matrix a+a.transpose() should have real eigenvalues</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span><span class="o">=</span><span class="n">a</span><span class="o">+</span><span class="n">a</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ev</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">();</span> <span class="n">ev</span>
<span class="go">[-8.35066086057957?, -1.107247901349379?, 5.718651326708515?, 33.73925743522043?]</span>
</pre></div>
</div>
<p>The eigenvalues are elements of QQbar, so they really represent
exact roots of polynomials, not just approximations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">e</span>
<span class="go">-8.35066086057957?</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">minpoly</span><span class="p">();</span> <span class="n">p</span>
<span class="go">x^4 - 30*x^3 - 171*x^2 + 1460*x + 1784</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>To perform computations on the eigenvalue as an element of a number
field, you can always convert back to a number field element.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">as_number_field_element</span><span class="p">()</span>
<span class="go">(Number Field in a with defining polynomial y^4 - 2*y^3 - 507*y^2 - 3972*y - 4264,</span>
<span class="go">a + 7,</span>
<span class="go">Ring morphism:</span>
<span class="go">  From: Number Field in a with defining polynomial y^4 - 2*y^3 - 507*y^2 - 3972*y - 4264</span>
<span class="go">  To:   Algebraic Real Field</span>
<span class="go">  Defn: a |--&gt; -15.35066086057957?)</span>
</pre></div>
</div>
<p>Notice the effect of the extend option.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">[2, -1*I, 1*I]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[2]</span>
</pre></div>
</div>
<p>The method also works for matrices over finite fields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">ev</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">());</span> <span class="n">ev</span>
<span class="go">[2*z3, 2*z3 + 1, 2*z3 + 2]</span>
</pre></div>
</div>
<p>Similarly as in the case of QQbar, the eigenvalues belong to some
algebraic closure but they can be converted to elements of a finite
field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">ev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Algebraic closure of Finite Field of size 3</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">as_finite_field_element</span><span class="p">()</span>
<span class="go">(Finite Field in z3 of size 3^3, 2*z3, Ring morphism:</span>
<span class="go">  From: Finite Field in z3 of size 3^3</span>
<span class="go">  To:   Algebraic closure of Finite Field of size 3</span>
<span class="go">  Defn: z3 |--&gt; z3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenvectors_left">
<code class="descname">eigenvectors_left</code><span class="sig-paren">(</span><em>extend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenvectors_left" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the left eigenvectors of a matrix.</p>
<p>For each distinct eigenvalue, returns a list of the form (e,V,n)
where e is the eigenvalue, V is a list of eigenvectors forming a
basis for the corresponding left eigenspace, and n is the algebraic
multiplicity of the eigenvalue.</p>
<p>If the option extend is set to False, then only the eigenvalues that
live in the base ring are considered.</p>
<p>EXAMPLES: We compute the left eigenvectors of a <span class="math notranslate nohighlight">\(3\times 3\)</span>
rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">();</span> <span class="n">es</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1),</span>
<span class="go">(-1.348469228349535?, [(1, 0.3101020514433644?, -0.3797958971132713?)], 1),</span>
<span class="go">(13.34846922834954?, [(1, 1.289897948556636?, 1.579795897113272?)], 1)]</span>
<span class="gp">sage: </span><span class="nb">eval</span><span class="p">,</span> <span class="p">[</span><span class="n">evec</span><span class="p">],</span> <span class="n">mult</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="nb">eval</span><span class="o">*</span><span class="n">evec</span> <span class="o">-</span> <span class="n">evec</span><span class="o">*</span><span class="n">A</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Notice the difference between considering ring extensions or not.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">()</span>
<span class="go">[(2, [</span>
<span class="go">(0, 0, 1)</span>
<span class="go">], 1), (-1*I, [(1, -1*I, 0)], 1), (1*I, [(1, 1*I, 0)], 1)]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(2, [</span>
<span class="go">(0, 0, 1)</span>
<span class="go">], 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.eigenvectors_right">
<code class="descname">eigenvectors_right</code><span class="sig-paren">(</span><em>extend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.eigenvectors_right" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the right eigenvectors of a matrix.</p>
<p>For each distinct eigenvalue, returns a list of the form (e,V,n)
where e is the eigenvalue, V is a list of eigenvectors forming a
basis for the corresponding right eigenspace, and n is the
algebraic multiplicity of the eigenvalue. If <code class="docutils literal notranslate"><span class="pre">extend</span> <span class="pre">=</span> <span class="pre">True</span></code>
(the default), this will return eigenspaces over the algebraic
closure of the base field where this is implemented; otherwise
it will restrict to eigenvalues in the base field.</p>
<p>EXAMPLES: We compute the right eigenvectors of a
<span class="math notranslate nohighlight">\(3\times 3\)</span> rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_right</span><span class="p">();</span> <span class="n">es</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1),</span>
<span class="go">(-1.348469228349535?, [(1, 0.1303061543300932?, -0.7393876913398137?)], 1),</span>
<span class="go">(13.34846922834954?, [(1, 3.069693845669907?, 5.139387691339814?)], 1)]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_right</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1)]</span>
<span class="gp">sage: </span><span class="nb">eval</span><span class="p">,</span> <span class="p">[</span><span class="n">evec</span><span class="p">],</span> <span class="n">mult</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="nb">eval</span><span class="o">*</span><span class="n">evec</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">evec</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.elementary_divisors">
<code class="descname">elementary_divisors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.elementary_divisors" title="Permalink to this definition">¶</a></dt>
<dd><p>If self is a matrix over a principal ideal domain R, return
elements <span class="math notranslate nohighlight">\(d_i\)</span> for <span class="math notranslate nohighlight">\(1 \le i \le k = \min(r,s)\)</span>
where <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(s\)</span> are the number of rows and
columns of self, such that the cokernel of self is isomorphic to</p>
<div class="math notranslate nohighlight">
\[R/(d_1) \oplus R/(d_2) \oplus R/(d_k)\]</div>
<p>with <span class="math notranslate nohighlight">\(d_i \mid d_{i+1}\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>. These are
the diagonal entries of the Smith form of self (see
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.smith_form" title="sage.matrix.matrix2.Matrix.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a>).</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">OE</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EquationOrder</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">],[</span><span class="n">w</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">elementary_divisors</span><span class="p">()</span>
<span class="go">[1, -w + 9]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.smith_form" title="sage.matrix.matrix2.Matrix.smith_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">smith_form()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.elementwise_product">
<code class="descname">elementwise_product</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.elementwise_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the elementwise product of two matrices
of the same size (also known as the Hadamard product).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">right</span></code> - the right operand of the product.  A matrix
of the same size as <code class="docutils literal notranslate"><span class="pre">self</span></code> such that multiplication
of elements of the base rings of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>
is defined, once Sage’s coercion model is applied.  If
the matrices have different sizes, or if multiplication
of individual entries cannot be achieved, a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>
will result.</li>
</ul>
<p>OUTPUT:</p>
<p>A matrix of the same size as <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">right</span></code>.  The
entry in location <span class="math notranslate nohighlight">\((i,j)\)</span> of the output is the product of
the two entries in location <span class="math notranslate nohighlight">\((i,j)\)</span> of <code class="docutils literal notranslate"><span class="pre">self</span></code> and
<code class="docutils literal notranslate"><span class="pre">right</span></code> (in that order).</p>
<p>The parent of the result is determined by Sage’s coercion
model.  If the base rings are identical, then the result
is dense or sparse according to this property for
the left operand.  If the base rings must be adjusted
for one, or both, matrices then the result will be sparse
only if both operands are sparse.  No subdivisions are
present in the result.</p>
<p>If the type of the result is not to your liking, or
the ring could be “tighter,” adjust the operands with
<a class="reference internal" href="matrix0.html#sage.matrix.matrix0.Matrix.change_ring" title="sage.matrix.matrix0.Matrix.change_ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">change_ring()</span></code></a>.
Adjust sparse versus dense inputs with the methods
<a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix.sparse_matrix" title="sage.matrix.matrix1.Matrix.sparse_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sparse_matrix()</span></code></a> and
<a class="reference internal" href="matrix1.html#sage.matrix.matrix1.Matrix.dense_matrix" title="sage.matrix.matrix1.Matrix.dense_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dense_matrix()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">[   0  1/3  4/7]</span>
<span class="go">[33/2   -6   40]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 2 by 3 dense matrices over Rational Field</span>
</pre></div>
</div>
<p>Notice the base ring of the results in the next two examples.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">-</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[  x^2 + 1         4]</span>
<span class="go">[        9 -4*x + 16]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Univariate Polynomial Ring in x over Rational Field</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">[0 2]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 2 by 2 dense matrices over Finite Field of size 3</span>
</pre></div>
</div>
<p>Non-commutative rings behave as expected.  These are the usual quaternions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[ i -1]</span>
<span class="go">[-k  j]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">[ i -1]</span>
<span class="go">[ k -j]</span>
</pre></div>
</div>
<p>Input that is not a matrix will raise an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents: &#39;Full MatrixSpace of 5 by 10 dense matrices over Integer Ring&#39; and &#39;Ambient free module of rank 4 over the principal ideal domain Integer Ring&#39;</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">polygen</span><span class="p">(</span><span class="n">parent</span><span class="p">(</span><span class="n">A</span><span class="p">)))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">elementwise_product() argument should be a matrix or coercible to a matrix</span>
</pre></div>
</div>
<p>Matrices of different sizes for operands will raise an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents: &#39;Full MatrixSpace of 5 by 10 dense matrices over Integer Ring&#39; and &#39;Full MatrixSpace of 10 by 5 dense matrices over Integer Ring&#39;</span>
</pre></div>
</div>
<p>Some pairs of rings do not have a common parent where
multiplication makes sense.  This will raise an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents: &#39;Full MatrixSpace of 3 by 2 dense matrices over Rational Field&#39; and &#39;Full MatrixSpace of 3 by 2 dense matrices over Finite Field of size 3&#39;</span>
</pre></div>
</div>
<p>We illustrate various combinations of sparse and dense matrices.
The usual coercion rules apply:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">C</span><span class="p">)</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span><span class="o">.</span><span class="n">is_dense</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">elementwise_product</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">is_dense</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2009-07-13)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the exponential of this matrix X, which is the matrix</p>
<div class="math notranslate nohighlight">
\[e^X = \sum_{k=0}^{\infty} \frac{X^k}{k!}.\]</div>
<p>This function depends on maxima’s matrix exponentiation
function, which does not deal well with floating point
numbers.  If the matrix has floating point numbers, they will
be rounded automatically to rational numbers during the
computation.  If you want approximations to the exponential
that are calculated numerically, you may get better results by
first converting your matrix to RDF or CDF, as shown in the
last example.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">[-1/22*((sqrt(33) - 11)*e^sqrt(33) - sqrt(33) - 11)*e^(-1/2*sqrt(33) + 5/2)              2/33*(sqrt(33)*e^sqrt(33) - sqrt(33))*e^(-1/2*sqrt(33) + 5/2)]</span>
<span class="go">[             1/11*(sqrt(33)*e^sqrt(33) - sqrt(33))*e^(-1/2*sqrt(33) + 5/2)  1/22*((sqrt(33) + 11)*e^sqrt(33) - sqrt(33) + 11)*e^(-1/2*sqrt(33) + 5/2)]</span>

<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">exp</span><span class="p">())</span>
<span class="go">&lt;type &#39;sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense&#39;&gt;</span>

<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">[-1/418*((3*sqrt(209) - 209)*e^(1/10*sqrt(209)) - 3*sqrt(209) - 209)*e^(-1/20*sqrt(209) + 13/20)                   20/627*(sqrt(209)*e^(1/10*sqrt(209)) - sqrt(209))*e^(-1/20*sqrt(209) + 13/20)]</span>
<span class="go">[                  15/418*(sqrt(209)*e^(1/10*sqrt(209)) - sqrt(209))*e^(-1/20*sqrt(209) + 13/20)  1/418*((3*sqrt(209) + 209)*e^(1/10*sqrt(209)) - 3*sqrt(209) + 209)*e^(-1/20*sqrt(209) + 13/20)]</span>

<span class="gp">sage: </span><span class="n">a</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()],[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">[ 1/11882424341266*((11*sqrt(227345670387496707609) + 5941212170633)*e^(3/1275529100*sqrt(227345670387496707609)) - 11*sqrt(227345670387496707609) + 5941212170633)*e^(-3/2551058200*sqrt(227345670387496707609) + 101/200)                            445243650/75781890129165569203*(sqrt(227345670387496707609)*e^(3/1275529100*sqrt(227345670387496707609)) - sqrt(227345670387496707609))*e^(-3/2551058200*sqrt(227345670387496707609) + 101/200)]</span>
<span class="go">[                                     10000/53470909535697*(sqrt(227345670387496707609)*e^(3/1275529100*sqrt(227345670387496707609)) - sqrt(227345670387496707609))*e^(-3/2551058200*sqrt(227345670387496707609) + 101/200) -1/11882424341266*((11*sqrt(227345670387496707609) - 5941212170633)*e^(3/1275529100*sqrt(227345670387496707609)) - 11*sqrt(227345670387496707609) - 5941212170633)*e^(-3/2551058200*sqrt(227345670387496707609) + 101/200)]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>  <span class="c1"># rel tol 1e-14</span>
<span class="go">[42748127.31532951 7368259.244159399]</span>
<span class="go">[234538976.1381042 40426191.45156228]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.extended_echelon_form">
<code class="descname">extended_echelon_form</code><span class="sig-paren">(</span><em>subdivide=False</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.extended_echelon_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> augmented with an identity matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - default: <code class="docutils literal notranslate"><span class="pre">False</span></code> - determines if the
returned matrix is subdivided.  See the description of the
(output) below for details.</li>
<li><code class="docutils literal notranslate"><span class="pre">kwds</span></code> - additional keywords that can be passed to
the method that computes the echelon form.</li>
</ul>
<p>OUTPUT:</p>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix, add the <span class="math notranslate nohighlight">\(m\)</span> columns of an
<span class="math notranslate nohighlight">\(m\times m\)</span> identity matrix to the right of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  Then
row-reduce this <span class="math notranslate nohighlight">\(m\times(n+m)\)</span> matrix.  This matrix is returned
as an immutable matrix.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">subdivide</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> then the returned matrix has a single
division among the columns and a single division among the rows.
The column subdivision has <span class="math notranslate nohighlight">\(n\)</span> columns to the left and <span class="math notranslate nohighlight">\(m\)</span>
columns to the right.  The row division separates the non-zero rows
from the zero rows, when restricted to the first <span class="math notranslate nohighlight">\(n\)</span> columns.</p>
<p>For a nonsingular matrix the final <span class="math notranslate nohighlight">\(m\)</span> columns of the extended
echelon form are the inverse of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  For a matrix of
any size, the final <span class="math notranslate nohighlight">\(m\)</span> columns provide a matrix that transforms
<code class="docutils literal notranslate"><span class="pre">self</span></code> to echelon form when it multiplies <code class="docutils literal notranslate"><span class="pre">self</span></code> from the left.
When the base ring is a field, the uniqueness of reduced row-echelon
form implies that this transformation matrix can be taken as the
coefficients giving a
canonical set of linear combinations of the rows of <code class="docutils literal notranslate"><span class="pre">self</span></code> that
yield reduced row-echelon form.</p>
<p>When subdivided as described above, and again over a field, the
parts of the subdivision in the upper-left corner and lower-right
corner satisfy several interesting relationships with the row space,
column space, left kernel and right kernel of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  See the
examples below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method returns an echelon form.  If the base ring
is not a field, no attempt is made to move to the fraction field.
See an example below where the base ring is changed manually.</p>
</div>
<p>EXAMPLES:</p>
<p>The four relationships at the end of this example hold in general.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [-1, 1, -5, 3, 4, 4],</span>
<span class="go">....:                 [2, -1, 7, 0, 2, -2],</span>
<span class="go">....:                 [2, 0, 4, 3, 6, 1],</span>
<span class="go">....:                 [2, -1, 7, 0, 2, -2]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[   1    0    2    0    0   -1|   0   -1    0    1   -1]</span>
<span class="go">[   0    1   -3    0   -2    0|   0   -2    0    2   -3]</span>
<span class="go">[   0    0    0    1    2    1|   0  2/3    0 -1/3  2/3]</span>
<span class="go">[-----------------------------+------------------------]</span>
<span class="go">[   0    0    0    0    0    0|   1  2/3    0 -1/3 -1/3]</span>
<span class="go">[   0    0    0    0    0    0|   0    0    1    0   -1]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">matrix_from_columns</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">11</span><span class="p">));</span> <span class="n">J</span>
<span class="go">[   0   -1    0    1   -1]</span>
<span class="go">[   0   -2    0    2   -3]</span>
<span class="go">[   0  2/3    0 -1/3  2/3]</span>
<span class="go">[   1  2/3    0 -1/3 -1/3]</span>
<span class="go">[   0    0    1    0   -1]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[ 1  0  2  0  0 -1]</span>
<span class="go">[ 0  1 -3  0 -2  0]</span>
<span class="go">[ 0  0  0  1  2  1]</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="n">L</span>
<span class="go">[   1  2/3    0 -1/3 -1/3]</span>
<span class="go">[   0    0    1    0   -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span> <span class="o">==</span> <span class="n">C</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">C</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">column_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span> <span class="o">==</span> <span class="n">L</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For a nonsingular matrix, the right half of the extended
echelon form is the inverse matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">matrix_from_columns</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">));</span> <span class="n">J</span>
<span class="go">[-4  5  4]</span>
<span class="go">[-1  1  0]</span>
<span class="go">[ 2 -2 -1]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The result is in echelon form, so if the base ring is
not a field, the leading entry of each row may not be 1.
But you can easily change to the fraction field if necessary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="go">....:                 [10, 13, 3, -3, 7, 11, 6],</span>
<span class="go">....:                 [-12, -15, -3, -3, 2, -10, -4],</span>
<span class="go">....:                 [10, 13, 3, 3, -1, 9, 4],</span>
<span class="go">....:                 [4, 5, 1, 8, -10, 1, -1]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[ 2  0 -2  2 -9 -3 -4| 0  4 -3 -9  4]</span>
<span class="go">[ 0  1  1  2  0  1  1| 0  1  2  1  1]</span>
<span class="go">[ 0  0  0  3 -4 -1 -1| 0  3  1 -3  3]</span>
<span class="go">[--------------------+--------------]</span>
<span class="go">[ 0  0  0  0  0  0  0| 1  6  3 -6  5]</span>
<span class="go">[ 0  0  0  0  0  0  0| 0  7  2 -7  6]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">matrix_from_columns</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">));</span> <span class="n">J</span>
<span class="go">[ 0  4 -3 -9  4]</span>
<span class="go">[ 0  1  2  1  1]</span>
<span class="go">[ 0  3  1 -3  3]</span>
<span class="go">[ 1  6  3 -6  5]</span>
<span class="go">[ 0  7  2 -7  6]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[     1      0     -1      0  -19/6   -7/6   -5/3|     0      0 -89/42   -5/2    1/7]</span>
<span class="go">[     0      1      1      0    8/3    5/3    5/3|     0      0  34/21      2   -1/7]</span>
<span class="go">[     0      0      0      1   -4/3   -1/3   -1/3|     0      0   1/21      0    1/7]</span>
<span class="go">[------------------------------------------------+----------------------------------]</span>
<span class="go">[     0      0      0      0      0      0      0|     1      0    9/7      0   -1/7]</span>
<span class="go">[     0      0      0      0      0      0      0|     0      1    2/7     -1    6/7]</span>
</pre></div>
</div>
<p>Subdivided, or not, the result is immutable, so make a
copy if you want to make changes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">is_mutable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[1 0 0|0 4 6]</span>
<span class="go">[0 1 0|4 2 2]</span>
<span class="go">[0 0 1|5 2 3]</span>
<span class="go">[-----+-----]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.</span><span class="n">is_mutable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([],[]);</span> <span class="n">G</span>
<span class="go">[1 0 0 0 4 6]</span>
<span class="go">[0 1 0 4 2 2]</span>
<span class="go">[0 0 1 5 2 3]</span>
</pre></div>
</div>
<p>If you want to determine exactly which algorithm is
used to compute the echelon form, you can add additional
keywords to pass on to the <code class="docutils literal notranslate"><span class="pre">echelon_form()</span></code> routine
employed on the augmented matrix.  Sending the flag
<code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> is a bit silly, since the
extended echelon form will never have any zero rows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extended_echelon_form</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span>
<span class="go">[  1   0  36   1  -8]</span>
<span class="go">[  0   1   5   0  -1]</span>
<span class="go">[  0   0  45   1 -10]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-02-02)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.fcp">
<code class="descname">fcp</code><span class="sig-paren">(</span><em>var='x'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.fcp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the factorization of the characteristic polynomial of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - (default: ‘x’) name of variable of charpoly</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fcp</span><span class="p">()</span>
<span class="go">x^3 - 8*x^2 + 209/5*x - 286</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">fcp</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span>
<span class="go">(T - 3) * T * (T + 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.find">
<code class="descname">find</code><span class="sig-paren">(</span><em>f</em>, <em>indices=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.find" title="Permalink to this definition">¶</a></dt>
<dd><p>Find elements in this matrix satisfying the constraints in the
function <span class="math notranslate nohighlight">\(f\)</span>. The function is evaluated on each element of
the matrix .</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">f</span></code> - a function that is evaluated on each
element of this matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">indices</span></code> - whether or not to return the indices
and elements of this matrix that satisfy the function.</li>
</ul>
<p>OUTPUT: If <code class="docutils literal notranslate"><span class="pre">indices</span></code> is not specified, return a
matrix with 1 where <span class="math notranslate nohighlight">\(f\)</span> is satisfied and 0 where it is not.
If <code class="docutils literal notranslate"><span class="pre">indices</span></code> is specified, return a dictionary
containing the elements of this matrix satisfying <span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">entry</span><span class="p">:</span><span class="n">entry</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 1 1]</span>
<span class="go">[0 1 0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0 1 1]</span>
<span class="go">[0 1 1]</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="o">&lt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">u</span><span class="o">&gt;-</span><span class="mi">1</span><span class="p">,</span><span class="n">indices</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="o">!=</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[1 1 1]</span>
<span class="go">[1 1 1]</span>
<span class="go">[1 1 1]</span>
<span class="go">[1 1 1]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="o">&gt;</span><span class="mf">1.2</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[1 0 0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="k">lambda</span> <span class="n">u</span><span class="p">:</span><span class="n">u</span><span class="o">!=</span><span class="mi">0</span><span class="p">,</span><span class="n">indices</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">==</span> <span class="n">M</span><span class="o">.</span><span class="n">nonzero_positions</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.get_subdivisions">
<code class="descname">get_subdivisions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.get_subdivisions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current subdivision of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">()</span>
<span class="go">([], [])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">()</span>
<span class="go">([2], [3])</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">());</span> <span class="n">N</span>
<span class="go">[1 0 0|0 0]</span>
<span class="go">[0 1 0|0 0]</span>
<span class="go">[-----+---]</span>
<span class="go">[0 0 1|0 0]</span>
<span class="go">[0 0 0|1 0]</span>
<span class="go">[0 0 0|0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.gram_schmidt">
<code class="descname">gram_schmidt</code><span class="sig-paren">(</span><em>orthonormal=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.gram_schmidt" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Gram-Schmidt orthogonalization on the rows of the matrix,
returning a new matrix and a matrix accomplishing the transformation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a matrix whose rows are to be orthogonalized.</li>
<li><code class="docutils literal notranslate"><span class="pre">orthonormal</span></code> - default: <code class="docutils literal notranslate"><span class="pre">False</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code> the
returned orthogonal vectors are unit vectors.  This keyword
is ignored if the matrix is over <code class="docutils literal notranslate"><span class="pre">RDF</span></code> or <code class="docutils literal notranslate"><span class="pre">CDF</span></code> and the
results are always orthonormal.</li>
</ul>
<p>OUTPUT:</p>
<p>A pair of matrices, <code class="docutils literal notranslate"><span class="pre">G</span></code> and <code class="docutils literal notranslate"><span class="pre">M</span></code> such that if <code class="docutils literal notranslate"><span class="pre">A</span></code>
represents <code class="docutils literal notranslate"><span class="pre">self</span></code>, where the parenthetical properties occur
when <code class="docutils literal notranslate"><span class="pre">orthonormal</span> <span class="pre">=</span> <span class="pre">True</span></code>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">=</span> <span class="pre">M*G</span></code></li>
<li>The rows of <code class="docutils literal notranslate"><span class="pre">G</span></code> are an orthogonal (resp. orthonormal)
set of vectors.</li>
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> times the conjugate-transpose of <code class="docutils literal notranslate"><span class="pre">G</span></code> is a diagonal
(resp. identity) matrix.</li>
<li>The row space of <code class="docutils literal notranslate"><span class="pre">G</span></code> equals the row space of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> is a full-rank matrix with zeros above the diagonal.</li>
</ul>
<p>For exact rings, any zero vectors produced (when the original
vectors are linearly dependent) are not output, thus the
orthonormal set is linearly independent, and thus a basis for the
row space of the original matrix.</p>
<p>Any notion of a Gram-Schmidt procedure requires that the base
ring of the matrix has a fraction field implemented.  In order
to arrive at an orthonormal set, it must be possible to construct
square roots of the elements of the base field.  In Sage, your
best option is the field of algebraic numbers, <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>, which
properly contains the rationals and number fields.</p>
<p>If you have an approximate numerical matrix, then this routine
requires that your base field be the real and complex
double-precision floating point numbers, <code class="docutils literal notranslate"><span class="pre">RDF</span></code> and <code class="docutils literal notranslate"><span class="pre">CDF</span></code>.
In this case, the matrix is treated as having full rank, as no
attempt is made to recognize linear dependence with approximate
calculations.</p>
<p>EXAMPLES:</p>
<p>Inexact Rings, Numerical Matrices:</p>
<p>First, the inexact rings, <code class="docutils literal notranslate"><span class="pre">CDF</span></code> and <code class="docutils literal notranslate"><span class="pre">RDF</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="p">[[</span> <span class="mf">0.6454</span> <span class="o">+</span> <span class="mf">0.7491</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8662</span> <span class="o">+</span> <span class="mf">0.1489</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>  <span class="mf">0.7656</span> <span class="o">-</span> <span class="mf">0.00344</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                  [-0.2913 + 0.8057*I,  0.8321 + 0.8170*I, -0.6744 + 0.9248*I],</span>
<span class="go">....:                  [ 0.2554 + 0.3517*I, -0.4454 - 0.1715*I,  0.8325 - 0.6282*I]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># random signs</span>
<span class="go">[-0.422243 - 0.490087*I  0.566698 - 0.097416*I -0.500882 + 0.002251*I]</span>
<span class="go">[-0.057002 - 0.495035*I  -0.35059 - 0.625323*I  0.255514 - 0.415284*I]</span>
<span class="go">[ 0.394105 - 0.421778*I -0.392266 - 0.039345*I  -0.352905 + 0.62195*I]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">[             -1.528503                    0.0                    0.0]</span>
<span class="go">[  0.459974 - 0.40061*I              -1.741233                    0.0]</span>
<span class="go">[-0.934304 + 0.148868*I   0.54833 + 0.073202*I              -0.550725]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mi">10</span><span class="o">^-</span><span class="mi">12</span><span class="p">)</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">())</span>  <span class="c1"># random</span>
<span class="go">[0.9999999999999999                0.0                0.0]</span>
<span class="go">[               0.0 0.9999999999999997                0.0]</span>
<span class="go">[               0.0                0.0                1.0]</span>
</pre></div>
</div>
<p>A rectangular matrix.  Note that the <code class="docutils literal notranslate"><span class="pre">orthonormal</span></code> keyword
is ignored in these cases.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mf">0.978325</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.751994</span><span class="p">,</span> <span class="mf">0.925305</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.200512</span><span class="p">,</span> <span class="mf">0.420458</span><span class="p">],</span>
<span class="go">....:                  [-0.474877, -0.983403, 0.089836,  0.132218, 0.672965]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mi">10</span><span class="o">^-</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[-0.607223 -0.466745  0.574315 -0.124453  0.260968]</span>
<span class="go">[ 0.123203 -0.617909 -0.530578  0.289773  0.487368]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mi">10</span><span class="o">^-</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1.611147      0.0]</span>
<span class="go">[0.958116 0.867778]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span><span class="o">-</span><span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mi">10</span><span class="o">^-</span><span class="mi">12</span><span class="p">)</span>
<span class="go">[0.0 0.0 0.0 0.0 0.0]</span>
<span class="go">[0.0 0.0 0.0 0.0 0.0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mi">10</span><span class="o">^-</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[1.0 0.0]</span>
<span class="go">[0.0 1.0]</span>
</pre></div>
</div>
<p>Even though a set of vectors may be linearly dependent, no effort
is made to decide when a zero vector is really the result of a
relation of linear dependence.  So in this regard, input matrices
are treated as being of full rank.  Try one of the base rings that
provide exact results if you need exact results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">entries</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># random signs</span>
<span class="go">[-0.408248 -0.408248 -0.816497]</span>
<span class="go">[ 0.707107 -0.707107      -0.0]</span>
<span class="go">[ -0.57735  -0.57735   0.57735]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">[-2.4494897428           0.0           0.0]</span>
<span class="go">[-3.6742346142  0.7071067812           0.0]</span>
<span class="go">[-4.8989794856  1.4142135624           0.0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">zero_at</span><span class="p">(</span><span class="mf">1e-14</span><span class="p">)</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="go">[0.0 0.0 0.0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>  <span class="c1"># abs tol 1e-14</span>
<span class="go">[0.9999999999999997                0.0                0.0]</span>
<span class="go">[               0.0 0.9999999999999998                0.0]</span>
<span class="go">[               0.0                0.0                1.0]</span>
</pre></div>
</div>
<p>Exact Rings, Orthonormalization:</p>
<p>To scale a vector to unit length requires taking
a square root, which often takes us outside the base ring.
For the integers and the rationals, the field of algebraic numbers
(<code class="docutils literal notranslate"><span class="pre">QQbar</span></code>) is big enough to contain what we need, but the price
is that the computations are very slow, hence mostly of value
for small cases or instruction. Now we need to use the
<code class="docutils literal notranslate"><span class="pre">orthonormal</span></code> keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                    [4,  1,  3],</span>
<span class="go">....:                    [6,  3,  3],</span>
<span class="go">....:                    [7,  1, -5],</span>
<span class="go">....:                    [7, -3,  5]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[ 0.5970223141259934? -0.7960297521679913? 0.09950371902099891?]</span>
<span class="go">[ 0.6063218341690895?  0.5289635311888953?  0.5937772444966257?]</span>
<span class="go">[ 0.5252981913594170?  0.2941669871612735?  -0.798453250866314?]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[ 10.04987562112089?                   0                   0]</span>
<span class="go">[ 1.890570661398980?  4.735582601355131?                   0]</span>
<span class="go">[ 1.492555785314984?  7.006153332071100?  1.638930357041381?]</span>
<span class="go">[ 2.885607851608969?  1.804330147889395?  7.963520581008761?]</span>
<span class="go">[ 7.064764050490923?  5.626248468100069? -1.197679876299471?]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">A</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">-</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>After <a class="reference external" href="https://trac.sagemath.org/14047">trac ticket #14047</a>, the matrix can also be over the algebraic reals
<code class="docutils literal notranslate"><span class="pre">AA</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="p">[[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [4,  1,  3],</span>
<span class="go">....:                 [6,  3,  3],</span>
<span class="go">....:                 [7,  1, -5],</span>
<span class="go">....:                 [7, -3,  5]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[ 0.5970223141259934? -0.7960297521679913? 0.09950371902099891?]</span>
<span class="go">[ 0.6063218341690895?  0.5289635311888953?  0.5937772444966257?]</span>
<span class="go">[ 0.5252981913594170?  0.2941669871612735?  -0.798453250866314?]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[ 10.04987562112089?                   0                   0]</span>
<span class="go">[ 1.890570661398980?  4.735582601355131?                   0]</span>
<span class="go">[ 1.492555785314984?  7.006153332071100?  1.638930357041381?]</span>
<span class="go">[ 2.885607851608969?  1.804330147889395?  7.963520581008761?]</span>
<span class="go">[ 7.064764050490923?  5.626248468100069? -1.197679876299471?]</span>
</pre></div>
</div>
<p>Starting with complex numbers with rational real and imaginary parts.
Note the use of the conjugate-transpose when checking the
orthonormality.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>  <span class="o">-</span><span class="mi">2</span><span class="p">,</span>    <span class="o">-</span><span class="n">I</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>       <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                    [-4*I, -2*I + 17,       0,  9*I + 1],</span>
<span class="go">....:                    [   1,  -2*I - 6, -I + 11, -5*I + 1]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">id3</span> <span class="o">=</span> <span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">id3</span> <span class="o">-</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>  <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A square matrix with small rank.  The zero vectors produced as a
result of linear dependence get eliminated, so the rows of <code class="docutils literal notranslate"><span class="pre">G</span></code>
are a basis for the row space of <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
<span class="go">....:                    [1, -3, 2, 5],</span>
<span class="go">....:                    [0,  0, 2, 4],</span>
<span class="go">....:                    [2, -6, 3, 8]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[ 0.1881441736767195? -0.5644325210301583?  0.2822162605150792?  0.7525766947068779?]</span>
<span class="go">[-0.2502818123591464?   0.750845437077439?  0.3688363550555841?  0.4873908977520218?]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[10.630145812734649?                   0]</span>
<span class="go">[ 6.208757731331742? 0.6718090752798139?]</span>
<span class="go">[ 3.574739299857670?  2.687236301119256?]</span>
<span class="go">[10.630145812734649?                   0]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">A</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">-</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">^-</span><span class="mi">10</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Exact Rings, Orthogonalization:</p>
<p>If we forego scaling orthogonal vectors to unit vectors, we
can apply Gram-Schmidt to a much greater variety of rings.
Use the <code class="docutils literal notranslate"><span class="pre">orthonormal=False</span></code> keyword (or assume it as the default).
Note that now the orthogonality check creates a diagonal matrix
whose diagonal entries are the squares of the lengths of the
vectors.</p>
<p>First, in the rationals, without involving <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-1,  0, -1,  0],</span>
<span class="go">....:                 [-1, -2, -3, -1],</span>
<span class="go">....:                 [ 1,  1,  2,  0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[    -1      3      2      2]</span>
<span class="go">[-19/18    1/6   -8/9    1/9]</span>
<span class="go">[  2/35  -4/35  -2/35   9/35]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[     1      0      0]</span>
<span class="go">[ -1/18      1      0]</span>
<span class="go">[-13/18  59/35      1]</span>
<span class="go">[   1/3 -48/35     -2]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span><span class="o">-</span><span class="n">A</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[   18     0     0]</span>
<span class="go">[    0 35/18     0]</span>
<span class="go">[    0     0  3/35]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A complex subfield of the complex numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>              <span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span>             <span class="o">-</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span>             <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                [         z^3 - 2*z^2 + 1, -z^3 + 2*z^2 - z - 1,                  -1,       z^2 + z],</span>
<span class="go">....:                [-1/2*z^3 - 2*z^2 + z + 1,         -z^3 + z - 2,    -2*z^3 + 1/2*z^2, 2*z^2 - z + 2]])</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">M</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">(</span><span class="n">orthonormal</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[                                                      -z^3 - 2*z                                                         -z^3 - 1                                              2*z^3 - 2*z^2 + 2*z                                                                1]</span>
<span class="go">[                   155/139*z^3 - 161/139*z^2 + 31/139*z + 13/139                 -175/139*z^3 + 180/139*z^2 - 125/139*z - 142/139                     230/139*z^3 + 124/139*z^2 + 6/139*z + 19/139                      -14/139*z^3 + 92/139*z^2 - 6/139*z - 95/139]</span>
<span class="go">[-10359/19841*z^3 - 36739/39682*z^2 + 24961/39682*z - 11879/39682  -28209/39682*z^3 - 3671/19841*z^2 + 51549/39682*z - 38613/39682    -42769/39682*z^3 - 615/39682*z^2 - 1252/19841*z - 14392/19841   4895/19841*z^3 + 57885/39682*z^2 - 46094/19841*z + 65747/39682]</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[                                                           1                                                            0                                                            0]</span>
<span class="go">[                14/139*z^3 + 47/139*z^2 + 145/139*z + 95/139                                                            1                                                            0]</span>
<span class="go">[              -7/278*z^3 + 199/278*z^2 + 183/139*z + 175/278 -3785/39682*z^3 + 3346/19841*z^2 - 3990/19841*z + 2039/19841                                                            1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">*</span><span class="n">G</span> <span class="o">-</span> <span class="n">A</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">[                               15*z^3 + 15*z^2 + 28                                                   0                                                   0]</span>
<span class="go">[                                                  0                463/139*z^3 + 463/139*z^2 + 1971/139                                                   0]</span>
<span class="go">[                                                  0                                                   0 230983/19841*z^3 + 230983/19841*z^2 + 1003433/39682]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A slightly edited legacy example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[ -1   2   5]</span>
<span class="go">[-11   1   1]</span>
<span class="go">[  1  -1  -3]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gram_schmidt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">[     -1       2       5]</span>
<span class="go">[  -52/5    -1/5      -2]</span>
<span class="go">[  2/187  36/187 -14/187]</span>
<span class="gp">sage: </span><span class="n">mu</span>
<span class="go">[     1      0      0]</span>
<span class="go">[   3/5      1      0]</span>
<span class="go">[  -3/5 -7/187      1]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">G</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The relation between mu and A is as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mu</span><span class="o">*</span><span class="n">G</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.hadamard_bound">
<code class="descname">hadamard_bound</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.hadamard_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an int n such that the absolute value of the determinant of
this matrix is at most <span class="math notranslate nohighlight">\(10^n\)</span>.</p>
<p>This is got using both the row norms and the column norms.</p>
<p>This function only makes sense when the base field can be coerced
to the real double field RDF or the MPFR Real Field with 53-bits
precision.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">123</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hadamard_bound</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-2014</span>
<span class="gp">sage: </span><span class="mi">10</span><span class="o">^</span><span class="mi">4</span>
<span class="go">10000</span>
</pre></div>
</div>
<p>In this example the Hadamard bound has to be computed
(automatically) using MPFR instead of doubles, since doubles
overflow:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="o">^</span><span class="mi">10000</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">10000</span><span class="p">,</span><span class="mi">2</span><span class="o">^</span><span class="mi">50</span><span class="p">,</span><span class="mi">3</span><span class="o">^</span><span class="mi">19292</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">hadamard_bound</span><span class="p">()</span>
<span class="go">12215</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">det</span><span class="p">()))</span>
<span class="go">12215</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.hermite_form">
<code class="descname">hermite_form</code><span class="sig-paren">(</span><em>include_zero_rows=True</em>, <em>transformation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.hermite_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hermite form of self, if it is defined.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">include_zero_rows</span></code> – bool (default: True); if False
the zero rows in the output matrix are deleted.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – bool (default: False) a matrix U such that U*self == H.</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li>matrix H</li>
<li>(optional) transformation matrix U such that U*self == H, possibly with zero
rows deleted…</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">));</span> <span class="n">M</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">maximal_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">()</span>
<span class="go">[      x       1     2*x]</span>
<span class="go">[      0       x 5*x + 2]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[      x       1     2*x]  [1 0]</span>
<span class="go">[      0       x 5*x + 2], [6 1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">([  x   1 2*x], [1 0])</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">H</span><span class="p">,</span> <span class="n">U</span>
<span class="go">(</span>
<span class="go">[  x   1 2*x]  [1 0]</span>
<span class="go">[  0   0   0], [5 1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">H</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hermite_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">include_zero_rows</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span>
<span class="go">[  x   1 2*x]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">H</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.hessenberg_form">
<code class="descname">hessenberg_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.hessenberg_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Hessenberg form of self.</p>
<p>If the base ring is merely an integral domain (and not a field),
the Hessenberg form will (in general) only be defined over the
fraction field of the base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">hessenberg_form</span><span class="p">();</span> <span class="n">h</span>
<span class="go">[    2  -7/2 -19/5    -2]</span>
<span class="go">[    2   1/2 -17/5    -1]</span>
<span class="go">[    0  25/4  15/2   5/2]</span>
<span class="go">[    0     0  58/5     3]</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="go">Full MatrixSpace of 4 by 4 dense matrices over Rational Field</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hessenbergize</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Hessenbergize only possible for matrices over a field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.hessenbergize">
<code class="descname">hessenbergize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.hessenbergize" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform self to Hessenberg form.</p>
<p>The hessenberg form of a matrix <span class="math notranslate nohighlight">\(A\)</span> is a matrix that is
similar to <span class="math notranslate nohighlight">\(A\)</span>, so has the same characteristic polynomial
as <span class="math notranslate nohighlight">\(A\)</span>, and is upper triangular except possible for entries
right below the diagonal.</p>
<p>ALGORITHM: See Henri Cohen’s first book.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hessenbergize</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[  2 3/2   1]</span>
<span class="go">[ -2   3   2]</span>
<span class="go">[  0  -3  -2]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hessenbergize</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[    2  -7/2 -19/5    -2]</span>
<span class="go">[    2   1/2 -17/5    -1]</span>
<span class="go">[    0  25/4  15/2   5/2]</span>
<span class="go">[    0     0  58/5     3]</span>
</pre></div>
</div>
<p>You can’t Hessenbergize an immutable matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">hessenbergize</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix is immutable; please change a copy instead (i.e., use copy(M) to change a copy of M).</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.image">
<code class="descname">image</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.image" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the image of the homomorphism on rows defined by this
matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MS1</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MS2</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MS1</span><span class="o">.</span><span class="n">matrix</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">MS2</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">image</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">Free module of degree 4 and rank 4 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1   0   0 426]</span>
<span class="go">[  0   1   0 518]</span>
<span class="go">[  0   0   1 293]</span>
<span class="go">[  0   0   0 687]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">image</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">row_module</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.indefinite_factorization">
<code class="descname">indefinite_factorization</code><span class="sig-paren">(</span><em>algorithm='symmetric'</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.indefinite_factorization" title="Permalink to this definition">¶</a></dt>
<dd><p>Decomposes a symmetric or Hermitian matrix into a
lower triangular matrix and a diagonal matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix over a ring.  The base ring
must have an implemented fraction field.</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - default: <code class="docutils literal notranslate"><span class="pre">'symmetric'</span></code>.  Either
<code class="docutils literal notranslate"><span class="pre">'symmetric'</span></code> or <code class="docutils literal notranslate"><span class="pre">'hermitian'</span></code>, according to if
the input matrix is symmetric or hermitian.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> - default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code> then
performs the check that the matrix is consistent with the
<code class="docutils literal notranslate"><span class="pre">algorithm</span></code> keyword.</li>
</ul>
<p>OUTPUT:</p>
<p>A lower triangular matrix <span class="math notranslate nohighlight">\(L\)</span> with each diagonal element
equal to <span class="math notranslate nohighlight">\(1\)</span> and a vector of entries that form a
diagonal matrix <span class="math notranslate nohighlight">\(D\)</span>.  The vector of diagonal entries
can be easily used to form the matrix, as demonstrated
below in the examples.</p>
<p>For a symmetric matrix, <span class="math notranslate nohighlight">\(A\)</span>, these will be related by</p>
<div class="math notranslate nohighlight">
\[A = LDL^T\]</div>
<p>If <span class="math notranslate nohighlight">\(A\)</span> is Hermitian matrix, then the transpose of <span class="math notranslate nohighlight">\(L\)</span>
should be replaced by the conjugate-transpose of <span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>If any leading principal submatrix (a square submatrix
in the upper-left corner) is singular then this method will
fail with a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>.</p>
<p>ALGORITHM:</p>
<p>The algorithm employed only uses field operations,
but the computation of each diagonal entry has the potential
for division by zero.  The number of operations is of order
<span class="math notranslate nohighlight">\(n^3/3\)</span>, which is half the count for an LU decomposition.
This makes it an appropriate candidate for solving systems
with symmetric (or Hermitian) coefficient matrices.</p>
<p>EXAMPLES:</p>
<p>There is no requirement that a matrix be positive definite, as
indicated by the negative entries in the resulting diagonal
matrix.  The default is that the input matrix is symmetric.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">3</span><span class="p">,</span>  <span class="o">-</span><span class="mi">6</span><span class="p">,</span>   <span class="mi">9</span><span class="p">,</span>   <span class="mi">6</span><span class="p">,</span>  <span class="o">-</span><span class="mi">9</span><span class="p">],</span>
<span class="go">....:                 [-6,  11, -16, -11,  17],</span>
<span class="go">....:                 [ 9, -16,  28,  16, -40],</span>
<span class="go">....:                 [ 6, -11,  16,   9, -19],</span>
<span class="go">....:                 [-9,  17, -40, -19,  68]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[ 1  0  0  0  0]</span>
<span class="go">[-2  1  0  0  0]</span>
<span class="go">[ 3 -2  1  0  0]</span>
<span class="go">[ 2 -1  0  1  0]</span>
<span class="go">[-3  1 -3  1  1]</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[ 3  0  0  0  0]</span>
<span class="go">[ 0 -1  0  0  0]</span>
<span class="go">[ 0  0  5  0  0]</span>
<span class="go">[ 0  0  0 -2  0]</span>
<span class="go">[ 0  0  0  0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">L</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Optionally, Hermitian matrices can be factored
and the result has a similar property (but not
identical).  Here, the field is all complex numbers
with rational real and imaginary parts.  As theory
predicts, the diagonal entries will be real numbers.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>      <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                [4 + 2*I,       8,    10*I],</span>
<span class="go">....:                [2 - 2*I,   -10*I,      -3]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;hermitian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[      1       0       0]</span>
<span class="go">[  I + 2       1       0]</span>
<span class="go">[ -I + 1 2*I + 1       1]</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[ 2  0  0]</span>
<span class="go">[ 0 -2  0]</span>
<span class="go">[ 0  0  3]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">==</span> <span class="n">L</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If a leading principal submatrix has zero determinant, this
algorithm will fail.  This will never happen with a positive
definite matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [15, 12,  9,  6],</span>
<span class="go">....:                 [12,  9,  7,  3],</span>
<span class="go">....:                 [-2,  6,  3,  8]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">det</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">3x3 leading principal submatrix is singular,</span>
<span class="go">so cannot create indefinite factorization</span>
</pre></div>
</div>
<p>This algorithm only depends on field operations, so
outside of the singular submatrix situation, any matrix
may be factored.  This provides a reasonable alternative
to the Cholesky decomposition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span>
<span class="go">....:     [[      a^2 + 2*a, 4*a^2 + 3*a + 4,       3*a^2 + a, 2*a^2 + 2*a + 1],</span>
<span class="go">....:      [4*a^2 + 3*a + 4,       4*a^2 + 2,             3*a, 2*a^2 + 4*a + 2],</span>
<span class="go">....:      [      3*a^2 + a,             3*a,       3*a^2 + 2, 3*a^2 + 2*a + 3],</span>
<span class="go">....:      [2*a^2 + 2*a + 1, 2*a^2 + 4*a + 2, 3*a^2 + 2*a + 3, 3*a^2 + 2*a + 4]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">[              1               0               0               0]</span>
<span class="go">[4*a^2 + 4*a + 3               1               0               0]</span>
<span class="go">[              3   4*a^2 + a + 2               1               0]</span>
<span class="go">[      4*a^2 + 4 2*a^2 + 3*a + 3 2*a^2 + 3*a + 1               1]</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[      a^2 + 2*a               0               0               0]</span>
<span class="go">[              0 2*a^2 + 2*a + 4               0               0]</span>
<span class="go">[              0               0 3*a^2 + 4*a + 3               0]</span>
<span class="go">[              0               0               0       a^2 + 3*a]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">L</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">L</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This works correctly for the 0x0 matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">()</span>
<span class="go">([], ())</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2012-05-24)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.integer_kernel">
<code class="descname">integer_kernel</code><span class="sig-paren">(</span><em>ring='ZZ'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.integer_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel of this matrix over the given ring (which should be
either the base ring, or a PID whose fraction field is the base ring).</p>
<p>Assume that the base field of this matrix has a numerator and
denominator functions for its elements, e.g., it is the rational
numbers or a fraction field. This function computes a basis over
the integers for the kernel of self.</p>
<p>If the matrix is not coercible into QQ, then the PID itself should be
given as a second argument, as in the third example below.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">integer_kernel</span><span class="p">()</span>
<span class="go">Free module of degree 4 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0 -3  2]</span>
<span class="go">[ 0  1 -2  1]</span>
</pre></div>
</div>
<p>The integer kernel even makes sense for matrices with fractional
entries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">integer_kernel</span><span class="p">()</span>
<span class="go">Free module of degree 2 and rank 1 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
<p>An example over a bigger ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">OL</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">ring_of_integers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">integer_kernel</span><span class="p">(</span><span class="n">OL</span><span class="p">)</span>
<span class="go">Free module of degree 2 and rank 1 over Maximal Order in Number Field in w with defining polynomial x^2 - x + 2</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[    -1 -w + 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.inverse">
<code class="descname">inverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.inverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the inverse of self, without changing self.</p>
<p>Note that one can use the Python inverse operator to obtain the
inverse as well.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">m</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]],</span> <span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">m</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_Z_operator_on">
<code class="descname">is_Z_operator_on</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_Z_operator_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if this matrix is a Z-operator on a cone.</p>
<p>We say that a matrix <span class="math notranslate nohighlight">\(L\)</span> is a Z-operator on a closed convex cone
<span class="math notranslate nohighlight">\(K\)</span> if the inner product of <span class="math notranslate nohighlight">\(Lx\)</span> and <span class="math notranslate nohighlight">\(s\)</span> is nonpositive for all
pairs of orthogonal vectors <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(s\)</span> in the dual of
<span class="math notranslate nohighlight">\(K\)</span>. This property need only be checked for generators of <span class="math notranslate nohighlight">\(K\)</span>
and its dual.</p>
<p>A matrix is a Z-operator on <span class="math notranslate nohighlight">\(K\)</span> if and only if its negation is a
cross-positive operator on <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>To reliably check whether or not this matrix is a Z operator,
its base ring must be either exact (for example, the rationals)
or the symbolic ring. An exact ring is more reliable, but in
some cases a matrix whose entries contain symbolic constants
like <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> will work.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a polyhedral closed convex cone.</li>
</ul>
<p>OUTPUT:</p>
<p>If the base ring of this matrix is exact, then <code class="docutils literal notranslate"><span class="pre">True</span></code> will be
returned if and only if this matrix is a Z-operator on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>If the base ring of this matrix is symbolic, then the situation
is more complicated:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned if it can be proven that this matrix
is a Z-operator on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned if it can be proven that this matrix
is not a Z-operator on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will also be returned if we can’t decide; specifically
if we arrive at a symbolic inequality that cannot be resolved.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_positive_operator_on" title="sage.matrix.matrix2.Matrix.is_positive_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_positive_operator_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_cross_positive_on" title="sage.matrix.matrix2.Matrix.is_cross_positive_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_cross_positive_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_lyapunov_like_on" title="sage.matrix.matrix2.Matrix.is_lyapunov_like_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_lyapunov_like_on()</span></code></a></p>
</div>
<p>REFERENCES:</p>
<p>A. Berman and R. J. Plemmons. Nonnegative Matrices in the
Mathematical Sciences. SIAM, Philadelphia, 1994.</p>
<p>EXAMPLES:</p>
<p>Z-matrices are Z-operators on the nonnegative orthant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
<span class="go">....:                  [ 0,  2, -7],</span>
<span class="go">....:                  [-3,  0,  3] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_Z_operator_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Symbolic entries also work in some easy cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>      <span class="o">-</span><span class="n">e</span><span class="p">,</span>  <span class="mi">0</span> <span class="p">],</span>
<span class="go">....:                  [ 0,       2, -pi],</span>
<span class="go">....:                  [-sqrt(2), 0,  3 ] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_Z_operator_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_bistochastic">
<code class="descname">is_bistochastic</code><span class="sig-paren">(</span><em>normalized=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_bistochastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if this matrix is bistochastic.</p>
<p>A matrix is said to be bistochastic if both the sums of the
entries of each row and the sum of the entries of each column
are equal to 1 and all entries are nonnegative.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">normalized</span></code> – if set to <code class="docutils literal notranslate"><span class="pre">True</span></code> (default), checks that
the sums are equal to 1. When set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, checks that
the row sums and column sums are all equal to some constant
possibly different from 1.</li>
</ul>
<p>EXAMPLES:</p>
<p>The identity matrix is clearly bistochastic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_bistochastic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same matrix, multiplied by 2, is not bistochastic anymore,
though is verifies the constraints of <code class="docutils literal notranslate"><span class="pre">normalized</span> <span class="pre">==</span> <span class="pre">False</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_bistochastic</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">is_bistochastic</span><span class="p">(</span><span class="n">normalized</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here is a matrix whose row and column sums is 1, but not all entries are
nonnegative:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_bistochastic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_cross_positive_on">
<code class="descname">is_cross_positive_on</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_cross_positive_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if this matrix is cross-positive on a cone.</p>
<p>We say that a matrix <span class="math notranslate nohighlight">\(L\)</span> is cross-positive on a closed convex
cone <span class="math notranslate nohighlight">\(K\)</span> if the inner product of <span class="math notranslate nohighlight">\(Lx\)</span> and <span class="math notranslate nohighlight">\(s\)</span> is nonnegative for
all pairs of orthogonal vectors <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(s\)</span> in the dual
of <span class="math notranslate nohighlight">\(K\)</span>. This property need only be checked for generators of <span class="math notranslate nohighlight">\(K\)</span>
and its dual.</p>
<p>To reliably check whether or not this matrix is cross-positive,
its base ring must be either exact (for example, the rationals)
or the symbolic ring. An exact ring is more reliable, but in
some cases a matrix whose entries contain symbolic constants
like <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> will work.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a polyhedral closed convex cone.</li>
</ul>
<p>OUTPUT:</p>
<p>If the base ring of this matrix is exact, then <code class="docutils literal notranslate"><span class="pre">True</span></code> will be
returned if and only if this matrix is cross-positive on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>If the base ring of this matrix is symbolic, then the situation
is more complicated:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned if it can be proven that this matrix
is cross-positive on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned if it can be proven that this matrix
is not cross-positive on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will also be returned if we can’t decide; specifically
if we arrive at a symbolic inequality that cannot be resolved.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_positive_operator_on" title="sage.matrix.matrix2.Matrix.is_positive_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_positive_operator_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_Z_operator_on" title="sage.matrix.matrix2.Matrix.is_Z_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_Z_operator_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_lyapunov_like_on" title="sage.matrix.matrix2.Matrix.is_lyapunov_like_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_lyapunov_like_on()</span></code></a></p>
</div>
<p>REFERENCES:</p>
<p>H. Schneider and M. Vidyasagar. Cross-positive matrices. SIAM
Journal on Numerical Analysis, 7:508-519, 1970.</p>
<p>EXAMPLES:</p>
<p>Negative Z-matrices are cross-positive operators on the
nonnegative orthant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="go">....:                  [ 0, 2, 7],</span>
<span class="go">....:                  [ 3, 0, 3] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_cross_positive_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Symbolic entries also work in some easy cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>       <span class="n">e</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
<span class="go">....:                  [ 0,       2, pi],</span>
<span class="go">....:                  [ sqrt(2), 0, 3 ] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_cross_positive_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_diagonalizable">
<code class="descname">is_diagonalizable</code><span class="sig-paren">(</span><em>base_field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_diagonalizable" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if the matrix is similar to a diagonal matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">base_field</span></code> - a new field to use for entries
of the matrix.</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> is the matrix <span class="math notranslate nohighlight">\(A\)</span>, then it is diagonalizable
if there is an invertible matrix <span class="math notranslate nohighlight">\(S\)</span> and a diagonal matrix
<span class="math notranslate nohighlight">\(D\)</span> such that</p>
<div class="math notranslate nohighlight">
\[S^{-1}AS = D\]</div>
<p>This routine returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is diagonalizable.
The diagonal entries of the matrix <span class="math notranslate nohighlight">\(D\)</span> are the eigenvalues
of <span class="math notranslate nohighlight">\(A\)</span>.  It may be necessary to “increase” the base field to
contain all of the eigenvalues.  Over the rationals, the field
of algebraic numbers, <a class="reference external" href="../../../number_fields/sage/rings/qqbar.html#module-sage.rings.qqbar" title="(in Sage Reference Manual: Algebraic Numbers and Number Fields v8.5)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.rings.qqbar</span></code></a> is a good choice.</p>
<p>To obtain the matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(D\)</span> use the <a class="reference internal" href="#sage.matrix.matrix2.Matrix.jordan_form" title="sage.matrix.matrix2.Matrix.jordan_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jordan_form()</span></code></a>
method with the <code class="docutils literal notranslate"><span class="pre">transformation=True</span></code> keyword.</p>
<p>ALGORITHM:</p>
<p>For each eigenvalue, this routine checks that the algebraic
multiplicity (number of occurrences as a root of the characteristic
polynomial) is equal to the geometric multiplicity (dimension
of the eigenspace), which is sufficient to ensure a basis of
eigenvectors for the columns of <span class="math notranslate nohighlight">\(S\)</span>.</p>
<p>EXAMPLES:</p>
<p>A matrix that is diagonalizable over the rationals, as evidenced
by its Jordan form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>    <span class="mi">6</span><span class="p">],</span>
<span class="go">....:                 [-9, 15,  0,  12, -27],</span>
<span class="go">....:                 [ 9, -8, 11, -12,  51],</span>
<span class="go">....:                 [ 3, -4,  0,  -1,   9],</span>
<span class="go">....:                 [-1,  0, -4,   4, -12]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[ 2  0  0  0  0]</span>
<span class="go">[ 0  3  0  0  0]</span>
<span class="go">[ 0  0  3  0  0]</span>
<span class="go">[ 0  0  0 -1  0]</span>
<span class="go">[ 0  0  0  0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A matrix that is not diagonalizable over the rationals, as evidenced
by its Jordan form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="go">....:                 [4, 6, -2, 3, -8],</span>
<span class="go">....:                 [-2, -14, 0, 0, 10],</span>
<span class="go">....:                 [3, 13, -2, 0, -11],</span>
<span class="go">....:                 [-1, 6, 1, -3, 1]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[-1  1  0  0  0]</span>
<span class="go">[ 0 -1  0  0  0]</span>
<span class="go">[ 0  0  2  1  0]</span>
<span class="go">[ 0  0  0  2  1]</span>
<span class="go">[ 0  0  0  0  2]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If any eigenvalue of a matrix is outside the base ring, then
this routine raises an error.  However, the ring can be
“expanded” to contain the eigenvalues.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [0,  1,  0,  4,  8],</span>
<span class="go">....:                 [2,  1,  3,  5,  1],</span>
<span class="go">....:                 [2, -1,  1,  0, -2],</span>
<span class="go">....:                 [0, -1, -1, -5, -8]])</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span> <span class="ow">in</span> <span class="n">QQ</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()]</span>
<span class="go">[False, False, False, False, False]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">an eigenvalue of the matrix is not contained in Rational Field</span>

<span class="gp">sage: </span><span class="p">[</span><span class="n">e</span> <span class="ow">in</span> <span class="n">QQbar</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()]</span>
<span class="go">[True, True, True, True, True]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">(</span><span class="n">base_field</span><span class="o">=</span><span class="n">QQbar</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Other exact fields may be employed, though it will not always
be possible to expand their base fields to contain all
the eigenvalues.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span>      <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                [2*b + 1,     4*b,       0,       2],</span>
<span class="go">....:                [    4*b,   b + 2, 2*b + 3,       3],</span>
<span class="go">....:                [    2*b,     3*b, 4*b + 4, 3*b + 3]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="go">[      4       1|      0       0]</span>
<span class="go">[      0       4|      0       0]</span>
<span class="go">[---------------+---------------]</span>
<span class="go">[      0       0|2*b + 1       1]</span>
<span class="go">[      0       0|      0 2*b + 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">False</span>

<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">c</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span>   <span class="n">c</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>   <span class="mi">2</span><span class="o">*</span><span class="n">c</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span>   <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">c</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span>     <span class="n">c</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                [2*c + 10, 13*c + 15, -13*c - 17, 11*c + 31],</span>
<span class="go">....:                [2*c + 10, 14*c + 10, -14*c - 12, 12*c + 30],</span>
<span class="go">....:                [       0,   2*c - 2,   -2*c + 2,   2*c + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[    4     0     0     0]</span>
<span class="go">[    0    -2     0     0]</span>
<span class="go">[    0     0 c + 3     0]</span>
<span class="go">[    0     0     0 c + 3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A trivial matrix is diagonalizable, trivially.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A matrix must be square to be diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The matrix must have entries from a field,
and it must be an exact field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix entries must be from a field, not Integer Ring</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_diagonalizable</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">base field must be exact, not Real Double Field</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-04-01)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_lyapunov_like_on">
<code class="descname">is_lyapunov_like_on</code><span class="sig-paren">(</span><em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_lyapunov_like_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if this matrix is Lyapunov-like on a cone.</p>
<p>We say that a matrix <span class="math notranslate nohighlight">\(L\)</span> is Lyapunov-like on a closed convex
cone <span class="math notranslate nohighlight">\(K\)</span> if the inner product of <span class="math notranslate nohighlight">\(Lx\)</span> and <span class="math notranslate nohighlight">\(s\)</span> is zero for all
pairs of orthogonal vectors <span class="math notranslate nohighlight">\(x\)</span> in <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(s\)</span> in the dual of
<span class="math notranslate nohighlight">\(K\)</span>. This property need only be checked for generators of <span class="math notranslate nohighlight">\(K\)</span>
and its dual.</p>
<p>An operator is Lyapunov-like on <span class="math notranslate nohighlight">\(K\)</span> if and only if both the
operator itself and its negation are cross-positive on <span class="math notranslate nohighlight">\(K\)</span>.</p>
<p>To reliably check whether or not this matrix is Lyapunov-like,
its base ring must be either exact (for example, the rationals)
or the symbolic ring. An exact ring is more reliable, but in
some cases a matrix whose entries contain symbolic constants
like <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> will work.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a polyhedral closed convex cone.</li>
</ul>
<p>OUTPUT:</p>
<p>If the base ring of this matrix is exact, then <code class="docutils literal notranslate"><span class="pre">True</span></code> will be
returned if and only if this matrix is Lyapunov-like on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>If the base ring of this matrix is symbolic, then the situation
is more complicated:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned if it can be proven that this matrix
is Lyapunov-like on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned if it can be proven that this matrix
is not Lyapunov-like on <code class="docutils literal notranslate"><span class="pre">K</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will also be returned if we can’t decide; specifically
if we arrive at a symbolic inequality that cannot be resolved.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_positive_operator_on" title="sage.matrix.matrix2.Matrix.is_positive_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_positive_operator_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_cross_positive_on" title="sage.matrix.matrix2.Matrix.is_cross_positive_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_cross_positive_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_Z_operator_on" title="sage.matrix.matrix2.Matrix.is_Z_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_Z_operator_on()</span></code></a></p>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><a class="reference internal" href="../../../references/index.html#or2017" id="id3">[Or2017]</a></li>
</ul>
<p>EXAMPLES:</p>
<p>Diagonal matrices are Lyapunov-like operators on the nonnegative
orthant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">random_vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_lyapunov_like_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Symbolic entries also work in some easy cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="n">e</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span>      <span class="p">],</span>
<span class="go">....:                  [0, pi, 0      ],</span>
<span class="go">....:                  [0, 0,  sqrt(2)] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_lyapunov_like_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_normal">
<code class="descname">is_normal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the matrix commutes with its conjugate-transpose.</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the matrix is square and commutes with its
conjugate-transpose, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>Normal matrices are precisely those that can be diagonalized
by a unitary matrix.</p>
<p>This routine is for matrices over exact rings and so may not
work properly for matrices over <code class="docutils literal notranslate"><span class="pre">RR</span></code> or <code class="docutils literal notranslate"><span class="pre">CC</span></code>.  For matrices with
approximate entries, the rings of double-precision floating-point
numbers, <code class="docutils literal notranslate"><span class="pre">RDF</span></code> and <code class="docutils literal notranslate"><span class="pre">CDF</span></code>, are a better choice since the
<a class="reference internal" href="matrix_double_dense.html#sage.matrix.matrix_double_dense.Matrix_double_dense.is_normal" title="sage.matrix.matrix_double_dense.Matrix_double_dense.is_normal"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.matrix.matrix_double_dense.Matrix_double_dense.is_normal()</span></code></a>
method has a tolerance parameter.  This provides control over
allowing for minor discrepancies between entries when checking
equality.</p>
<p>The result is cached.</p>
<p>EXAMPLES:</p>
<p>Hermitian matrices are normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span> <span class="o">+</span> <span class="n">I</span><span class="o">*</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">A</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Circulant matrices are normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CirculantGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">D</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Skew-symmetric matrices are normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_skew_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A small matrix that does not fit into any of the usual categories
of normal matrices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [1,  1]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="ow">not</span> <span class="n">A</span><span class="o">.</span><span class="n">is_hermitian</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">A</span><span class="o">.</span><span class="n">is_skew_symmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Sage has several fields besides the entire complex numbers
where conjugation is non-trivial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">7</span><span class="o">*</span><span class="n">b</span> <span class="o">-</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="n">b</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                [-2*b - 3, -3*b + 2,   -2*b],</span>
<span class="go">....:                [   b + 1,        0,     -2]])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">conjugate_transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A matrix that is nearly normal, but for a non-real
diagonal entry.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>    <span class="mi">2</span><span class="p">,</span>   <span class="mi">2</span><span class="o">-</span><span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                    [  2+I,   3+I, 2-6*I],</span>
<span class="go">....:                    [1-4*I, 2+6*I,     5]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">132</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Rectangular matrices are never normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A square, empty matrix is trivially normal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_normal</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-03-31)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_one">
<code class="descname">is_one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this matrix is the identity matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_permutation_of">
<code class="descname">is_permutation_of</code><span class="sig-paren">(</span><em>N</em>, <em>check=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_permutation_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if there exists a permutation of rows and
columns sending <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">N</span></code> and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">N</span></code> – a matrix.</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>). If <code class="docutils literal notranslate"><span class="pre">False</span></code></dt>
<dd>return Boolean indicating whether there exists a permutation of
rows and columns sending <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">N</span></code> and False otherwise.
If <code class="docutils literal notranslate"><span class="pre">True</span></code> return a tuple of a Boolean and a permutation mapping
<code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">N</span></code> if such a permutation exists, and
(<code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>) if it does not.</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>A Boolean or a tuple of a Boolean and a permutation.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[1 2 3]</span>
<span class="go">[3 5 3]</span>
<span class="go">[2 6 4]</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">N</span>
<span class="go">[1 2 3]</span>
<span class="go">[2 6 4]</span>
<span class="go">[3 5 3]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_permutation_of</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some examples that are not permutations of each other:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">N</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="go">[7 8 9]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_permutation_of</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">N</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_permutation_of</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>And for when <code class="docutils literal notranslate"><span class="pre">check</span></code> is True:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">N</span>
<span class="go">[3 5 3]</span>
<span class="go">[2 6 4]</span>
<span class="go">[1 2 3]</span>
<span class="gp">sage: </span><span class="n">r</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">is_permutation_of</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">r</span>
<span class="go">(True, ((1,2,3), ()))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">with_permuted_rows_and_columns</span><span class="p">(</span><span class="o">*</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="n">N</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_positive_definite">
<code class="descname">is_positive_definite</code><span class="sig-paren">(</span><em>certificate=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_positive_definite" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if a real or symmetric matrix is positive definite.</p>
<p>A square matrix <span class="math notranslate nohighlight">\(A\)</span> is positive definite if it is
symmetric with real entries or Hermitian with complex entries,
and for every non-zero vector <span class="math notranslate nohighlight">\(\vec{x}\)</span></p>
<div class="math notranslate nohighlight">
\[\vec{x}^\ast A\vec{x} &gt; 0.\]</div>
<p>Here <span class="math notranslate nohighlight">\(\vec{x}^\ast\)</span> is the conjugate-transpose, which can be
simplified to just the transpose in the real case.</p>
<p>ALGORITHM:</p>
<p>A matrix is positive definite if and only if the
diagonal entries from the indefinite factorization
are all positive (see <a class="reference internal" href="#sage.matrix.matrix2.Matrix.indefinite_factorization" title="sage.matrix.matrix2.Matrix.indefinite_factorization"><code class="xref py py-meth docutils literal notranslate"><span class="pre">indefinite_factorization()</span></code></a>).
So this algorithm is of order <code class="docutils literal notranslate"><span class="pre">n^3/3</span></code> and may be applied
to matrices with elements of any ring that has a fraction
field contained within the reals or complexes.</p>
<p>INPUT:</p>
<p>Any square matrix.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">certificate</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) return the
decomposition from the indefinite factorization if possible</li>
</ul>
<p>OUTPUT:</p>
<p>This routine will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the matrix is square,
symmetric or Hermitian, and meets the condition above
for the quadratic form.</p>
<p>The base ring for the elements of the matrix needs to
have a fraction field implemented and the computations
that result from the indefinite factorization must be
convertable to real numbers that are comparable to zero.</p>
<p>EXAMPLES:</p>
<p>A real symmetric matrix that is positive definite,
as evidenced by the positive entries for the diagonal
matrix of the indefinite factorization and the positive
determinants of the leading principal submatrices.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>  <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [-2, 10, -2, -7],</span>
<span class="go">....:                 [ 4, -2,  8,  4],</span>
<span class="go">....:                 [ 2, -7,  4,  7]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;symmetric&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">(4, 9, 4, 1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[4, 36, 144, 144]</span>
</pre></div>
</div>
<p>A real symmetric matrix which is not positive definite, along
with a vector that makes the quadratic form negative.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">3</span><span class="p">,</span>  <span class="o">-</span><span class="mi">6</span><span class="p">,</span>   <span class="mi">9</span><span class="p">,</span>   <span class="mi">6</span><span class="p">,</span>  <span class="o">-</span><span class="mi">9</span><span class="p">],</span>
<span class="go">....:                 [-6,  11, -16, -11,  17],</span>
<span class="go">....:                 [ 9, -16,  28,  16, -40],</span>
<span class="go">....:                 [ 6, -11,  16,   9, -19],</span>
<span class="go">....:                 [-9,  17, -40, -19,  68]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;symmetric&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">(3, -1, 5, -2, -1)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[3, -3, -15, 30, -30]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">row</span><span class="p">()</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">u</span>
<span class="go">(-3)</span>
</pre></div>
</div>
<p>A real symmetric matrix with a singular leading
principal submatrix, that is therefore not positive definite.
The vector <code class="docutils literal notranslate"><span class="pre">u</span></code> makes the quadratic form zero.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [15, 12,  9,  6],</span>
<span class="go">....:                 [12,  9,  7,  3],</span>
<span class="go">....:                 [-2,  6,  3,  8]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[21, 27, 0, -75]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">row</span><span class="p">()</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">u</span>
<span class="go">(0)</span>
</pre></div>
</div>
<p>An Hermitian matrix that is positive definite.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="n">CC</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>        <span class="mi">23</span><span class="p">,</span>  <span class="mi">17</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span>  <span class="mi">24</span><span class="o">*</span><span class="n">I</span> <span class="o">+</span> <span class="mi">25</span><span class="p">,</span>     <span class="mi">21</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                [ -17*I + 3,        38, -69*I + 89, 7*I + 15],</span>
<span class="go">....:                [-24*I + 25, 69*I + 89,        976, 24*I + 6],</span>
<span class="go">....:                [     -21*I, -7*I + 15,  -24*I + 6,       28]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;hermitian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">(23, 576/23, 89885/144, 142130/17977)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[23, 576, 359540, 2842600]</span>
</pre></div>
</div>
<p>An Hermitian matrix that is not positive definite.
The vector <code class="docutils literal notranslate"><span class="pre">u</span></code> makes the quadratic form negative.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">I</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[[</span>      <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                [4 + 2*I,       8,    10*I],</span>
<span class="go">....:                [2 - 2*I,   -10*I,      -3]])</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">indefinite_factorization</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;hermitian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">(2, -2, 3)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">B</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">B</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[2, -4, -12]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">row</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">u</span>
<span class="go">(-50)</span>
</pre></div>
</div>
<p>A positive definite matrix over an algebraically closed field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[</span>        <span class="mi">2</span><span class="p">,</span>   <span class="mi">4</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">,</span>   <span class="mi">6</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">I</span><span class="p">],</span>
<span class="go">....:                    [ -2*I + 4,        11, 10 - 12*I],</span>
<span class="go">....:                    [  4*I + 6, 10 + 12*I,        37]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_positive_definite</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">A</span><span class="p">[:</span><span class="n">i</span><span class="p">,:</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">determinant</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="o">.</span><span class="n">nrows</span><span class="p">()</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[2, 2, 6]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2012-05-24)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_positive_operator_on">
<code class="descname">is_positive_operator_on</code><span class="sig-paren">(</span><em>K1</em>, <em>K2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_positive_operator_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if this matrix is a positive operator on a cone.</p>
<p>A matrix is a positive operator on a cone if the image of the
cone under the matrix is itself a subset of the cone. That
concept can be extended to two cones: a matrix is a positive
operator on a pair of cones if the image of the first cone is
contained in the second cone.</p>
<p>To reliably check whether or not this matrix is a positive
operator, its base ring must be either exact (for example, the
rationals) or the symbolic ring. An exact ring is more reliable,
but in some cases a matrix whose entries contain symbolic
constants like <span class="math notranslate nohighlight">\(e\)</span> and <span class="math notranslate nohighlight">\(\pi\)</span> will work. Performance is best
for integer or rational matrices, for which we can check the
“is a subset of the other cone” condition quickly.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">K1</span></code> – a polyhedral closed convex cone.</li>
<li><code class="docutils literal notranslate"><span class="pre">K2</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">K1</span></code>) the codomain cone; this matrix is
a positive operator if the image of <code class="docutils literal notranslate"><span class="pre">K1</span></code> is a subset of <code class="docutils literal notranslate"><span class="pre">K2</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>If the base ring of this matrix is exact, then <code class="docutils literal notranslate"><span class="pre">True</span></code> will be
returned if and only if this matrix is a positive operator.</p>
<p>If the base ring of this matrix is symbolic, then the situation is
more complicated:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned if it can be proven that this matrix
is a positive operator.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned if it can be proven that this matrix
is not a positive operator.</li>
<li><code class="docutils literal notranslate"><span class="pre">False</span></code> will also be returned if we can’t decide; specifically
if we arrive at a symbolic inequality that cannot be resolved.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_cross_positive_on" title="sage.matrix.matrix2.Matrix.is_cross_positive_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_cross_positive_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_Z_operator_on" title="sage.matrix.matrix2.Matrix.is_Z_operator_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_Z_operator_on()</span></code></a>,
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.is_lyapunov_like_on" title="sage.matrix.matrix2.Matrix.is_lyapunov_like_on"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_lyapunov_like_on()</span></code></a></p>
</div>
<p>REFERENCES:</p>
<p>A. Berman and P. Gaiha. A generalization of irreducible
monotonicity. Linear Algebra and its Applications, 5:29-38,
1972.</p>
<p>A. Berman and R. J. Plemmons. Nonnegative Matrices in the
Mathematical Sciences. SIAM, Philadelphia, 1994.</p>
<p>EXAMPLES:</p>
<p>Nonnegative matrices are positive operators on the nonnegative
orthant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">set_random_seed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="nb">abs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_positive_operator_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Symbolic entries also work in some easy cases:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="p">[</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span>       <span class="n">e</span><span class="p">,</span> <span class="mi">0</span> <span class="p">],</span>
<span class="go">....:                  [0,       2, pi],</span>
<span class="go">....:                  [sqrt(2), 0, 0 ] ])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_positive_operator_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Your matrix can be over any exact ring, for example the ring of
univariate polynomials with rational coefficients:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_full_space</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="p">[[</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">is_positive_operator_on</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_scalar">
<code class="descname">is_scalar</code><span class="sig-paren">(</span><em>a=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_scalar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return True if this matrix is a scalar matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li>base_ring element a, which is chosen as self[0][0] if
a = None</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>whether self is a scalar matrix (in fact the scalar matrix
aI if a is input)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">is_scalar</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_similar">
<code class="descname">is_similar</code><span class="sig-paren">(</span><em>other</em>, <em>transformation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_similar" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code> are similar,
i.e. related by a change-of-basis matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">other</span></code> – a matrix, which should be square, and of the same size
as <code class="docutils literal notranslate"><span class="pre">self</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – default: <code class="docutils literal notranslate"><span class="pre">False</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the output
may include the change-of-basis matrix (also known as the similarity
transformation). See below for an exact description.</li>
</ul>
<p>OUTPUT:</p>
<p>Two matrices, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are similar if they are square
matrices of the same size and there is an invertible matrix
<span class="math notranslate nohighlight">\(S\)</span> such that <span class="math notranslate nohighlight">\(A=S^{-1}BS\)</span>. <span class="math notranslate nohighlight">\(S\)</span> can be interpreted as a
change-of-basis matrix if <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(B\)</span> are viewed as matrix
representations of the same linear transformation from a vector space
to itself.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">transformation=False</span></code> this method will return <code class="docutils literal notranslate"><span class="pre">True</span></code> if
such a matrix <span class="math notranslate nohighlight">\(S\)</span> exists, otherwise it will return <code class="docutils literal notranslate"><span class="pre">False</span></code>.  When
<code class="docutils literal notranslate"><span class="pre">transformation=True</span></code> the method returns a pair. The first part
of the pair is <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> depending on if the matrices
are similar. The second part of the pair is the change-of-basis
matrix when the matrices are similar and <code class="docutils literal notranslate"><span class="pre">None</span></code> when the matrices
are not similar.</p>
<p>When a similarity transformation matrix <code class="docutils literal notranslate"><span class="pre">S</span></code>  is requested,
it will satisfy <code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">=</span> <span class="pre">S.inverse()*other*S</span></code>.</p>
<p class="rubric">rings and coefficients</p>
<p>Inexact rings are not supported. Only rings having a
fraction field can be used as coefficients.</p>
<p>The base rings for the matrices are promoted to a common
field for the similarity check using rational form over this field.</p>
<p>If the fraction fields of both matrices are the same, this
field is used. Otherwise, if the fraction fields are only
related by a canonical coercion, the common coercion field
is used.</p>
<p>In all cases, the result is about similarity over a common field.</p>
<p class="rubric">similarity transformation</p>
<p>For computation of the similarity transformation, the
matrices are first checked to be similar over their common
field.</p>
<p>In this case, a similarity transformation is then
searched for over the common field. If this fails, the
matrices are promoted to the algebraic closure of their
common field (whenever it is available) and a similarity
transformation is looked for over the algebraic closure.</p>
<p>For example, matrices over the rationals
may be promoted to the field of algebraic numbers (<code class="docutils literal notranslate"><span class="pre">QQbar</span></code>)
for computation of the similarity transformation.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When the two matrices are similar, this routine may
fail to find the similarity transformation.  A technical
explanation follows.</p>
</div>
<p>The similarity check is accomplished with rational form, which
will be successful for any pair of matrices over the same field.
However, the computation of rational form does not provide a
transformation. So we instead compute Jordan form, which does
provide a transformation.  But Jordan form will require that
the eigenvalues of the matrix can be represented within Sage,
requiring the existence of the appropriate extension field.
When this is not possible, a <code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code> is raised, as
demonstrated in an example below.</p>
<p>EXAMPLES:</p>
<p>The two matrices in this example were constructed to be similar.
The computations happen in the field of algebraic numbers, but we
are able to convert the change-of-basis matrix back to the rationals
(which may not always be possible).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">],</span>
<span class="go">....:                 [-6, 7, -42],</span>
<span class="go">....:                 [0, 1, -6]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span>  <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [-1, -6, -1],</span>
<span class="go">....:                 [ 0,  6,  1]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">[ 1.00000000000000? + 0.?e-14*I            0.?e-14 + 0.?e-14*I            0.?e-14 + 0.?e-14*I]</span>
<span class="go">[-0.66666666666667? + 0.?e-15*I 0.166666666666667? + 0.?e-15*I -0.83333333333334? + 0.?e-14*I]</span>
<span class="go">[ 0.66666666666667? + 0.?e-14*I            0.?e-14 + 0.?e-14*I -0.33333333333333? + 0.?e-14*I]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">[   1    0    0]</span>
<span class="go">[-2/3  1/6 -5/6]</span>
<span class="go">[ 2/3    0 -1/3]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Other exact fields are supported.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,[[</span><span class="mi">2</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span>   <span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:               [  a + 3, 2*a + 2, 4*a + 2],</span>
<span class="go">....:               [2*a + 6, 5*a + 5,     3*a]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,[[</span><span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span>   <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:               [  a + 5, 4*a + 3, 3*a + 3],</span>
<span class="go">....:               [3*a + 5,   a + 4, 5*a + 6]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">[      1       0       0]</span>
<span class="go">[6*a + 1 4*a + 3 4*a + 2]</span>
<span class="go">[6*a + 3 3*a + 5 3*a + 6]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">T</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">T</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Two matrices with different sets of eigenvalues, so they
cannot possibly be similar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">2</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">],</span>
<span class="go">....:                 [ 0,  1, -2, -8],</span>
<span class="go">....:                 [-3, -3,  4,  3],</span>
<span class="go">....:                 [-1, -2,  2,  6]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                 [-1,  2, -3, -7],</span>
<span class="go">....:                 [-2,  3, -4, -7],</span>
<span class="go">....:                 [ 0, -1,  0,  0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(False, None)</span>
</pre></div>
</div>
<p>Similarity is an equivalence relation, so this routine computes
a representative of the equivalence class for each matrix, the
rational form, as provided by <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rational_form" title="sage.matrix.matrix2.Matrix.rational_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rational_form()</span></code></a>.  The matrices
below have identical eigenvalues (as evidenced by equal
characteristic polynomials), but slightly different rational forms,
and hence are not similar.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">19</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">],</span>
<span class="go">....:                 [-16, 11,  30],</span>
<span class="go">....:                 [ 15, -7, -25]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">63</span><span class="p">,</span>  <span class="mi">42</span><span class="p">],</span>
<span class="go">....:                 [ 14,  25, -14],</span>
<span class="go">....:                 [-14, -21,  18]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[  0   0 -48]</span>
<span class="go">[  1   0   8]</span>
<span class="go">[  0   1   5]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[ 4| 0  0]</span>
<span class="go">[--+-----]</span>
<span class="go">[ 0| 0 12]</span>
<span class="go">[ 0| 1  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Obtaining the transformation between two similar matrices
requires the Jordan form, which requires computing the
eigenvalues of the matrix, which may not lie in the field
used for entries of the matrix.  In this unfortunate case,
the computation of the transformation may fail with a
<code class="docutils literal notranslate"><span class="pre">RuntimeError</span></code>, EVEN when the matrices are similar.  This
is not the case for matrices over the integers, rationals
or algebraic numbers, since the computations are done in
the algebraically closed field of algebraic numbers.
Here is an example where the similarity is obvious by
design, but we are not able to resurrect a similarity
transformation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,[[</span>  <span class="n">a</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:               [6*a + 6, 6*a + 4]])</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                [1, 0]])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">S</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">unable to compute transformation for similar matrices</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Some eigenvalue does not exist in</span>
<span class="go">Finite Field in a of size 7^2.</span>
</pre></div>
</div>
<p>An example over a finite field of prime order, which uses the
algebraic closure of this field to find the change-of-basis
matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cox</span> <span class="o">=</span> <span class="n">posets</span><span class="o">.</span><span class="n">TamariLattice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">coxeter_transformation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">cox</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">M</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">(</span>
<span class="go">      [1 0 0 0 0]</span>
<span class="go">      [0 1 1 0 2]</span>
<span class="go">      [0 0 0 0 1]</span>
<span class="go">      [1 2 0 2 1]</span>
<span class="go">True, [0 0 1 0 0]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Inexact rings and fields are not supported.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">matrix entries must come from an exact field,</span>
<span class="go">not Complex Double Field</span>
</pre></div>
</div>
<p>Base rings for the matrices need to have a fraction field. So
in particular, the ring needs to be at least an integral domain.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z6</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Z6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">base ring of a matrix needs a fraction field,</span>
<span class="go">maybe the ring is not an integral domain</span>
</pre></div>
</div>
<p>If the fraction fields of the entries are unequal and do not
coerce in a common field, it is an error.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no common canonical parent for objects with parents:</span>
<span class="go">&#39;Full MatrixSpace of 2 by 2 dense matrices over Finite Field</span>
<span class="go">of size 3&#39; and</span>
<span class="go">&#39;Full MatrixSpace of 2 by 2 dense matrices over Finite Field</span>
<span class="go">of size 2&#39;</span>
</pre></div>
</div>
<p>A matrix over the integers and a matrix over the algebraic
numbers will be compared over the algebraic numbers (by coercion
of <code class="docutils literal notranslate"><span class="pre">QQ</span></code> in <code class="docutils literal notranslate"><span class="pre">QQbar</span></code>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_similar</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-03-15, 2015-05-25)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.is_unitary">
<code class="descname">is_unitary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.is_unitary" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if the columns of the matrix are an orthonormal basis.</p>
<p>For a matrix with real entries this determines if a matrix is
“orthogonal” and for a matrix with complex entries this determines
if the matrix is “unitary.”</p>
<p>OUTPUT:</p>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if the matrix is square and its conjugate-transpose is
its inverse, and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.  In other words, a matrix
is orthogonal or unitary if the product of its conjugate-transpose
times the matrix is the identity matrix.</p>
<p>For numerical matrices a specialized routine available
over <code class="docutils literal notranslate"><span class="pre">RDF</span></code> and <code class="docutils literal notranslate"><span class="pre">CDF</span></code> is a good choice.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="p">[[(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">55</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">22</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">I</span><span class="p">)],</span>
<span class="go">....:                    [(1/sqrt(5))*(1-i), (1/sqrt(55))*(2+2*I),  (1/sqrt(22))*(-3+I)],</span>
<span class="go">....:                    [    (1/sqrt(5))*I, (1/sqrt(55))*(3-5*I),    (1/sqrt(22))*(-2)]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A permutation matrix is always orthogonal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">Permutation</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">.</span><span class="n">to_matrix</span><span class="p">();</span> <span class="n">P</span>
<span class="go">[1 0 0 0 0]</span>
<span class="go">[0 0 0 0 1]</span>
<span class="go">[0 1 0 0 0]</span>
<span class="go">[0 0 1 0 0]</span>
<span class="go">[0 0 0 1 0]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A square matrix far from unitary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Rectangular matrices are never unitary.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">is_unitary</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.jordan_form">
<code class="descname">jordan_form</code><span class="sig-paren">(</span><em>base_ring=None</em>, <em>sparse=False</em>, <em>subdivide=True</em>, <em>transformation=False</em>, <em>eigenvalues=None</em>, <em>check_input=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.jordan_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Jordan normal form of this square matrix <span class="math notranslate nohighlight">\(A\)</span>, if it exists.</p>
<p>This computation is performed in a naive way using the ranks of powers
of <span class="math notranslate nohighlight">\(A-xI\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> is an eigenvalue of the matrix <span class="math notranslate nohighlight">\(A\)</span>.  If desired,
a transformation matrix <span class="math notranslate nohighlight">\(P\)</span> can be returned, which is such that the
Jordan canonical form is given by <span class="math notranslate nohighlight">\(P^{-1} A P\)</span>; if the matrix is
diagonalizable, this equals to <em>eigendecomposition</em> or <em>spectral
decomposition</em>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> - Ring in which to compute the Jordan form.</li>
<li><code class="docutils literal notranslate"><span class="pre">sparse</span></code> - (default <code class="docutils literal notranslate"><span class="pre">False</span></code>) If <code class="docutils literal notranslate"><span class="pre">sparse=True</span></code>, return a sparse
matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - (default <code class="docutils literal notranslate"><span class="pre">True</span></code>) If <code class="docutils literal notranslate"><span class="pre">subdivide=True</span></code>, the
subdivisions for the Jordan blocks in the matrix are shown.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> - (default <code class="docutils literal notranslate"><span class="pre">False</span></code>) If <code class="docutils literal notranslate"><span class="pre">transformation=True</span></code>,
computes also the transformation matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">eigenvalues</span></code> - (default <code class="docutils literal notranslate"><span class="pre">None</span></code>) A complete set of roots, with
multiplicity, of the characteristic polynomial of <span class="math notranslate nohighlight">\(A\)</span>, encoded as
a list of pairs, each having the form <span class="math notranslate nohighlight">\((r, m)\)</span> with <span class="math notranslate nohighlight">\(r\)</span> a root and
<span class="math notranslate nohighlight">\(m\)</span> its multiplicity. If this is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then Sage computes this
list itself, but this is only possible over base rings in whose
quotient fields polynomial factorization is implemented. Over all
other rings, providing this list manually is the only way to
compute Jordan normal forms.</li>
<li><code class="docutils literal notranslate"><span class="pre">check_input</span></code> - (default <code class="docutils literal notranslate"><span class="pre">True</span></code>) A Boolean specifying whether
the list <code class="docutils literal notranslate"><span class="pre">eigenvalues</span></code> (if provided) has to be checked for
correctness. Set this to <code class="docutils literal notranslate"><span class="pre">False</span></code> for a speedup if the eigenvalues
are known to be correct.</li>
</ul>
<p>NOTES:</p>
<p>Currently, the Jordan normal form is not computed over inexact rings
in any but the trivial cases when the matrix is either <span class="math notranslate nohighlight">\(0 \times 0\)</span>
or <span class="math notranslate nohighlight">\(1 \times 1\)</span>.</p>
<p>In the case of exact rings, this method does not compute any
generalized form of the Jordan normal form, but is only able to
compute the result if the characteristic polynomial of the matrix
splits over the specific base ring.</p>
<p>Note that the base ring must be a field or a ring with an implemented
fraction field.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>
<span class="go">....:                  1, -1, 1, 0, 1, -1, 1, 2]); a</span>
<span class="go">[ 1  0  0  0]</span>
<span class="go">[ 0  1  0  0]</span>
<span class="go">[ 1 -1  1  0]</span>
<span class="go">[ 1 -1  1  2]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="go">[2|0 0|0]</span>
<span class="go">[-+---+-]</span>
<span class="go">[0|1 1|0]</span>
<span class="go">[0|0 1|0]</span>
<span class="go">[-+---+-]</span>
<span class="go">[0|0 0|1]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[2 0 0 0]</span>
<span class="go">[0 1 1 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">b</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Some eigenvalue does not exist in Rational Field.</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Jordan normal form not implemented over inexact rings.</span>
</pre></div>
</div>
<p>Here we need to specify a field, since the eigenvalues are not defined
in the smallest ring containing the matrix entries (<a class="reference external" href="https://trac.sagemath.org/14508">trac ticket #14508</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">CyclotomicField</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[         1|         0|         0]</span>
<span class="go">[----------+----------+----------]</span>
<span class="go">[         0|     zeta3|         0]</span>
<span class="go">[----------+----------+----------]</span>
<span class="go">[         0|         0|-zeta3 - 1]</span>
</pre></div>
</div>
<p>If you need the transformation matrix as well as the Jordan form of
<code class="docutils literal notranslate"><span class="pre">self</span></code>, then pass the option <code class="docutils literal notranslate"><span class="pre">transformation=True</span></code>. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]]);</span> <span class="n">m</span>
<span class="go">[ 5  4  2  1]</span>
<span class="go">[ 0  1 -1 -1]</span>
<span class="go">[-1 -1  3  0]</span>
<span class="go">[ 1  1 -1  2]</span>
<span class="gp">sage: </span><span class="n">jf</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">jf</span>
<span class="go">[2|0|0 0]</span>
<span class="go">[-+-+---]</span>
<span class="go">[0|1|0 0]</span>
<span class="go">[-+-+---]</span>
<span class="go">[0|0|4 1]</span>
<span class="go">[0|0|0 4]</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">p</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">p</span>
<span class="go">[2 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 4 1]</span>
<span class="go">[0 0 0 4]</span>
</pre></div>
</div>
<p>Note that for matrices over inexact rings, we do not attempt to
compute the Jordan normal form, since it is not numerically
stable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">jf</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">b</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">RealField</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Jordan normal form not implemented over inexact rings.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">evals</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">jf</span> <span class="o">=</span> <span class="n">block_diagonal_matrix</span><span class="p">([</span><span class="n">jordan_block</span><span class="p">(</span><span class="n">ev</span><span class="p">,</span><span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">ev</span><span class="p">,</span><span class="n">size</span> <span class="ow">in</span> <span class="n">evals</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">p</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span> <span class="o">!=</span> <span class="n">n</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">jf</span> <span class="o">*</span> <span class="o">~</span><span class="n">p</span>
<span class="gp">sage: </span><span class="n">mjf</span><span class="p">,</span> <span class="n">mp</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mjf</span> <span class="o">==</span> <span class="n">jf</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">jf</span><span class="p">,</span><span class="n">P</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">jf</span> <span class="o">==</span> <span class="o">~</span><span class="n">P</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We verify that the bug from <a class="reference external" href="https://trac.sagemath.org/6942">trac ticket #6942</a> is fixed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span>
<span class="go">[1 1|0 0|0 0|0]</span>
<span class="go">[0 1|0 0|0 0|0]</span>
<span class="go">[---+---+---+-]</span>
<span class="go">[0 0|1 1|0 0|0]</span>
<span class="go">[0 0|0 1|0 0|0]</span>
<span class="go">[---+---+---+-]</span>
<span class="go">[0 0|0 0|1 1|0]</span>
<span class="go">[0 0|0 0|0 1|0]</span>
<span class="go">[---+---+---+-]</span>
<span class="go">[0 0|0 0|0 0|1]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">T</span> <span class="o">==</span> <span class="n">T</span> <span class="o">*</span> <span class="n">J</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
<p>We verify that the bug from <a class="reference external" href="https://trac.sagemath.org/6932">trac ticket #6932</a> is fixed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">Matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">([1], [1])</span>
</pre></div>
</div>
<p>We now go through three <span class="math notranslate nohighlight">\(10 \times 10\)</span> matrices to exhibit cases where
there are multiple blocks of the same size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">37</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">104</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">74</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">,</span> <span class="o">-</span><span class="mi">208</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">296</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">832</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">101</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">232</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">26</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">,</span> <span class="o">-</span><span class="mi">199</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">54</span><span class="p">,</span> <span class="o">-</span><span class="mi">57</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]);</span> <span class="n">A</span>
<span class="go">[    15   37/3    -16 -104/3    -29   -7/3      0    2/3  -29/3   -1/3]</span>
<span class="go">[     2      9     -1     -6     -6      0      0      0     -2      0]</span>
<span class="go">[    24   74/3    -41 -208/3    -58  -23/3      0    4/3  -58/3   -2/3]</span>
<span class="go">[    -6    -19      3     21     19      0      0      0      6      0]</span>
<span class="go">[     2      6      3     -6     -3      1      0      0     -2      0]</span>
<span class="go">[   -96 -296/3    176  832/3    232  101/3      0  -16/3  232/3    8/3]</span>
<span class="go">[    -4   -2/3     21   16/3      4   14/3      3   -1/3    4/3  -25/3]</span>
<span class="go">[    20   26/3    -66 -199/3    -42  -41/3      0   13/3  -55/3   -2/3]</span>
<span class="go">[    18     57     -9    -54    -57      0      0      0    -15      0]</span>
<span class="go">[     0      0      0      0      0      0      0      0      0      3]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">J</span>
<span class="go">[3 1 0|0 0 0|0 0 0|0]</span>
<span class="go">[0 3 1|0 0 0|0 0 0|0]</span>
<span class="go">[0 0 3|0 0 0|0 0 0|0]</span>
<span class="go">[-----+-----+-----+-]</span>
<span class="go">[0 0 0|3 1 0|0 0 0|0]</span>
<span class="go">[0 0 0|0 3 1|0 0 0|0]</span>
<span class="go">[0 0 0|0 0 3|0 0 0|0]</span>
<span class="go">[-----+-----+-----+-]</span>
<span class="go">[0 0 0|0 0 0|3 1 0|0]</span>
<span class="go">[0 0 0|0 0 0|0 3 1|0]</span>
<span class="go">[0 0 0|0 0 0|0 0 3|0]</span>
<span class="go">[-----+-----+-----+-]</span>
<span class="go">[0 0 0|0 0 0|0 0 0|3]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">37</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">44</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">74</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="p">,</span> <span class="o">-</span><span class="mi">28</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">88</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">296</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">112</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">101</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">352</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">26</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">66</span><span class="p">,</span> <span class="o">-</span><span class="mi">28</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">41</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">82</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">57</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">28</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]);</span> <span class="n">A</span>
<span class="go">[    15   37/3    -16  -14/3    -29   -7/3      0    2/3    1/3   44/3]</span>
<span class="go">[     2      9     -1      0     -6      0      0      0      0      3]</span>
<span class="go">[    24   74/3    -41  -28/3    -58  -23/3      0    4/3    2/3   88/3]</span>
<span class="go">[    -6    -19      3      3     19      0      0      0      0     -9]</span>
<span class="go">[     2      6      3      0     -3      1      0      0      0      3]</span>
<span class="go">[   -96 -296/3    176  112/3    232  101/3      0  -16/3   -8/3 -352/3]</span>
<span class="go">[    -4   -2/3     21   16/3      4   14/3      3   -1/3    4/3  -25/3]</span>
<span class="go">[    20   26/3    -66  -28/3    -42  -41/3      0   13/3    2/3   82/3]</span>
<span class="go">[    18     57     -9      0    -57      0      0      0      3     28]</span>
<span class="go">[     0      0      0      0      0      0      0      0      0      3]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">J</span>
<span class="go">[3 1 0|0 0 0|0 0|0 0]</span>
<span class="go">[0 3 1|0 0 0|0 0|0 0]</span>
<span class="go">[0 0 3|0 0 0|0 0|0 0]</span>
<span class="go">[-----+-----+---+---]</span>
<span class="go">[0 0 0|3 1 0|0 0|0 0]</span>
<span class="go">[0 0 0|0 3 1|0 0|0 0]</span>
<span class="go">[0 0 0|0 0 3|0 0|0 0]</span>
<span class="go">[-----+-----+---+---]</span>
<span class="go">[0 0 0|0 0 0|3 1|0 0]</span>
<span class="go">[0 0 0|0 0 0|0 3|0 0]</span>
<span class="go">[-----+-----+---+---]</span>
<span class="go">[0 0 0|0 0 0|0 0|3 1]</span>
<span class="go">[0 0 0|0 0 0|0 0|0 3]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">37</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">104</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">74</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span> <span class="o">-</span><span class="mi">208</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">58</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">96</span><span class="p">,</span> <span class="o">-</span><span class="mi">296</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">832</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">65</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">279</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">232</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">26</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="o">-</span><span class="mi">199</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">13</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">55</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">54</span><span class="p">,</span> <span class="o">-</span><span class="mi">57</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]);</span> <span class="n">A</span>
<span class="go">[    15   37/3    -16 -104/3    -29   -7/3     35    2/3  -29/3   -1/3]</span>
<span class="go">[     2      9     -1     -6     -6      0      7      0     -2      0]</span>
<span class="go">[    24   74/3    -29 -208/3    -58  -14/3     70    4/3  -58/3   -2/3]</span>
<span class="go">[    -6    -19      3     21     19      0    -21      0      6      0]</span>
<span class="go">[     2      6     -1     -6     -3      0      7      0     -2      0]</span>
<span class="go">[   -96 -296/3    128  832/3    232   65/3   -279  -16/3  232/3    8/3]</span>
<span class="go">[     0      0      0      0      0      0      3      0      0      0]</span>
<span class="go">[    20   26/3    -30 -199/3    -42  -14/3     70   13/3  -55/3   -2/3]</span>
<span class="go">[    18     57     -9    -54    -57      0     63      0    -15      0]</span>
<span class="go">[     0      0      0      0      0      0      0      0      0      3]</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">J</span>
<span class="go">[3 1 0|0 0|0 0|0 0|0]</span>
<span class="go">[0 3 1|0 0|0 0|0 0|0]</span>
<span class="go">[0 0 3|0 0|0 0|0 0|0]</span>
<span class="go">[-----+---+---+---+-]</span>
<span class="go">[0 0 0|3 1|0 0|0 0|0]</span>
<span class="go">[0 0 0|0 3|0 0|0 0|0]</span>
<span class="go">[-----+---+---+---+-]</span>
<span class="go">[0 0 0|0 0|3 1|0 0|0]</span>
<span class="go">[0 0 0|0 0|0 3|0 0|0]</span>
<span class="go">[-----+---+---+---+-]</span>
<span class="go">[0 0 0|0 0|0 0|3 1|0]</span>
<span class="go">[0 0 0|0 0|0 0|0 3|0]</span>
<span class="go">[-----+---+---+---+-]</span>
<span class="go">[0 0 0|0 0|0 0|0 0|3]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">*</span> <span class="n">J</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">rank</span><span class="p">()</span>
<span class="go">10</span>
</pre></div>
</div>
<p>Verify that we smoothly move to QQ from ZZ (<a class="reference external" href="https://trac.sagemath.org/12693">trac ticket #12693</a>), i.e.
we work in the vector space over the field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">J</span><span class="p">;</span> <span class="n">P</span>
<span class="go">[0 1|0]</span>
<span class="go">[0 0|0]</span>
<span class="go">[---+-]</span>
<span class="go">[0 0|0]</span>
<span class="go">[ 2  1  0]</span>
<span class="go">[ 0  0  1]</span>
<span class="go">[-2  0 -1]</span>
<span class="gp">sage: </span><span class="n">J</span> <span class="o">-</span> <span class="o">~</span><span class="n">P</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">P</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Full MatrixSpace of 3 by 3 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">==</span> <span class="n">parent</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">M</span><span class="o">/</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>By providing eigenvalues ourselves, we can compute the Jordan form even
lacking a polynomial factorization algorithm.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qx</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x11, x12, x13, x21, x22, x23, x31, x32, x33&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x11</span><span class="p">,</span> <span class="n">x12</span><span class="p">,</span> <span class="n">x13</span><span class="p">,</span> <span class="n">x21</span><span class="p">,</span> <span class="n">x22</span><span class="p">,</span> <span class="n">x23</span><span class="p">,</span> <span class="n">x31</span><span class="p">,</span> <span class="n">x32</span><span class="p">,</span> <span class="n">x33</span> <span class="o">=</span> <span class="n">Qx</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Qx</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x31</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x21</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>    <span class="c1"># This is a nilpotent matrix.</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">eigenvalues</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="go">[0 1|0]</span>
<span class="go">[0 0|0]</span>
<span class="go">[---+-]</span>
<span class="go">[0 0|0]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">eigenvalues</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The provided list of eigenvalues is not correct.</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">eigenvalues</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="go">(</span>
<span class="go">[0 1|0]</span>
<span class="go">[0 0|0]  [x31   0   1]</span>
<span class="go">[---+-]  [x21   0   0]</span>
<span class="go">[0 0|0], [  0   1   0]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>The base ring for the matrix needs to have a fraction field
and it needs to be implemented.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Matrix entries must be from a field, not Ring of integers modulo 6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.kernel">
<code class="descname">kernel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the left kernel of this matrix, as a vector space or free module.
This is the set of vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> such that <code class="docutils literal notranslate"><span class="pre">x*self</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the right kernel, use <a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel" title="sage.matrix.matrix2.Matrix.right_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel()</span></code></a>.  The method
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.kernel" title="sage.matrix.matrix2.Matrix.kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel()</span></code></a> is exactly equal to <a class="reference internal" href="#sage.matrix.matrix2.Matrix.left_kernel" title="sage.matrix.matrix2.Matrix.left_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">left_kernel()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - default: ‘default’ - a keyword that selects the
algorithm employed.  Allowable values are:<ul>
<li>‘default’ - allows the algorithm to be chosen automatically</li>
<li>‘generic’ - naive algorithm usable for matrices over any field</li>
<li>‘flint’ - FLINT library code for matrices over the rationals
or the integers</li>
<li>‘pari’ - PARI library code for matrices over number fields
or the integers</li>
<li>‘padic’ - padic algorithm from IML library for matrices
over the rationals and integers</li>
<li>‘pluq’ - PLUQ matrix factorization for matrices mod 2</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">basis</span></code> - default: ‘echelon’ - a keyword that describes
the format of the basis used to construct the left kernel.
Allowable values are:<ul>
<li>‘echelon’: the basis matrix is returned in echelon form</li>
<li>‘pivot’ : each basis vector is computed from the reduced
row-echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> by placing a single one in a
non-pivot column and zeros in the remaining non-pivot columns.
Only available for matrices over fields.</li>
<li>‘LLL’: an LLL-reduced basis.  Only available for matrices
over the integers.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>A vector space or free module whose degree equals the number
of rows in <code class="docutils literal notranslate"><span class="pre">self</span></code> and which contains all the vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> such
that <code class="docutils literal notranslate"><span class="pre">x*self</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has 0 rows, the kernel has dimension 0, while if <code class="docutils literal notranslate"><span class="pre">self</span></code>
has 0 columns the kernel is the entire ambient vector space.</p>
<p>The result is cached.  Requesting the left kernel a second time,
but with a different basis format, will return the cached result
with the format from the first computation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For much more detailed documentation of the various options see
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel" title="sage.matrix.matrix2.Matrix.right_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel()</span></code></a>, since this method just computes
the right kernel of the transpose of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<p>Over the rationals with a basis matrix in echelon form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                 [1, 1, 0, 2, -1],</span>
<span class="go">....:                 [1, 0, 3, -3, 1],</span>
<span class="go">....:                 [0, -1, -1, 3, -2],</span>
<span class="go">....:                 [0, 0, -1, 2, -1]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 5 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1  2 -1]</span>
<span class="go">[ 0  1 -1  1 -4]</span>
</pre></div>
</div>
<p>Over a finite field, with a basis matrix in “pivot” format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                             [1, 3, 2, 3, 6],</span>
<span class="go">....:                             [1, 1, 6, 5, 3],</span>
<span class="go">....:                             [2, 5, 6, 0, 0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="go">Vector space of degree 4 and dimension 2 over Finite Field of size 7</span>
<span class="go">User basis matrix:</span>
<span class="go">[5 2 1 0]</span>
<span class="go">[6 3 0 1]</span>
</pre></div>
</div>
<p>The left kernel of a zero matrix is the entire ambient vector
space whose degree equals the number of rows of <code class="docutils literal notranslate"><span class="pre">self</span></code>
(i.e. everything).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 3 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
</pre></div>
</div>
<p>We test matrices with no rows or columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 0 and dimension 0 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>The results are cached. Note that requesting a new format
for the basis is ignored and the cached copy is returned.
Work with a copy if you need a new left kernel, or perhaps
investigate the <a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel_matrix" title="sage.matrix.matrix2.Matrix.right_kernel_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel_matrix()</span></code></a> method on the
transpose, which does not cache its results and is more
flexible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1 -1/2]</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="ow">is</span> <span class="n">K2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1 -1/2]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[-2  1]</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="ow">is</span> <span class="n">K1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">==</span> <span class="n">K1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.kernel_on">
<code class="descname">kernel_on</code><span class="sig-paren">(</span><em>V</em>, <em>poly=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.kernel_on" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel of self restricted to the invariant subspace V.
The result is a vector subspace of V, which is also a subspace
of the ambient space.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> - vector subspace</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> - (optional) default: True; whether to check that
V is invariant under the action of self.</li>
<li><code class="docutils literal notranslate"><span class="pre">poly</span></code> - (optional) default: None; if not None, compute instead
the kernel of poly(self) on V.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a subspace</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function does <em>not</em> check that V is in fact
invariant under self if check is False.  With check False this
function is much faster.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">39</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]);</span> <span class="n">t</span>
<span class="go">[ 39 -10   0 -12]</span>
<span class="go">[  0   2   0  -1]</span>
<span class="go">[  0   1  -2   0]</span>
<span class="go">[  0   2   0  -2]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">fcp</span><span class="p">()</span>
<span class="go">(x - 39) * (x + 2) * (x^2 - 2)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">39</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">kernel</span><span class="p">();</span> <span class="n">V</span>
<span class="go">Vector space of degree 4 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">kernel_on</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">Vector space of degree 4 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">t</span><span class="o">-</span><span class="mi">39</span>
<span class="gp">sage: </span><span class="n">k</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">[  0 -10 -12]</span>
<span class="go">[  0 -37  -1]</span>
<span class="go">[  0   2 -41]</span>
<span class="gp">sage: </span><span class="n">ker</span> <span class="o">=</span> <span class="n">k</span><span class="o">.</span><span class="n">kernel_on</span><span class="p">(</span><span class="n">V</span><span class="p">);</span> <span class="n">ker</span>
<span class="go">Vector space of degree 4 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1 -2/7    0 -2/7]</span>
<span class="gp">sage: </span><span class="n">ker</span><span class="o">.</span><span class="mi">0</span> <span class="o">*</span> <span class="n">k</span>
<span class="go">(0, 0, 0, 0)</span>
</pre></div>
</div>
<p>Test that <a class="reference external" href="https://trac.sagemath.org/9425">trac ticket #9425</a> is fixed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">span</span><span class="p">([[</span><span class="mi">1</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">ZZ</span><span class="p">);</span> <span class="n">V</span>
<span class="go">Free module of degree 3 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[1/7   0   0]</span>
<span class="go">[  0   1   0]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">T</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">kernel_on</span><span class="p">(</span><span class="n">V</span><span class="p">);</span> <span class="n">W</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(0, 1, 0)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.</span><span class="n">is_submodule</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.left_eigenmatrix">
<code class="descname">left_eigenmatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.left_eigenmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrices D and P, where D is a diagonal matrix of
eigenvalues and P is the corresponding matrix where the rows are
corresponding eigenvectors (or zero vectors) so that P*self =
D*P.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[                  0                   0                   0]</span>
<span class="go">[                  0 -1.348469228349535?                   0]</span>
<span class="go">[                  0                   0  13.34846922834954?]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[                   1                   -2                    1]</span>
<span class="go">[                   1  0.3101020514433644? -0.3797958971132713?]</span>
<span class="go">[                   1   1.289897948556636?   1.579795897113272?]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Because P is invertible, A is diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="p">(</span><span class="o">~</span><span class="n">P</span><span class="p">)</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The matrix P may contain zero rows corresponding to eigenvalues for
which the algebraic multiplicity is greater than the geometric
multiplicity. In these cases, the matrix is not diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[2 1 0]</span>
<span class="go">[0 2 1]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[0 0 1]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">D</span><span class="o">*</span><span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.left_eigenspaces">
<code class="descname">left_eigenspaces</code><span class="sig-paren">(</span><em>format='all'</em>, <em>var='a'</em>, <em>algebraic_multiplicity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.left_eigenspaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the left eigenspaces of a matrix.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">eigenspaces_left()</span></code> and <code class="docutils literal notranslate"><span class="pre">left_eigenspaces()</span></code>
are identical methods.  Here “left” refers to the eigenvectors
being placed to the left of the matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix over an exact field.  For inexact
matrices consult the numerical or symbolic matrix classes.</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">'all'</span></code> - attempts to create every eigenspace.  This will
always be possible for matrices with rational entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">'galois'</span></code> - for each irreducible factor of the characteristic
polynomial, a single eigenspace will be output for a
single root/eigenvalue for the irreducible factor.</li>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> - Uses the ‘all’ format if the base ring is contained
in an algebraically closed field which is implemented.
Otherwise, uses the ‘galois’ format.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - default: ‘a’ - variable name used to
represent elements of the root field of each
irreducible factor of the characteristic polynomial.
If var=’a’, then the root fields will be in terms of
a0, a1, a2, …., where the numbering runs across all
the irreducible factors of the characteristic polynomial,
even for linear factors.</li>
<li><code class="docutils literal notranslate"><span class="pre">algebraic_multiplicity</span></code> - default: False - whether or
not to include the algebraic multiplicity of each eigenvalue
in the output.  See the discussion below.</li>
</ul>
<p>OUTPUT:</p>
<p>If algebraic_multiplicity=False, return a list of pairs (e, V)
where e is an eigenvalue of the matrix, and V is the corresponding
left eigenspace.  For Galois conjugates of eigenvalues, there
may be just one representative eigenspace, depending on the
<code class="docutils literal notranslate"><span class="pre">format</span></code> keyword.</p>
<p>If algebraic_multiplicity=True, return a list of triples (e, V, n)
where e and V are as above and n is the algebraic multiplicity of
the eigenvalue.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Uses a somewhat naive algorithm (simply factors the
characteristic polynomial and computes kernels directly
over the extension field).</p>
</div>
<p>EXAMPLES:</p>
<p>We compute the left eigenspaces of a <span class="math notranslate nohighlight">\(3\times 3\)</span>
rational matrix. First, we request <span class="math notranslate nohighlight">\(all\)</span> of the eigenvalues,
so the results are in the field of algebraic numbers, <span class="math notranslate nohighlight">\(QQbar\)</span>.
Then we request just one eigenspace per irreducible factor of
the characteristic polynomial with the <span class="math notranslate nohighlight">\(galois\)</span> keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(-1.348469228349535?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   1  0.3101020514433644? -0.3797958971132713?]),</span>
<span class="go">(13.34846922834954?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                 1 1.289897948556636? 1.579795897113272?])</span>
<span class="go">]</span>

<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1], 1),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5], 1)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">e</span><span class="o">*</span><span class="n">v</span> <span class="o">-</span> <span class="n">v</span><span class="o">*</span><span class="n">A</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same computation, but with implicit base change to a field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[            1 1/15*a1 + 2/5 2/15*a1 - 1/5])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>We compute the left eigenspaces of the matrix of the Hecke operator
<span class="math notranslate nohighlight">\(T_2\)</span> on level 43 modular symbols, both with all eigenvalues (the default)
and with one subspace per factor.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[ 3  0  0  0  0  0 -1]</span>
<span class="go">[ 0 -2  1  0  0  0  0]</span>
<span class="go">[ 0 -1  1  1  0 -1  0]</span>
<span class="go">[ 0 -1  0 -1  2 -1  1]</span>
<span class="go">[ 0 -1  0  1  1 -1  1]</span>
<span class="go">[ 0  0 -2  0  2 -2  1]</span>
<span class="go">[ 0  0 -1  0  1  0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Rational Field</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">();</span> <span class="n">f</span>
<span class="go">x^7 + x^6 - 12*x^5 - 16*x^4 + 36*x^3 + 52*x^2 - 32*x - 48</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">(x - 3) * (x + 2)^2 * (x^2 - 2)^2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(3, Vector space of degree 7 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[   1    0  1/7    0 -1/7    0 -2/7], 1),</span>
<span class="go">(-2, Vector space of degree 7 and dimension 2 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 0  1  0  1 -1  1 -1]</span>
<span class="go">[ 0  0  1  0 -1  2 -1], 2),</span>
<span class="go">(-1.414213562373095?, Vector space of degree 7 and dimension 2 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                  0                   1                   0                  -1 0.4142135623730951?                   1                  -1]</span>
<span class="go">[                  0                   0                   1                   0                  -1                   0  2.414213562373095?], 2),</span>
<span class="go">(1.414213562373095?, Vector space of degree 7 and dimension 2 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   0                    1                    0                   -1  -2.414213562373095?                    1                   -1]</span>
<span class="go">[                   0                    0                    1                    0                   -1                    0 -0.4142135623730951?], 2)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(3, Vector space of degree 7 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[   1    0  1/7    0 -1/7    0 -2/7], 1),</span>
<span class="go">(-2, Vector space of degree 7 and dimension 2 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 0  1  0  1 -1  1 -1]</span>
<span class="go">[ 0  0  1  0 -1  2 -1], 2),</span>
<span class="go">(a2, Vector space of degree 7 and dimension 2 over Number Field in a2 with defining polynomial x^2 - 2</span>
<span class="go">User basis matrix:</span>
<span class="go">[      0       1       0      -1 -a2 - 1       1      -1]</span>
<span class="go">[      0       0       1       0      -1       0 -a2 + 1], 2)</span>
<span class="go">]</span>
</pre></div>
</div>
<p>Next we compute the left eigenspaces over the finite field of order 11.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">),</span> <span class="n">sign</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">matrix</span><span class="p">();</span> <span class="n">A</span>
<span class="go">[ 3  9  0  0]</span>
<span class="go">[ 0  9  0  1]</span>
<span class="go">[ 0 10  9  2]</span>
<span class="go">[ 0  9  0  2]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Finite Field of size 11</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^4 + 10*x^3 + 3*x^2 + 2*x + 1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s1">&#39;beta&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(9, Vector space of degree 4 and dimension 1 over Finite Field of size 11</span>
<span class="go">User basis matrix:</span>
<span class="go">[0 0 1 5]),</span>
<span class="go">(3, Vector space of degree 4 and dimension 1 over Finite Field of size 11</span>
<span class="go">User basis matrix:</span>
<span class="go">[1 6 0 6]),</span>
<span class="go">(beta2, Vector space of degree 4 and dimension 1 over Univariate Quotient Polynomial Ring in beta2 over Finite Field of size 11 with modulus x^2 + 9</span>
<span class="go">User basis matrix:</span>
<span class="go">[           0            1            0 5*beta2 + 10])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This method is only applicable to exact matrices.
The “eigenmatrix” routines for matrices with double-precision
floating-point entries (<code class="docutils literal notranslate"><span class="pre">RDF</span></code>, <code class="docutils literal notranslate"><span class="pre">CDF</span></code>) are the best
alternative.  (Since some platforms return eigenvectors
that are the negatives of those given here, this one example
is not tested here.)  There are also “eigenmatrix” routines for
matrices with symbolic entries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">eigenspaces cannot be computed reliably for inexact rings such as Real Field with 53 bits of precision,</span>
<span class="go">consult numerical or symbolic matrix classes for other options</span>

<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span> <span class="c1"># abs tol 1e-13</span>
<span class="go">[13.348469228349522                0.0                 0.0]</span>
<span class="go">[               0.0 -1.348469228349534                 0.0]</span>
<span class="go">[               0.0                0.0                 0.0]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span> <span class="c1"># not tested</span>
<span class="go">[ 0.440242867...  0.567868371...  0.695493875...]</span>
<span class="go">[ 0.897878732...  0.278434036... -0.341010658...]</span>
<span class="go">[ 0.408248290... -0.816496580...  0.408248290...]</span>

<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">eigenmatrix_left</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span>
<span class="go">[3/2*x^2 + 1/2*x - 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)                                                       0]</span>
<span class="go">[                                                      0 3/2*x^2 + 1/2*x + 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span>
<span class="go">[                                                    1 1/2*(3*x^2 - x - sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
<span class="go">[                                                    1 1/2*(3*x^2 - x + sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
</pre></div>
</div>
<p>A request for <code class="docutils literal notranslate"><span class="pre">'all'</span></code> the eigenvalues, when it is not
possible, will raise an error.  Using the <code class="docutils literal notranslate"><span class="pre">'galois'</span></code>
format option is more likely to be successful.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">11</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span><span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="o">*</span><span class="n">b</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">unable to construct eigenspaces for eigenvalues outside the base field,</span>
<span class="go">try the keyword option: format=&#39;galois&#39;</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_left</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(a0, Vector space of degree 2 and dimension 1 over Univariate Quotient Polynomial Ring in a0 over Finite Field in b of size 11^2 with modulus x^2 + (5*b + 6)*x + 8*b + 10</span>
<span class="go">User basis matrix:</span>
<span class="go">[               1 6*b*a0 + 3*b + 1])</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.left_eigenvectors">
<code class="descname">left_eigenvectors</code><span class="sig-paren">(</span><em>extend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.left_eigenvectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the left eigenvectors of a matrix.</p>
<p>For each distinct eigenvalue, returns a list of the form (e,V,n)
where e is the eigenvalue, V is a list of eigenvectors forming a
basis for the corresponding left eigenspace, and n is the algebraic
multiplicity of the eigenvalue.</p>
<p>If the option extend is set to False, then only the eigenvalues that
live in the base ring are considered.</p>
<p>EXAMPLES: We compute the left eigenvectors of a <span class="math notranslate nohighlight">\(3\times 3\)</span>
rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">();</span> <span class="n">es</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1),</span>
<span class="go">(-1.348469228349535?, [(1, 0.3101020514433644?, -0.3797958971132713?)], 1),</span>
<span class="go">(13.34846922834954?, [(1, 1.289897948556636?, 1.579795897113272?)], 1)]</span>
<span class="gp">sage: </span><span class="nb">eval</span><span class="p">,</span> <span class="p">[</span><span class="n">evec</span><span class="p">],</span> <span class="n">mult</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="nb">eval</span><span class="o">*</span><span class="n">evec</span> <span class="o">-</span> <span class="n">evec</span><span class="o">*</span><span class="n">A</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Notice the difference between considering ring extensions or not.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">()</span>
<span class="go">[(2, [</span>
<span class="go">(0, 0, 1)</span>
<span class="go">], 1), (-1*I, [(1, -1*I, 0)], 1), (1*I, [(1, 1*I, 0)], 1)]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvectors_left</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(2, [</span>
<span class="go">(0, 0, 1)</span>
<span class="go">], 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.left_kernel">
<code class="descname">left_kernel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.left_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the left kernel of this matrix, as a vector space or free module.
This is the set of vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> such that <code class="docutils literal notranslate"><span class="pre">x*self</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the right kernel, use <a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel" title="sage.matrix.matrix2.Matrix.right_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel()</span></code></a>.  The method
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.kernel" title="sage.matrix.matrix2.Matrix.kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel()</span></code></a> is exactly equal to <a class="reference internal" href="#sage.matrix.matrix2.Matrix.left_kernel" title="sage.matrix.matrix2.Matrix.left_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">left_kernel()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - default: ‘default’ - a keyword that selects the
algorithm employed.  Allowable values are:<ul>
<li>‘default’ - allows the algorithm to be chosen automatically</li>
<li>‘generic’ - naive algorithm usable for matrices over any field</li>
<li>‘flint’ - FLINT library code for matrices over the rationals
or the integers</li>
<li>‘pari’ - PARI library code for matrices over number fields
or the integers</li>
<li>‘padic’ - padic algorithm from IML library for matrices
over the rationals and integers</li>
<li>‘pluq’ - PLUQ matrix factorization for matrices mod 2</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">basis</span></code> - default: ‘echelon’ - a keyword that describes
the format of the basis used to construct the left kernel.
Allowable values are:<ul>
<li>‘echelon’: the basis matrix is returned in echelon form</li>
<li>‘pivot’ : each basis vector is computed from the reduced
row-echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> by placing a single one in a
non-pivot column and zeros in the remaining non-pivot columns.
Only available for matrices over fields.</li>
<li>‘LLL’: an LLL-reduced basis.  Only available for matrices
over the integers.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>A vector space or free module whose degree equals the number
of rows in <code class="docutils literal notranslate"><span class="pre">self</span></code> and which contains all the vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> such
that <code class="docutils literal notranslate"><span class="pre">x*self</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has 0 rows, the kernel has dimension 0, while if <code class="docutils literal notranslate"><span class="pre">self</span></code>
has 0 columns the kernel is the entire ambient vector space.</p>
<p>The result is cached.  Requesting the left kernel a second time,
but with a different basis format, will return the cached result
with the format from the first computation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For much more detailed documentation of the various options see
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel" title="sage.matrix.matrix2.Matrix.right_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel()</span></code></a>, since this method just computes
the right kernel of the transpose of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<p>Over the rationals with a basis matrix in echelon form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                 [1, 1, 0, 2, -1],</span>
<span class="go">....:                 [1, 0, 3, -3, 1],</span>
<span class="go">....:                 [0, -1, -1, 3, -2],</span>
<span class="go">....:                 [0, 0, -1, 2, -1]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 5 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1  2 -1]</span>
<span class="go">[ 0  1 -1  1 -4]</span>
</pre></div>
</div>
<p>Over a finite field, with a basis matrix in “pivot” format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="go">....:                             [1, 3, 2, 3, 6],</span>
<span class="go">....:                             [1, 1, 6, 5, 3],</span>
<span class="go">....:                             [2, 5, 6, 0, 0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="go">Vector space of degree 4 and dimension 2 over Finite Field of size 7</span>
<span class="go">User basis matrix:</span>
<span class="go">[5 2 1 0]</span>
<span class="go">[6 3 0 1]</span>
</pre></div>
</div>
<p>The left kernel of a zero matrix is the entire ambient vector
space whose degree equals the number of rows of <code class="docutils literal notranslate"><span class="pre">self</span></code>
(i.e. everything).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 3 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
</pre></div>
</div>
<p>We test matrices with no rows or columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 0 and dimension 0 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>The results are cached. Note that requesting a new format
for the basis is ignored and the cached copy is returned.
Work with a copy if you need a new left kernel, or perhaps
investigate the <a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel_matrix" title="sage.matrix.matrix2.Matrix.right_kernel_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel_matrix()</span></code></a> method on the
transpose, which does not cache its results and is more
flexible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1 -1/2]</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="ow">is</span> <span class="n">K2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1 -1/2]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">left_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span>
<span class="go">Vector space of degree 2 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[-2  1]</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="ow">is</span> <span class="n">K1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">==</span> <span class="n">K1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.left_nullity">
<code class="descname">left_nullity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.left_nullity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (left) nullity of this matrix, which is the dimension of
the (left) kernel of this matrix acting from the right on row
vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">left_nullity</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_nullity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.matrix_window">
<code class="descname">matrix_window</code><span class="sig-paren">(</span><em>row=0</em>, <em>col=0</em>, <em>nrows=-1</em>, <em>ncols=-1</em>, <em>check=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.matrix_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the requested matrix window.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">matrix_window</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">Matrix window of size 2 x 1 at (1,1):</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
</pre></div>
</div>
<p>We test the optional check flag.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">matrix_window</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">Matrix window of size 1 x 1 at (0,1):</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">matrix_window</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">matrix window index out of range</span>
</pre></div>
</div>
<p>Another test of bounds checking:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">matrix_window</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">matrix window index out of range</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.maxspin">
<code class="descname">maxspin</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.maxspin" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the largest integer n such that the list of vectors
<span class="math notranslate nohighlight">\(S=[v, v*A, ..., v * A^n]\)</span> are linearly independent, and
returns that list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - Matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">v</span></code> - Vector</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">list</span></code> - list of Vectors</li>
</ul>
<p>ALGORITHM: The current implementation just adds vectors to a vector
space until the dimension doesn’t grow. This could be optimized by
directly using matrices and doing an efficient Echelon form. Also,
when the base is Q, maybe we could simultaneously keep track of
what is going on in the reduction modulo p, which might make things
much faster.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">t</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="mi">0</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">maxspin</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">[(1, 0, 0), (0, 1, 2), (15, 18, 21)]</span>
<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">kernel</span><span class="p">();</span> <span class="n">k</span>
<span class="go">Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">maxspin</span><span class="p">(</span><span class="n">k</span><span class="o">.</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[(1, -2, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.minimal_polynomial">
<code class="descname">minimal_polynomial</code><span class="sig-paren">(</span><em>var='x'</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.minimal_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a synonym for <code class="docutils literal notranslate"><span class="pre">self.minpoly</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
<span class="go">z^3 - 30*z^2 - 80*z</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()</span>
<span class="go">x^3 - 30*x^2 - 80*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.minors">
<code class="descname">minors</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.minors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of all <span class="math notranslate nohighlight">\(k \times k\)</span> minors of self.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(m \times n\)</span> matrix and <span class="math notranslate nohighlight">\(k\)</span> an integer with
<span class="math notranslate nohighlight">\(0 \leq k\)</span>, <span class="math notranslate nohighlight">\(k \leq m\)</span> and <span class="math notranslate nohighlight">\(k \leq n\)</span>.
A <span class="math notranslate nohighlight">\(k \times k\)</span> minor of <span class="math notranslate nohighlight">\(A\)</span> is the determinant of a
<span class="math notranslate nohighlight">\(k \times k\)</span> matrix obtained from <span class="math notranslate nohighlight">\(A\)</span> by deleting <span class="math notranslate nohighlight">\(m - k\)</span>
rows and <span class="math notranslate nohighlight">\(n - k\)</span> columns.
There are no <span class="math notranslate nohighlight">\(k \times k\)</span> minors of <span class="math notranslate nohighlight">\(A\)</span> if <span class="math notranslate nohighlight">\(k\)</span> is larger
than either <span class="math notranslate nohighlight">\(m\)</span> or <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>The returned list is sorted in lexicographical row major ordering,
e.g., if A is a <span class="math notranslate nohighlight">\(3 \times 3\)</span> matrix then the minors returned are
with these rows/columns: [ [0, 1]x[0, 1], [0, 1]x[0, 2], [0, 1]x[1, 2],
[0, 2]x[0, 1], [0, 2]x[0, 2], [0, 2]x[1, 2], [1, 2]x[0, 1], [1,
2]x[0, 2], [1, 2]x[1, 2] ].</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> – integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[1 2 3]</span>
<span class="go">[4 5 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[-3, -6, -3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 5, 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x0</span><span class="p">,</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="n">x0</span><span class="o">*</span><span class="n">x1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="mi">16</span><span class="p">,</span> <span class="n">x2</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x1</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[x0*x1*x2 + 16*x0*x1 - x0*x2, 5*x0*x1^2 + x0*x1*x2 - x1*x2, 5*x0*x1 + x0*x2 - x1*x2 - 16*x1]</span>
</pre></div>
</div>
<p>This test addresses an issue raised at <a class="reference external" href="https://trac.sagemath.org/20512">trac ticket #20512</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minors</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.minpoly">
<code class="descname">minpoly</code><span class="sig-paren">(</span><em>var='x'</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.minpoly" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimal polynomial of self.</p>
<p>This uses a simplistic - and potentially very very slow - algorithm
that involves computing kernels to determine the powers of the
factors of the charpoly that divide the minpoly.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">())</span>
<span class="go">(x + 1) * (x + 2)^2</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">()(</span><span class="n">A</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">charpoly</span><span class="p">())</span>
<span class="go">(x + 1)^2 * (x + 2)^2</span>
</pre></div>
</div>
<p>The default variable name is <span class="math notranslate nohighlight">\(x\)</span>, but you can specify
another name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">factor</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">minpoly</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="go">(y + 1) * (y + 2)^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><em>p=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the p-norm of this matrix, where <span class="math notranslate nohighlight">\(p\)</span> can be 1, 2,
<span class="math notranslate nohighlight">\(\inf\)</span>, or the Frobenius norm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a matrix whose entries are coercible into
CDF</li>
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> - one of the following options:</li>
<li><code class="docutils literal notranslate"><span class="pre">1</span></code> - the largest column-sum norm</li>
<li><code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">(default)</span></code> - the Euclidean norm</li>
<li><code class="docutils literal notranslate"><span class="pre">Infinity</span></code> - the largest row-sum norm</li>
<li><code class="docutils literal notranslate"><span class="pre">'frob'</span></code> - the Frobenius (sum of squares) norm</li>
</ul>
<p>OUTPUT: RDF number</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="../../../misc/sage/misc/functional.html#sage.misc.functional.norm" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">sage.misc.functional.norm()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">13.0</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Infinity</span><span class="p">)</span>
<span class="go">14.0</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Infinity</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Id</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Id</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>  <span class="c1"># rel tol 2e-16</span>
<span class="go">14.999999999999998</span>
</pre></div>
</div>
<p>Norms of numerical matrices over high-precision reals are computed by this routine.
Faster routines for double precision entries from <span class="math notranslate nohighlight">\(RDF\)</span> or <span class="math notranslate nohighlight">\(CDF\)</span> are provided by
the <a class="reference internal" href="matrix_double_dense.html#sage.matrix.matrix_double_dense.Matrix_double_dense" title="sage.matrix.matrix_double_dense.Matrix_double_dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix_double_dense</span></code></a> class.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">I</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span><span class="n">I</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="s1">&#39;frob&#39;</span><span class="p">)</span>
<span class="go">5.656854249492381</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">5.470684443210...</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">6.0</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Infinity</span><span class="p">)</span>
<span class="go">8.414213562373096</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[],[],[],[]])</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">0.0</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">Infinity</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.nullity">
<code class="descname">nullity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.nullity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (left) nullity of this matrix, which is the dimension of
the (left) kernel of this matrix acting from the right on row
vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">left_nullity</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">left_nullity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">nullity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.numerical_approx">
<code class="descname">numerical_approx</code><span class="sig-paren">(</span><em>prec=None</em>, <em>digits=None</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.numerical_approx" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a numerical approximation of <code class="docutils literal notranslate"><span class="pre">self</span></code> with <code class="docutils literal notranslate"><span class="pre">prec</span></code> bits
(or decimal <code class="docutils literal notranslate"><span class="pre">digits</span></code>) of precision.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – precision in bits</li>
<li><code class="docutils literal notranslate"><span class="pre">digits</span></code> – precision in decimal digits (only used if
<code class="docutils literal notranslate"><span class="pre">prec</span></code> is not given)</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – ignored for matrices</li>
</ul>
<p>OUTPUT: A matrix converted to a real or complex field</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)]])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span> <span class="p">;</span> <span class="n">e</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">d</span> <span class="o">*</span> <span class="n">b</span><span class="o">.</span><span class="n">inverse</span><span class="p">();</span><span class="n">e</span>
<span class="go">[ 1/2*sqrt(2) + 3/2 -1/4*sqrt(2) + 3/4]</span>
<span class="go">[      -sqrt(2) + 3  1/2*sqrt(2) + 3/2]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="go">[ 2.20710678118655 0.396446609406726]</span>
<span class="go">[ 1.58578643762690  2.20710678118655]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[ 2.2071 0.39645]</span>
<span class="go">[ 1.5858  2.2071]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">e</span><span class="o">-</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2.2071 - 1.0000*I           0.39645]</span>
<span class="go">[           1.5858 2.2071 - 1.0000*I]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,[</span><span class="n">i</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">)]);</span><span class="n">M</span>
<span class="go">[    0   1/2   2/3]</span>
<span class="go">[  3/4   4/5   5/6]</span>
<span class="go">[  6/7   7/8   8/9]</span>
<span class="go">[ 9/10 10/11 11/12]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">numerical_approx</span><span class="p">()</span>
<span class="go">[0.000000000000000 0.500000000000000 0.666666666666667]</span>
<span class="go">[0.750000000000000 0.800000000000000 0.833333333333333]</span>
<span class="go">[0.857142857142857 0.875000000000000 0.888888888888889]</span>
<span class="go">[0.900000000000000 0.909090909090909 0.916666666666667]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">[0.000000000000000  1.00000000000000]</span>
<span class="go">[ 2.00000000000000  3.00000000000000]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">numerical_approx</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[0.000000000000000 0.500000000000000 0.666666666666667]</span>
<span class="go">[0.750000000000000 0.800000000000000 0.833333333333333]</span>
<span class="go">[0.857142857142857 0.875000000000000 0.888888888888889]</span>
<span class="go">[0.900000000000000 0.909090909090909 0.916666666666667]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.permanent">
<code class="descname">permanent</code><span class="sig-paren">(</span><em>algorithm='Ryser'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.permanent" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the permanent of this matrix.</p>
<p>Let <span class="math notranslate nohighlight">\(A = (a_{i,j})\)</span> be an <span class="math notranslate nohighlight">\(m \times n\)</span> matrix over any
commutative ring with <span class="math notranslate nohighlight">\(m \le n\)</span>. The permanent of <span class="math notranslate nohighlight">\(A\)</span> is</p>
<div class="math notranslate nohighlight">
\[\mathrm{per}(A)
= \sum_\pi a_{1,\pi(1)} a_{2,\pi(2)} \cdots a_{m,\pi(m)}\]</div>
<p>where the summation extends over all one-to-one functions
<span class="math notranslate nohighlight">\(\pi\)</span> from <span class="math notranslate nohighlight">\(\{1, \ldots, m\}\)</span> to <span class="math notranslate nohighlight">\(\{1, \ldots, n\}\)</span>.</p>
<p>The product
<span class="math notranslate nohighlight">\(a_{1,\pi(1)} a_{2,\pi(2)} \cdots a_{m,\pi(m)}\)</span> is
called <em>diagonal product</em>. So the permanent of an
<span class="math notranslate nohighlight">\(m \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> is the sum of all the
diagonal products of <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>By default, this method uses Ryser’s algorithm, but setting
<code class="docutils literal notranslate"><span class="pre">algorithm</span></code> to “ButeraPernici” you can use the algorithm of Butera and
Pernici (which is well suited for band matrices, i.e. matrices whose
entries are concentrated near the diagonal).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – matrix of size <span class="math notranslate nohighlight">\(m \times n\)</span> with <span class="math notranslate nohighlight">\(m \leq n\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either “Ryser” (default) or “ButeraPernici”. The
Butera-Pernici algorithm takes advantage of presence of zeros and is
very well suited for sparse matrices.</li>
</ul>
<p>ALGORITHM:</p>
<p>The Ryser algorithm is implemented in the method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_permanent_ryser()</span></code>. It is a modification of theorem 7.1.1. from
Brualdi and Ryser: Combinatorial Matrix Theory. Instead of deleting
columns from <span class="math notranslate nohighlight">\(A\)</span>, we choose columns from <span class="math notranslate nohighlight">\(A\)</span> and calculate the product
of the row sums of the selected submatrix.</p>
<p>The Butera-Pernici algorithm is implemented in the function
<a class="reference internal" href="matrix_misc.html#sage.matrix.matrix_misc.permanental_minor_polynomial" title="sage.matrix.matrix_misc.permanental_minor_polynomial"><code class="xref py py-func docutils literal notranslate"><span class="pre">permanental_minor_polynomial()</span></code></a>. It takes
advantage of cancellations that may occur in the computations.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ones_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">24</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">36</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RR</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">36.0000000000000</span>
</pre></div>
</div>
<p>The permanent above is directed to the Sloane’s sequence <a class="reference external" href="https://oeis.org/A079908">OEIS sequence A079908</a>
(“The Dancing School Problems”) for which the third term is 36:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">oeis</span><span class="p">(</span><span class="mi">79908</span><span class="p">)</span>                           <span class="c1"># optional -- internet</span>
<span class="go">A079908: Solution to the Dancing School Problem with 3 girls and n+3 boys: f(3,n).</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                                  <span class="c1"># optional -- internet</span>
<span class="go">36</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">32</span>
</pre></div>
</div>
<p>A huge permanent that can not be reasonably computed with the Ryser
algorithm (a <span class="math notranslate nohighlight">\(50 \times 50\)</span> band matrix with width <span class="math notranslate nohighlight">\(5\)</span>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">%</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">1</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="n">j</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">w</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ButeraPernici&quot;</span><span class="p">)</span>
<span class="go">57766972735511097036962481710892268404670105604676932908</span>
</pre></div>
</div>
<p>See Minc: Permanents, Example 2.1, p. 5.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">103/175</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">a^2 + 2*a</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">x^2*y + x*y^2</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-02-16 and 2006-02-21)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.permanental_minor">
<code class="descname">permanental_minor</code><span class="sig-paren">(</span><em>k</em>, <em>algorithm='Ryser'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.permanental_minor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the permanental <span class="math notranslate nohighlight">\(k\)</span>-minor of this matrix.</p>
<p>The <em>permanental</em> <span class="math notranslate nohighlight">\(k\)</span>-<em>minor</em> of a matrix <span class="math notranslate nohighlight">\(A\)</span> is the sum of the
permanents of all possible <span class="math notranslate nohighlight">\(k\)</span> by <span class="math notranslate nohighlight">\(k\)</span> submatrices of <span class="math notranslate nohighlight">\(A\)</span>. Note that the
maximal permanental minor is just the permanent.</p>
<p>For a (0,1)-matrix <span class="math notranslate nohighlight">\(A\)</span> the permanental <span class="math notranslate nohighlight">\(k\)</span>-minor
counts the number of different selections of <span class="math notranslate nohighlight">\(k\)</span> 1’s of
<span class="math notranslate nohighlight">\(A\)</span> with no two of the 1’s on the same row and no two of the
1’s on the same column.</p>
<p>See Brualdi and Ryser: Combinatorial Matrix Theory, p. 203. Note
the typo <span class="math notranslate nohighlight">\(p_0(A) = 0\)</span> in that reference! For applications
see Theorem 7.2.1 and Theorem 7.2.4.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The method <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rook_vector" title="sage.matrix.matrix2.Matrix.rook_vector"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rook_vector()</span></code></a> returns the list of all permanental
minors.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> – the size of the minor</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – either “Ryser” (default) or “ButeraPernici”. The
Butera-Pernici algorithm is well suited for band matrices.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">114</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">40</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">36</span>
</pre></div>
</div>
<p>Note that if <span class="math notranslate nohighlight">\(k = m = n\)</span>, the permanental <span class="math notranslate nohighlight">\(k\)</span>-minor equals
<span class="math notranslate nohighlight">\(\mathrm{per}(A)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">permanent</span><span class="p">()</span>
<span class="go">36</span>
</pre></div>
</div>
<p>The permanental minors of the “complement” matrix of <span class="math notranslate nohighlight">\(A\)</span> is
related to the permanent of <span class="math notranslate nohighlight">\(A\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">])</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">^</span><span class="n">k</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">permanental_minor</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="n">factorial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">36</span>
</pre></div>
</div>
<p>See Theorem 7.2.1 of Brualdi and Ryser: Combinatorial Matrix
Theory: per(A)</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-02-19)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.permutation_normal_form">
<code class="descname">permutation_normal_form</code><span class="sig-paren">(</span><em>check=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.permutation_normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the set of matrices that are <code class="docutils literal notranslate"><span class="pre">self</span></code>
permuted by any row and column permutation,
and return the maximal one of the set where
matrices are ordered lexicographically
going along each row.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">check</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) If <code class="docutils literal notranslate"><span class="pre">True</span></code> return a tuple of</dt>
<dd>the maximal matrix and the permutations taking <code class="docutils literal notranslate"><span class="pre">self</span></code>
to the maximal matrix.
If <code class="docutils literal notranslate"><span class="pre">False</span></code>, return only the maximal matrix.</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>The maximal matrix.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[0 0 1]</span>
<span class="go">[1 0 2]</span>
<span class="go">[0 0 0]</span>

<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">permutation_normal_form</span><span class="p">()</span>
<span class="go">[2 1 0]</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[-1  3]</span>
<span class="go">[-1  5]</span>
<span class="go">[ 2  4]</span>

<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">permutation_normal_form</span><span class="p">(</span><span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[ 5 -1]</span>
<span class="go">[ 4  2]</span>
<span class="go">[ 3 -1],</span>
<span class="go">((1,2,3), (1,2))</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.pfaffian">
<code class="descname">pfaffian</code><span class="sig-paren">(</span><em>algorithm=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.pfaffian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Pfaffian of <code class="docutils literal notranslate"><span class="pre">self</span></code>, assuming that <code class="docutils literal notranslate"><span class="pre">self</span></code> is an
alternating matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string, the algorithm to use; currently the
following algorithms have been implemented:<ul>
<li><code class="docutils literal notranslate"><span class="pre">'definition'</span></code> - using the definition given by perfect
matchings</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) – Boolean determining whether to
check <code class="docutils literal notranslate"><span class="pre">self</span></code> for alternatingness and squareness. This has to
be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> if <code class="docutils literal notranslate"><span class="pre">self</span></code> is defined over a non-discrete
ring.</li>
</ul>
<p>The Pfaffian of an alternating matrix is defined as follows:</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an alternating <span class="math notranslate nohighlight">\(k \times k\)</span> matrix over a commutative
ring. (Here, “alternating” means that <span class="math notranslate nohighlight">\(A^T = -A\)</span> and that the
diagonal entries of <span class="math notranslate nohighlight">\(A\)</span> are zero.)
If <span class="math notranslate nohighlight">\(k\)</span> is odd, then the Pfaffian of the matrix <span class="math notranslate nohighlight">\(A\)</span> is
defined to be <span class="math notranslate nohighlight">\(0\)</span>. Let us now define it when <span class="math notranslate nohighlight">\(k\)</span> is even. In this
case, set <span class="math notranslate nohighlight">\(n = k/2\)</span> (this is an integer). For every <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>,
we denote the <span class="math notranslate nohighlight">\((i, j)\)</span>-th entry of <span class="math notranslate nohighlight">\(A\)</span> by <span class="math notranslate nohighlight">\(a_{i, j}\)</span>. Let <span class="math notranslate nohighlight">\(M\)</span>
denote the set of all perfect matchings of the set
<span class="math notranslate nohighlight">\(\{ 1, 2, \ldots, 2n \}\)</span> (see
<a class="reference external" href="../../../combinat/sage/combinat/perfect_matching.html#sage.combinat.perfect_matching.PerfectMatchings" title="(in Sage Reference Manual: Combinatorics v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.combinat.perfect_matching.PerfectMatchings</span></code></a> ).
For every matching <span class="math notranslate nohighlight">\(m \in M\)</span>, define the sign <span class="math notranslate nohighlight">\(\mathrm{sign}(m)\)</span>
of <span class="math notranslate nohighlight">\(m\)</span> by writing <span class="math notranslate nohighlight">\(m\)</span> as <span class="math notranslate nohighlight">\(\{ \{ i_1, j_1 \}, \{ i_2, j_2 \},
\ldots, \{ i_n, j_n \} \}\)</span> with <span class="math notranslate nohighlight">\(i_k &lt; j_k\)</span> for all <span class="math notranslate nohighlight">\(k\)</span>, and
setting <span class="math notranslate nohighlight">\(\mathrm{sign}(m)\)</span> to be the sign of the permutation
<span class="math notranslate nohighlight">\(( i_1, j_1, i_2, j_2, \ldots, i_n, j_n )\)</span> (written here in
one-line notation). For every matching <span class="math notranslate nohighlight">\(m \in M\)</span>, define the
weight <span class="math notranslate nohighlight">\(w(m)\)</span> of <span class="math notranslate nohighlight">\(m\)</span> by writing <span class="math notranslate nohighlight">\(m\)</span> as
<span class="math notranslate nohighlight">\(\{ \{ i_1, j_1 \}, \{ i_2, j_2 \}, \ldots, \{ i_n, j_n \} \}\)</span>
with <span class="math notranslate nohighlight">\(i_k &lt; j_k\)</span> for all <span class="math notranslate nohighlight">\(k\)</span>, and setting
<span class="math notranslate nohighlight">\(w(m) = a_{i_1, j_1} a_{i_2, j_2} \cdots a_{i_n, j_n}\)</span>. Now, the
Pfaffian of the matrix <span class="math notranslate nohighlight">\(A\)</span> is defined to be the sum</p>
<div class="math notranslate nohighlight">
\[\sum_{m \in M} \mathrm{sign}(m) w(m).\]</div>
<p>The Pfaffian of <span class="math notranslate nohighlight">\(A\)</span> is commonly denoted by <span class="math notranslate nohighlight">\(\mathrm{Pf}(A)\)</span>. It
is well-known that <span class="math notranslate nohighlight">\((\mathrm{Pf}(A))^2 = \det A\)</span> for every
alternating matrix <span class="math notranslate nohighlight">\(A\)</span>, and that
<span class="math notranslate nohighlight">\(\mathrm{Pf} (U^T A U) = \det U \cdot \mathrm{Pf}(A)\)</span> for any
<span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(U\)</span> and any alternating <span class="math notranslate nohighlight">\(n \times n\)</span>
matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>See <a class="reference internal" href="../../../references/index.html#knu1995" id="id4">[Knu1995]</a>, <a class="reference internal" href="../../../references/index.html#dw1995" id="id5">[DW1995]</a> and <a class="reference internal" href="../../../references/index.html#rot2001" id="id6">[Rot2001]</a>, just to name three
sources, for further properties of Pfaffians.</p>
<p>ALGORITHM:</p>
<p>The current implementation uses the definition given above.
It checks alternatingness of the matrix <code class="docutils literal notranslate"><span class="pre">self</span></code> only if
<code class="docutils literal notranslate"><span class="pre">check</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (this is important because even if <code class="docutils literal notranslate"><span class="pre">self</span></code>
is alternating, a non-discrete base ring might prevent Sage
from being able to check this).</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p>Implement faster algorithms, including a division-free one.
Does <a class="reference internal" href="../../../references/index.html#rot2001" id="id7">[Rot2001]</a>, section 3.3 give one?</p>
<p class="last">Check the implementation of the matchings used here for
performance?</p>
</div>
<p>EXAMPLES:</p>
<p>A <span class="math notranslate nohighlight">\(3 \times 3\)</span> alternating matrix has Pfaffian 0 independently
of its entries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MSp</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">27</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MSp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">())</span>
<span class="go">Ring of integers modulo 27</span>
</pre></div>
</div>
<p>The Pfaffian of a <span class="math notranslate nohighlight">\(2 \times 2\)</span> alternating matrix is just its
northeast entry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MSp</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MSp</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">())</span>
<span class="go">Rational Field</span>
</pre></div>
</div>
<p>The Pfaffian of a <span class="math notranslate nohighlight">\(0 \times 0\)</span> alternating matrix is <span class="math notranslate nohighlight">\(1\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">MSp</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MSp</span><span class="p">([])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">())</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
<p>Let us compute the Pfaffian of a generic <span class="math notranslate nohighlight">\(4 \times 4\)</span>
alternating matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x12,x13,x14,x23,x24,x34&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x12</span><span class="p">,</span> <span class="n">x13</span><span class="p">,</span> <span class="n">x14</span><span class="p">,</span> <span class="n">x23</span><span class="p">,</span> <span class="n">x24</span><span class="p">,</span> <span class="n">x34</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[[</span>   <span class="mi">0</span><span class="p">,</span>  <span class="n">x12</span><span class="p">,</span>  <span class="n">x13</span><span class="p">,</span>  <span class="n">x14</span><span class="p">],</span>
<span class="go">....:                [-x12,    0,  x23,  x24],</span>
<span class="go">....:                [-x13, -x23,    0,  x34],</span>
<span class="go">....:                [-x14, -x24, -x34,    0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">()</span>
<span class="go">x14*x23 - x13*x24 + x12*x34</span>
<span class="gp">sage: </span><span class="n">parent</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">())</span>
<span class="go">Multivariate Polynomial Ring in x12, x13, x14, x23, x24, x34 over Rational Field</span>
</pre></div>
</div>
<p>The Pfaffian of an alternating matrix squares to its
determinant:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
<span class="go">....:     for j in range(i):</span>
<span class="go">....:         u = floor(random() * 10)</span>
<span class="go">....:         A[i][j] = u</span>
<span class="go">....:         A[j][i] = -u</span>
<span class="go">....:     A[i][i] = 0</span>
<span class="gp">sage: </span><span class="n">AA</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AA</span><span class="o">.</span><span class="n">pfaffian</span><span class="p">()</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">==</span> <span class="n">AA</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Darij Grinberg (1 Oct 2013): first (slow)
implementation.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.pivot_rows">
<code class="descname">pivot_rows</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.pivot_rows" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pivot row positions for this matrix, which are a topmost
subset of the rows that span the row space and are linearly
independent.</p>
<p>OUTPUT: a tuple of integers</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[0 0 0]</span>
<span class="go">[1 2 3]</span>
<span class="go">[2 4 6]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pivot_rows</span><span class="p">()</span>
<span class="go">(1,)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">pivot_rows</span><span class="p">()</span> <span class="c1"># testing cached value</span>
<span class="go">(1,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>A plot of this matrix.</p>
<p>Each (ith, jth) matrix element is given a different color value
depending on its relative size compared to the other elements in
the matrix.</p>
<p>The tick marks drawn on the frame axes denote the (ith, jth)
element of the matrix.</p>
<p>This method just calls <code class="docutils literal notranslate"><span class="pre">matrix_plot</span></code>.
<code class="docutils literal notranslate"><span class="pre">*args</span></code> and <code class="docutils literal notranslate"><span class="pre">**kwds</span></code> are passed to
<code class="docutils literal notranslate"><span class="pre">matrix_plot</span></code>.</p>
<p>EXAMPLES:</p>
<p>A matrix over ZZ colored with different grey levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>Here we make a random matrix over RR and use cmap=’hsv’ to color
the matrix elements different RGB colors (see documentation for
<code class="docutils literal notranslate"><span class="pre">matrix_plot</span></code> for more information on cmaps):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">RDF</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">plot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
<p>Another random plot, but over GF(389):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">389</span><span class="p">),</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Oranges&#39;</span><span class="p">)</span>
<span class="go">Graphics object consisting of 1 graphics primitive</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.principal_square_root">
<code class="descname">principal_square_root</code><span class="sig-paren">(</span><em>check_positivity=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.principal_square_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the principal square root of a positive definte matrix.</p>
<p>A positive definite matrix <span class="math notranslate nohighlight">\(A\)</span> has a unique positive definite
matrix <span class="math notranslate nohighlight">\(M\)</span> such that <span class="math notranslate nohighlight">\(M^2 = A\)</span>.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Square_root_of_a_matrix">Wikipedia article Square_root_of_a_matrix</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">principal_square_root</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">B</span><span class="o">^</span><span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.prod_of_row_sums">
<code class="descname">prod_of_row_sums</code><span class="sig-paren">(</span><em>cols</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.prod_of_row_sums" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the product of all row sums of a submatrix of <span class="math notranslate nohighlight">\(A\)</span>
for a list of selected columns <code class="docutils literal notranslate"><span class="pre">cols</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2]</span>
<span class="go">[3 2]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">15</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[1 2 3]</span>
<span class="go">[2 5 6]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">prod_of_row_sums</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">55</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-02-18)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.pseudoinverse">
<code class="descname">pseudoinverse</code><span class="sig-paren">(</span><em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.pseudoinverse" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Moore-Penrose pseudoinverse of this matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> (default: guess) – one of the following:<ul>
<li><code class="docutils literal notranslate"><span class="pre">&quot;numpy&quot;</span></code> – Use numpy’s <code class="docutils literal notranslate"><span class="pre">linalg.pinv()</span></code> which is
suitable over real or complex fields.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;exact&quot;</span></code> – Use a simple algorithm which is not
numerically stable but useful over exact fields. Assume that
no conjugation is needed, that the conjugate transpose is
just the transpose.</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;exactconj&quot;</span></code> – Like <code class="docutils literal notranslate"><span class="pre">exact</span></code> but use the conjugate
transpose.</li>
</ul>
</li>
</ul>
<p>OUTPUT: a matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">diagonal_matrix</span><span class="p">(</span><span class="n">CDF</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">I</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">[        0.0         0.0         0.0]</span>
<span class="go">[        0.0       1.0*I         0.0]</span>
<span class="go">[        0.0         0.0 1.0 + 1.0*I]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">()</span>  <span class="c1"># tol 1e-15</span>
<span class="go">[        0.0         0.0         0.0]</span>
<span class="go">[        0.0      -1.0*I         0.0]</span>
<span class="go">[        0.0         0.0 0.5 - 0.5*I]</span>
</pre></div>
</div>
<p>We check the properties of the pseudoinverse over an exact
field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Mx</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">Mx</span> <span class="o">*</span> <span class="n">M</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Mx</span> <span class="o">*</span> <span class="n">M</span> <span class="o">*</span> <span class="n">Mx</span> <span class="o">==</span> <span class="n">Mx</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">M</span> <span class="o">*</span> <span class="n">Mx</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Mx</span> <span class="o">*</span> <span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">is_symmetric</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Beware that the <code class="docutils literal notranslate"><span class="pre">exact</span></code> algorithm is not numerically stable,
but the default <code class="docutils literal notranslate"><span class="pre">numpy</span></code> algorithm is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">()</span>  <span class="c1"># tol 1e-15</span>
<span class="go">[0.0620518477661335 0.0206839492553778 0.0124103695532267]</span>
<span class="go">[ 0.124103695532267 0.0413678985107557 0.0248207391064534]</span>
<span class="go">[ 0.186155543298400 0.0620518477661335 0.0372311086596801]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>  <span class="c1"># tol 1e-15</span>
<span class="go">[0.0620518477661335 0.0206839492553778 0.0124103695532267]</span>
<span class="go">[ 0.124103695532267 0.0413678985107557 0.0248207391064534]</span>
<span class="go">[ 0.186155543298400 0.0620518477661335 0.0372311086596801]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
<span class="go">[ 0.125000000000000 0.0625000000000000 0.0312500000000000]</span>
<span class="go">[ 0.250000000000000  0.125000000000000 0.0625000000000000]</span>
<span class="go">[ 0.000000000000000  0.000000000000000 0.0625000000000000]</span>
</pre></div>
</div>
<p>When multiplying the given matrix with the pseudoinverse, the
result is symmetric for the <code class="docutils literal notranslate"><span class="pre">exact</span></code> algorithm or hermitian
for the <code class="docutils literal notranslate"><span class="pre">exactconj</span></code> algorithm:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQbar</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">()</span>
<span class="go">[   0.2500000000000000?  0.4330127018922193?*I]</span>
<span class="go">[-0.4330127018922193?*I     0.750000000000000?]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;exactconj&quot;</span><span class="p">)</span>
<span class="go">[                   1/4  0.4330127018922193?*I]</span>
<span class="go">[-0.4330127018922193?*I                    3/4]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">*</span> <span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;exact&quot;</span><span class="p">)</span>
<span class="go">[                -1/2 0.866025403784439?*I]</span>
<span class="go">[0.866025403784439?*I                  3/2]</span>
</pre></div>
</div>
<p>For an invertible matrix, the pseudoinverse is just the
inverse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="o">~</span><span class="n">M</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">()</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
</pre></div>
</div>
<p>Numpy gives a strange answer due to rounding errors:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">pseudoinverse</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;numpy&quot;</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">[-1286742750677287/643371375338643 1000799917193445/1000799917193444]</span>
<span class="go">[  519646110850445/346430740566963  -300239975158034/600479950316067]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.randomize">
<code class="descname">randomize</code><span class="sig-paren">(</span><em>density=1</em>, <em>nonzero=False</em>, <em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.randomize" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace a proportion of the entries of a matrix by random elements,
leaving the remaining entries unchanged.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The locations of the entries of the matrix to change are
determined randomly, with the total number of locations
determined by the <code class="docutils literal notranslate"><span class="pre">density</span></code> keyword. These locations
are not guaranteed to be distinct.  So it is possible
that the same position can be chosen multiple times,
especially for a very small matrix.  The exception is
when <code class="docutils literal notranslate"><span class="pre">density</span> <span class="pre">=</span> <span class="pre">1</span></code>, in which case every entry of the
matrix will be changed.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">density</span></code> - <code class="docutils literal notranslate"><span class="pre">float</span></code> (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>); upper bound for the
proportion of entries that are changed</li>
<li><code class="docutils literal notranslate"><span class="pre">nonzero</span></code> - Bool (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, then new
entries will be nonzero</li>
<li><code class="docutils literal notranslate"><span class="pre">*args,</span> <span class="pre">**kwds</span></code> - Remaining parameters may be passed to the
<code class="docutils literal notranslate"><span class="pre">random_element</span></code> function of the base ring</li>
</ul>
<p>EXAMPLES:</p>
<p>We construct the zero matrix over a polynomial ring.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
</pre></div>
</div>
<p>We then randomize roughly half the entries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[                     0                      0                      0]</span>
<span class="go">[                     0                      0       1/2*x^2 - x - 12]</span>
<span class="go">[1/2*x^2 - 1/95*x - 1/2                      0                      0]</span>
</pre></div>
</div>
<p>Now we randomize all the entries of the resulting matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">randomize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[                     0 -5/2*x^2 + 2/3*x - 1/4           -x^2 + 2/3*x]</span>
<span class="go">[                     1        x^2 + 1/3*x - 1                     -1]</span>
<span class="go">[                    -1       -x^2 - 1/4*x + 1                  -1/14]</span>
</pre></div>
</div>
<p>We create the zero matrix over the integers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
<p>Then we randomize it; the <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> keywords, which determine the
size of the random elements, are passed on to the <code class="docutils literal notranslate"><span class="pre">random_element</span></code>
method for <code class="docutils literal notranslate"><span class="pre">ZZ</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">2</span><span class="o">^</span><span class="mi">64</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">[-3789934696463997112 -3775200185786627805]</span>
<span class="go">[-8014573080042851913  7914454492632997238]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.rational_form">
<code class="descname">rational_form</code><span class="sig-paren">(</span><em>format='right'</em>, <em>subdivide=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.rational_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rational canonical form, also known as Frobenius form.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix with entries from an exact field.</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - default: ‘right’ - one of ‘right’, ‘bottom’,
‘left’, ‘top’ or ‘invariants’.  The first four will cause a
matrix to be returned with companion matrices dictated by the
keyword.  The value ‘invariants’ will cause a list of lists to
be returned, where each list contains coefficients of a
polynomial associated with a companion matrix.</li>
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - default: ‘True’ - if ‘True’ and a matrix is
returned, then it contains subdivisions delineating the
companion matrices along the diagonal.</li>
</ul>
<p>OUTPUT:</p>
<p>The rational form of a matrix is a similar matrix composed of
submatrices (“blocks”) placed on the main diagonal.  Each block
is a companion matrix.  Associated with each companion matrix is a
polynomial.  In rational form, the polynomial of one block will
divide the polynomial of the next block (and thus, the polynomials
of all subsequent blocks).</p>
<p>Rational form, also known as Frobenius form, is a canonical form.
In other words, two matrices are similar if and only if their
rational canonical forms are equal.  The algorithm used does not
provide the similarity transformation matrix (also known as the
change-of-basis matrix).</p>
<p>Companion matrices may be written in one of four styles, and any
such style may be selected with the <code class="docutils literal notranslate"><span class="pre">format</span></code> keyword.  See the
companion matrix constructor,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.matrix.constructor.companion_matrix()</span></code>,
for more information about companion matrices.</p>
<p>If the ‘invariants’ value is used for the <code class="docutils literal notranslate"><span class="pre">format</span></code> keyword,
then the return value is a list of lists, where each list is the
coefficients of the polynomial associated with one of the companion
matrices on the diagonal.  These coefficients include the leading
one of the monic polynomial and are ready to be coerced into
any polynomial ring over the same field (see examples of this below).
This return value is intended to be the most compact representation
and the easiest to use for testing equality of rational forms.</p>
<p>Because the minimal and characteristic polynomials of a companion
matrix are the associated polynomial, it is easy to see that the
product of the polynomials of the blocks will be the characteristic
polynomial and the final polynomial will be the minimal polynomial
of the entire matrix.</p>
<p>ALGORITHM:</p>
<p>We begin with ZigZag form, which is due to Arne Storjohann
and is documented at <a class="reference internal" href="#sage.matrix.matrix2.Matrix.zigzag_form" title="sage.matrix.matrix2.Matrix.zigzag_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">zigzag_form()</span></code></a>.  Then we eliminate
‘’corner’’ entries enroute to rational form via an additional
algorithm of Storjohann’s <a class="reference internal" href="../../../references/index.html#sto2011" id="id8">[Sto2011]</a>.</p>
<p>EXAMPLES:</p>
<p>The lists of coefficients returned with the <code class="docutils literal notranslate"><span class="pre">invariants</span></code> keyword
are designed to easily convert to the polynomials associated with
the companion matrices.  This is illustrated by the construction
below of the <code class="docutils literal notranslate"><span class="pre">polys</span></code> list.  Then we can test the divisibility
condition on the list of polynomials. Also the minimal and
characteristic polynomials are easy to determine from this list.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">11</span><span class="p">,</span>  <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">38</span><span class="p">,</span> <span class="o">-</span><span class="mi">29</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span>  <span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">63</span><span class="p">,</span>  <span class="mi">17</span><span class="p">,</span>  <span class="mi">24</span><span class="p">,</span>  <span class="mi">36</span><span class="p">,</span>  <span class="mi">32</span><span class="p">],</span>
<span class="go">....:                 [ 18,   6, -17, -11, -31, -43, 12,  26,   0, -69,  11,  13,  17,  24],</span>
<span class="go">....:                 [ 11,  16, -22,  -8, -48, -34,  0,  31,  16, -82,  26,  31,  39,  37],</span>
<span class="go">....:                 [ -8, -18,  22,  10,  46,  33,  3, -27, -12,  70, -19, -20, -42, -31],</span>
<span class="go">....:                 [-13, -21,  16,  10,  52,  43,  4, -28, -25,  89, -37, -20, -53, -62],</span>
<span class="go">....:                 [ -2,  -6,   0,   0,   6,  10,  1,   1,  -7,  14, -11,  -3, -10, -18],</span>
<span class="go">....:                 [ -9, -19,  -3,   4,  23,  30,  8,  -3, -27,  55, -40,  -5, -40, -69],</span>
<span class="go">....:                 [  4,  -8,  -1,  -1,   5,  -4,  9,   5, -11,   4, -14,  -2, -13, -17],</span>
<span class="go">....:                 [  1,  -2,  16,  -1,  19,  -2, -1, -17,   2,  19,   5, -25,  -7,  14],</span>
<span class="go">....:                 [  7,   7, -13,  -4, -26,  -21, 3,  18,   5, -40,   7,  15,  20,  14],</span>
<span class="go">....:                 [ -6,  -7, -12,   4,  -1,  18,  3,   8, -11,  15, -18,  17, -15, -41],</span>
<span class="go">....:                 [  5,  11, -11,  -3, -26, -19, -1,  14,  10, -42,  14,  17,  25,  23],</span>
<span class="go">....:                 [-16, -15,   3,  10,  29,  45, -1, -13, -19,  71, -35,  -2, -35, -65],</span>
<span class="go">....:                 [  4,   2,   3,  -2,  -2, -10,  1,   0,   3, -11,   6,  -4,   6,  17]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[   0   -4|   0    0    0    0|   0    0    0    0    0    0    0    0]</span>
<span class="go">[   1    4|   0    0    0    0|   0    0    0    0    0    0    0    0]</span>
<span class="go">[---------+-------------------+---------------------------------------]</span>
<span class="go">[   0    0|   0    0    0   12|   0    0    0    0    0    0    0    0]</span>
<span class="go">[   0    0|   1    0    0   -4|   0    0    0    0    0    0    0    0]</span>
<span class="go">[   0    0|   0    1    0   -9|   0    0    0    0    0    0    0    0]</span>
<span class="go">[   0    0|   0    0    1    6|   0    0    0    0    0    0    0    0]</span>
<span class="go">[---------+-------------------+---------------------------------------]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    0    0    0    0    0 -216]</span>
<span class="go">[   0    0|   0    0    0    0|   1    0    0    0    0    0    0  108]</span>
<span class="go">[   0    0|   0    0    0    0|   0    1    0    0    0    0    0  306]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    1    0    0    0    0 -271]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    0    1    0    0    0  -41]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    0    0    1    0    0  134]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    0    0    0    1    0  -64]</span>
<span class="go">[   0    0|   0    0    0    0|   0    0    0    0    0    0    1   13]</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">invariants</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;invariants&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">invariants</span>
<span class="go">[[4, -4, 1], [-12, 4, 9, -6, 1], [216, -108, -306, 271, 41, -134, 64, -13, 1]]</span>
<span class="gp">sage: </span><span class="n">polys</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">invariants</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">]</span>
<span class="go">[(x - 2)^2, (x - 3) * (x + 1) * (x - 2)^2, (x + 1)^2 * (x - 3)^3 * (x - 2)^3]</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">polys</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">polys</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">polys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">polys</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">(</span><span class="n">var</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Rational form is a canonical form.  Any two matrices are similar
if and only if their rational forms are equal.  By starting with
Jordan canonical forms, the matrices <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">D</span></code> below were
built as similar matrices, while <code class="docutils literal notranslate"><span class="pre">E</span></code> was built to be just
slightly different.  All three matrices have equal characteristic
polynomials though <code class="docutils literal notranslate"><span class="pre">E</span></code>’s minimal polynomial differs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span>  <span class="mi">13</span><span class="p">,</span>  <span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">],</span>
<span class="go">....:                 [0,  48, -16, -16, -188,  20,  92, -16],</span>
<span class="go">....:                 [0,   9,  -1,   2,  -33,   5,  18,   0],</span>
<span class="go">....:                 [0,  15,  -5,   0,  -59,   7,  30,  -4],</span>
<span class="go">....:                 [0, -21,   7,   2,   84, -10, -42,   5],</span>
<span class="go">....:                 [0, -42,  14,   8,  167, -17, -84,  13],</span>
<span class="go">....:                 [0, -50,  17,  10,  199, -23, -98,  14],</span>
<span class="go">....:                 [0,  15,  -5,  -2,  -59,   7,  30, -2]])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^2</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^8</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[ 0 -4| 0  0| 0  0| 0  0]</span>
<span class="go">[ 1  4| 0  0| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0 -4| 0  0| 0  0]</span>
<span class="go">[ 0  0| 1  4| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0 -4| 0  0]</span>
<span class="go">[ 0  0| 0  0| 1  4| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0  0| 0 -4]</span>
<span class="go">[ 0  0| 0  0| 0  0| 1  4]</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">3</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">5</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>   <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [ -6,   5,    7,   2,  -4,   5,    7,   -3],</span>
<span class="go">....:                 [ 21, -12,   89,  25,   8,  27,   98,  -95],</span>
<span class="go">....:                 [ -9,   5,  -44, -11,  -3, -13,  -48,   47],</span>
<span class="go">....:                 [ 23, -13,   74,  21,  12,  22,   85,  -84],</span>
<span class="go">....:                 [ 31, -18,  135,  38,  12,  47,  155, -147],</span>
<span class="go">....:                 [-33,  19, -138, -39, -13, -45, -156,  151],</span>
<span class="go">....:                 [ -7,   4,  -29,  -8,  -3, -10,  -34,  34]])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^8</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[ 0 -4| 0  0| 0  0| 0  0]</span>
<span class="go">[ 1  4| 0  0| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0 -4| 0  0| 0  0]</span>
<span class="go">[ 0  0| 1  4| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0 -4| 0  0]</span>
<span class="go">[ 0  0| 0  0| 1  4| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0  0| 0 -4]</span>
<span class="go">[ 0  0| 0  0| 0  0| 1  4]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span>   <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>   <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">11</span><span class="p">],</span>
<span class="go">....:                 [-2, -4,   2, -4, -2,   4, -2,   6],</span>
<span class="go">....:                 [ 5, 14,  -7, 12,  3,  -8,  6, -27],</span>
<span class="go">....:                 [-3, -8,   7, -5,  0,   2, -6,  17],</span>
<span class="go">....:                 [ 0,  5,   0,  2,  4,  -4,  1,   2],</span>
<span class="go">....:                 [-3, -7,   5, -6, -1,   5, -4,  14],</span>
<span class="go">....:                 [ 6, 18, -10, 14,  4, -10, 10, -28],</span>
<span class="go">....:                 [-2, -6,   4, -5, -1,   3,  -3, 13]])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x - 2)^8</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[  2|  0   0|  0   0|  0   0   0]</span>
<span class="go">[---+-------+-------+-----------]</span>
<span class="go">[  0|  0  -4|  0   0|  0   0   0]</span>
<span class="go">[  0|  1   4|  0   0|  0   0   0]</span>
<span class="go">[---+-------+-------+-----------]</span>
<span class="go">[  0|  0   0|  0  -4|  0   0   0]</span>
<span class="go">[  0|  0   0|  1   4|  0   0   0]</span>
<span class="go">[---+-------+-------+-----------]</span>
<span class="go">[  0|  0   0|  0   0|  0   0   8]</span>
<span class="go">[  0|  0   0|  0   0|  1   0 -12]</span>
<span class="go">[  0|  0   0|  0   0|  0   1   6]</span>
</pre></div>
</div>
<p>The principal feature of rational canonical form is that it
can be computed over any field using only field operations.  Other
forms, such as Jordan canonical form, are complicated by the need to
determine the eigenvalues of the matrix, which can lie outside
the field.  The following matrix has all of its eigenvalues
outside the rationals - some are irrational (<span class="math notranslate nohighlight">\(\pm\sqrt{2}\)</span>) and
the rest are complex (<span class="math notranslate nohighlight">\(-1\pm 2i\)</span>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span>
<span class="go">....: [[-154,  -3,  -54,   44,   48, -244,  -19,   67, -326,   85,   355,   581],</span>
<span class="go">....:  [ 504,  25,  156, -145, -171,  793,   99, -213, 1036, -247, -1152, -1865],</span>
<span class="go">....:  [ 294,  -1,  112,  -89,  -90,  469,   36, -128,  634, -160,  -695, -1126],</span>
<span class="go">....:  [ -49,  -32,  25,    7,   37,  -64,  -58,   12,  -42,  -14,    72,   106],</span>
<span class="go">....:  [-261, -123,  65,   47,  169, -358, -254,   70, -309,  -29,   454,   673],</span>
<span class="go">....:  [-448, -123, -10,  109,  227, -668, -262,  163, -721,   95,   896,  1410],</span>
<span class="go">....:  [  38,    7,   8,  -14,  -17,   66,    6,  -23,   73,  -29,   -78,  -143],</span>
<span class="go">....:  [ -96,   10, -55,   37,   24, -168,   17,   56, -231,   88,   237,   412],</span>
<span class="go">....:  [ 310,   67,  31,  -81, -143,  473,  143, -122,  538,  -98,  -641, -1029],</span>
<span class="go">....:  [ 139,  -35,  99,  -49,  -18,  236,  -41,  -70,  370, -118,  -377,  -619],</span>
<span class="go">....:  [ 243,    9,  81,  -72,  -81,  386,   43, -105,  508, -124,  -564,  -911],</span>
<span class="go">....:  [-155,   -3, -55,   45,   50, -245,  -27,   65, -328,   77,   365,  583]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x^2 - 2)^2 * (x^2 + 2*x + 5)^4</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[  0  -5|  0   0   0   0|  0   0   0   0   0   0]</span>
<span class="go">[  1  -2|  0   0   0   0|  0   0   0   0   0   0]</span>
<span class="go">[-------+---------------+-----------------------]</span>
<span class="go">[  0   0|  0   0   0  10|  0   0   0   0   0   0]</span>
<span class="go">[  0   0|  1   0   0   4|  0   0   0   0   0   0]</span>
<span class="go">[  0   0|  0   1   0  -3|  0   0   0   0   0   0]</span>
<span class="go">[  0   0|  0   0   1  -2|  0   0   0   0   0   0]</span>
<span class="go">[-------+---------------+-----------------------]</span>
<span class="go">[  0   0|  0   0   0   0|  0   0   0   0   0  50]</span>
<span class="go">[  0   0|  0   0   0   0|  1   0   0   0   0  40]</span>
<span class="go">[  0   0|  0   0   0   0|  0   1   0   0   0   3]</span>
<span class="go">[  0   0|  0   0   0   0|  0   0   1   0   0 -12]</span>
<span class="go">[  0   0|  0   0   0   0|  0   0   0   1   0 -12]</span>
<span class="go">[  0   0|  0   0   0   0|  0   0   0   0   1  -4]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">polys</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;invariants&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">F</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">]</span>
<span class="go">[x^2 + 2*x + 5, (x^2 - 2) * (x^2 + 2*x + 5), (x^2 - 2) * (x^2 + 2*x + 5)^2]</span>
</pre></div>
</div>
<p>Rational form may be computed over any field.  The matrix below is
an example where the eigenvalues lie outside the field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span>
<span class="go">....: [[5*a + 3, 4*a + 1, 6*a + 2, 2*a + 5,       6, 4*a + 5, 4*a + 5,       5,   a + 6,      5,  4*a + 4],</span>
<span class="go">....:  [6*a + 3, 2*a + 4,       0,       6, 5*a + 5,     2*a, 5*a + 1,       1, 5*a + 2,     4*a, 5*a + 6],</span>
<span class="go">....:  [3*a + 1, 6*a + 6,   a + 6,       2,       0, 3*a + 6, 5*a + 4, 5*a + 6, 5*a + 2,       3, 4*a + 2],</span>
<span class="go">....:  [    3*a,     6*a,     3*a,     4*a, 4*a + 4, 3*a + 6,     6*a,       4, 3*a + 4, 6*a + 2,     4*a],</span>
<span class="go">....:  [4*a + 5,   a + 1, 4*a + 3, 6*a + 5, 5*a + 2, 5*a + 2,     6*a, 4*a + 6, 6*a + 4, 5*a + 3, 3*a + 1],</span>
<span class="go">....:  [    3*a,     6*a, 4*a + 1, 6*a + 2, 2*a + 5, 4*a + 6,       2,   a + 5, 2*a + 4, 2*a + 1, 2*a + 1],</span>
<span class="go">....:  [4*a + 5, 3*a + 3,       6, 4*a + 1, 4*a + 3, 6*a + 3,       6, 3*a + 3,       3,   a + 3,       0],</span>
<span class="go">....:  [6*a + 6,   a + 4, 2*a + 6, 3*a + 5, 4*a + 3,       2,       a, 3*a + 4,     5*a, 2*a + 5, 4*a + 3],</span>
<span class="go">....:  [3*a + 5, 6*a + 2,     4*a,   a + 5,       0,     5*a, 6*a + 5, 2*a + 1, 3*a + 1, 3*a + 5, 4*a + 2],</span>
<span class="go">....:  [3*a + 2,   a + 3, 3*a + 6,       a, 3*a + 5, 5*a + 1, 3*a + 2,   a + 3,   a + 2, 6*a + 1, 3*a + 3],</span>
<span class="go">....:  [6*a + 6, 5*a + 1,     4*a,       2, 5*a + 5, 3*a + 5, 3*a + 1,     2*a,     2*a, 2*a + 4, 4*a + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">()</span>
<span class="go">[  a + 2|      0       0       0|      0       0       0       0       0       0       0]</span>
<span class="go">[-------+-----------------------+-------------------------------------------------------]</span>
<span class="go">[      0|      0       0   a + 6|      0       0       0       0       0       0       0]</span>
<span class="go">[      0|      1       0 6*a + 4|      0       0       0       0       0       0       0]</span>
<span class="go">[      0|      0       1 6*a + 4|      0       0       0       0       0       0       0]</span>
<span class="go">[-------+-----------------------+-------------------------------------------------------]</span>
<span class="go">[      0|      0       0       0|      0       0       0       0       0       0     2*a]</span>
<span class="go">[      0|      0       0       0|      1       0       0       0       0       0 6*a + 3]</span>
<span class="go">[      0|      0       0       0|      0       1       0       0       0       0 6*a + 1]</span>
<span class="go">[      0|      0       0       0|      0       0       1       0       0       0   a + 2]</span>
<span class="go">[      0|      0       0       0|      0       0       0       1       0       0   a + 6]</span>
<span class="go">[      0|      0       0       0|      0       0       0       0       1       0 2*a + 1]</span>
<span class="go">[      0|      0       0       0|      0       0       0       0       0       1 2*a + 1]</span>
<span class="gp">sage: </span><span class="n">invariants</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;invariants&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">invariants</span>
<span class="go">[[6*a + 5, 1], [6*a + 1, a + 3, a + 3, 1], [5*a, a + 4, a + 6, 6*a + 5, 6*a + 1, 5*a + 6, 5*a + 6, 1]]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">polys</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">invariants</span><span class="p">]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">polys</span><span class="p">]</span>
<span class="go">[x + 6*a + 5, (x + 6*a + 5) * (x^2 + (2*a + 5)*x + 5*a), (x + 6*a + 5) * (x^2 + (2*a + 5)*x + 5*a)^3]</span>
<span class="gp">sage: </span><span class="n">polys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">polys</span><span class="p">)</span> <span class="o">==</span> <span class="n">A</span><span class="o">.</span><span class="n">characteristic_polynomial</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">algebraic closures of finite fields are only implemented for prime fields</span>
</pre></div>
</div>
<p>Companion matrices may be selected as any one of four different types.
See the documentation for the companion matrix constructor,
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.matrix.constructor.companion_matrix()</span></code>, for more information.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">35</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span>
<span class="go">....:                 [22, -22, 12, -16],</span>
<span class="go">....:                 [ 5, -12, 12,   4],</span>
<span class="go">....:                 [16,  -6, -4, -23]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">[ 2| 0  0  0]</span>
<span class="go">[--+--------]</span>
<span class="go">[ 0| 0  0 10]</span>
<span class="go">[ 0| 1  0 -1]</span>
<span class="go">[ 0| 0  1  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="go">[ 2| 0  0  0]</span>
<span class="go">[--+--------]</span>
<span class="go">[ 0| 0  1  0]</span>
<span class="go">[ 0| 0  0  1]</span>
<span class="go">[ 0|10 -1  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">[ 2| 0  0  0]</span>
<span class="go">[--+--------]</span>
<span class="go">[ 0| 0  1  0]</span>
<span class="go">[ 0|-1  0  1]</span>
<span class="go">[ 0|10  0  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rational_form</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">)</span>
<span class="go">[ 2| 0  0  0]</span>
<span class="go">[--+--------]</span>
<span class="go">[ 0| 0 -1 10]</span>
<span class="go">[ 0| 1  0  0]</span>
<span class="go">[ 0| 0  1  0]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-06-09)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.restrict">
<code class="descname">restrict</code><span class="sig-paren">(</span><em>V</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.restrict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix that defines the action of self on the chosen
basis for the invariant subspace V. If V is an ambient, returns
self (not a copy of self).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> - vector subspace</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> - (optional) default: True; if False may
not check that V is invariant (hence can be faster).</li>
</ul>
<p>OUTPUT: a matrix</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function returns an nxn matrix, where V has dimension
n. It does <em>not</em> check that V is in fact invariant under
self, unless check is True.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">VectorSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">M</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">subspace</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
</pre></div>
</div>
<p>We illustrate the warning about invariance not being checked by
default, by giving a non-invariant subspace. With the default
check=False this function returns the ‘restriction’ matrix, which
is meaningless as check=True reveals.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W2</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">subspace</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">W2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">subspace is not invariant under matrix</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.restrict_codomain">
<code class="descname">restrict_codomain</code><span class="sig-paren">(</span><em>V</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.restrict_codomain" title="Permalink to this definition">¶</a></dt>
<dd><p>Suppose that self defines a linear map from some domain to a
codomain that contains <span class="math notranslate nohighlight">\(V\)</span> and that the image of self is
contained in <span class="math notranslate nohighlight">\(V\)</span>. This function returns a new matrix
<span class="math notranslate nohighlight">\(A\)</span> that represents this linear map but as a map to
<span class="math notranslate nohighlight">\(V\)</span>, in the sense that if <span class="math notranslate nohighlight">\(x\)</span> is in the domain,
then <span class="math notranslate nohighlight">\(xA\)</span> is the linear combination of the elements of the
basis of <span class="math notranslate nohighlight">\(V\)</span> that equals v*self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> - vector space (space of degree
<code class="docutils literal notranslate"><span class="pre">self.ncols()</span></code>) that contains the image of self.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.restrict" title="sage.matrix.matrix2.Matrix.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restrict()</span></code></a>, <a class="reference internal" href="#sage.matrix.matrix2.Matrix.restrict_domain" title="sage.matrix.matrix2.Matrix.restrict_domain"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restrict_domain()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">9</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">(</span><span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">span</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]);</span> <span class="n">V</span>
<span class="go">Vector space of degree 3 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">restrict_codomain</span><span class="p">(</span><span class="n">V</span><span class="p">);</span> <span class="n">B</span>
<span class="go">[1 2]</span>
<span class="go">[4 5]</span>
<span class="go">[7 8]</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">*</span><span class="n">B</span>
<span class="go">(44, 52)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">*</span><span class="n">A</span>
<span class="go">(44, 52, 60)</span>
<span class="gp">sage: </span><span class="mi">44</span><span class="o">*</span><span class="n">V</span><span class="o">.</span><span class="mi">0</span> <span class="o">+</span> <span class="mi">52</span><span class="o">*</span><span class="n">V</span><span class="o">.</span><span class="mi">1</span>
<span class="go">(44, 52, 60)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.restrict_domain">
<code class="descname">restrict_domain</code><span class="sig-paren">(</span><em>V</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.restrict_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the matrix relative to the basis for V on the domain
obtained by restricting self to V, but not changing the codomain of
the matrix. This is the matrix whose rows are the images of the
basis for V.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">V</span></code> - vector space (subspace of ambient space on
which self acts)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.restrict" title="sage.matrix.matrix2.Matrix.restrict"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restrict()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">W</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">subspace</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="go">[1 2 0]</span>
<span class="go">[3 4 0]</span>
<span class="gp">sage: </span><span class="n">W2</span> <span class="o">=</span> <span class="n">V</span><span class="o">.</span><span class="n">subspace_with_basis</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">restrict_domain</span><span class="p">(</span><span class="n">W2</span><span class="p">)</span>
<span class="go">[ 1  2  0]</span>
<span class="go">[ 7 10  0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_eigenmatrix">
<code class="descname">right_eigenmatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_eigenmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return matrices D and P, where D is a diagonal matrix of
eigenvalues and P is the corresponding matrix where the columns are
corresponding eigenvectors (or zero vectors) so that self*P =
P*D.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[                  0                   0                   0]</span>
<span class="go">[                  0 -1.348469228349535?                   0]</span>
<span class="go">[                  0                   0  13.34846922834954?]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[                   1                    1                    1]</span>
<span class="go">[                  -2  0.1303061543300932?   3.069693845669907?]</span>
<span class="go">[                   1 -0.7393876913398137?   5.139387691339814?]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Because P is invertible, A is diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="p">(</span><span class="o">~</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The matrix P may contain zero columns corresponding to eigenvalues
for which the algebraic multiplicity is greater than the geometric
multiplicity. In these cases, the matrix is not diagonalizable.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">A</span>
<span class="go">[2 1 0]</span>
<span class="go">[0 2 1]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">jordan_block</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">[2 0 0]</span>
<span class="go">[0 2 0]</span>
<span class="go">[0 0 2]</span>
<span class="gp">sage: </span><span class="n">P</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span> <span class="o">==</span> <span class="n">P</span><span class="o">*</span><span class="n">D</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_eigenspaces">
<code class="descname">right_eigenspaces</code><span class="sig-paren">(</span><em>format='all'</em>, <em>var='a'</em>, <em>algebraic_multiplicity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_eigenspaces" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the right eigenspaces of a matrix.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">eigenspaces_right()</span></code> and <code class="docutils literal notranslate"><span class="pre">right_eigenspaces()</span></code>
are identical methods.  Here “right” refers to the eigenvectors
being placed to the right of the matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix over an exact field.  For inexact
matrices consult the numerical or symbolic matrix classes.</li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code> - default: <code class="docutils literal notranslate"><span class="pre">None</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">'all'</span></code> - attempts to create every eigenspace.  This will
always be possible for matrices with rational entries.</li>
<li><code class="docutils literal notranslate"><span class="pre">'galois'</span></code> - for each irreducible factor of the characteristic
polynomial, a single eigenspace will be output for a
single root/eigenvalue for the irreducible factor.</li>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> - Uses the ‘all’ format if the base ring is contained
in an algebraically closed field which is implemented.
Otherwise, uses the ‘galois’ format.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">var</span></code> - default: ‘a’ - variable name used to
represent elements of the root field of each
irreducible factor of the characteristic polynomial.
If var=’a’, then the root fields will be in terms of
a0, a1, a2, …., where the numbering runs across all
the irreducible factors of the characteristic polynomial,
even for linear factors.</li>
<li><code class="docutils literal notranslate"><span class="pre">algebraic_multiplicity</span></code> - default: False - whether or
not to include the algebraic multiplicity of each eigenvalue
in the output.  See the discussion below.</li>
</ul>
<p>OUTPUT:</p>
<p>If algebraic_multiplicity=False, return a list of pairs (e, V)
where e is an eigenvalue of the matrix, and V is the corresponding
left eigenspace.  For Galois conjugates of eigenvalues, there
may be just one representative eigenspace, depending on the
<code class="docutils literal notranslate"><span class="pre">format</span></code> keyword.</p>
<p>If algebraic_multiplicity=True, return a list of triples (e, V, n)
where e and V are as above and n is the algebraic multiplicity of
the eigenvalue.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Uses a somewhat naive algorithm (simply factors the
characteristic polynomial and computes kernels directly
over the extension field).</p>
</div>
<p>EXAMPLES:</p>
<p>Right eigenspaces are computed from the left eigenspaces of the
transpose of the matrix.  As such, there is a greater collection
of illustrative examples at the <a class="reference internal" href="#sage.matrix.matrix2.Matrix.eigenspaces_left" title="sage.matrix.matrix2.Matrix.eigenspaces_left"><code class="xref py py-meth docutils literal notranslate"><span class="pre">eigenspaces_left()</span></code></a>.</p>
<p>We compute the right eigenspaces of a <span class="math notranslate nohighlight">\(3\times 3\)</span> rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span> <span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(-1.348469228349535?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                   1  0.1303061543300932? -0.7393876913398137?]),</span>
<span class="go">(13.34846922834954?, Vector space of degree 3 and dimension 1 over Algebraic Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[                 1 3.069693845669907? 5.139387691339814?])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5])</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">,</span> <span class="n">algebraic_multiplicity</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">es</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1], 1),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5], 1)</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="n">e</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="n">v</span><span class="o">*</span><span class="n">e</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">v</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same computation, but with implicit base change to a field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">(</span><span class="n">format</span><span class="o">=</span><span class="s1">&#39;galois&#39;</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(0, Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]),</span>
<span class="go">(a1, Vector space of degree 3 and dimension 1 over Number Field in a1 with defining polynomial x^2 - 12*x - 18</span>
<span class="go">User basis matrix:</span>
<span class="go">[           1 1/5*a1 + 2/5 2/5*a1 - 1/5])</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This method is only applicable to exact matrices.
The “eigenmatrix” routines for matrices with double-precision
floating-point entries (<code class="docutils literal notranslate"><span class="pre">RDF</span></code>, <code class="docutils literal notranslate"><span class="pre">CDF</span></code>) are the best
alternative.  (Since some platforms return eigenvectors
that are the negatives of those given here, this one example
is not tested here.)  There are also “eigenmatrix” routines for
matrices with symbolic entries.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">RR</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">eigenspaces_right</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">eigenspaces cannot be computed reliably for inexact rings such as Real Field with 53 bits of precision,</span>
<span class="go">consult numerical or symbolic matrix classes for other options</span>

<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">RDF</span><span class="p">)</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span><span class="o">.</span><span class="n">dense_matrix</span><span class="p">()</span> <span class="c1"># abs tol 1e-13</span>
<span class="go">[13.348469228349522                0.0                0.0]</span>
<span class="go">[               0.0 -1.348469228349534                0.0]</span>
<span class="go">[               0.0                0.0                0.0]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span> <span class="c1"># not tested</span>
<span class="go">[ 0.164763817...  0.799699663...  0.408248290...]</span>
<span class="go">[ 0.505774475...  0.104205787... -0.816496580...]</span>
<span class="go">[ 0.846785134... -0.591288087...  0.408248290...]</span>

<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">em</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">eigenmatrix_right</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="n">eigenvalues</span>
<span class="go">[3/2*x^2 + 1/2*x - 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)                                                       0]</span>
<span class="go">[                                                      0 3/2*x^2 + 1/2*x + 1/2*sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2)]</span>
<span class="gp">sage: </span><span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">em</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="n">eigenvectors</span>
<span class="go">[                                                    1                                                     1]</span>
<span class="go">[1/2*(3*x^2 - x - sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y 1/2*(3*x^2 - x + sqrt(9*x^4 - 6*x^3 + x^2 + 4*y^2))/y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_eigenvectors">
<code class="descname">right_eigenvectors</code><span class="sig-paren">(</span><em>extend=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_eigenvectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the right eigenvectors of a matrix.</p>
<p>For each distinct eigenvalue, returns a list of the form (e,V,n)
where e is the eigenvalue, V is a list of eigenvectors forming a
basis for the corresponding right eigenspace, and n is the
algebraic multiplicity of the eigenvalue. If <code class="docutils literal notranslate"><span class="pre">extend</span> <span class="pre">=</span> <span class="pre">True</span></code>
(the default), this will return eigenspaces over the algebraic
closure of the base field where this is implemented; otherwise
it will restrict to eigenvalues in the base field.</p>
<p>EXAMPLES: We compute the right eigenvectors of a
<span class="math notranslate nohighlight">\(3\times 3\)</span> rational matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">es</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_right</span><span class="p">();</span> <span class="n">es</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1),</span>
<span class="go">(-1.348469228349535?, [(1, 0.1303061543300932?, -0.7393876913398137?)], 1),</span>
<span class="go">(13.34846922834954?, [(1, 3.069693845669907?, 5.139387691339814?)], 1)]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvectors_right</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, [</span>
<span class="go">(1, -2, 1)</span>
<span class="go">], 1)]</span>
<span class="gp">sage: </span><span class="nb">eval</span><span class="p">,</span> <span class="p">[</span><span class="n">evec</span><span class="p">],</span> <span class="n">mult</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">delta</span> <span class="o">=</span> <span class="nb">eval</span><span class="o">*</span><span class="n">evec</span> <span class="o">-</span> <span class="n">A</span><span class="o">*</span><span class="n">evec</span>
<span class="gp">sage: </span><span class="nb">abs</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">delta</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-10</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_kernel">
<code class="descname">right_kernel</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the right kernel of this matrix, as a vector space or
free module. This is the set of vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> such that <code class="docutils literal notranslate"><span class="pre">self*x</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the left kernel, use <a class="reference internal" href="#sage.matrix.matrix2.Matrix.left_kernel" title="sage.matrix.matrix2.Matrix.left_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">left_kernel()</span></code></a>.  The method
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.kernel" title="sage.matrix.matrix2.Matrix.kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">kernel()</span></code></a> is exactly equal to <a class="reference internal" href="#sage.matrix.matrix2.Matrix.left_kernel" title="sage.matrix.matrix2.Matrix.left_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">left_kernel()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - default: ‘default’ - a keyword that selects the
algorithm employed.  Allowable values are:<ul>
<li>‘default’ - allows the algorithm to be chosen automatically</li>
<li>‘generic’ - naive algorithm usable for matrices over any field</li>
<li>‘flint’ - FLINT library code for matrices over the rationals
or the integers</li>
<li>‘pari’ - PARI library code for matrices over number fields
or the integers</li>
<li>‘padic’ - padic algorithm from IML library for matrices
over the rationals and integers</li>
<li>‘pluq’ - PLUQ matrix factorization for matrices mod 2</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">basis</span></code> - default: ‘echelon’ - a keyword that describes the
format of the basis used to construct the right kernel.
Allowable values are:<ul>
<li>‘echelon’: the basis matrix is returned in echelon form</li>
<li>‘pivot’ : each basis vector is computed from the reduced
row-echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> by placing a single one in a
non-pivot column and zeros in the remaining non-pivot columns.
Only available for matrices over fields.</li>
<li>‘LLL’: an LLL-reduced basis.  Only available for matrices
over the integers.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>A vector space or free module whose degree equals the number
of columns in <code class="docutils literal notranslate"><span class="pre">self</span></code> and which contains all the vectors <code class="docutils literal notranslate"><span class="pre">x</span></code>
such that <code class="docutils literal notranslate"><span class="pre">self*x</span> <span class="pre">=</span> <span class="pre">0</span></code>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has 0 columns, the kernel has dimension 0, while if
<code class="docutils literal notranslate"><span class="pre">self</span></code> has 0 rows the kernel is the entire ambient vector space.</p>
<p>The result is cached.  Requesting the right kernel a second time,
but with a different basis format, will return the cached result
with the format from the first computation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more detailed documentation on the selection of algorithms
used and a more flexible method for computing a basis matrix
for a right kernel (rather than computing a vector space), see
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel_matrix" title="sage.matrix.matrix2.Matrix.right_kernel_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel_matrix()</span></code></a>, which powers the computations for
this method.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [-1, 5, 2, 2, 1, -7, 5],</span>
<span class="go">....:                 [0, 0, -2, -3, -3, 8, -5],</span>
<span class="go">....:                 [-1, 5, 0, -1, -2, 1, 0]])</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">K</span>
<span class="go">Vector space of degree 7 and dimension 4 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0  0  0 -1 -1 -1]</span>
<span class="go">[ 0  1  0  0  5  5  5]</span>
<span class="go">[ 0  0  1  0 -1 -2 -3]</span>
<span class="go">[ 0  0  0  1  0  1  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The default is basis vectors that form a matrix in echelon form.
A “pivot basis” instead has a basis matrix where the columns of
an identity matrix are in the locations of the non-pivot columns
of the original matrix. This alternate format is available whenever
the base ring is a field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [-1, 5, 2, 2, 1, -7, 5],</span>
<span class="go">....:                 [0, 0, -2, -3, -3, 8, -5],</span>
<span class="go">....:                 [-1, 5, 0, -1, -2, 1, 0]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[ 1 -5  0  0  1  1 -1]</span>
<span class="go">[ 0  0  1  0  0 -1  1]</span>
<span class="go">[ 0  0  0  1  1 -2  1]</span>
<span class="go">[ 0  0  0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">nonpivots</span><span class="p">()</span>
<span class="go">(1, 4, 5, 6)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Vector space of degree 7 and dimension 4 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 5  1  0  0  0  0  0]</span>
<span class="go">[-1  0  0 -1  1  0  0]</span>
<span class="go">[-1  0  1  2  0  1  0]</span>
<span class="go">[ 1  0 -1 -1  0  0  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Matrices may have any field as a base ring.  Number fields are
computed by PARI library code, matrices over <span class="math notranslate nohighlight">\(GF(2)\)</span> are computed
by the M4RI library, and matrices over the rationals are computed by
the IML library.  For any of these specialized cases, general-purpose
code can be called instead with the keyword setting
<code class="docutils literal notranslate"><span class="pre">algorithm='generic'</span></code>.</p>
<p>Over an arbitrary field, with two basis formats.  Same vector space,
different bases.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">a</span><span class="p">,</span>     <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span>  <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="p">],</span>
<span class="go">....:                      [  a, a^4,   a+a^4,  a^4+a^8],</span>
<span class="go">....:                      [a^2, a^6, a^2+a^6, a^5+a^10]])</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">K</span>
<span class="go">Vector space of degree 4 and dimension 2 over Finite Field in a of size 5^2</span>
<span class="go">Basis matrix:</span>
<span class="go">[      1       0 3*a + 4 2*a + 2]</span>
<span class="go">[      0       1     2*a 3*a + 3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the following test, we have to force usage of
<a class="reference internal" href="matrix_generic_dense.html#sage.matrix.matrix_generic_dense.Matrix_generic_dense" title="sage.matrix.matrix_generic_dense.Matrix_generic_dense"><code class="xref py py-class docutils literal notranslate"><span class="pre">Matrix_generic_dense</span></code></a>,
since the option <code class="docutils literal notranslate"><span class="pre">basis</span> <span class="pre">=</span> <span class="pre">'pivot'</span></code> would simply yield the same
result as the previous test, if the optional meataxe package is
installed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.matrix.matrix_generic_dense</span> <span class="kn">import</span> <span class="n">Matrix_generic_dense</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix_generic_dense</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">parent</span><span class="p">(),</span> <span class="n">A</span><span class="o">.</span><span class="n">list</span><span class="p">(),</span> <span class="bp">False</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span> <span class="o">=</span> <span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">Vector space of degree 4 and dimension 2 over Finite Field in a of size 5^2</span>
<span class="go">User basis matrix:</span>
<span class="go">[      4       4       1       0]</span>
<span class="go">[  a + 2 3*a + 3       0       1]</span>
</pre></div>
</div>
<p>If the optional meataxe package is installed, we again have to make sure
to work with a copy of B that has the same type as <code class="docutils literal notranslate"><span class="pre">P.basis_matrix()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">B</span><span class="o">.</span><span class="n">list</span><span class="p">())</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over number fields, PARI is used by default, but general-purpose code
can be requested.  Same vector space, same bases, different code.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">-</span><span class="n">a</span><span class="p">,</span>     <span class="mi">15</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">],</span>
<span class="go">....:                [2+a,   a, -7 + 5*a, -3+3*a]])</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Vector space of degree 4 and dimension 2 over Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">Basis matrix:</span>
<span class="go">[                1                 0     7/88*a + 3/88 -3/176*a - 39/176]</span>
<span class="go">[                0                 1   -1/88*a - 13/88  13/176*a - 7/176]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Vector space of degree 4 and dimension 2 over Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">Basis matrix:</span>
<span class="go">[                1                 0     7/88*a + 3/88 -3/176*a - 39/176]</span>
<span class="go">[                0                 1   -1/88*a - 13/88  13/176*a - 7/176]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">==</span> <span class="n">G</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For matrices over the integers, several options are possible.
The basis can be an LLL-reduced basis or an echelon basis.
The pivot basis isnot available.  A heuristic will decide whether
to use a p-adic algorithm from the IML library or an algorithm
from the PARI library.  Note how specifying the algorithm can
mildly influence the LLL basis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">],</span>
<span class="go">....:                 [-1, 1, 0, -2, -7, -1, 6],</span>
<span class="go">....:                 [2, 0, 1, 0, 1, -5, -2],</span>
<span class="go">....:                 [-1, -1, -1, 3, 10, 10, -9],</span>
<span class="go">....:                 [-1, 2, 0, -3, -7, 1, 6]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">)</span>
<span class="go">Free module of degree 7 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1   5  -8   3  -1  -1  -1]</span>
<span class="go">[  0  11 -19   5  -2  -3  -3]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;LLL&#39;</span><span class="p">)</span>
<span class="go">Free module of degree 7 and rank 2 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 2 -1  3  1  0  1  1]</span>
<span class="go">[-5 -3  2 -5  1 -1 -1]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">pivot basis only available over a field, not over Integer Ring</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">Free module of degree 7 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1   5  -8   3  -1  -1  -1]</span>
<span class="go">[  0  11 -19   5  -2  -3  -3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;LLL&#39;</span><span class="p">)</span>
<span class="go">Free module of degree 7 and rank 2 over Integer Ring</span>
<span class="go">User basis matrix:</span>
<span class="go">[-2  1 -3 -1  0 -1 -1]</span>
<span class="go">[ 5  3 -2  5 -1  1  1]</span>
</pre></div>
</div>
<p>Besides the integers, rings may be as general as principal ideal
domains.  Results are then free modules.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                [y^3, y^2, 2*y^3]])</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Free module of degree 3 and rank 1 over Univariate Polynomial Ring in y over Rational Field</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[-1 -y  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">basis_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It is possible to compute a kernel for a matrix over an integral
domain which is not a PID, but usually this will fail.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">],</span>
<span class="go">....:                      [x^2 - 8, -x + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Ideal Ideal (x^2 - x, x^2 - 8) of Univariate Polynomial Ring in x over Integer Ring not principal</span>
</pre></div>
</div>
<p>Matrices over non-commutative rings are not a good idea either.
These are the “usual” quaternions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span><span class="o">.&lt;</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuaternionAlgebra</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Cannot compute a matrix kernel over Quaternion Algebra (-1, -1) with base ring Rational Field</span>
</pre></div>
</div>
<p>Sparse matrices, over the rationals and the integers,
use the same routines as the dense versions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="go">....:                 [1, -2, 0, 1, 3],</span>
<span class="go">....:                 [-1, 2, 0, -1, -3]],</span>
<span class="go">....:            sparse=True)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">Free module of degree 5 and rank 3 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[ 1  0  0  2 -1]</span>
<span class="go">[ 0  1  0 -1  1]</span>
<span class="go">[ 0  0  1 -3  1]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 5 and dimension 3 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0  0  2 -1]</span>
<span class="go">[ 0  1  0 -1  1]</span>
<span class="go">[ 0  0  1 -3  1]</span>
</pre></div>
</div>
<p>With no columns, the kernel can only have dimension zero.
With no rows, every possible vector is in the kernel.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 0 and dimension 0 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
<p>Every vector is in the kernel of a zero matrix, the
dimension is the number of columns.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">()</span>
<span class="go">Vector space of degree 20 and dimension 20 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">20 x 20 dense matrix over Rational Field</span>
</pre></div>
</div>
<p>Results are cached as the right kernel of the matrix.
Subsequent requests for the right kernel will return
the cached result, without regard for new values of the
algorithm or format keyword.  Work with a copy if you
need a new right kernel, or perhaps investigate the
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel_matrix" title="sage.matrix.matrix2.Matrix.right_kernel_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel_matrix()</span></code></a> method, which does not
cache its results and is more flexible.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K1</span>
<span class="go">Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K2</span>
<span class="go">Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">K1</span> <span class="ow">is</span> <span class="n">K2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">kernel</span><span class="p">(</span><span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K3</span>
<span class="go">Vector space of degree 3 and dimension 1 over Rational Field</span>
<span class="go">User basis matrix:</span>
<span class="go">[ 1 -2  1]</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="ow">is</span> <span class="n">K1</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">==</span> <span class="n">K1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_kernel_matrix">
<code class="descname">right_kernel_matrix</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_kernel_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix whose rows form a basis
for the right kernel of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - default: ‘default’ - a keyword that selects the
algorithm employed.  Allowable values are:<ul>
<li>‘default’ - allows the algorithm to be chosen automatically</li>
<li>‘generic’ - naive algorithm usable for matrices over any field</li>
<li>‘flint’ - FLINT library code for matrices over the rationals
or the integers</li>
<li>‘pari’ - PARI library code for matrices over number fields
or the integers</li>
<li>‘padic’ - padic algorithm from IML library for matrices
over the rationals and integers</li>
<li>‘pluq’ - PLUQ matrix factorization for matrices mod 2</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">basis</span></code> - default: ‘echelon’ - a keyword that describes
the format of the basis returned.  Allowable values are:<ul>
<li>‘echelon’: the basis matrix is returned in echelon form</li>
<li>‘pivot’ : each basis vector is computed from the reduced
row-echelon form of <code class="docutils literal notranslate"><span class="pre">self</span></code> by placing a single one in a
non-pivot column and zeros in the remaining non-pivot columns.
Only available for matrices over fields.</li>
<li>‘LLL’: an LLL-reduced basis.  Only available for matrices
over the integers.</li>
<li>‘computed’: no work is done to transform the basis, it is
returned exactly as provided by whichever routine actually
computed the basis.  Request this for the least possible
computation possible, but with no guarantees about the format
of the basis.</li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>A matrix <code class="docutils literal notranslate"><span class="pre">X</span></code>  whose rows are an independent set spanning the
right kernel of <code class="docutils literal notranslate"><span class="pre">self</span></code>.  So <code class="docutils literal notranslate"><span class="pre">self*X.transpose()</span></code> is a zero matrix.</p>
<p>The output varies depending on the choice of <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> and the
format chosen by <code class="docutils literal notranslate"><span class="pre">basis</span></code>.</p>
<p>The results of this routine are not cached, so you can call it again
with different options to get possibly different output (like the basis
format).  Conversely, repeated calls on the same matrix will always
start from scratch.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you want to get the most basic description of a kernel, with a
minimum of overhead, then ask for the right kernel matrix with
the basis format requested as ‘computed’.  You are then free to
work with the output for whatever purpose.  For a left kernel,
call this method on the transpose of your matrix.</p>
<p class="last">For greater convenience, plus cached results, request an actual
vector space or free module with <a class="reference internal" href="#sage.matrix.matrix2.Matrix.right_kernel" title="sage.matrix.matrix2.Matrix.right_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">right_kernel()</span></code></a>
or <a class="reference internal" href="#sage.matrix.matrix2.Matrix.left_kernel" title="sage.matrix.matrix2.Matrix.left_kernel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">left_kernel()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Over the Rational Numbers:</p>
<p>Kernels are computed by the IML library in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_right_kernel_matrix()</span></code>.
Setting the <span class="math notranslate nohighlight">\(algorithm\)</span> keyword to ‘default’, ‘padic’ or unspecified
will yield the same result, as there is no optional behavior.
The ‘computed’ format of the basis vectors are exactly the negatives
of the vectors in the ‘pivot’ format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [-5, 1, 0, 7, -3],</span>
<span class="go">....:                 [0, -1, -4, 6, -2],</span>
<span class="go">....:                 [4, -1, 0, -6, 2]])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[-1  2 -2 -1  0]</span>
<span class="go">[ 1  2  0  0 -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[ 1 -2  2  1  0]</span>
<span class="go">[-1 -2  0  0  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">==</span> <span class="o">-</span><span class="n">P</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[   1    0    1  1/2 -1/2]</span>
<span class="go">[   0    1 -1/2 -1/4 -1/4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Since the rationals are a field, we can call the general code
available for any field by using the ‘generic’ keyword.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [-5, 1, 0, 7, -3],</span>
<span class="go">....:                 [0, -1, -4, 6, -2],</span>
<span class="go">....:                 [4, -1, 0, -6, 2]])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">[   1    0    1  1/2 -1/2]</span>
<span class="go">[   0    1 -1/2 -1/4 -1/4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We verify that the rational matrix code is called for both
dense and sparse rational matrices, with equal result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="go">....:                 [-5, 1, 0, 7, -3],</span>
<span class="go">....:                 [0, -1, -4, 6, -2],</span>
<span class="go">....:                 [4, -1, 0, -6, 2]],</span>
<span class="go">....:            sparse=False)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">sparse_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">D</span>
<span class="go">verbose 1 (&lt;module&gt;) computing a right kernel for 4x5 matrix over Rational Field</span>
<span class="gp">...</span>
<span class="go">Vector space of degree 5 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1    0    1  1/2 -1/2]</span>
<span class="go">[   0    1 -1/2 -1/4 -1/4]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">S</span>
<span class="go">verbose 1 (&lt;module&gt;) computing a right kernel for 4x5 matrix over Rational Field</span>
<span class="gp">...</span>
<span class="go">Vector space of degree 5 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[   1    0    1  1/2 -1/2]</span>
<span class="go">[   0    1 -1/2 -1/4 -1/4]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over Number Fields:</p>
<p>Kernels are by default computed by PARI, (except for exceptions like
the rationals themselves).  The raw results from PARI are a pivot
basis, so the <span class="math notranslate nohighlight">\(basis\)</span> keywords ‘computed’ and ‘pivot’ will return
the same results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">15</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">],</span>
<span class="go">....:                [2+a, a, -7 + 5*a, -3+3*a]])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[    -a     -3      1      0]</span>
<span class="go">[    -2 -a - 1      0      1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[    -a     -3      1      0]</span>
<span class="go">[    -2 -a - 1      0      1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[                1                 0     7/88*a + 3/88 -3/176*a - 39/176]</span>
<span class="go">[                0                 1   -1/88*a - 13/88  13/176*a - 7/176]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can bypass using PARI for number fields and use Sage’s general
code for matrices over any field.  The basis vectors as computed
are in pivot format.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">15</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">],[</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">[    -a     -3      1      0]</span>
<span class="go">[    -2 -a - 1      0      1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We check that number fields are handled by the right routine as part of
typical right kernel computation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">15</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="mi">16</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">],[</span><span class="mi">2</span><span class="o">+</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">a</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">verbose ...</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over a number field for 2x4 matrix</span>
<span class="go">verbose 1 (&lt;module&gt;) done computing right kernel matrix over a number field for 2x4 matrix</span>
<span class="gp">...</span>
<span class="go">Vector space of degree 4 and dimension 2 over Number Field in a with defining polynomial x^2 + 7</span>
<span class="go">Basis matrix:</span>
<span class="go">[                1                 0     7/88*a + 3/88 -3/176*a - 39/176]</span>
<span class="go">[                0                 1   -1/88*a - 13/88  13/176*a - 7/176]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Over the Finite Field of Order 2:</p>
<p>Kernels are computed by the M4RI library using PLUQ matrix
decomposition in the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_right_kernel_matrix()</span></code>
method. There are no options for the algorithm used.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1,],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="go">[0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Since GF(2) is a field we can route this computation to the generic
code and obtain the ‘pivot’ form of the basis.  The <code class="docutils literal notranslate"><span class="pre">algorithm</span></code>
keywords, ‘pluq’, ‘default’ and unspecified, all have the
same effect as there is no optional behavior.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1,],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[1 0 0 0 1 0]</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DP</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">DP</span>
<span class="go">[0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[1 0 0 0 1 0]</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">DP</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pluq&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">)</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="go">[0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 1]</span>
</pre></div>
</div>
<p>We test that the mod 2 code is called for matrices over GF(2).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1,],</span>
<span class="go">....:                   [1, 0, 0, 0, 1, 1]])</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">verbose ...</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over integers mod 2 for 3x6 matrix</span>
<span class="go">verbose 1 (&lt;module&gt;) done computing right kernel matrix over integers mod 2 for 3x6 matrix</span>
<span class="gp">...</span>
<span class="go">Vector space of degree 6 and dimension 4 over Finite Field of size 2</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 0 0 0 0 1]</span>
<span class="go">[0 1 1 0 0 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 1 1]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Over Arbitrary Fields:</p>
<p>For kernels over fields not listed above, totally general code
will compute a set of basis vectors in the pivot format.
These could be returned as a basis in echelon form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">a</span><span class="p">,</span>     <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span>  <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="p">],</span>
<span class="go">....:                      [  a, a^4,   a+a^4,  a^4+a^8],</span>
<span class="go">....:                      [a^2, a^6, a^2+a^6, a^5+a^10]])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;pivot&#39;</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[      4       4       1       0]</span>
<span class="go">[  a + 2 3*a + 3       0       1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">P</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[      1       0 3*a + 4 2*a + 2]</span>
<span class="go">[      0       1     2*a 3*a + 3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>This general code can be requested for matrices over any field
with the <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> keyword ‘generic’.  Normally, matrices
over the rationals would be handled by specific routines from
the IML library. The default format is an echelon basis, but a
pivot basis may be requested, which is identical to the computed
basis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
<span class="go">....:                       [2,0,2,2],</span>
<span class="go">....:                       [-1,1,-2,0]])</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">);</span> <span class="n">G</span>
<span class="go">[   1    0 -1/2 -1/2]</span>
<span class="go">[   0    1  1/2 -1/2]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">G</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;generic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">C</span>
<span class="go">[-1  1  1  0]</span>
<span class="go">[-1 -1  0  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We test that the generic code is called for matrices over fields,
lacking any more specific routine.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FiniteField</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">a</span><span class="p">,</span>     <span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="p">,</span>  <span class="n">a</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">5</span><span class="p">],</span>
<span class="go">....:                      [  a, a^4,   a+a^4,  a^4+a^8],</span>
<span class="go">....:                      [a^2, a^6, a^2+a^6, a^5+a^10]])</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">)</span>
<span class="go">verbose ...</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over an arbitrary field for 3x4 matrix</span>
<span class="gp">...</span>
<span class="go">Vector space of degree 4 and dimension 2 over Finite Field in a of size 5^2</span>
<span class="go">Basis matrix:</span>
<span class="go">[      1       0 3*a + 4 2*a + 2]</span>
<span class="go">[      0       1     2*a 3*a + 3]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Over the Integers:</p>
<p>Either the IML or PARI libraries are used to provide a set of basis
vectors.  The <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> keyword can be used to select either,
or when set to ‘default’ a heuristic will choose between the two.
Results can be returned in the ‘compute’ format, straight out of
the libraries.  Unique to the integers, the basis vectors can be
returned as an LLL basis.  Note the similarities and differences
in the results. The ‘pivot’ format is not available, since the
integers are not a field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="go">....:                 [4, 0, 3, 4, 2, 7, 7],</span>
<span class="go">....:                 [1, 4, 6, 1, 2, 8, 5],</span>
<span class="go">....:                 [0, 3, 1, 2, 3, 6, 2]])</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[  1  12   3  14  -3 -10   1]</span>
<span class="go">[  0  35   0  25  -1 -31  17]</span>
<span class="go">[  0   0   7  12  -3  -1  -8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;LLL&#39;</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[ -3  -1   5   7   2  -3  -2]</span>
<span class="go">[  3   1   2   5  -5   2  -6]</span>
<span class="go">[ -4 -13   2  -7   5   7  -3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;pari&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[ 3  1 -5 -7 -2  3  2]</span>
<span class="go">[ 3  1  2  5 -5  2 -6]</span>
<span class="go">[ 4 13 -2  7 -5 -7  3]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;padic&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;computed&#39;</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[ 265  345 -178   17 -297    0    0]</span>
<span class="go">[-242 -314  163  -14  271   -1    0]</span>
<span class="go">[ -36  -47   25   -1   40    0   -1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We test that the code for integer matrices is called for matrices
defined over the integers, both dense and sparse, with equal result.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
<span class="go">....:                 [4, 0, 3, 4, 2, 7, 7],</span>
<span class="go">....:                 [1, 4, 6, 1, 2, 8, 5],</span>
<span class="go">....:                 [0, 3, 1, 2, 3, 6, 2]],</span>
<span class="go">....:            sparse=False)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">sparse_matrix</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">D</span>
<span class="go">verbose 1 (&lt;module&gt;) computing a right kernel for 4x7 matrix over Integer Ring</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over the integers for 4x7 matrix</span>
<span class="gp">...</span>
<span class="go">verbose 1 (&lt;module&gt;) done computing right kernel matrix over the integers for 4x7 matrix</span>
<span class="gp">...</span>
<span class="go">Free module of degree 7 and rank 3 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1  12   3  14  -3 -10   1]</span>
<span class="go">[  0  35   0  25  -1 -31  17]</span>
<span class="go">[  0   0   7  12  -3  -1  -8]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">();</span> <span class="n">S</span>
<span class="go">verbose 1 (&lt;module&gt;) computing a right kernel for 4x7 matrix over Integer Ring</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over the integers for 4x7 matrix</span>
<span class="gp">...</span>
<span class="go">verbose 1 (&lt;module&gt;) done computing right kernel matrix over the integers for 4x7 matrix</span>
<span class="gp">...</span>
<span class="go">Free module of degree 7 and rank 3 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[  1  12   3  14  -3 -10   1]</span>
<span class="go">[  0  35   0  25  -1 -31  17]</span>
<span class="go">[  0   0   7  12  -3  -1  -8]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">S</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over Principal Ideal Domains:</p>
<p>Kernels can be computed using Smith normal form.  Only the default
algorithm is available, and the ‘pivot’ basis format is
not available.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                [y^3, y^2, 2*y^3]])</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[-1 -y  1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="o">==</span> <span class="n">zero_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It can be computationally expensive to determine if an integral
domain is a principal ideal domain.  The Smith normal form routine
can fail for non-PIDs, as in this example.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">],</span>
<span class="go">....:                      [x^2 - 8, -x + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Ideal Ideal (x^2 - x, x^2 - 8) of Univariate Polynomial Ring in x over Integer Ring not principal</span>
</pre></div>
</div>
<p>We test that the domain code is called for domains that lack any
extra structure.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="p">[[</span>  <span class="mi">1</span><span class="p">,</span>   <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">],</span>
<span class="go">....:                [y^3, y^2, 2*y^3]])</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s1">&#39;echelon&#39;</span><span class="p">)</span>
<span class="go">verbose ...</span>
<span class="go">verbose 1 (&lt;module&gt;) computing right kernel matrix over a domain for 2x3 matrix</span>
<span class="go">verbose 1 (&lt;module&gt;) done computing right kernel matrix over a domain for 2x3 matrix</span>
<span class="gp">...</span>
<span class="go">Free module of degree 3 and rank 1 over Univariate Polynomial Ring in y over Rational Field</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[-1 -y  1]</span>
<span class="gp">sage: </span><span class="n">set_verbose</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>Trivial Cases:</p>
<p>We test two trivial cases.  Any possible values for the
keywords (<code class="docutils literal notranslate"><span class="pre">algorithm</span></code>, <code class="docutils literal notranslate"><span class="pre">basis</span></code>) will return identical results.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_kernel_matrix</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 0 by 0 dense matrices over Finite Field of size 7</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-02-05)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.right_nullity">
<code class="descname">right_nullity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.right_nullity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the right nullity of this matrix, which is the dimension of
the right kernel.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_nullity</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">right_nullity</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.rook_vector">
<code class="descname">rook_vector</code><span class="sig-paren">(</span><em>algorithm='ButeraPernici'</em>, <em>complement=False</em>, <em>use_complement=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.rook_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rook vector of this matrix.</p>
<p>Let <span class="math notranslate nohighlight">\(A\)</span> be an <span class="math notranslate nohighlight">\(m\)</span> by <span class="math notranslate nohighlight">\(n\)</span> (0,1)-matrix. We identify <span class="math notranslate nohighlight">\(A\)</span> with a chessboard
where rooks can be placed on the fields <span class="math notranslate nohighlight">\((i, j)\)</span> with <span class="math notranslate nohighlight">\(A_{i,j} = 1\)</span>. The
number <span class="math notranslate nohighlight">\(r_k = p_k(A)\)</span> (the permanental <span class="math notranslate nohighlight">\(k\)</span>-minor) counts the number of
ways to place <span class="math notranslate nohighlight">\(k\)</span> rooks on this board so that no rook can attack
another.</p>
<p>The <em>rook vector</em> of the matrix <span class="math notranslate nohighlight">\(A\)</span> is the list consisting of <span class="math notranslate nohighlight">\(r_0,
r_1, \ldots, r_h\)</span>, where <span class="math notranslate nohighlight">\(h = min(m,n)\)</span>. The <em>rook polynomial</em> is defined by
<span class="math notranslate nohighlight">\(r(x) = \sum_{k=0}^h r_k x^k\)</span>.</p>
<p>The rook vector can be generalized to matrices defined over any rings
using permanental minors. Among the available algorithms, only “Godsil”
needs the condition on the entries to be either <span class="math notranslate nohighlight">\(0\)</span> or <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Rook_polynomial">Wikipedia article Rook_polynomial</a> for more information and also the
method <a class="reference internal" href="#sage.matrix.matrix2.Matrix.permanental_minor" title="sage.matrix.matrix2.Matrix.permanental_minor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">permanental_minor()</span></code></a> to compute individual permanental
minor.</p>
<p>See also <code class="docutils literal notranslate"><span class="pre">sage.matrix.matrix2.permanental_minor_polynomial</span></code>
and the graph method <code class="docutils literal notranslate"><span class="pre">matching_polynomial</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – an <span class="math notranslate nohighlight">\(m\)</span> by <span class="math notranslate nohighlight">\(n\)</span> matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – a string which must be either “Ryser” or
“ButeraPernici” (default) or “Godsil”; Ryser one might be faster on
simple and small instances. Godsil only accepts input in 0,1.</li>
<li><code class="docutils literal notranslate"><span class="pre">complement</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) whether we consider the
rook vector of the complement matrix. If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> then the
matrix must have entries in {0, 1} and the complement matrix is the
one for which the 0’s are replaced by 1’s and 1’s by 0’s.</li>
<li><code class="docutils literal notranslate"><span class="pre">use_complement</span></code> – Boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) whether to compute the
rook vector of a (0,1)-matrix from its complement. By default this is
determined by the density of ones in the matrix.</li>
</ul>
<p>EXAMPLES:</p>
<p>The standard chessboard is an <span class="math notranslate nohighlight">\(8\)</span> by <span class="math notranslate nohighlight">\(8\)</span> grid in which any positions is
allowed. In that case one gets that the number of ways to position <span class="math notranslate nohighlight">\(4\)</span>
non-attacking rooks is <span class="math notranslate nohighlight">\(117600\)</span> while for <span class="math notranslate nohighlight">\(8\)</span> rooks it is <span class="math notranslate nohighlight">\(40320\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ones_matrix</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">()</span>
<span class="go">[1, 64, 1568, 18816, 117600, 376320, 564480, 322560, 40320]</span>
</pre></div>
</div>
<p>These numbers are the coefficients of a modified Laguerre polynomial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factorial</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">*</span> <span class="n">laguerre</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="go">x^8 + 64*x^7 + 1568*x^6 + 18816*x^5 + 117600*x^4 + 376320*x^3 +</span>
<span class="go">564480*x^2 + 322560*x + 40320</span>
</pre></div>
</div>
<p>The number of derangements of length <span class="math notranslate nohighlight">\(n\)</span> is the permanent
of a matrix with 0 on the diagonal and 1 elsewhere;
for <span class="math notranslate nohighlight">\(n=21\)</span> it is <span class="math notranslate nohighlight">\(18795307255050944540\)</span> (see <a class="reference external" href="https://oeis.org/A000166">OEIS sequence A000166</a>):</p>
<blockquote>
<div>sage: A = identity_matrix(21)
sage: A.rook_vector(complement=True)[-1]
18795307255050944540
sage: Derangements(21).cardinality()
18795307255050944540</div></blockquote>
<p>An other example that we convert into a rook polynomial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[1 1 1 1 0 0]</span>
<span class="go">[0 1 1 1 1 0]</span>
<span class="go">[0 0 1 1 1 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">()</span>
<span class="go">[1, 12, 40, 36]</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">())</span>
<span class="go">36*x^3 + 40*x^2 + 12*x + 1</span>
</pre></div>
</div>
<p>Different algorithms are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ButeraPernici&quot;</span><span class="p">)</span>
<span class="go">[1, 8, 20, 16, 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;Ryser&quot;</span><span class="p">)</span>
<span class="go">[1, 8, 20, 16, 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;Godsil&quot;</span><span class="p">)</span>
<span class="go">[1, 8, 20, 16, 4]</span>
</pre></div>
</div>
<p>When the matrix <span class="math notranslate nohighlight">\(A\)</span> has more ones then zeroes it is usually faster
to compute the rook polynomial of the complementary matrix, with
zeroes and ones interchanged, and use the inclusion-exclusion theorem,
giving for a <span class="math notranslate nohighlight">\(m \times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> with complementary matrix <span class="math notranslate nohighlight">\(B\)</span></p>
<div class="math notranslate nohighlight">
\[r_k(A) = \sum_{j=0}^k (-1)^j \binom{m-j}{k-j} \binom{n-j}{k-j} (k-j)! r_j(B)\]</div>
<p>see <a class="reference internal" href="../../../references/index.html#rio1958" id="id9">[Rio1958]</a> or the introductory text <a class="reference internal" href="../../../references/index.html#as2011" id="id10">[AS2011]</a>. This can be done
setting the argument <code class="docutils literal notranslate"><span class="pre">use_complement</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>An example with an exotic matrix (for which only Butera-Pernici and
Ryser algorithms are available):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">],[</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ButeraPernici&quot;</span><span class="p">)</span>
<span class="go">[1, x^2 + x*y + x + 2*y + 1, 2*x^2*y + x*y^2 + x^2 + y^2 + y]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;Ryser&quot;</span><span class="p">)</span>
<span class="go">[1, x^2 + x*y + x + 2*y + 1, 2*x^2*y + x*y^2 + x^2 + y^2 + y]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;Godsil&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">coefficients must be zero or one, but we have &#39;x&#39; in position (0,1).</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;ButeraPernici&quot;</span><span class="p">)</span>
<span class="go">[1, x^2 + x*y + x + 2*y + 1, 2*x^2*y + x*y^2 + x^2 + y^2 + y]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rook_vector</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="s2">&quot;Ryser&quot;</span><span class="p">)</span>
<span class="go">[1, x^2 + x*y + x + 2*y + 1, 2*x^2*y + x*y^2 + x^2 + y^2 + y]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jaap Spies (2006-02-24)</li>
<li>Mario Pernici (2014-07-01)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.row_module">
<code class="descname">row_module</code><span class="sig-paren">(</span><em>base_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.row_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the free module over the base ring spanned by the rows of
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">IntegerRing</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">row_module</span><span class="p">()</span>
<span class="go">Free module of degree 2 and rank 2 over Integer Ring</span>
<span class="go">Echelon basis matrix:</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.row_space">
<code class="descname">row_space</code><span class="sig-paren">(</span><em>base_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.row_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the row space of this matrix. (Synonym for
self.row_module().)</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">t</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">Vector space of degree 3 and dimension 2 over Rational Field</span>
<span class="go">Basis matrix:</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">row_space</span><span class="p">()</span>
<span class="go">Vector space of degree 2 and dimension 1 over Ring of integers modulo 5</span>
<span class="go">Basis matrix:</span>
<span class="go">[1 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.rref">
<code class="descname">rref</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.rref" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the reduced row echelon form of the matrix, considered
as a matrix over a field.</p>
<p>If the matrix is over a ring, then an equivalent matrix is
constructed over the fraction field, and then row reduced.</p>
<p>All arguments are passed on to <a class="reference internal" href="#sage.matrix.matrix2.Matrix.echelon_form" title="sage.matrix.matrix2.Matrix.echelon_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">echelon_form()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because the matrix is viewed as a matrix over a field,
every leading coefficient of the returned matrix will be
one and will be the only nonzero entry in its column.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">A</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[ 1  0 -1]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>
</pre></div>
</div>
<p>Note that there is a difference between <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rref" title="sage.matrix.matrix2.Matrix.rref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rref()</span></code></a> and
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.echelon_form" title="sage.matrix.matrix2.Matrix.echelon_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">echelon_form()</span></code></a> when the matrix is not over a field (in
this case, the integers instead of the rational numbers):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[ 3  0 -3]</span>
<span class="go">[ 0  1  2]</span>
<span class="go">[ 0  0  0]</span>

<span class="gp">sage: </span><span class="n">B</span><span class="o">=</span><span class="n">random_matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">num_bound</span><span class="o">=</span><span class="mi">10</span><span class="p">);</span> <span class="n">B</span>
<span class="go">[ -4  -3   6]</span>
<span class="go">[  5  -5 9/2]</span>
<span class="go">[3/2  -4  -7]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
</pre></div>
</div>
<p>In this case, since <code class="docutils literal notranslate"><span class="pre">B</span></code> is a matrix over a field (the
rational numbers), <a class="reference internal" href="#sage.matrix.matrix2.Matrix.rref" title="sage.matrix.matrix2.Matrix.rref"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rref()</span></code></a> and <a class="reference internal" href="#sage.matrix.matrix2.Matrix.echelon_form" title="sage.matrix.matrix2.Matrix.echelon_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">echelon_form()</span></code></a> are
exactly the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span> <span class="ow">is</span> <span class="n">B</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Since <a class="reference internal" href="#sage.matrix.matrix2.Matrix.echelon_form" title="sage.matrix.matrix2.Matrix.echelon_form"><code class="xref py py-meth docutils literal notranslate"><span class="pre">echelon_form()</span></code></a> is not implemented for every ring,
sometimes behavior varies, as here:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;=</span><span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in x over Integer Ring</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Ideal Ideal (2, x + 1) of Univariate Polynomial Ring in x over Integer Ring not principal</span>
<span class="go">Echelon form not implemented over &#39;Univariate Polynomial Ring in x over Integer Ring&#39;.</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[                               2                                x                              x^2]</span>
<span class="go">[                               0                                1            15*x^2 - 3/2*x - 31/2]</span>
<span class="go">[                               0                                0 5/2*x^3 - 15/4*x^2 - 9/4*x + 7/2]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,[</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">-</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">echelon_form</span><span class="p">()</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.set_block">
<code class="descname">set_block</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.set_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the sub-matrix of self, with upper left corner given by row,
col to block.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span><span class="mi">200</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">set_block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[  0 100   1]</span>
<span class="go">[3/2 200 5/2]</span>
<span class="go">[  3 7/2   4]</span>
</pre></div>
</div>
<p>We test that an exception is raised when the block is out of
bounds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">set_block</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">]))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">matrix window index out of range</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.smith_form">
<code class="descname">smith_form</code><span class="sig-paren">(</span><em>transformation=True</em>, <em>integral=None</em>, <em>exact=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.smith_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a Smith normal form of this matrix.</p>
<p>For a matrix <span class="math notranslate nohighlight">\(M\)</span>, a Smith normal form is a matrix <span class="math notranslate nohighlight">\(S = UMV\)</span> such that:</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are invertible matrices</li>
<li>the only non-vanishing entries of <span class="math notranslate nohighlight">\(S\)</span> are located on the diagonal
(though <span class="math notranslate nohighlight">\(S\)</span> might not be a square matrix)</li>
<li>if <span class="math notranslate nohighlight">\(d_i\)</span> denotes the entry of <span class="math notranslate nohighlight">\(S\)</span> at <span class="math notranslate nohighlight">\((i,i)\)</span>, then <span class="math notranslate nohighlight">\(d_i\)</span> divides
<span class="math notranslate nohighlight">\(d_{i+1}\)</span> for all <span class="math notranslate nohighlight">\(i\)</span>, i.e., the <span class="math notranslate nohighlight">\(d_i\)</span> are the ordered
<a class="reference internal" href="#sage.matrix.matrix2.Matrix.elementary_divisors" title="sage.matrix.matrix2.Matrix.elementary_divisors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">elementary_divisors()</span></code></a> of <span class="math notranslate nohighlight">\(M\)</span></li>
</ul>
<p>Note that the matrices <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are not uniquely determined and the
<span class="math notranslate nohighlight">\(d_i\)</span> are only uniquely determined up to units. For some base rings,
such as local rings, the <span class="math notranslate nohighlight">\(d_i\)</span> might be further normalized, see
<code class="docutils literal notranslate"><span class="pre">LOCAL</span> <span class="pre">RINGS</span></code> below.</p>
<p>If the base ring is not a PID, the routine might work, or else it will
fail having found an example of a non-principal ideal. Note that we do
not call any methods to check whether or not the base ring is a PID,
since this might be quite expensive (e.g. for rings of integers of
number fields of large degree).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether the
matrices <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> should be returned</li>
<li><code class="docutils literal notranslate"><span class="pre">integral</span></code> – a subring of the base ring, boolean or <code class="docutils literal notranslate"><span class="pre">None</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the entries of <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are taken
from this subring. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the ring is taken to be the
ring of integers of the base ring; if <code class="docutils literal notranslate"><span class="pre">False</span></code> the fraction field
of the base ring; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the base ring itself.
When a subring is specified, multiplying
by the denominator must map the entries into the subring; in this
case the transformation matrices will have entries in this subring.</li>
<li><code class="docutils literal notranslate"><span class="pre">exact</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>), only used for local rings/fields.
See <code class="docutils literal notranslate"><span class="pre">LOCAL</span> <span class="pre">RINGS</span></code> for more details.</li>
</ul>
<p>OUTPUT:</p>
<p>The matrices <span class="math notranslate nohighlight">\(S, U, V\)</span> or the matrix <span class="math notranslate nohighlight">\(S\)</span> depending on
<code class="docutils literal notranslate"><span class="pre">transformation</span></code>.</p>
<p>ALGORITHM:</p>
<p>If the base ring has a method <code class="docutils literal notranslate"><span class="pre">_matrix_smith_form</span></code>, use it; note that
<code class="docutils literal notranslate"><span class="pre">_matrix_smith_form</span></code> might choose to further normalize the output.</p>
<p>Otherwise, use the algorithm from <a class="reference external" href="https://en.wikipedia.org/wiki/Smith_normal_form">Wikipedia article Smith_normal_form</a>.</p>
<p>LOCAL RINGS:</p>
<p>Over local rings, we normalize <span class="math notranslate nohighlight">\(S\)</span> to only contain powers of the uniformizer.</p>
<p>In order to simplify the precision handling, we truncate the absolute precision
of the input matrix to the minimum absolute precision of any of its entries.
As long as all of the elementary divisors are nonzero modulo this precision,
they can be determined exactly since they are defined to be powers of the
uniformizer.  In this case, which is specified by the keyword <code class="docutils literal notranslate"><span class="pre">exact=True</span></code>,
one of the transformation matrices will be inexact: <span class="math notranslate nohighlight">\(U\)</span> in the case that
the number of rows is at least the number of columns, and <span class="math notranslate nohighlight">\(V\)</span> otherwise.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">exact=False</span></code>, we instead return an inexact Smith form.  Now the
transformation matrices are exact and we can deal gracefully with
elementary divisors that are zero modulo the working precision.  However,
the off-diagonal entries of the smith form carry a precision that
can affect the precision of future calculations.</p>
<p>See <code class="docutils literal notranslate"><span class="pre">_matrix_smith_form</span></code> on the base ring for more detail.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Loeffler (2008-12-05)</li>
</ul>
<p>EXAMPLES:</p>
<p>An example over the ring of integers of a number field (of class
number 1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">OE</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EquationOrder</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">w</span><span class="p">],[</span><span class="n">w</span><span class="p">,</span><span class="mi">7</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[     1      0]  [ 1  0]  [ 1 -w]</span>
<span class="go">[     0 -w + 9], [-w  1], [ 0  1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span> <span class="o">==</span> <span class="n">d</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span> <span class="o">==</span> <span class="n">OE</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">det</span><span class="p">()</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span> <span class="ow">and</span> <span class="n">v</span><span class="o">.</span><span class="n">det</span><span class="p">()</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example over the polynomial ring QQ[x]:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[];</span> <span class="n">m</span><span class="o">=</span><span class="n">x</span><span class="o">*</span><span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]);</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[            1             0]  [    0    -1]  [    1 x + 1]</span>
<span class="go">[            0 x^2 - 2*x + 1], [    1 x - 3], [    0     1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>An example over a field:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span> <span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>When the base ring has a <code class="docutils literal notranslate"><span class="pre">ring_of_integers</span></code> method and supports denominators,
you can get an integral version of the smith form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">47</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">25</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">23</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="go">(</span>
<span class="go">[1 0]  [6/17    0]  [     1 -47/17]</span>
<span class="go">[0 1], [  75  -51], [     0      1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">(</span><span class="n">integral</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">[1/6   0]  [  3  -2]  [ 1  3]</span>
<span class="go">[  0 1/3], [-25  17], [ 0 -1]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>Some examples over non-PID’s work anyway:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">s</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">EquationOrder</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span> <span class="c1"># class number 2</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">V</span>
<span class="go">(</span>
<span class="go">[     1      0]  [    4 s + 4]  [       1 -5*s + 6]</span>
<span class="go">[     0 -s - 6], [    s s - 1], [       0        1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">U</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">V</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Others don’t, but they fail quite constructively:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">matrix</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">s</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">s</span><span class="p">,</span><span class="o">-</span><span class="n">s</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">smith_form</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ArithmeticError</span>: <span class="n">Ideal Fractional ideal (2, s + 1) not principal</span>
</pre></div>
</div>
<p>Empty matrices are handled safely:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">OE</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">OE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">MatrixSpace</span><span class="p">(</span><span class="n">OE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="mi">0</span><span class="p">);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Some pathological cases that crashed earlier versions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">OE</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">w</span><span class="o">+</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">]]);</span> <span class="n">d</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">OE</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="o">*</span><span class="n">w</span><span class="p">,</span><span class="o">-</span><span class="n">w</span><span class="p">,</span><span class="n">w</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">8</span><span class="p">]);</span> <span class="n">d</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">smith_form</span><span class="p">();</span> <span class="n">u</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span> <span class="o">==</span> <span class="n">d</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Over local fields, we can request the transformation matrices to be integral:;</p>
<blockquote>
<div>sage: K = Qp(2, 5, print_mode=’terse’)
sage: M = matrix(K, 2, 3, [1/2, 1, 2, 1/3, 1, 3])
sage: M.smith_form(integral=True)
(
[1/2 + O(2^4)            0            0]  [ 1 + O(2^5)           0]
[           0   1 + O(2^5)            0], [42 + O(2^6)  1 + O(2^5)],
&lt;BLANKLINE&gt;
[ 1 + O(2^5) 26 + O(2^5)  6 + O(2^5)]
[     O(2^4)  3 + O(2^4) 11 + O(2^4)]
[          0           0  1 + O(2^5)]
)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.solve_left">
<code class="descname">solve_left</code><span class="sig-paren">(</span><em>B</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.solve_left" title="Permalink to this definition">¶</a></dt>
<dd><p>If self is a matrix <span class="math notranslate nohighlight">\(A\)</span>, then this function returns a
vector or matrix <span class="math notranslate nohighlight">\(X\)</span> such that <span class="math notranslate nohighlight">\(X A = B\)</span>. If
<span class="math notranslate nohighlight">\(B\)</span> is a vector then <span class="math notranslate nohighlight">\(X\)</span> is a vector and if
<span class="math notranslate nohighlight">\(B\)</span> is a matrix, then <span class="math notranslate nohighlight">\(X\)</span> is a matrix.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">B</span></code> - a matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> - bool (default: True) - if False and self
is nonsquare, may not raise an error message even if there is no
solution. This is faster but more dangerous.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_left</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">*</span><span class="n">A</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">solve_left</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">number of columns of self must equal number of columns of B</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.solve_right">
<code class="descname">solve_right</code><span class="sig-paren">(</span><em>B</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.solve_right" title="Permalink to this definition">¶</a></dt>
<dd><p>If self is a matrix <span class="math notranslate nohighlight">\(A\)</span>, then this function returns a
vector or matrix <span class="math notranslate nohighlight">\(X\)</span> such that <span class="math notranslate nohighlight">\(A X = B\)</span>. If
<span class="math notranslate nohighlight">\(B\)</span> is a vector then <span class="math notranslate nohighlight">\(X\)</span> is a vector and if
<span class="math notranslate nohighlight">\(B\)</span> is a matrix, then <span class="math notranslate nohighlight">\(X\)</span> is a matrix.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Sage one can also write <code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">\backslash</span>&#160; <span class="pre">B</span></code> for
<code class="docutils literal notranslate"><span class="pre">A.solve_right(B)</span></code>, i.e., Sage implements the “the
MATLAB/Octave backslash operator”.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">B</span></code> - a matrix or vector</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> - bool (default: True) - if False and self
is nonsquare, may not raise an error message even if there is no
solution. This is faster but more dangerous.</li>
</ul>
<p>OUTPUT: a matrix or vector</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.matrix.matrix2.Matrix.solve_left" title="sage.matrix.matrix2.Matrix.solve_left"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_left()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span> \ <span class="n">b</span><span class="p">;</span> <span class="n">x</span>
<span class="go">(-13/12, 23/12, -7/12)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">*</span> <span class="n">x</span>
<span class="go">(1, 2, 3)</span>
</pre></div>
</div>
<p>We solve with A nonsquare:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[-3/2  1/2]</span>
<span class="go">[  -1    0]</span>
<span class="go">[   0    0]</span>
<span class="go">[   0    0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another nonsingular example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span> \ <span class="n">v</span><span class="p">;</span> <span class="n">x</span>
<span class="go">(-1/2, 0, 0)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">x</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Same example but over <span class="math notranslate nohighlight">\(\ZZ\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> \ <span class="n">v</span>
<span class="go">(-1, 0, 0)</span>
</pre></div>
</div>
<p>An example in which there is no solution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> \ <span class="n">v</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix equation has no solutions</span>
</pre></div>
</div>
<p>A ValueError is raised if the input is invalid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">number of rows of self must equal number of rows of B</span>
</pre></div>
</div>
<p>We solve with A singular:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]);</span> <span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[ 6 -6]</span>
<span class="go">[ 0  0]</span>
<span class="go">[ 0  0]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We illustrate left associativity, etc., of the backslash operator.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span> \ <span class="n">A</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">A</span> \ <span class="n">A</span> \ <span class="n">A</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="mi">1</span><span class="p">)</span> \ <span class="n">A</span>
<span class="go">[1 2]</span>
<span class="go">[3 4]</span>
<span class="gp">sage: </span><span class="n">A</span> \ <span class="p">(</span><span class="n">A</span> \ <span class="n">A</span><span class="p">)</span>
<span class="go">[  -2    1]</span>
<span class="go">[ 3/2 -1/2]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span> \ <span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="mi">2</span><span class="p">);</span> <span class="n">X</span>
<span class="go">[ 5 -2]</span>
<span class="go">[-3  2]</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">*</span> <span class="n">X</span>
<span class="go">[-1  2]</span>
<span class="go">[ 3  2]</span>
</pre></div>
</div>
<p>Solving over a polynomial ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span> \ <span class="n">v</span>
<span class="gp">sage: </span><span class="n">X</span>
<span class="go">((-4/5*x^2 + 2/5*x + 9/10)/(x^3 + 1/10*x), (19/10*x^2 - 1/5*x - 3/10)/(x^3 + 1/10*x))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">*</span> <span class="n">X</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Solving some systems over <span class="math notranslate nohighlight">\(\ZZ/n\ZZ\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">(5, 1)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">matrix equation has no solutions</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">128</span><span class="p">),</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">[  5]</span>
<span class="go">[108]</span>
<span class="go">[127]</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="go">(5, 108, 127)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">Zmod</span><span class="p">(</span><span class="mi">15</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">*</span><span class="n">X</span> <span class="o">==</span> <span class="n">B</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Solving a system over the p-adics:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]);</span> <span class="n">a</span>
<span class="go">[    1 + O(5^4) 2 + 5 + O(5^4)     3 + O(5^4)]</span>
<span class="go">[    2 + O(5^4)     5 + O(5^5)     4 + O(5^4)]</span>
<span class="go">[    1 + O(5^4)     1 + O(5^4)     2 + O(5^4)]</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">a</span> \ <span class="n">v</span><span class="p">;</span> <span class="n">x</span>
<span class="go">(4 + 5 + 5^2 + 3*5^3 + O(5^4), 2 + 5 + 3*5^2 + 5^3 + O(5^4), 1 + 5 + O(5^4))</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Solving a system of linear equation symbolically using symbolic matrices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,b,c,d,x,y&#39;</span><span class="p">)</span>
<span class="go">(a, b, c, d, x, y)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">=</span><span class="n">matrix</span><span class="p">(</span><span class="n">SR</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">]);</span> <span class="n">A</span>
<span class="go">[a b]</span>
<span class="go">[c d]</span>
<span class="gp">sage: </span><span class="n">result</span><span class="o">=</span><span class="n">vector</span><span class="p">(</span><span class="n">SR</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]);</span> <span class="n">result</span>
<span class="go">(3, 5)</span>
<span class="gp">sage: </span><span class="n">soln</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">solve_right</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">soln</span>
<span class="go">(-b*(3*c/a - 5)/(a*(b*c/a - d)) + 3/a, (3*c/a - 5)/(b*c/a - d))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">simplify_full</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">c</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">d</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">y</span><span class="o">=</span><span class="n">soln</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">simplify_full</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span><span class="o">*</span><span class="n">soln</span><span class="p">)</span><span class="o">.</span><span class="n">apply_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">simplify_full</span><span class="p">())</span>
<span class="go">(3, 5)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.subdivide">
<code class="descname">subdivide</code><span class="sig-paren">(</span><em>row_lines=None</em>, <em>col_lines=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.subdivide" title="Permalink to this definition">¶</a></dt>
<dd><p>Divides self into logical submatrices which can then be queried and
extracted. If a subdivision already exists, this method forgets the
previous subdivision and flushes the cache.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">row_lines</span></code> - None, an integer, or a list of
integers (lines at which self must be split).</li>
<li><code class="docutils literal notranslate"><span class="pre">col_lines</span></code> - None, an integer, or a list of
integers (columns at which self must be split).</li>
</ul>
<p>OUTPUT: changes self</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One may also pass a tuple into the first argument which
will be interpreted as (row_lines, col_lines)</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">prime_range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 2  3  5| 7 11]</span>
<span class="go">[13 17 19|23 29]</span>
<span class="go">[--------+-----]</span>
<span class="go">[31 37 41|43 47]</span>
<span class="go">[53 59 61|67 71]</span>
<span class="go">[73 79 83|89 97]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[ 2  3  5]</span>
<span class="go">[13 17 19]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[31 37 41]</span>
<span class="go">[53 59 61]</span>
<span class="go">[73 79 83]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">31</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">()</span>
<span class="go">([2], [3])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[ 2| 3  5| 7 11]</span>
<span class="go">[13|17 19|23 29]</span>
<span class="go">[31|37 41|43 47]</span>
<span class="go">[53|59 61|67 71]</span>
<span class="go">[73|79 83|89 97]</span>
</pre></div>
</div>
<p>Degenerate cases work too:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[| 2| 3  5| 7 11]</span>
<span class="go">[|13|17 19|23 29]</span>
<span class="go">[+--+-----+-----]</span>
<span class="go">[|31|37 41|43 47]</span>
<span class="go">[|53|59 61|67 71]</span>
<span class="go">[|73|79 83|89 97]</span>
<span class="go">[+--+-----+-----]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[ 2]</span>
<span class="go">[13]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[|| 2|| 3  5  7 11]</span>
<span class="go">[||13||17 19 23 29]</span>
<span class="go">[++--++-----------]</span>
<span class="go">[++--++-----------]</span>
<span class="go">[||31||37 41 43 47]</span>
<span class="go">[++--++-----------]</span>
<span class="go">[||53||59 61 67 71]</span>
<span class="go">[||73||79 83 89 97]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[37 41 43 47]</span>
</pre></div>
</div>
<p>Indices do not need to be in the right order (<a class="reference external" href="https://trac.sagemath.org/14064">trac ticket #14064</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[ 2| 3  5| 7 11]</span>
<span class="go">[13|17 19|23 29]</span>
<span class="go">[--+-----+-----]</span>
<span class="go">[31|37 41|43 47]</span>
<span class="go">[53|59 61|67 71]</span>
<span class="go">[--+-----+-----]</span>
<span class="go">[73|79 83|89 97]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw (2007-06-14)</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.subdivision">
<code class="descname">subdivision</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.subdivision" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an immutable copy of the (i,j)th submatrix of self,
according to a previously set subdivision.</p>
<p>Before a subdivision is set, the only valid arguments are (0,0)
which returns self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 0  1| 2  3]</span>
<span class="go">[-----+-----]</span>
<span class="go">[ 4  5| 6  7]</span>
<span class="go">[ 8  9|10 11]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[2 3]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[4 5]</span>
<span class="go">[8 9]</span>
</pre></div>
</div>
<p>It handles size-zero subdivisions as well.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[+-----++-----+]</span>
<span class="go">[| 0  1|| 2  3|]</span>
<span class="go">[| 4  5|| 6  7|]</span>
<span class="go">[| 8  9||10 11|]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[4 5]</span>
<span class="go">[8 9]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.subdivision_entry">
<code class="descname">subdivision_entry</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.subdivision_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the x,y entry of the i,j submatrix of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[ 0  1  2| 3  4]</span>
<span class="go">[ 5  6  7| 8  9]</span>
<span class="go">[10 11 12|13 14]</span>
<span class="go">[--------+-----]</span>
<span class="go">[15 16 17|18 19]</span>
<span class="go">[20 21 22|23 24]</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="go">7</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">15</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="go">24</span>
</pre></div>
</div>
<p>Even though this entry exists in the matrix, the index is invalid
for the submatrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivision_entry</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">IndexError</span>: <span class="n">Submatrix 0,0 has no entry 4,0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.subdivisions">
<code class="descname">subdivisions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.subdivisions" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the current subdivision of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">()</span>
<span class="go">([], [])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">()</span>
<span class="go">([2], [3])</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span><span class="o">.</span><span class="n">subdivide</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">subdivisions</span><span class="p">());</span> <span class="n">N</span>
<span class="go">[1 0 0|0 0]</span>
<span class="go">[0 1 0|0 0]</span>
<span class="go">[-----+---]</span>
<span class="go">[0 0 1|0 0]</span>
<span class="go">[0 0 0|1 0]</span>
<span class="go">[0 0 0|0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.subs">
<code class="descname">subs</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>Substitute values to the variables in that matrix.</p>
<p>All the arguments are transmitted unchanged to the method <code class="docutils literal notranslate"><span class="pre">subs</span></code> of
the coefficients.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a,b,d,e&#39;</span><span class="p">)</span>
<span class="go">(a, b, d, e)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="n">d</span><span class="p">,</span><span class="n">e</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[1 b]</span>
<span class="go">[d e]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
<span class="go">[b d]</span>
<span class="go">[d e]</span>
<span class="gp">sage: </span><span class="n">m</span><span class="o">.</span><span class="n">subs</span><span class="p">({</span><span class="n">a</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="go">[ 3  2]</span>
<span class="go">[ 1 -1]</span>
</pre></div>
</div>
<p>The parent of the newly created matrix might be different from the
initial one. It depends on what the method <code class="docutils literal notranslate"><span class="pre">.subs</span></code> does on
coefficients (see <a class="reference external" href="https://trac.sagemath.org/19045">trac ticket #19045</a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">m2</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m2</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 1 by 1 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">m1</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">RDF</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">m1</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 1 by 1 dense matrices over Real Double Field</span>
</pre></div>
</div>
<p>However, sparse matrices remain sparse:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">({(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span> <span class="o">-</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">59</span><span class="p">,</span><span class="mi">38</span><span class="p">):</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">2</span><span class="p">},</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m1</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m1</span><span class="o">.</span><span class="n">is_sparse</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.symplectic_form">
<code class="descname">symplectic_form</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.symplectic_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a symplectic form for self if self is an anti-symmetric,
alternating matrix defined over a field.</p>
<p>Returns a pair (F, C) such that the rows of C form a symplectic
basis for self and F = C * self * C.transpose().</p>
<p>Raises a ValueError if not over a field, or self is not
anti-symmetric, or self is not alternating.</p>
<p>Anti-symmetric means that <span class="math notranslate nohighlight">\(M = -M^t\)</span>. Alternating means
that the diagonal of <span class="math notranslate nohighlight">\(M\)</span> is identically zero.</p>
<p>A symplectic basis is a basis of the form
<span class="math notranslate nohighlight">\(e_1, \ldots, e_j, f_1, \ldots f_j, z_1, \dots, z_k\)</span>
such that</p>
<ul class="simple">
<li><span class="math notranslate nohighlight">\(z_i M v^t\)</span> = 0 for all vectors <span class="math notranslate nohighlight">\(v\)</span></li>
<li><span class="math notranslate nohighlight">\(e_i M {e_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></li>
<li><span class="math notranslate nohighlight">\(f_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i, j\)</span></li>
<li><span class="math notranslate nohighlight">\(e_i M {f_i}^t = 1\)</span> for all <span class="math notranslate nohighlight">\(i\)</span></li>
<li><span class="math notranslate nohighlight">\(e_i M {f_j}^t = 0\)</span> for all <span class="math notranslate nohighlight">\(i\)</span> not equal
<span class="math notranslate nohighlight">\(j\)</span>.</li>
</ul>
<p>See the example for a pictorial description of such a basis.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">E</span>
<span class="go">[   0 -1/2   -2  1/2    2    0   -2    1]</span>
<span class="go">[ 1/2    0   -1   -3    0    2  5/2   -3]</span>
<span class="go">[   2    1    0  3/2   -1    0   -1   -2]</span>
<span class="go">[-1/2    3 -3/2    0    1  3/2 -1/2 -1/2]</span>
<span class="go">[  -2    0    1   -1    0    0    1   -1]</span>
<span class="go">[   0   -2    0 -3/2    0    0  1/2   -2]</span>
<span class="go">[   2 -5/2    1  1/2   -1 -1/2    0   -1]</span>
<span class="go">[  -1    3    2  1/2    1    2    1    0]</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">,</span> <span class="n">C</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">symplectic_form</span><span class="p">();</span> <span class="n">F</span>
<span class="go">[ 0  0  0  0  1  0  0  0]</span>
<span class="go">[ 0  0  0  0  0  1  0  0]</span>
<span class="go">[ 0  0  0  0  0  0  1  0]</span>
<span class="go">[ 0  0  0  0  0  0  0  1]</span>
<span class="go">[-1  0  0  0  0  0  0  0]</span>
<span class="go">[ 0 -1  0  0  0  0  0  0]</span>
<span class="go">[ 0  0 -1  0  0  0  0  0]</span>
<span class="go">[ 0  0  0 -1  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">==</span> <span class="n">C</span> <span class="o">*</span> <span class="n">E</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.tensor_product">
<code class="descname">tensor_product</code><span class="sig-paren">(</span><em>A</em>, <em>subdivide=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.tensor_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the tensor product of two matrices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> - a matrix</li>
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - default: True - whether or not to return
natural subdivisions with the matrix</li>
</ul>
<p>OUTPUT:</p>
<p>Replace each element of <code class="docutils literal notranslate"><span class="pre">self</span></code> by a copy of <code class="docutils literal notranslate"><span class="pre">A</span></code>, but first
create a scalar multiple of <code class="docutils literal notranslate"><span class="pre">A</span></code> by the element it replaces.
So if <code class="docutils literal notranslate"><span class="pre">self</span></code> is an <span class="math notranslate nohighlight">\(m\times n\)</span> matrix and <code class="docutils literal notranslate"><span class="pre">A</span></code> is a
<span class="math notranslate nohighlight">\(p\times q\)</span> matrix, then the tensor product is an <span class="math notranslate nohighlight">\(mp\times nq\)</span>
matrix.  By default, the matrix will be subdivided into
submatrices of size <span class="math notranslate nohighlight">\(p\times q\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M1</span><span class="o">=</span><span class="n">Matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,[[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M2</span><span class="o">=</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">M1</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
<span class="go">[  -1    1   -2|   0    0    0]</span>
<span class="go">[   2   -4   -8|   0    0    0]</span>
<span class="go">[--------------+--------------]</span>
<span class="go">[-1/2  1/2   -1|  -1    1   -2]</span>
<span class="go">[   1   -2   -4|   2   -4   -8]</span>
<span class="gp">sage: </span><span class="n">M2</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="go">[  -1    0|   1    0|  -2    0]</span>
<span class="go">[-1/2   -1| 1/2    1|  -1   -2]</span>
<span class="go">[---------+---------+---------]</span>
<span class="go">[   2    0|  -4    0|  -8    0]</span>
<span class="go">[   1    2|  -2   -4|  -4   -8]</span>
</pre></div>
</div>
<p>Subdivisions can be optionally suppressed.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M1</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">M2</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[  -1    1   -2    0    0    0]</span>
<span class="go">[   2   -4   -8    0    0    0]</span>
<span class="go">[-1/2  1/2   -1   -1    1   -2]</span>
<span class="go">[   1   -2   -4    2   -4   -8]</span>
</pre></div>
</div>
<p>Different base rings are handled sensibly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">FiniteField</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 6 by 12 dense matrices over Finite Field of size 23</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="n">B</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">unsupported operand parent(s) for *: &#39;Finite Field of size 29&#39; and &#39;Full MatrixSpace of 3 by 4 dense matrices over Finite Field of size 23&#39;</span>
</pre></div>
</div>
<p>The input is checked to be sure it is a matrix.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">tensor_product</span><span class="p">(</span><span class="s1">&#39;junk&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">tensor product requires a second matrix, not junk</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the trace of self, which is the sum of the diagonal entries
of self.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix</li>
</ul>
<p>OUTPUT: element of the base ring of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">a</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">({(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="mi">10</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">});</span> <span class="n">a</span>
<span class="go">[  0   0   0]</span>
<span class="go">[  0  10   0]</span>
<span class="go">[  0  -3 4/3]</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">34/3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.trace_of_product">
<code class="descname">trace_of_product</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.trace_of_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the trace of self * other without computing the entire product.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">trace_of_product</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="go">-1629</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">-1629</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.visualize_structure">
<code class="descname">visualize_structure</code><span class="sig-paren">(</span><em>maxsize=512</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.visualize_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize the non-zero entries</p>
<p>White pixels are put at positions with zero entries. If ‘maxsize’
is given, then the maximal dimension in either x or y direction is
set to ‘maxsize’ depending on which is bigger. If the image is
scaled, the darkness of the pixel reflects how many of the
represented entries are nonzero. So if e.g. one image pixel
actually represents a 2x2 submatrix, the dot is darker the more of
the four values are nonzero.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">maxsize</span></code> - integer (default: <code class="docutils literal notranslate"><span class="pre">512</span></code>). Maximal dimension
in either x or y direction of the resulting image. If
<code class="docutils literal notranslate"><span class="pre">None</span></code> or a maxsize larger than
<code class="docutils literal notranslate"><span class="pre">max(self.nrows(),self.ncols())</span></code> is given the image will
have the same pixelsize as the matrix dimensions.</li>
</ul>
<p>OUTPUT:</p>
<p>Bitmap image as an instance of
<a class="reference external" href="../../../repl/sage/repl/image.html#sage.repl.image.Image" title="(in Sage Reference Manual: The Sage Command Line v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">random_matrix</span><span class="p">(</span><span class="n">CC</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="n">M</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">M</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="n">img</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">visualize_structure</span><span class="p">();</span>  <span class="n">img</span>
<span class="go">7x5px 24-bit RGB image</span>
</pre></div>
</div>
<p>You can use <a class="reference external" href="../../../repl/sage/repl/image.html#sage.repl.image.Image.save" title="(in Sage Reference Manual: The Sage Command Line v8.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> to save the
resulting image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">filename</span> <span class="o">=</span> <span class="n">tmp_filename</span><span class="p">(</span><span class="n">ext</span><span class="o">=</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fobj</span><span class="p">:</span>
<span class="go">....:     fobj.read().startswith(b&#39;\x89PNG&#39;)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.wiedemann">
<code class="descname">wiedemann</code><span class="sig-paren">(</span><em>i</em>, <em>t=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.wiedemann" title="Permalink to this definition">¶</a></dt>
<dd><p>Application of Wiedemann’s algorithm to the i-th standard basis
vector.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">i</span></code> - an integer</li>
<li><code class="docutils literal notranslate"><span class="pre">t</span></code> - an integer (default: 0) if t is nonzero, use
only the first t linear recurrence relations.</li>
</ul>
<p>IMPLEMENTATION: This is a toy implementation.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">));</span> <span class="n">t</span>
<span class="go">[0 1 2]</span>
<span class="go">[3 4 5]</span>
<span class="go">[6 7 8]</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">wiedemann</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">x^2 - 12*x - 18</span>
<span class="gp">sage: </span><span class="n">t</span><span class="o">.</span><span class="n">charpoly</span><span class="p">()</span>
<span class="go">x^3 - 12*x^2 - 18*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.matrix.matrix2.Matrix.zigzag_form">
<code class="descname">zigzag_form</code><span class="sig-paren">(</span><em>subdivide=True</em>, <em>transformation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.Matrix.zigzag_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Find a matrix in ZigZag form that is similar to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> - a square matrix with entries from an exact field.</li>
<li><code class="docutils literal notranslate"><span class="pre">transformation</span></code> - default: False - if <code class="docutils literal notranslate"><span class="pre">True</span></code> return a
change-of-basis matrix relating the matrix and its ZigZag form.</li>
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> - default: <code class="docutils literal notranslate"><span class="pre">True</span></code> - if <code class="docutils literal notranslate"><span class="pre">True</span></code> the ZigZag
form matrix is subdivided according to the companion matrices
described in the output section below.</li>
</ul>
<p>OUTPUT:</p>
<p>A matrix in ZigZag form has blocks on the main diagonal that are
companion matrices.  The first companion matrix has ones just below
the main diagonal.  The last column has the negatives of coefficients
of a monic polynomial, but not the leading one.  Low degree monomials
have their coefficients in the earlier rows.  The second companion
matrix is like the first only transposed.  The third is like the first.
The fourth is like the second.  And so on.</p>
<p>These blocks on the main diagonal define blocks just off the diagonal.
To the right of the first companion matrix, and above the second
companion matrix is a block that is totally zero, except the entry
of the first row and first column may be a one.  Below the second
block and to the left of the third block is a block that is totally
zero, except the entry of the first row and first column may be one.
This alternating pattern continues. It may now be apparent how this
form gets its name.  Any other entry of the matrix is zero.  So this
form is reminiscent of rational canonical form and is a good precursor
to that form.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">transformation</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the output is a pair of
matrices.  The first is the form <code class="docutils literal notranslate"><span class="pre">Z</span></code> and the second is an invertible
matrix <code class="docutils literal notranslate"><span class="pre">U</span></code> such that <code class="docutils literal notranslate"><span class="pre">U.inverse()*self*U</span></code> equals <code class="docutils literal notranslate"><span class="pre">Z</span></code>.  In other
words, the representation of <code class="docutils literal notranslate"><span class="pre">self</span></code> with respect to the columns
of <code class="docutils literal notranslate"><span class="pre">U</span></code> will be <code class="docutils literal notranslate"><span class="pre">Z</span></code>.</p>
<p>If subdivide is <code class="docutils literal notranslate"><span class="pre">True</span></code> then the matrix returned as the form is
partitioned according to the companion matrices and these may be
manipulated by several different matrix methods.</p>
<p>For output that may be more useful as input to other routines,
see the helper method <code class="xref py py-meth docutils literal notranslate"><span class="pre">_zigzag_form()</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An effort has been made to optimize computation of the form,
but no such work has been done for the computation of the
transformation matrix, so for fastest results do not request the
transformation matrix.</p>
</div>
<p>ALGORITHM:</p>
<p>ZigZag form, and its computation, are due to Arne Storjohann
and are  described in <a class="reference internal" href="../../../references/index.html#sto2000" id="id11">[Sto2000]</a> and
<a class="reference internal" href="../../../references/index.html#sto1998" id="id12">[Sto1998]</a>, where the former is more
representative of the code here.</p>
<p>EXAMPLES:</p>
<p>Two examples that illustrate ZigZag form well. Notice that this is
<em>not</em> a canonical form.  The two matrices below are similar, since
they have equal Jordan canonical forms, yet their ZigZag forms are
quite different.  In other words, while the computation of the form
is deterministic, the final result, when viewed as a property of a
linear transformation, is dependent on the basis used for the
matrix representation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="o">-</span><span class="mi">68</span><span class="p">,</span>   <span class="mi">69</span><span class="p">,</span> <span class="o">-</span><span class="mi">27</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">65</span><span class="p">,</span>   <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">181</span><span class="p">,</span> <span class="o">-</span><span class="mi">32</span><span class="p">],</span>
<span class="go">....:                 [-52,   52, -27,  -8, -52, -16, -133, -14],</span>
<span class="go">....:                 [ 92,  -97,  47,  14,  90,  32,  241,  18],</span>
<span class="go">....:                 [139, -144,  60,  18, 148, -10,  362,  77],</span>
<span class="go">....:                 [ 40,  -41,  12,   6,  45, -24,  105,  42],</span>
<span class="go">....:                 [-46,   48, -20,  -7, -47,   0, -122, -22],</span>
<span class="go">....:                 [-26,   27, -13,  -4, -29,  -6,  -66, -14],</span>
<span class="go">....:                 [-33,   34, -13,  -5, -35,   7,  -87, -23]])</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span>
<span class="go">[  0   0   0  40|  1   0|  0   0]</span>
<span class="go">[  1   0   0  52|  0   0|  0   0]</span>
<span class="go">[  0   1   0  18|  0   0|  0   0]</span>
<span class="go">[  0   0   1  -1|  0   0|  0   0]</span>
<span class="go">[---------------+-------+-------]</span>
<span class="go">[  0   0   0   0|  0   1|  0   0]</span>
<span class="go">[  0   0   0   0|-25  10|  0   0]</span>
<span class="go">[---------------+-------+-------]</span>
<span class="go">[  0   0   0   0|  1   0|  0  -4]</span>
<span class="go">[  0   0   0   0|  0   0|  1  -4]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">A</span><span class="o">*</span><span class="n">U</span> <span class="o">==</span> <span class="n">Z</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="mi">16</span><span class="p">,</span>  <span class="mi">69</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">52</span><span class="p">,</span>  <span class="mi">143</span><span class="p">,</span>   <span class="mi">90</span><span class="p">,</span>  <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [ 26,  54,   6,  -5, -28,   73,   73, -48],</span>
<span class="go">....:                 [-16, -79,  12, -10,  64, -142, -115,  41],</span>
<span class="go">....:                 [ 27,  -7,  21, -33,  39,  -20,  -42,  43],</span>
<span class="go">....:                 [  8, -75,  34, -32,  86, -156, -130,  42],</span>
<span class="go">....:                 [  2, -17,   7,  -8,  20,  -33,  -31,  16],</span>
<span class="go">....:                 [-24, -80,   7,  -3,  56, -136, -112,  42],</span>
<span class="go">....:                 [ -6, -19,   0,  -1,  13,  -28,  -27,  15]])</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span>
<span class="go">[   0    0    0    0    0 1000|   0|   0]</span>
<span class="go">[   1    0    0    0    0  900|   0|   0]</span>
<span class="go">[   0    1    0    0    0  -30|   0|   0]</span>
<span class="go">[   0    0    1    0    0 -153|   0|   0]</span>
<span class="go">[   0    0    0    1    0    3|   0|   0]</span>
<span class="go">[   0    0    0    0    1    9|   0|   0]</span>
<span class="go">[-----------------------------+----+----]</span>
<span class="go">[   0    0    0    0    0    0|  -2|   0]</span>
<span class="go">[-----------------------------+----+----]</span>
<span class="go">[   0    0    0    0    0    0|   1|  -2]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">B</span><span class="o">*</span><span class="n">U</span> <span class="o">==</span> <span class="n">Z</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">B</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Two more examples, illustrating the two extremes of the zig-zag
nature of this form.  The first has a one in each of the
off-diagonal blocks, the second has all zeros in each off-diagonal
block.  Notice again that the two matrices are similar, since their
Jordan canonical forms are equal.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">31</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span>  <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">125</span><span class="p">,</span>  <span class="mi">13</span><span class="p">,</span>  <span class="mi">62</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">],</span>
<span class="go">....:                 [0,  48, -16, -16, -188,  20,  92, -16],</span>
<span class="go">....:                 [0,   9,  -1,   2,  -33,   5,  18,   0],</span>
<span class="go">....:                 [0,  15,  -5,   0,  -59,   7,  30,  -4],</span>
<span class="go">....:                 [0, -21,   7,   2,   84, -10, -42,   5],</span>
<span class="go">....:                 [0, -42,  14,   8,  167, -17, -84,  13],</span>
<span class="go">....:                 [0, -50,  17,  10,  199, -23, -98,  14],</span>
<span class="go">....:                 [0,  15,  -5,  -2,  -59,   7,  30, -2]])</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span>
<span class="go">[2|1|0|0|0|0|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|2|0|0|0|0|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|1|2|1|0|0|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|0|0|2|0|0|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|0|0|1|2|1|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|0|0|0|0|2|0|0]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|0|0|0|0|1|2|1]</span>
<span class="go">[-+-+-+-+-+-+-+-]</span>
<span class="go">[0|0|0|0|0|0|0|2]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">C</span><span class="o">*</span><span class="n">U</span> <span class="o">==</span> <span class="n">Z</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[[</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">3</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>  <span class="o">-</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">5</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>   <span class="o">-</span><span class="mi">3</span><span class="p">],</span>
<span class="go">....:                 [ -6,   5,    7,   2,  -4,   5,    7,   -3],</span>
<span class="go">....:                 [ 21, -12,   89,  25,   8,  27,   98,  -95],</span>
<span class="go">....:                 [ -9,   5,  -44, -11,  -3, -13,  -48,   47],</span>
<span class="go">....:                 [ 23, -13,   74,  21,  12,  22,   85,  -84],</span>
<span class="go">....:                 [ 31, -18,  135,  38,  12,  47,  155, -147],</span>
<span class="go">....:                 [-33,  19, -138, -39, -13, -45, -156,  151],</span>
<span class="go">....:                 [ -7,   4,  -29,  -8,  -3, -10,  -34,  34]])</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="p">,</span> <span class="n">U</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z</span>
<span class="go">[ 0 -4| 0  0| 0  0| 0  0]</span>
<span class="go">[ 1  4| 0  0| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  1| 0  0| 0  0]</span>
<span class="go">[ 0  0|-4  4| 0  0| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0 -4| 0  0]</span>
<span class="go">[ 0  0| 0  0| 1  4| 0  0]</span>
<span class="go">[-----+-----+-----+-----]</span>
<span class="go">[ 0  0| 0  0| 0  0| 0  1]</span>
<span class="go">[ 0  0| 0  0| 0  0|-4  4]</span>
<span class="gp">sage: </span><span class="n">U</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">U</span> <span class="o">==</span> <span class="n">Z</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span> <span class="o">==</span> <span class="n">D</span><span class="o">.</span><span class="n">jordan_form</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>ZigZag form is achieved entirely with the operations of the field, so
while the eigenvalues may lie outside the field, this does not impede
the computation of the form.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span>     <span class="n">a</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                [     0,a^2 + 1,  0,     0],</span>
<span class="go">....:                [     0,      0,a^3,     0],</span>
<span class="go">....:                [a^2 +4 ,     0,   0,a + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">()</span>
<span class="go">[                    0 a^3 + 2*a^2 + 2*a + 2|                    0|                    0]</span>
<span class="go">[                    1               2*a + 2|                    0|                    0]</span>
<span class="go">[-------------------------------------------+---------------------+---------------------]</span>
<span class="go">[                    0                     0|                  a^3|                    0]</span>
<span class="go">[-------------------------------------------+---------------------+---------------------]</span>
<span class="go">[                    0                     0|                    0|              a^2 + 1]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">algebraic closures of finite fields are only implemented for prime fields</span>
</pre></div>
</div>
<p>Subdivisions are optional.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[[</span>     <span class="n">a</span><span class="p">,</span>      <span class="mi">0</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="p">],</span>
<span class="go">....:                [     0,a^2 + 1,  0,     0],</span>
<span class="go">....:                [     0,      0,a^3,     0],</span>
<span class="go">....:                [a^2 +4 ,     0,   0,a + 2]])</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">zigzag_form</span><span class="p">(</span><span class="n">subdivide</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[                    0 a^3 + 2*a^2 + 2*a + 2                     0                     0]</span>
<span class="go">[                    1               2*a + 2                     0                     0]</span>
<span class="go">[                    0                     0                   a^3                     0]</span>
<span class="go">[                    0                     0                     0               a^2 + 1]</span>
</pre></div>
</div>
<p>AUTHOR:</p>
<ul class="simple">
<li>Rob Beezer (2011-06-09)</li>
</ul>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.matrix.matrix2.decomp_seq">
<code class="descclassname">sage.matrix.matrix2.</code><code class="descname">decomp_seq</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.matrix.matrix2.decomp_seq" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is used internally be the decomposition matrix
method. It takes a list of tuples and produces a sequence that is
correctly sorted and prints with carriage returns.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.matrix.matrix2</span> <span class="kn">import</span> <span class="n">decomp_seq</span>
<span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[(</span><span class="n">QQ</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="n">QQ</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">decomp_seq</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">(Vector space of dimension 2 over Rational Field, 1),</span>
<span class="go">(Vector space of dimension 3 over Rational Field, 2)</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="matrix1.html"
                        title="previous chapter">Base class for matrices, part 1</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="strassen.html"
                        title="next chapter">Generic Asymptotically Fast Strassen Algorithms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/matrix/matrix2.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="strassen.html" title="Generic Asymptotically Fast Strassen Algorithms"
             >next</a> |</li>
        <li class="right" >
          <a href="matrix1.html" title="Base class for matrices, part 1"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Matrices and Spaces of Matrices</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>