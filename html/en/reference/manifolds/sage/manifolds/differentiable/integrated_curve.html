
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Integrated Curves and Geodesics in Manifolds &#8212; Sage 9.1 Reference Manual: Manifolds</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Tangent Spaces" href="../../../tangent_space.html" />
    <link rel="prev" title="Curves in Manifolds" href="curve.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../tangent_space.html" title="Tangent Spaces"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="curve.html" title="Curves in Manifolds"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.1 Reference Manual: Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../diff_manifold.html" >Differentiable Manifolds</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../diff_map.html" accesskey="U">Differentiable Maps and Curves</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="integrated-curves-and-geodesics-in-manifolds">
<span id="sage-manifolds-differentiable-integrated-curve"></span><h1>Integrated Curves and Geodesics in Manifolds<a class="headerlink" href="#integrated-curves-and-geodesics-in-manifolds" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.manifolds.differentiable.integrated_curve"></span><p>Given a differentiable manifold <span class="math notranslate nohighlight">\(M\)</span>, an <em>integrated curve</em> in <span class="math notranslate nohighlight">\(M\)</span>
is a differentiable curve constructed as a solution to a system of
second order differential equations.</p>
<p>Integrated curves are implemented by the class <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a>, from
which the classes <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurve</span></code></a> and
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic" title="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedGeodesic</span></code></a> inherit.</p>
<p class="rubric">Example: a geodesic in the hyperbolic plane</p>
<p>First declare the hyperbolic plane as a 2-dimensional Riemannian manifold <code class="docutils literal notranslate"><span class="pre">M</span></code>
and introduce the chart <code class="docutils literal notranslate"><span class="pre">X</span></code> corresponding to the Poincaré half-plane model:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x y:(0,+oo)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then set the metric to be the hyperbolic one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">g = y^(-2) dx*dx + y^(-2) dy*dy</span>
</pre></div>
</div>
<p>Pick an initial point and an initial tangent vector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">v = d/dx + 3/2 d/dy</span>
</pre></div>
</div>
<p>Declare a geodesic with such initial conditions, denoting by <span class="math notranslate nohighlight">\(t\)</span> the
corresponding affine parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Numerically integrate the geodesic (see <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> for
all possible options, including the choice of the numerical algorithm):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
</pre></div>
</div>
<p>Plot the geodesic after interpolating the solution <code class="docutils literal notranslate"><span class="pre">sol</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">graph</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p_plot</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">label_offset</span><span class="o">=-</span><span class="mf">0.07</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v_plot</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label_offset</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph</span> <span class="o">+</span> <span class="n">p_plot</span> <span class="o">+</span> <span class="n">v_plot</span>
<span class="go">Graphics object consisting of 5 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-1.svg" src="../../../_images/integrated_curve-1.svg" /></div>
<p><span class="math notranslate nohighlight">\(c\)</span> is a differentiable curve in <span class="math notranslate nohighlight">\(M\)</span> and inherits from the properties of
<a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve" title="sage.manifolds.differentiable.curve.DifferentiableCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">DifferentiableCurve</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Real interval (0, 10)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">2-dimensional Riemannian manifold M</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">c: (0, 10) --&gt; M</span>
</pre></div>
</div>
<p>In particular, its value at <span class="math notranslate nohighlight">\(t=1\)</span> is:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Point on the 2-dimensional Riemannian manifold M</span>
</pre></div>
</div>
<p>which corresponds to the following <span class="math notranslate nohighlight">\((x, y)\)</span> coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>  <span class="c1"># abs tol 1e-12</span>
<span class="go">(2.4784140715580136, 1.5141683866138937)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Karim Van Aelst (2017): initial version</li>
<li>Florentin Jaffredo (2018): integration over multiple charts, use of
<code class="docutils literal notranslate"><span class="pre">fast_callable</span></code> to improve the computation speed</li>
</ul>
<dl class="class">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve">
<em class="property">class </em><code class="descclassname">sage.manifolds.differentiable.integrated_curve.</code><code class="descname">IntegratedAutoparallelCurve</code><span class="sig-paren">(</span><em>parent</em>, <em>affine_connection</em>, <em>curve_parameter</em>, <em>initial_tangent_vector</em>, <em>chart=None</em>, <em>name=None</em>, <em>latex_name=None</em>, <em>verbose=False</em>, <em>across_charts=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.manifolds.differentiable.integrated_curve.IntegratedCurve</span></code></a></p>
<p>Autoparallel curve on the manifold with respect to a given
affine connection.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedAutoparallelCurveSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedAutoparallelCurveSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedAutoparallelCurveSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{autoparallel}}(I, M)\)</span> to which the
curve belongs</li>
<li><code class="docutils literal notranslate"><span class="pre">affine_connection</span></code> –
<a class="reference internal" href="affine_connection.html#sage.manifolds.differentiable.affine_connection.AffineConnection" title="sage.manifolds.differentiable.affine_connection.AffineConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">AffineConnection</span></code></a>
affine connection with respect to which the curve is autoparallel</li>
<li><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression to be used as the
parameter of the curve (the equations defining an instance of
IntegratedAutoparallelCurve are such that <code class="docutils literal notranslate"><span class="pre">t</span></code> will actually be
an affine parameter of the curve)</li>
<li><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in terms of
which the equations are expressed; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</li>
</ul>
<p>EXAMPLES:</p>
<p>Autoparallel curves associated with the Mercator projection of the
unit 2-sphere <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="https://idontgetoutmuch.wordpress.com/2016/11/24/mercator-a-connection-with-torsion/">https://idontgetoutmuch.wordpress.com/2016/11/24/mercator-a-connection-with-torsion/</a>
for more details about Mercator projection.</p>
</div>
<p>On the Mercator projection, the lines of longitude all appear
vertical and then all parallel with respect to each other.
Likewise, all the lines of latitude appear horizontal and parallel
with respect to each other.
These curves may be recovered as autoparallel curves of a certain
connection <span class="math notranslate nohighlight">\(\nabla\)</span> to be made explicit.</p>
<p>Start with declaring the standard polar coordinates
<span class="math notranslate nohighlight">\((\theta, \phi)\)</span> on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and the
corresponding coordinate frame <span class="math notranslate nohighlight">\((e_{\theta}, e_{\phi})\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">polar</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;=</span><span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
<p>Normalizing <span class="math notranslate nohighlight">\(e_{\phi}\)</span> provides an orthonormal basis:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ch_basis</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">automorphism_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ch_basis</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">ch_basis</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">epolar_ON</span> <span class="o">=</span> <span class="n">epolar</span><span class="o">.</span><span class="n">new_frame</span><span class="p">(</span><span class="n">ch_basis</span><span class="p">,</span><span class="s1">&#39;epolar_ON&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Denote <span class="math notranslate nohighlight">\((\hat{e}_{\theta}, \hat{e}_{\phi})\)</span> such an orthonormal frame
field. In any point, the vector field <span class="math notranslate nohighlight">\(\hat{e}_{\theta}\)</span> is
normalized and tangent to the line of longitude through the point.
Likewise, <span class="math notranslate nohighlight">\(\hat{e}_{\phi}\)</span> is normalized and tangent to the
line of latitude.</p>
<p>Now, set an affine connection with respect to such fields that are
parallely transported in all directions, that is:
<span class="math notranslate nohighlight">\(\nabla \hat{e}_{\theta} = \nabla \hat{e}_{\phi} = 0\)</span>.
This is equivalent to setting all the connection coefficients to
zero with respect to this frame:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nab</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nab&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nab</span><span class="o">.</span><span class="n">set_coef</span><span class="p">(</span><span class="n">frame</span><span class="o">=</span><span class="n">epolar_ON</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
<p>This connection is such that two vectors are parallel if their
angles to a given meridian are the same.
Check that this connection is compatible with the Euclidean
metric tensor <span class="math notranslate nohighlight">\(g\)</span> induced on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">nab</span><span class="p">(</span><span class="n">g</span><span class="p">)[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]</span>
</pre></div>
</div>
<p>Yet, this connection is not the Levi-Civita connection, which
implies that it has non-vanishing torsion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">nab</span><span class="o">.</span><span class="n">torsion</span><span class="p">()[:]</span>
<span class="go">[[[0, 0], [0, 0]], [[0, cos(th)/sin(th)], [-cos(th)/sin(th), 0]]]</span>
</pre></div>
</div>
<p>Set generic initial conditions for the autoparallel curves to
compute:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar_ON</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<p>Note here that the components <code class="docutils literal notranslate"><span class="pre">(v_th0,</span> <span class="pre">v_ph0)</span></code> of the initial
tangent vector <code class="docutils literal notranslate"><span class="pre">v</span></code> refer to the basis
<code class="docutils literal notranslate"><span class="pre">epolar_ON</span></code> <span class="math notranslate nohighlight">\(= (\hat{e}_{\theta}, \hat{e}_{\phi})\)</span>
and not the coordinate basis <code class="docutils literal notranslate"><span class="pre">epolar</span></code> <span class="math notranslate nohighlight">\(= (e_{\theta}, e_{\phi})\)</span>.
This is merely to help picture the aspect of the tangent vector in
the usual embedding of <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> in
<span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> thanks to using an orthonormal frame,
since providing the components with respect to the coordinate basis
would require multiplying the second component (i.e. the <span class="math notranslate nohighlight">\(\phi\)</span>
component) in order to picture the vector in the same way.
This subtlety will need to be taken into account later when the
numerical curve will be compared to the analytical solution.</p>
<p>Now, declare the corresponding integrated autoparallel curve and display
the differential system it satisfies:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span>
<span class="gp">....: </span>                                 <span class="n">v</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Autoparallel curve c in the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 equipped with Affine connection nab on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2, and integrated over</span>
<span class="go"> the Real interval (tmin, tmax) as a solution to the following</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>

<span class="go">Initial point: Point p on the 2-dimensional differentiable</span>
<span class="go"> manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go"> Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional differentiable manifold S^2 with</span>
<span class="go"> components [v_th0, v_ph0/sin(th0)] with respect to Chart (S^2, (th, ph))</span>

<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = 0</span>
<span class="go">d(Dph)/dt = -Dph*Dth*cos(th)/sin(th)</span>
</pre></div>
</div>
<p>Set a dictionary providing the parameter range and the initial
conditions for a line of latitude and a line of longitude:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;latit&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>  <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">0</span><span class="p">}}</span>
</pre></div>
</div>
<p>Declare the Mercator coordinates <span class="math notranslate nohighlight">\((\xi, \zeta)\)</span> and the
corresponding coordinate change from the polar coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">mercator</span><span class="o">.&lt;</span><span class="n">xi</span><span class="p">,</span><span class="n">ze</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;xi:(-oo,oo):\xi ze:(0,2*pi):\zeta&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">polar</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">mercator</span><span class="p">,</span> <span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th</span><span class="o">/</span><span class="mi">2</span><span class="p">)),</span> <span class="n">ph</span><span class="p">))</span>
<span class="go">Change of coordinates from Chart (S^2, (th, ph)) to Chart</span>
<span class="go"> (S^2, (xi, ze))</span>
</pre></div>
</div>
<p>Ask for the identity map in terms of these charts in order to add
this coordinate change to its dictionary of expressions. This is
required to plot the curve with respect to the Mercator chart:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">identity</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">identity_map</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">identity</span><span class="o">.</span><span class="n">coord_functions</span><span class="p">(</span><span class="n">polar</span><span class="p">,</span> <span class="n">mercator</span><span class="p">)</span>
<span class="go">Coordinate functions (log(sin(1/2*th)/cos(1/2*th)), ph) on the</span>
<span class="go"> Chart (S^2, (th, ph))</span>
</pre></div>
</div>
<p>Solve, interpolate and prepare the plot for the solutions
corresponding to the two initial conditions previously set:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph2D_mercator</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                       <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">....: </span>    <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                          <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">graph2D_mercator</span><span class="o">+=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                              <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Prepare a grid of Mercator coordinates lines, and plot the curves
over it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph2D_mercator_coords</span><span class="o">=</span><span class="n">mercator</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">....: </span>                           <span class="n">number_values</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph2D_mercator</span> <span class="o">+</span> <span class="n">graph2D_mercator_coords</span>
<span class="go">Graphics object consisting of 18 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-2.svg" src="../../../_images/integrated_curve-2.svg" /></div>
<p>The resulting curves are horizontal and vertical as expected.
It is easier to check that these are latitude and longitude lines
respectively when plotting them on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.
To do so, use <span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> as the codomain of the standard
map embedding <span class="math notranslate nohighlight">\((\mathbb{S}^{2}, (\theta, \phi))\)</span> in the
3-dimensional Euclidean space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cart</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">....: </span> <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
<p>Plot the resulting curves on the grid of polar coordinates lines on
<span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph3D_embedded_curves</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">graph3D_embedded_curves</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>           <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....: </span>           <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">....: </span>                         <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....: </span>                         <span class="n">number_values</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph3D_embedded_curves</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-3.svg" src="../../../_images/integrated_curve-3.svg" /></div>
<p>Finally, one may plot a general autoparallel curve with respect to
<span class="math notranslate nohighlight">\(\nabla\)</span> that is neither a line of latitude or longitude.
The vectors tangent to such a curve make an angle different from 0
or <span class="math notranslate nohighlight">\(\pi/2\)</span> with the lines of latitude and longitude.
Then, compute a curve such that both components of its initial
tangent vectors are non zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span> <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                         <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the resulting curve in the Mercator plane.
This generates a straight line, as expected:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-4.svg" src="../../../_images/integrated_curve-4.svg" /></div>
<p>One may eventually plot such a curve on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-5.svg" src="../../../_images/integrated_curve-5.svg" /></div>
<p>All the curves presented are loxodromes, and the differential system
defining them (displayed above) may be solved analytically,
providing the following expressions:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\theta(t) &amp;= \theta_{0} + \dot{\theta}_{0} (t - t_{0}),      \\
\phi(t) &amp;= \phi_{0} - \frac{1}{\tan \alpha} \left(
\ln \tan \frac{\theta_{0} + \dot{\theta}_{0} (t - t_{0})}{2} -
\ln \tan \frac{\theta_{0}}{2} \right),
\end{aligned}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the angle between the curve and any latitude
line it crosses; then, one finds
<span class="math notranslate nohighlight">\(\tan \alpha = - \dot{\theta}_{0} / (\dot{\phi}_{0} \sin \theta_{0})\)</span>
(then <span class="math notranslate nohighlight">\(\tan \alpha \leq 0\)</span> when the initial tangent vector
points towards the southeast).</p>
<p>In order to use these expressions to compare with the result
provided by the numerical integration, remember that the components
<code class="docutils literal notranslate"><span class="pre">(v_th0,</span> <span class="pre">v_ph0)</span></code> of the initial
tangent vector <code class="docutils literal notranslate"><span class="pre">v</span></code> refer to the basis
<code class="docutils literal notranslate"><span class="pre">epolar_ON</span></code> <span class="math notranslate nohighlight">\(= (\hat{e}_{\theta}, \hat{e}_{\phi})\)</span> and not the
coordinate basis
<code class="docutils literal notranslate"><span class="pre">epolar</span></code> <span class="math notranslate nohighlight">\(= (e_{\theta}, e_{\phi})\)</span>.
Therefore, the following relations hold:
<code class="docutils literal notranslate"><span class="pre">v_ph0</span></code> <span class="math notranslate nohighlight">\(= \dot{\phi}_{0} \sin \theta_{0}\)</span> (and not merely
<span class="math notranslate nohighlight">\(\dot{\phi}_{0}\)</span>), while <code class="docutils literal notranslate"><span class="pre">v_th0</span></code> clearly is <span class="math notranslate nohighlight">\(\dot{\theta}_{0}\)</span>.</p>
<p>With this in mind, plot an analytical curve to compare with a
numerical solution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph2D_mercator_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                              <span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">expr_ph</span> <span class="o">=</span> <span class="n">ph0</span><span class="o">+</span><span class="n">v_ph0</span><span class="o">/</span><span class="n">v_th0</span><span class="o">*</span><span class="p">(</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">((</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="o">+</span><span class="n">th0</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">-</span><span class="n">ln</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">th0</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">c_loxo</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">curve</span><span class="p">({</span><span class="n">polar</span><span class="p">:[</span><span class="n">th0</span><span class="o">+</span><span class="n">v_th0</span><span class="o">*</span><span class="n">t</span><span class="p">,</span> <span class="n">expr_ph</span><span class="p">]},</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="gp">....: </span>                                            <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c_loxo&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Ask for the expression of the loxodrome in terms of the Mercator
chart in order to add it to its dictionary of expressions.
It is a particularly long expression, and there is no particular
need to display it, which is why it may simply be affected to an
arbitrary variable <code class="docutils literal notranslate"><span class="pre">expr_mercator</span></code>, which will never be used
again.
But adding the expression to the dictionary is required to plot the
curve with respect to the Mercator chart:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">expr_mercator</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="n">chart2</span><span class="o">=</span><span class="n">mercator</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the curves (for clarity, set a 2 degrees shift in the initial
value of <span class="math notranslate nohighlight">\(\theta_{0}\)</span> so that the curves do not overlap):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph2D_mercator_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">mercator</span><span class="p">,</span>
<span class="gp">....: </span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span>
<span class="gp">....: </span> <span class="n">thickness</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph2D_mercator_angle_curve</span> <span class="o">+</span> <span class="n">graph2D_mercator_loxo</span>
<span class="go">Graphics object consisting of 2 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-6.svg" src="../../../_images/integrated_curve-6.svg" /></div>
<p>Both curves do have the same aspect.
One may eventually compare these curves on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph3D_embedded_angle_curve</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-angle&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                    <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph3D_embedded_loxo</span> <span class="o">=</span> <span class="n">c_loxo</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....: </span> <span class="n">parameters</span><span class="o">=</span><span class="p">{</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">,</span> <span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span>
<span class="gp">....: </span> <span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">graph3D_embedded_angle_curve</span> <span class="o">+</span> <span class="n">graph3D_embedded_loxo</span>
<span class="gp">....: </span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span><span class="p">)</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-7.svg" src="../../../_images/integrated_curve-7.svg" /></div>
<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve.system">
<code class="descname">system</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a detailed description of the system defining the
autoparallel curve and returns the system defining it: chart,
equations and initial conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints a detailed
description of the curve</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list containing the<ul>
<li>the equations</li>
<li>the initial conditions</li>
<li>the chart</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>System defining an autoparallel curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A B&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nab</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">affine_connection</span><span class="p">(</span><span class="s1">&#39;nabla&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\nabla&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">nab</span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">A</span><span class="o">*</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="n">B</span><span class="o">*</span><span class="n">x2</span><span class="o">*</span><span class="n">x3</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_autoparallel_curve</span><span class="p">(</span><span class="n">nab</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Autoparallel curve in the 3-dimensional differentiable</span>
<span class="go"> manifold M equipped with Affine connection nabla on the</span>
<span class="go"> 3-dimensional differentiable manifold M, and integrated</span>
<span class="go"> over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following equations, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = -A*Dx1*Dx2*x1^2</span>
<span class="go">d(Dx2)/dt = 0</span>
<span class="go">d(Dx3)/dt = -B*Dx2*Dx3*x2*x3</span>

<span class="gp">sage: </span><span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve">
<em class="property">class </em><code class="descclassname">sage.manifolds.differentiable.integrated_curve.</code><code class="descname">IntegratedCurve</code><span class="sig-paren">(</span><em>parent</em>, <em>equations_rhs</em>, <em>velocities</em>, <em>curve_parameter</em>, <em>initial_tangent_vector</em>, <em>chart=None</em>, <em>name=None</em>, <em>latex_name=None</em>, <em>verbose=False</em>, <em>across_charts=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve" title="sage.manifolds.differentiable.curve.DifferentiableCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.manifolds.differentiable.curve.DifferentiableCurve</span></code></a></p>
<p>Given a chart with coordinates denoted <span class="math notranslate nohighlight">\((x_{1}, \ldots, x_{n})\)</span>,
an instance of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a> is a curve
<span class="math notranslate nohighlight">\(t \mapsto (x_{1}(t), \ldots, x_{n}(t))\)</span> constructed as a
solution to a system of second order differential equations
satisfied by the coordinate curves <span class="math notranslate nohighlight">\(t \mapsto x_{i}(t)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedCurveSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedCurveSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurveSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{integrated}}(I, M)\)</span> to which the
curve belongs</li>
<li><code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> – list of the right-hand sides of the equations
on the velocities only (the term <em>velocity</em> referring to the
derivatives <span class="math notranslate nohighlight">\(d x_{i} / dt\)</span> of the coordinate curves)</li>
<li><code class="docutils literal notranslate"><span class="pre">velocities</span></code> – list of the symbolic expressions used in
<code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> to denote the velocities</li>
<li><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression used in
<code class="docutils literal notranslate"><span class="pre">equations_rhs</span></code> to denote the parameter of the curve (denoted
<span class="math notranslate nohighlight">\(t\)</span> in the descriptions above)</li>
<li><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in
which the equations are given; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to
denote the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</li>
</ul>
<p>EXAMPLES:</p>
<p>Motion of a charged particle in an axial magnetic field linearly
increasing in time and exponentially decreasing in space:</p>
<div class="math notranslate nohighlight">
\[\mathbf{B}(t,\mathbf{x}) = \frac{B_{0}t}{T} \exp \left(
-\frac{ x_{1}^{2} + x_{2}^{2} }{ L^{2} } \right) \mathbf{e_{3}}.\]</div>
<p>Equations of motion are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\ddot{x}_{1}(t) &amp;= \frac{qB(t,\mathbf{x}(t))}{m} \dot{x}_{2}(t), \\
\ddot{x}_{2}(t) &amp;= -\frac{qB(t, \mathbf{x}(t))}{m} \dot{x}_{1}(t), \\
\ddot{x}_{3}(t) &amp;= 0.
\end{aligned}\end{split}\]</div>
<p>Start with declaring a chart on a 3-dimensional manifold and the
symbolic expressions denoting the velocities and the various
parameters:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="go">(t, B_0, m, q, L, T)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">();</span> <span class="n">D</span>
<span class="go">[Dx1, Dx2, Dx3]</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Set the initial conditions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>Declare an integrated curve and display information relative to it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                                             <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">The curve was correctly set.</span>
<span class="go">Parameters appearing in the differential system defining the</span>
<span class="go"> curve are [B_0, L, T, m, q].</span>
<span class="gp">sage: </span><span class="n">c</span>
<span class="go">Integrated curve c in the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to the</span>
<span class="go"> following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on</span>
<span class="go"> the 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>
</pre></div>
</div>
<p>Generate a solution of the system and an interpolation of this
solution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Numerical integration completed.</span>

<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>

<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;carac time 1&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>               <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Interpolation completed and associated with the key &#39;interp 1&#39;</span>
<span class="go"> (if this key already referred to a former interpolation,</span>
<span class="go"> such an interpolation was erased).</span>
</pre></div>
</div>
<p>Such an interpolation is required to evaluate the curve and the
vector tangent to the curve for any value of the curve parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Evaluating point coordinates from the interpolation associated</span>
<span class="go"> with the key &#39;interp 1&#39; by default...</span>
<span class="gp">sage: </span><span class="n">p</span>
<span class="go">Point on the 3-dimensional differentiable manifold M</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">(1.377689074756845, -0.900114533011232, 1.9)</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">4.3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp 1&#39; by default...</span>
<span class="gp">sage: </span><span class="n">v2</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage: </span><span class="n">v2</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[-0.9425156073651124, -0.33724314284285434, 1.0]</span>
</pre></div>
</div>
<p>Plotting a numerical solution (with or without its tangent vector
field) also requires the solution to be interpolated at least once:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c_plot_2d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>
<span class="gp">....: </span>              <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">....: </span>              <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="gp">....: </span>              <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">....: </span>              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">....: </span>              <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">A tiny final offset equal to 0.000251256281407035 was introduced</span>
<span class="go"> for the last point in order to safely compute it from the</span>
<span class="go"> interpolation.</span>
<span class="gp">sage: </span><span class="n">c_plot_2d_1</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-8.svg" src="../../../_images/integrated_curve-8.svg" /></div>
<p>An instance of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedCurve</span></code></a> may store several numerical
solutions and interpolations:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">....: </span>        <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">100</span><span class="p">},</span>
<span class="gp">....: </span>        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;carac time 100&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                           <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c_plot_3d_100</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 100&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c_plot_3d_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp 1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span> <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                  <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c_plot_3d_1</span> <span class="o">+</span> <span class="n">c_plot_3d_100</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-9.svg" src="../../../_images/integrated_curve-9.svg" /></div>
<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolate">
<code class="descname">interpolate</code><span class="sig-paren">(</span><em>solution_key=None</em>, <em>method=None</em>, <em>interpolation_key=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolate" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the chosen numerical solution using the given
interpolation method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
numerical solution to interpolate is associated to ; a default
value is chosen if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">method</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) interpolation scheme to use;
algorithms available are<ul>
<li><code class="docutils literal notranslate"><span class="pre">'cubic</span> <span class="pre">spline'</span></code>, which makes use of <code class="docutils literal notranslate"><span class="pre">GSL</span></code> via
<a class="reference external" href="../../../../calculus/sage/calculus/interpolation.html#sage.calculus.interpolation.Spline" title="(in Sage 9.1 Reference Manual: Symbolic Calculus v9.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spline</span></code></a></li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting interpolation will be associated to ; a default
value is given if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the interpolation in progress</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>built interpolation object</li>
</ul>
<p>EXAMPLES:</p>
<p>Interpolating a numerical solution previously computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                       <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                       <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                       <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;interp_T1&#39; (if this key already referred to a former</span>
<span class="go"> interpolation, such an interpolation was erased).</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Interpolating the numerical solution associated with the</span>
<span class="go"> key &#39;sol_T1&#39; by default...</span>
<span class="go">Performing cubic spline interpolation by default...</span>
<span class="go">Resulting interpolation will be associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; by default.</span>
<span class="go">Interpolation completed and associated with the key</span>
<span class="go"> &#39;cubic spline-interp-sol_T1&#39; (if this key already referred</span>
<span class="go"> to a former interpolation, such an interpolation was</span>
<span class="go"> erased).</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolation">
<code class="descname">interpolation</code><span class="sig-paren">(</span><em>interpolation_key=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the interpolation object associated with the given key.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
requested interpolation is associated to; a default
value is chosen if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the interpolation object returned</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>requested interpolation object</li>
</ul>
<p>EXAMPLES:</p>
<p>Requesting an interpolation object previously computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">default_interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Returning the interpolation associated with the key</span>
<span class="go"> &#39;interp_T1&#39; by default...</span>
<span class="gp">sage: </span><span class="n">default_interp</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">interp_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">interp_mute</span> <span class="o">==</span> <span class="n">interp</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated">
<code class="descname">plot_integrated</code><span class="sig-paren">(</span><em>chart=None</em>, <em>ambient_coords=None</em>, <em>mapping=None</em>, <em>prange=None</em>, <em>interpolation_key=None</em>, <em>include_end_point=(True</em>, <em>True)</em>, <em>end_point_offset=(0.001</em>, <em>0.001)</em>, <em>verbose=False</em>, <em>color='red'</em>, <em>style='-'</em>, <em>label_axes=True</em>, <em>display_tangent=False</em>, <em>color_tangent='blue'</em>, <em>across_charts=False</em>, <em>thickness=1</em>, <em>plot_points=75</em>, <em>aspect_ratio='automatic'</em>, <em>plot_points_tangent=10</em>, <em>width_tangent=1</em>, <em>scale=1</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the 2D or 3D projection of <code class="docutils literal notranslate"><span class="pre">self</span></code> onto the space of the
chosen two or three ambient coordinates, based on the
interpolation of a numerical solution previously computed.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="curve.html#sage.manifolds.differentiable.curve.DifferentiableCurve.plot" title="sage.manifolds.differentiable.curve.DifferentiableCurve.plot"><code class="xref py py-class docutils literal notranslate"><span class="pre">plot</span></code></a>
for complete information about the input.</p>
</div>
<p>ADDITIONAL INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key associated to
the interpolation object used for the plot; a default value
is chosen if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the interpolation object used and the plotting in progress</li>
<li><code class="docutils literal notranslate"><span class="pre">display_tangent</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) determines whether
some tangent vectors should also be plotted</li>
<li><code class="docutils literal notranslate"><span class="pre">color_tangent</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">blue</span></code>) color of the tangent
vectors when these are plotted</li>
<li><code class="docutils literal notranslate"><span class="pre">plot_points_tangent</span></code> – (default: 10) number of tangent
vectors to display when these are plotted</li>
<li><code class="docutils literal notranslate"><span class="pre">width_tangent</span></code> – (default: 1) sets the width of the arrows
representing the tangent vectors</li>
<li><code class="docutils literal notranslate"><span class="pre">scale</span></code> – (default: 1) scale applied to the tangent vectors
before displaying them</li>
</ul>
<p>EXAMPLES:</p>
<p>Trajectory of a particle of unit mass and unit charge in an
unit, axial, uniform, stationary magnetic field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="go">t</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c_plot_2d</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">ambient_coords</span><span class="o">=</span><span class="p">[</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span>
<span class="gp">....: </span>                <span class="n">thickness</span><span class="o">=</span><span class="mf">2.5</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">plot_points_tangent</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">color_tangent</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Plotting from the interpolation associated with the key</span>
<span class="go"> &#39;cubic spline-interp-odeint&#39; by default...</span>
<span class="go">A tiny final offset equal to 0.000301507537688442 was</span>
<span class="go"> introduced for the last point in order to safely compute it</span>
<span class="go"> from the interpolation.</span>
<span class="gp">sage: </span><span class="n">c_plot_2d</span>
<span class="go">Graphics object consisting of 11 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-10.svg" src="../../../_images/integrated_curve-10.svg" /></div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solution">
<code class="descname">solution</code><span class="sig-paren">(</span><em>solution_key=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the solution (list of points) associated with the given
key.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
requested numerical solution is associated to; a default
value is chosen if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the solution returned</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the numerical points of the solution requested</li>
</ul>
<p>EXAMPLES:</p>
<p>Requesting a numerical solution previously computed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">sol_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Returning the numerical solution associated with the key</span>
<span class="go"> &#39;sol_T1&#39; by default...</span>
<span class="gp">sage: </span><span class="n">sol_bis</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sol_ter</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol_ter</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solution</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>step=None</em>, <em>method='odeint'</em>, <em>solution_key=None</em>, <em>parameters_values=None</em>, <em>verbose=False</em>, <em>**control_param</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the curve numerically over the domain of definition.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">step</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) step of integration; default
value is a hundredth of the domain of integration if none is
provided</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">method</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">'odeint'</span></code>) numerical scheme to
use for the integration of the curve; available algorithms are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'odeint'</span></code> - makes use of
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.odeint.html">scipy.integrate.odeint</a>
via Sage solver
<a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_odeint" title="(in Sage 9.1 Reference Manual: Symbolic Calculus v9.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_odeint()</span></code></a>; <code class="docutils literal notranslate"><span class="pre">odeint</span></code> invokes
the LSODA algorithm of the
<a class="reference external" href="https://www.netlib.org/odepack/">ODEPACK suite</a>, which
automatically selects between implicit Adams method (for non-stiff
problems) and a method based on backward differentiation formulas
(BDF) (for stiff problems).</li>
<li><code class="docutils literal notranslate"><span class="pre">'rk4_maxima'</span></code> - 4th order classical Runge-Kutta, which
makes use of Maxima’s dynamics package via Sage solver
<a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_system_rk4" title="(in Sage 9.1 Reference Manual: Symbolic Calculus v9.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_system_rk4()</span></code></a> (quite slow)</li>
<li><code class="docutils literal notranslate"><span class="pre">'dopri5'</span></code> - Dormand-Prince Runge-Kutta of order (4)5 provided by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html">scipy.integrate.ode</a></li>
<li><code class="docutils literal notranslate"><span class="pre">'dop853'</span></code> - Dormand-Prince Runge-Kutta of order 8(5,3) provided by
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html">scipy.integrate.ode</a></li>
</ul>
<p>and those provided by <code class="docutils literal notranslate"><span class="pre">GSL</span></code> via Sage class
<a class="reference external" href="../../../../calculus/sage/calculus/ode.html#sage.calculus.ode.ode_solver" title="(in Sage 9.1 Reference Manual: Symbolic Calculus v9.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ode_solver</span></code></a>:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'rk2'</span></code> - embedded Runge-Kutta (2,3)</li>
<li><code class="docutils literal notranslate"><span class="pre">'rk4'</span></code> - 4th order classical Runge-Kutta</li>
<li><code class="docutils literal notranslate"><span class="pre">'rkf45'</span></code> - Runge-Kutta-Felhberg (4,5)</li>
<li><code class="docutils literal notranslate"><span class="pre">'rkck'</span></code> - embedded Runge-Kutta-Cash-Karp (4,5)</li>
<li><code class="docutils literal notranslate"><span class="pre">'rk8pd'</span></code> - Runge-Kutta Prince-Dormand (8,9)</li>
<li><code class="docutils literal notranslate"><span class="pre">'rk2imp'</span></code> - implicit 2nd order Runge-Kutta at Gaussian points</li>
<li><code class="docutils literal notranslate"><span class="pre">'rk4imp'</span></code> - implicit 4th order Runge-Kutta at Gaussian points</li>
<li><code class="docutils literal notranslate"><span class="pre">'gear1'</span></code> - <span class="math notranslate nohighlight">\(M=1\)</span> implicit Gear</li>
<li><code class="docutils literal notranslate"><span class="pre">'gear2'</span></code> - <span class="math notranslate nohighlight">\(M=2\)</span> implicit Gear</li>
<li><code class="docutils literal notranslate"><span class="pre">'bsimp'</span></code> - implicit Bulirsch-Stoer (requires Jacobian)</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting numerical solution will be associated to; a default
value is given if none is provided</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">parameters_values</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of numerical
values of the parameters present in the system defining the
curve, to be substituted in the equations before integration</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the computation in progress</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">**control_param</span></code> – extra control parameters to be passed to the
chosen solver; see the example with <code class="docutils literal notranslate"><span class="pre">rtol</span></code> and <code class="docutils literal notranslate"><span class="pre">atol</span></code> below</p>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the numerical points of the computed solution</li>
</ul>
<p>EXAMPLES:</p>
<p>Computing a numerical solution:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>              <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;odeint&#39;...</span>
<span class="go">Resulting list of points will be associated with the key</span>
<span class="go"> &#39;odeint&#39; by default.</span>
<span class="go">Numerical integration completed.</span>

<span class="go">Checking all points are in the chart domain...</span>
<span class="go">All points are in the chart domain.</span>

<span class="go">The resulting list of points was associated with the key</span>
<span class="go"> &#39;odeint&#39; (if this key already referred to a former</span>
<span class="go"> numerical solution, such a solution was erased).</span>
</pre></div>
</div>
<p>The first 3 points of the solution, in the form <code class="docutils literal notranslate"><span class="pre">[t,</span> <span class="pre">x1,</span> <span class="pre">x2,</span> <span class="pre">x3]</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># abs tol 1e-12</span>
<span class="go">[[0.0, 0.0, 0.0, 0.0],</span>
<span class="go"> [0.05, 0.04999999218759271, -2.083327338392213e-05, 0.05],</span>
<span class="go"> [0.1, 0.09999975001847655, -0.00016666146190783666, 0.1]]</span>
</pre></div>
</div>
<p>The default is <code class="docutils literal notranslate"><span class="pre">verbose=False</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">....: </span>                                      <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">sol_mute</span> <span class="o">==</span> <span class="n">sol</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Specifying the relative and absolute error tolerance parameters to
be used in <a class="reference external" href="../../../../calculus/sage/calculus/desolvers.html#sage.calculus.desolvers.desolve_odeint" title="(in Sage 9.1 Reference Manual: Symbolic Calculus v9.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">desolve_odeint()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>              <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span>
</pre></div>
</div>
<p>Using a numerical method different from the default one:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>              <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rk8pd&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts">
<code class="descname">solve_across_charts</code><span class="sig-paren">(</span><em>charts=None</em>, <em>step=None</em>, <em>solution_key=None</em>, <em>parameters_values=None</em>, <em>verbose=False</em>, <em>**control_param</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate the curve numerically over the domain of integration, with
the ability to switch chart mid-integration.</p>
<p>The only supported solver is
<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html">scipy.integrate.ode</a>, because it supports basic event handling, needed to detect when the
curve is reaching the frontier of the chart. This is an adaptive step
solver. So the <code class="docutils literal notranslate"><span class="pre">step</span></code> is not the step of integration but instead the
step used to peak at the current chart, and switch if needed.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">step</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) step of chart checking; default
value is a hundredth of the domain of integration if none is
provided. If your curve can’t find a new frame on exiting the
current frame, consider reducing this parameter.</li>
<li><code class="docutils literal notranslate"><span class="pre">charts</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of chart allowed. The
integration stops once it leaves those charts. By default the whole
atlas is taken (only the top-charts).</li>
<li><code class="docutils literal notranslate"><span class="pre">solution_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
resulting numerical solution will be associated to; a default
value is given if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">parameters_values</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) list of numerical
values of the parameters present in the system defining the
curve, to be substituted in the equations before integration</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the computation in progress</li>
<li><code class="docutils literal notranslate"><span class="pre">**control_param</span></code> – extra control parameters to be passed to the
solver</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the numerical points of the computed solution</li>
</ul>
<p>EXAMPLES:</p>
<p>Let us use <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_across_charts()</span></code></a> to integrate a geodesic of the
Euclidean plane (a straight line) in polar coordinates.</p>
<p>In pure polar coordinates <span class="math notranslate nohighlight">\((r, \theta)\)</span>, artefacts can appear near
the origin because of the fast variation of <span class="math notranslate nohighlight">\(\theta\)</span>, resulting in
the direction of the geodesic being different before and after
getting close to the origin.</p>
<p>The solution to this problem is to switch to Cartesian coordinates
near <span class="math notranslate nohighlight">\((0,0)\)</span> to avoid any singularity.</p>
<p>First let’s declare the plane as a 2-dimensional manifold, with two
charts <span class="math notranslate nohighlight">\(P\)</span> en <span class="math notranslate nohighlight">\(C\)</span> (for “Polar” and “Cartesian”) and their transition
maps:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s2">&quot;Riemannian&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">r</span><span class="p">,</span><span class="n">th</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P_to_C</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">C</span><span class="p">,(</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">C_to_P</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">transition_map</span><span class="p">(</span><span class="n">P</span><span class="p">,(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span> <span class="n">atan2</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)))</span>
</pre></div>
</div>
<p>Let us also add restrictions on those charts, to avoid any
singularity. We have to make sure that the charts still intersect.
Here the intersection is the donut region <span class="math notranslate nohighlight">\(2 &lt; r &lt; 3\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">add_restrictions</span><span class="p">(</span><span class="n">r</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">add_restrictions</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>We still have to define the metric. This is done in the Cartesian
frame. The metric in the polar frame is computed automatically:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">C</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">(),</span> <span class="p">:</span> <span class="p">,</span><span class="n">P</span><span class="p">]</span>
<span class="go">[  1   0]</span>
<span class="go">[  0 r^2]</span>
</pre></div>
</div>
<p>To visualize our manifold, let’s declare a mapping between every chart
and the Cartesian chart, and then plot each chart in term of this
mapping:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="p">{(</span><span class="n">C</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">C</span><span class="p">):</span> <span class="p">[</span><span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">),</span> <span class="n">r</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
<span class="gp">sage: </span><span class="n">fig</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>
<span class="gp">....: </span>             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">r</span><span class="p">:(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">th</span><span class="p">:(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">fig</span> <span class="o">+=</span> <span class="n">C</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">number_values</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">chart</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span>
<span class="gp">....: </span>              <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">ranges</span><span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">y</span><span class="p">:(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)})</span>
</pre></div>
</div>
<p>There is a clear non-empty intersection between the two
charts. This is the key point to successfully switch chart during the
integration. Indeed, at least 2 points must fall in the intersection.</p>
<p class="rubric">Geodesic integration</p>
<p>Let’s define the time as <span class="math notranslate nohighlight">\(t\)</span>, the initial point as <span class="math notranslate nohighlight">\(p\)</span>, and the
initial velocity vector as <span class="math notranslate nohighlight">\(v\)</span> (define as a member of the tangent
space <span class="math notranslate nohighlight">\(T_p\)</span>). The chosen geodesic should enter the central region
from the left and leave it to the right:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="n">pi</span><span class="o">+</span><span class="mf">0.3</span><span class="p">),</span> <span class="n">P</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.03</span><span class="p">),</span> <span class="n">P</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<p>While creating the integrated geodesic, we need to specify the
optional argument <code class="docutils literal notranslate"><span class="pre">across_chart=True</span></code>, to prepare the compiled
version of the changes of charts:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">across_charts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The integration is done as usual, but using the method
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_across_charts"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve_across_charts()</span></code></a> instead of <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a>. This forces the
use of <code class="docutils literal notranslate"><span class="pre">scipy.integrate.ode</span></code> as the solver, because of event handling
support.</p>
<p>The argument <code class="docutils literal notranslate"><span class="pre">verbose=True</span></code> will cause the solver to write a small
message each time it is switching chart:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_across_charts</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Performing numerical integration with method &#39;ode&#39;.</span>
<span class="go">Integration will take place on the whole manifold domain.</span>
<span class="go">Resulting list of points will be associated with the key &#39;ode_multichart&#39; by default.</span>
<span class="go">   ...</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Exiting chart, trying to switch to another chart.</span>
<span class="go">New chart found. Resuming integration.</span>
<span class="go">Integration successful.</span>
</pre></div>
</div>
<p>As expected, two changes of chart occur.</p>
<p>The returned solution is a list of pairs <code class="docutils literal notranslate"><span class="pre">(chart,</span> <span class="pre">solution)</span></code>,
where each solution is given on a unique chart, and the last
point of a solution is the first of the next.</p>
<p>The following code prints the corresponding charts:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">chart</span><span class="p">,</span> <span class="n">solution</span> <span class="ow">in</span> <span class="n">sol</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">print</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
<span class="go">Chart (M, (r, th))</span>
<span class="go">Chart (M, (x, y))</span>
<span class="go">Chart (M, (r, th))</span>
</pre></div>
</div>
<p>The interpolation is done as usual:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
</pre></div>
</div>
<p>To plot the result, you must first be sure that the mapping
encompasses all the chart, which is the case here.
You must also specify <code class="docutils literal notranslate"><span class="pre">across_charts=True</span></code> in order to call
<a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated" title="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.plot_integrated"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot_integrated()</span></code></a> again on each part.
Finally, <code class="docutils literal notranslate"><span class="pre">color</span></code> can be a list, which will be cycled through:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fig</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">mapping</span><span class="o">=</span><span class="n">phi</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;green&quot;</span><span class="p">,</span><span class="s2">&quot;red&quot;</span><span class="p">],</span>
<span class="gp">....: </span><span class="n">thickness</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">plot_points</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">across_charts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fig</span>
<span class="go">Graphics object consisting of 43 graphics primitives</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-111.svg" src="../../../_images/integrated_curve-111.svg" /></div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_analytical">
<code class="descname">solve_analytical</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.solve_analytical" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the differential system defining <code class="docutils literal notranslate"><span class="pre">self</span></code> analytically.</p>
<p>Solve analytically the differential system defining a curve
using Maxima via Sage solver <code class="docutils literal notranslate"><span class="pre">desolve_system</span></code>.
In case of success, the analytical expressions are added to the
dictionary of expressions representing the curve.
Pay attention to the fact that <code class="docutils literal notranslate"><span class="pre">desolve_system</span></code> only considers
initial conditions given at an initial parameter value equal to
zero, although the parameter range may not contain zero.
Yet, assuming that it does, values of the coordinates functions
at such zero initial parameter value are denoted by the name of
the coordinate function followed by the string <code class="docutils literal notranslate"><span class="pre">&quot;_0&quot;</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the analytical expressions of the coordinate functions
(when the differential system could be solved analytically),
or boolean <code class="docutils literal notranslate"><span class="pre">False</span></code> (in case the differential system could
not be solved analytically)</li>
</ul>
<p>EXAMPLES:</p>
<p>Analytical expression of the trajectory of a charged particle in
a uniform, stationary magnetic field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B_0</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with components</span>
<span class="go"> [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q/m</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q/m</span>
<span class="go">d(Dx3)/dt = 0</span>

<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve_analytical</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">((B_0*q*x1_0 - Dx2_0*m*cos(B_0*q*t/m) +</span>
<span class="go">   Dx1_0*m*sin(B_0*q*t/m) + Dx2_0*m)/(B_0*q),</span>
<span class="go"> (B_0*q*x2_0 + Dx1_0*m*cos(B_0*q*t/m) +</span>
<span class="go">  Dx2_0*m*sin(B_0*q*t/m) - Dx1_0*m)/(B_0*q),</span>
<span class="go"> Dx3_0*t + x3_0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.system">
<code class="descname">system</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide a detailed description of the system defining the curve
and return the system defining it: chart, equations and initial
conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints a detailed
description of the curve</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list containing<ul>
<li>the equations</li>
<li>the initial conditions</li>
<li>the chart</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>System defining an integrated curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Curve c in the 3-dimensional differentiable manifold M</span>
<span class="go"> integrated over the Real interval (0, 5) as a solution to</span>
<span class="go"> the following system, written with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3)):</span>

<span class="go">Initial point: Point p on the 3-dimensional differentiable</span>
<span class="go"> manifold M with coordinates [0, 0, 0] with respect to</span>
<span class="go"> Chart (M, (x1, x2, x3))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 3-dimensional differentiable manifold M with</span>
<span class="go"> components [1, 0, 1] with respect to Chart (M, (x1, x2, x3))</span>

<span class="go">d(x1)/dt = Dx1</span>
<span class="go">d(x2)/dt = Dx2</span>
<span class="go">d(x3)/dt = Dx3</span>
<span class="go">d(Dx1)/dt = B_0*Dx2*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx2)/dt = -B_0*Dx1*q*t*e^(-(x1^2 + x2^2)/L^2)/(T*m)</span>
<span class="go">d(Dx3)/dt = 0</span>

<span class="gp">sage: </span><span class="n">sys_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sys_mute</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedCurve.tangent_vector_eval_at">
<code class="descname">tangent_vector_eval_at</code><span class="sig-paren">(</span><em>t</em>, <em>interpolation_key=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedCurve.tangent_vector_eval_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vector tangent to <code class="docutils literal notranslate"><span class="pre">self</span></code> at the given curve
parameter with components evaluated from the given
interpolation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">t</span></code> – curve parameter value at which the tangent vector is
evaluated</li>
<li><code class="docutils literal notranslate"><span class="pre">interpolation_key</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) key which the
interpolation requested to compute the tangent vector is
associated to; a default value is chosen if none is provided</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints information about
the interpolation used</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
tangent vector with numerical components</li>
</ul>
<p>EXAMPLES:</p>
<p>Evaluating a vector tangent to the curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">B_0</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t B_0 m q L T&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">B_0</span><span class="o">*</span><span class="n">t</span><span class="o">/</span><span class="n">T</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x1</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x2</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">L</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">symbolic_velocities</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">eqns</span> <span class="o">=</span> <span class="p">[</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">q</span><span class="o">*</span><span class="n">B</span><span class="o">/</span><span class="n">m</span><span class="o">*</span><span class="n">D</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">integrated_curve</span><span class="p">(</span><span class="n">eqns</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>       <span class="n">parameters_values</span><span class="o">=</span><span class="p">{</span><span class="n">B_0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">q</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span> <span class="n">T</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic spline&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol_T1&#39;</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tg_vec</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">1.22</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Evaluating tangent vector components from the interpolation</span>
<span class="go"> associated with the key &#39;interp_T1&#39; by default...</span>
<span class="gp">sage: </span><span class="n">tg_vec</span>
<span class="go">Tangent vector at Point on the 3-dimensional differentiable</span>
<span class="go"> manifold M</span>
<span class="gp">sage: </span><span class="n">tg_vec</span><span class="p">[:]</span>     <span class="c1"># abs tol 1e-12</span>
<span class="go">[0.7392640422917979, -0.6734182509826023, 1.0]</span>
<span class="gp">sage: </span><span class="n">tg_vec_mute</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">tangent_vector_eval_at</span><span class="p">(</span><span class="mf">1.22</span><span class="p">,</span>
<span class="gp">....: </span>                        <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp_T1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">tg_vec_mute</span> <span class="o">==</span> <span class="n">tg_vec</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic">
<em class="property">class </em><code class="descclassname">sage.manifolds.differentiable.integrated_curve.</code><code class="descname">IntegratedGeodesic</code><span class="sig-paren">(</span><em>parent</em>, <em>metric</em>, <em>curve_parameter</em>, <em>initial_tangent_vector</em>, <em>chart=None</em>, <em>name=None</em>, <em>latex_name=None</em>, <em>verbose=False</em>, <em>across_charts=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve" title="sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.manifolds.differentiable.integrated_curve.IntegratedAutoparallelCurve</span></code></a></p>
<p>Geodesic on the manifold with respect to a given metric.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">parent</span></code> –
<a class="reference internal" href="manifold_homset.html#sage.manifolds.differentiable.manifold_homset.IntegratedGeodesicSet" title="sage.manifolds.differentiable.manifold_homset.IntegratedGeodesicSet"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntegratedGeodesicSet</span></code></a>
the set of curves <span class="math notranslate nohighlight">\(\mathrm{Hom_{geodesic}}(I, M)\)</span> to which the
curve belongs</li>
<li><code class="docutils literal notranslate"><span class="pre">metric</span></code> –
<a class="reference internal" href="metric.html#sage.manifolds.differentiable.metric.PseudoRiemannianMetric" title="sage.manifolds.differentiable.metric.PseudoRiemannianMetric"><code class="xref py py-class docutils literal notranslate"><span class="pre">PseudoRiemannianMetric</span></code></a>
metric with respect to which the curve is a geodesic</li>
<li><code class="docutils literal notranslate"><span class="pre">curve_parameter</span></code> – symbolic expression to be used as the
parameter of the curve (the equations defining an instance of
IntegratedGeodesic are such that <code class="docutils literal notranslate"><span class="pre">t</span></code> will actually be an affine
parameter of the curve);</li>
<li><code class="docutils literal notranslate"><span class="pre">initial_tangent_vector</span></code> –
<a class="reference internal" href="tangent_vector.html#sage.manifolds.differentiable.tangent_vector.TangentVector" title="sage.manifolds.differentiable.tangent_vector.TangentVector"><code class="xref py py-class docutils literal notranslate"><span class="pre">TangentVector</span></code></a>
initial tangent vector of the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">chart</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) chart on the manifold in terms of
which the equations are expressed; if <code class="docutils literal notranslate"><span class="pre">None</span></code> the default chart
of the manifold is assumed</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; symbol given to the curve</li>
<li><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) string; LaTeX symbol to denote
the curve; if none is provided, <code class="docutils literal notranslate"><span class="pre">name</span></code> will be used</li>
</ul>
<p>EXAMPLES:</p>
<p>Geodesics of the unit 2-sphere <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span>.
Start with declaring the standard polar coordinates
<span class="math notranslate nohighlight">\((\theta, \phi)\)</span> on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and the
corresponding coordinate frame <span class="math notranslate nohighlight">\((e_{\theta}, e_{\phi})\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">polar</span><span class="o">.&lt;</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="o">&gt;=</span><span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;th ph&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">epolar</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">frame</span><span class="p">()</span>
</pre></div>
</div>
<p>Set the standard round metric:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>Set generic initial conditions for the geodesics to compute:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">,</span> <span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;th0 ph0 v_th0 v_ph0&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">th0</span><span class="p">,</span> <span class="n">ph0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="n">v_th0</span><span class="p">,</span> <span class="n">v_ph0</span><span class="p">),</span> <span class="n">basis</span><span class="o">=</span><span class="n">epolar</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
</pre></div>
</div>
<p>Declare the corresponding integrated geodesic and display the
differential system it satisfies:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t tmin tmax&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span>
<span class="gp">....: </span>                           <span class="n">chart</span><span class="o">=</span><span class="n">polar</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (tmin, tmax) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (th, ph)):</span>

<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go">manifold S^2 with coordinates [th0, ph0] with respect to</span>
<span class="go">Chart (S^2, (th, ph))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go">2-dimensional Riemannian manifold S^2 with</span>
<span class="go">components [v_th0, v_ph0] with respect to Chart (S^2, (th, ph))</span>

<span class="go">d(th)/dt = Dth</span>
<span class="go">d(ph)/dt = Dph</span>
<span class="go">d(Dth)/dt = Dph^2*cos(th)*sin(th)</span>
<span class="go">d(Dph)/dt = -2*Dph*Dth*cos(th)/sin(th)</span>
</pre></div>
</div>
<p>Set a dictionary providing the parameter range and the initial
conditions for various geodesics:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dict_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;equat&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">},</span>
<span class="gp">....: </span>  <span class="s1">&#39;longi&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">0</span><span class="p">},</span>
<span class="gp">....: </span>  <span class="s1">&#39;angle&#39;</span><span class="p">:{</span><span class="n">tmin</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="n">tmax</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="n">th0</span><span class="p">:</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">ph0</span><span class="p">:</span><span class="mf">0.1</span><span class="p">,</span><span class="n">v_th0</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">v_ph0</span><span class="p">:</span><span class="mi">1</span><span class="p">}}</span>
</pre></div>
</div>
<p>Use <span class="math notranslate nohighlight">\(\mathbb{R}^{3}\)</span> as the codomain of the standard map
embedding <span class="math notranslate nohighlight">\((\mathbb{S}^{2}, (\theta, \phi))\)</span> in the
3-dimensional Euclidean space:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R3</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;R3&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cart</span><span class="o">.&lt;</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R3</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">euclid_embedding</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">diff_map</span><span class="p">(</span><span class="n">R3</span><span class="p">,</span>
<span class="gp">....: </span> <span class="p">{(</span><span class="n">polar</span><span class="p">,</span> <span class="n">cart</span><span class="p">):[</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">ph</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)]})</span>
</pre></div>
</div>
<p>Solve, interpolate and prepare the plot for the solutions
corresponding to the three initial conditions previously set:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph3D_embedded_geods</span> <span class="o">=</span> <span class="n">Graphics</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dict_params</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">sol</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                       <span class="n">parameters_values</span><span class="o">=</span><span class="n">dict_params</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
<span class="gp">....: </span>    <span class="n">interp</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">solution_key</span><span class="o">=</span><span class="s1">&#39;sol-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                          <span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">graph3D_embedded_geods</span> <span class="o">+=</span> <span class="n">c</span><span class="o">.</span><span class="n">plot_integrated</span><span class="p">(</span><span class="n">interpolation_key</span><span class="o">=</span><span class="s1">&#39;interp-&#39;</span><span class="o">+</span><span class="n">key</span><span class="p">,</span>
<span class="gp">....: </span>                     <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="gp">....: </span>                     <span class="n">display_tangent</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
<span class="gp">....: </span>                     <span class="n">width_tangent</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Plot the resulting geodesics on the grid of polar coordinates lines
on <span class="math notranslate nohighlight">\(\mathbb{S}^{2}\)</span> and check that these are great circles:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">graph3D_embedded_polar_coords</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">chart</span><span class="o">=</span><span class="n">cart</span><span class="p">,</span>
<span class="gp">....: </span>                         <span class="n">mapping</span><span class="o">=</span><span class="n">euclid_embedding</span><span class="p">,</span>
<span class="gp">....: </span>                         <span class="n">number_values</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">graph3D_embedded_geods</span> <span class="o">+</span> <span class="n">graph3D_embedded_polar_coords</span>
<span class="go">Graphics3d Object</span>
</pre></div>
</div>
<div class="figure">
<img alt="../../../_images/integrated_curve-12.svg" src="../../../_images/integrated_curve-12.svg" /></div>
<dl class="method">
<dt id="sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic.system">
<code class="descname">system</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.differentiable.integrated_curve.IntegratedGeodesic.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the system defining the geodesic: chart, equations and
initial conditions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) prints a detailed
description of the curve</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list containing<ul>
<li>the equations</li>
<li>the initial equations</li>
<li>the chart</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>System defining a geodesic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S2</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;S^2&#39;</span><span class="p">,</span><span class="n">structure</span><span class="o">=</span><span class="s1">&#39;Riemannian&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t A&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">metric</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">point</span><span class="p">((</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Tp</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">tangent_space</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">Tp</span><span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">S2</span><span class="o">.</span><span class="n">integrated_geodesic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="p">),</span> <span class="n">v</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sys</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">Geodesic c in the 2-dimensional Riemannian manifold S^2</span>
<span class="go"> equipped with Riemannian metric g on the 2-dimensional</span>
<span class="go"> Riemannian manifold S^2, and integrated over the Real</span>
<span class="go"> interval (0, pi) as a solution to the following geodesic</span>
<span class="go"> equations, written with respect to Chart (S^2, (theta, phi)):</span>

<span class="go">Initial point: Point p on the 2-dimensional Riemannian</span>
<span class="go"> manifold S^2 with coordinates [1/2*pi, 0] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>
<span class="go">Initial tangent vector: Tangent vector at Point p on the</span>
<span class="go"> 2-dimensional Riemannian manifold S^2 with</span>
<span class="go"> components [1/2*sqrt(2), 1/2*sqrt(2)] with respect to</span>
<span class="go"> Chart (S^2, (theta, phi))</span>

<span class="go">d(theta)/dt = Dtheta</span>
<span class="go">d(phi)/dt = Dphi</span>
<span class="go">d(Dtheta)/dt = Dphi^2*cos(theta)*sin(theta)</span>
<span class="go">d(Dphi)/dt = -2*Dphi*Dtheta*cos(theta)/sin(theta)</span>

<span class="gp">sage: </span><span class="n">sys_bis</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sys_bis</span> <span class="o">==</span> <span class="n">sys</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="curve.html"
                        title="previous chapter">Curves in Manifolds</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../../../tangent_space.html"
                        title="next chapter">Tangent Spaces</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/manifolds/differentiable/integrated_curve.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../../tangent_space.html" title="Tangent Spaces"
             >next</a> |</li>
        <li class="right" >
          <a href="curve.html" title="Curves in Manifolds"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.1 Reference Manual: Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../../diff_manifold.html" >Differentiable Manifolds</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../diff_map.html" >Differentiable Maps and Curves</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>