
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Chart Functions &#8212; Sage 9.5 Reference Manual: Manifolds</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Coordinate calculus methods" href="calculus_method.html" />
    <link rel="prev" title="Coordinate Charts" href="chart.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="calculus_method.html" title="Coordinate calculus methods"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="chart.html" title="Coordinate Charts"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../manifold.html" >Topological Manifolds</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../chart.html" accesskey="U">Coordinate Charts</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Chart Functions</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="chart-functions">
<span id="sage-manifolds-chart-func"></span><h1>Chart Functions<a class="headerlink" href="#chart-functions" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.manifolds.chart_func"></span><p>In the context of a topological manifold <span class="math notranslate nohighlight">\(M\)</span> over a topological field
<span class="math notranslate nohighlight">\(K\)</span>, a <em>chart function</em> is a function from a chart codomain
to <span class="math notranslate nohighlight">\(K\)</span>.
In other words, a chart function is a <span class="math notranslate nohighlight">\(K\)</span>-valued function of the coordinates
associated to some chart. The internal coordinate expressions of chart
functions and calculus on them are taken in charge by different calculus
methods, at the choice of the user:</p>
<ul class="simple">
<li><p>Sage’s default symbolic engine (Pynac + Maxima), implemented via the
Symbolic Ring (<code class="docutils literal notranslate"><span class="pre">SR</span></code>)</p></li>
<li><p>SymPy engine, denoted <code class="docutils literal notranslate"><span class="pre">sympy</span></code> hereafter</p></li>
</ul>
<p>See <a class="reference internal" href="calculus_method.html#sage.manifolds.calculus_method.CalculusMethod" title="sage.manifolds.calculus_method.CalculusMethod"><code class="xref py py-class docutils literal notranslate"><span class="pre">CalculusMethod</span></code></a> for details.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>Marco Mancini (2017) : initial version</p></li>
<li><p>Eric Gourgoulhon (2015) : for a previous class implementing only SR
calculus (CoordFunctionSymb)</p></li>
<li><p>Florentin Jaffredo (2018) : series expansion with respect to a given
parameter</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.chart_func.</span></span><span class="sig-name descname"><span class="pre">ChartFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.AlgebraElement" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.AlgebraElement</span></code></a>, <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.ModuleElementWithMutability" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.ModuleElementWithMutability</span></code></a></p>
<p>Function of coordinates of a given chart.</p>
<p>If <span class="math notranslate nohighlight">\((U, \varphi)\)</span> is a chart on a topological manifold <span class="math notranslate nohighlight">\(M\)</span> of
dimension <span class="math notranslate nohighlight">\(n\)</span> over a topological field <span class="math notranslate nohighlight">\(K\)</span>,  a <em>chart function</em>
associated to <span class="math notranslate nohighlight">\((U, \varphi)\)</span> is a map</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{llcl}
f:&amp; V \subset K^n &amp; \longrightarrow &amp; K \\
  &amp; (x^1, \ldots, x^n) &amp; \longmapsto &amp; f(x^1, \ldots, x^n),
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(V\)</span> is the codomain of <span class="math notranslate nohighlight">\(\varphi\)</span>. In other words, <span class="math notranslate nohighlight">\(f\)</span> is a
<span class="math notranslate nohighlight">\(K\)</span>-valued function of the coordinates associated to the chart
<span class="math notranslate nohighlight">\((U, \varphi)\)</span>.</p>
<p>The chart function <span class="math notranslate nohighlight">\(f\)</span> can be represented by expressions pertaining to
different calculus methods; the currently implemented ones are</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SR</span></code> (Sage’s Symbolic Ring)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SymPy</span></code></p></li>
</ul>
<p>See <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.expr" title="sage.manifolds.chart_func.ChartFunction.expr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a> for details.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">parent</span></code> – the algebra of chart functions on the chart
<span class="math notranslate nohighlight">\((U, \varphi)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a symbolic expression representing
<span class="math notranslate nohighlight">\(f(x^1, \ldots, x^n)\)</span>, where <span class="math notranslate nohighlight">\((x^1, \ldots, x^n)\)</span> are the
coordinates of the chart <span class="math notranslate nohighlight">\((U, \varphi)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">calc_method</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>): the calculus method with
respect to which the internal expression of <code class="docutils literal notranslate"><span class="pre">self</span></code> must be initialized
from <code class="docutils literal notranslate"><span class="pre">expression</span></code>; one of</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'SR'</span></code>: Sage’s default symbolic engine (Symbolic Ring)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code>: SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: the chart current calculus method is assumed</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">expansion_symbol</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) symbolic variable (the “small
parameter”) with respect to which the coordinate expression is expanded
in power series (around the zero value of this variable)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">order</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the order of the expansion
if <code class="docutils literal notranslate"><span class="pre">expansion_symbol</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>; the <em>order</em> is defined as the
degree of the polynomial representing the truncated power series in
<code class="docutils literal notranslate"><span class="pre">expansion_symbol</span></code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The value of <code class="docutils literal notranslate"><span class="pre">order</span></code> is <span class="math notranslate nohighlight">\(n-1\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the order of the
big <span class="math notranslate nohighlight">\(O\)</span> in the power series expansion</p>
</div>
</li>
</ul>
<p>EXAMPLES:</p>
<p>A symbolic chart function on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">x^2 + 3*y + 1</span>
</pre></div>
</div>
<p>The symbolic expression is returned when asking for the direct display of
the function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span>
<span class="go">x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">x^{2} + 3 \, y + 1</span>
</pre></div>
</div>
<p>A similar output is obtained by means of the method <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.expr" title="sage.manifolds.chart_func.ChartFunction.expr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">x^2 + 3*y + 1</span>
</pre></div>
</div>
<p>The expression returned by <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.expr" title="sage.manifolds.chart_func.ChartFunction.expr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a> is by default a Sage symbolic
expression:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>A SymPy expression can also be asked for:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">x**2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.add.Add&#39;&gt;</span>
</pre></div>
</div>
<p>The value of the function at specified coordinates is obtained by means
of the standard parentheses notation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="go">a^2 + 3*b + 1</span>
</pre></div>
</div>
<p>An unspecified chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;G&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span>
<span class="go">G(x, y)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ G(x, y)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">G(x, y)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">G(2, 3)</span>
</pre></div>
</div>
<p>Coordinate functions can be compared to other values:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">g</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">h</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="n">h</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A coercion by means of the restriction is implemented:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X_D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># open disk</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">X_D</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">+</span> <span class="n">f</span>
<span class="go">2*x^2 + 3*y + 1</span>
</pre></div>
</div>
<p>Expansion to a given order with respect to a small parameter:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>  <span class="c1"># the small parameter</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">expansion_symbol</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The expansion is triggered by the call to <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.simplify" title="sage.manifolds.chart_func.ChartFunction.simplify"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplify()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span>
<span class="go">x*y*cos(t)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">-1/2*t^2*x*y + x*y</span>
</pre></div>
</div>
<p class="rubric">Differences between <code class="docutils literal notranslate"><span class="pre">ChartFunction</span></code> and callable
symbolic expressions</p>
<p>Callable symbolic expressions are defined directly from symbolic
expressions of the coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f0</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f0</span>
<span class="go">(x, y) |--&gt; x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">x^2 + 3*y + 1</span>
</pre></div>
</div>
<p>To get an output similar to that of <code class="docutils literal notranslate"><span class="pre">f0</span></code> for a chart function, we must
use the method <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.display" title="sage.manifolds.chart_func.ChartFunction.display"><code class="xref py py-meth docutils literal notranslate"><span class="pre">display()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">x^2 + 3*y + 1</span>
</pre></div>
</div>
<p>More importantly, instances of <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> differ from
callable symbolic expression by the automatic simplifications in all
operations. For instance, adding the two callable symbolic expressions:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="p">;</span> <span class="n">g0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<p>results in:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f0</span> <span class="o">+</span> <span class="n">g0</span>
<span class="go">(x, y, z) |--&gt; cos(x)^2 + sin(x)^2</span>
</pre></div>
</div>
<p>To get <span class="math notranslate nohighlight">\(1\)</span>, one has to call
<a class="reference external" href="../../../calculus/sage/symbolic/expression.html#sage.symbolic.expression.Expression.simplify_trig" title="(in Sage 9.5 Reference Manual: Symbolic Calculus v9.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">simplify_trig()</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">f0</span> <span class="o">+</span> <span class="n">g0</span><span class="p">)</span><span class="o">.</span><span class="n">simplify_trig</span><span class="p">()</span>
<span class="go">(x, y, z) |--&gt; 1</span>
</pre></div>
</div>
<p>On the contrary, the sum of the corresponding <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a>
instances is automatically simplified (see
<a class="reference internal" href="utilities.html#sage.manifolds.utilities.simplify_chain_real" title="sage.manifolds.utilities.simplify_chain_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify_chain_real()</span></code></a> and
<a class="reference internal" href="utilities.html#sage.manifolds.utilities.simplify_chain_generic" title="sage.manifolds.utilities.simplify_chain_generic"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify_chain_generic()</span></code></a> for details):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">+</span> <span class="n">g</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Another difference regards the display of partial derivatives:
for callable symbolic functions, it involves <code class="docutils literal notranslate"><span class="pre">diff</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f0</span>
<span class="go">(x, y) |--&gt; diff(g(x, y), x) + diff(g(x, y), y)</span>
</pre></div>
</div>
<p>while for chart functions, the display is more “textbook” like:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">diff</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">d(g)/dx + d(g)/dy</span>
</pre></div>
</div>
<p>The difference is even more dramatic on LaTeX outputs:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f0</span><span class="p">)</span>
<span class="go">\left( x, y \right) \ {\mapsto} \ \frac{\partial}{\partial x}g\left(x, y\right) + \frac{\partial}{\partial y}g\left(x, y\right)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">\frac{\partial\,g}{\partial x} + \frac{\partial\,g}{\partial y}</span>
</pre></div>
</div>
<p>Note that this regards only the display of coordinate functions:
internally, the <code class="docutils literal notranslate"><span class="pre">diff</span></code> notation is still used, as we can check by asking
for the symbolic expression stored in <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">diff(g(x, y), x) + diff(g(x, y), y)</span>
</pre></div>
</div>
<p>One can switch to Pynac notation by changing the options:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Manifold</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">textbook_output</span><span class="o">=</span><span class="kc">False</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">\frac{\partial}{\partial x}g\left(x, y\right) + \frac{\partial}{\partial y}g\left(x, y\right)</span>
<span class="gp">sage: </span><span class="n">Manifold</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">\frac{\partial\,g}{\partial x} + \frac{\partial\,g}{\partial y}</span>
</pre></div>
</div>
<p>Another difference between <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> and
callable symbolic expression is the possibility to switch off the display
of the arguments of unspecified functions. Consider for instance:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">u(x, y)*v(x, y)</span>
<span class="gp">sage: </span><span class="n">f0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">function</span><span class="p">(</span><span class="s1">&#39;v&#39;</span><span class="p">)(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f0</span>
<span class="go">(x, y) |--&gt; u(x, y)*v(x, y)</span>
</pre></div>
</div>
<p>If there is a clear understanding that <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span> are functions of
<span class="math notranslate nohighlight">\((x,y)\)</span>, the explicit mention of the latter can be cumbersome in lengthy
tensor expressions. We can switch it off by:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Manifold</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">omit_function_arguments</span><span class="o">=</span><span class="kc">True</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">u*v</span>
</pre></div>
</div>
<p>Note that neither the callable symbolic expression <code class="docutils literal notranslate"><span class="pre">f0</span></code> nor the internal
expression of <code class="docutils literal notranslate"><span class="pre">f</span></code> is affected by the above command:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f0</span>
<span class="go">(x, y) |--&gt; u(x, y)*v(x, y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">u(x, y)*v(x, y)</span>
</pre></div>
</div>
<p>We revert to the default behavior by:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Manifold</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">_reset</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">u(x, y)*v(x, y)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.__call__">
<span class="sig-name descname"><span class="pre">__call__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the value of the function at specified coordinates.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">*coords</span></code> – list of coordinates <span class="math notranslate nohighlight">\((x^1, \ldots, x^n)\)</span>,
where the function <span class="math notranslate nohighlight">\(f\)</span> is to be evaluated</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**options</span></code> – allows to pass <code class="docutils literal notranslate"><span class="pre">simplify=False</span></code> to disable the
call of the simplification chain on the result</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>the value <span class="math notranslate nohighlight">\(f(x^1, \ldots, x^n)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">-sin(6)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">-sin(6)</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">sin(a*b)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="go">sin(a*b)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>With SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-sin(6)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.mul.Mul&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="go">sin(a*b)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">))</span>
<span class="go">sin</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.numbers.Zero&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.numbers.One&#39;&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arccos">
<span class="sig-name descname"><span class="pre">arccos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arccos" title="Permalink to this definition">¶</a></dt>
<dd><p>Arc cosine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\arccos(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arccos</span><span class="p">()</span>
<span class="go">arccos(x*y)</span>
<span class="gp">sage: </span><span class="n">arccos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccos()</span>
<span class="go">arccos(x*y)</span>
<span class="gp">sage: </span><span class="n">acos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccos()</span>
<span class="go">arccos(x*y)</span>
<span class="gp">sage: </span><span class="n">arccos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arccos(x*y)</span>
<span class="gp">sage: </span><span class="n">arccos</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 1/2*pi</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">set_calculus_method</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arccos</span><span class="p">()</span>
<span class="go">acos(x*y)</span>
<span class="gp">sage: </span><span class="n">arccos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccos()</span>
<span class="go">acos(x*y)</span>
<span class="gp">sage: </span><span class="n">acos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccos()</span>
<span class="go">acos(x*y)</span>
<span class="gp">sage: </span><span class="n">arccos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ acos(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arccosh">
<span class="sig-name descname"><span class="pre">arccosh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arccosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse hyperbolic cosine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\mathrm{arccosh}(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arccosh</span><span class="p">()</span>
<span class="go">arccosh(x*y)</span>
<span class="gp">sage: </span><span class="n">arccosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccosh()</span>
<span class="go">arccosh(x*y)</span>
<span class="gp">sage: </span><span class="n">acosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccosh()</span>
<span class="go">arccosh(x*y)</span>
<span class="gp">sage: </span><span class="n">arccosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arccosh(x*y)</span>
<span class="gp">sage: </span><span class="n">arccosh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arccosh</span><span class="p">()</span>
<span class="go">acosh(x*y)</span>
<span class="gp">sage: </span><span class="n">arccosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccosh()</span>
<span class="go">acosh(x*y)</span>
<span class="gp">sage: </span><span class="n">acosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arccosh()</span>
<span class="go">acosh(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arcsin">
<span class="sig-name descname"><span class="pre">arcsin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arcsin" title="Permalink to this definition">¶</a></dt>
<dd><p>Arc sine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\arcsin(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arcsin</span><span class="p">()</span>
<span class="go">arcsin(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsin()</span>
<span class="go">arcsin(x*y)</span>
<span class="gp">sage: </span><span class="n">asin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsin()</span>
<span class="go">arcsin(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arcsin(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsin</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arcsin</span><span class="p">()</span>
<span class="go">asin(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsin()</span>
<span class="go">asin(x*y)</span>
<span class="gp">sage: </span><span class="n">asin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsin()</span>
<span class="go">asin(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arcsinh">
<span class="sig-name descname"><span class="pre">arcsinh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arcsinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse hyperbolic sine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\mathrm{arcsinh}(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">()</span>
<span class="go">arcsinh(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsinh()</span>
<span class="go">arcsinh(x*y)</span>
<span class="gp">sage: </span><span class="n">asinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsinh()</span>
<span class="go">arcsinh(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arcsinh(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsinh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arcsinh</span><span class="p">()</span>
<span class="go">asinh(x*y)</span>
<span class="gp">sage: </span><span class="n">arcsinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsinh()</span>
<span class="go">asinh(x*y)</span>
<span class="gp">sage: </span><span class="n">asinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arcsinh()</span>
<span class="go">asinh(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arctan">
<span class="sig-name descname"><span class="pre">arctan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arctan" title="Permalink to this definition">¶</a></dt>
<dd><p>Arc tangent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\arctan(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arctan</span><span class="p">()</span>
<span class="go">arctan(x*y)</span>
<span class="gp">sage: </span><span class="n">arctan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctan()</span>
<span class="go">arctan(x*y)</span>
<span class="gp">sage: </span><span class="n">atan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctan()</span>
<span class="go">arctan(x*y)</span>
<span class="gp">sage: </span><span class="n">arctan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arctan(x*y)</span>
<span class="gp">sage: </span><span class="n">arctan</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arctan</span><span class="p">()</span>
<span class="go">atan(x*y)</span>
<span class="gp">sage: </span><span class="n">arctan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctan()</span>
<span class="go">atan(x*y)</span>
<span class="gp">sage: </span><span class="n">atan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctan()</span>
<span class="go">atan(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.arctanh">
<span class="sig-name descname"><span class="pre">arctanh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.arctanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse hyperbolic tangent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\mathrm{arctanh}(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the
current chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arctanh</span><span class="p">()</span>
<span class="go">arctanh(x*y)</span>
<span class="gp">sage: </span><span class="n">arctanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctanh()</span>
<span class="go">arctanh(x*y)</span>
<span class="gp">sage: </span><span class="n">atanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctanh()</span>
<span class="go">arctanh(x*y)</span>
<span class="gp">sage: </span><span class="n">arctanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ arctanh(x*y)</span>
<span class="gp">sage: </span><span class="n">arctanh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">arctanh</span><span class="p">()</span>
<span class="go">atanh(x*y)</span>
<span class="gp">sage: </span><span class="n">arctanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctanh()</span>
<span class="go">atanh(x*y)</span>
<span class="gp">sage: </span><span class="n">atanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.arctanh()</span>
<span class="go">atanh(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.chart">
<span class="sig-name descname"><span class="pre">chart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.chart" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the chart with respect to which <code class="docutils literal notranslate"><span class="pre">self</span></code> is defined.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="chart.html#sage.manifolds.chart.Chart" title="sage.manifolds.chart.Chart"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chart</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="go">Chart (M, (x, y))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span> <span class="ow">is</span> <span class="n">X</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.collect" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect the coefficients of <span class="math notranslate nohighlight">\(s\)</span> in the expression of <code class="docutils literal notranslate"><span class="pre">self</span></code>
into a group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> – the symbol whose coefficients will be collected</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> with the coefficients of <code class="docutils literal notranslate"><span class="pre">s</span></code> grouped in
its expression</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Action on a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2*y^2 + x^2*y + x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">x^2*y^2 + (x^2 + x)*y</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">collect()</span></code> has changed the expression of <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2*y^2 + (x^2 + x)*y</span>
</pre></div>
</div>
<p>The same test with SymPy</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x**2*y**2 + x**2*y + x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">x**2*y**2 + y*(x**2 + x)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.collect_common_factors">
<span class="sig-name descname"><span class="pre">collect_common_factors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.collect_common_factors" title="Permalink to this definition">¶</a></dt>
<dd><p>Collect common factors in the expression of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This method does not perform a full factorization but only looks
for factors which are already explicitly present.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> with the common factors collected in
its expression</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Action on a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x/(x^2*y + x*y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">collect_common_factors</span><span class="p">()</span>
<span class="go">1/((x + 1)*y)</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">collect_common_factors()</span></code> has changed the expression
of <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 1/((x + 1)*y)</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x/(x**2*y + x*y)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">collect_common_factors</span><span class="p">()</span>
<span class="go">1/(y*(x + 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an exact copy of the object.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunctionSymb</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span> <span class="n">g</span>
<span class="go">y^2 + x</span>
</pre></div>
</div>
<p>By construction, <code class="docutils literal notranslate"><span class="pre">g</span></code> is identical to <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>but it is not the same object:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="ow">is</span> <span class="n">f</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.cos">
<span class="sig-name descname"><span class="pre">cos</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.cos" title="Permalink to this definition">¶</a></dt>
<dd><p>Cosine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\cos(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span>
<span class="go">cos(x*y)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.cos()</span>
<span class="go">cos(x*y)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(x*y)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 1</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cos</span><span class="p">()</span>
<span class="go">cos(x*y)</span>
<span class="gp">sage: </span><span class="n">cos</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.cos()</span>
<span class="go">cos(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.cosh">
<span class="sig-name descname"><span class="pre">cosh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.cosh" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyperbolic cosine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\cosh(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosh</span><span class="p">()</span>
<span class="go">cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">cosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.cosh()</span>
<span class="go">cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">cosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">cosh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 1</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">cosh</span><span class="p">()</span>
<span class="go">cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">cosh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.cosh()</span>
<span class="go">cosh(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.derivative">
<span class="sig-name descname"><span class="pre">derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial derivative with respect to a coordinate.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coord</span></code> – either the coordinate <span class="math notranslate nohighlight">\(x^i\)</span> with respect
to which the derivative of the chart function <span class="math notranslate nohighlight">\(f\)</span> is to be
taken, or the index <span class="math notranslate nohighlight">\(i\)</span> labelling this coordinate (with the
index convention defined on the chart domain via the parameter
<code class="docutils literal notranslate"><span class="pre">start_index</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> representing the partial
derivative <span class="math notranslate nohighlight">\(\frac{\partial f}{\partial x^i}\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Partial derivatives of a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;SR&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">diff</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
</pre></div>
</div>
<p>Each partial derivative is itself a chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class&#39;&gt;</span>
</pre></div>
</div>
<p>The same result is returned by the function <code class="docutils literal notranslate"><span class="pre">diff</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
</pre></div>
</div>
<p>An index can be used instead of the coordinate symbol:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The index range depends on the convention used on the chart’s domain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: coordinate index out of range</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x**2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.diff">
<span class="sig-name descname"><span class="pre">diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Partial derivative with respect to a coordinate.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">coord</span></code> – either the coordinate <span class="math notranslate nohighlight">\(x^i\)</span> with respect
to which the derivative of the chart function <span class="math notranslate nohighlight">\(f\)</span> is to be
taken, or the index <span class="math notranslate nohighlight">\(i\)</span> labelling this coordinate (with the
index convention defined on the chart domain via the parameter
<code class="docutils literal notranslate"><span class="pre">start_index</span></code>)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> representing the partial
derivative <span class="math notranslate nohighlight">\(\frac{\partial f}{\partial x^i}\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Partial derivatives of a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;SR&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x^2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">derivative</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>An alias is <code class="docutils literal notranslate"><span class="pre">diff</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
</pre></div>
</div>
<p>Each partial derivative is itself a chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class&#39;&gt;</span>
</pre></div>
</div>
<p>The same result is returned by the function <code class="docutils literal notranslate"><span class="pre">diff</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
</pre></div>
</div>
<p>An index can be used instead of the coordinate symbol:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The index range depends on the convention used on the chart’s domain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: coordinate index out of range</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span> <span class="n">f</span>
<span class="go">x**2 + 3*y + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.disp">
<span class="sig-name descname"><span class="pre">disp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.disp" title="Permalink to this definition">¶</a></dt>
<dd><p>Display <code class="docutils literal notranslate"><span class="pre">self</span></code> in arrow notation.
For display the standard <code class="docutils literal notranslate"><span class="pre">SR</span></code> representation is used.</p>
<p>The output is either text-formatted (console mode) or
LaTeX-formatted (notebook mode).</p>
<p>EXAMPLES:</p>
<p>Coordinate function on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(1/2*x*y)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">())</span>
<span class="go">\left(x, y\right) \mapsto \cos\left(\frac{1}{2} \, x y\right)</span>
</pre></div>
</div>
<p>A shortcut is <code class="docutils literal notranslate"><span class="pre">disp()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">disp</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(1/2*x*y)</span>
</pre></div>
</div>
<p>Display of the zero function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.display">
<span class="sig-name descname"><span class="pre">display</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.display" title="Permalink to this definition">¶</a></dt>
<dd><p>Display <code class="docutils literal notranslate"><span class="pre">self</span></code> in arrow notation.
For display the standard <code class="docutils literal notranslate"><span class="pre">SR</span></code> representation is used.</p>
<p>The output is either text-formatted (console mode) or
LaTeX-formatted (notebook mode).</p>
<p>EXAMPLES:</p>
<p>Coordinate function on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(1/2*x*y)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">())</span>
<span class="go">\left(x, y\right) \mapsto \cos\left(\frac{1}{2} \, x y\right)</span>
</pre></div>
</div>
<p>A shortcut is <code class="docutils literal notranslate"><span class="pre">disp()</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">disp</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(1/2*x*y)</span>
</pre></div>
</div>
<p>Display of the zero function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.exp">
<span class="sig-name descname"><span class="pre">exp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\exp(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">e^(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># equivalent to f.exp()</span>
<span class="go">e^(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ e^(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">exp(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># equivalent to f.exp()</span>
<span class="go">exp(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ exp(x + y)</span>
<span class="gp">sage: </span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.expand">
<span class="sig-name descname"><span class="pre">expand</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand the coordinate expression of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> with its expression expanded</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Expanding a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ (x - y)^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">x^2 - 2*x*y + y^2</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">expand()</span></code> has changed the expression of <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2 - 2*x*y + y^2</span>
</pre></div>
</div>
<p>The same test with SymPy</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
<span class="go">x**2 - 2*x*y + y**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.expr">
<span class="sig-name descname"><span class="pre">expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the symbolic expression of <code class="docutils literal notranslate"><span class="pre">self</span></code> in terms of the chart
coordinates, as an object of a specified calculus method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>): the calculus method which
the returned expression belongs to; one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'SR'</span></code>: Sage’s default symbolic engine (Symbolic Ring)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code>: SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: the chart current calculus method is assumed</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference external" href="../../../calculus/sage/symbolic/expression.html#sage.symbolic.expression.Expression" title="(in Sage 9.5 Reference Manual: Symbolic Calculus v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sage</span> <span class="pre">symbolic</span> <span class="pre">expression</span></code></a>
if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">'SR'</span></code></p></li>
<li><p>a SymPy object if <code class="docutils literal notranslate"><span class="pre">method</span></code> is <code class="docutils literal notranslate"><span class="pre">'sympy'</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Chart function on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">x^2 + y</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>Asking for the SymPy expression:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">x**2 + y</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">))</span>
<span class="go">&lt;class &#39;sympy.core.add.Add&#39;&gt;</span>
</pre></div>
</div>
<p>The default corresponds to the current calculus method, here the one
based on the Symbolic Ring <code class="docutils literal notranslate"><span class="pre">SR</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span> <span class="ow">is</span> <span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If we change the current calculus method on chart <code class="docutils literal notranslate"><span class="pre">X</span></code>, we change the
default:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">x**2 + y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span> <span class="ow">is</span> <span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">)</span>  <span class="c1"># revert back to SR</span>
</pre></div>
</div>
<p>Internally, the expressions corresponding to various calculus methods
are stored in the dictionary <code class="docutils literal notranslate"><span class="pre">_express</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">method</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">_express</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">{}</span><span class="s2">&#39;: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">_express</span><span class="p">[</span><span class="n">method</span><span class="p">]))</span>
<span class="gp">....:</span>
<span class="go">&#39;SR&#39;: x^2 + y</span>
<span class="go">&#39;sympy&#39;: x**2 + y</span>
</pre></div>
</div>
<p>The method <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction.expr" title="sage.manifolds.chart_func.ChartFunction.expr"><code class="xref py py-meth docutils literal notranslate"><span class="pre">expr()</span></code></a> is useful for accessing to all the
symbolic expression functionalities in Sage; for instance:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">a</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">);</span> <span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ a*x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">a*x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">2*x*y</span>
</pre></div>
</div>
<p>Note that for substituting the value of a coordinate, the function
call can be used as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">3*a*x</span>
<span class="gp">sage: </span><span class="nb">bool</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.factor">
<span class="sig-name descname"><span class="pre">factor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Factorize the coordinate expression of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> with its expression factorized</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Factorization of a 2-dimensional chart function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x^2 + 2*x*y + y^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + y)^2</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">factor()</span></code> has changed the expression of <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ (x + y)^2</span>
</pre></div>
</div>
<p>The same test with SymPy</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x**2 + 2*x*y + y**2</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + y)**2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.is_trivial_one">
<span class="sig-name descname"><span class="pre">is_trivial_one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.is_trivial_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is trivially equal to one without any
simplification.</p>
<p>This method is supposed to be fast as compared with
<code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">==</span> <span class="pre">1</span></code> and is intended to be used in library code where
trying to obtain a mathematically correct result by applying
potentially expensive rewrite rules is not desirable.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_one</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">one_function</span><span class="p">()</span><span class="o">.</span><span class="n">is_trivial_one</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>No simplification is attempted, so that <code class="docutils literal notranslate"><span class="pre">False</span></code> is returned for
non-trivial cases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_one</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>On the contrary, the method
<a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.Element.is_zero" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_zero()</span></code></a> and the direct
comparison to one involve some simplification algorithms and
return <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.is_trivial_zero">
<span class="sig-name descname"><span class="pre">is_trivial_zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.is_trivial_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">self</span></code> is trivially equal to zero without any
simplification.</p>
<p>This method is supposed to be fast as compared with
<code class="docutils literal notranslate"><span class="pre">self.is_zero()</span></code> or <code class="docutils literal notranslate"><span class="pre">self</span> <span class="pre">==</span> <span class="pre">0</span></code> and is intended to be
used in library code where trying to obtain a mathematically
correct result by applying potentially expensive rewrite rules
is not desirable.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="mf">0.0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span><span class="o">.</span><span class="n">is_trivial_zero</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>No simplification is attempted, so that <code class="docutils literal notranslate"><span class="pre">False</span></code> is returned for
non-trivial cases:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_trivial_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>On the contrary, the method
<a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.Element.is_zero" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_zero()</span></code></a> and the direct
comparison to zero involve some simplification algorithms and
return <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.is_unit">
<span class="sig-name descname"><span class="pre">is_unit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.is_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> iff <code class="docutils literal notranslate"><span class="pre">self</span></code> is not trivially zero since most chart
functions are invertible and an actual computation would take too much
time.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">zero</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">zero</span><span class="o">.</span><span class="n">is_unit</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Logarithm of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) base of the logarithm; if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
the natural logarithm (i.e. logarithm to base <span class="math notranslate nohighlight">\(e\)</span>) is returned</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\log_a(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current chart
function and <span class="math notranslate nohighlight">\(a\)</span> is the base</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">log(x + y)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># equivalent to f.log()</span>
<span class="go">log(x + y)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ log(x + y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">log(x + y)/log(2)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">log(x + y)/log(2)</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">log(x + y)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c1"># equivalent to f.log()</span>
<span class="go">log(x + y)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ log(x + y)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">log(x + y)/log(2)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">log(x + y)/log(2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.scalar_field">
<span class="sig-name descname"><span class="pre">scalar_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">latex_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.scalar_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct the scalar field that has <code class="docutils literal notranslate"><span class="pre">self</span></code> as coordinate expression.</p>
<p>The domain of the scalar field is the open subset covered by the
chart on which <code class="docutils literal notranslate"><span class="pre">self</span></code> is defined.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) name given to the scalar field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latex_name</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) LaTeX symbol to denote the
scalar field; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the LaTeX symbol is set to <code class="docutils literal notranslate"><span class="pre">name</span></code></p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="scalarfield.html#sage.manifolds.scalarfield.ScalarField" title="sage.manifolds.scalarfield.ScalarField"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScalarField</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Construction of a scalar field on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c_xy</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">fc</span> <span class="o">=</span> <span class="n">c_xy</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">fc</span><span class="o">.</span><span class="n">scalar_field</span><span class="p">()</span> <span class="p">;</span> <span class="n">f</span>
<span class="go">Scalar field on the 2-dimensional topological manifold M</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">M → ℝ</span>
<span class="go">(x, y) ↦ 2*y^3 + x</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">coord_function</span><span class="p">(</span><span class="n">c_xy</span><span class="p">)</span> <span class="ow">is</span> <span class="n">fc</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.set_expr">
<span class="sig-name descname"><span class="pre">set_expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">calc_method</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expression</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.set_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Add an expression in a particular calculus method  <code class="docutils literal notranslate"><span class="pre">self</span></code>.
Some control is done to verify the consistency between the
different representations of the same expression.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_method</span></code> – calculus method</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expression</span></code> – symbolic expression</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">_repr_</span><span class="p">()</span>
<span class="go">&#39;x^2 + 1&#39;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">set_expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">,</span><span class="s1">&#39;x**2+1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>  <span class="c1"># indirect doctest</span>
<span class="go">x^2 + 1</span>

<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">_repr_</span><span class="p">()</span>
<span class="go">&#39;x^3 + 1&#39;</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">,</span><span class="s1">&#39;x**2+y&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Expressions are not equal</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.simplify">
<span class="sig-name descname"><span class="pre">simplify</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.simplify" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify the coordinate expression of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>For details about the employed chain of simplifications for the <code class="docutils literal notranslate"><span class="pre">SR</span></code>
calculus method, see
<a class="reference internal" href="utilities.html#sage.manifolds.utilities.simplify_chain_real" title="sage.manifolds.utilities.simplify_chain_real"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify_chain_real()</span></code></a> for chart
functions on real manifolds and
<a class="reference internal" href="utilities.html#sage.manifolds.utilities.simplify_chain_generic" title="sage.manifolds.utilities.simplify_chain_generic"><code class="xref py py-func docutils literal notranslate"><span class="pre">simplify_chain_generic()</span></code></a> for the
generic case.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has been defined with the small parameter
<code class="docutils literal notranslate"><span class="pre">expansion_symbol</span></code> and some truncation order, the coordinate
expression of <code class="docutils literal notranslate"><span class="pre">self</span></code> will be expanded in power series of that
parameter and truncated to the given order.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">self</span></code> with its coordinate expression simplified</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Simplification of a chart function on a 2-dimensional manifold:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ cos(x)^2 + sin(x)^2 + abs(x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">abs(x) + 1</span>
</pre></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> has changed the expression of <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ abs(x) + 1</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">(x^2 - 1)/(x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">x - 1</span>
</pre></div>
</div>
<p>Examples taking into account the declared range of a coordinate:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x:(1,+oo) y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">sqrt(x^2 - 2*x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">x - 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>  <span class="c1"># to clear the previous assumption on x</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x:(-oo,0) y&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">sqrt(x^2 - 2*x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">-x + 1</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>  <span class="c1"># to clear the previous assumption on x</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">));</span> <span class="n">f</span>
<span class="go">sin(x)**2 + cos(x)**2 + Abs(x)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">Abs(x) + 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">((</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">(x**2 - 1)/(x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">x - 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x:(1,+oo) y&#39;</span><span class="p">,</span> <span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">sqrt(x**2 - 2*x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">x - 1</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>  <span class="c1"># to clear the previous assumption on x</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="s1">&#39;x:(-oo,0) y&#39;</span><span class="p">,</span> <span class="n">calc_method</span><span class="o">=</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">));</span> <span class="n">f</span>
<span class="go">sqrt(x**2 - 2*x + 1)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">1 - x</span>
</pre></div>
</div>
<p>Power series expansion with respect to a small parameter <span class="math notranslate nohighlight">\(t\)</span> (at
the moment, this is implemented only for the <code class="docutils literal notranslate"><span class="pre">SR</span></code> calculus backend,
hence the first line below):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;SR&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">var</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="o">*</span><span class="n">x</span><span class="p">),</span> <span class="n">expansion_symbol</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>At this stage, <span class="math notranslate nohighlight">\(f\)</span> is not expanded in power series:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span>
<span class="go">e^(t*x)</span>
</pre></div>
</div>
<p>Invoking <code class="docutils literal notranslate"><span class="pre">simplify()</span></code> triggers the expansion to the given order:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">1/6*t^3*x^3 + 1/2*t^2*x^2 + t*x + 1</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 1/6*t^3*x^3 + 1/2*t^2*x^2 + t*x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.sin">
<span class="sig-name descname"><span class="pre">sin</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.sin" title="Permalink to this definition">¶</a></dt>
<dd><p>Sine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\sin(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span class="go">sin(x*y)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.sin()</span>
<span class="go">sin(x*y)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ sin(x*y)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="mi">2</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">f</span><span class="o">+</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span>
<span class="go">2*y + 1</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sin</span><span class="p">()</span>
<span class="go">sin(x*y)</span>
<span class="gp">sage: </span><span class="n">sin</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.sin()</span>
<span class="go">sin(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.sinh">
<span class="sig-name descname"><span class="pre">sinh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.sinh" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyperbolic sine of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\sinh(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sinh</span><span class="p">()</span>
<span class="go">sinh(x*y)</span>
<span class="gp">sage: </span><span class="n">sinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.sinh()</span>
<span class="go">sinh(x*y)</span>
<span class="gp">sage: </span><span class="n">sinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ sinh(x*y)</span>
<span class="gp">sage: </span><span class="n">sinh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sinh</span><span class="p">()</span>
<span class="go">sinh(x*y)</span>
<span class="gp">sage: </span><span class="n">sinh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.sinh()</span>
<span class="go">sinh(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.sqrt">
<span class="sig-name descname"><span class="pre">sqrt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.sqrt" title="Permalink to this definition">¶</a></dt>
<dd><p>Square root of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\sqrt{f}\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">sqrt(x + y)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.sqrt()</span>
<span class="go">sqrt(x + y)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ sqrt(x + y)</span>
<span class="gp">sage: </span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.tan">
<span class="sig-name descname"><span class="pre">tan</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.tan" title="Permalink to this definition">¶</a></dt>
<dd><p>Tangent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\tan(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">tan</span><span class="p">()</span>
<span class="go">sin(x*y)/cos(x*y)</span>
<span class="gp">sage: </span><span class="n">tan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.tan()</span>
<span class="go">sin(x*y)/cos(x*y)</span>
<span class="gp">sage: </span><span class="n">tan</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ sin(x*y)/cos(x*y)</span>
<span class="gp">sage: </span><span class="n">tan</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same test with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">set_calculus_method</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">tan</span><span class="p">()</span>
<span class="go">tan(x*y)</span>
<span class="gp">sage: </span><span class="n">tan</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>  <span class="c1"># equivalent to g.tan()</span>
<span class="go">tan(x*y)</span>
<span class="gp">sage: </span><span class="n">tan</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ tan(x*y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunction.tanh">
<span class="sig-name descname"><span class="pre">tanh</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunction.tanh" title="Permalink to this definition">¶</a></dt>
<dd><p>Hyperbolic tangent of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>chart function <span class="math notranslate nohighlight">\(\tanh(f)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is the current
chart function</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">tanh</span><span class="p">()</span>
<span class="go">sinh(x*y)/cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">tanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.tanh()</span>
<span class="go">sinh(x*y)/cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">tanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ sinh(x*y)/cosh(x*y)</span>
<span class="gp">sage: </span><span class="n">tanh</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">())</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">zero_function</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The same tests with SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">calculus_method</span><span class="p">()</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">tanh</span><span class="p">()</span>
<span class="go">tanh(x*y)</span>
<span class="gp">sage: </span><span class="n">tanh</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>  <span class="c1"># equivalent to f.tanh()</span>
<span class="go">tanh(x*y)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.chart_func.</span></span><span class="sig-name descname"><span class="pre">ChartFunctionRing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.parent.Parent</span></code></a>, <a class="reference external" href="../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a></p>
<p>Ring of all chart functions on a chart.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chart</span></code> – a coordinate chart, as an instance of class
<a class="reference internal" href="chart.html#sage.manifolds.chart.Chart" title="sage.manifolds.chart.Chart"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chart</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<p>The ring of all chart functions w.r.t. to a chart:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">();</span> <span class="n">FR</span>
<span class="go">Ring of chart functions on Chart (M, (x, y))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">FR</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of commutative algebras over Symbolic Ring</span>
</pre></div>
</div>
<p>Coercions by means of restrictions are implemented:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FR_X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">open_subset</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X_D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">restrict</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># open disk</span>
<span class="gp">sage: </span><span class="n">FR_X_D</span> <span class="o">=</span> <span class="n">X_D</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR_X_D</span><span class="o">.</span><span class="n">has_coerce_map_from</span><span class="p">(</span><span class="n">FR_X</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But only if the charts are compatible:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span><span class="o">.&lt;</span><span class="n">t</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR_Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR_Y</span><span class="o">.</span><span class="n">has_coerce_map_from</span><span class="p">(</span><span class="n">FR_X</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing.is_field">
<span class="sig-name descname"><span class="pre">is_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing.is_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> as <code class="docutils literal notranslate"><span class="pre">self</span></code> is not an integral domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">is_integral_domain</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing.is_integral_domain">
<span class="sig-name descname"><span class="pre">is_integral_domain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing.is_integral_domain" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">False</span></code> as <code class="docutils literal notranslate"><span class="pre">self</span></code> is not an integral domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">is_integral_domain</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing.one">
<span class="sig-name descname"><span class="pre">one</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing.one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constant function <span class="math notranslate nohighlight">\(1\)</span> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span><span class="o">.</span><span class="n">one</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.ChartFunctionRing.zero">
<span class="sig-name descname"><span class="pre">zero</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.ChartFunctionRing.zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the constant function <span class="math notranslate nohighlight">\(0\)</span> in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">FR</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">,</span> <span class="n">field</span><span class="o">=</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">function_ring</span><span class="p">()</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.manifolds.chart_func.</span></span><span class="sig-name descname"><span class="pre">MultiCoordFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expressions</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a>, <a class="reference external" href="../../../structure/sage/structure/mutability.html#sage.structure.mutability.Mutability" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.mutability.Mutability</span></code></a></p>
<p>Coordinate function to some Cartesian power of the base field.</p>
<p>If <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> are two positive integers and <span class="math notranslate nohighlight">\((U, \varphi)\)</span> is a chart on
a topological manifold <span class="math notranslate nohighlight">\(M\)</span> of dimension <span class="math notranslate nohighlight">\(n\)</span> over a topological field <span class="math notranslate nohighlight">\(K\)</span>,
a <em>multi-coordinate function</em> associated to <span class="math notranslate nohighlight">\((U, \varphi)\)</span> is a map</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{array}{llcl}
f:&amp; V \subset K^n &amp; \longrightarrow &amp; K^m \\
  &amp; (x^1, \ldots, x^n) &amp; \longmapsto &amp; (f_1(x^1, \ldots, x^n),
    \ldots, f_m(x^1, \ldots, x^n)),
\end{array}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(V\)</span> is the codomain of <span class="math notranslate nohighlight">\(\varphi\)</span>. In other words, <span class="math notranslate nohighlight">\(f\)</span> is a
<span class="math notranslate nohighlight">\(K^m\)</span>-valued function of the coordinates associated to the chart
<span class="math notranslate nohighlight">\((U, \varphi)\)</span>. Each component <span class="math notranslate nohighlight">\(f_i\)</span> (<span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>) is a coordinate
function and is therefore stored as a
<a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">chart</span></code> – the chart <span class="math notranslate nohighlight">\((U, \varphi)\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expressions</span></code> – list (or tuple) of length <span class="math notranslate nohighlight">\(m\)</span> of elements to
construct the coordinate functions <span class="math notranslate nohighlight">\(f_i\)</span> (<span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>); for
symbolic coordinate functions, this must be symbolic expressions
involving the chart coordinates, while for numerical coordinate
functions, this must be data file names</p></li>
</ul>
<p>EXAMPLES:</p>
<p>A function <span class="math notranslate nohighlight">\(f: V \subset \RR^2 \longrightarrow \RR^3\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">forget</span><span class="p">()</span>  <span class="c1"># to clear the previous assumption on x</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">));</span> <span class="n">f</span>
<span class="go">Coordinate functions (x - y, x*y, cos(x)*e^y) on the Chart (M, (x, y))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.MultiCoordFunction&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x - y, x*y, cos(x)*e^y)</span>
<span class="gp">sage: </span><span class="n">latex</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="go">\left(x - y, x y, \cos\left(x\right) e^{y}\right)</span>
</pre></div>
</div>
<p>Each real-valued function <span class="math notranslate nohighlight">\(f_i\)</span> (<span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>) composing <span class="math notranslate nohighlight">\(f\)</span> can
be accessed via the square-bracket operator, by providing <span class="math notranslate nohighlight">\(i-1\)</span> as an
argument:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">x - y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">x*y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">cos(x)*e^y</span>
</pre></div>
</div>
<p>We can give a more verbose explanation of each function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x - y</span>
</pre></div>
</div>
<p>Each <code class="docutils literal notranslate"><span class="pre">f[i-1]</span></code> is an instance of
<a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sage</span><span class="o">.</span><span class="n">manifolds</span><span class="o">.</span><span class="n">chart_func</span><span class="o">.</span><span class="n">ChartFunction</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A class <a class="reference internal" href="#sage.manifolds.chart_func.MultiCoordFunction" title="sage.manifolds.chart_func.MultiCoordFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiCoordFunction</span></code></a> can represent a
real-valued function (case <span class="math notranslate nohighlight">\(m = 1\)</span>), although one should
rather employ the class <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a>
for this purpose:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="go">(x*y^2,)</span>
</pre></div>
</div>
<p>Evaluating the functions at specified coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(-1, 2, cos(1)*e^2)</span>
<span class="gp">sage: </span><span class="n">var</span><span class="p">(</span><span class="s1">&#39;a b&#39;</span><span class="p">)</span>
<span class="go">(a, b)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
<span class="go">(a - b, a*b, cos(a)*e^b)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(4,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction.chart">
<span class="sig-name descname"><span class="pre">chart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction.chart" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the chart with respect to which <code class="docutils literal notranslate"><span class="pre">self</span></code> is defined.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="chart.html#sage.manifolds.chart.Chart" title="sage.manifolds.chart.Chart"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chart</span></code></a></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="go">Chart (M, (x, y))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span> <span class="ow">is</span> <span class="n">X</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction.expr">
<span class="sig-name descname"><span class="pre">expr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction.expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple of data, the item no. <span class="math notranslate nohighlight">\(i\)</span> being sufficient to
reconstruct the coordinate function no. <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>In other words, if <code class="docutils literal notranslate"><span class="pre">f</span></code> is a multi-coordinate function, then
<code class="docutils literal notranslate"><span class="pre">f.chart().multifunction(*(f.expr()))</span></code> results in a
multi-coordinate function identical to <code class="docutils literal notranslate"><span class="pre">f</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>): the calculus method which
the returned expressions belong to; one of</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'SR'</span></code>: Sage’s default symbolic engine (Symbolic Ring)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sympy'</span></code>: SymPy</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: the chart current calculus method is assumed</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a tuple of the symbolic expressions of the chart functions
composing <code class="docutils literal notranslate"><span class="pre">self</span></code></p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span>
<span class="go">(x - y, x*y, cos(x)*e^y)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;sage.symbolic.expression.Expression&#39;&gt;</span>
</pre></div>
</div>
<p>A SymPy output:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="go">(x - y, x*y, exp(y)*cos(x))</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;sympy.core.add.Add&#39;&gt;</span>
</pre></div>
</div>
<p>One shall always have:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">expr</span><span class="p">()))</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction.jacobian">
<span class="sig-name descname"><span class="pre">jacobian</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Jacobian matrix of the system of coordinate functions.</p>
<p><code class="docutils literal notranslate"><span class="pre">jacobian()</span></code> is a 2-dimensional array of size <span class="math notranslate nohighlight">\(m \times n\)</span>,
where <span class="math notranslate nohighlight">\(m\)</span> is the number of functions and <span class="math notranslate nohighlight">\(n\)</span> the number of
coordinates, the generic element being
<span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial f_i}{\partial x^j}\)</span> with <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span>
(row index) and <span class="math notranslate nohighlight">\(1 \leq j \leq n\)</span> (column index).</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>Jacobian matrix as a 2-dimensional array <code class="docutils literal notranslate"><span class="pre">J</span></code> of
coordinate functions with <code class="docutils literal notranslate"><span class="pre">J[i-1][j-1]</span></code> being
<span class="math notranslate nohighlight">\(J_{ij} = \frac{\partial f_i}{\partial x^j}\)</span>
for <span class="math notranslate nohighlight">\(1 \leq i \leq m\)</span> and <span class="math notranslate nohighlight">\(1 \leq j \leq n\)</span></p></li>
</ul>
<p>EXAMPLES:</p>
<p>Jacobian of a set of 3 functions of 2 coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span>
<span class="go">[           1           -1]</span>
<span class="go">[           y            x]</span>
<span class="go">[ -y^3*sin(x) 3*y^2*cos(x)]</span>
</pre></div>
</div>
<p>Each element of the result is a
<a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">chart</span> <span class="pre">function</span></code></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ -y^3*sin(x)</span>
</pre></div>
</div>
<p>Test of the computation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[[</span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[[True, True], [True, True], [True, True]]</span>
</pre></div>
</div>
<p>Test with <code class="docutils literal notranslate"><span class="pre">start_index</span> <span class="pre">=</span> <span class="pre">1</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">,</span> <span class="n">start_index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()</span>
<span class="go">[           1           -1]</span>
<span class="go">[           y            x]</span>
<span class="go">[ -y^3*sin(x) 3*y^2*cos(x)]</span>
<span class="gp">sage: </span><span class="p">[[</span><span class="n">f</span><span class="o">.</span><span class="n">jacobian</span><span class="p">()[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>  <span class="c1"># note the j+1</span>
<span class="gp">....: </span>                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="go">[[True, True], [True, True], [True, True]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction.jacobian_det">
<span class="sig-name descname"><span class="pre">jacobian_det</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction.jacobian_det" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Jacobian determinant of the system of functions.</p>
<p>The number <span class="math notranslate nohighlight">\(m\)</span> of coordinate functions must equal the number <span class="math notranslate nohighlight">\(n\)</span>
of coordinates.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a <a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> representing the determinant</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Jacobian determinant of a set of 2 functions of 2 coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span>
<span class="go">x + y</span>
</pre></div>
</div>
<p>The output of <a class="reference internal" href="#sage.manifolds.chart_func.MultiCoordFunction.jacobian_det" title="sage.manifolds.chart_func.MultiCoordFunction.jacobian_det"><code class="xref py py-meth docutils literal notranslate"><span class="pre">jacobian_det()</span></code></a> is an instance of
<a class="reference internal" href="#sage.manifolds.chart_func.ChartFunction" title="sage.manifolds.chart_func.ChartFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChartFunction</span></code></a> and can therefore be called on specific
values of the coordinates, e.g. <span class="math notranslate nohighlight">\((x,y) = (1,2)\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">())</span>
<span class="go">&lt;class &#39;sage.manifolds.chart_func.ChartFunctionRing_with_category.element_class&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y) ↦ x + y</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The result is cached:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span> <span class="ow">is</span> <span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We verify the determinant of the Jacobian:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span> <span class="o">==</span> <span class="n">det</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">....: </span>                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example using SymPy:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">set_calculus_method</span><span class="p">(</span><span class="s1">&#39;sympy&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="n">e</span><span class="o">^</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span>
<span class="go">-3*x*y**2*exp(x)</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span><span class="o">.</span><span class="n">expr</span><span class="p">())</span>
<span class="go">&lt;class &#39;sympy.core.mul.Mul&#39;&gt;</span>
</pre></div>
</div>
<p>Jacobian determinant of a set of 3 functions of 3 coordinates:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">z</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">(x, y, z) ↦ 6*x^3*y^5*z^3 - 3*x^4*y^3*z^4 - 12*x^2*y^4*z^5 + 6*x^3*y^2*z^6</span>
</pre></div>
</div>
<p>We verify the determinant of the Jacobian:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">jacobian_det</span><span class="p">()</span> <span class="o">==</span> <span class="n">det</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">.</span><span class="n">expr</span><span class="p">()</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="gp">....: </span>                                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.manifolds.chart_func.MultiCoordFunction.set_immutable">
<span class="sig-name descname"><span class="pre">set_immutable</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.manifolds.chart_func.MultiCoordFunction.set_immutable" title="Permalink to this definition">¶</a></dt>
<dd><p>Set <code class="docutils literal notranslate"><span class="pre">self</span></code> and all chart functions of <code class="docutils literal notranslate"><span class="pre">self</span></code> immutable.</p>
<p>EXAMPLES:</p>
<p>Declare a coordinate function immutable:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Manifold</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;topological&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">chart</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">multifunction</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="o">+</span><span class="n">z</span><span class="p">,</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The chart functions are now immutable, too:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Ring of chart functions on Chart (M, (x, y, z))</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="chart.html"
                        title="previous chapter">Coordinate Charts</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="calculus_method.html"
                        title="next chapter">Coordinate calculus methods</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/manifolds/chart_func.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="calculus_method.html" title="Coordinate calculus methods"
             >next</a> |</li>
        <li class="right" >
          <a href="chart.html" title="Coordinate Charts"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Manifolds</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../manifold.html" >Topological Manifolds</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../chart.html" >Coordinate Charts</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Chart Functions</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>