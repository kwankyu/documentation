
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Element class for Pollack-Stevens’ Modular Symbols &#8212; Sage Reference Manual v8.2: Modular Symbols</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Quotients of the Bruhat-Tits tree" href="../btquotients/btquotient.html" />
    <link rel="prev" title="Manin map" href="manin_map.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../btquotients/btquotient.html" title="Quotients of the Bruhat-Tits tree"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="manin_map.html" title="Manin map"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Symbols</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="element-class-for-pollack-stevens-modular-symbols">
<span id="sage-modular-pollack-stevens-modsym"></span><h1>Element class for Pollack-Stevens’ Modular Symbols<a class="headerlink" href="#element-class-for-pollack-stevens-modular-symbols" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.pollack_stevens.modsym"></span><p>This is the class of elements in the spaces of Pollack-Steven’s modular symbols as described in <a class="reference internal" href="space.html#ps" id="id1">[PS]</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">();</span> <span class="n">phi</span>
<span class="go">Modular symbol of level 11 with values in Sym^0 Q^2</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span> <span class="c1"># Note that weight k=2 of a modular form corresponds here to weight 0</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_lift</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">eigensymbol</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">phi_lift</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">()</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">O(11^5) + (10 + 3*11 + 6*11^2 + 9*11^3 + O(11^4))*T + (6 + 3*11 + 2*11^2 + O(11^3))*T^2 + (2 + 2*11 + O(11^2))*T^3 + (5 + O(11))*T^4 + O(T^5)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="n">Gamma1</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plus_submodule</span><span class="p">()</span><span class="o">.</span><span class="n">new_subspace</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.space</span> <span class="kn">import</span> <span class="n">ps_modsym_from_simple_modsym_space</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ps_modsym_from_simple_modsym_space</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[(-1, 0, 0), (1, 0, 0), (-9, -6, -4)]</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.modular.pollack_stevens.modsym.PSModSymAction">
<em class="property">class </em><code class="descclassname">sage.modular.pollack_stevens.modsym.</code><code class="descname">PSModSymAction</code><span class="sig-paren">(</span><em>actor</em>, <em>MSspace</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModSymAction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../coercion/sage/categories/action.html#sage.categories.action.Action" title="(in Sage Reference Manual: Coercion v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.categories.action.Action</span></code></a></p>
<p>Create the action</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">_map</span><span class="o">.</span><span class="n">_codomain</span><span class="o">.</span><span class="n">_act</span><span class="o">.</span><span class="n">_Sigma0</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">*</span> <span class="n">g</span> <span class="c1"># indirect doctest</span>
<span class="go">Modular symbol of level 11 with values in Sym^0 Q^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement">
<em class="property">class </em><code class="descclassname">sage.modular.pollack_stevens.modsym.</code><code class="descname">PSModularSymbolElement</code><span class="sig-paren">(</span><em>map_data</em>, <em>parent</em>, <em>construct=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.ModuleElement" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.ModuleElement</span></code></a></p>
<p>Initialize a modular symbol</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.Tq_eigenvalue">
<code class="descname">Tq_eigenvalue</code><span class="sig-paren">(</span><em>q</em>, <em>p=None</em>, <em>M=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.Tq_eigenvalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Eigenvalue of <span class="math">\(T_q\)</span> modulo <span class="math">\(p^M\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code> – prime of the Hecke operator</li>
<li><code class="docutils literal"><span class="pre">p</span></code> – prime we are working modulo (default: None)</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – degree of accuracy of approximation (default: None)</li>
<li><code class="docutils literal"><span class="pre">check</span></code> – check that <code class="docutils literal"><span class="pre">self</span></code> is an eigensymbol</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>Constant <span class="math">\(c\)</span> such that <span class="math">\(self|T_q - c * self\)</span> has valuation greater than
or equal to <span class="math">\(M\)</span> (if it exists), otherwise raises ValueError</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi_ord</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ap</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ordinary</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
<span class="go">O(3^10)</span>

<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">2 + 3^2 + 2*3^3 + 2*3^4 + 2*3^6 + 3^8 + 2*3^9 + O(3^10)</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">result not determined to high enough precision</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.diagonal_valuation">
<code class="descname">diagonal_valuation</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.diagonal_valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimum of the diagonal valuation on the values of self</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – a positive integral prime</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">diagonal_valuation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">diagonal_valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">diagonal_valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">diagonal_valuation</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.dict">
<code class="descname">dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dictionary on the modular symbol self, where keys are generators and values are the corresponding values of self on generators</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">moment</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">phi</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span> <span class="o">==</span> <span class="n">Set</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.evaluate_twisted">
<code class="descname">evaluate_twisted</code><span class="sig-paren">(</span><em>a</em>, <em>chi</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.evaluate_twisted" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math">\(\Phi_{\chi}(\{a/p\}-\{\infty\})\)</span> where <span class="math">\(\Phi\)</span> is <code class="docutils literal"><span class="pre">self</span></code> and
<span class="math">\(\chi\)</span> is a quadratic character</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">a</span></code> – integer in the range range(p)</li>
<li><code class="docutils literal"><span class="pre">chi</span></code> – the modulus of a quadratic character.</li>
</ul>
<p>OUTPUT:</p>
<p>The distribution <span class="math">\(\Phi_{\chi}(\{a/p\}-\{\infty\})\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;17a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;pollackstevens&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#long time</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">()</span>          <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate_twisted</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">(1 + 5 + 3*5^2 + 5^3 + O(5^4), 5^2 + O(5^3), 1 + O(5^2), 2 + O(5))</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;40a4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;pollackstevens&quot;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span> <span class="c1">#long time</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">quadratic_twist</span><span class="p">()</span>          <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate_twisted</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">D</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">(4 + 6*7 + 3*7^2 + O(7^4), 6*7 + 6*7^2 + O(7^3), 6 + O(7^2), 1 + O(7))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.hecke">
<code class="descname">hecke</code><span class="sig-paren">(</span><em>ell</em>, <em>algorithm='prep'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.hecke" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self | <span class="math">\(T_{\ell}\)</span> by making use of the precomputations in
self.prep_hecke()</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">ell</span></code> – a prime</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> – a string, either ‘prep’ (default) or
‘naive’</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The image of this element under the Hecke operator
<span class="math">\(T_{\ell}\)</span></li>
</ul>
<p>ALGORITHMS:</p>
<ul class="simple">
<li>If <code class="docutils literal"><span class="pre">algorithm</span> <span class="pre">==</span> <span class="pre">'prep'</span></code>, precomputes a list of matrices
that only depend on the level, then uses them to speed up
the action.</li>
<li>If <code class="docutils literal"><span class="pre">algorithm</span> <span class="pre">==</span> <span class="pre">'naive'</span></code>, just acts by the matrices
defining the Hecke operator.  That is, it computes
sum_a self | [1,a,0,ell] + self | [ell,0,0,1],
the last term occurring only if the level is prime to ell.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">phi</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;naive&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">101</span><span class="p">]])</span> <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.is_Tq_eigensymbol">
<code class="descname">is_Tq_eigensymbol</code><span class="sig-paren">(</span><em>q</em>, <em>p=None</em>, <em>M=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.is_Tq_eigensymbol" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if self is an eigenvector for <span class="math">\(T_q\)</span> modulo <span class="math">\(p^M\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">q</span></code> – prime of the Hecke operator</li>
<li><code class="docutils literal"><span class="pre">p</span></code> – prime we are working modulo</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – degree of accuracy of approximation</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>True/False</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi_ord</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">ap</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">ordinary</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_ord</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.is_ordinary">
<code class="descname">is_ordinary</code><span class="sig-paren">(</span><em>p=None</em>, <em>P=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.is_ordinary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return true if the <span class="math">\(p\)</span>-th eigenvalue is a <span class="math">\(p\)</span>-adic unit.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a positive integral prime, or None (default None)</li>
<li><code class="docutils literal"><span class="pre">P</span></code> - a prime of the base ring above <span class="math">\(p\)</span>, or None. This is ignored
unless the base ring is a number field.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>True/False</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-2</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">phip</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phip</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A number field example. Here there are multiple primes above <span class="math">\(p\)</span>, and
<span class="math">\(\phi\)</span> is ordinary at one but not the other.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Newforms</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">hecke_eigenvalue_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.space</span> <span class="kn">import</span> <span class="n">ps_modsym_from_simple_modsym_space</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ps_modsym_from_simple_modsym_space</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span> <span class="o">!=</span>  <span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">ideal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">16</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_ordinary</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">P must be an ideal</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.minus_part">
<code class="descname">minus_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.minus_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minus part of self – i.e. self - self | [1,0,0,-1]</p>
<p>Note that we haven’t divided by 2.  Is this a problem?</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>self – self | [1,0,0,-1]</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">plus_part</span><span class="p">()</span><span class="o">+</span><span class="n">phi</span><span class="o">.</span><span class="n">minus_part</span><span class="p">())</span> <span class="o">==</span> <span class="n">phi</span> <span class="o">*</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.plus_part">
<code class="descname">plus_part</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.plus_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the plus part of self – i.e. <code class="docutils literal"><span class="pre">self</span> <span class="pre">+</span> <span class="pre">self</span> <span class="pre">|</span> <span class="pre">[1,0,0,-1]</span></code>.</p>
<p>Note that we haven’t divided by 2.  Is this a problem?</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>self + self | [1,0,0,-1]</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">plus_part</span><span class="p">()</span><span class="o">+</span><span class="n">phi</span><span class="o">.</span><span class="n">minus_part</span><span class="p">())</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">phi</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the valuation of <code class="docutils literal"><span class="pre">self</span></code> at <span class="math">\(p\)</span>.</p>
<p>Here the valuation is the minimum of the valuations of the
values of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - prime</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The valuation of <code class="docutils literal"><span class="pre">self</span></code> at <span class="math">\(p\)</span></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">you must specify a prime</span>

<span class="gp">sage: </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi2</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">phi2</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">inconsistent prime</span>
<span class="gp">sage: </span><span class="n">phi2</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.values">
<code class="descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the values of the symbol self on our chosen generators
(generators are listed in <code class="docutils literal"><span class="pre">self.dict().keys()</span></code>)</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[-1/5, 1, 0]</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[-1 -1]  [1 0]  [ 0 -1]</span>
<span class="go">[ 3  2], [0 1], [ 1  3]</span>
<span class="go">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">==</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">dict</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement.weight">
<code class="descname">weight</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement.weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the weight of this Pollack-Stevens modular symbol.</p>
<p>This is <span class="math">\(k-2\)</span>, where <span class="math">\(k\)</span> is the usual notion of weight for modular
forms!</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">weight</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist">
<em class="property">class </em><code class="descclassname">sage.modular.pollack_stevens.modsym.</code><code class="descname">PSModularSymbolElement_dist</code><span class="sig-paren">(</span><em>map_data</em>, <em>parent</em>, <em>construct=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement" title="sage.modular.pollack_stevens.modsym.PSModularSymbolElement"><code class="xref py py-class docutils literal"><span class="pre">sage.modular.pollack_stevens.modsym.PSModularSymbolElement</span></code></a></p>
<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.padic_lseries">
<code class="descname">padic_lseries</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.padic_lseries" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-adic L-series of this modular symbol.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">padic_lseries</span><span class="p">();</span> <span class="n">L</span>  <span class="c1"># long time</span>
<span class="go">37-adic L-series of Modular symbol of level 37 with values in Space of 37-adic distributions with k=0 action and precision cap 7</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">series</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">O(37^6) + (4 + 37 + 36*37^2 + 19*37^3 + 21*37^4 + O(37^5))*T + O(T^2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.precision_relative">
<code class="descname">precision_relative</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.precision_relative" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of moments of each value of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">OverconvergentDistributions</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">PollackStevensModularSymbols</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">coefficients</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">precision_relative</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.reduce_precision">
<code class="descname">reduce_precision</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.reduce_precision" title="Permalink to this definition">¶</a></dt>
<dd><p>Only hold on to <span class="math">\(M\)</span> moments of each value of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">OverconvergentDistributions</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">PollackStevensModularSymbols</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">coefficients</span><span class="o">=</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">reduce_precision</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Modular symbol of level 5 with values in Space of 5-adic distributions with k=0 action and precision cap 10</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.specialize">
<code class="descname">specialize</code><span class="sig-paren">(</span><em>new_base_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_dist.specialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying classical symbol of weight <span class="math">\(k\)</span> - i.e.,
applies the canonical map <span class="math">\(D_k \to Sym^k\)</span> to all values of
self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">OverconvergentDistributions</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>  <span class="n">M</span> <span class="o">=</span> <span class="n">PollackStevensModularSymbols</span><span class="p">(</span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="n">coefficients</span><span class="o">=</span><span class="n">D</span><span class="p">);</span> <span class="n">M</span>
<span class="go">Space of overconvergent modular symbols for Congruence Subgroup Gamma0(5) with sign 0</span>
<span class="go">and values in Space of 5-adic distributions with k=0 action and precision cap 10</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">M</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span>
<span class="go">Modular symbol of level 5 with values in Sym^0 Z_5^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1 + O(5), 1 + O(5), 1 + O(5)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="go">[1 + O(5), 1 + O(5), 1 + O(5)]</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Space of modular symbols for Congruence Subgroup Gamma0(5) with sign 0 and values in Sym^0 Z_5^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">coefficient_module</span><span class="p">()</span>
<span class="go">Sym^0 Z_5^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">coefficient_module</span><span class="p">()</span><span class="o">.</span><span class="n">is_symk</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">specialize</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="go">Modular symbol of level 5 with values in Sym^0 Q_5^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk">
<em class="property">class </em><code class="descclassname">sage.modular.pollack_stevens.modsym.</code><code class="descname">PSModularSymbolElement_symk</code><span class="sig-paren">(</span><em>map_data</em>, <em>parent</em>, <em>construct=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement" title="sage.modular.pollack_stevens.modsym.PSModularSymbolElement"><code class="xref py py-class docutils literal"><span class="pre">sage.modular.pollack_stevens.modsym.PSModularSymbolElement</span></code></a></p>
<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.completions">
<code class="descname">completions</code><span class="sig-paren">(</span><em>p</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.completions" title="Permalink to this definition">¶</a></dt>
<dd><p>If <span class="math">\(K\)</span> is the base_ring of self, this function takes all maps
<span class="math">\(K\to \QQ_p\)</span> and applies them to self return a list of
(modular symbol,map: <span class="math">\(K\to \QQ_p\)</span>) as map varies over all such maps.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This only returns all completions when <span class="math">\(p\)</span> splits completely in <span class="math">\(K\)</span></p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – prime</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – precision</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list of tuples (modular symbol,map: <span class="math">\(K\to \QQ_p\)</span>) as map varies over all such maps</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.space</span> <span class="kn">import</span> <span class="n">ps_modsym_from_simple_modsym_space</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ModularSymbols</span><span class="p">(</span><span class="mi">67</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">cuspidal_submodule</span><span class="p">()</span><span class="o">.</span><span class="n">new_subspace</span><span class="p">()</span><span class="o">.</span><span class="n">decomposition</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ps_modsym_from_simple_modsym_space</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">completions</span><span class="p">(</span><span class="mi">41</span><span class="p">,</span><span class="mi">10</span><span class="p">);</span> <span class="n">S</span>
<span class="go">[(Modular symbol of level 67 with values in Sym^0 Q_41^2, Ring morphism:</span>
<span class="go">  From: Number Field in alpha with defining polynomial x^2 + 3*x + 1</span>
<span class="go">  To:   41-adic Field with capped relative precision 10</span>
<span class="go">  Defn: alpha |--&gt; 5 + 22*41 + 19*41^2 + 10*41^3 + 28*41^4 + 22*41^5 + 9*41^6 + 25*41^7 + 40*41^8 + 8*41^9 + O(41^10)), (Modular symbol of level 67 with values in Sym^0 Q_41^2, Ring morphism:</span>
<span class="go">  From: Number Field in alpha with defining polynomial x^2 + 3*x + 1</span>
<span class="go">  To:   41-adic Field with capped relative precision 10</span>
<span class="go">  Defn: alpha |--&gt; 33 + 18*41 + 21*41^2 + 30*41^3 + 12*41^4 + 18*41^5 + 31*41^6 + 15*41^7 + 32*41^9 + O(41^10))]</span>
<span class="gp">sage: </span><span class="n">TestSuite</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">skip</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;_test_category&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.lift">
<code class="descname">lift</code><span class="sig-paren">(</span><em>p=None</em>, <em>M=None</em>, <em>alpha=None</em>, <em>new_base_ring=None</em>, <em>algorithm=None</em>, <em>eigensymbol=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.lift" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a (<span class="math">\(p\)</span>-adic) overconvergent modular symbol with
<span class="math">\(M\)</span> moments which lifts self up to an Eisenstein error</p>
<p>Here the Eisenstein error is a symbol whose system of Hecke
eigenvalues equals <span class="math">\(\ell+1\)</span> for <span class="math">\(T_\ell\)</span> when <span class="math">\(\ell\)</span>
does not divide <span class="math">\(Np\)</span> and 1 for <span class="math">\(U_q\)</span> when <span class="math">\(q\)</span> divides <span class="math">\(Np\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – prime</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – integer equal to the number of moments</li>
<li><code class="docutils literal"><span class="pre">alpha</span></code> – <span class="math">\(U_p\)</span> eigenvalue</li>
<li><code class="docutils literal"><span class="pre">new_base_ring</span></code> – change of base ring</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> – ‘stevens’ or ‘greenberg’ (default ‘stevens’)</li>
<li><code class="docutils literal"><span class="pre">eigensymbol</span></code> – if True, lifts to Hecke eigensymbol (self must
be a <span class="math">\(p\)</span>-ordinary eigensymbol)</li>
</ul>
<p>(Note: <code class="docutils literal"><span class="pre">eigensymbol</span> <span class="pre">=</span> <span class="pre">True</span></code> does <em>not</em> just indicate to the code that
self is an eigensymbol; it solves a wholly different problem, lifting
an eigensymbol to an eigensymbol.)</p>
<p>OUTPUT:</p>
<p>An overconvergent modular symbol whose specialization equals self, up
to some Eisenstein error if <code class="docutils literal"><span class="pre">eigensymbol</span></code> is False. If <code class="docutils literal"><span class="pre">eigensymbol</span>
<span class="pre">=</span> <span class="pre">True</span></code> then the output will be an overconvergent Hecke eigensymbol
(and it will lift the input exactly, the Eisenstein error disappears).</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;stevens&#39;</span><span class="p">,</span><span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">10 + 10*11 + 10*11^2 + 10*11^3 + O(11^4)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">1 + O(11^4)</span>
</pre></div>
</div>
<p>We check that lifting and then specializing gives back the original symbol:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">specialize</span><span class="p">()</span> <span class="o">==</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Another example, which showed precision loss in an earlier version of the code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize_and_lift</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">prec</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;stevens&#39;</span><span class="p">,</span> <span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">Phi</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">3 + 2*5 + 4*5^2 + 2*5^3 + O(5^4)</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.padic_lseries</span> <span class="kn">import</span> <span class="n">pAdicLseries</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize_and_lift</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span><span class="n">M</span><span class="o">=</span><span class="n">prec</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;stevens&#39;</span><span class="p">,</span><span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1">#long time</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">pAdicLseries</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>          <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">symbol</span><span class="p">()</span> <span class="ow">is</span> <span class="n">Phi</span>              <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Examples using Greenberg’s algorithm:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;greenberg&#39;</span><span class="p">,</span><span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Phi2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;stevens&#39;</span><span class="p">,</span><span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Phi</span> <span class="o">==</span> <span class="n">Phi2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example in higher weight:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.space</span> <span class="kn">import</span> <span class="n">ps_modsym_from_simple_modsym_space</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">ps_modsym_from_simple_modsym_space</span><span class="p">(</span><span class="n">Newforms</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fs</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FsG</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;greenberg&#39;</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">FsG</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>                                            <span class="c1"># long time</span>
<span class="go">5^-1 * (2*5 + 5^2 + 3*5^3 + 4*5^4 + O(5^7), O(5^6), 2*5^2 + 3*5^3 + O(5^5), O(5^4), 5^2 + O(5^3), O(5^2))</span>
<span class="gp">sage: </span><span class="n">FsS</span> <span class="o">=</span> <span class="n">fs</span><span class="o">.</span><span class="n">lift</span><span class="p">(</span><span class="n">M</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">eigensymbol</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;stevens&#39;</span><span class="p">)</span>   <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">FsS</span> <span class="o">==</span> <span class="n">FsG</span>                                                 <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.p_stabilize">
<code class="descname">p_stabilize</code><span class="sig-paren">(</span><em>p=None</em>, <em>M=20</em>, <em>alpha=None</em>, <em>ap=None</em>, <em>new_base_ring=None</em>, <em>ordinary=True</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.p_stabilize" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math">\(p\)</span>-stabilization of self to level <span class="math">\(N p\)</span> on which <span class="math">\(U_p\)</span> acts by <span class="math">\(\alpha\)</span>.</p>
<p>Note that since <span class="math">\(\alpha\)</span> is <span class="math">\(p\)</span>-adic, the resulting symbol
is just an approximation to the true <span class="math">\(p\)</span>-stabilization
(depending on how well <span class="math">\(\alpha\)</span> is approximated).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – prime not dividing the level of self</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – (default: 20) precision of <span class="math">\(\QQ_p\)</span></li>
<li><code class="docutils literal"><span class="pre">alpha</span></code> – <span class="math">\(U_p\)</span> eigenvalue</li>
<li><code class="docutils literal"><span class="pre">ap</span></code> – Hecke eigenvalue</li>
<li><code class="docutils literal"><span class="pre">new_base_ring</span></code> – change of base ring</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ordinary</span></code> – (default: True) whether to return the ordinary</dt>
<dd>(at <code class="docutils literal"><span class="pre">p</span></code>) eigensymbol.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">check</span></code> – (default: True) whether to perform extra sanity checks</li>
</ul>
<p>OUTPUT:</p>
<p>A modular symbol with the same Hecke eigenvalues as
self away from <span class="math">\(p\)</span> and eigenvalue <span class="math">\(\alpha\)</span> at <span class="math">\(p\)</span>.
The eigenvalue <span class="math">\(\alpha\)</span> depends on the parameter <code class="docutils literal"><span class="pre">ordinary</span></code>.</p>
<p>If <code class="docutils literal"><span class="pre">ordinary</span></code> == True: the unique modular symbol of level
<span class="math">\(N p\)</span> with the same Hecke eigenvalues as self away from
<span class="math">\(p\)</span> and unit eigenvalue at <span class="math">\(p\)</span>; else  the unique modular
symbol of level <span class="math">\(N p\)</span> with the same Hecke eigenvalues as
self away from <span class="math">\(p\)</span> and non-unit eigenvalue at <span class="math">\(p\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phis</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phis</span>
<span class="go">Modular symbol of level 55 with values in Sym^0 Q_5^2</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="n">phis</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">phis</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">hecke</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">phis</span><span class="o">*</span><span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + 4*5 + 3*5^2 + 2*5^3 + O(5^4)</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1 + 4*5 + 3*5^2 + O(5^3)</span>

<span class="gp">sage: </span><span class="n">phis</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">M</span> <span class="o">=</span> <span class="n">prec</span><span class="p">,</span><span class="n">ordinary</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phis</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">5 + 5^2 + 2*5^3 + O(5^5)</span>
</pre></div>
</div>
<p>A complicated example (with nontrivial character):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">chi</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">24</span><span class="p">)([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">Newforms</span><span class="p">(</span><span class="n">chi</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.pollack_stevens.space</span> <span class="kn">import</span> <span class="n">ps_modsym_from_simple_modsym_space</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">ps_modsym_from_simple_modsym_space</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi11</span><span class="p">,</span> <span class="n">h11</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">completions</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi11s</span> <span class="o">=</span> <span class="n">phi11</span><span class="o">.</span><span class="n">p_stabilize</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi11s</span><span class="o">.</span><span class="n">is_Tq_eigensymbol</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.p_stabilize_and_lift">
<code class="descname">p_stabilize_and_lift</code><span class="sig-paren">(</span><em>p</em>, <em>M</em>, <em>alpha=None</em>, <em>ap=None</em>, <em>new_base_ring=None</em>, <em>ordinary=True</em>, <em>algorithm='greenberg'</em>, <em>eigensymbol=False</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.pollack_stevens.modsym.PSModularSymbolElement_symk.p_stabilize_and_lift" title="Permalink to this definition">¶</a></dt>
<dd><p><span class="math">\(p\)</span>-stabilize and lift self</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – prime, not dividing the level of self</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – precision</li>
<li><code class="docutils literal"><span class="pre">alpha</span></code> – (default: None) the <span class="math">\(U_p\)</span> eigenvalue, if known</li>
<li><code class="docutils literal"><span class="pre">ap</span></code> – (default: None) the Hecke eigenvalue at p (before stabilizing), if known</li>
<li><code class="docutils literal"><span class="pre">new_base_ring</span></code> – (default: None) if specified, force the resulting eigensymbol to take values in the given ring</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">ordinary</span></code> – (default: True) whether to return the ordinary</dt>
<dd>(at <code class="docutils literal"><span class="pre">p</span></code>) eigensymbol.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">algorithm</span></code> – (default: ‘greenberg’) a string, either ‘greenberg’
or ‘stevens’, specifying whether to use
the lifting algorithm of M.Greenberg or that of Pollack–Stevens.
The latter one solves the difference equation, which is not needed. The
option to use Pollack–Stevens’ algorithm here is just for historical reasons.</li>
<li><code class="docutils literal"><span class="pre">eigensymbol</span></code> – (default: False) if True, return an overconvergent eigensymbol. Otherwise just perform a naive lift</li>
<li><code class="docutils literal"><span class="pre">check</span></code> – (default: True) whether to perform extra sanity checks</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\(p\)</span>-stabilized and lifted version of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">pollack_stevens_modular_symbol</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">p_stabilize_and_lift</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                <span class="c1"># long time</span>
<span class="go">1 + O(3^10)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>                <span class="c1"># long time</span>
<span class="go">1 + 2*3 + 2*3^2 + 2*3^3 + 2*3^4 + 2*3^5 + 2*3^6 + 2*3^7 + 2*3^8 + 2*3^9 + O(3^10)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">Tq_eigenvalue</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>                <span class="c1"># long time</span>
<span class="go">2 + 3^2 + 2*3^3 + 2*3^4 + 2*3^6 + 3^8 + 2*3^9 + O(3^10)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="manin_map.html"
                                  title="previous chapter">Manin map</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="../btquotients/btquotient.html"
                                  title="next chapter">Quotients of the Bruhat-Tits tree</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/modular/pollack_stevens/modsym.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../btquotients/btquotient.html" title="Quotients of the Bruhat-Tits tree"
             >next</a> |</li>
        <li class="right" >
          <a href="manin_map.html" title="Manin map"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Symbols</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>