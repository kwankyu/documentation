
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Quotients of the Bruhat-Tits tree &#8212; Sage Reference Manual v8.2: Modular Symbols</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Spaces of \(p\)-adic automorphic forms" href="pautomorphicform.html" />
    <link rel="prev" title="Element class for Pollack-Stevens’ Modular Symbols" href="../pollack_stevens/modsym.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pautomorphicform.html" title="Spaces of \(p\)-adic automorphic forms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../pollack_stevens/modsym.html" title="Element class for Pollack-Stevens’ Modular Symbols"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Symbols</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="quotients-of-the-bruhat-tits-tree">
<span id="sage-modular-btquotients-btquotient"></span><h1>Quotients of the Bruhat-Tits tree<a class="headerlink" href="#quotients-of-the-bruhat-tits-tree" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.btquotients.btquotient"></span><p>This package contains all the functionality described and developed in <a class="reference internal" href="#fm" id="id1">[FM]</a>.
It allows for computations with fundamental domains of the Bruhat-Tits tree,
under the action of arithmetic groups arising from units in definite
quaternion algebras.</p>
<p>EXAMPLES:</p>
<p>Create the quotient attached to a maximal order of the quaternion algebra of
discriminant <span class="math">\(13\)</span>, at the prime <span class="math">\(p = 5\)</span>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
</pre></div>
</div>
<p>We can query for its genus, as well as get it back as a graph:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span>
<span class="go">Multi-graph on 2 vertices</span>
</pre></div>
</div>
<p>The rest of functionality can be found in the docstrings below.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="fm" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[FM]</a></td><td>Computing fundamental domains for the Bruhat-Tits tree for <span class="math">\(\textrm{GL}_2(\QQ_p)\)</span>,
<span class="math">\(p\)</span>-adic automorphic forms, and the canonical embedding of Shimura curves
Cameron Franc, Marc Masdeu
LMS Journal of Computation and Mathematics (2014), volume 17, issue 01, pp. 1-23.</td></tr>
</tbody>
</table>
<dl class="class">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient">
<em class="property">class </em><code class="descclassname">sage.modular.btquotients.btquotient.</code><code class="descname">BruhatTitsQuotient</code><span class="sig-paren">(</span><em>p</em>, <em>Nminus</em>, <em>Nplus=1</em>, <em>character=None</em>, <em>use_magma=False</em>, <em>seed=None</em>, <em>magma_session=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a></p>
<p>This function computes the quotient of the Bruhat-Tits tree
by an arithmetic quaternionic group. The group in question is the
group of norm 1 elements in an Eichler <span class="math">\(\ZZ[1/p]\)</span>-order of some (tame)
level inside of a definite quaternion algebra that is unramified
at the prime <span class="math">\(p\)</span>. Note that this routine relies in Magma in the case
<span class="math">\(p = 2\)</span> or when <span class="math">\(N^{+} &gt; 1\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime number</li>
<li><code class="docutils literal"><span class="pre">Nminus</span></code> - squarefree integer divisible by an odd number of
distinct primes and relatively prime to p. This is the
discriminant of the definite quaternion algebra that one is
quotienting by.</li>
<li><code class="docutils literal"><span class="pre">Nplus</span></code> - an integer coprime to pNminus (Default: 1). This is
the tame level. It need not be squarefree! If Nplus is not 1
then the user currently needs magma installed due to sage’s
inability to compute well with nonmaximal Eichler orders in
rational (definite) quaternion algebras.</li>
<li><code class="docutils literal"><span class="pre">character</span></code> - a Dirichlet character (Default: None) of modulus
<span class="math">\(pN^-N^+\)</span>.</li>
<li><code class="docutils literal"><span class="pre">use_magma</span></code> - boolean (default: False). If True, uses Magma
for quaternion arithmetic.</li>
<li><code class="docutils literal"><span class="pre">magma_session</span></code> – (default: None). If specified, the Magma session
to use.</li>
</ul>
<p>EXAMPLES:</p>
<p>Here is an example without a Dirichlet character:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">19</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_graph</span><span class="p">();</span> <span class="n">G</span>
<span class="go">Multi-graph on 4 vertices</span>
</pre></div>
</div>
<p>And an example with a Dirichlet character:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span><span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A sage implementation of Eichler orders in rational quaternions
algebras would remove the dependency on magma.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Marc Masdeu (2012-02-20)</li>
</ul>
<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.B_one">
<code class="descname">B_one</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.B_one" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of <span class="math">\(1\)</span> in the basis for the
quaternion order.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="p">,</span><span class="nb">pow</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">B_one</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_conv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nminus">
<code class="descname">Nminus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nminus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the discriminant of the relevant definite
quaternion algebra.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math">\(N^-\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Nminus</span><span class="p">()</span>
<span class="go">7</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nplus">
<code class="descname">Nplus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.Nplus" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tame level <span class="math">\(N^+\)</span>.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math">\(N^+\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Nplus</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.dimension_harmonic_cocycles">
<code class="descname">dimension_harmonic_cocycles</code><span class="sig-paren">(</span><em>k</em>, <em>lev=None</em>, <em>Nplus=None</em>, <em>character=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.dimension_harmonic_cocycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the dimension of the space of harmonic cocycles
of weight <span class="math">\(k\)</span> on <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>OUTPUT:</p>
<p>An integer equal to the dimension</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[1, 4, 4, 8, 8, 12, 12, 16, 16]</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># optional - magma</span>
<span class="go">[0, 1, 3, 1, 3, 5, 3, 5, 7, 5, 7, 9, 7, 9, 11, 9, 11, 13, 11]</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">11</span> <span class="o">*</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">481</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">dimension_harmonic_cocycles</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1440</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.e3">
<code class="descname">e3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e3" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math">\(e_3\)</span> invariant defined by the formula</p>
<div class="math">
\[e_k =\prod_{\ell\mid pN^-}\left(1-\left(\frac{-3}{\ell}\right)\right)\prod_{\ell \| N^+}\left(1+\left(\frac{-3}{\ell}\right)\right)\prod_{\ell^2\mid N^+} \nu_\ell(3)\]</div>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">e3</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.e4">
<code class="descname">e4</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.e4" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math">\(e_4\)</span> invariant defined by the formula</p>
<div class="math">
\[e_k =\prod_{\ell\mid pN^-}\left(1-\left(\frac{-k}{\ell}\right)\right)\prod_{\ell \| N^+}\left(1+\left(\frac{-k}{\ell}\right)\right)\prod_{\ell^2\mid N^+} \nu_\ell(k)\]</div>
<p>OUTPUT:</p>
<p>an integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">e4</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed">
<code class="descname">embed</code><span class="sig-paren">(</span><em>g</em>, <em>exact=False</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed" title="Permalink to this definition">¶</a></dt>
<dd><p>Embed the quaternion element <code class="docutils literal"><span class="pre">g</span></code> into a matrix algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">g</span></code> a row vector of size <span class="math">\(4\)</span> whose entries represent a
quaternion in our basis.</li>
<li><code class="docutils literal"><span class="pre">exact</span></code> boolean (default: False) - If True, tries to embed
<code class="docutils literal"><span class="pre">g</span></code> into a matrix algebra over a number field. If False,
the target is the matrix algebra over <span class="math">\(\QQ_p\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 matrix with coefficients in <span class="math">\(\QQ_p\)</span> if <code class="docutils literal"><span class="pre">exact</span></code> is
False, or a number field if <code class="docutils literal"><span class="pre">exact</span></code> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># random</span>
<span class="go">[-1]</span>
<span class="go">[ 0]</span>
<span class="go">[ 1]</span>
<span class="go">[ 1]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">u</span> <span class="c1"># random</span>
<span class="go">[    O(7) 3 + O(7)]</span>
<span class="go">[2 + O(7) 6 + O(7)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_increase_precision</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span> <span class="c1"># random</span>
<span class="go">[                7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)             3 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)]</span>
<span class="go">[            2 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6) 6 + 5*7 + 3*7^2 + 5*7^3 + 2*7^4 + 6*7^5 + O(7^6)]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed_quaternion">
<code class="descname">embed_quaternion</code><span class="sig-paren">(</span><em>g</em>, <em>exact=False</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.embed_quaternion" title="Permalink to this definition">¶</a></dt>
<dd><p>Embed the quaternion element <code class="docutils literal"><span class="pre">g</span></code> into a matrix algebra.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">g</span></code> a row vector of size <span class="math">\(4\)</span> whose entries represent a
quaternion in our basis.</li>
<li><code class="docutils literal"><span class="pre">exact</span></code> boolean (default: False) - If True, tries to embed
<code class="docutils literal"><span class="pre">g</span></code> into a matrix algebra over a number field. If False,
the target is the matrix algebra over <span class="math">\(\QQ_p\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 matrix with coefficients in <span class="math">\(\QQ_p\)</span> if <code class="docutils literal"><span class="pre">exact</span></code> is
False, or a number field if <code class="docutils literal"><span class="pre">exact</span></code> is True.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="c1"># random</span>
<span class="go">[-1]</span>
<span class="go">[ 0]</span>
<span class="go">[ 1]</span>
<span class="go">[ 1]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">u</span> <span class="c1"># random</span>
<span class="go">[    O(7) 3 + O(7)]</span>
<span class="go">[2 + O(7) 6 + O(7)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_increase_precision</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span> <span class="n">v</span> <span class="c1"># random</span>
<span class="go">[                7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)             3 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6)]</span>
<span class="go">[            2 + 7 + 3*7^2 + 7^3 + 4*7^4 + O(7^6) 6 + 5*7 + 3*7^2 + 5*7^3 + 2*7^4 + 6*7^5 + O(7^6)]</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.fundom_rep">
<code class="descname">fundom_rep</code><span class="sig-paren">(</span><em>v1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.fundom_rep" title="Permalink to this definition">¶</a></dt>
<dd><p>Find an equivalent vertex in the fundamental domain.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v1</span></code> - a 2x2 matrix representing a normalized vertex.</li>
</ul>
<p>OUTPUT:</p>
<p>A <code class="docutils literal"><span class="pre">Vertex</span></code> equivalent to <code class="docutils literal"><span class="pre">v1</span></code>, in the fundamental domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">set_immutable</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">fundom_rep</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Vertex of Bruhat-Tits tree for p = 3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus">
<code class="descname">genus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the genus of the quotient graph using a formula
This should agree with self.genus_no_formula().</p>
<p>Compute the genus of the Shimura curve
corresponding to this quotient via Cerednik-Drinfeld. It is
computed via a formula and not in terms of the quotient graph.</p>
<p>INPUT:</p>
<ul class="simple">
<li>level: Integer (default: None) a level. By default, use that
of <code class="docutils literal"><span class="pre">self</span></code>.</li>
<li>Nplus: Integer (default: None) a conductor. By default, use
that of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>An integer equal to the genus</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">21</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus_no_formula">
<code class="descname">genus_no_formula</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.genus_no_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the genus of the quotient from the data of the
quotient graph. This should agree with self.genus().</p>
<p>OUTPUT:</p>
<p>An integer</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span>
<span class="go">17</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">genus_no_formula</span><span class="p">()</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">genus</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_list">
<code class="descname">get_edge_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="docutils literal"><span class="pre">Edge</span></code> which represent a fundamental
domain inside the Bruhat-Tits tree for the quotient.</p>
<p>OUTPUT:</p>
<p>A list of <code class="docutils literal"><span class="pre">Edge</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_stabilizers">
<code class="descname">get_edge_stabilizers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_edge_stabilizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the stabilizers in the arithmetic group of all
edges in the Bruhat-Tits tree within a fundamental domain for
the quotient graph. The stabilizers of an edge and its
opposite are equal, and so we only store half the data.</p>
<p>OUTPUT:</p>
<p>A list of lists encoding edge stabilizers. It contains one
entry for each edge. Each entry is a list of data
corresponding to the group elements in the stabilizer of the
edge. The data consists of: (0) a column matrix representing
a quaternion, (1) the power of <span class="math">\(p\)</span> that one needs to divide
by in order to obtain a quaternion of norm 1, and hence an
element of the arithmetic group <span class="math">\(\Gamma\)</span>, (2) a boolean that
is only used to compute spaces of modular forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">=</span><span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_edge_stabilizers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span><span class="o">/</span><span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order">
<code class="descname">get_eichler_order</code><span class="sig-paren">(</span><em>magma=False</em>, <em>force_computation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying Eichler order of level <span class="math">\(N^+\)</span>.</p>
<p>OUTPUT:</p>
<p>An Eichler order.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_basis">
<code class="descname">get_eichler_order_basis</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a basis for the global Eichler order.</p>
<p>OUTPUT:</p>
<p>Basis for the underlying Eichler order of level Nplus.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_basis</span><span class="p">()</span>
<span class="go">[1/2 + 1/2*j, 1/2*i + 1/2*k, j, k]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadform">
<code class="descname">get_eichler_order_quadform</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadform" title="Permalink to this definition">¶</a></dt>
<dd><p>This function return the norm form for the underlying
Eichler order of level <code class="docutils literal"><span class="pre">Nplus</span></code>. Required for finding elements in
the arithmetic subgroup Gamma.</p>
<p>OUTPUT:</p>
<p>The norm form of the underlying Eichler order</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_quadform</span><span class="p">()</span>
<span class="go">Quadratic form in 4 variables over Integer Ring with coefficients:</span>
<span class="go">[ 3 0 11 0 ]</span>
<span class="go">[ * 3 0 11 ]</span>
<span class="go">[ * * 11 0 ]</span>
<span class="go">[ * * * 11 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadmatrix">
<code class="descname">get_eichler_order_quadmatrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_eichler_order_quadmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the matrix of the quadratic form of
the underlying Eichler order in the fixed basis.</p>
<p>OUTPUT:</p>
<p>A 4x4 integral matrix describing the norm form.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_eichler_order_quadmatrix</span><span class="p">()</span>
<span class="go">[ 6  0 11  0]</span>
<span class="go">[ 0  6  0 11]</span>
<span class="go">[11  0 22  0]</span>
<span class="go">[ 0 11  0 22]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding">
<code class="descname">get_embedding</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a function which embeds quaternions into a matrix
algebra.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_embedding</span><span class="p">(</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">[2 + 3*5 + 2*5^2 + 4*5^3 + O(5^4)       3 + 2*5^2 + 4*5^3 + O(5^4)]</span>
<span class="go">[        5 + 5^2 + 3*5^3 + O(5^4)           4 + 5 + 2*5^2 + O(5^4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding_matrix">
<code class="descname">get_embedding_matrix</code><span class="sig-paren">(</span><em>prec=None</em>, <em>exact=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_embedding_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix of the embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">exact</span></code> boolean (Default: <code class="docutils literal"><span class="pre">False</span></code>). If <code class="docutils literal"><span class="pre">True</span></code>, return an
embedding into a matrix algebra with coefficients in a
number field. Otherwise, embed into matrices over <span class="math">\(p\)</span>-adic
numbers.</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> Integer (Default: <code class="docutils literal"><span class="pre">None</span></code>). If specified, return the
matrix with precision <code class="docutils literal"><span class="pre">prec</span></code>. Otherwise, return the
cached matrix (with the current working precision).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A 4x4 matrix representing the embedding.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[                      1 + O(7^4)         5 + 2*7 + 3*7^3 + O(7^4) 4 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)       6 + 3*7^2 + 4*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)                           O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)         2 + 5*7 + 6*7^3 + O(7^4) 3 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)         3 + 3*7 + 3*7^2 + O(7^4)]</span>
<span class="go">[                      1 + O(7^4) 3 + 4*7 + 6*7^2 + 3*7^3 + O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[                      1 + O(7^4)         5 + 2*7 + 3*7^3 + O(7^4) 4 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)       6 + 3*7^2 + 4*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)                           O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="go">[                          O(7^4)         2 + 5*7 + 6*7^3 + O(7^4) 3 + 5*7 + 6*7^2 + 6*7^3 + O(7^4)         3 + 3*7 + 3*7^2 + O(7^4)]</span>
<span class="go">[                      1 + O(7^4) 3 + 4*7 + 6*7^2 + 3*7^3 + O(7^4)                   3 + 7 + O(7^4) 1 + 6*7 + 3*7^2 + 2*7^3 + O(7^4)]</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_embedding_matrix</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[                              1 + O(7^5)         5 + 2*7 + 3*7^3 + 6*7^4 + O(7^5) 4 + 5*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)       6 + 3*7^2 + 4*7^3 + 5*7^4 + O(7^5)]</span>
<span class="go">[                                  O(7^5)                                   O(7^5)                           3 + 7 + O(7^5)   1 + 6*7 + 3*7^2 + 2*7^3 + 7^4 + O(7^5)]</span>
<span class="go">[                                  O(7^5)         2 + 5*7 + 6*7^3 + 5*7^4 + O(7^5) 3 + 5*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)         3 + 3*7 + 3*7^2 + 5*7^4 + O(7^5)]</span>
<span class="go">[                              1 + O(7^5)         3 + 4*7 + 6*7^2 + 3*7^3 + O(7^5)                           3 + 7 + O(7^5)   1 + 6*7 + 3*7^2 + 2*7^3 + 7^4 + O(7^5)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_extra_embedding_matrices">
<code class="descname">get_extra_embedding_matrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_extra_embedding_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of  matrices representing the different embeddings.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The precision is very low (currently set to 5 digits),
since these embeddings are only used to apply a character.</p>
</div>
<p>EXAMPLES:</p>
<p>This portion of the code is only relevant when working with a
nontrivial Dirichlet character. If there is no such character
then the code returns an empty list. Even if the character is
not trivial it might return an empty list:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="p">,</span><span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_extra_embedding_matrices</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">DirichletGroup</span><span class="p">(</span><span class="mi">6</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">character</span> <span class="o">=</span> <span class="n">f</span><span class="p">,</span> <span class="n">use_magma</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_extra_embedding_matrices</span><span class="p">()</span> <span class="c1"># optional - magma</span>
<span class="go">[</span>
<span class="go">[1 0 2 0]</span>
<span class="go">[0 0 2 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[1 0 2 2]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_fundom_graph">
<code class="descname">get_fundom_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_fundom_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the fundamental domain (and computes it if needed).</p>
<p>OUTPUT:</p>
<p>A fundamental domain for the action of <span class="math">\(\Gamma\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_fundom_graph</span><span class="p">()</span>
<span class="go">Graph on 24 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_generators">
<code class="descname">get_generators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a fundamental domain in the Bruhat-Tits tree, and
certain gluing data for boundary vertices, in order to compute
a collection of generators for the arithmetic quaternionic
group that one is quotienting by. This is analogous to using a
polygonal rep. of a compact real surface to present its
fundamental domain.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A generating list of elements of an arithmetic
quaternionic group.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_generators</span><span class="p">())</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_graph">
<code class="descname">get_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the quotient graph (and compute it if needed).</p>
<p>OUTPUT:</p>
<p>A graph representing the quotient of the Bruhat-Tits tree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_graph</span><span class="p">()</span>
<span class="go">Multi-graph on 2 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_list">
<code class="descname">get_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of <code class="docutils literal"><span class="pre">Edge</span></code> which represent a fundamental
domain inside the Bruhat-Tits tree for the quotient,
together with a list of the opposite edges. This is used
to work with automorphic forms.</p>
<p>OUTPUT:</p>
<p>A list of <code class="docutils literal"><span class="pre">Edge</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_list</span><span class="p">())</span>
<span class="go">16</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_maximal_order">
<code class="descname">get_maximal_order</code><span class="sig-paren">(</span><em>magma=False</em>, <em>force_computation=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_maximal_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying maximal order containing the
Eichler order.</p>
<p>OUTPUT:</p>
<p>A maximal order.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_maximal_order</span><span class="p">()</span>
<span class="go">Order of Quaternion Algebra (-1, -7) with base ring Rational Field with basis (1/2 + 1/2*j, 1/2*i + 1/2*k, j, k)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_nontorsion_generators">
<code class="descname">get_nontorsion_generators</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_nontorsion_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Use a fundamental domain in the Bruhat-Tits tree, and
certain gluing data for boundary vertices, in order to compute
a collection of generators for the nontorsion part
of the arithmetic quaternionic group that one is quotienting by.
This is analogous to using a polygonal rep. of a compact real
surface to present its fundamental domain.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A generating list of elements of an arithmetic
quaternionic group.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">get_nontorsion_generators</span><span class="p">())</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_ordered_edges">
<code class="descname">get_num_ordered_edges</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_ordered_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of ordered edges <span class="math">\(E\)</span> in the quotient using
the formula relating the genus <span class="math">\(g\)</span> with the number of vertices <span class="math">\(V\)</span>
and that of unordered edges <span class="math">\(E/2\)</span>: <span class="math">\(E = 2(g + V - 1)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>An integer</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_verts">
<code class="descname">get_num_verts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_num_verts" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the number of vertices in the quotient using the formula
<span class="math">\(V = 2(\mu/12 + e_3/3 + e_4/4)\)</span>.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>An integer (the number of vertices)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_num_verts</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_quaternion_algebra">
<code class="descname">get_quaternion_algebra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_quaternion_algebra" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying quaternion algebra.</p>
<p>OUTPUT:</p>
<p>The underlying definite quaternion algebra</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_quaternion_algebra</span><span class="p">()</span>
<span class="go">Quaternion Algebra (-1, -7) with base ring Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_splitting_field">
<code class="descname">get_splitting_field</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_splitting_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a quadratic field that splits the quaternion
algebra attached to <code class="docutils literal"><span class="pre">self</span></code>. Currently requires Magma.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_splitting_field</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NotImplementedError</span>: <span class="n">Sage does not know yet how to work with the kind of orders that you are trying to use. Try installing Magma first and set it up so that Sage can use it.</span>
</pre></div>
</div>
<p>If we do have Magma installed, then it works:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="n">use_magma</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># optional - magma</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_splitting_field</span><span class="p">()</span> <span class="c1"># optional - magma</span>
<span class="go">Number Field in a with defining polynomial X1^2 + 11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_stabilizers">
<code class="descname">get_stabilizers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_stabilizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the stabilizers in the arithmetic group of all
edges in the Bruhat-Tits tree within a fundamental domain for
the quotient graph. This is similar to get_edge_stabilizers, except
that here we also store the stabilizers of the opposites.</p>
<p>OUTPUT:</p>
<p>A list of lists encoding edge stabilizers. It contains one
entry for each edge. Each entry is a list of data
corresponding to the group elements in the stabilizer of the
edge. The data consists of: (0) a column matrix representing
a quaternion, (1) the power of <span class="math">\(p\)</span> that one needs to divide
by in order to obtain a quaternion of norm 1, and hence an
element of the arithmetic group <span class="math">\(\Gamma\)</span>, (2) a boolean that
is only used to compute spaces of modular forms.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span><span class="o">=</span><span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_stabilizers</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">X</span><span class="o">.</span><span class="n">get_num_ordered_edges</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_BT</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_units_of_order">
<code class="descname">get_units_of_order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_units_of_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the units of the underlying Eichler
<span class="math">\(\ZZ\)</span>-order. This is a finite group since the order lives in a
definite quaternion algebra over <span class="math">\(\QQ\)</span>.</p>
<p>OUTPUT:</p>
<p>A list of elements of the global Eichler <span class="math">\(\ZZ\)</span>-order of
level <span class="math">\(N^+\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_units_of_order</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[ 0]  [-2]</span>
<span class="go">[-2]  [ 0]</span>
<span class="go">[ 0]  [ 1]</span>
<span class="go">[ 1], [ 0]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_dict">
<code class="descname">get_vertex_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the vertices of the quotient viewed as
a dict.</p>
<p>OUTPUT:</p>
<p>A python dict with the vertices of the quotient.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_vertex_dict</span><span class="p">()</span>
<span class="go">{[1 0]</span>
<span class="go">[0 1]: Vertex of Bruhat-Tits tree for p = 37, [ 1  0]</span>
<span class="go">[ 0 37]: Vertex of Bruhat-Tits tree for p = 37}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_list">
<code class="descname">get_vertex_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of the vertices of the quotient.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list with the vertices of the quotient.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">get_vertex_list</span><span class="p">()</span>
<span class="go">[Vertex of Bruhat-Tits tree for p = 37, Vertex of Bruhat-Tits tree for p = 37]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_stabs">
<code class="descname">get_vertex_stabs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.get_vertex_stabs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the stabilizers in the arithmetic
group of all vertices in the Bruhat-Tits tree within a
fundamental domain for the quotient graph.</p>
<p>OUTPUT:</p>
<p>A list of vertex stabilizers. Each vertex stabilizer is a
finite cyclic subgroup, so we return generators for these
subgroups.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_vertex_stabs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">embed_quaternion</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">prec</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">get_vertex_list</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">_BT</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">gamma</span><span class="o">*</span><span class="n">v</span><span class="p">)</span> <span class="o">==</span> <span class="n">v</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycle_from_elliptic_curve">
<code class="descname">harmonic_cocycle_from_elliptic_curve</code><span class="sig-paren">(</span><em>E</em>, <em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycle_from_elliptic_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a harmonic cocycle with the same Hecke eigenvalues as <code class="docutils literal"><span class="pre">E</span></code>.</p>
<p>Given an elliptic curve <span class="math">\(E\)</span> having a conductor <span class="math">\(N\)</span> of the form <span class="math">\(pN^-N^+\)</span>,
return the harmonic cocycle over <code class="docutils literal"><span class="pre">self</span></code> which is attached to <code class="docutils literal"><span class="pre">E</span></code> via
modularity. The result is only well-defined up to scaling.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">E</span></code> – an elliptic curve over the rational numbers</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> – (default: None) If specified, the harmonic cocycle will take values
in <span class="math">\(\QQ_p\)</span> with precision <code class="docutils literal"><span class="pre">prec</span></code>. Otherwise it will take values in <span class="math">\(\ZZ\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>A harmonic cocycle attached via modularity to the given elliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;21a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycle_from_elliptic_curve</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T29</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T29</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;51a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycle_from_elliptic_curve</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T31</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">hecke_operator</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T31</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="o">*</span> <span class="n">f</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycles">
<code class="descname">harmonic_cocycles</code><span class="sig-paren">(</span><em>k</em>, <em>prec=None</em>, <em>basis_matrix=None</em>, <em>base_field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.harmonic_cocycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the space of harmonic cocycles of a given even weight <code class="docutils literal"><span class="pre">k</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">k</span></code> - integer - The weight. It must be even.</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> - integer (default: None). If specified, the
precision for the coefficient module</li>
<li><code class="docutils literal"><span class="pre">basis_matrix</span></code> - a matrix (default: None).</li>
<li><code class="docutils literal"><span class="pre">base_field</span></code> - a ring (default: None)</li>
</ul>
<p>OUTPUT: A space of harmonic cocycles</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">31</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">harmonic_cocycles</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">Space of harmonic cocycles of weight 2 on Quotient of the Bruhat Tits tree of GL_2(QQ_31) with discriminant 7 and level 1</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">basis</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Harmonic cocycle with values in Sym^0 Q_31^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.is_admissible">
<code class="descname">is_admissible</code><span class="sig-paren">(</span><em>D</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.is_admissible" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the imaginary quadratic field of
discriminant <span class="math">\(D\)</span> embeds in the quaternion algebra. It
furthermore tests the Heegner hypothesis in this setting
(e.g., is <span class="math">\(p\)</span> inert in the field, etc).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">D</span></code> - an integer whose squarefree part will define the
quadratic field</li>
</ul>
<p>OUTPUT:</p>
<p>A boolean describing whether the quadratic field is admissible</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">X</span><span class="o">.</span><span class="n">is_admissible</span><span class="p">(</span><span class="n">D</span><span class="p">)</span> <span class="k">for</span> <span class="n">D</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[False, True, False, False, False, False, False, True, False, False, False, False, False, False, False, False, False, True, False]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.level">
<code class="descname">level</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math">\(p N^-\)</span>, which is the discriminant of the
indefinite quaternion algebra that is uniformed by
Cerednik-Drinfeld.</p>
<p>OUTPUT:</p>
<p>An integer equal to <span class="math">\(p N^-\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">level</span><span class="p">()</span>
<span class="go">35</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.mu">
<code class="descname">mu</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mu invariant of self.</p>
<p>OUTPUT:</p>
<p>An integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">29</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">mu</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.padic_automorphic_forms">
<code class="descname">padic_automorphic_forms</code><span class="sig-paren">(</span><em>U</em>, <em>prec=None</em>, <em>t=None</em>, <em>R=None</em>, <em>overconvergent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.padic_automorphic_forms" title="Permalink to this definition">¶</a></dt>
<dd><p>The module of (quaternionic) <span class="math">\(p\)</span>-adic automorphic forms over <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">U</span></code> – A distributions module or an integer. If <code class="docutils literal"><span class="pre">U</span></code> is a
distributions module then this creates the relevant space of
automorphic forms. If <code class="docutils literal"><span class="pre">U</span></code> is an integer then the coefficients
are the (<span class="math">\(U-2\)</span>)nd power of the symmetric representation of
<span class="math">\(GL_2(\QQ_p)\)</span>.</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> – A precision (default : None). If not None should
be a positive integer.</li>
<li><code class="docutils literal"><span class="pre">t</span></code> – (default : None). The number of additional moments to store. If None, determine
it automatically from <code class="docutils literal"><span class="pre">prec</span></code>, <code class="docutils literal"><span class="pre">U</span></code> and the <code class="docutils literal"><span class="pre">overconvergent</span></code> flag.</li>
<li><code class="docutils literal"><span class="pre">R</span></code> – (default : None). If specified, coefficient field of the automorphic forms.
If not specified it defaults to the base ring of the distributions <code class="docutils literal"><span class="pre">U</span></code>, or to <span class="math">\(\QQ_p\)</span>
with the working precision <code class="docutils literal"><span class="pre">prec</span></code>.</li>
<li><code class="docutils literal"><span class="pre">overconvergent</span></code> – Boolean (default = False). If True, will construct overconvergent
<span class="math">\(p\)</span>-adic automorphic forms. Otherwise it constructs the finite dimensional space of
<span class="math">\(p\)</span>-adic automorphic forms which is isomorphic to the space of harmonic cocycles.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">padic_automorphic_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">Space of automorphic forms on Quotient of the Bruhat Tits tree of GL_2(QQ_11) with discriminant 5 and level 1 with values in Sym^0 Q_11^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the quotient graph.</p>
<p>OUTPUT:</p>
<p>A plot of the quotient graph</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="go">Graphics object consisting of 17 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot_fundom">
<code class="descname">plot_fundom</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.plot_fundom" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a fundamental domain.</p>
<p>OUTPUT:</p>
<p>A plot of the fundamental domain.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">23</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">plot_fundom</span><span class="p">()</span>
<span class="go">Graphics object consisting of 88 graphics primitives</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsQuotient.prime">
<code class="descname">prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsQuotient.prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the prime one is working with.</p>
<p>OUTPUT:</p>
<p>An integer equal to the fixed prime <span class="math">\(p\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">prime</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree">
<em class="property">class </em><code class="descclassname">sage.modular.btquotients.btquotient.</code><code class="descname">BruhatTitsTree</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a></p>
<p>An implementation of the Bruhat-Tits tree for <span class="math">\(GL_2(\QQ_p)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime number. The corresponding tree is then <span class="math">\(p+1\)</span> regular</li>
</ul>
<p>EXAMPLES:</p>
<p>We create the tree for <span class="math">\(GL_2(\QQ_5)\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">m</span><span class="p">);</span> <span class="n">e</span>
<span class="go">[  0  25]</span>
<span class="go">[625  21]</span>
<span class="gp">sage: </span><span class="n">v0</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="n">v0</span>
<span class="go">[ 25   0]</span>
<span class="go">[ 21 125]</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">e</span><span class="p">);</span> <span class="n">v1</span>
<span class="go">[ 25   0]</span>
<span class="go">[ 21 625]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">v1</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">v0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A value error is raised if a prime is not passed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Input (4) must be prime</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Marc Masdeu (2012-02-20)</li>
</ul>
<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.edge">
<code class="descname">edge</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a matrix to the correct normalized edge
representative.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - a 2x2 integer matrix</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">newM</span></code> - a 2x2 integer matrix</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[3 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.edge_between_vertices">
<code class="descname">edge_between_vertices</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>normalized=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edge_between_vertices" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the normalized matrix rep. for the edge
passing between two vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v1</span></code> - 2x2 integer matrix</li>
<li><code class="docutils literal"><span class="pre">v2</span></code> - 2x2 integer matrix</li>
<li><code class="docutils literal"><span class="pre">normalized</span></code> - boolean (default: False), whether the
vertices are normalized.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>2x2 integer matrix, representing the edge from <code class="docutils literal"><span class="pre">v1</span></code> to
<code class="docutils literal"><span class="pre">v2</span></code>.  If <code class="docutils literal"><span class="pre">v1</span></code> and <code class="docutils literal"><span class="pre">v2</span></code> are not at distance <span class="math">\(1\)</span>, raise
a <code class="docutils literal"><span class="pre">ValueError</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v1</span>
<span class="go">[7 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v2</span>
<span class="go">[1 0]</span>
<span class="go">[1 7]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge_between_vertices</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Vertices are not adjacent.</span>

<span class="gp">sage: </span><span class="n">v3</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]));</span> <span class="n">v3</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edge_between_vertices</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v3</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[1 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.edges_leaving_origin">
<code class="descname">edges_leaving_origin</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.edges_leaving_origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Find normalized representatives for the <span class="math">\(p+1\)</span> edges
leaving the origin vertex corresponding to the homothety class
of <span class="math">\(\ZZ_p^2\)</span>. These are cached.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>A list of size <span class="math">\(p+1\)</span> of 2x2 integer matrices</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">edges_leaving_origin</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">[0 1]  [3 0]  [0 1]  [0 1]</span>
<span class="go">[3 0], [0 1], [3 1], [3 2]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.entering_edges">
<code class="descname">entering_edges</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.entering_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the edges entering a given vertex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> - 2x2 integer matrix</li>
</ul>
<p>OUTPUT:</p>
<p>A list of size <span class="math">\(p+1\)</span> of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">entering_edges</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[</span>
<span class="go">[1 0]  [0 1]  [1 0]  [1 0]  [1 0]  [1 0]  [1 0]  [1 0]</span>
<span class="go">[0 1], [1 0], [1 1], [4 1], [5 1], [2 1], [3 1], [6 1]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_containing_affinoid">
<code class="descname">find_containing_affinoid</code><span class="sig-paren">(</span><em>z</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_containing_affinoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the vertex corresponding to the affinoid in the
<span class="math">\(p\)</span>-adic upper half plane that a given (unramified!) point
reduces to.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">z</span></code> - an element of an unramified extension of <span class="math">\(\QQ_p\)</span>
that is not contained in <span class="math">\(\QQ_p\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<p>A 2x2 integer matrix representing a vertex of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_containing_affinoid</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">a</span><span class="o">+</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">find_containing_affinoid</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">inverse</span><span class="p">();</span> <span class="n">v</span>
<span class="go">[   1    0]</span>
<span class="go">[-2/5  1/5]</span>
</pre></div>
</div>
<p>Note that the translate of <code class="docutils literal"><span class="pre">z</span></code> belongs to the standard
affinoid. That is, it is a <span class="math">\(p\)</span>-adic unit and its reduction
modulo <span class="math">\(p\)</span> is not in <span class="math">\(\mathbb{F}_p\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">gz</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">z</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">gz</span>
<span class="go">(a + 1) + O(5^19)</span>
<span class="gp">sage: </span><span class="n">gz</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_covering">
<code class="descname">find_covering</code><span class="sig-paren">(</span><em>z1</em>, <em>z2</em>, <em>level=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_covering" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a covering of <span class="math">\(P^1(\QQ_p)\)</span> adapted to a certain
geodesic in self.</p>
<p>More precisely, the <span class="math">\(p\)</span>-adic upper half plane points <code class="docutils literal"><span class="pre">z1</span></code>
and <code class="docutils literal"><span class="pre">z2</span></code> reduce to vertices <span class="math">\(v_1\)</span>, <span class="math">\(v_2\)</span>.
The returned covering consists of all the edges leaving the
geodesic from <span class="math">\(v_1\)</span> to <span class="math">\(v_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">z1</span></code>, <code class="docutils literal"><span class="pre">z2</span></code> - unramified algebraic points of h_p</li>
</ul>
<p>OUTPUT:</p>
<p>a list of 2x2 integer matrices representing edges of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z1</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span>
<span class="gp">sage: </span><span class="n">z2</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">p</span><span class="o">^</span><span class="mi">6</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_covering</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[0 1]  [3 0]  [0 1]  [0 1]  [0 1]  [0 1]</span>
<span class="go">[3 0], [0 1], [3 2], [9 1], [9 4], [9 7]</span>
<span class="go">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function is used to compute certain Coleman integrals
on <span class="math">\(P^1\)</span>. That’s why the input consists of two points of
the <span class="math">\(p\)</span>-adic upper half plane, but decomposes
<span class="math">\(P^1(\QQ_p)\)</span>. This decomposition is what allows us to
represent the relevant integrand as a locally analytic
function. The <code class="docutils literal"><span class="pre">z1</span></code> and <code class="docutils literal"><span class="pre">z2</span></code> appear in the integrand.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_geodesic">
<code class="descname">find_geodesic</code><span class="sig-paren">(</span><em>v1</em>, <em>v2</em>, <em>normalized=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_geodesic" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the geodesic between two vertices</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v1</span></code> - 2x2 integer matrix representing a vertex</li>
<li><code class="docutils literal"><span class="pre">v2</span></code> - 2x2 integer matrix representing a vertex</li>
<li><code class="docutils literal"><span class="pre">normalized</span></code> - boolean (default: True)</li>
</ul>
<p>OUTPUT:</p>
<p>An ordered list of 2x2 integer matrices representing the vertices
of the paths joining <code class="docutils literal"><span class="pre">v1</span></code> and <code class="docutils literal"><span class="pre">v2</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">^</span><span class="mi">1</span><span class="p">])</span> <span class="p">);</span> <span class="n">v1</span>
<span class="go">[27  0]</span>
<span class="go">[ 1  3]</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">p</span><span class="p">])</span> <span class="p">);</span> <span class="n">v2</span>
<span class="go">[1 0]</span>
<span class="go">[6 9]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_geodesic</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[27  0]  [27  0]  [9 0]  [3 0]  [1 0]  [1 0]  [1 0]</span>
<span class="go">[ 1  3], [ 0  1], [0 1], [0 1], [0 1], [0 3], [6 9]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.find_path">
<code class="descname">find_path</code><span class="sig-paren">(</span><em>v</em>, <em>boundary=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.find_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a path from a vertex to a given set of so-called
boundary vertices, whose interior must contain the origin
vertex.  In the case that the boundary is not specified, it
computes the geodesic between the given vertex and the origin.
In the case that the boundary contains more than one vertex,
it computes the geodesic to some point of the boundary.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">v</span></code> - a 2x2 matrix representing a vertex <code class="docutils literal"><span class="pre">boundary</span></code></li>
<li>a list of matrices (default: None). If ommitted, finds the
geodesic from <code class="docutils literal"><span class="pre">v</span></code> to the central vertex.</li>
</ul>
<p>OUTPUT:</p>
<p>An ordered list of vertices describing the geodesic from
<code class="docutils literal"><span class="pre">v</span></code> to <code class="docutils literal"><span class="pre">boundary</span></code>, followed by the vertex in the boundary
that is closest to <code class="docutils literal"><span class="pre">v</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>
<span class="go">(</span>
<span class="go">[[81  0]</span>
<span class="go">[ 0  1], [27  0]</span>
<span class="go">[ 0  1], [9 0]</span>
<span class="go">[0 1], [3 0]      [1 0]</span>
<span class="go">[0 1]]          , [0 1]</span>
<span class="go">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">find_path</span><span class="p">(</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="n">p</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span> <span class="p">)</span>
<span class="go">(</span>
<span class="go">[[27  0]</span>
<span class="go">[ 8  9], [27  0]</span>
<span class="go">[ 2  3], [27  0]</span>
<span class="go">[ 0  1], [9 0]</span>
<span class="go">[0 1], [3 0]      [1 0]</span>
<span class="go">[0 1]]          , [0 1]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.get_balls">
<code class="descname">get_balls</code><span class="sig-paren">(</span><em>center=1</em>, <em>level=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.get_balls" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a decomposition of <span class="math">\(P^1(\QQ_p)\)</span> into compact
open balls.</p>
<p>Each vertex in the Bruhat-Tits tree gives a decomposition of
<span class="math">\(P^1(\QQ_p)\)</span> into <span class="math">\(p+1\)</span> open balls. Each of these balls may
be further subdivided, to get a finer decomposition.</p>
<p>This function returns the decomposition of <span class="math">\(P^1(\QQ_p)\)</span>
corresponding to <code class="docutils literal"><span class="pre">center</span></code> into <span class="math">\((p+1)p^{\mbox{level}}\)</span> balls.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">get_balls</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[0 1]  [0 1]  [8 0]  [0 4]  [0 2]  [0 2]</span>
<span class="go">[2 0], [2 1], [0 1], [2 1], [4 1], [4 3]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.leaving_edges">
<code class="descname">leaving_edges</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.leaving_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Return edges leaving a vertex</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - 2x2 integer matrix</li>
</ul>
<p>OUTPUT:</p>
<p>List of size <span class="math">\(p+1\)</span> of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">leaving_edges</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="go">[</span>
<span class="go">[0 1]  [7 0]  [0 1]  [0 1]  [0 1]  [0 1]  [0 1]  [0 1]</span>
<span class="go">[7 0], [0 1], [7 1], [7 4], [7 5], [7 2], [7 3], [7 6]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.opposite">
<code class="descname">opposite</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.opposite" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the edge oriented oppositely to a
given edge.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> - 2x2 integer matrix</li>
</ul>
<p>OUTPUT:</p>
<p>2x2 integer matrix</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="go">[0 1]</span>
<span class="go">[7 0]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">opposite</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="o">==</span> <span class="n">e</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.origin">
<code class="descname">origin</code><span class="sig-paren">(</span><em>e</em>, <em>normalized=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.origin" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the origin vertex of the edge represented by the
input matrix e.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> - a 2x2 matrix with integer entries</li>
<li><code class="docutils literal"><span class="pre">normalized</span></code> - boolean (default: false). If True
then the input matrix M is assumed to be normalized</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> - A 2x2 integer matrix</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">origin</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]))</span>
<span class="go">[1 0]</span>
<span class="go">[1 7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.subdivide">
<code class="descname">subdivide</code><span class="sig-paren">(</span><em>edgelist</em>, <em>level</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.subdivide" title="Permalink to this definition">¶</a></dt>
<dd><p>(Ordered) edges of self may be regarded as open balls in
<span class="math">\(P^1(\QQ_p)\)</span>.  Given a list of edges, this function return a list
of edges corresponding to the level-th subdivision of the
corresponding opens.  That is, each open ball of the input is
broken up into <span class="math">\(p^{\mbox{level}}\)</span> subballs of equal radius.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">edgelist</span></code> - a list of edges</li>
<li><code class="docutils literal"><span class="pre">level</span></code> - an integer</li>
</ul>
<p>OUTPUT:</p>
<p>A list of 2x2 integer matrices</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])],</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[</span>
<span class="go">[27  0]  [0 9]  [0 9]  [0 3]  [0 3]  [0 3]  [0 3]  [0 3]  [0 3]</span>
<span class="go">[ 0  1], [3 1], [3 2], [9 1], [9 4], [9 7], [9 2], [9 5], [9 8]</span>
<span class="go">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.target">
<code class="descname">target</code><span class="sig-paren">(</span><em>e</em>, <em>normalized=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.target" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the target vertex of the edge represented by the
input matrix e.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> - a 2x2 matrix with integer entries</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">normalized</span></code> - boolean (default: false). If True</dt>
<dd>then the input matrix is assumed to be normalized.</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> - 2x2 integer matrix representing the target of
the input edge</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">target</span><span class="p">(</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]))</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.BruhatTitsTree.vertex">
<code class="descname">vertex</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.BruhatTitsTree.vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a matrix to the corresponding normalized
vertex representative</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">M</span></code> - 2x2 integer matrix</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a 2x2 integer matrix</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">BruhatTitsTree</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">BruhatTitsTree</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="n">p</span><span class="o">**</span><span class="mi">5</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">p</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="n">p</span><span class="o">+</span><span class="n">p</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">inverse</span><span class="p">()</span><span class="o">*</span><span class="n">e</span>
<span class="gp">sage: </span><span class="n">scaling</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="mi">20</span><span class="p">)(</span><span class="n">t</span><span class="o">.</span><span class="n">determinant</span><span class="p">())</span><span class="o">.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">scaling</span> <span class="o">*</span> <span class="n">t</span>
<span class="gp">sage: </span><span class="nb">min</span><span class="p">([</span><span class="n">t</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)])</span> <span class="o">&gt;=</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.btquotients.btquotient.DoubleCosetReduction">
<em class="property">class </em><code class="descclassname">sage.modular.btquotients.btquotient.</code><code class="descname">DoubleCosetReduction</code><span class="sig-paren">(</span><em>Y</em>, <em>x</em>, <em>extrapow=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>Edges in the Bruhat-Tits tree are represented by cosets of
matrices in <span class="math">\(GL_2\)</span>. Given a matrix <span class="math">\(x\)</span> in <span class="math">\(GL_2\)</span>, this
class computes and stores the data corresponding to the
double coset representation of <span class="math">\(x\)</span> in terms of a fundamental
domain of edges for the action of the arithmetic group <span class="math">\(\Gamma\)</span>.</p>
<p>More precisely:</p>
<p>Initialized with an element <span class="math">\(x\)</span> of <span class="math">\(GL_2(\ZZ)\)</span>, finds elements
<span class="math">\(\gamma\)</span> in <span class="math">\(\Gamma\)</span>, <span class="math">\(t\)</span> and an edge <span class="math">\(e\)</span> such that <span class="math">\(get=x\)</span>. It
stores these values as members <code class="docutils literal"><span class="pre">gamma</span></code>, <code class="docutils literal"><span class="pre">label</span></code> and functions
<code class="docutils literal"><span class="pre">self.sign()</span></code>,  <code class="docutils literal"><span class="pre">self.t()</span></code> and <code class="docutils literal"><span class="pre">self.igamma()</span></code>, satisfying:</p>
<ul class="simple">
<li>if <code class="docutils literal"><span class="pre">self.sign()</span> <span class="pre">==</span> <span class="pre">+1</span></code>:
<code class="docutils literal"><span class="pre">igamma()</span> <span class="pre">*</span> <span class="pre">edge_list[label].rep</span> <span class="pre">*</span> <span class="pre">t()</span> <span class="pre">==</span> <span class="pre">x</span></code></li>
<li>if <code class="docutils literal"><span class="pre">self.sign()</span> <span class="pre">==</span> <span class="pre">-1</span></code>:
<code class="docutils literal"><span class="pre">igamma()</span> <span class="pre">*</span> <span class="pre">edge_list[label].opposite.rep</span> <span class="pre">*</span> <span class="pre">t()</span> <span class="pre">==</span> <span class="pre">x</span></code></li>
</ul>
<p>It also stores a member called power so that:</p>
<blockquote>
<div><code class="docutils literal"><span class="pre">p**(2*power)</span> <span class="pre">=</span> <span class="pre">gamma.reduced_norm()</span></code></div></blockquote>
<p>The usual decomposition <span class="math">\(get=x\)</span> would be:</p>
<ul class="simple">
<li>g = gamma / (p ** power)</li>
<li>e = edge_list[label]</li>
<li>t’ = t * p ** power</li>
</ul>
<p>Here usual denotes that we have rescaled gamma to have unit
determinant, and so that the result is honestly an element
of the arithmetic quaternion group under consideration. In
practice we store integral multiples and keep track of the
powers of <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Y</span></code> -  BruhatTitsQuotient object in which to work</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">x</span></code> -  Something coercible into a matrix in <span class="math">\(GL_2(\ZZ)\)</span>. In</dt>
<dd>principle we should allow elements in <span class="math">\(GL_2(\QQ_p)\)</span>, but it is
enough to work with integral entries</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">extrapow</span></code> - gets added to the power attribute, and it is</dt>
<dd>used for the Hecke action.</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1231</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())]</span><span class="o">.</span><span class="n">opposite</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1423</span><span class="p">,</span><span class="mi">113553</span><span class="p">,</span><span class="mi">11231</span><span class="p">,</span><span class="mi">12313</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Cameron Franc (2012-02-20)</li>
<li>Marc Masdeu</li>
</ul>
<dl class="method">
<dt id="sage.modular.btquotients.btquotient.DoubleCosetReduction.igamma">
<code class="descname">igamma</code><span class="sig-paren">(</span><em>embedding=None</em>, <em>scale=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.igamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Image under gamma.</p>
<p>Elements of the arithmetic group can be regarded as elements
of the global quaternion order, and hence may be represented
exactly. This function computes the image of such an element
under the local splitting and returns the corresponding <span class="math">\(p\)</span>-adic
approximation.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">embedding</span></code> - an integer, or a function (default:
none). If <code class="docutils literal"><span class="pre">embedding</span></code> is None, then the image of
<code class="docutils literal"><span class="pre">self.gamma</span></code> under the local splitting associated to
<code class="docutils literal"><span class="pre">self.Y</span></code> is used. If <code class="docutils literal"><span class="pre">embedding</span></code> is an integer, then
the precision of the local splitting of self.Y is raised
(if necessary) to be larger than this integer, and this
new local splitting is used. If a function is passed, then
map <code class="docutils literal"><span class="pre">self.gamma</span></code> under <code class="docutils literal"><span class="pre">embedding</span></code>.</li>
<li><code class="docutils literal"><span class="pre">scale</span></code> – (default: 1) scaling factor applied to the output</li>
</ul>
<p>OUTPUT:</p>
<p>a 2x2 matrix with <span class="math">\(p\)</span>-adic entries encoding the image of <code class="docutils literal"><span class="pre">self</span></code>
under the local splitting</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span>
<span class="go">[6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)                                   O(7^5)]</span>
<span class="go">[                                  O(7^5) 6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + O(7^5)]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">(</span><span class="n">embedding</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">[6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + 6*7^5 + 6*7^6 + O(7^7)                                                   O(7^7)]</span>
<span class="go">[                                                  O(7^7) 6 + 6*7 + 6*7^2 + 6*7^3 + 6*7^4 + 6*7^5 + 6*7^6 + O(7^7)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.DoubleCosetReduction.sign">
<code class="descname">sign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>The direction of the edge.</p>
<p>The Bruhat Tits quotients are directed graphs but we only store
half the edges (we treat them more like unordered graphs).
The sign tells whether the matrix self.x is equivalent to the
representative in the quotient (sign = +1), or to the
opposite of one of the representatives (sign = -1).</p>
<p>OUTPUT :</p>
<p>an int that is +1 or -1 according to the sign of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1231</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="o">.</span><span class="n">get_edge_list</span><span class="p">())]</span><span class="o">.</span><span class="n">opposite</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1423</span><span class="p">,</span><span class="mi">113553</span><span class="p">,</span><span class="mi">11231</span><span class="p">,</span><span class="mi">12313</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">sign</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">igamma</span><span class="p">()</span><span class="o">*</span><span class="n">Y</span><span class="o">.</span><span class="n">_edge_list</span><span class="p">[</span><span class="n">d</span><span class="o">.</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">rep</span><span class="o">*</span><span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.modular.btquotients.btquotient.DoubleCosetReduction.t">
<code class="descname">t</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.DoubleCosetReduction.t" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ‘t part’ of the decomposition using the rest of the data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> - a <span class="math">\(p\)</span>-adic precision that t will be computed
to. Defaults to the default working precision of self.</li>
</ul>
<p>OUTPUT:</p>
<p>a 2x2 <span class="math">\(p\)</span>-adic matrix with entries of
precision <code class="docutils literal"><span class="pre">prec</span></code> that is the ‘t-part’ of the decomposition of
self</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">DoubleCosetReduction</span>
<span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">BruhatTitsQuotient</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">123</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">1231</span><span class="p">,</span><span class="mi">1232</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DoubleCosetReduction</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">t</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.modular.btquotients.btquotient.Edge">
<em class="property">class </em><code class="descclassname">sage.modular.btquotients.btquotient.</code><code class="descname">Edge</code><span class="sig-paren">(</span><em>p</em>, <em>label</em>, <em>rep</em>, <em>origin</em>, <em>target</em>, <em>links=None</em>, <em>opposite=None</em>, <em>determinant=None</em>, <em>valuation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.Edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>This is a structure to represent edges of quotients of the
Bruhat-Tits tree. It is useful to enrich the representation of an
edge as a matrix with extra data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime integer.</li>
<li><code class="docutils literal"><span class="pre">label</span></code> - An integer which uniquely identifies this edge.</li>
<li><code class="docutils literal"><span class="pre">rep</span></code> - A 2x2 matrix in reduced form representing this edge.</li>
<li><code class="docutils literal"><span class="pre">origin</span></code> - The origin vertex of <code class="docutils literal"><span class="pre">self</span></code>.</li>
<li><code class="docutils literal"><span class="pre">target</span></code> - The target vertex of <code class="docutils literal"><span class="pre">self</span></code>.</li>
<li><code class="docutils literal"><span class="pre">links</span></code> - (Default: empty list) A list of elements of
<span class="math">\(\Gamma\)</span> which identify different edges in the Bruhat-Tits tree
which are equivalent to <code class="docutils literal"><span class="pre">self</span></code>.</li>
<li><code class="docutils literal"><span class="pre">opposite</span></code> - (Default: None) The edge opposite to <code class="docutils literal"><span class="pre">self</span></code></li>
<li><code class="docutils literal"><span class="pre">determinant</span></code> - (Default: None) The determinant of <code class="docutils literal"><span class="pre">rep</span></code>,
if known.</li>
<li><code class="docutils literal"><span class="pre">valuation</span></code> - (Default: None) The valuation of the
determinant of <code class="docutils literal"><span class="pre">rep</span></code>, if known.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">Edge</span><span class="p">,</span> <span class="n">Vertex</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v2</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">e1</span> <span class="o">=</span> <span class="n">Edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]),</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e1</span><span class="o">.</span><span class="n">rep</span>
<span class="go">[ 1  2]</span>
<span class="go">[ 3 18]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Marc Masdeu (2012-02-20)</li>
</ul>
</dd></dl>

<dl class="class">
<dt id="sage.modular.btquotients.btquotient.Vertex">
<em class="property">class </em><code class="descclassname">sage.modular.btquotients.btquotient.</code><code class="descname">Vertex</code><span class="sig-paren">(</span><em>p</em>, <em>label</em>, <em>rep</em>, <em>leaving_edges=None</em>, <em>entering_edges=None</em>, <em>determinant=None</em>, <em>valuation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.btquotients.btquotient.Vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>This is a structure to represent vertices of quotients of the
Bruhat-Tits tree.  It is useful to enrich the representation of
the vertex as a matrix with extra data.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime integer.</li>
<li><code class="docutils literal"><span class="pre">label</span></code> - An integer which uniquely identifies this vertex.</li>
<li><code class="docutils literal"><span class="pre">rep</span></code> - A 2x2 matrix in reduced form representing this
vertex.</li>
<li><code class="docutils literal"><span class="pre">leaving_edges</span></code> - (default: empty list) A list of edges
leaving this vertex.</li>
<li><code class="docutils literal"><span class="pre">entering_edges</span></code> - (default: empty list) A list of edges
entering this vertex.</li>
<li><code class="docutils literal"><span class="pre">determinant</span></code> - (default: None) The determinant of <code class="docutils literal"><span class="pre">rep</span></code>,
if known.</li>
<li><code class="docutils literal"><span class="pre">valuation</span></code> - (default: None) The valuation of the
determinant of <code class="docutils literal"><span class="pre">rep</span></code>, if known.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.modular.btquotients.btquotient</span> <span class="kn">import</span> <span class="n">Vertex</span>
<span class="gp">sage: </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Vertex</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">Matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">18</span><span class="p">]))</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">rep</span>
<span class="go">[ 1  2]</span>
<span class="go">[ 3 18]</span>
<span class="gp">sage: </span><span class="n">v1</span><span class="o">.</span><span class="n">entering_edges</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Marc Masdeu (2012-02-20)</li>
</ul>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="../pollack_stevens/modsym.html"
                                  title="previous chapter">Element class for Pollack-Stevens’ Modular Symbols</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="pautomorphicform.html"
                                  title="next chapter">Spaces of <span class="math">\(p\)</span>-adic automorphic forms</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/modular/btquotients/btquotient.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pautomorphicform.html" title="Spaces of \(p\)-adic automorphic forms"
             >next</a> |</li>
        <li class="right" >
          <a href="../pollack_stevens/modsym.html" title="Element class for Pollack-Stevens’ Modular Symbols"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Modular Symbols</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>