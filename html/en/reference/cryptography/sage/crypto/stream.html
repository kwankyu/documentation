
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Stream Cryptosystems &#8212; Sage Reference Manual v8.2: Cryptography</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Stream Ciphers" href="stream_cipher.html" />
    <link rel="prev" title="Blum-Goldwasser Probabilistic Encryption" href="public_key/blum_goldwasser.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stream_cipher.html" title="Stream Ciphers"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="public_key/blum_goldwasser.html" title="Blum-Goldwasser Probabilistic Encryption"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cryptography</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="stream-cryptosystems">
<span id="sage-crypto-stream"></span><h1>Stream Cryptosystems<a class="headerlink" href="#stream-cryptosystems" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.crypto.stream"></span><dl class="class">
<dt id="sage.crypto.stream.LFSRCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.stream.</code><code class="descname">LFSRCryptosystem</code><span class="sig-paren">(</span><em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.stream.LFSRCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Linear feedback shift register cryptosystem class</p>
<dl class="method">
<dt id="sage.crypto.stream.LFSRCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.stream.LFSRCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.crypto.stream.ShrinkingGeneratorCryptosystem">
<em class="property">class </em><code class="descclassname">sage.crypto.stream.</code><code class="descname">ShrinkingGeneratorCryptosystem</code><span class="sig-paren">(</span><em>field=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.stream.ShrinkingGeneratorCryptosystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="cryptosystem.html#sage.crypto.cryptosystem.SymmetricKeyCryptosystem" title="sage.crypto.cryptosystem.SymmetricKeyCryptosystem"><code class="xref py py-class docutils literal"><span class="pre">sage.crypto.cryptosystem.SymmetricKeyCryptosystem</span></code></a></p>
<p>Shrinking generator cryptosystem class</p>
<dl class="method">
<dt id="sage.crypto.stream.ShrinkingGeneratorCryptosystem.encoding">
<code class="descname">encoding</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.stream.ShrinkingGeneratorCryptosystem.encoding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.crypto.stream.blum_blum_shub">
<code class="descclassname">sage.crypto.stream.</code><code class="descname">blum_blum_shub</code><span class="sig-paren">(</span><em>length</em>, <em>seed=None</em>, <em>p=None</em>, <em>q=None</em>, <em>lbound=None</em>, <em>ubound=None</em>, <em>ntries=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.stream.blum_blum_shub" title="Permalink to this definition">¶</a></dt>
<dd><p>The Blum-Blum-Shub (BBS) pseudorandom bit generator.</p>
<p>See the original paper by Blum, Blum and Shub <a class="reference internal" href="../../../references/index.html#bbs1986" id="id1">[BBS1986]</a>. The
BBS algorithm is also discussed in section 5.5.2 of <a class="reference internal" href="../../../references/index.html#mvov1996" id="id2">[MvOV1996]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">length</span></code> – positive integer; the number of bits in the output
pseudorandom bit sequence.</li>
<li><code class="docutils literal"><span class="pre">seed</span></code> – (default: <code class="docutils literal"><span class="pre">None</span></code>) if <span class="math">\(p\)</span> and <span class="math">\(q\)</span> are Blum primes, then
<code class="docutils literal"><span class="pre">seed</span></code> is a quadratic residue in the multiplicative group
<span class="math">\((\ZZ/n\ZZ)^{\ast}\)</span> where <span class="math">\(n = pq\)</span>. If <code class="docutils literal"><span class="pre">seed=None</span></code>, then the function
would generate its own random quadratic residue in <span class="math">\((\ZZ/n\ZZ)^{\ast}\)</span>.
If you provide a value for <code class="docutils literal"><span class="pre">seed</span></code>, then it is your responsibility to
ensure that the seed is a quadratic residue in the multiplicative group
<span class="math">\((\ZZ/n\ZZ)^{\ast}\)</span>.</li>
<li><code class="docutils literal"><span class="pre">p</span></code> – (default: <code class="docutils literal"><span class="pre">None</span></code>) a large positive prime congruent to 3
modulo 4. Both <code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code> must be distinct. If <code class="docutils literal"><span class="pre">p=None</span></code>, then
a value for <code class="docutils literal"><span class="pre">p</span></code> will be generated, where
<code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">p</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>.</li>
<li><code class="docutils literal"><span class="pre">q</span></code> – (default: <code class="docutils literal"><span class="pre">None</span></code>) a large positive prime congruence to 3
modulo 4. Both <code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code> must be distinct. If <code class="docutils literal"><span class="pre">q=None</span></code>, then
a value for <code class="docutils literal"><span class="pre">q</span></code> will be generated, where
<code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>.</li>
<li><code class="docutils literal"><span class="pre">lbound</span></code> – (positive integer, default: <code class="docutils literal"><span class="pre">None</span></code>) the lower
bound on how small each random primes <span class="math">\(p\)</span> and <span class="math">\(q\)</span> can be. So we
have <code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lbound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">ubound</span></code>. The lower bound must be
distinct from the upper bound.</li>
<li><code class="docutils literal"><span class="pre">ubound</span></code> – (positive integer, default: <code class="docutils literal"><span class="pre">None</span></code>) the upper
bound on how large each random primes <span class="math">\(p\)</span> and <span class="math">\(q\)</span> can be. So we have
<code class="docutils literal"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lbound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">ubound</span></code>. The lower bound must be distinct
from the upper bound.</li>
<li><code class="docutils literal"><span class="pre">ntries</span></code> – (default: <code class="docutils literal"><span class="pre">100</span></code>) the number of attempts to generate
a random Blum prime. If <code class="docutils literal"><span class="pre">ntries</span></code> is a positive integer, then
perform that many attempts at generating a random Blum prime. This
might or might not result in a Blum prime.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A pseudorandom bit sequence whose length is specified by <code class="docutils literal"><span class="pre">length</span></code>.</li>
</ul>
<p>Here is a common use case for this function. If you want this
function to use pre-computed values for <span class="math">\(p\)</span> and <span class="math">\(q\)</span>, you should pass
those pre-computed values to this function. In that case, you only need
to specify values for <code class="docutils literal"><span class="pre">length</span></code>, <code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code>, and you do not need
to worry about doing anything with the parameters <code class="docutils literal"><span class="pre">lbound</span></code> and
<code class="docutils literal"><span class="pre">ubound</span></code>. The pre-computed values <span class="math">\(p\)</span> and <span class="math">\(q\)</span> must be Blum primes.
It is your responsibility to check that both <span class="math">\(p\)</span> and <span class="math">\(q\)</span> are Blum primes.</p>
<p>Here is another common use case. If you want the function to generate
its own values for <span class="math">\(p\)</span> and <span class="math">\(q\)</span>, you must specify the lower and upper
bounds within which these two primes must lie. In that case, you must
specify values for <code class="docutils literal"><span class="pre">length</span></code>, <code class="docutils literal"><span class="pre">lbound</span></code> and <code class="docutils literal"><span class="pre">ubound</span></code>, and you do
not need to worry about values for the parameters <code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code>. The
parameter <code class="docutils literal"><span class="pre">ntries</span></code> is only relevant when you want this function to
generate <code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Beware that there might not be any primes between the lower and
upper bounds. So make sure that these two bounds are
“sufficiently” far apart from each other for there to be primes
congruent to 3 modulo 4. In particular, there should be at least
two distinct primes within these bounds, each prime being congruent
to 3 modulo 4. This function uses the function
<a class="reference internal" href="util.html#sage.crypto.util.random_blum_prime" title="sage.crypto.util.random_blum_prime"><code class="xref py py-func docutils literal"><span class="pre">random_blum_prime()</span></code></a> to
generate random primes that are congruent to 3 modulo 4.</p>
</div>
<p>ALGORITHM:</p>
<p>The BBS algorithm as described below is adapted from the presentation
in Algorithm 5.40, page 186 of <a class="reference internal" href="../../../references/index.html#mvov1996" id="id3">[MvOV1996]</a>.</p>
<ol class="arabic simple">
<li>Let <span class="math">\(L\)</span> be the desired number of bits in the output bit sequence.
That is, <span class="math">\(L\)</span> is the desired length of the bit string.</li>
<li>Let <span class="math">\(p\)</span> and <span class="math">\(q\)</span> be two large distinct primes, each congruent to 3
modulo 4.</li>
<li>Let <span class="math">\(n = pq\)</span> be the product of <span class="math">\(p\)</span> and <span class="math">\(q\)</span>.</li>
<li>Select a random seed value <span class="math">\(s \in (\ZZ/n\ZZ)^{\ast}\)</span>, where
<span class="math">\((\ZZ/n\ZZ)^{\ast}\)</span> is the multiplicative group of <span class="math">\(\ZZ/n\ZZ\)</span>.</li>
<li>Let <span class="math">\(x_0 = s^2 \bmod n\)</span>.</li>
<li>For <span class="math">\(i\)</span> from 1 to <span class="math">\(L\)</span>, do<ol class="arabic">
<li>Let <span class="math">\(x_i = x_{i-1}^2 \bmod n\)</span>.</li>
<li>Let <span class="math">\(z_i\)</span> be the least significant bit of <span class="math">\(x_i\)</span>.</li>
</ol>
</li>
<li>The output pseudorandom bit sequence is <span class="math">\(z_1, z_2, \dots, z_L\)</span>.</li>
</ol>
<p>EXAMPLES:</p>
<p>A BBS pseudorandom bit sequence with a specified seed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.stream</span> <span class="kn">import</span> <span class="n">blum_blum_shub</span>
<span class="gp">sage: </span><span class="n">blum_blum_shub</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>
<span class="go">110000</span>
</pre></div>
</div>
<p>You could specify the length of the bit string, with given values for
<code class="docutils literal"><span class="pre">p</span></code> and <code class="docutils literal"><span class="pre">q</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">blum_blum_shub</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">19</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">001011</span>
</pre></div>
</div>
<p>Or you could specify the length of the bit string, with given values for
the lower and upper bounds:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">blum_blum_shub</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">lbound</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="n">ubound</span><span class="o">=</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">110111</span>
</pre></div>
</div>
<p>Under some reasonable hypotheses, Blum-Blum-Shub <a class="reference internal" href="../../../references/index.html#bbs1982" id="id4">[BBS1982]</a>
sketch a proof that the period of the BBS stream cipher is equal to
<span class="math">\(\lambda(\lambda(n))\)</span>, where <span class="math">\(\lambda(n)\)</span> is the Carmichael function of
<span class="math">\(n\)</span>. This is verified below in a few examples by using the function
<a class="reference internal" href="lfsr.html#sage.crypto.lfsr.lfsr_connection_polynomial" title="sage.crypto.lfsr.lfsr_connection_polynomial"><code class="xref py py-func docutils literal"><span class="pre">lfsr_connection_polynomial()</span></code></a>
(written by Tim Brock) which computes the connection polynomial of a
linear feedback shift register sequence. The degree of that polynomial
is the period.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.stream</span> <span class="kn">import</span> <span class="n">blum_blum_shub</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">carmichael_lambda</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="mi">11</span><span class="p">))</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">blum_blum_shub</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">13</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x^3 + x^2 + x + 1</span>
<span class="gp">sage: </span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="n">carmichael_lambda</span><span class="p">(</span><span class="mi">11</span><span class="o">*</span><span class="mi">23</span><span class="p">))</span>
<span class="go">20</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">)(</span><span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">blum_blum_shub</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">13</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">lfsr_connection_polynomial</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">x^19 + x^18 + x^17 + x^16 + x^15 + x^14 + x^13 + x^12 + x^11 + x^10 + x^9 + x^8 + x^7 + x^6 + x^5 + x^4 + x^3 + x^2 + x + 1</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="public_key/blum_goldwasser.html"
                                  title="previous chapter">Blum-Goldwasser Probabilistic Encryption</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="stream_cipher.html"
                                  title="next chapter">Stream Ciphers</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/crypto/stream.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="stream_cipher.html" title="Stream Ciphers"
             >next</a> |</li>
        <li class="right" >
          <a href="public_key/blum_goldwasser.html" title="Blum-Goldwasser Probabilistic Encryption"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cryptography</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>