
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Blum-Goldwasser Probabilistic Encryption &#8212; Sage Reference Manual v9.0: Cryptography</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Stream Cryptosystems" href="../stream.html" />
    <link rel="prev" title="PRESENT" href="../block_cipher/present.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../stream.html" title="Stream Cryptosystems"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../block_cipher/present.html" title="PRESENT"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Cryptography</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="blum-goldwasser-probabilistic-encryption">
<span id="sage-crypto-public-key-blum-goldwasser"></span><h1>Blum-Goldwasser Probabilistic Encryption<a class="headerlink" href="#blum-goldwasser-probabilistic-encryption" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.crypto.public_key.blum_goldwasser"></span><p>The Blum-Goldwasser probabilistic public-key encryption scheme. This scheme
was originally described in <a class="reference internal" href="../../../../references/index.html#bg1985" id="id1">[BG1985]</a>. See also section 8.7.2
of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id2">[MvOV1996]</a> and the <a class="reference external" href="https://en.wikipedia.org/wiki/Blum-Goldwasser_cryptosystem">Wikipedia article Blum-Goldwasser_cryptosystem</a>
on this scheme.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mike Hogan and David Joyner (2009-9-19): initial procedural version
released as public domain software.</li>
<li>Minh Van Nguyen (2009-12): integrate into Sage as a class and relicense
under the GPLv2+. Complete rewrite of the original version to follow
the description contained in <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id3">[MvOV1996]</a>.</li>
</ul>
<dl class="class">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser">
<em class="property">class </em><code class="descclassname">sage.crypto.public_key.blum_goldwasser.</code><code class="descname">BlumGoldwasser</code><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../cryptosystem.html#sage.crypto.cryptosystem.PublicKeyCryptosystem" title="sage.crypto.cryptosystem.PublicKeyCryptosystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.crypto.cryptosystem.PublicKeyCryptosystem</span></code></a></p>
<p>The Blum-Goldwasser probabilistic public-key encryption scheme.</p>
<p>The Blum-Goldwasser encryption and decryption algorithms as described in
<a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt" title="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">encrypt()</span></code></a> and
<a class="reference internal" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt" title="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt"><code class="xref py py-func docutils literal notranslate"><span class="pre">decrypt()</span></code></a>, respectively, make use of the
least significant bit of a binary string. A related concept is the <span class="math notranslate nohighlight">\(k\)</span>
least significant bits of a binary string. For example, given a positive
integer <span class="math notranslate nohighlight">\(n\)</span>, let <span class="math notranslate nohighlight">\(b = b_0 b_1 \cdots b_{m-1}\)</span> be the binary representation
of <span class="math notranslate nohighlight">\(n\)</span> so that <span class="math notranslate nohighlight">\(b\)</span> is a binary string of length <span class="math notranslate nohighlight">\(m\)</span>. Then the least
significant bit of <span class="math notranslate nohighlight">\(n\)</span> is <span class="math notranslate nohighlight">\(b_{m-1}\)</span>. If <span class="math notranslate nohighlight">\(0 &lt; k \leq m\)</span>, then the <span class="math notranslate nohighlight">\(k\)</span> least
significant bits of <span class="math notranslate nohighlight">\(n\)</span> are <span class="math notranslate nohighlight">\(b_{m-1-k} b_{m-k} \cdots b_{m-1}\)</span>. The least
significant bit of an integer is also referred to as its parity bit,
because this bit determines whether the integer is even or odd. In the
following example, we obtain the least significant bit of an integer:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">123</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">binary</span><span class="p">();</span> <span class="n">b</span>
<span class="go">&#39;1111011&#39;</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&#39;1&#39;</span>
</pre></div>
</div>
<p>Now find the 4 least significant bits of the integer <span class="math notranslate nohighlight">\(n = 123\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span>
<span class="go">&#39;1111011&#39;</span>
<span class="gp">sage: </span><span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:]</span>
<span class="go">&#39;1011&#39;</span>
</pre></div>
</div>
<p>The last two examples could be worked through as follows:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">least_significant_bits</span>
<span class="gp">sage: </span><span class="n">least_significant_bits</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[1]</span>
<span class="gp">sage: </span><span class="n">least_significant_bits</span><span class="p">(</span><span class="mi">123</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">[1, 0, 1, 1]</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<p>The following encryption/decryption example is taken from Example 8.57,
pages 309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id4">[MvOV1996]</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">();</span> <span class="n">bg</span>
<span class="go">The Blum-Goldwasser public-key encryption scheme.</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">pubkey</span>
<span class="go">272953</span>
<span class="gp">sage: </span><span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">prikey</span>
<span class="go">(499, 547, -57, 52)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;10011100000100001100&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">159201</span><span class="p">);</span> <span class="n">C</span>
<span class="go">([[0, 0, 1, 0], [0, 0, 0, 0], [1, 1, 0, 0], [1, 1, 1, 0], [0, 1, 0, 0]], 139680)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">prikey</span><span class="p">);</span> <span class="n">M</span>
<span class="go">[[1, 0, 0, 1], [1, 1, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0], [1, 1, 0, 0]]</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">flatten</span><span class="p">(</span><span class="n">M</span><span class="p">));</span> <span class="n">M</span>
<span class="go">&#39;10011100000100001100&#39;</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Generate a pair of random public/private keys. Use the public key to
encrypt a plaintext. Then decrypt the resulting ciphertext using the
private key. Finally, compare the decrypted message with the original
plaintext.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">bin_to_ascii</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pubkey</span><span class="p">,</span> <span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">random_key</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;A fixed plaintext.&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">pubkey</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">prikey</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bin_to_ascii</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">M</span><span class="p">))</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> is a private key, then <span class="math notranslate nohighlight">\(n = pq\)</span> is the corresponding
public key. Furthermore, we have <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">prikey</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">==</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt">
<code class="descname">decrypt</code><span class="sig-paren">(</span><em>C</em>, <em>K</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.decrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the Blum-Goldwasser scheme to decrypt the ciphertext <code class="docutils literal notranslate"><span class="pre">C</span></code>
using the private key <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">C</span></code> – a ciphertext resulting from encrypting a plaintext using
the Blum-Goldwasser encryption algorithm. The ciphertext <span class="math notranslate nohighlight">\(C\)</span> must
be of the form <span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>. Each <span class="math notranslate nohighlight">\(c_i\)</span>
is a sub-block of binary string and <span class="math notranslate nohighlight">\(x_{t+1}\)</span> is the result of the
<span class="math notranslate nohighlight">\(t+1\)</span>-th iteration of the Blum-Blum-Shub algorithm.</li>
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are
distinct Blum primes and <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The plaintext resulting from decrypting the ciphertext <code class="docutils literal notranslate"><span class="pre">C</span></code> using
the Blum-Goldwasser decryption algorithm.</li>
</ul>
<p>ALGORITHM:</p>
<p>The Blum-Goldwasser decryption algorithm is described in Algorithm
8.56, page 309 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id5">[MvOV1996]</a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li>Let <span class="math notranslate nohighlight">\(C\)</span> be the ciphertext <span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>.
Then <span class="math notranslate nohighlight">\(t\)</span> is the number of ciphertext sub-blocks and <span class="math notranslate nohighlight">\(h\)</span> is the
length of each binary string sub-block <span class="math notranslate nohighlight">\(c_i\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> be the private key whose corresponding
public key is <span class="math notranslate nohighlight">\(n = pq\)</span>. Note that <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</li>
<li>Compute <span class="math notranslate nohighlight">\(d_1 = ((p + 1) / 4)^{t+1} \bmod{(p - 1)}\)</span>.</li>
<li>Compute <span class="math notranslate nohighlight">\(d_2 = ((q + 1) / 4)^{t+1} \bmod{(q - 1)}\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(u = x_{t+1}^{d_1} \bmod p\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(v = x_{t+1}^{d_2} \bmod q\)</span>.</li>
<li>Compute <span class="math notranslate nohighlight">\(x_0 = vap + ubq \bmod n\)</span>.</li>
<li>For <span class="math notranslate nohighlight">\(i\)</span> from 1 to <span class="math notranslate nohighlight">\(t\)</span>, do:<ol class="arabic">
<li>Compute <span class="math notranslate nohighlight">\(x_i = x_{t-1}^2 \bmod n\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(p_i\)</span> be the <span class="math notranslate nohighlight">\(h\)</span> least significant bits of <span class="math notranslate nohighlight">\(x_i\)</span>.</li>
<li>Compute <span class="math notranslate nohighlight">\(m_i = p_i \oplus c_i\)</span>.</li>
</ol>
</li>
<li>The plaintext is <span class="math notranslate nohighlight">\(m = m_1 m_2 \cdots m_t\)</span>.</li>
</ol>
<p>EXAMPLES:</p>
<p>The following decryption example is taken from Example 8.57, pages
309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id6">[MvOV1996]</a>. Here we decrypt a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="mi">139680</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span> <span class="n">K</span>
<span class="go">(499, 547, -57, 52)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">K</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[[1, 0, 0, 1], [1, 1, 0, 0], [0, 0, 0, 1], [0, 0, 0, 0], [1, 1, 0, 0]]</span>
</pre></div>
</div>
<p>Convert the plaintext sub-blocks into a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">10011100000100001100</span>
</pre></div>
</div>
<p>Decrypt a longer ciphertext and convert the resulting plaintext
into an ASCII string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">bin_to_ascii</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">78307</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">412487</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> \
<span class="gp">....: </span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="mi">3479653279</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">bin_to_ascii</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="go">&#39;Blum-Goldwasser encryption&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt">
<code class="descname">encrypt</code><span class="sig-paren">(</span><em>P</em>, <em>K</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.encrypt" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the Blum-Goldwasser scheme to encrypt the plaintext <code class="docutils literal notranslate"><span class="pre">P</span></code> using
the public key <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">P</span></code> – a non-empty string of plaintext. The string <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> is
an empty string, whereas <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> is a string consisting of one
white space character. The plaintext can be a binary string or
a string of ASCII characters. Where <code class="docutils literal notranslate"><span class="pre">P</span></code> is an ASCII string, then
<code class="docutils literal notranslate"><span class="pre">P</span></code> is first encoded as a binary string prior to encryption.</li>
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a public key, which is the product of two Blum primes.</li>
<li><code class="docutils literal notranslate"><span class="pre">seed</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are Blum primes and
<span class="math notranslate nohighlight">\(n = pq\)</span> is a public key, then <code class="docutils literal notranslate"><span class="pre">seed</span></code> is a quadratic residue in
the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. If <code class="docutils literal notranslate"><span class="pre">seed=None</span></code>,
then the function would generate its own random quadratic residue
in <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. Where a value for <code class="docutils literal notranslate"><span class="pre">seed</span></code> is provided,
it is your responsibility to ensure that the seed is a
quadratic residue in the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The ciphertext resulting from encrypting <code class="docutils literal notranslate"><span class="pre">P</span></code> using the public
key <code class="docutils literal notranslate"><span class="pre">K</span></code>. The ciphertext <span class="math notranslate nohighlight">\(C\)</span> is of the form
<span class="math notranslate nohighlight">\(C = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>. Each <span class="math notranslate nohighlight">\(c_i\)</span> is a
sub-block of binary string and <span class="math notranslate nohighlight">\(x_{t+1}\)</span> is the result of the
<span class="math notranslate nohighlight">\(t+1\)</span>-th iteration of the Blum-Blum-Shub algorithm.</li>
</ul>
<p>ALGORITHM:</p>
<p>The Blum-Goldwasser encryption algorithm is described in Algorithm
8.56, page 309 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id7">[MvOV1996]</a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li>Let <span class="math notranslate nohighlight">\(n\)</span> be a public key, where <span class="math notranslate nohighlight">\(n = pq\)</span> is the product of two
distinct Blum primes <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(k = \lfloor \log_2(n) \rfloor\)</span> and
<span class="math notranslate nohighlight">\(h = \lfloor \log_2(k) \rfloor\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(m = m_1 m_2 \cdots m_t\)</span> be the message (plaintext) where
each <span class="math notranslate nohighlight">\(m_i\)</span> is a binary string of length <span class="math notranslate nohighlight">\(h\)</span>.</li>
<li>Choose a random seed <span class="math notranslate nohighlight">\(x_0\)</span>, which is a quadratic residue in
the multiplicative group <span class="math notranslate nohighlight">\((\ZZ/n\ZZ)^{\ast}\)</span>. That is, choose
a random <span class="math notranslate nohighlight">\(r \in (\ZZ/n\ZZ)^{\ast}\)</span> and compute
<span class="math notranslate nohighlight">\(x_0 = r^2 \bmod n\)</span>.</li>
<li>For <span class="math notranslate nohighlight">\(i\)</span> from 1 to <span class="math notranslate nohighlight">\(t\)</span>, do:<ol class="arabic">
<li>Let <span class="math notranslate nohighlight">\(x_i = x_{i-1}^2 \bmod n\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(p_i\)</span> be the <span class="math notranslate nohighlight">\(h\)</span> least significant bits of <span class="math notranslate nohighlight">\(x_i\)</span>.</li>
<li>Let <span class="math notranslate nohighlight">\(c_i = p_i \oplus m_i\)</span>.</li>
</ol>
</li>
<li>Compute <span class="math notranslate nohighlight">\(x_{t+1} = x_t^2 \bmod n\)</span>.</li>
<li>The ciphertext is <span class="math notranslate nohighlight">\(c = (c_1, c_2, \dots, c_t, x_{t+1})\)</span>.</li>
</ol>
<p>The value <span class="math notranslate nohighlight">\(h\)</span> in the algorithm is the sub-block length. If the
binary string representing the message cannot be divided into blocks
of length <span class="math notranslate nohighlight">\(h\)</span> each, then other sub-block lengths would be used
instead. The sub-block lengths to fall back on are in the
following order: 16, 8, 4, 2, 1.</p>
<p>EXAMPLES:</p>
<p>The following encryption example is taken from Example 8.57,
pages 309–310 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id8">[MvOV1996]</a>. Here, we encrypt a binary
string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">499</span><span class="p">;</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">547</span><span class="p">;</span> <span class="n">n</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">q</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;10011100000100001100&quot;</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">159201</span><span class="p">);</span> <span class="n">C</span>
<span class="go">([[0, 0, 1, 0], [0, 0, 0, 0], [1, 1, 0, 0], [1, 1, 1, 0], [0, 1, 0, 0]], 139680)</span>
</pre></div>
</div>
<p>Convert the ciphertext sub-blocks into a binary string:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">bin</span> <span class="o">=</span> <span class="n">BinaryStrings</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">bin</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="go">00100000110011100100</span>
</pre></div>
</div>
<p>Now encrypt an ASCII string. The result is random; no seed is
provided to the encryption function so the function generates its
own random seed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="mi">32300619509</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="s2">&quot;Blum-Goldwasser encryption&quot;</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>  <span class="c1"># random</span>
<span class="go">([[1, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0], \</span>
<span class="go">[1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 1], \</span>
<span class="go">[0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0], \</span>
<span class="go">[0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1], \</span>
<span class="go">[1, 0, 0, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0], \</span>
<span class="go">[0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0], \</span>
<span class="go">[1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1], \</span>
<span class="go">[0, 1, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0], \</span>
<span class="go">[1, 0, 1, 1, 0, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1], \</span>
<span class="go">[1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 0], \</span>
<span class="go">[0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1]], 3479653279)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.private_key">
<code class="descname">private_key</code><span class="sig-paren">(</span><em>p</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.private_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Blum-Goldwasser private key corresponding to the
distinct Blum primes <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – a Blum prime.</li>
<li><code class="docutils literal notranslate"><span class="pre">q</span></code> – a Blum prime.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The Blum-Goldwasser private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> must be distinct Blum primes. Let <span class="math notranslate nohighlight">\(p\)</span> be a
positive prime. Then <span class="math notranslate nohighlight">\(p\)</span> is a Blum prime if <span class="math notranslate nohighlight">\(p\)</span> is congruent to 3
modulo 4, i.e. <span class="math notranslate nohighlight">\(p \equiv 3 \pmod{4}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Obtain two distinct Blum primes and compute the Blum-Goldwasser
private key corresponding to those two Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="go">[False, True, False, True, True, False, False, True, True, False]</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
<span class="go">(19, 23, -6, 5)</span>
</pre></div>
</div>
<p>Choose two distinct random Blum primes, compute the Blum-Goldwasser
private key corresponding to those two primes, and test that the
resulting private key <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> satisfies
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">random_blum_prime</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">q</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">private_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.public_key">
<code class="descname">public_key</code><span class="sig-paren">(</span><em>p</em>, <em>q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.public_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Blum-Goldwasser public key corresponding to the
distinct Blum primes <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – a Blum prime.</li>
<li><code class="docutils literal notranslate"><span class="pre">q</span></code> – a Blum prime.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>The Blum-Goldwasser public key <span class="math notranslate nohighlight">\(n = pq\)</span>.</li>
</ul>
<p>Both <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">q</span></code> must be distinct Blum primes. Let <span class="math notranslate nohighlight">\(p\)</span> be a
positive prime. Then <span class="math notranslate nohighlight">\(p\)</span> is a Blum prime if <span class="math notranslate nohighlight">\(p\)</span> is congruent to 3
modulo 4, i.e. <span class="math notranslate nohighlight">\(p \equiv 3 \pmod{4}\)</span>.</p>
<p>EXAMPLES:</p>
<p>Obtain two distinct Blum primes and compute the Blum-Goldwasser
public key corresponding to those two Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">primes_first_n</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">P</span>
<span class="go">[2, 3, 5, 7, 11, 13, 17, 19, 23, 29]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">P</span><span class="p">]</span>
<span class="go">[False, True, False, True, True, False, False, True, True, False]</span>
<span class="gp">sage: </span><span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">21</span>
</pre></div>
</div>
<p>Choose two distinct random Blum primes, compute the Blum-Goldwasser
public key corresponding to those two primes, and test that the
public key factorizes into Blum primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">random_blum_prime</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">while</span> <span class="n">q</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="n">q</span> <span class="o">=</span> <span class="n">random_blum_prime</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="go">...</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">public_key</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">factor</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]);</span> <span class="n">is_blum_prime</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">*</span> <span class="n">q</span> <span class="o">==</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.random_key">
<code class="descname">random_key</code><span class="sig-paren">(</span><em>lbound</em>, <em>ubound</em>, <em>ntries=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.crypto.public_key.blum_goldwasser.BlumGoldwasser.random_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pair of random public and private keys.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">lbound</span></code> – positive integer; the lower bound on how small each
random Blum prime <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> can be. So we have
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>. The lower bound must
be distinct from the upper bound.</li>
<li><code class="docutils literal notranslate"><span class="pre">ubound</span></code> – positive integer; the upper bound on how large each
random Blum prime <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> can be. So we have
<code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">lower_bound</span> <span class="pre">&lt;=</span> <span class="pre">p,</span> <span class="pre">q</span> <span class="pre">&lt;=</span> <span class="pre">upper_bound</span></code>. The lower bound must
be distinct from the upper bound.</li>
<li><code class="docutils literal notranslate"><span class="pre">ntries</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">100</span></code>) the number of attempts to generate
a random public/private key pair. If <code class="docutils literal notranslate"><span class="pre">ntries</span></code> is a positive
integer, then perform that many attempts at generating a random
public/private key pair.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A random public key and its corresponding private key. Each
randomly chosen <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are guaranteed to be Blum primes. The
public key is <span class="math notranslate nohighlight">\(n = pq\)</span>, and the private key is <span class="math notranslate nohighlight">\((p, q, a, b)\)</span> where
<span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</li>
</ul>
<p>ALGORITHM:</p>
<p>The key generation algorithm is described in Algorithm 8.55,
page 308 of <a class="reference internal" href="../../../../references/index.html#mvov1996" id="id9">[MvOV1996]</a>. The algorithm works as follows:</p>
<ol class="arabic simple">
<li>Let <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> be distinct large random primes, each congruent
to 3 modulo 4. That is, <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are Blum primes.</li>
<li>Let <span class="math notranslate nohighlight">\(n = pq\)</span> be the product of <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span>.</li>
<li>Use the extended Euclidean algorithm to compute integers <span class="math notranslate nohighlight">\(a\)</span> and
<span class="math notranslate nohighlight">\(b\)</span> such that <span class="math notranslate nohighlight">\(\gcd(p, q) = ap + bq = 1\)</span>.</li>
<li>The public key is <span class="math notranslate nohighlight">\(n\)</span> and the corresponding private key is
<span class="math notranslate nohighlight">\((p, q, a, b)\)</span>.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Beware that there might not be any primes between the lower and
upper bounds. So make sure that these two bounds are
“sufficiently” far apart from each other for there to be primes
congruent to 3 modulo 4. In particular, there should
be at least two distinct primes within these bounds, each prime
being congruent to 3 modulo 4.</p>
</div>
<p>EXAMPLES:</p>
<p>Choosing a random pair of public and private keys. We then test to see
if they satisfy the requirements of the Blum-Goldwasser scheme:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.public_key.blum_goldwasser</span> <span class="kn">import</span> <span class="n">BlumGoldwasser</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.crypto.util</span> <span class="kn">import</span> <span class="n">is_blum_prime</span>
<span class="gp">sage: </span><span class="n">bg</span> <span class="o">=</span> <span class="n">BlumGoldwasser</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">pubkey</span><span class="p">,</span> <span class="n">prikey</span> <span class="o">=</span> <span class="n">bg</span><span class="o">.</span><span class="n">random_key</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">prikey</span>
<span class="gp">sage: </span><span class="n">is_blum_prime</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">is_blum_prime</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="go">True</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">==</span> <span class="n">q</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">pubkey</span> <span class="o">==</span> <span class="n">p</span><span class="o">*</span><span class="n">q</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">gcd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">*</span><span class="n">p</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">q</span> <span class="o">==</span> <span class="mi">1</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../block_cipher/present.html"
                        title="previous chapter">PRESENT</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../stream.html"
                        title="next chapter">Stream Cryptosystems</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/crypto/public_key/blum_goldwasser.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../stream.html" title="Stream Cryptosystems"
             >next</a> |</li>
        <li class="right" >
          <a href="../block_cipher/present.html" title="PRESENT"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Cryptography</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>