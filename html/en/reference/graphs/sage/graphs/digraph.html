
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Directed graphs &#8212; Sage Reference Manual v8.5: Graph Theory</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Bipartite graphs" href="bipartite_graph.html" />
    <link rel="prev" title="Undirected graphs" href="graph.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartite_graph.html" title="Bipartite graphs"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Graph Theory</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="directed-graphs">
<span id="sage-graphs-digraph"></span><h1>Directed graphs<a class="headerlink" href="#directed-graphs" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="module-sage.graphs.digraph"></span><p>This module implements functions and operations involving directed
graphs. Here is what they can do</p>
<p><strong>Graph basic operations:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_acyclic_dummy()</span></code></a></td>
<td>Compute a (dummy) ranked layout so that all edges point upward.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic" title="sage.graphs.digraph.DiGraph.layout_acyclic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_acyclic()</span></code></a></td>
<td>Compute a ranked layout so that all edges point upward.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse" title="sage.graphs.digraph.DiGraph.reverse"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reverse()</span></code></a></td>
<td>Return a copy of digraph with edges reversed in direction.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reverse_edge()</span></code></a></td>
<td>Reverse an edge.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edges" title="sage.graphs.digraph.DiGraph.reverse_edges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reverse_edges()</span></code></a></td>
<td>Reverse a list of edges.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree_sequence" title="sage.graphs.digraph.DiGraph.out_degree_sequence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">out_degree_sequence()</span></code></a></td>
<td>Return the outdegree sequence.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree_iterator" title="sage.graphs.digraph.DiGraph.out_degree_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">out_degree_iterator()</span></code></a></td>
<td>Same as degree_iterator, but for out degree.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.out_degree" title="sage.graphs.digraph.DiGraph.out_degree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">out_degree()</span></code></a></td>
<td>Same as degree, but for out degree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree_sequence" title="sage.graphs.digraph.DiGraph.in_degree_sequence"><code class="xref py py-meth docutils literal notranslate"><span class="pre">in_degree_sequence()</span></code></a></td>
<td>Return the indegree sequence of this digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree_iterator" title="sage.graphs.digraph.DiGraph.in_degree_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">in_degree_iterator()</span></code></a></td>
<td>Same as degree_iterator, but for in degree.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.in_degree" title="sage.graphs.digraph.DiGraph.in_degree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">in_degree()</span></code></a></td>
<td>Same as degree, but for in-degree.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbors_out" title="sage.graphs.digraph.DiGraph.neighbors_out"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neighbors_out()</span></code></a></td>
<td>Return the list of the out-neighbors of a given vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="sage.graphs.digraph.DiGraph.neighbor_out_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neighbor_out_iterator()</span></code></a></td>
<td>Return an iterator over the out-neighbors of a given vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbors_in" title="sage.graphs.digraph.DiGraph.neighbors_in"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neighbors_in()</span></code></a></td>
<td>Return the list of the in-neighbors of a given vertex.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.neighbor_in_iterator" title="sage.graphs.digraph.DiGraph.neighbor_in_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">neighbor_in_iterator()</span></code></a></td>
<td>Return an iterator over the in-neighbors of vertex.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.outgoing_edges" title="sage.graphs.digraph.DiGraph.outgoing_edges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">outgoing_edges()</span></code></a></td>
<td>Return a list of edges departing from vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.outgoing_edge_iterator" title="sage.graphs.digraph.DiGraph.outgoing_edge_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">outgoing_edge_iterator()</span></code></a></td>
<td>Return an iterator over all departing edges from vertices</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.incoming_edges" title="sage.graphs.digraph.DiGraph.incoming_edges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">incoming_edges()</span></code></a></td>
<td>Return a list of edges arriving at vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.incoming_edge_iterator" title="sage.graphs.digraph.DiGraph.incoming_edge_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">incoming_edge_iterator()</span></code></a></td>
<td>Return an iterator over all arriving edges from vertices</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.sources" title="sage.graphs.digraph.DiGraph.sources"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sources()</span></code></a></td>
<td>Return the list of all sources (vertices without incoming edges) of this digraph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.sinks" title="sage.graphs.digraph.DiGraph.sinks"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sinks()</span></code></a></td>
<td>Return the list of all sinks (vertices without outgoing edges) of this digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.to_undirected" title="sage.graphs.digraph.DiGraph.to_undirected"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_undirected()</span></code></a></td>
<td>Return an undirected version of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.to_directed" title="sage.graphs.digraph.DiGraph.to_directed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_directed()</span></code></a></td>
<td>Since the graph is already directed, simply returns a copy of itself.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed" title="sage.graphs.digraph.DiGraph.is_directed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_directed()</span></code></a></td>
<td>Since digraph is directed, returns True.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.dig6_string" title="sage.graphs.digraph.DiGraph.dig6_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dig6_string()</span></code></a></td>
<td>Return the <code class="docutils literal notranslate"><span class="pre">dig6</span></code> representation of the digraph as an ASCII string.</td>
</tr>
</tbody>
</table>
<p><strong>Paths and cycles:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_paths_iterator" title="sage.graphs.digraph.DiGraph.all_paths_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_paths_iterator()</span></code></a></td>
<td>Return an iterator over the paths of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="sage.graphs.digraph.DiGraph.all_simple_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_simple_paths()</span></code></a></td>
<td>Return a list of all the simple paths of <code class="docutils literal notranslate"><span class="pre">self</span></code> starting with one of the given vertices.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_cycles_iterator" title="sage.graphs.digraph.DiGraph.all_cycles_iterator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_cycles_iterator()</span></code></a></td>
<td>Return an iterator over all the cycles of <code class="docutils literal notranslate"><span class="pre">self</span></code> starting with one of the given vertices.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_simple_cycles()</span></code></a></td>
<td>Return a list of all simple cycles of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</td>
</tr>
</tbody>
</table>
<p><strong>Representation theory:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.path_semigroup" title="sage.graphs.digraph.DiGraph.path_semigroup"><code class="xref py py-meth docutils literal notranslate"><span class="pre">path_semigroup()</span></code></a></td>
<td>Return the (partial) semigroup formed by the paths of the digraph.</td>
</tr>
</tbody>
</table>
<p><strong>Connectivity:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_strongly_connected" title="sage.graphs.digraph.DiGraph.is_strongly_connected"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_strongly_connected()</span></code></a></td>
<td>Check whether the current <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> is strongly connected.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_digraph" title="sage.graphs.digraph.DiGraph.strongly_connected_components_digraph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components_digraph()</span></code></a></td>
<td>Return the digraph of the strongly connected components</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs" title="sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components_subgraphs()</span></code></a></td>
<td>Return the strongly connected components as a list of subgraphs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex" title="sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_component_containing_vertex()</span></code></a></td>
<td>Return the strongly connected component containing a given vertex</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="sage.graphs.digraph.DiGraph.strongly_connected_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components()</span></code></a></td>
<td>Return the list of strongly connected components.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.immediate_dominators" title="sage.graphs.digraph.DiGraph.immediate_dominators"><code class="xref py py-meth docutils literal notranslate"><span class="pre">immediate_dominators()</span></code></a></td>
<td>Return the immediate dominators of all vertices reachable from <span class="math notranslate nohighlight">\(root\)</span>.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strong_articulation_points" title="sage.graphs.digraph.DiGraph.strong_articulation_points"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strong_articulation_points()</span></code></a></td>
<td>Return the strong articulation points of this digraph.</td>
</tr>
</tbody>
</table>
<p><strong>Acyclicity:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="sage.graphs.digraph.DiGraph.is_directed_acyclic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_directed_acyclic()</span></code></a></td>
<td>Check whether the digraph is acyclic or not.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_transitive" title="sage.graphs.digraph.DiGraph.is_transitive"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_transitive()</span></code></a></td>
<td>Check whether the digraph is transitive or not.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="sage.graphs.digraph.DiGraph.is_aperiodic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_aperiodic()</span></code></a></td>
<td>Check whether the digraph is aperiodic or not.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_tournament" title="sage.graphs.digraph.DiGraph.is_tournament"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_tournament()</span></code></a></td>
<td>Check whether the digraph is a tournament.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.period" title="sage.graphs.digraph.DiGraph.period"><code class="xref py py-meth docutils literal notranslate"><span class="pre">period()</span></code></a></td>
<td>Return the period of the digraph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">level_sets()</span></code></a></td>
<td>Return the level set decomposition of the digraph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.topological_sort_generator" title="sage.graphs.digraph.DiGraph.topological_sort_generator"><code class="xref py py-meth docutils literal notranslate"><span class="pre">topological_sort_generator()</span></code></a></td>
<td>Return a list of all topological sorts of the digraph if it is acyclic</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.topological_sort" title="sage.graphs.digraph.DiGraph.topological_sort"><code class="xref py py-meth docutils literal notranslate"><span class="pre">topological_sort()</span></code></a></td>
<td>Return a topological sort of the digraph if it is acyclic</td>
</tr>
</tbody>
</table>
<p><strong>Hard stuff:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.feedback_edge_set" title="sage.graphs.digraph.DiGraph.feedback_edge_set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">feedback_edge_set()</span></code></a></td>
<td>Compute the minimum feedback edge (arc) set of a digraph</td>
</tr>
</tbody>
</table>
<p><strong>Miscellanous:</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.flow_polytope" title="sage.graphs.digraph.DiGraph.flow_polytope"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flow_polytope()</span></code></a></td>
<td>Compute the flow polytope of a digraph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.digraph.DiGraph.degree_polynomial" title="sage.graphs.digraph.DiGraph.degree_polynomial"><code class="xref py py-meth docutils literal notranslate"><span class="pre">degree_polynomial()</span></code></a></td>
<td>Return the generating polynomial of degrees of vertices in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</td>
</tr>
</tbody>
</table>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">Â¶</a></h2>
<dl class="class">
<dt id="sage.graphs.digraph.DiGraph">
<em class="property">class </em><code class="descclassname">sage.graphs.digraph.</code><code class="descname">DiGraph</code><span class="sig-paren">(</span><em>data=None</em>, <em>pos=None</em>, <em>loops=None</em>, <em>format=None</em>, <em>weighted=None</em>, <em>implementation='c_graph'</em>, <em>data_structure='sparse'</em>, <em>vertex_labels=True</em>, <em>name=None</em>, <em>multiedges=None</em>, <em>convert_empty_dict_labels_to_None=None</em>, <em>sparse=True</em>, <em>immutable=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph" title="sage.graphs.generic_graph.GenericGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph</span></code></a></p>
<p>Directed graph.</p>
<p>A digraph or directed graph is a set of vertices connected by oriented
edges. See also the <a class="reference external" href="https://en.wikipedia.org/wiki/Directed_graph">Wikipedia article Directed_graph</a>. For a collection of
pre-defined digraphs, see the <a class="reference internal" href="digraph_generators.html#module-sage.graphs.digraph_generators" title="sage.graphs.digraph_generators"><code class="xref py py-mod docutils literal notranslate"><span class="pre">digraph_generators</span></code></a> module.</p>
<p>A <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiGraph</span></code></a> object has many methods whose list can be obtained by
typing <code class="docutils literal notranslate"><span class="pre">g.&lt;tab&gt;</span></code> (i.e. hit the âtabâ key) or by reading the documentation
of <a class="reference internal" href="#module-sage.graphs.digraph" title="sage.graphs.digraph"><code class="xref py py-mod docutils literal notranslate"><span class="pre">digraph</span></code></a>, <a class="reference internal" href="generic_graph.html#module-sage.graphs.generic_graph" title="sage.graphs.generic_graph"><code class="xref py py-mod docutils literal notranslate"><span class="pre">generic_graph</span></code></a>, and
<a class="reference internal" href="graph.html#module-sage.graphs.graph" title="sage.graphs.graph"><code class="xref py py-mod docutils literal notranslate"><span class="pre">graph</span></code></a>.</p>
<p>INPUT:</p>
<p>By default, a <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiGraph</span></code></a> object is simple (i.e. no <em>loops</em> nor
<em>multiple edges</em>) and unweighted. This can be easily tuned with the
appropriate flags (see below).</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">data</span></code> â can be any of the following (see the <code class="docutils literal notranslate"><span class="pre">format</span></code> argument):</p>
<ol class="arabic">
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph()</span></code> â build a digraph on 0 vertices</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph(5)</span></code> â return an edgeless digraph on the 5 vertices 0,â¦,4</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph([list_of_vertices,</span> <span class="pre">list_of_edges])</span></code> â return a digraph with
given vertices/edges</p>
<p>To bypass auto-detection, prefer the more explicit
<code class="docutils literal notranslate"><span class="pre">DiGraph([V,</span> <span class="pre">E],</span> <span class="pre">format='vertices_and_edges')</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph(list_of_edges)</span></code> â return a digraph with a given list of
edges (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.add_edges" title="sage.graphs.generic_graph.GenericGraph.add_edges"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_edges()</span></code></a>).</p>
<p>To bypass auto-detection, prefer the more explicit
<code class="docutils literal notranslate"><span class="pre">DiGraph(L,</span> <span class="pre">format='list_of_edges')</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph({1:</span> <span class="pre">[2,3,4],</span> <span class="pre">3:</span> <span class="pre">[4]})</span></code> â return a digraph by associating to
each vertex the list of its out-neighbors.</p>
<p>To bypass auto-detection, prefer the more explicit
<code class="docutils literal notranslate"><span class="pre">DiGraph(D,</span> <span class="pre">format='dict_of_lists')</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph({1:</span> <span class="pre">{2:</span> <span class="pre">'a',</span> <span class="pre">3:</span> <span class="pre">'b'},</span> <span class="pre">3:</span> <span class="pre">{2:</span> <span class="pre">'c'}})</span></code> â return a digraph by
associating a list of out-neighbors to each vertex and providing its
edge label.</p>
<p>To bypass auto-detection, prefer the more explicit
<code class="docutils literal notranslate"><span class="pre">DiGraph(D,</span> <span class="pre">format='dict_of_dicts')</span></code>.</p>
<p>For digraphs with multiple edges, you can provide a list of labels
instead, e.g.: <code class="docutils literal notranslate"><span class="pre">DiGraph({1:</span> <span class="pre">{2:</span> <span class="pre">['a1',</span> <span class="pre">'a2'],</span> <span class="pre">3:['b']},</span>
<span class="pre">3:{2:['c']}})</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph(a_matrix)</span></code> â return a digraph with given (weighted)
adjacency matrix (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.adjacency_matrix" title="sage.graphs.generic_graph.GenericGraph.adjacency_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">adjacency_matrix()</span></code></a>).</p>
<p>To bypass auto-detection, prefer the more explicit <code class="docutils literal notranslate"><span class="pre">DiGraph(M,</span>
<span class="pre">format='adjacency_matrix')</span></code>. To take weights into account, use
<code class="docutils literal notranslate"><span class="pre">format='weighted_adjacency_matrix'</span></code> instead.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph(a_nonsquare_matrix)</span></code> â return a digraph with given
incidence matrix (see documentation of
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.incidence_matrix" title="sage.graphs.generic_graph.GenericGraph.incidence_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">incidence_matrix()</span></code></a>).</p>
<p>To bypass auto-detection, prefer the more explicit <code class="docutils literal notranslate"><span class="pre">DiGraph(M,</span>
<span class="pre">format='incidence_matrix')</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph([V,</span> <span class="pre">f])</span></code> â return a digraph with a vertex set <code class="docutils literal notranslate"><span class="pre">V</span></code> and an
edge <span class="math notranslate nohighlight">\(u,v\)</span> whenever <span class="math notranslate nohighlight">\(f(u, v)\)</span> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Example: <code class="docutils literal notranslate"><span class="pre">DiGraph([</span>
<span class="pre">[1..10],</span> <span class="pre">lambda</span> <span class="pre">x,y:</span> <span class="pre">abs(x</span> <span class="pre">-</span> <span class="pre">y).is_square()])</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph('FOC&#64;?OC&#64;_?')</span></code> â return a digraph from a <code class="docutils literal notranslate"><span class="pre">dig6</span></code> string
(see documentation of <a class="reference internal" href="#sage.graphs.digraph.DiGraph.dig6_string" title="sage.graphs.digraph.DiGraph.dig6_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dig6_string()</span></code></a>).</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">DiGraph(another_digraph)</span></code> â return a digraph from a Sage (di)graph,
<a class="reference external" href="https://pygraphviz.github.io/">pygraphviz</a> digraph, <a class="reference external" href="https://networkx.github.io/">NetworkX</a> digraph, or <a class="reference external" href="http://igraph.org/python/">igraph</a> digraph.</p>
</li>
</ol>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pos</span></code> â dict (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a positioning dictionary. For
example, the spring layout from NetworkX for the 5-cycle is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.91679746</span><span class="p">,</span> <span class="mf">0.88169588</span><span class="p">],</span>
 <span class="mi">1</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.47294849</span><span class="p">,</span> <span class="mf">1.125</span>     <span class="p">],</span>
 <span class="mi">2</span><span class="p">:</span> <span class="p">[</span> <span class="mf">1.125</span>     <span class="p">,</span><span class="o">-</span><span class="mf">0.12867615</span><span class="p">],</span>
 <span class="mi">3</span><span class="p">:</span> <span class="p">[</span> <span class="mf">0.12743933</span><span class="p">,</span><span class="o">-</span><span class="mf">1.125</span>     <span class="p">],</span>
 <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.125</span>     <span class="p">,</span><span class="o">-</span><span class="mf">0.50118505</span><span class="p">]}</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); gives the graph a name (e.g.,
name=âcompleteâ)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">loops</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); whether to allow loops (ignored
if data is an instance of the DiGraph class)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">multiedges</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); whether to allow multiple
edges (ignored if data is an instance of the DiGraph class)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">weighted</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); whether digraph thinks of
itself as weighted or not. See <code class="docutils literal notranslate"><span class="pre">self.weighted()</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">format</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiGraph</span></code></a> tries to guess inputâs format. To avoid this possibly
time-consuming step, one of the following values can be specified (see
description above): <code class="docutils literal notranslate"><span class="pre">&quot;int&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;dig6&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;rule&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;list_of_edges&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;dict_of_lists&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;dict_of_dicts&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;adjacency_matrix&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;weighted_adjacency_matrix&quot;</span></code>,
<code class="docutils literal notranslate"><span class="pre">&quot;incidence_matrix&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;NX&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;igraph&quot;</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">sparse</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); <code class="docutils literal notranslate"><span class="pre">sparse=True</span></code> is an alias for
<code class="docutils literal notranslate"><span class="pre">data_structure=&quot;sparse&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">sparse=False</span></code> is an alias for
<code class="docutils literal notranslate"><span class="pre">data_structure=&quot;dense&quot;</span></code></p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">data_structure</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">&quot;sparse&quot;</span></code>); one of the following
(for more information, see <a class="reference internal" href="base/overview.html#module-sage.graphs.base.overview" title="sage.graphs.base.overview"><code class="xref py py-mod docutils literal notranslate"><span class="pre">overview</span></code></a>):</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">&quot;dense&quot;</span></code> â selects the <a class="reference internal" href="base/dense_graph.html#module-sage.graphs.base.dense_graph" title="sage.graphs.base.dense_graph"><code class="xref py py-mod docutils literal notranslate"><span class="pre">dense_graph</span></code></a> backend</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;sparse&quot;</span></code> â selects the <a class="reference internal" href="base/sparse_graph.html#module-sage.graphs.base.sparse_graph" title="sage.graphs.base.sparse_graph"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sparse_graph</span></code></a>
backend</li>
<li><code class="docutils literal notranslate"><span class="pre">&quot;static_sparse&quot;</span></code> â selects the
<a class="reference internal" href="base/static_sparse_backend.html#module-sage.graphs.base.static_sparse_backend" title="sage.graphs.base.static_sparse_backend"><code class="xref py py-mod docutils literal notranslate"><span class="pre">static_sparse_backend</span></code></a> (this backend is faster
than the sparse backend and smaller in memory, and it is immutable, so
that the resulting graphs can be used as dictionary keys).</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">immutable</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to create a
immutable digraph. Note that <code class="docutils literal notranslate"><span class="pre">immutable=True</span></code> is actually a shortcut for
<code class="docutils literal notranslate"><span class="pre">data_structure='static_sparse'</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">vertex_labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to allow any
object as a vertex (slower), or only the integers <span class="math notranslate nohighlight">\(0,...,n-1\)</span>, where <span class="math notranslate nohighlight">\(n\)</span>
is the number of vertices.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">convert_empty_dict_labels_to_None</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); this
arguments sets the default edge labels used by NetworkX (empty
dictionaries) to be replaced by <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default Sage edge label. It
is set to <code class="docutils literal notranslate"><span class="pre">True</span></code> iff a NetworkX graph is on the input.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<ol class="arabic">
<li><p class="first">A dictionary of dictionaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">5</span><span class="p">:</span> <span class="s1">&#39;out&#39;</span><span class="p">}});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
<p>The labels (âxâ, âzâ, âaâ, âoutâ) are labels for edges. For example,
âoutâ is the label for the edge from 2 to 5. Labels can be used as
weights, if all the labels share some common parent.</p>
</li>
<li><p class="first">A dictionary of lists (or iterables):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)});</span> <span class="n">g</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">A list of vertices and a function describing adjacencies. Note that the
list of vertices and the function must be enclosed in a list (i.e.,
<code class="docutils literal notranslate"><span class="pre">[list</span> <span class="pre">of</span> <span class="pre">vertices,</span> <span class="pre">function]</span></code>).</p>
<p>We construct a graph on the integers 1 through 12 such that there is a
directed edge from <span class="math notranslate nohighlight">\(i\)</span> to <span class="math notranslate nohighlight">\(j\)</span> if and only if <span class="math notranslate nohighlight">\(i\)</span> divides <span class="math notranslate nohighlight">\(j\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mf">1.</span><span class="o">.</span><span class="mi">12</span><span class="p">],</span> <span class="k">lambda</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">:</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">j</span> <span class="ow">and</span> <span class="n">i</span><span class="o">.</span><span class="n">divides</span><span class="p">(</span><span class="n">j</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">()</span>
<span class="go">[0 1 1 1 1 1 1 1 1 1 1 1]</span>
<span class="go">[0 0 0 1 0 1 0 1 0 1 0 1]</span>
<span class="go">[0 0 0 0 0 1 0 0 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0]</span>
</pre></div>
</div>
</li>
<li><p class="first">A Sage matrix: Note: If format is not specified, then Sage assumes a
square matrix is an adjacency matrix, and a nonsquare matrix is an
incidence matrix.</p>
<ul>
<li><p class="first">an adjacency matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[0 1 1 1 0]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="go">[0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>

<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[   0    1   -1]</span>
<span class="go">[  -1    0 -1/2]</span>
<span class="go">[   1  1/2    0]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">sparse</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">);</span> <span class="n">G</span>
<span class="go">Digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first">an incidence matrix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]);</span> <span class="n">M</span>
<span class="go">[-1  0  0  0  1]</span>
<span class="go">[ 1 -1  0  0  0]</span>
<span class="go">[ 0  1 -1  0  0]</span>
<span class="go">[ 0  0  1 -1  0]</span>
<span class="go">[ 0  0  0  1 -1]</span>
<span class="go">[ 0  0  0  0  0]</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">Digraph on 6 vertices</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p class="first">A <code class="docutils literal notranslate"><span class="pre">dig6</span></code> string: Sage automatically recognizes whether a string is in
<code class="docutils literal notranslate"><span class="pre">dig6</span></code> format, which is a directed version of <code class="docutils literal notranslate"><span class="pre">graph6</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s1">&#39;IRAaDCIIOWEOKcPWAo&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Digraph on 10 vertices</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s1">&#39;IRAaDCIIOEOKcPWAo&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">the string (IRAaDCIIOEOKcPWAo) seems corrupt: for n = 10, the string is too short</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="s2">&quot;IRAaDCI&#39;OWEOKcPWAo&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">the string seems corrupt: valid characters are</span>
<span class="go">?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz{|}~</span>
</pre></div>
</div>
</li>
<li><p class="first">A NetworkX XDiGraph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">A NetworkX digraph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">networkx</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">networkx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">Digraph on 5 vertices</span>
</pre></div>
</div>
</li>
<li><p class="first">An igraph directed Graph (see also
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.igraph_graph" title="sage.graphs.generic_graph.GenericGraph.igraph_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">igraph_graph()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">igraph</span>                                  <span class="c1"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c1"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>                                     <span class="c1"># optional - python_igraph</span>
<span class="go">Digraph on 3 vertices</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">vertex_labels</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the names of the vertices are given by
the vertex attribute <code class="docutils literal notranslate"><span class="pre">'name'</span></code>, if available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]})</span>  <span class="c1"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                                                                <span class="c1"># optional - python_igraph</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">vertex_attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">]})</span> <span class="c1"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>                                                                <span class="c1"># optional - python_igraph</span>
<span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<p>If the igraph Graph has edge attributes, they are used as edge labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">igraph</span><span class="o">.</span><span class="n">Graph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)],</span> <span class="n">directed</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">edge_attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;weight&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]})</span> <span class="c1"># optional - python_igraph</span>
<span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>                                                                            <span class="c1"># optional - python_igraph</span>
<span class="go">[(0, 1, {&#39;name&#39;: &#39;a&#39;, &#39;weight&#39;: 1}), (0, 2, {&#39;name&#39;: &#39;b&#39;, &#39;weight&#39;: 3})]</span>
</pre></div>
</div>
</li>
</ol>
<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_cycles_iterator">
<code class="descname">all_cycles_iterator</code><span class="sig-paren">(</span><em>starting_vertices=None</em>, <em>simple=False</em>, <em>rooted=False</em>, <em>max_length=None</em>, <em>trivial=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_cycles_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over all the cycles of <code class="docutils literal notranslate"><span class="pre">self</span></code> starting with one of
the given vertices.</p>
<p>The cycles are enumerated in increasing length order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">starting_vertices</span></code> â iterable (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); vertices from
which the cycles must start. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices of the
graph can be starting points. This argument is necessary if <code class="docutils literal notranslate"><span class="pre">rooted</span></code>
is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">simple</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
only simple cycles are considered. A cycle is simple if the only
vertex occuring twice in it is the starting and ending one.</li>
<li><code class="docutils literal notranslate"><span class="pre">rooted</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to False, then
cycles differing only by their starting vertex are considered the same
(e.g. <code class="docutils literal notranslate"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c',</span> <span class="pre">'a']</span></code> and <code class="docutils literal notranslate"><span class="pre">['b',</span> <span class="pre">'c',</span> <span class="pre">'a',</span>
<span class="pre">'b']</span></code>). Otherwise, all cycles are enumerated.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_length</span></code> â non negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the
maximum length of the enumerated paths. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all
lengths are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">trivial</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>iterator</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_simple_cycles()</span></code></a></li>
</ul>
</div>
<p>AUTHOR:</p>
<blockquote>
<div>Alexandre Blondin Masse</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">))</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
</pre></div>
</div>
<p>There are no cycles in the empty graph and in acyclic graphs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>It is possible to restrict the starting vertices of the cycles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">))</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]</span>
</pre></div>
</div>
<p>Also, one can bound the length of the cycles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
</pre></div>
</div>
<p>By default, cycles differing only by their starting point are not all
enumerated, but this may be parametrized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;]]</span>
</pre></div>
</div>
<p>One may prefer to enumerate simple cycles, i.e. cycles such that the only
vertex occuring twice in it is the starting and ending one (see also
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="sage.graphs.digraph.DiGraph.all_simple_cycles"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_simple_cycles()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">all_cycles_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">[[0, 1, 2, 3, 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_paths_iterator">
<code class="descname">all_paths_iterator</code><span class="sig-paren">(</span><em>starting_vertices=None</em>, <em>ending_vertices=None</em>, <em>simple=False</em>, <em>max_length=None</em>, <em>trivial=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_paths_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over the paths of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>The paths are enumerated in increasing length order.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">starting_vertices</span></code> â iterable (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); vertices from
which the paths must start. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices of the
graph can be starting points.</li>
<li><code class="docutils literal notranslate"><span class="pre">ending_vertices</span></code> â iterable (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); allowed ending
vertices of the paths. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">simple</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
only simple paths are considered. Simple paths are paths in which no
two arcs share a head or share a tail, i.e. every vertex in the path
is entered at most once and exited at most once.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_length</span></code> â non negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the
maximum length of the enumerated paths. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all
lengths are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">trivial</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>iterator</div></blockquote>
<p>AUTHOR:</p>
<blockquote>
<div>Alexandre Blondin Masse</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;b&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;c&#39;, &#39;d&#39;]</span>
<span class="go">[&#39;d&#39;, &#39;c&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>It is possible to precise the allowed starting and/or ending vertices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="k">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">pi</span><span class="p">))</span>
<span class="go">[&#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
<span class="go">[&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;]</span>
</pre></div>
</div>
<p>One may prefer to enumerate only simple paths (see
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="sage.graphs.digraph.DiGraph.all_simple_paths"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_simple_paths()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>Or simply bound the length of the enumerated paths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="n">max_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;a&#39;, &#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>By default, empty paths are not enumerated, but it may be parametrized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;], [&#39;b&#39;], [&#39;c&#39;], [&#39;d&#39;], [&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;],</span>
<span class="go"> [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;], [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">pi</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">all_paths_iterator</span><span class="p">(</span><span class="n">simple</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_simple_cycles">
<code class="descname">all_simple_cycles</code><span class="sig-paren">(</span><em>starting_vertices=None</em>, <em>rooted=False</em>, <em>max_length=None</em>, <em>trivial=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_simple_cycles" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of all simple cycles of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">starting_vertices</span></code> â iterable (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); vertices from
which the cycles must start. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices of the
graph can be starting points. This argument is necessary if <code class="docutils literal notranslate"><span class="pre">rooted</span></code>
is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">rooted</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to False, then
cycles differing only by their starting vertex are considered the same
(e.g. <code class="docutils literal notranslate"><span class="pre">['a',</span> <span class="pre">'b',</span> <span class="pre">'c',</span> <span class="pre">'a']</span></code> and <code class="docutils literal notranslate"><span class="pre">['b',</span> <span class="pre">'c',</span> <span class="pre">'a',</span>
<span class="pre">'b']</span></code>). Otherwise, all cycles are enumerated.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_length</span></code> â non negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the
maximum length of the enumerated paths. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all
lengths are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">trivial</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the number of simple cycles of a finite graph is always
finite, computing all its cycles may take a very long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">()</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>The directed version of the Petersen graph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 4, 0], [0, 5, 0], [1, 2, 1], [1, 6, 1], [2, 3, 2],</span>
<span class="go"> [2, 7, 2], [3, 8, 3], [3, 4, 3], [4, 9, 4], [5, 8, 5], [5, 7, 5],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [7, 9, 7]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 4, 0], [0, 5, 0], [1, 2, 1], [1, 6, 1], [2, 3, 2],</span>
<span class="go"> [2, 7, 2], [3, 8, 3], [3, 4, 3], [4, 9, 4], [5, 8, 5], [5, 7, 5],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [7, 9, 7], [0, 1, 2, 3, 4, 0],</span>
<span class="go"> [0, 1, 2, 7, 5, 0], [0, 1, 6, 8, 5, 0], [0, 1, 6, 9, 4, 0],</span>
<span class="go"> [0, 4, 9, 6, 1, 0], [0, 4, 9, 7, 5, 0], [0, 4, 3, 8, 5, 0],</span>
<span class="go"> [0, 4, 3, 2, 1, 0], [0, 5, 8, 3, 4, 0], [0, 5, 8, 6, 1, 0],</span>
<span class="go"> [0, 5, 7, 9, 4, 0], [0, 5, 7, 2, 1, 0], [1, 2, 3, 8, 6, 1],</span>
<span class="go"> [1, 2, 7, 9, 6, 1], [1, 6, 8, 3, 2, 1], [1, 6, 9, 7, 2, 1],</span>
<span class="go"> [2, 3, 8, 5, 7, 2], [2, 3, 4, 9, 7, 2], [2, 7, 9, 4, 3, 2],</span>
<span class="go"> [2, 7, 5, 8, 3, 2], [3, 8, 6, 9, 4, 3], [3, 4, 9, 6, 8, 3],</span>
<span class="go"> [5, 8, 6, 9, 7, 5], [5, 7, 9, 6, 8, 5], [0, 1, 2, 3, 8, 5, 0],</span>
<span class="go"> [0, 1, 2, 7, 9, 4, 0], [0, 1, 6, 8, 3, 4, 0],</span>
<span class="go"> [0, 1, 6, 9, 7, 5, 0], [0, 4, 9, 6, 8, 5, 0],</span>
<span class="go"> [0, 4, 9, 7, 2, 1, 0], [0, 4, 3, 8, 6, 1, 0],</span>
<span class="go"> [0, 4, 3, 2, 7, 5, 0], [0, 5, 8, 3, 2, 1, 0],</span>
<span class="go"> [0, 5, 8, 6, 9, 4, 0], [0, 5, 7, 9, 6, 1, 0],</span>
<span class="go"> [0, 5, 7, 2, 3, 4, 0], [1, 2, 3, 4, 9, 6, 1],</span>
<span class="go"> [1, 2, 7, 5, 8, 6, 1], [1, 6, 8, 5, 7, 2, 1],</span>
<span class="go"> [1, 6, 9, 4, 3, 2, 1], [2, 3, 8, 6, 9, 7, 2],</span>
<span class="go"> [2, 7, 9, 6, 8, 3, 2], [3, 8, 5, 7, 9, 4, 3],</span>
<span class="go"> [3, 4, 9, 7, 5, 8, 3]]</span>
</pre></div>
</div>
<p>The complete graph (without loops) on <span class="math notranslate nohighlight">\(4\)</span> vertices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">()</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 2, 1], [1, 3, 1], [2, 3, 2],</span>
<span class="go"> [0, 1, 2, 0], [0, 1, 3, 0], [0, 2, 1, 0], [0, 2, 3, 0],</span>
<span class="go"> [0, 3, 1, 0], [0, 3, 2, 0], [1, 2, 3, 1], [1, 3, 2, 1],</span>
<span class="go"> [0, 1, 2, 3, 0], [0, 1, 3, 2, 0], [0, 2, 1, 3, 0],</span>
<span class="go"> [0, 2, 3, 1, 0], [0, 3, 1, 2, 0], [0, 3, 2, 1, 0]]</span>
</pre></div>
</div>
<p>If the graph contains a large number of cycles, one can bound the length
of the cycles, or simply restrict the possible starting vertices of the
cycles:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [0, 4, 0], [0, 5, 0], [0, 6, 0],</span>
<span class="go"> [0, 7, 0], [0, 8, 0], [0, 9, 0], [0, 10, 0], [0, 11, 0],</span>
<span class="go"> [0, 12, 0], [0, 13, 0], [0, 14, 0], [0, 15, 0], [0, 16, 0],</span>
<span class="go"> [0, 17, 0], [0, 18, 0], [0, 19, 0], [1, 2, 1], [1, 3, 1],</span>
<span class="go"> [1, 4, 1], [1, 5, 1], [1, 6, 1], [1, 7, 1], [1, 8, 1], [1, 9, 1],</span>
<span class="go"> [1, 10, 1], [1, 11, 1], [1, 12, 1], [1, 13, 1], [1, 14, 1],</span>
<span class="go"> [1, 15, 1], [1, 16, 1], [1, 17, 1], [1, 18, 1], [1, 19, 1],</span>
<span class="go"> [2, 3, 2], [2, 4, 2], [2, 5, 2], [2, 6, 2], [2, 7, 2], [2, 8, 2],</span>
<span class="go"> [2, 9, 2], [2, 10, 2], [2, 11, 2], [2, 12, 2], [2, 13, 2],</span>
<span class="go"> [2, 14, 2], [2, 15, 2], [2, 16, 2], [2, 17, 2], [2, 18, 2],</span>
<span class="go"> [2, 19, 2], [3, 4, 3], [3, 5, 3], [3, 6, 3], [3, 7, 3], [3, 8, 3],</span>
<span class="go"> [3, 9, 3], [3, 10, 3], [3, 11, 3], [3, 12, 3], [3, 13, 3],</span>
<span class="go"> [3, 14, 3], [3, 15, 3], [3, 16, 3], [3, 17, 3], [3, 18, 3],</span>
<span class="go"> [3, 19, 3], [4, 5, 4], [4, 6, 4], [4, 7, 4], [4, 8, 4], [4, 9, 4],</span>
<span class="go"> [4, 10, 4], [4, 11, 4], [4, 12, 4], [4, 13, 4], [4, 14, 4],</span>
<span class="go"> [4, 15, 4], [4, 16, 4], [4, 17, 4], [4, 18, 4], [4, 19, 4],</span>
<span class="go"> [5, 6, 5], [5, 7, 5], [5, 8, 5], [5, 9, 5], [5, 10, 5],</span>
<span class="go"> [5, 11, 5], [5, 12, 5], [5, 13, 5], [5, 14, 5], [5, 15, 5],</span>
<span class="go"> [5, 16, 5], [5, 17, 5], [5, 18, 5], [5, 19, 5], [6, 7, 6],</span>
<span class="go"> [6, 8, 6], [6, 9, 6], [6, 10, 6], [6, 11, 6], [6, 12, 6],</span>
<span class="go"> [6, 13, 6], [6, 14, 6], [6, 15, 6], [6, 16, 6], [6, 17, 6],</span>
<span class="go"> [6, 18, 6], [6, 19, 6], [7, 8, 7], [7, 9, 7], [7, 10, 7],</span>
<span class="go"> [7, 11, 7], [7, 12, 7], [7, 13, 7], [7, 14, 7], [7, 15, 7],</span>
<span class="go"> [7, 16, 7], [7, 17, 7], [7, 18, 7], [7, 19, 7], [8, 9, 8],</span>
<span class="go"> [8, 10, 8], [8, 11, 8], [8, 12, 8], [8, 13, 8], [8, 14, 8],</span>
<span class="go"> [8, 15, 8], [8, 16, 8], [8, 17, 8], [8, 18, 8], [8, 19, 8],</span>
<span class="go"> [9, 10, 9], [9, 11, 9], [9, 12, 9], [9, 13, 9], [9, 14, 9],</span>
<span class="go"> [9, 15, 9], [9, 16, 9], [9, 17, 9], [9, 18, 9], [9, 19, 9],</span>
<span class="go"> [10, 11, 10], [10, 12, 10], [10, 13, 10], [10, 14, 10],</span>
<span class="go"> [10, 15, 10], [10, 16, 10], [10, 17, 10], [10, 18, 10],</span>
<span class="go"> [10, 19, 10], [11, 12, 11], [11, 13, 11], [11, 14, 11],</span>
<span class="go"> [11, 15, 11], [11, 16, 11], [11, 17, 11], [11, 18, 11],</span>
<span class="go"> [11, 19, 11], [12, 13, 12], [12, 14, 12], [12, 15, 12],</span>
<span class="go"> [12, 16, 12], [12, 17, 12], [12, 18, 12], [12, 19, 12],</span>
<span class="go"> [13, 14, 13], [13, 15, 13], [13, 16, 13], [13, 17, 13],</span>
<span class="go"> [13, 18, 13], [13, 19, 13], [14, 15, 14], [14, 16, 14],</span>
<span class="go"> [14, 17, 14], [14, 18, 14], [14, 19, 14], [15, 16, 15],</span>
<span class="go"> [15, 17, 15], [15, 18, 15], [15, 19, 15], [16, 17, 16],</span>
<span class="go"> [16, 18, 16], [16, 19, 16], [17, 18, 17], [17, 19, 17],</span>
<span class="go"> [18, 19, 18]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [0, 4, 0], [0, 5, 0], [0, 6, 0],</span>
<span class="go"> [0, 7, 0], [0, 8, 0], [0, 9, 0], [0, 10, 0], [0, 11, 0],</span>
<span class="go"> [0, 12, 0], [0, 13, 0], [0, 14, 0], [0, 15, 0], [0, 16, 0],</span>
<span class="go"> [0, 17, 0], [0, 18, 0], [0, 19, 0]]</span>
</pre></div>
</div>
<p>One may prefer to distinguish equivalent cycles having distinct starting
vertices (compare the following examples):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 2, 1], [1, 3, 1], [2, 3, 2]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_cycles</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rooted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[0, 1, 0], [0, 2, 0], [0, 3, 0], [1, 0, 1], [1, 2, 1], [1, 3, 1],</span>
<span class="go"> [2, 0, 2], [2, 1, 2], [2, 3, 2], [3, 0, 3], [3, 1, 3], [3, 2, 3]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.all_simple_paths">
<code class="descname">all_simple_paths</code><span class="sig-paren">(</span><em>starting_vertices=None</em>, <em>ending_vertices=None</em>, <em>max_length=None</em>, <em>trivial=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.all_simple_paths" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of all the simple paths of <code class="docutils literal notranslate"><span class="pre">self</span></code> starting with one of
the given vertices.</p>
<p>Simple paths are paths in which no two arcs share a head or share a
tail, i.e. every vertex in the path is entered at most once and exited
at most once.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">starting_vertices</span></code> â list (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); vertices from which
the paths must start. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices of the graph can
be starting points.</li>
<li><code class="docutils literal notranslate"><span class="pre">ending_vertices</span></code> â iterable (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); allowed ending
vertices of the paths. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all vertices are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_length</span></code> â non negative integer (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the
maximum length of the enumerated paths. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, then all
lengths are allowed.</li>
<li><code class="docutils literal notranslate"><span class="pre">trivial</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then
the empty paths are also enumerated.</li>
</ul>
<p>OUTPUT:</p>
<blockquote>
<div>list</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the number of simple paths of a finite graph is always
finite, computing all its paths may take a very long time.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="n">loops</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">()</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>One may compute all paths having specific starting and/or ending
vertices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">ending_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
<span class="go">[[&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]]</span>
</pre></div>
</div>
<p>It is also possible to bound the length of the paths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;b&#39;, &#39;c&#39;], [&#39;c&#39;, &#39;d&#39;], [&#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;b&#39;, &#39;c&#39;, &#39;d&#39;], [&#39;c&#39;, &#39;d&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;d&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
<p>By default, empty paths are not enumerated, but this can be
parametrized:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;], [&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;],</span>
<span class="go"> [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">all_simple_paths</span><span class="p">(</span><span class="n">starting_vertices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> <span class="n">trivial</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[[&#39;a&#39;, &#39;a&#39;], [&#39;a&#39;, &#39;b&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.degree_polynomial">
<code class="descname">degree_polynomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.degree_polynomial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the generating polynomial of degrees of vertices in <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is the sum</p>
<div class="math notranslate nohighlight">
\[\sum_{v \in G} x^{\operatorname{in}(v)} y^{\operatorname{out}(v)},\]</div>
<p>where <code class="docutils literal notranslate"><span class="pre">in(v)</span></code> and <code class="docutils literal notranslate"><span class="pre">out(v)</span></code> are the number of incoming and outgoing
edges at vertex <span class="math notranslate nohighlight">\(v\)</span> in the digraph <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>Because this polynomial is multiplicative for Cartesian product of
digraphs, it is useful to help see if the digraph can be isomorphic to a
Cartesian product.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">num_verts()</span></code> for the value at <span class="math notranslate nohighlight">\((x, y) = (1, 1)\)</span></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">posets</span><span class="o">.</span><span class="n">PentagonPoset</span><span class="p">()</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_polynomial</span><span class="p">()</span>
<span class="go">x^2 + 3*x*y + y^2</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">posets</span><span class="o">.</span><span class="n">BooleanLattice</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">hasse_diagram</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">degree_polynomial</span><span class="p">()</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + y)^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.dig6_string">
<code class="descname">dig6_string</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.dig6_string" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">dig6</span></code> representation of the digraph as an ASCII string.</p>
<p>This is only valid for single (no multiple edges) digraphs on at most
<span class="math notranslate nohighlight">\(2^{18} - 1 = 262143\)</span> vertices.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As the <code class="docutils literal notranslate"><span class="pre">dig6</span></code> format only handles graphs with vertex set <span class="math notranslate nohighlight">\(\{0,
\ldots, n-1\}\)</span>, a <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.relabel" title="sage.graphs.generic_graph.GenericGraph.relabel"><code class="xref py py-meth docutils literal notranslate"><span class="pre">relabelled</span> <span class="pre">copy</span></code></a> will be encoded,
if necessary.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.graph6_string" title="sage.graphs.graph.Graph.graph6_string"><code class="xref py py-meth docutils literal notranslate"><span class="pre">graph6_string()</span></code></a> â a similar string
format for undirected graphs</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">dig6_string</span><span class="p">()</span>
<span class="go">&#39;CW`_&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.feedback_edge_set">
<code class="descname">feedback_edge_set</code><span class="sig-paren">(</span><em>constraint_generation=True</em>, <em>value_only=False</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.feedback_edge_set" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Compute the minimum feedback edge set of a digraph (also called
feedback arc set).</p>
<p>The minimum feedback edge set of a digraph is a set of edges that
intersect all the circuits of the digraph.  Equivalently, a minimum
feedback arc set of a DiGraph is a set <span class="math notranslate nohighlight">\(S\)</span> of arcs such that the digraph
<span class="math notranslate nohighlight">\(G - S\)</span> is acyclic. For more information, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Feedback_arc_set">Wikipedia article Feedback_arc_set</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)<ul>
<li>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the minimum cardinal of a minimum edge
set is returned.</li>
<li>When set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, the <code class="docutils literal notranslate"><span class="pre">Set</span></code> of edges of a minimal edge set is
returned.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">constraint_generation</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to
use constraint generation when solving the Mixed Integer Linear
Program.</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); specify a Linear Program
(LP) solver to be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is
used. For more information on LP solvers and which default solver is
used, see the method <a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.5)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a> of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> â integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>); sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>This problem is solved using Linear Programming, in two different
ways. The first one is to solve the following formulation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{(u,v)\in G} b_{(u,v)}\\
\mbox{Such that : }&amp;\\
&amp;\forall (u,v)\in G, d_u-d_v+ n \cdot b_{(u,v)}\geq 0\\
&amp;\forall u\in G, 0\leq d_u\leq |G|\\\end{split}\]</div>
<p>An explanation:</p>
<p>An acyclic digraph can be seen as a poset, and every poset has a linear
extension. This means that in any acyclic digraph the vertices can be
ordered with a total order <span class="math notranslate nohighlight">\(&lt;\)</span> in such a way that if <span class="math notranslate nohighlight">\((u,v) \in G\)</span>, then
<span class="math notranslate nohighlight">\(u &lt; v\)</span>.</p>
<p>Thus, this linear program is built in order to assign to each vertex <span class="math notranslate nohighlight">\(v\)</span>
a number <span class="math notranslate nohighlight">\(d_v \in [0,\dots,n-1]\)</span> such that if there exists an edge
<span class="math notranslate nohighlight">\((u, v) \in G\)</span> such that <span class="math notranslate nohighlight">\(d_v &lt; d_u\)</span>, then the edge <span class="math notranslate nohighlight">\((u,v)\)</span> is removed.</p>
<p>The number of edges removed is then minimized, which is the objective.</p>
<p>(Constraint Generation)</p>
<p>If the parameter <code class="docutils literal notranslate"><span class="pre">constraint_generation</span></code> is enabled, a more efficient
formulation is used :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mbox{Minimize : }&amp;\sum_{(u,v)\in G} b_{(u,v)}\\
\mbox{Such that : }&amp;\\
&amp;\forall C\text{ circuits }\subseteq G, \sum_{uv\in C}b_{(u,v)}\geq 1\\\end{split}\]</div>
<p>As the number of circuits contained in a graph is exponential, this LP
is solved through constraint generation. This means that the solver is
sequentially asked to solved the problem, knowing only a portion of the
circuits contained in <span class="math notranslate nohighlight">\(G\)</span>, each time adding to the list of its
constraints the circuit which its last answer had left intact.</p>
<p>EXAMPLES:</p>
<p>If the digraph is created from a graph, and hence is symmetric (if <span class="math notranslate nohighlight">\(uv\)</span>
is an edge, then <span class="math notranslate nohighlight">\(vu\)</span> is an edge too), then obviously the cardinality of
its feedback arc set is the number of edges in the first graph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cycle</span><span class="o">=</span><span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dcycle</span><span class="o">=</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">cycle</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">dcycle</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">(</span><span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">5</span>
</pre></div>
</div>
<p>And in this situation, for any edge <span class="math notranslate nohighlight">\(uv\)</span> of the first graph, <span class="math notranslate nohighlight">\(uv\)</span> of
<span class="math notranslate nohighlight">\(vu\)</span> is in the returned feedback arc set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomGNP</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="o">.</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">dg</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">feedback</span> <span class="o">=</span> <span class="n">dg</span><span class="o">.</span><span class="n">feedback_edge_set</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">l</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">feedback</span> <span class="ow">or</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="ow">in</span> <span class="n">feedback</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.flow_polytope">
<code class="descname">flow_polytope</code><span class="sig-paren">(</span><em>edges=None</em>, <em>ends=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.flow_polytope" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the flow polytope of a digraph.</p>
<p>The flow polytope of a directed graph is the polytope consisting of all
nonnegative flows on the graph with a given set <span class="math notranslate nohighlight">\(S\)</span> of sources and a
given set <span class="math notranslate nohighlight">\(T\)</span> of sinks.</p>
<p>A <em>flow</em> on a directed graph <span class="math notranslate nohighlight">\(G\)</span> with a given set <span class="math notranslate nohighlight">\(S\)</span> of sources and a
given set <span class="math notranslate nohighlight">\(T\)</span> of sinks means an assignment of a nonnegative real to each
edge of <span class="math notranslate nohighlight">\(G\)</span> such that the flow is conserved in each vertex outside of
<span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(T\)</span>, and there is a unit of flow entering each vertex in <span class="math notranslate nohighlight">\(S\)</span> and
a unit of flow leaving each vertex in <span class="math notranslate nohighlight">\(T\)</span>. These flows clearly form a
polytope in the space of all assignments of reals to the edges of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>The polytope is empty unless the sets <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(T\)</span> are equinumerous.</p>
<p>By default, <span class="math notranslate nohighlight">\(S\)</span> is taken to be the set of all sources (i.e., vertices of
indegree <span class="math notranslate nohighlight">\(0\)</span>) of <span class="math notranslate nohighlight">\(G\)</span>, and <span class="math notranslate nohighlight">\(T\)</span> is taken to be the set of all sinks (i.e.,
vertices of outdegree <span class="math notranslate nohighlight">\(0\)</span>) of <span class="math notranslate nohighlight">\(G\)</span>. If a different choice of <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(T\)</span>
is desired, it can be specified using the optional <code class="docutils literal notranslate"><span class="pre">ends</span></code> parameter.</p>
<p>The polytope is returned as a polytope in <span class="math notranslate nohighlight">\(\RR^m\)</span>, where <span class="math notranslate nohighlight">\(m\)</span> is the
number of edges of the digraph <code class="docutils literal notranslate"><span class="pre">self</span></code>. The <span class="math notranslate nohighlight">\(k\)</span>-th coordinate of a
point in the polytope is the real assigned to the <span class="math notranslate nohighlight">\(k\)</span>-th edge of
<code class="docutils literal notranslate"><span class="pre">self</span></code>. The order of the edges is the one returned by
<code class="docutils literal notranslate"><span class="pre">self.edges()</span></code>. If a different order is desired, it can be specified
using the optional <code class="docutils literal notranslate"><span class="pre">edges</span></code> parameter.</p>
<p>The faces and volume of these polytopes are of interest. Examples of
these polytopes are the Chan-Robbins-Yuen polytope and the
Pitman-Stanley polytope <a class="reference internal" href="#pitsta" id="id1">[PitSta]</a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">edges</span></code> â (optional, default: <code class="docutils literal notranslate"><span class="pre">self.edges()</span></code>) a list or tuple of
all edges of <code class="docutils literal notranslate"><span class="pre">self</span></code> (each only once). This determines which
coordinate of a point in the polytope will correspond to which edge of
<code class="docutils literal notranslate"><span class="pre">self</span></code>. It is also possible to specify a list which contains not all
edges of <code class="docutils literal notranslate"><span class="pre">self</span></code>; this results in a polytope corresponding to the
flows which are <span class="math notranslate nohighlight">\(0\)</span> on all remaining edges. Notice that the edges
entered here must be in the precisely same format as outputted by
<code class="docutils literal notranslate"><span class="pre">self.edges()</span></code>; so, if <code class="docutils literal notranslate"><span class="pre">self.edges()</span></code> outputs an edge in the form
<code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3,</span> <span class="pre">None)</span></code>, then <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">3)</span></code> will not do!</li>
<li><code class="docutils literal notranslate"><span class="pre">ends</span></code> â (optional, default: <code class="docutils literal notranslate"><span class="pre">(self.sources(),</span> <span class="pre">self.sinks())</span></code>) a
pair <span class="math notranslate nohighlight">\((S, T)\)</span> of an iterable <span class="math notranslate nohighlight">\(S\)</span> and an iterable <span class="math notranslate nohighlight">\(T\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Flow polytopes can also be built through the <code class="docutils literal notranslate"><span class="pre">polytopes.&lt;tab&gt;</span></code>
object:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytopes</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">A 0-dimensional polyhedron in QQ^4 defined as the convex hull of 1 vertex</span>
</pre></div>
</div>
</div>
<p>EXAMPLES:</p>
<p>A commutative square:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">();</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 1, 0, 1), A vertex at (1, 0, 1, 0))</span>
</pre></div>
</div>
<p>Using a different order for the edges of the graph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 1, 1, 0), A vertex at (1, 0, 0, 1))</span>
</pre></div>
</div>
<p>A tournament on 4 vertices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">TransitiveTournament</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">();</span> <span class="n">fl</span>
<span class="go">A 3-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 4 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 1, 0, 0, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 0, 0, 1),</span>
<span class="go"> A vertex at (1, 0, 0, 0, 1, 0),</span>
<span class="go"> A vertex at (1, 0, 0, 1, 0, 1))</span>
</pre></div>
</div>
<p>Restricting to a subset of the edges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="go">....:                             (2, 3, None), (0, 3, None)])</span>
<span class="gp">sage: </span><span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^4 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1), A vertex at (1, 1, 1, 0))</span>
</pre></div>
</div>
<p>Using a different choice of sources and sinks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 1-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 2 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1, 0, 1), A vertex at (0, 0, 0, 0, 1, 0))</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">The empty polyhedron in QQ^6</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">The empty polyhedron in QQ^6</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">ends</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]));</span> <span class="n">fl</span>
<span class="go">A 3-dimensional polyhedron in QQ^6 defined as the convex hull</span>
<span class="go">of 5 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 1, 1, 0, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 0, 1, 0),</span>
<span class="go"> A vertex at (1, 0, 0, 2, 0, 1),</span>
<span class="go"> A vertex at (1, 0, 0, 1, 1, 0),</span>
<span class="go"> A vertex at (0, 1, 0, 1, 0, 1))</span>
<span class="gp">sage: </span><span class="n">fl</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">(</span><span class="n">edges</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">None</span><span class="p">),</span>
<span class="go">....:                             (2, 3, None), (0, 2, None),</span>
<span class="go">....:                             (1, 3, None)],</span>
<span class="go">....:                      ends=([0, 1], [2, 3])); fl</span>
<span class="go">A 2-dimensional polyhedron in QQ^5 defined as the convex hull</span>
<span class="go">of 4 vertices</span>
<span class="gp">sage: </span><span class="n">fl</span><span class="o">.</span><span class="n">vertices</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0, 0, 1, 1),</span>
<span class="go"> A vertex at (1, 2, 1, 0, 0),</span>
<span class="go"> A vertex at (1, 1, 0, 0, 1),</span>
<span class="go"> A vertex at (0, 1, 1, 1, 0))</span>
</pre></div>
</div>
<p>A digraph with one source and two sinks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Y</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">Y</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">()</span>
<span class="go">The empty polyhedron in QQ^3</span>
</pre></div>
</div>
<p>A digraph with one vertex and no edge:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[]})</span>
<span class="gp">sage: </span><span class="n">Z</span><span class="o">.</span><span class="n">flow_polytope</span><span class="p">()</span>
<span class="go">A 0-dimensional polyhedron in QQ^0 defined as the convex hull</span>
<span class="go">of 1 vertex</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="pitsta" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[PitSta]</a></td><td>Jim Pitman, Richard Stanley, âA polytope related to
empirical distributions, plane trees, parking functions, and
the associahedronâ, <a class="reference external" href="https://arxiv.org/abs/math/9908029">Arxiv math/9908029</a></td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.immediate_dominators">
<code class="descname">immediate_dominators</code><span class="sig-paren">(</span><em>r</em>, <em>reverse=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.immediate_dominators" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the immediate dominators of all vertices reachable from <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p>A flowgraph <span class="math notranslate nohighlight">\(G = (V, A, r)\)</span> is a digraph where every vertex in <span class="math notranslate nohighlight">\(V\)</span> is
reachable from a distinguished root vertex <span class="math notranslate nohighlight">\(r\in V\)</span>. In such digraph, a
vertex <span class="math notranslate nohighlight">\(w\)</span> dominates a vertex <span class="math notranslate nohighlight">\(v\)</span> if every path from <span class="math notranslate nohighlight">\(r\)</span> to <span class="math notranslate nohighlight">\(v\)</span> includes
<span class="math notranslate nohighlight">\(w\)</span>. Let <span class="math notranslate nohighlight">\(dom(v)\)</span> be the set of the vertices that dominate <span class="math notranslate nohighlight">\(v\)</span>.
Obviously, <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(v\)</span>, the trivial dominators of <span class="math notranslate nohighlight">\(v\)</span>, are in
<span class="math notranslate nohighlight">\(dom(v)\)</span>. For <span class="math notranslate nohighlight">\(v \neq r\)</span>, the immediate dominator of <span class="math notranslate nohighlight">\(v\)</span>, denoted by
<span class="math notranslate nohighlight">\(d(v)\)</span>, is the unique vertex <span class="math notranslate nohighlight">\(w \neq v\)</span> that dominates <span class="math notranslate nohighlight">\(v\)</span> and is
dominated by all the vertices in <span class="math notranslate nohighlight">\(dom(v)\setminus\{v\}\)</span>. The (immediate)
dominator tree is a directed tree (or arborescence) rooted at <span class="math notranslate nohighlight">\(r\)</span> that
is formed by the arcs <span class="math notranslate nohighlight">\(\{ (d(v), v)\mid v\in V\setminus\{r\}\}\)</span>.  See
<a class="reference internal" href="../../../references/index.html#ge2005" id="id2">[Ge2005]</a> for more details.</p>
<p>This method implements the algorithm proposed in <a class="reference internal" href="../../../references/index.html#chk2001" id="id3">[CHK2001]</a> which
performs very well in practice, although its worst case time complexity
is in <span class="math notranslate nohighlight">\(O(n^2)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">r</span></code> â a vertex of the digraph, the root of the immediate dominators
tree</li>
<li><code class="docutils literal notranslate"><span class="pre">reverse</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, we
consider the reversed digraph in which out-neighbors become the
in-neighbors and vice-versa. This option is available only if the
backend of the digraph is <code class="xref py py-mod docutils literal notranslate"><span class="pre">SparseGraphBackend</span></code>.</li>
</ul>
<p>OUTPUT: The (immediate) dominator tree rooted at <span class="math notranslate nohighlight">\(r\)</span>, encoded as a
predecessor dictionary.</p>
<p>EXAMPLES:</p>
<p>The output encodes a tree rooted at <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">doctest:...: DeprecationWarning: immediate_dominators is now deprecated. Please use method dominator_tree instead.</span>
<span class="go">See https://trac.sagemath.org/25030 for details.</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">d</span> <span class="k">if</span> <span class="n">u</span> <span class="o">!=</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">T</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In a strongly connected digraph, the result depends on the root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: 0, 1: 0, 2: 1, 3: 2, 4: 3}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">{0: 4, 1: 1, 2: 1, 3: 2, 4: 3}</span>
</pre></div>
</div>
<p>The (immediate) dominator tree contains only reachable vertices:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{0: 0, 1: 0, 2: 1, 3: 2, 4: 3}</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">{3: 3, 4: 3}</span>
</pre></div>
</div>
<p>Immediate dominators in the reverse digraph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">idom</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">idom</span>
<span class="go">{0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 7, 6: 7, 7: 2, 8: 7}</span>
<span class="gp">sage: </span><span class="n">D_reverse</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D_reverse</span><span class="o">.</span><span class="n">immediate_dominators</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">idom</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Dominator_(graph_theory)">Wikipedia article Dominator_(graph_theory)</a></li>
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strong_articulation_points" title="sage.graphs.digraph.DiGraph.strong_articulation_points"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strong_articulation_points()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="sage.graphs.digraph.DiGraph.strongly_connected_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components()</span></code></a></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree">
<code class="descname">in_degree</code><span class="sig-paren">(</span><em>vertices=None</em>, <em>labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Same as degree, but for in degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 2, 1: 2, 2: 2}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">in_degree</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 1, 1]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">in_degree</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree_iterator">
<code class="descname">in_degree_iterator</code><span class="sig-paren">(</span><em>vertices=None</em>, <em>labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Same as degree_iterator, but for in degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">in_degree_iterator</span><span class="p">():</span>
<span class="go">....:     print(i)</span>
<span class="go">3</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">in_degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="go">....:    print(i)</span>
<span class="go">((0, 1), 3)</span>
<span class="go">((1, 2), 3)</span>
<span class="go">((0, 0), 2)</span>
<span class="go">((0, 3), 2)</span>
<span class="go">((1, 1), 3)</span>
<span class="go">((1, 3), 2)</span>
<span class="go">((1, 0), 2)</span>
<span class="go">((0, 2), 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.in_degree_sequence">
<code class="descname">in_degree_sequence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.in_degree_sequence" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the in-degree sequence.</p>
<p>EXAMPLES:</p>
<p>The in-degree sequences of two digraphs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">in_degree_sequence</span><span class="p">()</span>
<span class="go">[5, 2, 1, 1, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">E</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">in_degree_sequence</span><span class="p">()</span>
<span class="go">[2, 2, 2, 2, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.incoming_edge_iterator">
<code class="descname">incoming_edge_iterator</code><span class="sig-paren">(</span><em>vertices</em>, <em>labels=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.incoming_edge_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over all arriving edges from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">vertices</span></code> â a vertex or a list of vertices</li>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to return edges as
pairs of vertices, or as triples containing the labels</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">incoming_edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="go">....:     print(a)</span>
<span class="go">(1, 0, None)</span>
<span class="go">(4, 0, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.incoming_edges">
<code class="descname">incoming_edges</code><span class="sig-paren">(</span><em>vertices</em>, <em>labels=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.incoming_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of edges arriving at vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">vertices</span></code> â a vertex or a list of vertices</li>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to return edges as
pairs of vertices, or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">incoming_edges</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(1, 0, None), (4, 0, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_aperiodic">
<code class="descname">is_aperiodic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the current <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> is aperiodic.</p>
<p>A directed graph is aperiodic if there is no integer <span class="math notranslate nohighlight">\(k &gt; 1\)</span> that
divides the length of every cycle in the graph. See the
<a class="reference external" href="https://en.wikipedia.org/wiki/Aperiodic_graph">Wikipedia article Aperiodic_graph</a> for more information.</p>
<p>EXAMPLES:</p>
<p>The following graph has period <code class="docutils literal notranslate"><span class="pre">2</span></code>, so it is not aperiodic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_aperiodic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The following graph has a cycle of length 2 and a cycle of length 3,
so it is aperiodic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_aperiodic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.period" title="sage.graphs.digraph.DiGraph.period"><code class="xref py py-meth docutils literal notranslate"><span class="pre">period()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_directed">
<code class="descname">is_directed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_directed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Since digraph is directed, return <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">()</span><span class="o">.</span><span class="n">is_directed</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_directed_acyclic">
<code class="descname">is_directed_acyclic</code><span class="sig-paren">(</span><em>certificate=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the digraph is acyclic or not.</p>
<p>A directed graph is acyclic if for any vertex <span class="math notranslate nohighlight">\(v\)</span>, there is no directed
path that starts and ends at <span class="math notranslate nohighlight">\(v\)</span>. Every directed acyclic graph (DAG)
corresponds to a partial ordering of its vertices, however multiple dags
may lead to the same partial ordering.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">certificate</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to return a
certificate</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>When <code class="docutils literal notranslate"><span class="pre">certificate=False</span></code>, returns a boolean value.</li>
<li>When <code class="docutils literal notranslate"><span class="pre">certificate=True</span></code>:<ul>
<li>If the graph is acyclic, returns a pair <code class="docutils literal notranslate"><span class="pre">(True,</span> <span class="pre">ordering)</span></code> where
<code class="docutils literal notranslate"><span class="pre">ordering</span></code> is a list of the vertices such that <code class="docutils literal notranslate"><span class="pre">u</span></code> appears
before <code class="docutils literal notranslate"><span class="pre">v</span></code> in <code class="docutils literal notranslate"><span class="pre">ordering</span></code> if <code class="docutils literal notranslate"><span class="pre">u,</span> <span class="pre">v</span></code> is an edge.</li>
<li>Else, returns a pair <code class="docutils literal notranslate"><span class="pre">(False,</span> <span class="pre">cycle)</span></code> where <code class="docutils literal notranslate"><span class="pre">cycle</span></code> is a list of
vertices representing a circuit in the graph.</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<p>At first, the following graph is acyclic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">5</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="mi">7</span><span class="p">:[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">6</span><span class="p">:[</span><span class="mi">9</span><span class="p">],</span> <span class="mi">8</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span> <span class="mi">9</span><span class="p">:[</span><span class="mi">10</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Adding an edge from <span class="math notranslate nohighlight">\(9\)</span> to <span class="math notranslate nohighlight">\(7\)</span> does not change it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can obtain as a proof an ordering of the vertices such that <span class="math notranslate nohighlight">\(u\)</span>
appears before <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(uv\)</span> is an edge of the graph:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(True, [4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10])</span>
</pre></div>
</div>
<p>Adding an edge from 7 to 4, though, makes a difference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Indeed, it creates a circuit <span class="math notranslate nohighlight">\(7, 4, 5\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(False, [7, 4, 5])</span>
</pre></div>
</div>
<p>Checking acyclic graphs are indeed acyclic</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">random_acyclic</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="go">....:  g = graphs.RandomGNP(n, p)</span>
<span class="go">....:  h = DiGraph()</span>
<span class="go">....:  h.add_edges(((u, v) if u &lt; v else (v, u)) for u, v in g.edge_iterator(labels=False))</span>
<span class="go">....:  return h</span>
<span class="gp">...</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">random_acyclic</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>    <span class="c1"># long time</span>
<span class="go">....:      for i in range(50))                             # long time</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_strongly_connected">
<code class="descname">is_strongly_connected</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_strongly_connected" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Check whether the current <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code> is strongly connected.</p>
<p>EXAMPLES:</p>
<p>The circuit is obviously strongly connected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.connectivity</span> <span class="kn">import</span> <span class="n">is_strongly_connected</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_strongly_connected</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But a transitive triangle is not:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">is_strongly_connected</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_tournament">
<code class="descname">is_tournament</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_tournament" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Check whether the digraph is a tournament.</p>
<p>A tournament is a digraph in which each pair of distinct vertices is
connected by a single arc.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomTournament</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_tournament</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">u</span><span class="p">,</span><span class="n">v</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_tournament</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_tournament</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Tournament_(graph_theory)">Wikipedia article Tournament_(graph_theory)</a></li>
<li><a class="reference internal" href="digraph_generators.html#sage.graphs.digraph_generators.DiGraphGenerators.RandomTournament" title="sage.graphs.digraph_generators.DiGraphGenerators.RandomTournament"><code class="xref py py-meth docutils literal notranslate"><span class="pre">RandomTournament()</span></code></a></li>
<li><a class="reference internal" href="digraph_generators.html#sage.graphs.digraph_generators.DiGraphGenerators.TransitiveTournament" title="sage.graphs.digraph_generators.DiGraphGenerators.TransitiveTournament"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TransitiveTournament()</span></code></a></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.is_transitive">
<code class="descname">is_transitive</code><span class="sig-paren">(</span><em>g</em>, <em>certificate=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.is_transitive" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Tests whether the digraph is transitive.</p>
<p>A digraph is transitive if for any pair of vertices <span class="math notranslate nohighlight">\(u,v\in G\)</span> linked by a
<span class="math notranslate nohighlight">\(uv\)</span>-path the edge <span class="math notranslate nohighlight">\(uv\)</span> belongs to <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">certificate</span></code> â whether to return a certificate for negative answers.<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">False</span></code> (default), this method returns <code class="docutils literal notranslate"><span class="pre">True</span></code> or
<code class="docutils literal notranslate"><span class="pre">False</span></code> according to the graph.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">certificate</span> <span class="pre">=</span> <span class="pre">True</span></code>, this method either returns <code class="docutils literal notranslate"><span class="pre">True</span></code> answers
or yield a pair of vertices <span class="math notranslate nohighlight">\(uv\)</span> such that there exists a <span class="math notranslate nohighlight">\(uv\)</span>-path in
<span class="math notranslate nohighlight">\(G\)</span> but <span class="math notranslate nohighlight">\(uv\not\in G\)</span>.</li>
</ul>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">Circuit</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 2)</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">DeBruijn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">cert</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">(</span><span class="n">certificate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="o">*</span><span class="n">cert</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">shortest_path</span><span class="p">(</span><span class="o">*</span><span class="n">cert</span><span class="p">)</span> <span class="o">!=</span> <span class="p">[]</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="o">.</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">transitive_closure</span><span class="p">()</span><span class="o">.</span><span class="n">is_transitive</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.layout_acyclic">
<code class="descname">layout_acyclic</code><span class="sig-paren">(</span><em>rankdir='up'</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.layout_acyclic" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a ranked layout so that all edges point upward.</p>
<p>To this end, the heights of the vertices are set according to the level
set decomposition of the graph (see <a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">level_sets()</span></code></a>).</p>
<p>This is achieved by calling <code class="docutils literal notranslate"><span class="pre">graphviz</span></code> and <code class="docutils literal notranslate"><span class="pre">dot2tex</span></code> if available
(see <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_graphviz()</span></code></a>), and using a spring layout with fixed
vertical placement of the vertices otherwise (see
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_acyclic_dummy()</span></code></a> and
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_ranked()</span></code></a>).</p>
<p>Non acyclic graphs are partially supported by <code class="docutils literal notranslate"><span class="pre">graphviz</span></code>, which then
chooses some edges to point down.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">rankdir</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">'up'</span></code>); indicates which direction
the edges should point toward among <code class="docutils literal notranslate"><span class="pre">'up'</span></code>, <code class="docutils literal notranslate"><span class="pre">'down'</span></code>, <code class="docutils literal notranslate"><span class="pre">'left'</span></code>,
or <code class="docutils literal notranslate"><span class="pre">'right'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">**options</span></code> â passed down to
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_ranked()</span></code></a> or
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_graphviz" title="sage.graphs.generic_graph.GenericGraph.layout_graphviz"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_graphviz()</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
</pre></div>
</div>
<p>The actual layout computed depends on whether dot2tex and graphviz are
installed, so we donât test its relative values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">()</span>
<span class="go">{0: [..., ...], 1: [..., ...], 2: [..., ...], 3: [..., ...], 5: [..., ...], 6: [..., ...]}</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">pos</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="o">.</span><span class="mi">5</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.layout_acyclic_dummy">
<code class="descname">layout_acyclic_dummy</code><span class="sig-paren">(</span><em>heights=None</em>, <em>rankdir='up'</em>, <em>**options</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a ranked layout so that all edges point upward.</p>
<p>To this end, the heights of the vertices are set according to the level
set decomposition of the graph (see <a class="reference internal" href="#sage.graphs.digraph.DiGraph.level_sets" title="sage.graphs.digraph.DiGraph.level_sets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">level_sets()</span></code></a>). This is
achieved by a spring layout with fixed vertical placement of the
vertices otherwise (see <a class="reference internal" href="#sage.graphs.digraph.DiGraph.layout_acyclic_dummy" title="sage.graphs.digraph.DiGraph.layout_acyclic_dummy"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_acyclic_dummy()</span></code></a> and
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_ranked()</span></code></a>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">rankdir</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">'up'</span></code>); indicates which direction
the edges should point toward among <code class="docutils literal notranslate"><span class="pre">'up'</span></code>, <code class="docutils literal notranslate"><span class="pre">'down'</span></code>, <code class="docutils literal notranslate"><span class="pre">'left'</span></code>,
or <code class="docutils literal notranslate"><span class="pre">'right'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">**options</span></code> â passed down to
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.layout_ranked" title="sage.graphs.generic_graph.GenericGraph.layout_ranked"><code class="xref py py-meth docutils literal notranslate"><span class="pre">layout_ranked()</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">()</span>
<span class="go">{0: [1.00..., 0], 1: [1.00..., 1], 2: [1.51..., 2], 3: [1.50..., 3], 5: [2.01..., 0], 6: [2.00..., 1]}</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;up&#39;</span><span class="p">)</span>
<span class="go">{0: [0.5..., 0], 1: [0.5..., 1]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;down&#39;</span><span class="p">)</span>
<span class="go">{0: [0.5..., 1], 1: [0.5..., 0]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="go">{0: [1, 0.5...], 1: [0, 0.5...]}</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">(</span><span class="n">rankdir</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="go">{0: [0, 0.5...], 1: [1, 0.5...]}</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">layout_acyclic_dummy</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">`self` should be an acyclic graph</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.level_sets">
<code class="descname">level_sets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.level_sets" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the level set decomposition of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a list of non empty lists of vertices of this graph</li>
</ul>
<p>The level set decomposition of the digraph is a list <span class="math notranslate nohighlight">\(l\)</span> such that the
level <span class="math notranslate nohighlight">\(l[i]\)</span> contains all the vertices having all their predecessors in
the levels <span class="math notranslate nohighlight">\(l[j]\)</span> for <span class="math notranslate nohighlight">\(j &lt; i\)</span>, and at least one in level <span class="math notranslate nohighlight">\(l[i-1]\)</span>
(unless <span class="math notranslate nohighlight">\(i = 0\)</span>).</p>
<p>The level decomposition contains exactly the vertices not occuring in
any cycle of the graph. In particular, the graph is acyclic if and only
if the decomposition forms a set partition of its vertices, and we
recover the usual level set decomposition of the corresponding poset.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()</span>
<span class="go">[[0, 5], [1, 6], [2], [3]]</span>

<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">6</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()</span>
<span class="go">[[0, 5], [6], [2]]</span>
</pre></div>
</div>
<p>This routine is mostly used for Hasse diagrams of posets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.posets.hasse_diagram</span> <span class="kn">import</span> <span class="n">HasseDiagram</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HasseDiagram</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[]})</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()]</span>
<span class="go">[1, 2, 1]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.combinat.posets.hasse_diagram</span> <span class="kn">import</span> <span class="n">HasseDiagram</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">HasseDiagram</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">H</span><span class="o">.</span><span class="n">level_sets</span><span class="p">()]</span>
<span class="go">[1, 2, 1, 1]</span>
</pre></div>
</div>
<p>Complexity: <span class="math notranslate nohighlight">\(O(n+m)\)</span> in time and <span class="math notranslate nohighlight">\(O(n)\)</span> in memory (besides the storage
of the graph itself), where <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(m\)</span> are respectively the number of
vertices and edges (assuming that appending to a list is constant time,
which it is not quite).</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbor_in_iterator">
<code class="descname">neighbor_in_iterator</code><span class="sig-paren">(</span><em>vertex</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbor_in_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over the in-neighbors of <code class="docutils literal notranslate"><span class="pre">vertex</span></code>.</p>
<p>An vertex <span class="math notranslate nohighlight">\(u\)</span> is an in-neighbor of a vertex <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(uv\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">neighbor_in_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="go">....:     print(a)</span>
<span class="go">1</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbor_out_iterator">
<code class="descname">neighbor_out_iterator</code><span class="sig-paren">(</span><em>vertex</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbor_out_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over the out-neighbors of a given vertex.</p>
<p>A vertex <span class="math notranslate nohighlight">\(u\)</span> is an out-neighbor of a vertex <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(vu\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">neighbor_out_iterator</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="go">....:     print(a)</span>
<span class="go">1</span>
<span class="go">2</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbors_in">
<code class="descname">neighbors_in</code><span class="sig-paren">(</span><em>vertex</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbors_in" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the list of the in-neighbors of a given vertex.</p>
<p>A vertex <span class="math notranslate nohighlight">\(u\)</span> is an in-neighbor of a vertex <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(uv\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_in</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1, 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.neighbors_out">
<code class="descname">neighbors_out</code><span class="sig-paren">(</span><em>vertex</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.neighbors_out" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the list of the out-neighbors of a given vertex.</p>
<p>A vertex <span class="math notranslate nohighlight">\(u\)</span> is an out-neighbor of a vertex <span class="math notranslate nohighlight">\(v\)</span> if <span class="math notranslate nohighlight">\(vu\)</span> in an edge.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">neighbors_out</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1, 2, 3]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree">
<code class="descname">out_degree</code><span class="sig-paren">(</span><em>vertices=None</em>, <em>labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Same as degree, but for out degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="n">vertices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: 3, 1: 2, 2: 1}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">()</span>
<span class="go">[3, 2, 1, 1, 2, 1]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">out_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree_iterator">
<code class="descname">out_degree_iterator</code><span class="sig-paren">(</span><em>vertices=None</em>, <em>labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Same as degree_iterator, but for out degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">out_degree_iterator</span><span class="p">():</span>
<span class="go">....:     print(i)</span>
<span class="go">3</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">2</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">out_degree_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="go">....:     print(i)</span>
<span class="go">((0, 1), 3)</span>
<span class="go">((1, 2), 3)</span>
<span class="go">((0, 0), 2)</span>
<span class="go">((0, 3), 2)</span>
<span class="go">((1, 1), 3)</span>
<span class="go">((1, 3), 2)</span>
<span class="go">((1, 0), 2)</span>
<span class="go">((0, 2), 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.out_degree_sequence">
<code class="descname">out_degree_sequence</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.out_degree_sequence" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the outdegree sequence of this digraph.</p>
<p>EXAMPLES:</p>
<p>The outdegree sequences of two digraphs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">out_degree_sequence</span><span class="p">()</span>
<span class="go">[3, 2, 2, 2, 1, 0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">E</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">out_degree_sequence</span><span class="p">()</span>
<span class="go">[3, 2, 2, 1, 1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.outgoing_edge_iterator">
<code class="descname">outgoing_edge_iterator</code><span class="sig-paren">(</span><em>vertices</em>, <em>labels=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.outgoing_edge_iterator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an iterator over all departing edges from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">vertices</span></code> â a vertex or a list of vertices</li>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to return edges as
pairs of vertices, or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">outgoing_edge_iterator</span><span class="p">([</span><span class="mi">0</span><span class="p">]):</span>
<span class="go">....:     print(a)</span>
<span class="go">(0, 1, None)</span>
<span class="go">(0, 2, None)</span>
<span class="go">(0, 3, None)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.outgoing_edges">
<code class="descname">outgoing_edges</code><span class="sig-paren">(</span><em>vertices</em>, <em>labels=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.outgoing_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of edges departing from vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">vertices</span></code> â a vertex or a list of vertices</li>
<li><code class="docutils literal notranslate"><span class="pre">labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to return edges as
pairs of vertices, or as triples containing the labels.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">outgoing_edges</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="go">[(0, 1, None), (0, 2, None), (0, 3, None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.path_semigroup">
<code class="descname">path_semigroup</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.path_semigroup" title="Permalink to this definition">Â¶</a></dt>
<dd><p>The partial semigroup formed by the paths of this quiver.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Q</span><span class="o">.</span><span class="n">path_semigroup</span><span class="p">();</span> <span class="n">F</span>
<span class="go">Partial semigroup formed by the directed paths of Multi-digraph on 3 vertices</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="go">[e_1, e_2, e_3, a, c, b, a*b, c*b]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.period">
<code class="descname">period</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.period" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the period of the current <code class="docutils literal notranslate"><span class="pre">DiGraph</span></code>.</p>
<p>The period of a directed graph is the largest integer that divides the
length of every cycle in the graph. See the <a class="reference external" href="https://en.wikipedia.org/wiki/Aperiodic_graph">Wikipedia article Aperiodic_graph</a>
for more information.</p>
<p>EXAMPLES:</p>
<p>The following graph has period <code class="docutils literal notranslate"><span class="pre">2</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The following graph has a cycle of length 2 and a cycle of length 3,
so it has period <code class="docutils literal notranslate"><span class="pre">1</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is an example of computing the period of a digraph which is not
strongly connected. By definition, it is the <a class="reference external" href="../../../rings_standard/sage/arith/misc.html#sage.arith.misc.gcd" title="(in Sage Reference Manual: Standard Commutative Rings v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gcd()</span></code></a> of the periods
of its strongly connected components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="go">....:     1: [2], 2: [1]})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">period</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">period</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span>
<span class="go">....:         in g.strongly_connected_components_subgraphs()])</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>See the networkX implementation of <code class="docutils literal notranslate"><span class="pre">is_aperiodic</span></code>, that is based on
breadth first search.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_aperiodic" title="sage.graphs.digraph.DiGraph.is_aperiodic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_aperiodic()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse">
<code class="descname">reverse</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a copy of digraph with edges reversed in direction.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">5</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
<span class="go">Reverse of (): Digraph on 6 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse_edge">
<code class="descname">reverse_edge</code><span class="sig-paren">(</span><em>u</em>, <em>v=None</em>, <em>label=None</em>, <em>inplace=True</em>, <em>multiedges=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Reverse the edge from <span class="math notranslate nohighlight">\(u\)</span> to <span class="math notranslate nohighlight">\(v\)</span>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">inplace</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, a new
digraph is created and returned as output, otherwise <code class="docutils literal notranslate"><span class="pre">self</span></code> is
modified.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">multiedges</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); how to decide what
should be done in case of doubt (for instance when edge <span class="math notranslate nohighlight">\((1,2)\)</span> is to
be reversed in a graph while <span class="math notranslate nohighlight">\((2,1)\)</span> already exists):</p>
<ul class="simple">
<li>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, input graph will be forced to allow parallel
edges if necessary and edge <span class="math notranslate nohighlight">\((1,2)\)</span> will appear twice in the graph.</li>
<li>If set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, only one edge <span class="math notranslate nohighlight">\((1,2)\)</span> will remain in the graph
after <span class="math notranslate nohighlight">\((2,1)\)</span> is reversed. Besides, the label of edge <span class="math notranslate nohighlight">\((1,2)\)</span> will
be overwritten with the label of edge <span class="math notranslate nohighlight">\((2,1)\)</span>.</li>
</ul>
<p>The default behaviour (<code class="docutils literal notranslate"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">None</span></code>) will raise an exception
each time a subjective decision (setting <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code> or
<code class="docutils literal notranslate"><span class="pre">False</span></code>) is necessary to perform the operation.</p>
</li>
</ul>
<p>The following forms are all accepted:</p>
<ul class="simple">
<li>D.reverse_edge( 1, 2 )</li>
<li>D.reverse_edge( (1, 2) )</li>
<li>D.reverse_edge( [1, 2] )</li>
<li>D.reverse_edge( 1, 2, âlabelâ )</li>
<li>D.reverse_edge( ( 1, 2, âlabelâ) )</li>
<li>D.reverse_edge( [1, 2, âlabelâ] )</li>
<li>D.reverse_edge( ( 1, 2), label=âlabelâ )</li>
</ul>
<p>EXAMPLES:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">inplace</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default value), <code class="docutils literal notranslate"><span class="pre">self</span></code> is modified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2)]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">inplace</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not modified and a new digraph
is returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 2)]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will be forced to allow parallel
edges when and only when it is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even if <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will not be forced to allow
parallel edges when it is not necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If user specifies <code class="docutils literal notranslate"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will not be forced to
allow parallel edges and a parallel edge will get deleted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 3, None)]</span>
</pre></div>
</div>
<p>Note that in the following graph, specifying <code class="docutils literal notranslate"><span class="pre">multiedges</span> <span class="pre">=</span> <span class="pre">False</span></code> will
result in overwriting the label of <span class="math notranslate nohighlight">\((1, 2)\)</span> with the label of <span class="math notranslate nohighlight">\((2, 1)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;B&#39;), (2, 1, &#39;A&#39;), (2, 3, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 3, None)]</span>
</pre></div>
</div>
<p>If input edge in digraph has weight/label, then the weight/label should
be preserved in the output digraph.  User does not need to specify the
weight/label when calling function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, 2), (2, 1, 1)]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has multiple copies (parallel edges) of the input edge, only
1 of the parallel edges is reversed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;12&#39;</span><span class="p">)],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;01&#39;), (0, 1, &#39;cat&#39;), (1, 0, &#39;01&#39;), (1, 2, &#39;12&#39;)]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">self</span></code> has multiple copies (parallel edges) of the input edge but
with distinct labels and no input label is specified, only 1 of the
parallel edges is reversed (the edge that is labeled by the first label
on the list returned by <a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.edge_label" title="sage.graphs.generic_graph.GenericGraph.edge_label"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_label()</span></code></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;mouse&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">[&#39;cat&#39;, &#39;mouse&#39;, &#39;B&#39;, &#39;A&#39;]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;A&#39;), (0, 1, &#39;B&#39;), (0, 1, &#39;mouse&#39;), (1, 0, &#39;cat&#39;)]</span>
</pre></div>
</div>
<p>Finally, an exception is raised when Sage does not know how to choose
between allowing multiple edges and losing some data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">reversing the given edge is about to create two parallel</span>
<span class="go">edges but input digraph doesn&#39;t allow them - User needs to specify</span>
<span class="go">multiedges is True or False.</span>
</pre></div>
</div>
<p>The following syntax is supported, but note that you must use the
<code class="docutils literal notranslate"><span class="pre">label</span></code> keyword:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;label&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;), ((1, 2), &#39;label&#39;, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edge</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;label&#39;), (&#39;label&#39;, (1, 2), None)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.reverse_edges">
<code class="descname">reverse_edges</code><span class="sig-paren">(</span><em>edges</em>, <em>inplace=True</em>, <em>multiedges=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.reverse_edges" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Reverse a list of edges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">edges</span></code> â a list of edges in the DiGraph.</li>
<li><code class="docutils literal notranslate"><span class="pre">inplace</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">False</span></code>, a new
digraph is created and returned as output, otherwise <code class="docutils literal notranslate"><span class="pre">self</span></code> is
modified.</li>
<li><code class="docutils literal notranslate"><span class="pre">multiedges</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, input
graph will be forced to allow parallel edges when necessary (for more
information see the documentation of <a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reverse_edge()</span></code></a>)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.graphs.digraph.DiGraph.reverse_edge" title="sage.graphs.digraph.DiGraph.reverse_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reverse_edge()</span></code></a> - Reverses a single edge.</p>
</div>
<p>EXAMPLES:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">inplace</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> (default value), <code class="docutils literal notranslate"><span class="pre">self</span></code> is modified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span> <span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">]},</span> <span class="n">multiedges</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, None), (1, 0, None), (2, 3, None), (3, 0, None),</span>
<span class="go"> (3, 2, None), (4, 1, None), (5, 4, None)]</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">inplace</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> is not modified and a new digraph
is returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">re</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span>
<span class="go">....:                       inplace=False,</span>
<span class="go">....:                       multiedges=True)</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, &#39;A&#39;), (1, 0, &#39;B&#39;), (2, 1, &#39;C&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, &#39;A&#39;), (1, 0, &#39;B&#39;), (1, 2, &#39;C&#39;)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">re</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will be forced to allow parallel
edges when and only when it is necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Even if <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will not be forced to allow
parallel edges when it is not necessary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="bp">None</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, &#39;A&#39;), (2, 1, &#39;A&#39;), (3, 2, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">allows_multiple_edges</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">multiedges</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">self</span></code> will not be forced to allow
parallel edges and an edge will get deleted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 2, None), (2, 1, None)]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(2, 1, None)]</span>
</pre></div>
</div>
<p>If input edge in digraph has weight/label, then the weight/label should
be preserved in the output digraph.  User does not need to specify the
weight/label when calling function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;23&#39;</span><span class="p">)],</span> <span class="n">weighted</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">reverse_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;01&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(1, 0, &#39;01&#39;), (2, 1, 1), (3, 2, &#39;23&#39;)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.sinks">
<code class="descname">sinks</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.sinks" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of sinks of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the vertices of the digraph that have no edges beginning at them</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sinks</span><span class="p">()</span>
<span class="go">[3]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{}})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">sinks</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.sources">
<code class="descname">sources</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.sources" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of sources of the digraph.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>list of the vertices of the digraph that have no edges going into them</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
<span class="go">[1, 2]</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="p">{}})</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">sources</span><span class="p">()</span>
<span class="go">[1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strong_articulation_points">
<code class="descname">strong_articulation_points</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strong_articulation_points" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the strong articulation points of this digraph.</p>
<p>A vertex is a strong articulation point if its deletion increases the
number of strongly connected components. This method implements the
algorithm described in <a class="reference internal" href="../../../references/index.html#ils2012" id="id4">[ILS2012]</a>. The time complexity is dominated by
the time complexity of the immediate dominators finding algorithm.</p>
<p>OUTPUT: The list of strong articulation points.</p>
<p>EXAMPLES:</p>
<p>Two cliques sharing a vertex:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.connectivity</span> <span class="kn">import</span> <span class="n">strong_articulation_points</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_clique</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">strong_articulation_points</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">[3]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strong_articulation_points</span><span class="p">()</span>
<span class="go">[3]</span>
</pre></div>
</div>
<p>Two cliques connected by some arcs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">Complete</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edges</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">strong_articulation_points</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">[0, 3, 4, 7]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">strong_articulation_points</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">[3, 7]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">strong_articulation_points</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="sage.graphs.digraph.DiGraph.strongly_connected_components"><code class="xref py py-meth docutils literal notranslate"><span class="pre">strongly_connected_components()</span></code></a></li>
<li><a class="reference internal" href="base/boost_graph.html#sage.graphs.base.boost_graph.dominator_tree" title="sage.graphs.base.boost_graph.dominator_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dominator_tree()</span></code></a></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex">
<code class="descname">strongly_connected_component_containing_vertex</code><span class="sig-paren">(</span><em>G</em>, <em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_component_containing_vertex" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the strongly connected component containing a given vertex</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> â the input DiGraph</li>
<li><code class="docutils literal notranslate"><span class="pre">v</span></code> â a vertex</li>
</ul>
<p>EXAMPLES:</p>
<p>In the symmetric digraph of a graph, the strongly connected components are
the connected components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.connectivity</span> <span class="kn">import</span> <span class="n">strongly_connected_component_containing_vertex</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">strongly_connected_component_containing_vertex</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">strongly_connected_component_containing_vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">strongly_connected_component_containing_vertex</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">[0, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components">
<code class="descname">strongly_connected_components</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the lists of vertices in each strongly connected components (SCCs).</p>
<p>This method implements the Tarjan algorithm to compute the strongly
connected components of the digraph. It returns a list of lists of vertices,
each list of vertices representing a strongly connected component.</p>
<p>The basic idea of the algorithm is this: a depth-first search (DFS) begins
from an arbitrary start node (and subsequent DFSes are
conducted on any nodes that have not yet been found). As usual with DFSes,
the search visits every node of the graph exactly once, declining to revisit
any node that has already been explored. Thus, the collection of search
trees is a spanning forest of the graph. The strongly connected components
correspond to the subtrees of this spanning forest that have no edge
directed outside the subtree.</p>
<p>To recover these components, during the DFS, we keep the index of a node,
that is, the position in the DFS tree, and the lowlink: as soon as the
subtree rooted at <span class="math notranslate nohighlight">\(v\)</span> has been fully explored, the lowlink of <span class="math notranslate nohighlight">\(v\)</span> is the
smallest index reachable from <span class="math notranslate nohighlight">\(v\)</span> passing from descendants of <span class="math notranslate nohighlight">\(v\)</span>. If the
subtree rooted at <span class="math notranslate nohighlight">\(v\)</span> has been fully explored, and the index of <span class="math notranslate nohighlight">\(v\)</span> equals
the lowlink of <span class="math notranslate nohighlight">\(v\)</span>, that whole subtree is a new SCC.</p>
<p>For more information, see the
<a class="reference external" href="https://en.wikipedia.org/wiki/Tarjan's_strongly_connected_components_algorithm">Wikipedia article Tarjanâs_strongly_connected_components_algorithm</a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.base.static_sparse_graph</span> <span class="kn">import</span> <span class="n">tarjan_strongly_connected_components</span>
<span class="gp">sage: </span><span class="n">tarjan_strongly_connected_components</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">[[2], [1], [0]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">connected_components</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3], [4, 5, 6]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span> <span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="mi">5</span> <span class="p">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [2], [1], [0], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[3], [0, 1, 2], [6], [5], [4]]</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">()</span>
<span class="go">[[&#39;e&#39;], [&#39;c&#39;, &#39;b&#39;, &#39;d&#39;], [&#39;a&#39;]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components_digraph">
<code class="descname">strongly_connected_components_digraph</code><span class="sig-paren">(</span><em>G</em>, <em>keep_labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_digraph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the digraph of the strongly connected components</p>
<p>The digraph of the strongly connected components of a graph <span class="math notranslate nohighlight">\(G\)</span> has a vertex
per strongly connected component included in <span class="math notranslate nohighlight">\(G\)</span>. There is an edge from a
component <span class="math notranslate nohighlight">\(C_1\)</span> to a component <span class="math notranslate nohighlight">\(C_2\)</span> if there is an edge in <span class="math notranslate nohighlight">\(G\)</span> from a
vertex <span class="math notranslate nohighlight">\(u_1 \in C_1\)</span> to a vertex <span class="math notranslate nohighlight">\(u_2 \in C_2\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> â the input DiGraph</li>
<li><code class="docutils literal notranslate"><span class="pre">keep_labels</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); when
<code class="docutils literal notranslate"><span class="pre">keep_labels=True</span></code>, the resulting digraph has an edge from a component
<span class="math notranslate nohighlight">\(C_i\)</span> to a component <span class="math notranslate nohighlight">\(C_j\)</span> for each edge in <span class="math notranslate nohighlight">\(G\)</span> from a vertex <span class="math notranslate nohighlight">\(u_i \in
C_i\)</span> to a vertex <span class="math notranslate nohighlight">\(u_j \in C_j\)</span>. Hence the resulting digraph may have loops
and multiple edges. However, edges in the result with same source, target,
and label are not duplicated (see examples below). When
<code class="docutils literal notranslate"><span class="pre">keep_labels=False</span></code>, the return digraph is simple, so without loops nor
multiple edges, and edges are unlabelled.</li>
</ul>
<p>EXAMPLES:</p>
<p>Such a digraph is always acyclic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.connectivity</span> <span class="kn">import</span> <span class="n">strongly_connected_components_digraph</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">RandomDirectedGNP</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components_digraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The vertices of the digraph of strongly connected components are exactly the
strongly connected components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">digraphs</span><span class="o">.</span><span class="n">ButterflyGraph</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">is_directed_acyclic</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">V_scc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">scc_digraph</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">Set</span><span class="p">(</span><span class="n">scc</span><span class="p">)</span> <span class="ow">in</span> <span class="n">V_scc</span> <span class="k">for</span> <span class="n">scc</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">strongly_connected_components</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following digraph has three strongly connected components, and the
digraph of those is a
<code class="xref py py-meth docutils literal notranslate"><span class="pre">TransitiveTournament()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;02&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;03&quot;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;12&quot;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;21&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;23&quot;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">digraphs</span><span class="o">.</span><span class="n">TransitiveTournament</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>By default, the labels are discarded, and the result has no loops nor
multiple edges. If <code class="docutils literal notranslate"><span class="pre">keep_labels</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the labels are kept,
and the result is a multi digraph, possibly with multiple edges and
loops. However, edges in the result with same source, target, and label are
not duplicated (see the edges from 0 to the strongly connected component
<span class="math notranslate nohighlight">\(\{1,2\}\)</span> below):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;0-12&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;0-12&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;0-3&quot;</span><span class="p">},</span> <span class="mi">1</span><span class="p">:</span> <span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;1-2&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;1-3&quot;</span><span class="p">},</span> <span class="mi">2</span><span class="p">:</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;2-1&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;2-3&quot;</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">(4, 7)</span>
<span class="gp">sage: </span><span class="n">scc_digraph</span> <span class="o">=</span> <span class="n">strongly_connected_components_digraph</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">keep_labels</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">order</span><span class="p">(),</span> <span class="n">scc_digraph</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="go">(3, 6)</span>
<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">scc_digraph</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs">
<code class="descname">strongly_connected_components_subgraphs</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.strongly_connected_components_subgraphs" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the strongly connected components as a list of subgraphs.</p>
<p>EXAMPLES:</p>
<p>In the symmetric digraph of a graph, the strongly connected components are
the connected components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.connectivity</span> <span class="kn">import</span> <span class="n">strongly_connected_components_subgraphs</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">strongly_connected_components_subgraphs</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">[Subgraph of (Petersen graph): Digraph on 10 vertices]</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">strongly_connected_components_subgraphs</span><span class="p">()</span>
<span class="go">[Subgraph of (Petersen graph): Digraph on 10 vertices]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">([(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">strongly_connected_components_subgraphs</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">[Subgraph of (): Digraph on 2 vertices, Subgraph of (): Digraph on 2 vertices]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.to_directed">
<code class="descname">to_directed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.to_directed" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Since the graph is already directed, simply returns a copy of itself.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span><span class="o">.</span><span class="n">to_directed</span><span class="p">()</span>
<span class="go">Digraph on 6 vertices</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.to_undirected">
<code class="descname">to_undirected</code><span class="sig-paren">(</span><em>implementation='c_graph'</em>, <em>data_structure=None</em>, <em>sparse=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.to_undirected" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return an undirected version of the graph.</p>
<p>Every directed edge becomes an edge.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">data_structure</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); one of
<code class="docutils literal notranslate"><span class="pre">&quot;sparse&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;static_sparse&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;dense&quot;</span></code>. See the
documentation of <a class="reference internal" href="graph.html#sage.graphs.graph.Graph" title="sage.graphs.graph.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a> or <a class="reference internal" href="#sage.graphs.digraph.DiGraph" title="sage.graphs.digraph.DiGraph"><code class="xref py py-class docutils literal notranslate"><span class="pre">DiGraph</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">sparse</span></code> â boolean (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); <code class="docutils literal notranslate"><span class="pre">sparse=True</span></code> is an
alias for <code class="docutils literal notranslate"><span class="pre">data_structure=&quot;sparse&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">sparse=False</span></code> is an
alias for <code class="docutils literal notranslate"><span class="pre">data_structure=&quot;dense&quot;</span></code>.</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">to_undirected</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2), (1, 0)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(0, 1), (0, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.topological_sort">
<code class="descname">topological_sort</code><span class="sig-paren">(</span><em>implementation='default'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.topological_sort" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a topological sort of the digraph if it is acyclic.</p>
<p>If the digraph contains a directed cycle, a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is raised. As
topological sorts are not necessarily unique, different implementations
may yield different results.</p>
<p>A topological sort is an ordering of the vertices of the digraph such
that each vertex comes before all of its successors. That is, if <span class="math notranslate nohighlight">\(u\)</span>
comes before <span class="math notranslate nohighlight">\(v\)</span> in the sort, then there may be a directed path from <span class="math notranslate nohighlight">\(u\)</span>
to <span class="math notranslate nohighlight">\(v\)</span>, but there will be no directed path from <span class="math notranslate nohighlight">\(v\)</span> to <span class="math notranslate nohighlight">\(u\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">implementation</span></code> â string (default: <code class="docutils literal notranslate"><span class="pre">&quot;default&quot;</span></code>); either use the
default Cython implementation, or the default NetworkX library
(<code class="docutils literal notranslate"><span class="pre">implementation</span> <span class="pre">=</span> <span class="pre">&quot;NetworkX&quot;</span></code>)</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="#sage.graphs.digraph.DiGraph.is_directed_acyclic" title="sage.graphs.digraph.DiGraph.is_directed_acyclic"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_directed_acyclic()</span></code></a> â Tests whether a directed graph is
acyclic (can also join a certificate â a topological sort or a
circuit in the graph).</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">4</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="mi">3</span><span class="p">:</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span>
<span class="go">....:   5: [6, 7], 7: [8], 6: [9], 8: [10], 9: [10]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="go">[4, 5, 6, 9, 0, 1, 2, 3, 7, 8, 10]</span>
</pre></div>
</div>
<p>Using the NetworkX implementation</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">implementation</span><span class="o">=</span><span class="s2">&quot;NetworkX&quot;</span><span class="p">))</span>
<span class="go">[4, 5, 6, 9, 0, 3, 2, 7, 1, 8, 10]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">digraph is not acyclic; there is no topological sort</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.digraph.DiGraph.topological_sort_generator">
<code class="descname">topological_sort_generator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.digraph.DiGraph.topological_sort_generator" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return a list of all topological sorts of the digraph.</p>
<p>If the digraph contains a directed cycle, a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> is raised.</p>
<p>A topological sort is an ordering of the vertices of the digraph such
that each vertex comes before all of its successors. That is, if u comes
before v in the sort, then there may be a directed path from u to v, but
there will be no directed path from v to u. See also
<a class="reference internal" href="#sage.graphs.digraph.DiGraph.topological_sort" title="sage.graphs.digraph.DiGraph.topological_sort"><code class="xref py py-meth docutils literal notranslate"><span class="pre">topological_sort()</span></code></a>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mike Hansen - original implementation</li>
<li>Robert L. Miller: wrapping, documentation</li>
</ul>
<p>REFERENCE:</p>
<ul class="simple">
<li>[1] Pruesse, Gara and Ruskey, Frank. Generating Linear
Extensions Fast. SIAM J. Comput., Vol. 23 (1994), no. 2, pp.
373-386.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">DiGraph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="mi">2</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s1">&#39;circular&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">topological_sort_generator</span><span class="p">()</span>
<span class="go">[[0, 1, 2, 3, 4], [0, 1, 2, 4, 3], [0, 2, 1, 3, 4], [0, 2, 1, 4, 3], [0, 2, 4, 1, 3]]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">sort</span> <span class="ow">in</span> <span class="n">D</span><span class="o">.</span><span class="n">topological_sort_generator</span><span class="p">():</span>
<span class="go">....:     for u, v in D.edge_iterator(labels=False):</span>
<span class="go">....:         if sort.index(u) &gt; sort.index(v):</span>
<span class="go">....:             print(&quot;this should never happen&quot;)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Directed graphs</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="graph.html"
                        title="previous chapter">Undirected graphs</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bipartite_graph.html"
                        title="next chapter">Bipartite graphs</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/graphs/digraph.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bipartite_graph.html" title="Bipartite graphs"
             >next</a> |</li>
        <li class="right" >
          <a href="graph.html" title="Undirected graphs"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Graph Theory</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>