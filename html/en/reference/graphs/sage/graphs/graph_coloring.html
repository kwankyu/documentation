
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Graph coloring &#8212; Sage Reference Manual v8.3: Graph Theory</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Interface with Cliquer (clique-related problems)" href="cliquer.html" />
    <link rel="prev" title="Incidence structures (i.e. hypergraphs, i.e. set systems)" href="../combinat/designs/incidence_structures.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cliquer.html" title="Interface with Cliquer (clique-related problems)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../combinat/designs/incidence_structures.html" title="Incidence structures (i.e. hypergraphs, i.e. set systems)"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Graph Theory</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="graph-coloring">
<span id="sage-graphs-graph-coloring"></span><h1>Graph coloring<a class="headerlink" href="#graph-coloring" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.graphs.graph_coloring"></span><p>This module gathers all methods related to graph coloring. Here is what it can
do :</p>
<p><strong>Proper vertex coloring</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.all_graph_colorings" title="sage.graphs.graph_coloring.all_graph_colorings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_graph_colorings()</span></code></a></td>
<td>Computes all <span class="math notranslate nohighlight">\(n\)</span>-colorings a graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.first_coloring" title="sage.graphs.graph_coloring.first_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">first_coloring()</span></code></a></td>
<td>Returns the first vertex coloring found</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.number_of_n_colorings" title="sage.graphs.graph_coloring.number_of_n_colorings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">number_of_n_colorings()</span></code></a></td>
<td>Computes the number of <span class="math notranslate nohighlight">\(n\)</span>-colorings of a graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.numbers_of_colorings" title="sage.graphs.graph_coloring.numbers_of_colorings"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numbers_of_colorings()</span></code></a></td>
<td>Computes the number of colorings of a graph</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.chromatic_number" title="sage.graphs.graph_coloring.chromatic_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">chromatic_number()</span></code></a></td>
<td>Returns the chromatic number of the graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.vertex_coloring" title="sage.graphs.graph_coloring.vertex_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">vertex_coloring()</span></code></a></td>
<td>Computes Vertex colorings and chromatic numbers</td>
</tr>
</tbody>
</table>
<p><strong>Other colorings</strong></p>
<table border="1" class="colwidths-given contentstable docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.grundy_coloring" title="sage.graphs.graph_coloring.grundy_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">grundy_coloring()</span></code></a></td>
<td>Computes Grundy numbers and Grundy colorings</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.b_coloring" title="sage.graphs.graph_coloring.b_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">b_coloring()</span></code></a></td>
<td>Computes a b-chromatic numbers and b-colorings</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.edge_coloring" title="sage.graphs.graph_coloring.edge_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_coloring()</span></code></a></td>
<td>Compute chromatic index and edge colorings</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.round_robin" title="sage.graphs.graph_coloring.round_robin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">round_robin()</span></code></a></td>
<td>Computes a round-robin coloring of the complete graph on <span class="math notranslate nohighlight">\(n\)</span> vertices</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#sage.graphs.graph_coloring.linear_arboricity" title="sage.graphs.graph_coloring.linear_arboricity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">linear_arboricity()</span></code></a></td>
<td>Computes the linear arboricity of the given graph</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#sage.graphs.graph_coloring.acyclic_edge_coloring" title="sage.graphs.graph_coloring.acyclic_edge_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">acyclic_edge_coloring()</span></code></a></td>
<td>Computes an acyclic edge coloring of the current graph</td>
</tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>Tom Boothby (2008-02-21): Initial version</li>
<li>Carlo Hamalainen (2009-03-28): minor change: switch to C++ DLX solver</li>
<li>Nathann Cohen (2009-10-24): Coloring methods using linear programming</li>
</ul>
<div class="section" id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sage.graphs.graph_coloring.Test">
<em class="property">class </em><code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">Test</code><a class="headerlink" href="#sage.graphs.graph_coloring.Test" title="Permalink to this definition">¶</a></dt>
<dd><p>This class performs randomized testing for all_graph_colorings.
Since everything else in this file is derived from
all_graph_colorings, this is a pretty good randomized tester for
the entire file.  Note that for a graph <span class="math notranslate nohighlight">\(G\)</span>, <code class="docutils literal notranslate"><span class="pre">G.chromatic_polynomial()</span></code>
uses an entirely different algorithm, so we provide a good,
independent test.</p>
<dl class="method">
<dt id="sage.graphs.graph_coloring.Test.random">
<code class="descname">random</code><span class="sig-paren">(</span><em>tests=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.Test.random" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <code class="docutils literal notranslate"><span class="pre">self.random_all_graph_colorings()</span></code>.  In the future, if
other methods are added, it should call them, too.</p>
</dd></dl>

<dl class="method">
<dt id="sage.graphs.graph_coloring.Test.random_all_graph_colorings">
<code class="descname">random_all_graph_colorings</code><span class="sig-paren">(</span><em>tests=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.Test.random_all_graph_colorings" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies the results of <code class="docutils literal notranslate"><span class="pre">all_graph_colorings()</span></code> in three ways:</p>
<ol class="arabic simple">
<li>all colorings are unique</li>
<li>number of m-colorings is <span class="math notranslate nohighlight">\(P(m)\)</span> (where <span class="math notranslate nohighlight">\(P\)</span> is the chromatic
polynomial of the graph being tested)</li>
<li>colorings are valid – that is, that no two vertices of
the same color share an edge.</li>
</ol>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.acyclic_edge_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">acyclic_edge_coloring</code><span class="sig-paren">(</span><em>g</em>, <em>hex_colors=False</em>, <em>value_only=False</em>, <em>k=0</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.acyclic_edge_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes an acyclic edge coloring of the current graph.</p>
<p>An edge coloring of a graph is a assignment of colors to the edges of a
graph such that :</p>
<ul class="simple">
<li>the coloring is proper (no adjacent edges share a color)</li>
<li>For any two colors <span class="math notranslate nohighlight">\(i,j\)</span>, the union of the edges colored with <span class="math notranslate nohighlight">\(i\)</span> or <span class="math notranslate nohighlight">\(j\)</span>
is a forest.</li>
</ul>
<p>The least number of colors such that such a coloring exists for a graph <span class="math notranslate nohighlight">\(G\)</span>
is written <span class="math notranslate nohighlight">\(\chi'_a(G)\)</span>, also called the acyclic chromatic index of <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>It is conjectured that this parameter can not be too different from the
obvious lower bound <span class="math notranslate nohighlight">\(\Delta(G)\leq \chi'_a(G)\)</span>, <span class="math notranslate nohighlight">\(\Delta(G)\)</span> being the
maximum degree of <span class="math notranslate nohighlight">\(G\)</span>, which is given by the first of the two
constraints. Indeed, it is conjectured that <span class="math notranslate nohighlight">\(\Delta(G)\leq \chi'_a(G) \leq
\Delta(G) + 2\)</span>.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">hex_colors</span></code> (boolean)</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">hex_colors</span> <span class="pre">=</span> <span class="pre">True</span></code>, the function returns a dictionary
associating to each color a list of edges (meant as an argument to the
<code class="docutils literal notranslate"><span class="pre">edge_colors</span></code> keyword of the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method).</li>
<li>If <code class="docutils literal notranslate"><span class="pre">hex_colors</span> <span class="pre">=</span> <span class="pre">False</span></code> (default value), returns a list of graphs
corresponding to each color class.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">value_only</span></code> (boolean)</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">True</span></code>, only returns the acyclic chromatic index as
an integer value</li>
<li>If <code class="docutils literal notranslate"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">False</span></code>, returns the color classes according to the
value of <code class="docutils literal notranslate"><span class="pre">hex_colors</span></code></li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">k</span></code> (integer) – the number of colors to use.</p>
<blockquote>
<div><ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">k&gt;0</span></code>, computes an acyclic edge coloring using <span class="math notranslate nohighlight">\(k\)</span> colors.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">k=0</span></code> (default), computes a coloring of <span class="math notranslate nohighlight">\(G\)</span> into <span class="math notranslate nohighlight">\(\Delta(G) + 2\)</span>
colors, which is the conjectured general bound.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">k=None</span></code>, computes a decomposition using the least possible
number of colors.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP) solver to
be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is used. For more information
on LP solvers and which default solver is used, see the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of verbosity of
the LP solver. Set to 0 by default, which means quiet.</p>
</li>
</ul>
<p>ALGORITHM:</p>
<p>Linear Programming</p>
<p>EXAMPLES:</p>
<p>The complete graph on 8 vertices can not be acyclically edge-colored with
less <span class="math notranslate nohighlight">\(\Delta+1\)</span> colors, but it can be colored with <span class="math notranslate nohighlight">\(\Delta+2=9\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">acyclic_edge_coloring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">colors</span> <span class="o">=</span> <span class="n">acyclic_edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
<p>Each color class is of course a matching</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="nb">max</span><span class="p">(</span><span class="n">gg</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span><span class="o">&lt;=</span><span class="mi">1</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>These matchings being a partition of the edge set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span> <span class="nb">any</span><span class="p">([</span><span class="n">gg</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">gg</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">])</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Besides, the union of any two of them is a forest</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">g1</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">g2</span><span class="p">)</span><span class="o">.</span><span class="n">is_forest</span><span class="p">()</span> <span class="k">for</span> <span class="n">g1</span> <span class="ow">in</span> <span class="n">colors</span> <span class="k">for</span> <span class="n">g2</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If one wants to acyclically color a cycle on <span class="math notranslate nohighlight">\(4\)</span> vertices, at least 3 colors
will be necessary. The function raises an exception when asked to color it
with only 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CycleGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">acyclic_edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This graph can not be colored with the given number of colors.</span>
</pre></div>
</div>
<p>The optimal coloring give us <span class="math notranslate nohighlight">\(3\)</span> classes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">colors</span> <span class="o">=</span> <span class="n">acyclic_edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="bp">None</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.all_graph_colorings">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">all_graph_colorings</code><span class="sig-paren">(</span><em>G</em>, <em>n</em>, <em>count_only=False</em>, <em>hex_colors=False</em>, <em>vertex_color_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.all_graph_colorings" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes all <span class="math notranslate nohighlight">\(n\)</span>-colorings of the graph <span class="math notranslate nohighlight">\(G\)</span> by casting the graph
coloring problem into an exact cover problem, and passing this
into an implementation of the Dancing Links algorithm described
by Knuth (who attributes the idea to Hitotumatu and Noshita).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">G</span></code> - a graph</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> - a positive integer the number of colors</li>
<li><dl class="first docutils">
<dt><span class="math notranslate nohighlight">\(count_only\)</span> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, it returns 1</dt>
<dd>for each coloring</dd>
</dl>
</li>
<li><span class="math notranslate nohighlight">\(hex_colors\)</span> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, it labels
the colors [0,1,.., <code class="docutils literal notranslate"><span class="pre">n</span></code> - 1], otherwise it uses the RGB Hex labeling</li>
<li><span class="math notranslate nohighlight">\(vertex_color_dict\)</span> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, it
returns a dictionary {vertex:color}, otherwise it returns a dictionary
{color:[list of vertices]}</li>
</ul>
<p>The construction works as follows. Columns:</p>
<ul class="simple">
<li>The first <span class="math notranslate nohighlight">\(|V|\)</span> columns correspond to a vertex – a <span class="math notranslate nohighlight">\(1\)</span> in this
column indicates that that vertex has a color.</li>
<li>After those <span class="math notranslate nohighlight">\(|V|\)</span> columns, we add <span class="math notranslate nohighlight">\(n*|E|\)</span> columns – a <span class="math notranslate nohighlight">\(1\)</span> in
these columns indicate that a particular edge is
incident to a vertex with a certain color.</li>
</ul>
<p>Rows:</p>
<ul class="simple">
<li>For each vertex, add <span class="math notranslate nohighlight">\(n\)</span> rows; one for each color <span class="math notranslate nohighlight">\(c\)</span>.  Place
a <span class="math notranslate nohighlight">\(1\)</span> in the column corresponding to the vertex, and a <span class="math notranslate nohighlight">\(1\)</span>
in the appropriate column for each edge incident to the
vertex, indicating that that edge is incident to the
color <span class="math notranslate nohighlight">\(c\)</span>.</li>
<li>If <span class="math notranslate nohighlight">\(n &gt; 2\)</span>, the above construction cannot be exactly covered
since each edge will be incident to only two vertices
(and hence two colors) - so we add <span class="math notranslate nohighlight">\(n*|E|\)</span> rows, each one
containing a <span class="math notranslate nohighlight">\(1\)</span> for each of the <span class="math notranslate nohighlight">\(n*|E|\)</span> columns.  These
get added to the cover solutions “for free” during the
backtracking.</li>
</ul>
<p>Note that this construction results in <span class="math notranslate nohighlight">\(n*|V| + 2*n*|E| + n*|E|\)</span>
entries in the matrix.  The Dancing Links algorithm uses a
sparse representation, so if the graph is simple, <span class="math notranslate nohighlight">\(|E| \leq |V|^2\)</span>
and <span class="math notranslate nohighlight">\(n &lt;= |V|\)</span>, this construction runs in <span class="math notranslate nohighlight">\(O(|V|^3)\)</span> time.
Back-conversion to a coloring solution is a simple scan of the
solutions, which will contain <span class="math notranslate nohighlight">\(|V| + (n-2)*|E|\)</span> entries,  so
runs in <span class="math notranslate nohighlight">\(O(|V|^3)\)</span> time also.  For most graphs, the conversion
will be much faster – for example, a planar graph will be
transformed for <span class="math notranslate nohighlight">\(4\)</span>-coloring in linear time since <span class="math notranslate nohighlight">\(|E| = O(|V|)\)</span>.</p>
<p>REFERENCES:</p>
<p><a class="reference external" href="http://www-cs-staff.stanford.edu/~uno/papers/dancing-color.ps.gz">http://www-cs-staff.stanford.edu/~uno/papers/dancing-color.ps.gz</a></p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">all_graph_colorings</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">all_graph_colorings</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">hex_colors</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="go">....:     parts = [C[k] for k in C]</span>
<span class="go">....:     for P in parts:</span>
<span class="go">....:         l = len(P)</span>
<span class="go">....:         for i in range(l):</span>
<span class="go">....:             for j in range(i+1,l):</span>
<span class="go">....:                 if G.has_edge(P[i],P[j]):</span>
<span class="go">....:                     raise RuntimeError(&quot;Coloring Failed.&quot;)</span>
<span class="go">....:     n+=1</span>
<span class="gp">sage: </span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;G has </span><span class="si">%s</span><span class="s2"> 3-colorings.&quot;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>
<span class="go">G has 12 3-colorings.</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.b_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">b_coloring</code><span class="sig-paren">(</span><em>g</em>, <em>k</em>, <em>value_only=True</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.b_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a b-coloring with at most k colors that maximizes the
number of colors, if such a coloring exists</p>
<p>Definition :</p>
<p>Given a proper coloring of a graph <span class="math notranslate nohighlight">\(G\)</span> and a color class <span class="math notranslate nohighlight">\(C\)</span> such
that none of its vertices have neighbors in all the other color
classes, one can eliminate color class <span class="math notranslate nohighlight">\(C\)</span> assigning to each of
its elements a missing color in its neighborhood.</p>
<p>Let a b-vertex be a vertex with neighbors in all other colorings.
Then, one can repeat the above procedure until a coloring
is obtained where every color class contains a b-vertex,
in which case none of the color classes can be eliminated
with the same ideia.  So, one can define a b-coloring as a
proper coloring where each color class has a b-vertex.</p>
<p>In the worst case, after successive applications of the above procedure,
one get a proper coloring that uses a number of colors equal to the
the b-chromatic number of <span class="math notranslate nohighlight">\(G\)</span> (denoted <span class="math notranslate nohighlight">\(\chi_b(G)\)</span>):
the maximum <span class="math notranslate nohighlight">\(k\)</span> such that <span class="math notranslate nohighlight">\(G\)</span> admits a b-coloring with <span class="math notranslate nohighlight">\(k\)</span> colors.</p>
<p>An useful upper bound for calculating the b-chromatic number is
the following. If G admits a b-coloring with k colors, then there
are <span class="math notranslate nohighlight">\(k\)</span> vertices of degree at least <span class="math notranslate nohighlight">\(k - 1\)</span> (the b-vertices of
each color class). So, if we set <span class="math notranslate nohighlight">\(m(G) = max\)</span> {<span class="math notranslate nohighlight">\(k | `there are
k vertices of degree at least `k - 1\)</span>}, we have that <span class="math notranslate nohighlight">\(\chi_b(G)
\leq m(G)\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This method computes a b-coloring that uses at <em>MOST</em> <span class="math notranslate nohighlight">\(k\)</span>
colors. If this method returns a value equal to <span class="math notranslate nohighlight">\(k\)</span>, it can not
be assumed that <span class="math notranslate nohighlight">\(k\)</span> is equal to <span class="math notranslate nohighlight">\(\chi_b(G)\)</span>. Meanwhile, if it
returns any value <span class="math notranslate nohighlight">\(k' &lt; k\)</span>, this is a certificate that the
Grundy number of the given graph is <span class="math notranslate nohighlight">\(k'\)</span>.</p>
<p class="last">As <span class="math notranslate nohighlight">\(\chi_b(G)\leq m(G)\)</span>, it can be assumed that
<span class="math notranslate nohighlight">\(\chi_b(G) = k\)</span> if <code class="docutils literal notranslate"><span class="pre">b_coloring(g,</span> <span class="pre">k)</span></code> returns <span class="math notranslate nohighlight">\(k\)</span> when
<span class="math notranslate nohighlight">\(k = m(G)\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> (integer) – Maximum number of colors</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP)
solver to be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>). When set to
<code class="docutils literal notranslate"><span class="pre">True</span></code>, only the number of colors is returned. Otherwise, the
pair <code class="docutils literal notranslate"><span class="pre">(nb_colors,</span> <span class="pre">coloring)</span></code> is returned, where <code class="docutils literal notranslate"><span class="pre">coloring</span></code>
is a dictionary associating its color (integer) to each vertex
of the graph.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>Integer Linear Program.</p>
<p>EXAMPLES:</p>
<p>The b-chromatic number of a <span class="math notranslate nohighlight">\(P_5\)</span> is equal to 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">b_coloring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The b-chromatic number of the Petersen Graph is equal to 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">b_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>It would have been sufficient to set the value of <code class="docutils literal notranslate"><span class="pre">k</span></code> to 4 in
this case, as <span class="math notranslate nohighlight">\(4 = m(G)\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.chromatic_number">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">chromatic_number</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.chromatic_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimal number of colors needed to color the
vertices of the graph <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">chromatic_number</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">chromatic_number</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">3</span>

<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">chromatic_number</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.edge_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">edge_coloring</code><span class="sig-paren">(</span><em>g</em>, <em>value_only=False</em>, <em>vizing=False</em>, <em>hex_colors=False</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.edge_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute chromatic index and edge colorings.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">g</span></code> – a graph.</li>
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>):<ul>
<li>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the chromatic index is returned.</li>
<li>When set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, a partition of the edge set into
matchings is returned if possible.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">vizing</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>):<ul>
<li>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, tries to find a <span class="math notranslate nohighlight">\(\Delta + 1\)</span>-edge-coloring,
where <span class="math notranslate nohighlight">\(\Delta\)</span> is equal to the maximum degree in the graph.</li>
<li>When set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, tries to find a <span class="math notranslate nohighlight">\(\Delta\)</span>-edge-coloring,
where <span class="math notranslate nohighlight">\(\Delta\)</span> is equal to the maximum degree in the graph. If
impossible, tries to find and returns a <span class="math notranslate nohighlight">\(\Delta + 1\)</span>-edge-coloring.
This implies that <code class="docutils literal notranslate"><span class="pre">value_only=False</span></code>.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">hex_colors</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
partition returned is a dictionary whose keys are colors and whose
values are the color classes (ideal for plotting).</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP)
solver to be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is
used. For more information on LP solvers and which default
solver is used, see the method <a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a> of the
class <a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>OUTPUT:</p>
<p>In the following, <span class="math notranslate nohighlight">\(\Delta\)</span> is equal to the maximum degree in the graph
<code class="docutils literal notranslate"><span class="pre">g</span></code>.</p>
<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">vizing=True</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=False</span></code>, return a partition of
the edge set into <span class="math notranslate nohighlight">\(\Delta + 1\)</span> matchings.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">vizing=False</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=True</span></code>, return the chromatic index.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">vizing=False</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=False</span></code>, return a partition of
the edge set into the minimum number of matchings.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">vizing=True</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=True</span></code>, should return something,
but mainly you are just trying to compute the maximum degree of the
graph, and this is not the easiest way. By Vizing’s theorem, a graph
has a chromatic index equal to <span class="math notranslate nohighlight">\(\Delta\)</span> or to <span class="math notranslate nohighlight">\(\Delta + 1\)</span>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a few cases, it is possible to find very quickly the chromatic
index of a graph, while it remains a tedious job to compute
a corresponding coloring. For this reason, <code class="docutils literal notranslate"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">True</span></code>
can sometimes be much faster, and it is a bad idea to compute
the whole coloring if you do not need it !</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Edge_coloring">Wikipedia article Edge_coloring</a> for further details on edge coloring</li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.chromatic_index" title="sage.graphs.graph.Graph.chromatic_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">chromatic_index()</span></code></a></li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.fractional_chromatic_index" title="sage.graphs.graph.Graph.fractional_chromatic_index"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fractional_chromatic_index()</span></code></a></li>
<li><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.chromatic_number" title="sage.graphs.graph.Graph.chromatic_number"><code class="xref py py-meth docutils literal notranslate"><span class="pre">chromatic_number()</span></code></a></li>
<li><a class="reference internal" href="#sage.graphs.graph_coloring.vertex_coloring" title="sage.graphs.graph_coloring.vertex_coloring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.graph_coloring.vertex_coloring()</span></code></a></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>The Petersen graph has chromatic index 4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">edge_coloring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;GLPK&#39;</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;GLPK&#39;</span><span class="p">)</span>
<span class="go">[[(0, 1), (2, 3), (4, 9), (5, 7)],</span>
<span class="go"> [(0, 4), (1, 2), (3, 8), (6, 9)],</span>
<span class="go"> [(1, 6), (5, 8), (7, 9)],</span>
<span class="go"> [(0, 5), (2, 7), (3, 4), (6, 8)]]</span>
<span class="gp">sage: </span><span class="n">edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">hex_colors</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;GLPK&#39;</span><span class="p">)</span>
<span class="go">{&#39;#00ffff&#39;: [(1, 6), (5, 8), (7, 9)],</span>
<span class="go"> &#39;#7f00ff&#39;: [(0, 5), (2, 7), (3, 4), (6, 8)],</span>
<span class="go"> &#39;#7fff00&#39;: [(0, 4), (1, 2), (3, 8), (6, 9)],</span>
<span class="go"> &#39;#ff0000&#39;: [(0, 1), (2, 3), (4, 9), (5, 7)]}</span>
</pre></div>
</div>
<p>Complete graphs are colored using the linear-time round-robin coloring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">edge_coloring</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">edge_coloring</span><span class="p">(</span><span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="go">19</span>
</pre></div>
</div>
<p>The chromatic index of a non connected graph is the maximum over
its connected components:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">edge_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.first_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">first_coloring</code><span class="sig-paren">(</span><em>G</em>, <em>n=0</em>, <em>hex_colors=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.first_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a graph, and optionally a natural number <span class="math notranslate nohighlight">\(n\)</span>, returns
the first coloring we find with at least <span class="math notranslate nohighlight">\(n\)</span> colors.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">hex_colors</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
partition returned is a dictionary whose keys are colors and whose
values are the color classes (ideal for plotting).</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – The minimal number of colors to try.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">first_coloring</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">1</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">first_coloring</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[[1, 3], [0], [2]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.grundy_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">grundy_coloring</code><span class="sig-paren">(</span><em>g</em>, <em>k</em>, <em>value_only=True</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.grundy_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the worst-case of a first-fit coloring with less than <span class="math notranslate nohighlight">\(k\)</span>
colors.</p>
<p>Definition :</p>
<p>A first-fit coloring is obtained by sequentially coloring the
vertices of a graph, assigning them the smallest color not already
assigned to one of its neighbors. The result is clearly a proper
coloring, which usually requires much more colors than an optimal
vertex coloring of the graph, and heavily depends on the ordering
of the vertices.</p>
<p>The number of colors required by the worst-case application of
this algorithm on a graph <span class="math notranslate nohighlight">\(G\)</span> is called the Grundy number, written
<span class="math notranslate nohighlight">\(\Gamma (G)\)</span>.</p>
<p>Equivalent formulation :</p>
<p>Equivalently, a Grundy coloring is a proper vertex coloring such
that any vertex colored with <span class="math notranslate nohighlight">\(i\)</span> has, for every <span class="math notranslate nohighlight">\(j&lt;i\)</span>, a neighbor
colored with <span class="math notranslate nohighlight">\(j\)</span>. This can define a Linear Program, which is used
here to compute the Grundy number of a graph.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This method computes a grundy coloring using at <em>MOST</em> <span class="math notranslate nohighlight">\(k\)</span>
colors. If this method returns a value equal to <span class="math notranslate nohighlight">\(k\)</span>, it can not
be assumed that <span class="math notranslate nohighlight">\(k\)</span> is equal to <span class="math notranslate nohighlight">\(\Gamma(G)\)</span>. Meanwhile, if it
returns any value <span class="math notranslate nohighlight">\(k' &lt; k\)</span>, this is a certificate that the
Grundy number of the given graph is <span class="math notranslate nohighlight">\(k'\)</span>.</p>
<p class="last">As <span class="math notranslate nohighlight">\(\Gamma(G)\leq \Delta(G)+1\)</span>, it can also be assumed that
<span class="math notranslate nohighlight">\(\Gamma(G) = k\)</span> if <code class="docutils literal notranslate"><span class="pre">grundy_coloring(g,</span> <span class="pre">k)</span></code> returns <span class="math notranslate nohighlight">\(k\)</span> when
<span class="math notranslate nohighlight">\(k = \Delta(G) +1\)</span>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> (integer) – Maximum number of colors</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP)
solver to be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is used. For
more information on LP solvers and which default solver is used, see
the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a>
of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>). When set to
<code class="docutils literal notranslate"><span class="pre">True</span></code>, only the number of colors is returned. Otherwise, the
pair <code class="docutils literal notranslate"><span class="pre">(nb_colors,</span> <span class="pre">coloring)</span></code> is returned, where <code class="docutils literal notranslate"><span class="pre">coloring</span></code>
is a dictionary associating its color (integer) to each vertex
of the graph.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>Integer Linear Program.</p>
<p>EXAMPLES:</p>
<p>The Grundy number of a <span class="math notranslate nohighlight">\(P_4\)</span> is equal to 3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">grundy_coloring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PathGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">grundy_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>The Grundy number of the PetersenGraph is equal to 4:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">grundy_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>It would have been sufficient to set the value of <code class="docutils literal notranslate"><span class="pre">k</span></code> to 4 in
this case, as <span class="math notranslate nohighlight">\(4 = \Delta(G)+1\)</span>.</p>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.linear_arboricity">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">linear_arboricity</code><span class="sig-paren">(</span><em>g</em>, <em>plus_one=None</em>, <em>hex_colors=False</em>, <em>value_only=False</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.linear_arboricity" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the linear arboricity of the given graph.</p>
<p>The linear arboricity of a graph <span class="math notranslate nohighlight">\(G\)</span> is the least number <span class="math notranslate nohighlight">\(la(G)\)</span> such that
the edges of <span class="math notranslate nohighlight">\(G\)</span> can be partitioned into linear forests (i.e. into forests
of paths).</p>
<p>Obviously, <span class="math notranslate nohighlight">\(la(G)\geq \lceil \frac{\Delta(G)}{2} \rceil\)</span>.</p>
<p>It is conjectured in <a class="reference internal" href="../../../references/index.html#aki1980" id="id1">[Aki1980]</a> that <span class="math notranslate nohighlight">\(la(G)\leq \lceil \frac{\Delta(G)+1}{2}
\rceil\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">hex_colors</span></code> (boolean)<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">hex_colors</span> <span class="pre">=</span> <span class="pre">True</span></code>, the function returns a dictionary associating
to each color a list of edges (meant as an argument to the
<code class="docutils literal notranslate"><span class="pre">edge_colors</span></code> keyword of the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method).</li>
<li>If <code class="docutils literal notranslate"><span class="pre">hex_colors</span> <span class="pre">=</span> <span class="pre">False</span></code> (default value), returns a list of graphs
corresponding to each color class.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> (boolean)<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">True</span></code>, only returns the linear arboricity as an
integer value.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">value_only</span> <span class="pre">=</span> <span class="pre">False</span></code>, returns the color classes according to the
value of <code class="docutils literal notranslate"><span class="pre">hex_colors</span></code></li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">plus_one</span></code> (integer) – whether to use <span class="math notranslate nohighlight">\(\lceil \frac{\Delta(G)}{2}
\rceil\)</span> or <span class="math notranslate nohighlight">\(\lceil \frac{\Delta(G)+1}{2} \rceil\)</span> colors.<ul>
<li>If <code class="docutils literal notranslate"><span class="pre">0</span></code>, computes a decomposition of <span class="math notranslate nohighlight">\(G\)</span> into <span class="math notranslate nohighlight">\(\lceil
\frac{\Delta(G)}{2} \rceil\)</span> forests of paths</li>
<li>If <code class="docutils literal notranslate"><span class="pre">1</span></code>, computes a decomposition of <span class="math notranslate nohighlight">\(G\)</span> into <span class="math notranslate nohighlight">\(\lceil
\frac{\Delta(G)+1}{2} \rceil\)</span> colors, which is the conjectured general
bound.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">plus_one</span> <span class="pre">=</span> <span class="pre">None</span></code> (default), computes a decomposition using the
least possible number of colors.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP) solver to
be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is used. For more information
on LP solvers and which default solver is used, see the method
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve()</span></code></a> of the class
<a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of verbosity of
the LP solver. Set to 0 by default, which means quiet.</li>
</ul>
<p>ALGORITHM:</p>
<p>Linear Programming</p>
<p>COMPLEXITY:</p>
<p>NP-Hard</p>
<p>EXAMPLES:</p>
<p>Obviously, a square grid has a linear arboricity of 2, as the set of
horizontal lines and the set of vertical lines are an admissible partition:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">linear_arboricity</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">GridGraph</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">g1</span><span class="p">,</span><span class="n">g2</span> <span class="o">=</span> <span class="n">linear_arboricity</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
</pre></div>
</div>
<p>Each graph is of course a forest:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g1</span><span class="o">.</span><span class="n">is_forest</span><span class="p">()</span> <span class="ow">and</span> <span class="n">g2</span><span class="o">.</span><span class="n">is_forest</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Of maximum degree 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">max</span><span class="p">(</span><span class="n">g1</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">g2</span><span class="o">.</span><span class="n">degree</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="mi">2</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Which constitutes a partition of the whole edge set:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">all</span><span class="p">([</span><span class="n">g1</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="ow">or</span> <span class="n">g2</span><span class="o">.</span><span class="n">has_edge</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.number_of_n_colorings">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">number_of_n_colorings</code><span class="sig-paren">(</span><em>G</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.number_of_n_colorings" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the number of <span class="math notranslate nohighlight">\(n\)</span>-colorings of a graph</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">number_of_n_colorings</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">number_of_n_colorings</span><span class="p">(</span><span class="n">G</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.numbers_of_colorings">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">numbers_of_colorings</code><span class="sig-paren">(</span><em>G</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.numbers_of_colorings" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of <span class="math notranslate nohighlight">\(n\)</span>-colorings of the graph <span class="math notranslate nohighlight">\(G\)</span> for <span class="math notranslate nohighlight">\(n\)</span> from
<span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(|V|\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">numbers_of_colorings</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">0</span><span class="p">:[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span><span class="mi">1</span><span class="p">:[</span><span class="mi">2</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">numbers_of_colorings</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="go">[0, 0, 0, 12, 72]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.round_robin">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">round_robin</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.round_robin" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes a round-robin coloring of the complete graph on <span class="math notranslate nohighlight">\(n\)</span> vertices.</p>
<p>A round-robin coloring of the complete graph <span class="math notranslate nohighlight">\(G\)</span> on <span class="math notranslate nohighlight">\(2n\)</span> vertices
(<span class="math notranslate nohighlight">\(V = [0, \dots, 2n - 1]\)</span>) is a proper coloring of its edges such that
the edges with color <span class="math notranslate nohighlight">\(i\)</span> are all the <span class="math notranslate nohighlight">\((i + j, i - j)\)</span> plus the
edge <span class="math notranslate nohighlight">\((2n - 1, i)\)</span>.</p>
<p>If <span class="math notranslate nohighlight">\(n\)</span> is odd, one obtain a round-robin coloring of the complete graph
through the round-robin coloring of the graph with <span class="math notranslate nohighlight">\(n + 1\)</span> vertices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – the number of vertices in the complete graph.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>A <code class="docutils literal notranslate"><span class="pre">CompleteGraph</span></code> with labelled edges such that the label of each
edge is its color.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">round_robin</span>
<span class="gp">sage: </span><span class="n">round_robin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 2), (0, 2, 1), (1, 2, 0)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">round_robin</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">()</span>
<span class="go">[(0, 1, 2), (0, 2, 1), (0, 3, 0), (1, 2, 0), (1, 3, 1), (2, 3, 2)]</span>
</pre></div>
</div>
<p>For higher orders, the coloring is still proper and uses the expected
number of colors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">round_robin</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">round_robin</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">([</span><span class="n">Set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges_incident</span><span class="p">(</span><span class="n">v</span><span class="p">)])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="p">])</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="n">g</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Set</span><span class="p">([</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">()])</span><span class="o">.</span><span class="n">cardinality</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.graphs.graph_coloring.vertex_coloring">
<code class="descclassname">sage.graphs.graph_coloring.</code><code class="descname">vertex_coloring</code><span class="sig-paren">(</span><em>g</em>, <em>k=None</em>, <em>value_only=False</em>, <em>hex_colors=False</em>, <em>solver=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.graph_coloring.vertex_coloring" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the chromatic number of the given graph or tests its
<span class="math notranslate nohighlight">\(k\)</span>-colorability. See <a class="reference external" href="https://en.wikipedia.org/wiki/Graph_coloring">Wikipedia article Graph_coloring</a> for
further details on graph coloring.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">g</span></code> – a graph.</li>
<li><code class="docutils literal notranslate"><span class="pre">k</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) tests whether the graph is <span class="math notranslate nohighlight">\(k\)</span>-colorable.
The function returns a partition of the vertex set in <span class="math notranslate nohighlight">\(k\)</span> independent
sets if possible and <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</li>
<li><code class="docutils literal notranslate"><span class="pre">value_only</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>):<ul>
<li>When set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the chromatic number is returned.</li>
<li>When set to <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), a partition of the vertex set into
independent sets is returned if possible.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">hex_colors</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) when set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, the
partition returned is a dictionary whose keys are colors and whose
values are the color classes (ideal for plotting).</li>
<li><code class="docutils literal notranslate"><span class="pre">solver</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) Specify a Linear Program (LP)
solver to be used. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, the default one is
used. For more information on LP solvers and which default
solver is used, see the method <a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram.solve" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">solve</span></code></a> of the
class <a class="reference external" href="../../../numerical/sage/numerical/mip.html#sage.numerical.mip.MixedIntegerLinearProgram" title="(in Sage Reference Manual: Numerical Optimization v8.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MixedIntegerLinearProgram</span></code></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> – integer (default: <code class="docutils literal notranslate"><span class="pre">0</span></code>). Sets the level of
verbosity. Set to 0 by default, which means quiet.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>If <code class="docutils literal notranslate"><span class="pre">k=None</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=False</span></code>, then return a partition of the
vertex set into the minimum possible of independent sets.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">k=None</span></code> and <code class="docutils literal notranslate"><span class="pre">value_only=True</span></code>, return the chromatic number.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">k</span></code> is set and <code class="docutils literal notranslate"><span class="pre">value_only=None</span></code>, return <code class="docutils literal notranslate"><span class="pre">False</span></code> if the
graph is not <span class="math notranslate nohighlight">\(k\)</span>-colorable, and a partition of the vertex set into
<span class="math notranslate nohighlight">\(k\)</span> independent sets otherwise.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">k</span></code> is set and <code class="docutils literal notranslate"><span class="pre">value_only=True</span></code>, test whether the graph is
<span class="math notranslate nohighlight">\(k\)</span>-colorable, and return <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> accordingly.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.graph_coloring</span> <span class="kn">import</span> <span class="n">vertex_coloring</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">PetersenGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">vertex_coloring</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">value_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Graph coloring</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../combinat/designs/incidence_structures.html"
                        title="previous chapter">Incidence structures (i.e. hypergraphs, i.e. set systems)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="cliquer.html"
                        title="next chapter">Interface with Cliquer (clique-related problems)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/graphs/graph_coloring.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cliquer.html" title="Interface with Cliquer (clique-related problems)"
             >next</a> |</li>
        <li class="right" >
          <a href="../combinat/designs/incidence_structures.html" title="Incidence structures (i.e. hypergraphs, i.e. set systems)"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Graph Theory</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>