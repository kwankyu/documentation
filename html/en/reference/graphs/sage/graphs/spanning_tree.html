
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Spanning trees &#8212; Graph Theory</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/thebelab.css" />
    
    <script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="PQ-Trees" href="pq_trees.html" />
    <link rel="prev" title="Line graphs" href="line_graph.html" />
  <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
  <!-- <script src="../../../_static/thebe.js" type="text/javascript"></script> -->
  <!-- <script src="../../../_static/thebe-sage.js" type="text/javascript"></script> -->

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pq_trees.html" title="PQ-Trees"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="line_graph.html" title="Line graphs"
             accesskey="P">previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../index.html">Graph Theory</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Spanning trees</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="spanning-trees">
<span id="sage-graphs-spanning-tree"></span><h1>Spanning trees<a class="headerlink" href="#spanning-trees" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.graphs.spanning_tree"></span><p>This module is a collection of algorithms on spanning trees. Also included in
the collection are algorithms for minimum spanning trees. See the book
<a class="reference internal" href="../../../references/index.html#jnc2010" id="id1"><span>[JNC2010]</span></a> for descriptions of spanning tree algorithms,
including minimum spanning trees.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">GenericGraph.min_spanning_tree</span></code></a>.</p></li>
</ul>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Rewrite <a class="reference internal" href="#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal()</span></code></a> to use priority queues.</p></li>
<li><p>Parallel version of Boruvka’s algorithm.</p></li>
<li><p>Randomized spanning tree construction.</p></li>
</ul>
</div>
<section id="methods">
<h2>Methods<a class="headerlink" href="#methods" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.boruvka">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">boruvka</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.boruvka" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum spanning tree using Boruvka’s algorithm.</p>
<p>This function assumes that we can only compute minimum spanning trees for
undirected graphs. Such graphs can be weighted or unweighted, and they can
have multiple edges (since we are computing the minimum spanning tree, only
the minimum weight among all <span class="math notranslate nohighlight">\((u,v)\)</span>-edges is considered, for each pair of
vertices <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to first perform sanity
checks on the input graph <code class="docutils literal notranslate"><span class="pre">G</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">check=False</span></code>. If we toggle
<code class="docutils literal notranslate"><span class="pre">check=True</span></code>, the following sanity checks are first performed on <code class="docutils literal notranslate"><span class="pre">G</span></code>
prior to running Boruvka’s algorithm on that input graph:</p>
<ul class="simple">
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> the null graph or graph on one vertex?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> disconnected?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> a tree?</p></li>
</ul>
<p>By default, we turn off the sanity checks for performance reasons. This
means that by default the function assumes that its input graph is
connected, and has at least one vertex. Otherwise, you should set
<code class="docutils literal notranslate"><span class="pre">check=True</span></code> to perform some sanity checks and preprocessing on the
input graph.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, if one exists, otherwise
returns the empty list.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">min_spanning_tree()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>An example from pages 727–728 in <a class="reference internal" href="../../../references/index.html#sah2000" id="id3"><span>[Sah2000]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">boruvka</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[(1, 6, 10), (2, 7, 14), (3, 4, 12), (4, 5, 22), (5, 6, 25), (2, 3, 16)]</span>
<span class="gp">sage: </span><span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(1, 6, 10), (2, 7, 14), (3, 4, 12), (4, 5, 22), (5, 6, 25), (2, 3, 16)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(1, 2, 28), (1, 6, 10), (2, 3, 16), (2, 7, 14), (3, 4, 12), (4, 5, 22)]</span>
</pre></div>
</div>
<p>An example with custom edge labels:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]],</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">weight</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(0, 2, 10), (0, 1, 1)]</span>
</pre></div>
</div>
<p>An example of disconnected graph with <code class="docutils literal notranslate"><span class="pre">check</span></code> disabled:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">boruvka</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">16</span><span class="p">}},</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">boruvka</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.edge_disjoint_spanning_trees">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">edge_disjoint_spanning_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.edge_disjoint_spanning_trees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(k\)</span> edge-disjoint spanning trees of minimum cost.</p>
<p>This method implements the Roskind-Tarjan algorithm for finding <span class="math notranslate nohighlight">\(k\)</span>
minimum-cost edge-disjoint spanning trees in simple undirected graphs
<a class="reference internal" href="../../../references/index.html#rt1985" id="id4"><span>[RT1985]</span></a>. When edge weights are taken into account, the algorithm ensures
that the sum of the weights of the returned spanning trees is minimized. The
time complexity of the algorithm is in <span class="math notranslate nohighlight">\(O(k^2n^2)\)</span> for the unweighted case
and otherwise in <span class="math notranslate nohighlight">\(O(m\log{m} + k^2n^2)\)</span>.</p>
<p>This method raises an error if the graph does not contain the requested
number of spanning trees.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – a simple undirected graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">k</span></code> – the requested number of edge-disjoint spanning trees</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted, otherwise all edges have weight 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, we check
that the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
</ul>
<p>EXAMPLES:</p>
<p>Example from <a class="reference internal" href="../../../references/index.html#rt1985" id="id5"><span>[RT1985]</span></a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">edge_disjoint_spanning_trees</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">],</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span> <span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;e&#39;</span><span class="p">]})</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span>
<span class="go">[Graph on 5 vertices, Graph on 5 vertices]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">F</span><span class="p">]</span>
<span class="go">[True, True]</span>
</pre></div>
</div>
<p>This method raises an error if the graph does not contain the required
number of trees:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">EmptySetError: this graph does not contain the required number of trees/arborescences</span>
</pre></div>
</div>
<p>A clique of order <span class="math notranslate nohighlight">\(n\)</span> has <span class="math notranslate nohighlight">\(\lfloor n/2 \rfloor\)</span> edge disjoint spanning
trees:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">F</span> <span class="o">=</span> <span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>The sum of the weights of the returned spanning trees is minimum:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">g</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">33</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">edge_disjoint_spanning_trees</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span>
<span class="go">8</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.filter_kruskal">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">filter_kruskal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.filter_kruskal" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum spanning tree using Filter Kruskal algorithm.</p>
<p>This function implements the variant of Kruskal’s algorithm proposed in
<a class="reference internal" href="../../../references/index.html#oss2009" id="id6"><span>[OSS2009]</span></a>. Instead of directly sorting the whole set of edges, it
partitions it in a similar way to quicksort and filter out edges that
connect vertices of the same tree to reduce the cost of sorting.</p>
<p>This function assumes that we can only compute minimum spanning trees for
undirected graphs. Such graphs can be weighted or unweighted, and they can
have multiple edges (since we are computing the minimum spanning tree, only
the minimum weight among all <span class="math notranslate nohighlight">\((u,v)\)</span>-edges is considered, for each pair of
vertices <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">threshold</span></code> – integer (default: 10000); maximum number of edges on</dt><dd><p>which to run kruskal algorithm. Above that value, edges are partitioned
into sets of size at most <code class="docutils literal notranslate"><span class="pre">threshold</span></code></p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to first perform sanity
checks on the input graph <code class="docutils literal notranslate"><span class="pre">G</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">check=False</span></code>. If we toggle
<code class="docutils literal notranslate"><span class="pre">check=True</span></code>, the following sanity checks are first performed on <code class="docutils literal notranslate"><span class="pre">G</span></code>
prior to running Kruskal’s algorithm on that input graph:</p>
<ul>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> the null graph?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> disconnected?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> a tree?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have self-loops?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have multiple edges?</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, if one exists, otherwise
returns the empty list.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph.min_spanning_tree()</span></code></a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Kruskal%27s_algorithm">Wikipedia article Kruskal%27s_algorithm</a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal()</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal_iterator" title="sage.graphs.spanning_tree.filter_kruskal_iterator"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal_iterator()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">filter_kruskal</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">filter_kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(1, 6, 10), (3, 4, 12), (2, 7, 14), (2, 3, 16), (4, 5, 22), (5, 6, 25)]</span>

<span class="gp">sage: </span><span class="n">filter_kruskal</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.filter_kruskal_iterator">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">filter_kruskal_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.filter_kruskal_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator implementation of Filter Kruskal’s algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">threshold</span></code> – integer (default: 10000); maximum number of edges on</dt><dd><p>which to run kruskal algorithm. Above that value, edges are partitioned
into sets of size at most <code class="docutils literal notranslate"><span class="pre">threshold</span></code></p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to first perform sanity
checks on the input graph <code class="docutils literal notranslate"><span class="pre">G</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">check=False</span></code>. If we toggle
<code class="docutils literal notranslate"><span class="pre">check=True</span></code>, the following sanity checks are first performed on <code class="docutils literal notranslate"><span class="pre">G</span></code>
prior to running Kruskal’s algorithm on that input graph:</p>
<ul>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> the null graph?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> disconnected?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> a tree?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have self-loops?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have multiple edges?</p></li>
</ul>
</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, one by one.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph.min_spanning_tree()</span></code></a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Kruskal%27s_algorithm">Wikipedia article Kruskal%27s_algorithm</a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal()</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal" title="sage.graphs.spanning_tree.filter_kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, if one exists, otherwise
returns the empty list.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">filter_kruskal_iterator</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">list</span><span class="p">(</span><span class="n">filter_kruskal_iterator</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[(1, 6, 10), (3, 4, 12), (2, 7, 14), (2, 3, 16), (4, 5, 22), (5, 6, 25)]</span>
</pre></div>
</div>
<p>The weights of the spanning trees returned by <a class="reference internal" href="#sage.graphs.spanning_tree.kruskal_iterator" title="sage.graphs.spanning_tree.kruskal_iterator"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal_iterator()</span></code></a> and
<a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal_iterator" title="sage.graphs.spanning_tree.filter_kruskal_iterator"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal_iterator()</span></code></a> are the same:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">kruskal_iterator</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">kruskal_iterator</span><span class="p">(</span><span class="n">G</span><span class="p">))</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">filter_kruskal_iterator</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.kruskal">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">kruskal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.kruskal" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum spanning tree using Kruskal’s algorithm.</p>
<p>This function assumes that we can only compute minimum spanning trees for
undirected graphs. Such graphs can be weighted or unweighted, and they can
have multiple edges (since we are computing the minimum spanning tree, only
the minimum weight among all <span class="math notranslate nohighlight">\((u,v)\)</span>-edges is considered, for each pair
of vertices <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(v\)</span>).</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to first perform sanity
checks on the input graph <code class="docutils literal notranslate"><span class="pre">G</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">check=False</span></code>. If we toggle
<code class="docutils literal notranslate"><span class="pre">check=True</span></code>, the following sanity checks are first performed on <code class="docutils literal notranslate"><span class="pre">G</span></code>
prior to running Kruskal’s algorithm on that input graph:</p>
<ul class="simple">
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> the null graph?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> disconnected?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> a tree?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have self-loops?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have multiple edges?</p></li>
</ul>
<p>By default, we turn off the sanity checks for performance reasons. This
means that by default the function assumes that its input graph is
connected, and has at least one vertex. Otherwise, you should set
<code class="docutils literal notranslate"><span class="pre">check=True</span></code> to perform some sanity checks and preprocessing on the
input graph. If <code class="docutils literal notranslate"><span class="pre">G</span></code> has multiple edges or self-loops, the algorithm
still works, but the running-time can be improved if these edges are
removed. To further improve the runtime of this function, you should call
it directly instead of using it indirectly via
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph.min_spanning_tree()</span></code></a>.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, if one exists, otherwise
returns the empty list.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph.min_spanning_tree()</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.kruskal_iterator" title="sage.graphs.spanning_tree.kruskal_iterator"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal_iterator()</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal" title="sage.graphs.spanning_tree.filter_kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal()</span></code></a> and <a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal_iterator" title="sage.graphs.spanning_tree.filter_kruskal_iterator"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal_iterator()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>An example from pages 727–728 in <a class="reference internal" href="../../../references/index.html#sah2000" id="id7"><span>[Sah2000]</span></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">kruskal</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span> <span class="n">E</span>
<span class="go">[(1, 6, 10), (3, 4, 12), (2, 7, 14), (2, 3, 16), (4, 5, 22), (5, 6, 25)]</span>
</pre></div>
</div>
<p>Variants of the previous example.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">kruskal</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(1, 2, None), (1, 6, None), (2, 3, None), (2, 7, None), (3, 4, None), (4, 5, None)]</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">G</span>
<span class="go">Looped multi-graph on 7 vertices</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">u</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">w</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">Looped multi-graph on 7 vertices</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">sanitize</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">allow_loops</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">allow_multiple_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">keep_label</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sanitize</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">H</span>
<span class="go">Graph on 7 vertices</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span> <span class="o">==</span> <span class="nb">sum</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">kruskal</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example from pages 599–601 in <a class="reference internal" href="../../../references/index.html#gt2001" id="id8"><span>[GT2001]</span></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="s2">&quot;SFO&quot;</span><span class="p">:{</span><span class="s2">&quot;BOS&quot;</span><span class="p">:</span><span class="mi">2704</span><span class="p">,</span> <span class="s2">&quot;ORD&quot;</span><span class="p">:</span><span class="mi">1846</span><span class="p">,</span> <span class="s2">&quot;DFW&quot;</span><span class="p">:</span><span class="mi">1464</span><span class="p">,</span> <span class="s2">&quot;LAX&quot;</span><span class="p">:</span><span class="mi">337</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;BOS&quot;</span><span class="p">:{</span><span class="s2">&quot;ORD&quot;</span><span class="p">:</span><span class="mi">867</span><span class="p">,</span> <span class="s2">&quot;JFK&quot;</span><span class="p">:</span><span class="mi">187</span><span class="p">,</span> <span class="s2">&quot;MIA&quot;</span><span class="p">:</span><span class="mi">1258</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;ORD&quot;</span><span class="p">:{</span><span class="s2">&quot;PVD&quot;</span><span class="p">:</span><span class="mi">849</span><span class="p">,</span> <span class="s2">&quot;JFK&quot;</span><span class="p">:</span><span class="mi">740</span><span class="p">,</span> <span class="s2">&quot;BWI&quot;</span><span class="p">:</span><span class="mi">621</span><span class="p">,</span> <span class="s2">&quot;DFW&quot;</span><span class="p">:</span><span class="mi">802</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;DFW&quot;</span><span class="p">:{</span><span class="s2">&quot;JFK&quot;</span><span class="p">:</span><span class="mi">1391</span><span class="p">,</span> <span class="s2">&quot;MIA&quot;</span><span class="p">:</span><span class="mi">1121</span><span class="p">,</span> <span class="s2">&quot;LAX&quot;</span><span class="p">:</span><span class="mi">1235</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;LAX&quot;</span><span class="p">:{</span><span class="s2">&quot;MIA&quot;</span><span class="p">:</span><span class="mi">2342</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;PVD&quot;</span><span class="p">:{</span><span class="s2">&quot;JFK&quot;</span><span class="p">:</span><span class="mi">144</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;JFK&quot;</span><span class="p">:{</span><span class="s2">&quot;MIA&quot;</span><span class="p">:</span><span class="mi">1090</span><span class="p">,</span> <span class="s2">&quot;BWI&quot;</span><span class="p">:</span><span class="mi">184</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;BWI&quot;</span><span class="p">:{</span><span class="s2">&quot;MIA&quot;</span><span class="p">:</span><span class="mi">946</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">[(&#39;JFK&#39;, &#39;PVD&#39;, 144), (&#39;BWI&#39;, &#39;JFK&#39;, 184), (&#39;BOS&#39;, &#39;JFK&#39;, 187), (&#39;LAX&#39;, &#39;SFO&#39;, 337), (&#39;BWI&#39;, &#39;ORD&#39;, 621), (&#39;DFW&#39;, &#39;ORD&#39;, 802), (&#39;BWI&#39;, &#39;MIA&#39;, 946), (&#39;DFW&#39;, &#39;LAX&#39;, 1235)]</span>
</pre></div>
</div>
<p>An example from pages 568–569 in <a class="reference internal" href="../../../references/index.html#clrs2001" id="id9"><span>[CLRS2001]</span></a>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="s2">&quot;a&quot;</span><span class="p">:{</span><span class="s2">&quot;b&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">},</span> <span class="s2">&quot;b&quot;</span><span class="p">:{</span><span class="s2">&quot;c&quot;</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&quot;h&quot;</span><span class="p">:</span><span class="mi">11</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;c&quot;</span><span class="p">:{</span><span class="s2">&quot;d&quot;</span><span class="p">:</span><span class="mi">7</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="s2">&quot;d&quot;</span><span class="p">:{</span><span class="s2">&quot;e&quot;</span><span class="p">:</span><span class="mi">9</span><span class="p">,</span> <span class="s2">&quot;f&quot;</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span>
<span class="gp">....: </span><span class="s2">&quot;e&quot;</span><span class="p">:{</span><span class="s2">&quot;f&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="s2">&quot;f&quot;</span><span class="p">:{</span><span class="s2">&quot;g&quot;</span><span class="p">:</span><span class="mi">2</span><span class="p">},</span> <span class="s2">&quot;g&quot;</span><span class="p">:{</span><span class="s2">&quot;h&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;i&quot;</span><span class="p">:</span><span class="mi">6</span><span class="p">},</span> <span class="s2">&quot;h&quot;</span><span class="p">:{</span><span class="s2">&quot;i&quot;</span><span class="p">:</span><span class="mi">7</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;list_of_edges&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">edge_labels</span><span class="p">())</span>
<span class="go">37</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>An example with custom edge labels:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]],</span> <span class="n">weighted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">weight</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">e</span><span class="p">:</span><span class="mi">3</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">e</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[(0, 1, 1), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
<span class="gp">sage: </span><span class="nb">sorted</span><span class="p">(</span><span class="n">kruskal</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">weight_function</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="go">[(0, 2, 10), (1, 2, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.kruskal_iterator">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">kruskal_iterator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.kruskal_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator implementation of Kruskal algorithm.</p>
<p>INPUT:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to first perform sanity
checks on the input graph <code class="docutils literal notranslate"><span class="pre">G</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">check=False</span></code>. If we toggle
<code class="docutils literal notranslate"><span class="pre">check=True</span></code>, the following sanity checks are first performed on <code class="docutils literal notranslate"><span class="pre">G</span></code>
prior to running Kruskal’s algorithm on that input graph:</p>
<ul class="simple">
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> the null graph?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> disconnected?</p></li>
<li><p>Is <code class="docutils literal notranslate"><span class="pre">G</span></code> a tree?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have self-loops?</p></li>
<li><p>Does <code class="docutils literal notranslate"><span class="pre">G</span></code> have multiple edges?</p></li>
</ul>
<p>By default, we turn off the sanity checks for performance reasons. This
means that by default the function assumes that its input graph is
connected, and has at least one vertex. Otherwise, you should set
<code class="docutils literal notranslate"><span class="pre">check=True</span></code> to perform some sanity checks and preprocessing on the
input graph. If <code class="docutils literal notranslate"><span class="pre">G</span></code> has multiple edges or self-loops, the algorithm
still works, but the running-time can be improved if these edges are
removed. To further improve the runtime of this function, you should call
it directly instead of using it indirectly via
<a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.min_spanning_tree" title="sage.graphs.generic_graph.GenericGraph.min_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.graphs.generic_graph.GenericGraph.min_spanning_tree()</span></code></a>.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, one by one.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">kruskal_iterator</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">kruskal_iterator</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">(1, 6, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.kruskal_iterator_from_edges">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">kruskal_iterator_from_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union_find</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.kruskal_iterator_from_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator implementation of Kruskal algorithm on list of edges.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">edges</span></code> – list of edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">union_find</span></code> – a
<a class="reference external" href="../../../sets/sage/sets/disjoint_set.html#sage.sets.disjoint_set.DisjointSet_of_hashables" title="(in Sets v9.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DisjointSet_of_hashables</span></code></a> encoding a
forest</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> - boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted; if <code class="docutils literal notranslate"><span class="pre">False</span></code>, all edges have weight 1.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code>, if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge</p></li>
</ul>
<p>OUTPUT:</p>
<p>The edges of a minimum spanning tree of <code class="docutils literal notranslate"><span class="pre">G</span></code>, one by one.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.kruskal" title="sage.graphs.spanning_tree.kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">kruskal()</span></code></a></p></li>
<li><p><a class="reference internal" href="#sage.graphs.spanning_tree.filter_kruskal" title="sage.graphs.spanning_tree.filter_kruskal"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_kruskal()</span></code></a></p></li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.graphs.spanning_tree</span> <span class="kn">import</span> <span class="n">kruskal_iterator_from_edges</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">({</span><span class="mi">1</span><span class="p">:{</span><span class="mi">2</span><span class="p">:</span><span class="mi">28</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">10</span><span class="p">},</span> <span class="mi">2</span><span class="p">:{</span><span class="mi">3</span><span class="p">:</span><span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">14</span><span class="p">},</span> <span class="mi">3</span><span class="p">:{</span><span class="mi">4</span><span class="p">:</span><span class="mi">12</span><span class="p">},</span> <span class="mi">4</span><span class="p">:{</span><span class="mi">5</span><span class="p">:</span><span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">18</span><span class="p">},</span> <span class="mi">5</span><span class="p">:{</span><span class="mi">6</span><span class="p">:</span><span class="mi">25</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span><span class="mi">24</span><span class="p">}})</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">union_set</span> <span class="o">=</span> <span class="n">DisjointSet</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">next</span><span class="p">(</span><span class="n">kruskal_iterator_from_edges</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">sort</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">union_set</span><span class="p">,</span> <span class="n">by_weight</span><span class="o">=</span><span class="n">G</span><span class="o">.</span><span class="n">weighted</span><span class="p">()))</span>
<span class="go">(1, 6, 10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.random_spanning_tree">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">random_spanning_tree</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">G</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_as_graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">by_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.random_spanning_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random spanning tree of the graph.</p>
<p>This uses the Aldous-Broder algorithm (<a class="reference internal" href="../../../references/index.html#bro1989" id="id10"><span>[Bro1989]</span></a>, <a class="reference internal" href="../../../references/index.html#ald1990" id="id11"><span>[Ald1990]</span></a>) to generate
a random spanning tree with the uniform distribution, as follows.</p>
<p>Start from any vertex. Perform a random walk by choosing at every step one
neighbor uniformly at random. Every time a new vertex <span class="math notranslate nohighlight">\(j\)</span> is met, add the
edge <span class="math notranslate nohighlight">\((i, j)\)</span> to the spanning tree, where <span class="math notranslate nohighlight">\(i\)</span> is the previous vertex in the
random walk.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> or a weight function is given, the selection
of the neighbor is done proportionaly to the edge weights.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> – an undirected graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">output_as_graph</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to return a
list of edges or a graph</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">by_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, the edges in
the graph are weighted, otherwise all edges have weight 1</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weight_function</span></code> – function (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); a function that takes
as input an edge <code class="docutils literal notranslate"><span class="pre">(u,</span> <span class="pre">v,</span> <span class="pre">l)</span></code> and outputs its weight. If not <code class="docutils literal notranslate"><span class="pre">None</span></code>,
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is automatically set to <code class="docutils literal notranslate"><span class="pre">True</span></code>. If <code class="docutils literal notranslate"><span class="pre">None</span></code> and
<code class="docutils literal notranslate"><span class="pre">by_weight</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, we use the edge label <code class="docutils literal notranslate"><span class="pre">l</span></code> , if <code class="docutils literal notranslate"><span class="pre">l</span></code> is not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, else <code class="docutils literal notranslate"><span class="pre">1</span></code> as a weight. The <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> can be used to
transform the label into a weight (note that, if the weight returned is
not convertible to a float, an error is raised)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">check_weight</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); whether to check that
the <code class="docutils literal notranslate"><span class="pre">weight_function</span></code> outputs a number for each edge.</p></li>
</ul>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.spanning_trees_count" title="sage.graphs.generic_graph.GenericGraph.spanning_trees_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spanning_trees_count()</span></code></a>
and <a class="reference internal" href="graph.html#sage.graphs.graph.Graph.spanning_trees" title="sage.graphs.graph.Graph.spanning_trees"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spanning_trees()</span></code></a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">TietzeGraph</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">random_spanning_tree</span><span class="p">(</span><span class="n">output_as_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Graph on 12 vertices</span>
<span class="gp">sage: </span><span class="n">rg</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_spanning_tree</span><span class="p">();</span> <span class="n">rg</span> <span class="c1"># random</span>
<span class="go">[(0, 9),</span>
<span class="go">(9, 11),</span>
<span class="go">(0, 8),</span>
<span class="go">(8, 7),</span>
<span class="go">(7, 6),</span>
<span class="go">(7, 2),</span>
<span class="go">(2, 1),</span>
<span class="go">(1, 5),</span>
<span class="go">(9, 10),</span>
<span class="go">(5, 4),</span>
<span class="go">(2, 3)]</span>
<span class="gp">sage: </span><span class="n">Graph</span><span class="p">(</span><span class="n">rg</span><span class="p">)</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A visual example for the grid graph:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">Grid2dGraph</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pos</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">get_pos</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_spanning_tree</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">set_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">vertex_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>We can also use edge weights to change the probability of returning a
spanning tree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">S</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="gp">....: </span>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">E</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_spanning_tree</span><span class="p">(</span><span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="n">S</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Graph</span><span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">.</span><span class="n">graph6_string</span><span class="p">())</span>
<span class="gp">....: </span>    <span class="k">return</span> <span class="n">S</span>
<span class="gp">sage: </span><span class="n">K3</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">K3</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">K3</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">foo</span><span class="p">(</span><span class="n">K3</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;BW&#39;</span><span class="p">,</span> <span class="s1">&#39;Bg&#39;</span><span class="p">,</span> <span class="s1">&#39;Bo&#39;</span><span class="p">}</span>  <span class="c1"># random</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K4</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">CompleteGraph</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">K4</span><span class="o">.</span><span class="n">edges</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">K4</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">foo</span><span class="p">(</span><span class="n">K4</span><span class="p">,</span> <span class="mi">100</span><span class="p">)))</span>  <span class="c1"># random</span>
<span class="go">16</span>
</pre></div>
</div>
<p>Check that the spanning tree returned when using weights is a tree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">graphs</span><span class="o">.</span><span class="n">RandomBarabasiAlbert</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">edge_iterator</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="n">G</span><span class="o">.</span><span class="n">set_edge_label</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">random_spanning_tree</span><span class="p">(</span><span class="n">by_weight</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_as_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">is_tree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sage.graphs.spanning_tree.spanning_trees">
<span class="sig-prename descclassname"><span class="pre">sage.graphs.spanning_tree.</span></span><span class="sig-name descname"><span class="pre">spanning_trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.graphs.spanning_tree.spanning_trees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over all spanning trees of the graph <span class="math notranslate nohighlight">\(g\)</span>.</p>
<p>A disconnected graph has no spanning tree.</p>
<p>Uses the Read-Tarjan backtracking algorithm <a class="reference internal" href="../../../references/index.html#rt1975a" id="id12"><span>[RT1975a]</span></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">labels</span></code> – boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to return edges labels
in the spanning trees or not</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">spanning_trees</span><span class="p">()))</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">()</span>
<span class="go">8</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),(</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">)],</span> <span class="n">multiedges</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">spanning_trees</span><span class="p">()))</span>
<span class="go">6</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">spanning_trees_count</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<ul class="simple">
<li><p><a class="reference internal" href="generic_graph.html#sage.graphs.generic_graph.GenericGraph.spanning_trees_count" title="sage.graphs.generic_graph.GenericGraph.spanning_trees_count"><code class="xref py py-meth docutils literal notranslate"><span class="pre">spanning_trees_count()</span></code></a>
– counts the number of spanning trees</p></li>
<li><p><a class="reference internal" href="graph.html#sage.graphs.graph.Graph.random_spanning_tree" title="sage.graphs.graph.Graph.random_spanning_tree"><code class="xref py py-meth docutils literal notranslate"><span class="pre">random_spanning_tree()</span></code></a>
– returns a random spanning tree</p></li>
</ul>
</div>
</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Spanning trees</a><ul>
<li><a class="reference internal" href="#methods">Methods</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="line_graph.html"
                          title="previous chapter">Line graphs</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="pq_trees.html"
                          title="next chapter">PQ-Trees</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/graphs/spanning_tree.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="pq_trees.html" title="PQ-Trees"
             >next</a> |</li>
        <li class="right" >
          <a href="line_graph.html" title="Line graphs"
             >previous</a> |</li>
  <li class="nav-item nav-item-0">
    <a href="http://www.sagemath.org"><img src="../../../_static/logo_sagemath_black.svg" class="sage-logo" title="Sage Logo"></a>
    
      <a href="../../../../index.html">Sage 9.6 Documentation</a> &#187;
      
      <a href="../../../index.html">Reference Manual</a> &#187;
      
      <a href="../../index.html">Graph Theory</a> &#187;
    
  </li>

        <li class="nav-item nav-item-this"><a href="">Spanning trees</a></li> 
      </ul>
    </div>
  
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
    </div>
  <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
  </script>
  <script type="text/javascript">
/* detex the document title by removing "\(", "\)", "\", "$" */
document.title = document.title.replace(/\\\(/g, '').replace(/\\\)/g, '').replace(/\\/g, '').replace(/\$/g, '');
  </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>