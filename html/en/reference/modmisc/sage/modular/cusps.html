
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>The set \(\mathbb{P}^1(\QQ)\) of cusps &#8212; Sage 9.5 Reference Manual: Miscellaneous Modular-Form-Related Modules</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sage.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <script data-url_root="../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Dimensions of spaces of modular forms" href="dims.html" />
    <link rel="prev" title="Dirichlet characters" href="dirichlet.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dims.html" title="Dimensions of spaces of modular forms"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="dirichlet.html" title="Dirichlet characters"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Miscellaneous Modular-Form-Related Modules</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">The set <span class="math notranslate nohighlight">\(\mathbb{P}^1(\QQ)\)</span> of cusps</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="the-set-mathbb-p-1-qq-of-cusps">
<span id="sage-modular-cusps"></span><h1>The set <span class="math notranslate nohighlight">\(\mathbb{P}^1(\QQ)\)</span> of cusps<a class="headerlink" href="#the-set-mathbb-p-1-qq-of-cusps" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.modular.cusps"></span><p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cusps</span>
<span class="go">Set P^1(QQ) of all cusps</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span>
<span class="go">Infinity</span>
</pre></div>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.modular.cusps.</span></span><span class="sig-name descname"><span class="pre">Cusp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.Element" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.Element</span></code></a></p>
<p>A cusp.</p>
<p>A cusp is either a rational number or infinity, i.e., an element of
the projective line over Q. A Cusp is stored as a pair (a,b), where
gcd(a,b)=1 and a,b are of type Integer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Set P^1(QQ) of all cusps</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span> <span class="ow">is</span> <span class="n">b</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.apply" title="Permalink to this definition">¶</a></dt>
<dd><p>Return g(self), where g=[a,b,c,d] is a list of length 4, which we
view as a linear fractional transformation.</p>
<p>EXAMPLES: Apply the identity matrix:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">-3</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.denominator">
<span class="sig-name descname"><span class="pre">denominator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.denominator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the denominator of the cusp a/b.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">Cusp</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span> <span class="n">x</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">denominator</span><span class="p">()</span>
<span class="go">2</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.galois_action">
<span class="sig-name descname"><span class="pre">galois_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.galois_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Suppose this cusp is <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(G\)</span> a congruence subgroup of level <span class="math notranslate nohighlight">\(N\)</span>
and <span class="math notranslate nohighlight">\(\sigma\)</span> is the automorphism in the Galois group of
<span class="math notranslate nohighlight">\(\QQ(\zeta_N)/\QQ\)</span> that sends <span class="math notranslate nohighlight">\(\zeta_N\)</span> to <span class="math notranslate nohighlight">\(\zeta_N^t\)</span>. Then this
function computes a cusp <span class="math notranslate nohighlight">\(\beta\)</span> such that <span class="math notranslate nohighlight">\(\sigma([\alpha]) = [\beta]\)</span>,
where <span class="math notranslate nohighlight">\([\alpha]\)</span> is the equivalence class of <span class="math notranslate nohighlight">\(\alpha\)</span> modulo <span class="math notranslate nohighlight">\(G\)</span>.</p>
<p>This code only needs as input the level and not the group since the
action of Galois for a congruence group <span class="math notranslate nohighlight">\(G\)</span> of level <span class="math notranslate nohighlight">\(N\)</span> is compatible
with the action of the full congruence group <span class="math notranslate nohighlight">\(\Gamma(N)\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t\)</span> – integer that is coprime to N</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> – positive integer (level)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a cusp</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In some cases <span class="math notranslate nohighlight">\(N\)</span> must fit in a long long, i.e., there
are cases where this algorithm isn’t fully implemented.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Modular curves can have multiple non-isomorphic models over <span class="math notranslate nohighlight">\(\QQ\)</span>.
The action of Galois depends on such a model. The model over <span class="math notranslate nohighlight">\(\QQ\)</span>
of <span class="math notranslate nohighlight">\(X(G)\)</span> used here is the model where the function field
<span class="math notranslate nohighlight">\(\QQ(X(G))\)</span> is given by the functions whose Fourier expansion at
<span class="math notranslate nohighlight">\(\infty\)</span> have their coefficients in <span class="math notranslate nohighlight">\(\QQ\)</span>. For <span class="math notranslate nohighlight">\(X(N):=X(\Gamma(N))\)</span>
the corresponding moduli interpretation over <span class="math notranslate nohighlight">\(\ZZ[1/N]\)</span> is that
<span class="math notranslate nohighlight">\(X(N)\)</span> parametrizes pairs <span class="math notranslate nohighlight">\((E,a)\)</span> where <span class="math notranslate nohighlight">\(E\)</span> is a (generalized)
elliptic curve and <span class="math notranslate nohighlight">\(a: \ZZ / N\ZZ \times \mu_N \to E\)</span> is a closed
immersion such that the Weil pairing of <span class="math notranslate nohighlight">\(a(1,1)\)</span> and <span class="math notranslate nohighlight">\(a(0,\zeta_N)\)</span>
is <span class="math notranslate nohighlight">\(\zeta_N\)</span>. In this parameterisation the point <span class="math notranslate nohighlight">\(z \in H\)</span>
corresponds to the pair <span class="math notranslate nohighlight">\((E_z,a_z)\)</span> with <span class="math notranslate nohighlight">\(E_z=\CC/(z \ZZ+\ZZ)\)</span> and
<span class="math notranslate nohighlight">\(a_z: \ZZ / N\ZZ \times \mu_N \to E\)</span> given by <span class="math notranslate nohighlight">\(a_z(1,1) = z/N\)</span> and
<span class="math notranslate nohighlight">\(a_z(0,\zeta_N) = 1/N\)</span>.
Similarly <span class="math notranslate nohighlight">\(X_1(N):=X(\Gamma_1(N))\)</span> parametrizes pairs <span class="math notranslate nohighlight">\((E,a)\)</span> where
<span class="math notranslate nohighlight">\(a: \mu_N \to E\)</span> is a closed immersion.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">galois_action</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="go">1/170</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span><span class="o">.</span><span class="n">galois_action</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">=</span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">galois_action</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span> <span class="n">c</span>
<span class="go">50/17</span>
<span class="gp">sage: </span><span class="n">Gamma0</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">reduce_cusp</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Here we compute the permutations of the action for t=3 on cusps for
Gamma0(50).</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">t</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">G</span> <span class="o">=</span> <span class="n">Gamma0</span><span class="p">(</span><span class="n">N</span><span class="p">);</span> <span class="n">C</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">cusps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cl</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">z</span><span class="p">:</span> <span class="n">exists</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">N</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="n">i</span><span class="p">))</span>
<span class="gp">....: </span>    <span class="nb">print</span><span class="p">([</span><span class="n">cl</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">galois_action</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="n">i</span><span class="p">,</span><span class="n">N</span><span class="p">))</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">C</span><span class="p">])</span>
<span class="go">(0, 1)</span>
<span class="go">[0, 1/25, 1/10, 1/5, 3/10, 2/5, 1/2, 3/5, 7/10, 4/5, 9/10, Infinity]</span>
<span class="go">(1, 3)</span>
<span class="go">[0, 1/25, 7/10, 2/5, 1/10, 4/5, 1/2, 1/5, 9/10, 3/5, 3/10, Infinity]</span>
<span class="go">(2, 9)</span>
<span class="go">[0, 1/25, 9/10, 4/5, 7/10, 3/5, 1/2, 2/5, 3/10, 1/5, 1/10, Infinity]</span>
<span class="go">(3, 27)</span>
<span class="go">[0, 1/25, 3/10, 3/5, 9/10, 1/5, 1/2, 4/5, 1/10, 2/5, 7/10, Infinity]</span>
<span class="go">(4, 81)</span>
<span class="go">[0, 1/25, 1/10, 1/5, 3/10, 2/5, 1/2, 3/5, 7/10, 4/5, 9/10, Infinity]</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<ul class="simple">
<li><p>Section 1.3 of Glenn Stevens, “Arithmetic on Modular Curves”</p></li>
<li><p>There is a long comment about our algorithm in the source code for this function.</p></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li><p>William Stein, 2009-04-18</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.is_gamma0_equiv">
<span class="sig-name descname"><span class="pre">is_gamma0_equiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.is_gamma0_equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether self and other are equivalent modulo the action of
<span class="math notranslate nohighlight">\(\Gamma_0(N)\)</span> via linear fractional transformations.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> - Cusp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> - an integer (specifies the group
Gamma_0(N))</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">transformation</span></code> - None (default) or either the string ‘matrix’ or ‘corner’. If ‘matrix’,
it also returns a matrix in Gamma_0(N) that sends self to other. The matrix is chosen such that the lower left entry is as small as possible in absolute value. If ‘corner’ (or True for backwards compatibility), it returns only the upper left entry of such a matrix.</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p>a boolean - True if self and other are equivalent</p></li>
<li><p>a matrix or an integer- returned only if transformation is ‘matrix’ or ‘corner’, respectively.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">_</span><span class="p">,</span> <span class="n">ga</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;matrix&#39;</span><span class="p">);</span> <span class="n">ga</span>
<span class="go">[-1  2]</span>
<span class="go">[-2  3]</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span>
<span class="go">(False, None)</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="s1">&#39;corner&#39;</span><span class="p">)</span>
<span class="go">(True, 19)</span>

<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Infinity</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma0_equiv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;matrix&#39;</span><span class="p">)</span>
<span class="go">(</span>
<span class="go">      [-1  1]</span>
<span class="go">True, [-3  2]</span>
<span class="go">)</span>
</pre></div>
</div>
<p>ALGORITHM: See Proposition 2.2.3 of Cremona’s book ‘Algorithms for
Modular Elliptic Curves’, or Prop 2.27 of Stein’s Ph.D. thesis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.is_gamma1_equiv">
<span class="sig-name descname"><span class="pre">is_gamma1_equiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.is_gamma1_equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether self and other are equivalent modulo the action of
Gamma_1(N) via linear fractional transformations.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> - Cusp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code> - an integer (specifies the group
Gamma_1(N))</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> - True if self and other are equivalent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> - 0, 1 or -1, gives further information
about the equivalence: If the two cusps are u1/v1 and u2/v2, then
they are equivalent if and only if v1 = v2 (mod N) and u1 = u2 (mod
gcd(v1,N)) or v1 = -v2 (mod N) and u1 = -u2 (mod gcd(v1,N)) The
sign is +1 for the first and -1 for the second. If the two cusps
are not equivalent then 0 is returned.</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(True, 1)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="n">QQ</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="go">(True, 1)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(True, -1)</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(True, 1)</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_gamma1_equiv</span><span class="p">(</span><span class="n">oo</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(False, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.is_gamma_h_equiv">
<span class="sig-name descname"><span class="pre">is_gamma_h_equiv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">G</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.is_gamma_h_equiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a pair (b, t), where b is True or False as self and other
are equivalent under the action of G, and t is 1 or -1, as
described below.</p>
<p>Two cusps <span class="math notranslate nohighlight">\(u1/v1\)</span> and <span class="math notranslate nohighlight">\(u2/v2\)</span> are equivalent modulo
Gamma_H(N) if and only if <span class="math notranslate nohighlight">\(v1 =  h*v2 (\mathrm{mod} N)\)</span> and
<span class="math notranslate nohighlight">\(u1 =  h^{(-1)}*u2 (\mathrm{mod} gcd(v1,N))\)</span> or
<span class="math notranslate nohighlight">\(v1 = -h*v2 (mod N)\)</span> and
<span class="math notranslate nohighlight">\(u1 = -h^{(-1)}*u2 (\mathrm{mod} gcd(v1,N))\)</span> for some
<span class="math notranslate nohighlight">\(h \in H\)</span>. Then t is 1 or -1 as c and c’ fall into the
first or second case, respectively.</p>
<p>INPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">other</span></code> - Cusp</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G</span></code> - a congruence subgroup Gamma_H(N)</p></li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> - True if self and other are equivalent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code> - -1, 0, 1; extra info</p></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">Cusp</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma_h_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">GammaH</span><span class="p">(</span><span class="mi">13</span><span class="p">,[</span><span class="mi">2</span><span class="p">]))</span>
<span class="go">(True, 1)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma_h_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">GammaH</span><span class="p">(</span><span class="mi">13</span><span class="p">,[</span><span class="mi">5</span><span class="p">]))</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma_h_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">GammaH</span><span class="p">(</span><span class="mi">5</span><span class="p">,[]))</span>
<span class="go">(False, 0)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">is_gamma_h_equiv</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">GammaH</span><span class="p">(</span><span class="mi">23</span><span class="p">,[</span><span class="mi">4</span><span class="p">]))</span>
<span class="go">(True, -1)</span>
</pre></div>
</div>
<p>Enumerating the cusps for a space of modular symbols uses this
function.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">GammaH</span><span class="p">(</span><span class="mi">25</span><span class="p">,[</span><span class="mi">6</span><span class="p">])</span> <span class="p">;</span> <span class="n">M</span> <span class="o">=</span> <span class="n">G</span><span class="o">.</span><span class="n">modular_symbols</span><span class="p">()</span> <span class="p">;</span> <span class="n">M</span>
<span class="go">Modular Symbols space of dimension 11 for Congruence Subgroup Gamma_H(25) with H generated by [6] of weight 2 with sign 0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">cusps</span><span class="p">()</span>
<span class="go">[8/25, 1/3, 6/25, 1/4, 1/15, -7/15, 7/15, 4/15, 1/20, 3/20, 7/20, 9/20]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">M</span><span class="o">.</span><span class="n">cusps</span><span class="p">())</span>
<span class="go">12</span>
</pre></div>
</div>
<p>This is always one more than the associated space of weight 2 Eisenstein
series.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dimension_eis</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">M</span><span class="o">.</span><span class="n">cuspidal_subspace</span><span class="p">()</span>
<span class="go">Modular Symbols subspace of dimension 0 of Modular Symbols space of dimension 11 for Congruence Subgroup Gamma_H(25) with H generated by [6] of weight 2 with sign 0 over Rational Field</span>
<span class="gp">sage: </span><span class="n">G</span><span class="o">.</span><span class="n">dimension_cusp_forms</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.is_infinity">
<span class="sig-name descname"><span class="pre">is_infinity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.is_infinity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if this is the cusp infinity.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">is_infinity</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_infinity</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_infinity</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusp.numerator">
<span class="sig-name descname"><span class="pre">numerator</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.modular.cusps.Cusp.numerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the numerator of the cusp a/b.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">Cusp</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span> <span class="n">x</span>
<span class="go">2/3</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="n">oo</span><span class="p">)</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">Cusp</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">numerator</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusps">
<span class="sig-prename descclassname"><span class="pre">sage.modular.cusps.</span></span><span class="sig-name descname"><span class="pre">Cusps</span></span><em class="property"> <span class="pre">=</span> <span class="pre">Set</span> <span class="pre">P^1(QQ)</span> <span class="pre">of</span> <span class="pre">all</span> <span class="pre">cusps</span></em><a class="headerlink" href="#sage.modular.cusps.Cusps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusps_class">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sage.modular.cusps.</span></span><span class="sig-name descname"><span class="pre">Cusps_class</span></span><a class="headerlink" href="#sage.modular.cusps.Cusps_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../misc/sage/misc/fast_methods.html#sage.misc.fast_methods.Singleton" title="(in Sage 9.5 Reference Manual: Utilities v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.misc.fast_methods.Singleton</span></code></a>, <a class="reference external" href="../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Sage 9.5 Reference Manual: Parents and Elements v9.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.parent.Parent</span></code></a></p>
<p>The set of cusps.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">Cusps</span><span class="p">;</span> <span class="n">C</span>
<span class="go">Set P^1(QQ) of all cusps</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">dumps</span><span class="p">())</span> <span class="o">==</span> <span class="n">C</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="sage.modular.cusps.Cusps_class.Element">
<span class="sig-name descname"><span class="pre">Element</span></span><a class="headerlink" href="#sage.modular.cusps.Cusps_class.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.modular.cusps.Cusp" title="sage.modular.cusps.Cusp"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cusp</span></code></a></p>
</dd></dl>

</dd></dl>

</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="dirichlet.html"
                        title="previous chapter">Dirichlet characters</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dims.html"
                        title="next chapter">Dimensions of spaces of modular forms</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/modular/cusps.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dims.html" title="Dimensions of spaces of modular forms"
             >next</a> |</li>
        <li class="right" >
          <a href="dirichlet.html" title="Dirichlet characters"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Sage 9.5 Reference Manual: Miscellaneous Modular-Form-Related Modules</a> &#187;</li>

        <li class="nav-item nav-item-this"><a href="">The set <span class="math notranslate nohighlight">\(\mathbb{P}^1(\QQ)\)</span> of cusps</a></li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2022, The Sage Development Team.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.2.0.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* The sidebar toggle adapts its height to the bodywrapper height. */
    const resizeObserver = new ResizeObserver(entries => {
        tog.height(bod.height());
    });
    resizeObserver.observe(bod[0]);

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>