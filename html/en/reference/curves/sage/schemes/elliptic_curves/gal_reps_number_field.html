
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Galois representations for elliptic curves over number fields &#8212; Sage Reference Manual v9.0: Plane curves</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Isogeny class of elliptic curves over number fields" href="isogeny_class.html" />
    <link rel="prev" title="Galois representations attached to elliptic curves" href="gal_reps.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="isogeny_class.html" title="Isogeny class of elliptic curves over number fields"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gal_reps.html" title="Galois representations attached to elliptic curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="galois-representations-for-elliptic-curves-over-number-fields">
<span id="sage-schemes-elliptic-curves-gal-reps-number-field"></span><h1>Galois representations for elliptic curves over number fields<a class="headerlink" href="#galois-representations-for-elliptic-curves-over-number-fields" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.gal_reps_number_field"></span><p>This file contains the code to compute for which primes the Galois
representation attached to an elliptic curve (over an arbitrary number field)
is surjective. The functions in this file are called by the <code class="docutils literal notranslate"><span class="pre">is_surjective</span></code>
and <code class="docutils literal notranslate"><span class="pre">non_surjective</span></code> methods of an elliptic curve over a number field.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="c1"># Cyclotomic character not surjective.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">31</span><span class="p">)</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (4s on sage.math, 2014)</span>
<span class="go">[3, 5, 29]</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2014)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Eric Larson (2012-05-28): initial version.</li>
<li>Eric Larson (2014-08-13): added isogeny_bound function.</li>
<li>John Cremona (2016, 2017): various efficiency improvements to _semistable_reducible_primes</li>
<li>John Cremona (2017): implementation of Billerey’s algorithm to find all reducible primes</li>
</ul>
<p>REFERENCES:</p>
<ul class="simple">
<li><a class="reference internal" href="../../../../references/index.html#ser1972" id="id1">[Ser1972]</a></li>
<li><a class="reference internal" href="../../../../references/index.html#sut2012" id="id2">[Sut2012]</a></li>
</ul>
<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_bound">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Billerey_B_bound</code><span class="sig-paren">(</span><em>E</em>, <em>max_l=200</em>, <em>num_l=8</em>, <em>small_prime_bound=0</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Billerey’s bound <span class="math notranslate nohighlight">\(B\)</span>.</p>
<p>We compute <span class="math notranslate nohighlight">\(B_l\)</span> for <span class="math notranslate nohighlight">\(l\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code> (at most) until <code class="docutils literal notranslate"><span class="pre">num_l</span></code>
nonzero values are found (at most).  Return the list of primes
dividing all <span class="math notranslate nohighlight">\(B_l\)</span> computed, excluding those dividing 6 or
ramified or of bad reduction or less than small_prime_bound.  If
no non-zero values are found return [0].</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int, default 200) – maximum size of primes l to check.</li>
<li><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int, default 8)  – maximum number of primes l to check.</li>
<li><code class="docutils literal notranslate"><span class="pre">small_prime_bound</span></code> (int, default 0) – remove primes less
than this from the output.</li>
<li><code class="docutils literal notranslate"><span class="pre">debug</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>)  – if <code class="docutils literal notranslate"><span class="pre">True</span></code> prints details.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The purpose of the small_prime_bound is that it is faster to
deal with these using the local test; by ignoring them here,
we enable the algorithm to terminate sooner when there are no
large reducible primes, which is always the case in practice.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_B_bound</span>
<span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>If we do not use enough primes <span class="math notranslate nohighlight">\(l\)</span>, extraneous primes will be
included which are not reducible primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="go">[5, 7]</span>
</pre></div>
</div>
<p>Similarly if we do not use large enough primes <span class="math notranslate nohighlight">\(l\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[5, 7]</span>
<span class="gp">sage: </span><span class="n">Billerey_B_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>This curve does have a rational 5-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_l">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Billerey_B_l</code><span class="sig-paren">(</span><em>E</em>, <em>l</em>, <em>B=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_B_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(B_l\)</span>, adapted from the definition in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id3">[Bil2011]</a>, after (9).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">l</span></code> (int) – a rational prime</li>
<li><code class="docutils literal notranslate"><span class="pre">B</span></code> (int) – 0 or LCM of previous <span class="math notranslate nohighlight">\(B_l\)</span>: the prime-to-B part of this <span class="math notranslate nohighlight">\(B_l\)</span> is ignored.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_B_l</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_B_l</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">15</span><span class="p">)]</span>
<span class="go">[1123077552537600,</span>
<span class="go">227279663773903886745600,</span>
<span class="go">0,</span>
<span class="go">0,</span>
<span class="go">269247154818492941287713746693964214802283882086400,</span>
<span class="go">0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_P_l">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Billerey_P_l</code><span class="sig-paren">(</span><em>E</em>, <em>l</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_P_l" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(P_l^*\)</span> as defined in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id4">[Bil2011]</a>, equation (9).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">l</span></code> – a rational prime</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_P_l</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_P_l</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[x^2 + 8143*x + 16777216,</span>
<span class="go">x^2 + 451358*x + 282429536481,</span>
<span class="go">x^4 - 664299076*x^3 + 205155493652343750*x^2 - 39595310449600219726562500*x + 3552713678800500929355621337890625,</span>
<span class="go">x^4 - 207302404*x^3 - 377423798538689366394*x^2 - 39715249826471656586987520004*x + 36703368217294125441230211032033660188801]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_bound">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Billerey_R_bound</code><span class="sig-paren">(</span><em>E</em>, <em>max_l=200</em>, <em>num_l=8</em>, <em>small_prime_bound=None</em>, <em>debug=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Billerey’s bound <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>We compute <span class="math notranslate nohighlight">\(R_q\)</span> for <span class="math notranslate nohighlight">\(q\)</span> dividing primes <span class="math notranslate nohighlight">\(\ell\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>
(at most) until <code class="docutils literal notranslate"><span class="pre">num_l</span></code> nonzero values are found (at most).
Return the list of primes dividing all <code class="docutils literal notranslate"><span class="pre">R_q</span></code> computed, excluding
those dividing 6 or ramified or of bad reduction or less than
small_prime_bound.  If no non-zero values are found return [0].</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int, default 200) – maximum size of rational primes
l for which the primes q above l are checked.</li>
<li><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int, default 8) – maximum number of rational primes
l for which the primes q above l are checked.</li>
<li><code class="docutils literal notranslate"><span class="pre">small_prime_bound</span></code> (int, default 0) – remove primes less
than this from the output.</li>
<li><code class="docutils literal notranslate"><span class="pre">debug</span></code> (bool, default <code class="docutils literal notranslate"><span class="pre">False</span></code>)  – if <code class="docutils literal notranslate"><span class="pre">True</span></code> prints details.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The purpose of the small_prime_bound is that it is faster to
deal with these using the local test; by ignoring them here,
we enable the algorithm to terminate sooner when there are no
large reducible primes, which is always the case in practice.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_R_bound</span>
<span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>We may get no bound at all if we do not use enough primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">max_l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>Or we may get a bound but not a good one if we do not use enough primes:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[5, 17, 67, 157]</span>
</pre></div>
</div>
<p>In this case two primes is enough to restrict the set of possible
reducible primes to just <span class="math notranslate nohighlight">\(\{5\}\)</span>.  This curve does have a rational 5-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Billerey_R_bound</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">num_l</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[5]</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_q">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Billerey_R_q</code><span class="sig-paren">(</span><em>E</em>, <em>q</em>, <em>B=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Billerey_R_q" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Billerey’s <span class="math notranslate nohighlight">\(R_q\)</span>, adapted from the definition in <a class="reference internal" href="../../../../references/index.html#bil2011" id="id5">[Bil2011]</a>, Theorem 2.8.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve over a number field <span class="math notranslate nohighlight">\(K\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">q</span></code> – a prime ideal of <span class="math notranslate nohighlight">\(K\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">B</span></code> (int) – 0 or LCM of previous <span class="math notranslate nohighlight">\(R_q\)</span>: the prime-to-B part of this <span class="math notranslate nohighlight">\(R_q\)</span> is ignored.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">Billerey_R_q</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Billerey_R_q</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">K</span><span class="o">.</span><span class="n">prime_above</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">primes</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="go">[1123077552537600,</span>
<span class="go">227279663773903886745600,</span>
<span class="go">51956919562116960000000000000000,</span>
<span class="go">252485933820556361829926400000000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.Frobenius_filter">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">Frobenius_filter</code><span class="sig-paren">(</span><em>E</em>, <em>L</em>, <em>patience=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.Frobenius_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine which primes in L might have an image contained in a
Borel subgroup, by checking of traces of Frobenius.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function will sometimes return primes for which the image
is not contained in a Borel subgroup.  This issue cannot always
be fixed by increasing patience as it may be a result of a
failure of a local-global principle for isogenies.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – EllipticCurve - over a number field.</li>
<li><code class="docutils literal notranslate"><span class="pre">L</span></code> – list - a list of prime numbers.</li>
<li><code class="docutils literal notranslate"><span class="pre">patience</span></code> (int), default 100– a positive integer bounding
the number of traces of Frobenius to use while trying to prove
irreducibility.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list – The list of all primes <span class="math notranslate nohighlight">\(\ell\)</span> in L for which the mod
<span class="math notranslate nohighlight">\(\ell\)</span> image might be contained in a Borel subgroup of
<span class="math notranslate nohighlight">\(GL_2(\mathbf{F}_{\ell})\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span> <span class="c1"># has a 5-isogeny</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">primes</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
<span class="go">[5]</span>
</pre></div>
</div>
<p>Example to show that the output may contain primes where the
representation is in fact reducible.  Over <span class="math notranslate nohighlight">\(\QQ\)</span> the following is
essentially the unique such example by <a class="reference internal" href="../../../../references/index.html#sut2012" id="id6">[Sut2012]</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">])</span>
<span class="go">[7]</span>
</pre></div>
</div>
<p>This curve does possess a 7-isogeny modulo every prime of good
reduction, but has no rational 7-isogeny:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>A number field example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">399</span><span class="o">-</span><span class="mi">240</span><span class="o">*</span><span class="n">i</span><span class="p">,</span>  <span class="mi">2627</span><span class="o">+</span><span class="mi">2869</span><span class="o">*</span><span class="n">i</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">elliptic_curves</span><span class="o">.</span><span class="n">gal_reps_number_field</span><span class="o">.</span><span class="n">Frobenius_filter</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">primes</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>Here the curve really does possess isogenies of degrees 2 and 3:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="n">l</span><span class="p">))</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
<span class="go">[1, 1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">GaloisRepresentation</code><span class="sig-paren">(</span><em>E</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>The compatible family of Galois representation
attached to an elliptic curve over a number field.</p>
<p>Given an elliptic curve <span class="math notranslate nohighlight">\(E\)</span> over a number field <span class="math notranslate nohighlight">\(K\)</span>
and a rational prime number <span class="math notranslate nohighlight">\(p\)</span>, the <span class="math notranslate nohighlight">\(p^n\)</span>-torsion
<span class="math notranslate nohighlight">\(E[p^n]\)</span> points of <span class="math notranslate nohighlight">\(E\)</span> is a representation of the
absolute Galois group <span class="math notranslate nohighlight">\(G_K\)</span> of <span class="math notranslate nohighlight">\(K\)</span>. As <span class="math notranslate nohighlight">\(n\)</span> varies
we obtain the Tate module <span class="math notranslate nohighlight">\(T_p E\)</span> which is
a representation of <span class="math notranslate nohighlight">\(G_K\)</span> on a free <span class="math notranslate nohighlight">\(\ZZ_p\)</span>-module
of rank <span class="math notranslate nohighlight">\(2\)</span>. As <span class="math notranslate nohighlight">\(p\)</span> varies the representations
are compatible.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span>
<span class="go">Compatible family of Galois representations associated to the Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in a with defining polynomial x^2 + 1</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.elliptic_curve">
<code class="descname">elliptic_curve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.elliptic_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the elliptic curve associated to this representation.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">elliptic_curve</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.is_surjective">
<code class="descname">is_surjective</code><span class="sig-paren">(</span><em>p</em>, <em>A=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.is_surjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if the mod-p representation is (provably)
surjective onto <span class="math notranslate nohighlight">\(Aut(E[p]) = GL_2(\GF{p})\)</span>.  Return
<code class="docutils literal notranslate"><span class="pre">False</span></code> if it is (probably) not.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> - int - a prime number.</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">A</span></code> - int - a bound on the number of traces of Frobenius to use</dt>
<dd>while trying to prove surjectivity.</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">29</span><span class="p">)</span> <span class="c1"># Cyclotomic character not surjective.</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">True</span>
</pre></div>
</div>
<p>If <span class="math notranslate nohighlight">\(E\)</span> is defined over <span class="math notranslate nohighlight">\(\QQ\)</span>, then the exceptional primes for <span class="math notranslate nohighlight">\(E_{/K}\)</span>
are the same as the exceptional primes for <span class="math notranslate nohighlight">\(E\)</span>, except for those primes
that are ramified in <span class="math notranslate nohighlight">\(K/\QQ\)</span> or are less than <span class="math notranslate nohighlight">\([K:\QQ]\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rhoK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rhoQQ</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">rhoK</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For CM curves, the mod-p representation is never surjective:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="nb">any</span><span class="p">(</span><span class="n">rho</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.isogeny_bound">
<code class="descname">isogeny_bound</code><span class="sig-paren">(</span><em>A=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.isogeny_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> including all primes for which
the image of the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is contained in a
Borel.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For the actual list of primes <span class="math notranslate nohighlight">\(p\)</span> at which the
representation is reducible see <a class="reference internal" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes" title="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reducible_primes()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – int (a bound on the number of traces of Frobenius to
use while trying to prove the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is not contained in a Borel).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">list</span></code> - A list of primes which contains (but may not be
equal to) all <span class="math notranslate nohighlight">\(p\)</span> for which the image of the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is contained in a Borel subgroup.  At any
prime not in this list, the image is definitely not
contained in a Borel. If E has <span class="math notranslate nohighlight">\(CM\)</span> defined over <span class="math notranslate nohighlight">\(K\)</span>, the list
[0] is returned.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># CM over K</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># CM NOT over K</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span> <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># No 7-isogeny, but...</span>
<span class="go">[7]</span>
</pre></div>
</div>
<p>For curves with rational CM, there are infinitely many primes
<span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is reducible, and [0]
is returned:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<p>An example (an elliptic curve with everywhere good reduction
over an imaginary quadratic field with quite large
discriminant), which failed until fixed at <a class="reference external" href="https://trac.sagemath.org/21776">trac ticket #21776</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">112941801</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="n">a</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="o">-</span><span class="mi">23163076</span><span class="o">*</span><span class="n">a</span> <span class="o">+</span> <span class="mi">266044005933275</span><span class="p">,</span><span class="mi">57560769602038</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">836483958630700313803</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">conductor</span><span class="p">()</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">GR</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">GR</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.non_surjective">
<code class="descname">non_surjective</code><span class="sig-paren">(</span><em>A=100</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.non_surjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> including all primes for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation might not be surjective.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – int (a bound on the number of traces of Frobenius to use
while trying to prove surjectivity).</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">list</span></code> – A list of primes where mod-<span class="math notranslate nohighlight">\(p\)</span> representation is
very likely not surjective. At any prime not in this list,
the representation is definitely surjective. If <span class="math notranslate nohighlight">\(E\)</span> has CM,
the list [0] is returned.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">[3, 5, 29]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># X_0(11)</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>  <span class="c1"># long time (4s on sage.math, 2014)</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">1728</span><span class="p">)</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="mi">146329141248</span><span class="o">*</span><span class="n">a</span> <span class="o">-</span> <span class="mi">327201914880</span><span class="p">)</span> <span class="c1"># CM</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span> <span class="c1"># long time (3s on sage.math, 2014)</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes">
<code class="descname">reducible_primes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.GaloisRepresentation.reducible_primes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of primes <span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is reducible, or [0] for CM curves.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">list</span></code> - A list of those primes <span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span>
representation is contained in a Borel subgroup, i.e. is
reducible.  If E has CM <em>defined over K</em>, the list [0] is
returned (in this case the representation is reducible for
infinitely many primes).</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># See Section 5.10 of [Ser1972].</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[3, 5]</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># CM over K</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span> <span class="c1"># CM but NOT over K</span>
<span class="go">[2, 3]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span> <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">isogeny_bound</span><span class="p">()</span> <span class="c1"># ... but there is no 7-isogeny ...</span>
<span class="go">[7]</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>For curves with rational CM, there are infinitely many primes
<span class="math notranslate nohighlight">\(p\)</span> for which the mod-<span class="math notranslate nohighlight">\(p\)</span> representation is reducible, and [0]
is returned:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">-</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">a</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">has_rational_cm</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">rho</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rho</span><span class="o">.</span><span class="n">reducible_primes</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.deg_one_primes_iter">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">deg_one_primes_iter</code><span class="sig-paren">(</span><em>K</em>, <em>principal_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.deg_one_primes_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator over degree 1 primes of <code class="docutils literal notranslate"><span class="pre">K</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">K</span></code> – a number field</li>
<li><code class="docutils literal notranslate"><span class="pre">principal_only</span></code> – bool; if <code class="docutils literal notranslate"><span class="pre">True</span></code>, only yield principal primes</li>
</ul>
<p>OUTPUT:</p>
<p>An iterator over degree 1 primes of <span class="math notranslate nohighlight">\(K\)</span> up to the given norm,
optionally yielding only principal primes.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QuadraticField</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">deg_one_primes_iter</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">deg_one_primes_iter</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[Fractional ideal (2, a + 1),</span>
<span class="go"> Fractional ideal (3, a + 1),</span>
<span class="go"> Fractional ideal (3, a + 2),</span>
<span class="go"> Fractional ideal (-a),</span>
<span class="go"> Fractional ideal (7, a + 3),</span>
<span class="go"> Fractional ideal (7, a + 4)]</span>
<span class="gp">sage: </span><span class="n">it</span> <span class="o">=</span> <span class="n">deg_one_primes_iter</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">it</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="go">[Fractional ideal (-a),</span>
<span class="go"> Fractional ideal (-2*a + 3),</span>
<span class="go"> Fractional ideal (2*a + 3),</span>
<span class="go"> Fractional ideal (a + 6),</span>
<span class="go"> Fractional ideal (a - 6),</span>
<span class="go"> Fractional ideal (-3*a + 4)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_Billerey">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">reducible_primes_Billerey</code><span class="sig-paren">(</span><em>E</em>, <em>num_l=None</em>, <em>max_l=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_Billerey" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a finite set of primes <span class="math notranslate nohighlight">\(\ell\)</span> containing all those for which
<span class="math notranslate nohighlight">\(E\)</span> has a <span class="math notranslate nohighlight">\(K\)</span>-rational ell-isogeny, where <span class="math notranslate nohighlight">\(K\)</span> is the base field of
<span class="math notranslate nohighlight">\(E\)</span>: i.e., the mod-<span class="math notranslate nohighlight">\(\ell\)</span> representation is irreducible for all
<span class="math notranslate nohighlight">\(\ell\)</span> outside the set returned.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve defined over a number field <span class="math notranslate nohighlight">\(K\)</span>.</li>
<li><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the maximum prime
<span class="math notranslate nohighlight">\(\ell\)</span> to use for the B-bound and R-bound.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a
default value will be used.</li>
<li><code class="docutils literal notranslate"><span class="pre">num_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the number of primes
<span class="math notranslate nohighlight">\(\ell\)</span> to use for the B-bound and R-bound.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a
default value will be used.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <code class="docutils literal notranslate"><span class="pre">E</span></code> has CM then [0] is returned.  In this case use the
function
sage.schemes.elliptic_curves.isogeny_class.possible_isogeny_degrees</p>
</div>
<p>We first compute Billeray’s B_bound using at most <code class="docutils literal notranslate"><span class="pre">num_l</span></code> primes
of size up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>.  If that fails we compute Billeray’s
R_bound using at most <code class="docutils literal notranslate"><span class="pre">num_q</span></code> primes of size up to <code class="docutils literal notranslate"><span class="pre">max_q</span></code>.</p>
<p>Provided that one of these methods succeeds in producing a finite
list of primes we check these using a local condition, and finally
test that the primes returned actually are reducible.  Otherwise
we return [0].</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">reducible_primes_Billerey</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">((</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[3, 5]</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span> <span class="c1"># CM over K</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># CM but NOT over K</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[2, 3]</span>
</pre></div>
</div>
<p>An example where a prime is not reducible but passes the test:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve_from_j</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">2268945</span><span class="o">/</span><span class="mi">128</span><span class="p">))</span><span class="o">.</span><span class="n">global_minimal_model</span><span class="p">()</span> <span class="c1"># c.f. [Sut2012]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_Billerey</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[7]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_naive">
<code class="descclassname">sage.schemes.elliptic_curves.gal_reps_number_field.</code><code class="descname">reducible_primes_naive</code><span class="sig-paren">(</span><em>E</em>, <em>max_l=None</em>, <em>num_P=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.gal_reps_number_field.reducible_primes_naive" title="Permalink to this definition">¶</a></dt>
<dd><p>Return locally reducible primes <span class="math notranslate nohighlight">\(\ell\)</span> up to <code class="docutils literal notranslate"><span class="pre">max_l</span></code>.</p>
<p>The list of primes <span class="math notranslate nohighlight">\(\ell\)</span> returned consists of all those up to
<code class="docutils literal notranslate"><span class="pre">max_l</span></code> such that <span class="math notranslate nohighlight">\(E\)</span> mod <span class="math notranslate nohighlight">\(P\)</span> has an <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny, where <span class="math notranslate nohighlight">\(K\)</span>
is the base field of <span class="math notranslate nohighlight">\(E\)</span>, for <code class="docutils literal notranslate"><span class="pre">num_P</span></code> primes <span class="math notranslate nohighlight">\(P\)</span> of <span class="math notranslate nohighlight">\(K\)</span>.  In
most cases <span class="math notranslate nohighlight">\(E\)</span> then has a <span class="math notranslate nohighlight">\(K\)</span>-rational <span class="math notranslate nohighlight">\(\ell\)</span>-isogeny, but there
are rare exceptions.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve defined over a number field <span class="math notranslate nohighlight">\(K\)</span></li>
<li><code class="docutils literal notranslate"><span class="pre">max_l</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the maximum prime
<span class="math notranslate nohighlight">\(\ell\)</span> to test.</li>
<li><code class="docutils literal notranslate"><span class="pre">num_P</span></code> (int or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)) – the number of primes
<span class="math notranslate nohighlight">\(P\)</span> of <span class="math notranslate nohighlight">\(K\)</span> to use in testing each <span class="math notranslate nohighlight">\(\ell\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.gal_reps_number_field</span> <span class="kn">import</span> <span class="n">reducible_primes_naive</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">50</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">95</span><span class="o">*</span><span class="n">a</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">67</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">[2, 5, 53, 173, 197, 241, 293, 317, 409, 557, 601, 653, 677, 769, 773, 797]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="go">[2, 5, 197, 557, 653, 769]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">num_P</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="n">reducible_primes_naive</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="go">[2, 5]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">()]</span>
<span class="go">[2, 2, 2, 5]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="gal_reps.html"
                        title="previous chapter">Galois representations attached to elliptic curves</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="isogeny_class.html"
                        title="next chapter">Isogeny class of elliptic curves over number fields</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/elliptic_curves/gal_reps_number_field.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="isogeny_class.html" title="Isogeny class of elliptic curves over number fields"
             >next</a> |</li>
        <li class="right" >
          <a href="gal_reps.html" title="Galois representations attached to elliptic curves"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>