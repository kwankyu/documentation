
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Isogenies &#8212; Sage 9.1 Reference Manual: Curves</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Isogenies of small prime degree" href="isogeny_small_degree.html" />
    <link rel="prev" title="Isomorphisms between Weierstrass models of elliptic curves" href="weierstrass_morphism.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="isogeny_small_degree.html" title="Isogenies of small prime degree"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="weierstrass_morphism.html" title="Isomorphisms between Weierstrass models of elliptic curves"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.1 Reference Manual: Curves</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="isogenies">
<span id="sage-schemes-elliptic-curves-ell-curve-isogeny"></span><h1>Isogenies<a class="headerlink" href="#isogenies" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.ell_curve_isogeny"></span><p>An isogeny <span class="math notranslate nohighlight">\(\varphi: E_1\to E_2\)</span> between two elliptic curves <span class="math notranslate nohighlight">\(E_1\)</span> and
<span class="math notranslate nohighlight">\(E_2\)</span> is a morphism of curves that sends the origin of <span class="math notranslate nohighlight">\(E_1\)</span> to the
origin of <span class="math notranslate nohighlight">\(E_2\)</span>. Such a morphism is automatically a morphism of group
schemes and the kernel is a finite subgroup scheme of <span class="math notranslate nohighlight">\(E_1\)</span>.  Such a
subscheme can either be given by a list of generators, which have to
be torsion points, or by a polynomial in the coordinate <span class="math notranslate nohighlight">\(x\)</span> of the
Weierstrass equation of <span class="math notranslate nohighlight">\(E_1\)</span>.</p>
<p>The usual way to create and work with isogenies is illustrated with
the following example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 7 from Elliptic Curve defined by y^2 = x^3 + x + 1 over Finite Field of size 11 to Elliptic Curve defined by y^2 = x^3 + 7*x + 8 over Finite Field of size 11</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(10 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 + 7*x + 8 over Finite Field of size 11</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^7 + 4*x^6 - 3*x^5 - 2*x^4 - 3*x^3 + 3*x^2 + x - 2)/(x^6 + 4*x^5 - 4*x^4 - 5*x^3 + 5*x^2), (x^9*y - 5*x^8*y - x^7*y + x^5*y - x^4*y - 5*x^3*y - 5*x^2*y - 2*x*y - 5*y)/(x^9 - 5*x^8 + 4*x^6 - 3*x^4 + 2*x^3))</span>
</pre></div>
</div>
<p>The functions directly accessible from an elliptic curve <code class="docutils literal notranslate"><span class="pre">E</span></code> over a
field are <code class="docutils literal notranslate"><span class="pre">isogeny</span></code> and <code class="docutils literal notranslate"><span class="pre">isogeny_codomain</span></code>.</p>
<p>The most useful functions that apply to isogenies are</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">codomain</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">domain</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dual</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">rational_maps</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">kernel_polynomial</span></code></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only cyclic, separable isogenies are implemented (except for [2]). Some
algorithms may need the isogeny to be normalized.</p>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Daniel Shumow &lt;<a class="reference external" href="mailto:shumow&#37;&#52;&#48;gmail&#46;com">shumow<span>&#64;</span>gmail<span>&#46;</span>com</a>&gt;: 2009-04-19: initial version</li>
<li>Chris Wuthrich : 7/09: changes: add check of input, not the full list is needed.
10/09: eliminating some bugs.</li>
<li>John Cremona 2014-08-08: tidying of code and docstrings, systematic
use of univariate vs. bivariate polynomials and rational functions.</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">EllipticCurveIsogeny</code><span class="sig-paren">(</span><em>E</em>, <em>kernel</em>, <em>codomain=None</em>, <em>degree=None</em>, <em>model=None</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../categories/sage/categories/morphism.html#sage.categories.morphism.Morphism" title="(in Sage 9.1 Reference Manual: Category Framework v9.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.categories.morphism.Morphism</span></code></a></p>
<p>Class Implementing Isogenies of Elliptic Curves</p>
<p>This class implements cyclic, separable, normalized isogenies of
elliptic curves.</p>
<p>Several different algorithms for computing isogenies are
available.  These include:</p>
<ul class="simple">
<li>Velu’s Formulas: Velu’s original formulas for computing
isogenies.  This algorithm is selected by giving as the
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> parameter a list of points which generate a finite
subgroup.</li>
<li>Kohel’s Formulas: Kohel’s original formulas for computing
isogenies.  This algorithm is selected by giving as the
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> parameter a monic polynomial (or a coefficient list
(little endian)) which will define the kernel of the isogeny.</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve, the domain of the isogeny to
initialize.</li>
<li><code class="docutils literal notranslate"><span class="pre">kernel</span></code> – a kernel, either a point in <code class="docutils literal notranslate"><span class="pre">E</span></code>, a list of
points in <code class="docutils literal notranslate"><span class="pre">E</span></code>, a monic kernel polynomial, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.  If
initializing from a domain/codomain, this must be set to None.</li>
<li><code class="docutils literal notranslate"><span class="pre">codomain</span></code> – an elliptic curve (default:<code class="docutils literal notranslate"><span class="pre">None</span></code>).  If
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, then this must be the codomain of a
cyclic, separable, normalized isogeny, furthermore, <code class="docutils literal notranslate"><span class="pre">degree</span></code>
must be the degree of the isogeny from <code class="docutils literal notranslate"><span class="pre">E</span></code> to <code class="docutils literal notranslate"><span class="pre">codomain</span></code>. If
<code class="docutils literal notranslate"><span class="pre">kernel</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then this must be isomorphic to the
codomain of the cyclic normalized separable isogeny defined by
<code class="docutils literal notranslate"><span class="pre">kernel</span></code>, in this case, the isogeny is post composed with an
isomorphism so that this parameter is the codomain.</li>
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> – an integer (default:<code class="docutils literal notranslate"><span class="pre">None</span></code>).  If <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then this is the degree of the isogeny from <code class="docutils literal notranslate"><span class="pre">E</span></code> to
<code class="docutils literal notranslate"><span class="pre">codomain</span></code>.  If <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, then this is used
to determine whether or not to skip a gcd of the kernel
polynomial with the two torsion polynomial of <code class="docutils literal notranslate"><span class="pre">E</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">model</span></code> – a string (default:<code class="docutils literal notranslate"><span class="pre">None</span></code>).  Only supported
variable is <code class="docutils literal notranslate"><span class="pre">minimal</span></code>, in which case if <code class="docutils literal notranslate"><span class="pre">E</span></code> is a curve over
the rationals or over a number field, then the codomain is a
global minimum model where this exists.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) checks if the input is valid to
define an isogeny</li>
</ul>
<p>EXAMPLES:</p>
<p>A simple example of creating an isogeny of a field of small
characteristic:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + x over Finite Field of size 7 to Elliptic Curve defined by y^2 = x^3 + 3*x over Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">x</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + 1)/x, (x^2*y - y)/x^2)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>  <span class="c1"># known bug</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example of a characteristic 2 field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;alpha&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi_v</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span> <span class="n">phi_v</span>
<span class="go">Isogeny of degree 3 from Elliptic Curve defined by y^2 + y = x^3 + 1 over Finite Field in alpha of size 2^4 to Elliptic Curve defined by y^2 + y = x^3 over Finite Field in alpha of size 2^4</span>
<span class="gp">sage: </span><span class="n">phi_ker_poly</span> <span class="o">=</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_ker_poly</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">ker_poly_list</span> <span class="o">=</span> <span class="n">phi_ker_poly</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">ker_poly_list</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">==</span> <span class="n">phi_v</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^3 + x + 1)/(x^2 + 1), (x^3*y + x^2*y + x*y + x + y)/(x^3 + x^2 + x + 1))</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^3 + x + 1)/(x^2 + 1), (x^3*y + x^2*y + x*y + x + y)/(x^3 + x^2 + x + 1))</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span> <span class="o">==</span> <span class="mi">3</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">alpha</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">base_field</span><span class="p">()</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">*</span><span class="p">(</span><span class="n">alpha</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>
<span class="go">(1 : alpha^2 + alpha : 1)</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">codomain</span><span class="p">()(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can create an isogeny that has kernel equal to the full 2
torsion:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ker_list</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">division_polynomial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">ker_list</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 4 from Elliptic Curve defined by y^2 = x^3 + x + 1 over Finite Field of size 3 to Elliptic Curve defined by y^2 = x^3 + x + 1 over Finite Field of size 3</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="go">(1 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">E</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>We can also create trivial isogenies with the trivial kernel:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi_v</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">==</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">P</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">23</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">18</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">phi_k</span>
<span class="go">Isogeny of degree 1 from Elliptic Curve defined by y^2 + 23*x*y + 22*y = x^3 + x^2 + 7*x + 18 over Finite Field of size 31 to Elliptic Curve defined by y^2 + 23*x*y + 22*y = x^3 + x^2 + 7*x + 18 over Finite Field of size 31</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">(x, y)</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">random_point</span><span class="p">();</span> <span class="n">P</span> <span class="o">==</span> <span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Velu and Kohel also work in characteristic 0:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">P_list</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">P_list</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + 3*x + 4 over Rational Field to Elliptic Curve defined by y^2 = x^3 - 27*x + 46 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(6 : -10 : 1)</span>
<span class="gp">sage: </span><span class="n">phi_ker_poly</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_ker_poly</span>
<span class="go">x + 1</span>
<span class="gp">sage: </span><span class="n">ker_poly_list</span> <span class="o">=</span> <span class="n">phi_ker_poly</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">ker_poly_list</span><span class="p">);</span> <span class="n">phi_k</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + 3*x + 4 over Rational Field to Elliptic Curve defined by y^2 = x^3 - 27*x + 46 over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>A more complicated example over the rationals (of odd degree):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P_list</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_v</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">P_list</span><span class="p">);</span> <span class="n">phi_v</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">((</span><span class="mi">16</span><span class="p">,</span><span class="o">-</span><span class="mi">61</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(0 : 1 : 0)</span>
<span class="gp">sage: </span><span class="n">ker_poly</span> <span class="o">=</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">();</span> <span class="n">ker_poly</span>
<span class="go">x^2 - 21*x + 80</span>
<span class="gp">sage: </span><span class="n">ker_poly_list</span> <span class="o">=</span> <span class="n">ker_poly</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">ker_poly_list</span><span class="p">);</span> <span class="n">phi_k</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">==</span> <span class="n">phi_v</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can also do this same example over the number field defined by
the irreducible two torsion polynomial of <span class="math notranslate nohighlight">\(E\)</span>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P_list</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">alpha</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">40</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">158</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EK</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">EK</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="k">for</span> <span class="n">P</span> <span class="ow">in</span> <span class="n">P_list</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">phi_v</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">EK</span><span class="p">,</span> <span class="n">P_list</span><span class="p">);</span> <span class="n">phi_v</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in alpha with defining polynomial x^3 - 2*x^2 - 40*x - 158 to Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-7820)*x + (-263580) over Number Field in alpha with defining polynomial x^3 - 2*x^2 - 40*x - 158</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">EK</span><span class="p">((</span><span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">(122/121*alpha^2 + 1633/242*alpha - 3920/121 : -1/2 : 1)</span>
<span class="gp">sage: </span><span class="n">ker_poly</span> <span class="o">=</span> <span class="n">phi_v</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ker_poly</span>
<span class="go">x^2 - 21*x + 80</span>
<span class="gp">sage: </span><span class="n">ker_poly_list</span> <span class="o">=</span> <span class="n">ker_poly</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">EK</span><span class="p">,</span> <span class="n">ker_poly_list</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_k</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-10)*x + (-20) over Number Field in alpha with defining polynomial x^3 - 2*x^2 - 40*x - 158 to Elliptic Curve defined by y^2 + y = x^3 + (-1)*x^2 + (-7820)*x + (-263580) over Number Field in alpha with defining polynomial x^3 - 2*x^2 - 40*x - 158</span>
<span class="gp">sage: </span><span class="n">phi_v</span> <span class="o">==</span> <span class="n">phi_k</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi_v</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span> <span class="o">==</span> <span class="n">phi_v</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_k</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">phi_v</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The following example shows how to specify an isogeny from domain
and codomain:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">80</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_s</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_s</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi_s</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However only cyclic normalized isogenies can be constructed this
way. So it won’t find the isogeny [3]:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="n">codomain</span><span class="o">=</span><span class="n">E</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The two curves are not linked by a cyclic normalized isogeny of degree 9</span>
</pre></div>
</div>
<p>Also the presumed isogeny between the domain and codomain must be
normalized:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E2</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="bp">None</span><span class="p">,</span><span class="n">codomain</span><span class="o">=</span><span class="n">E</span><span class="p">,</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The two curves are not linked by a cyclic normalized isogeny of degree 5</span>
<span class="gp">sage: </span><span class="n">phihat</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">();</span> <span class="n">phihat</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="gp">sage: </span><span class="n">phihat</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Here an example of a construction of a endomorphisms with cyclic
kernel on a CM-curve:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">RK</span><span class="o">.&lt;</span><span class="n">X</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">X</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="o">/</span><span class="mi">5</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">(((4/25*i + 3/25)*x^5 + (4/5*i - 2/5)*x^3 - x)/(x^4 + (-4/5*i + 2/5)*x^2 + (-4/25*i - 3/25)), ((11/125*i + 2/125)*x^6*y + (-23/125*i + 64/125)*x^4*y + (141/125*i + 162/125)*x^2*y + (3/25*i - 4/25)*y)/(x^6 + (-6/5*i + 3/5)*x^4 + (-12/25*i - 9/25)*x^2 + (2/125*i - 11/125)))</span>
</pre></div>
</div>
<p>Domain and codomain tests (see <a class="reference external" href="https://trac.sagemath.org/12880">trac ticket #12880</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 = x^3 - 4*x over Rational Field</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + x*y = x^3 + x + 2 over Finite Field of size 31</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + x*y = x^3 + 24*x + 6 over Finite Field of size 31</span>
</pre></div>
</div>
<p>Composition tests (see <a class="reference external" href="https://trac.sagemath.org/16245">trac ticket #16245</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">([</span><span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))]);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 to Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">phi</span> <span class="o">*</span> <span class="n">phi</span><span class="p">;</span> <span class="n">phi2</span>
<span class="go">Composite map:</span>
<span class="go">  From: Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7</span>
<span class="go">  To:   Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7</span>
<span class="go">  Defn:   Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 to Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7</span>
<span class="go">        then</span>
<span class="go">          Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7 to Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 7</span>
</pre></div>
</div>
<p>Examples over relative number fields used not to work (see <a class="reference external" href="https://trac.sagemath.org/16779">trac ticket #16779</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">pol26</span> <span class="o">=</span> <span class="n">hilbert_class_polynomial</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pol</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol26</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">optimized_representation</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">pol</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">j</span> <span class="o">=</span> <span class="n">pol26</span><span class="o">.</span><span class="n">roots</span><span class="p">(</span><span class="n">K</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">b</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">26</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">EL</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iso2</span> <span class="o">=</span> <span class="n">EL</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">iso2</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">iso3</span> <span class="o">=</span> <span class="n">EL</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="nb">len</span><span class="p">(</span><span class="n">iso3</span><span class="p">)</span>
<span class="go">2</span>
</pre></div>
</div>
<p>Examples over function fields used not to work (see <a class="reference external" href="https://trac.sagemath.org/11327">trac ticket #11327</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">FunctionField</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">isogs</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogenies_prime_degree</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isogs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + (-t^2)*x over Rational function field in t over Rational Field to Elliptic Curve defined by y^2 = x^3 + 4*t^2*x over Rational function field in t over Rational Field</span>
<span class="gp">sage: </span><span class="n">isogs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 - t^2)/x, (x^2*y + t^2*y)/x^2)</span>
<span class="gp">sage: </span><span class="n">duals</span> <span class="o">=</span> <span class="p">[</span><span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span> <span class="k">for</span> <span class="n">phi</span> <span class="ow">in</span> <span class="n">isogs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">duals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + 4*t^2*x over Rational function field in t over Rational Field to Elliptic Curve defined by y^2 = x^3 + (-t^2)*x over Rational function field in t over Rational Field</span>
<span class="gp">sage: </span><span class="n">duals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((1/4*x^2 + t^2)/x, (1/8*x^2*y + (-1/2*t^2)*y)/x^2)</span>
<span class="gp">sage: </span><span class="n">duals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + 4*t^2*x over Rational function field in t over Rational Field to Elliptic Curve defined by y^2 = x^3 + (-t^2)*x over Rational function field in t over Rational Field</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the degree of this isogeny.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">17</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual">
<code class="descname">dual</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.dual" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the isogeny dual to this isogeny.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If <span class="math notranslate nohighlight">\(\varphi\colon E \to E_2\)</span> is the given isogeny and <span class="math notranslate nohighlight">\(n\)</span>
is its degree, then the dual is by definition the unique
isogeny <span class="math notranslate nohighlight">\(\hat\varphi\colon E_2\to E\)</span> such that the
compositions <span class="math notranslate nohighlight">\(\hat\varphi\circ\varphi\)</span> and
<span class="math notranslate nohighlight">\(\varphi\circ\hat\varphi\)</span> are the multiplication-by-<span class="math notranslate nohighlight">\(n\)</span>
maps on <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span>, respectively.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">80</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_hat</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xhat</span><span class="p">,</span> <span class="n">Yhat</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi_hat</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Xm</span> <span class="o">=</span> <span class="n">Xhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ym</span> <span class="o">=</span> <span class="n">Yhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Ym</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">33</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_hat</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xhat</span><span class="p">,</span> <span class="n">Yhat</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi_hat</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Xm</span> <span class="o">=</span> <span class="n">Xhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ym</span> <span class="o">=</span> <span class="n">Yhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Ym</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">29</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi_hat</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi_hat</span><span class="o">.</span><span class="n">domain</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xhat</span><span class="p">,</span> <span class="n">Yhat</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi_hat</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Xm</span> <span class="o">=</span> <span class="n">Xhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Ym</span> <span class="o">=</span> <span class="n">Yhat</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">Y</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Xm</span><span class="p">,</span> <span class="n">Ym</span><span class="p">)</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Test for <a class="reference external" href="https://trac.sagemath.org/23928">trac ticket #23928</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">431</span><span class="o">**</span><span class="mi">2</span><span class="p">)(</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">lift_x</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 = x^3 + 427*x over Finite Field in z2 of size 431^2 to Elliptic Curve defined by y^2 = x^3 + x over Finite Field in z2 of size 431^2</span>
</pre></div>
</div>
<p>Test (for <a class="reference external" href="https://trac.sagemath.org/7096">trac ticket #7096</a>):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">k</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">103</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">k</span><span class="p">,[</span><span class="mi">11</span><span class="p">,</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 = x^3 + 11*x + 11 over Finite Field of size 103 to Elliptic Curve defined by y^2 = x^3 + 25*x + 80 over Finite Field of size 103</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">103</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">85</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="go">Isogeny of degree 7 from Elliptic Curve defined by y^2 + x*y = x^3 + 84*x + 34 over Finite Field of size 103 to Elliptic Curve defined by y^2 + x*y = x^3 + x + 102 over Finite Field of size 103</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/17293">trac ticket #17293</a> is fixed:</p>
<blockquote>
<div>sage: k.&lt;s&gt; = QuadraticField(2)
sage: E = EllipticCurve(k, [-3*s*(4 + 5*s), 2*s*(2 + 14*s + 11*s^2)])
sage: phi = E.isogenies_prime_degree(3)[0]
sage: (-phi).dual() == -(phi.dual())
True
sage: phi._EllipticCurveIsogeny__clear_cached_values()  # forget the dual
sage: -(phi.dual()) == (-phi).dual()
True</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.formal">
<code class="descname">formal</code><span class="sig-paren">(</span><em>prec=20</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.formal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the formal isogeny as a power series in the variable
<span class="math notranslate nohighlight">\(t=-x/y\)</span> on the domain curve.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> - (default = 20), the precision with which the
computations in the formal group are carried out.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">13</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">formal</span><span class="p">()</span>
<span class="go">t + 12*t^13 + 2*t^17 + 8*t^19 + 2*t^21 + O(t^23)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">E</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">formal</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="go">t + 54*t^5 + 255*t^7 + 2430*t^9 + 19278*t^11 + O(t^13)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">isogeny</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">101</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12751</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">formal</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
<span class="go">t - 2724/5*t^5 + 209046/5*t^7 - 4767/5*t^8 + 29200946/5*t^9 + O(t^10)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.get_post_isomorphism">
<code class="descname">get_post_isomorphism</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.get_post_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the post-isomorphism of this isogeny, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">18</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">get_post_isomorphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">get_post_isomorphism</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">)[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">24</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi2</span><span class="o">.</span><span class="n">get_post_isomorphism</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">From: Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 65*x + 69 over Finite Field of size 83</span>
<span class="go">To:   Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + 4*x + 16 over Finite Field of size 83</span>
<span class="go">Via:  (u,r,s,t) = (1, 7, 42, 42)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.get_pre_isomorphism">
<code class="descname">get_pre_isomorphism</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.get_pre_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pre-isomorphism of this isogeny, or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">30</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">get_post_isomorphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Epr</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">short_weierstrass_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">Epr</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_pre_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">get_pre_isomorphism</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">)[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">24</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi2</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi2</span><span class="o">.</span><span class="n">get_pre_isomorphism</span><span class="p">()</span>
<span class="go">Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + x over Finite Field of size 83</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 62*x + 74 over Finite Field of size 83</span>
<span class="go">  Via:  (u,r,s,t) = (1, 76, 41, 3)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_injective">
<code class="descname">is_injective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_injective" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if this isogeny has trivial
kernel.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">29</span><span class="o">/</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_normalized">
<code class="descname">is_normalized</code><span class="sig-paren">(</span><em>via_formal=True</em>, <em>check_by_pullback=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this isogeny is normalized.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">An isogeny <span class="math notranslate nohighlight">\(\varphi\colon E\to E_2\)</span> between two given
Weierstrass equations is said to be normalized if the
constant <span class="math notranslate nohighlight">\(c\)</span> is <span class="math notranslate nohighlight">\(1\)</span> in <span class="math notranslate nohighlight">\(\varphi*(\omega_2) = c\cdot\omega\)</span>,
where <span class="math notranslate nohighlight">\(\omega\)</span> and <span class="math notranslate nohighlight">\(omega_2\)</span> are the invariant
differentials on <span class="math notranslate nohighlight">\(E\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span> corresponding to the given
equation.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">via_formal</span></code> - (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>) If <code class="docutils literal notranslate"><span class="pre">True</span></code> it simply
checks if the leading term of the formal series is
1. Otherwise it uses a deprecated algorithm involving the
second optional argument.</li>
<li><code class="docutils literal notranslate"><span class="pre">check_by_pullback</span></code> -  (default:<code class="docutils literal notranslate"><span class="pre">True</span></code>) Deprecated.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">);</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">79</span><span class="o">/</span><span class="mi">4</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_normalized</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_separable">
<code class="descname">is_separable</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_separable" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether or not this isogeny is separable.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function always returns <code class="docutils literal notranslate"><span class="pre">True</span></code> as currently this
class only implements separable isogenies.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_separable</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_surjective">
<code class="descname">is_surjective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_surjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">True</span></code> if and only if this isogeny is surjective.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function always returns <code class="docutils literal notranslate"><span class="pre">True</span></code>, as a non-constant
map of algebraic curves must be surjective, and this class
does not model the constant <span class="math notranslate nohighlight">\(0\)</span> isogeny.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="mi">29</span><span class="o">/</span><span class="mi">5</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;omega&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">F</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_zero">
<code class="descname">is_zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.is_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this isogeny is zero.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently this class does not allow zero isogenies, so this
function will always return True.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.kernel_polynomial">
<code class="descname">kernel_polynomial</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.kernel_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel polynomial of this isogeny.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">x^2 - 21*x + 80</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">kernel_polynomial</span><span class="p">()</span>
<span class="go">x^3 + 3*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.n">
<code class="descname">n</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.n" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerical Approximation inherited from Map (through morphism),
nonsensical for isogenies.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">n</span><span class="p">()</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: Numerical approximations do not make sense for Elliptic Curve Isogenies</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.post_compose">
<code class="descname">post_compose</code><span class="sig-paren">(</span><em>left</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.post_compose" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the post-composition of this isogeny with <code class="docutils literal notranslate"><span class="pre">left</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">post_compose</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: post-composition of isogenies not yet implemented</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.pre_compose">
<code class="descname">pre_compose</code><span class="sig-paren">(</span><em>right</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.pre_compose" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pre-composition of this isogeny with <code class="docutils literal notranslate"><span class="pre">right</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">pre_compose</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">NotImplementedError: pre-composition of isogenies not yet implemented</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.rational_maps">
<code class="descname">rational_maps</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.rational_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the pair of rational maps defining this isogeny.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Both components are returned as elements of the function
field <span class="math notranslate nohighlight">\(F(x,y)\)</span> in two variables over the base field <span class="math notranslate nohighlight">\(F\)</span>,
though the first only involves <span class="math notranslate nohighlight">\(x\)</span>.  To obtain the
<span class="math notranslate nohighlight">\(x\)</span>-coordinate function as a rational function in <span class="math notranslate nohighlight">\(F(x)\)</span>,
use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.x_rational_map" title="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.x_rational_map"><code class="xref py py-meth docutils literal notranslate"><span class="pre">x_rational_map()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">(x, y)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + 3)/x, (x^2*y - 3*y)/x^2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.set_post_isomorphism">
<code class="descname">set_post_isomorphism</code><span class="sig-paren">(</span><em>postWI</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.set_post_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify this isogeny by postcomposing with a Weierstrass isomorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">18</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 3 from Elliptic Curve defined by y^2 = x^3 + 1 over Finite Field of size 31 to Elliptic Curve defined by y^2 + 24*x*y + 7*y = x^3 + 22*x^2 + 16*x + 20 over Finite Field of size 31</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">47</span><span class="p">)(</span><span class="mi">0</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">post_isom</span> <span class="o">=</span> <span class="n">E2</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_post_isomorphism</span><span class="p">(</span><span class="n">post_isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">switch_sign</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Example over a number field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="n">K</span><span class="p">(</span><span class="mi">1728</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">ker_list</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_points</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">ker_list</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">post_isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">(),</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 4 from Elliptic Curve defined by y^2 = x^3 + x over Number Field in a with defining polynomial x^2 + 2 to Elliptic Curve defined by y^2 = x^3 + (-44)*x + 112 over Number Field in a with defining polynomial x^2 + 2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.set_pre_isomorphism">
<code class="descname">set_pre_isomorphism</code><span class="sig-paren">(</span><em>preWI</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.set_pre_isomorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify this isogeny by precomposing with a Weierstrass isomorphism.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">31</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">30</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Epr</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">short_weierstrass_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">Epr</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_pre_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((-6*x^4 - 3*x^3 + 12*x^2 + 10*x - 1)/(x^3 + x - 12), (3*x^7 + x^6*y - 14*x^6 - 3*x^5 + 5*x^4*y + 7*x^4 + 8*x^3*y - 8*x^3 - 5*x^2*y + 5*x^2 - 14*x*y + 14*x - 6*y - 6)/(x^6 + 2*x^4 + 7*x^3 + x^2 + 7*x - 11))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">22</span><span class="p">)))</span>
<span class="go">(13 : 21 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)))</span>
<span class="go">(14 : 17 : 1)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">29</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">29</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 = x^3 + x over Finite Field of size 29 to Elliptic Curve defined by y^2 = x^3 + 20*x over Finite Field of size 29</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">inv_isom</span> <span class="o">=</span> <span class="n">WeierstrassIsomorphism</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">Epr</span> <span class="o">=</span> <span class="n">inv_isom</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">Epr</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_pre_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + 10*x*y + 20*y = x^3 + 27*x^2 + 6 over Finite Field of size 29 to Elliptic Curve defined by y^2 = x^3 + 20*x over Finite Field of size 29</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">12</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span>
<span class="go">(26 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">9</span><span class="p">)))</span>
<span class="go">(0 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">21</span><span class="p">,</span><span class="mi">12</span><span class="p">)))</span>
<span class="go">(3 : 0 : 1)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(x^5 - 10*x^4 - 6*x^3 - 7*x^2 - x + 3)/(x^4 - 8*x^3 + 5*x^2 - 14*x - 6)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">80</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.weierstrass_morphism</span> <span class="kn">import</span> <span class="n">WeierstrassIsomorphism</span>
<span class="gp">sage: </span><span class="n">Epr</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">short_weierstrass_model</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">isom</span> <span class="o">=</span> <span class="n">Epr</span><span class="o">.</span><span class="n">isomorphism_to</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">set_pre_isomorphism</span><span class="p">(</span><span class="n">isom</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 5 from Elliptic Curve defined by y^2 = x^3 - 13392*x - 1080432 over Rational Field to Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="p">(</span><span class="n">Epr</span><span class="p">((</span><span class="mi">168</span><span class="p">,</span><span class="mi">1188</span><span class="p">)))</span>
<span class="go">(0 : 1 : 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.switch_sign">
<code class="descname">switch_sign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.switch_sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Compose this isogeny with <span class="math notranslate nohighlight">\([-1]\)</span> (negation).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">23</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">torsion_polynomial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">switch_sign</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span> <span class="o">==</span> <span class="n">E</span><span class="o">.</span><span class="n">multiplication_by_m</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">6</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 + 15*x*y + 12*y = x^3 + 3*x^2 + 7*x + 6 over Finite Field of size 17 to Elliptic Curve defined by y^2 + 15*x*y + 12*y = x^3 + 3*x^2 + 4*x + 8 over Finite Field of size 17</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + 6*x + 4)/(x + 6), (x^2*y - 5*x*y + 8*x - 2*y)/(x^2 - 5*x + 2))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">switch_sign</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 + 15*x*y + 12*y = x^3 + 3*x^2 + 7*x + 6 over Finite Field of size 17 to Elliptic Curve defined by y^2 + 15*x*y + 12*y = x^3 + 3*x^2 + 4*x + 8 over Finite Field of size 17</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + 6*x + 4)/(x + 6),</span>
<span class="go"> (2*x^3 - x^2*y - 5*x^2 + 5*x*y - 4*x + 2*y + 7)/(x^2 - 5*x + 2))</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">80</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">xmap1</span><span class="p">,</span> <span class="n">ymap1</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">switch_sign</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">xmap2</span><span class="p">,</span> <span class="n">ymap2</span><span class="p">)</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">xmap1</span> <span class="o">==</span> <span class="n">xmap2</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">ymap1</span> <span class="o">==</span> <span class="o">-</span><span class="n">ymap2</span> <span class="o">-</span> <span class="n">E</span><span class="o">.</span><span class="n">a1</span><span class="p">()</span><span class="o">*</span><span class="n">xmap2</span> <span class="o">-</span> <span class="n">E</span><span class="o">.</span><span class="n">a3</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + (-a)*x - 2)/(x + (-a)), (x^2*y + (-2*a)*x*y + y)/(x^2 + (-2*a)*x - 1))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">switch_sign</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">rational_maps</span><span class="p">()</span>
<span class="go">((x^2 + (-a)*x - 2)/(x + (-a)), (-x^2*y + (2*a)*x*y - y)/(x^2 + (-2*a)*x - 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.x_rational_map">
<code class="descname">x_rational_map</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.x_rational_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rational map giving the <span class="math notranslate nohighlight">\(x\)</span>-coordinate of this isogeny.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function returns the <span class="math notranslate nohighlight">\(x\)</span>-coordinate component of the
isogeny as a rational function in <span class="math notranslate nohighlight">\(F(x)\)</span>, where <span class="math notranslate nohighlight">\(F\)</span> is the
base field.  To obtain both coordinate functions as
elements of the function field <span class="math notranslate nohighlight">\(F(x,y)\)</span> in two variables,
use <a class="reference internal" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.rational_maps" title="sage.schemes.elliptic_curves.ell_curve_isogeny.EllipticCurveIsogeny.rational_maps"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rational_maps()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">x_rational_map</span><span class="p">()</span>
<span class="go">x</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">x_rational_map</span><span class="p">()</span>
<span class="go">(x^2 + 3)/x</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_codomain_formula">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_codomain_formula</code><span class="sig-paren">(</span><em>E</em>, <em>v</em>, <em>w</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_codomain_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the codomain curve given parameters <span class="math notranslate nohighlight">\(v\)</span> and <span class="math notranslate nohighlight">\(w\)</span> (as in
Velu / Kohel / etc formulas).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve</li>
<li><code class="docutils literal notranslate"><span class="pre">v</span></code>, <code class="docutils literal notranslate"><span class="pre">w</span></code> – elements of the base field of <code class="docutils literal notranslate"><span class="pre">E</span></code></li>
</ul>
<p>OUTPUT:</p>
<p>The elliptic curve with invariants
<span class="math notranslate nohighlight">\([a_1,a_2,a_3,a_4-5v,a_6-(a_1^2+4a_2)v-7w]\)</span> where
<span class="math notranslate nohighlight">\(E=[a_1,a_2,a_3,a_4,a_6]\)</span>.</p>
<p>EXAMPLES:</p>
<p>This formula is used by every Isogeny instantiation:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 9*x + 13 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_codomain_formula</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">_EllipticCurveIsogeny__v</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">_EllipticCurveIsogeny__w</span>
<span class="gp">sage: </span><span class="n">compute_codomain_formula</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_codomain_kohel">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_codomain_kohel</code><span class="sig-paren">(</span><em>E</em>, <em>kernel</em>, <em>degree</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_codomain_kohel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the codomain from the kernel polynomial using Kohel’s
formulas.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve</li>
<li><code class="docutils literal notranslate"><span class="pre">kernel</span></code> (polynomial or list) – the kernel polynomial, or a
list of its coefficients</li>
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> (int) – degree of the isogeny</li>
</ul>
<p>OUTPUT:</p>
<p>(elliptic curve) – the codomain elliptic curve <code class="docutils literal notranslate"><span class="pre">E</span></code>/<code class="docutils literal notranslate"><span class="pre">kernel</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_codomain_kohel</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">compute_codomain_kohel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 9*x + 8 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">compute_codomain_kohel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + 18*x*y + 16*y = x^3 + 17*x^2 + 18*x + 18 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">compute_codomain_kohel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 3*x + 15 over Finite Field of size 19</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function uses the formulas of Section 2.4 of <a class="reference internal" href="../../../../references/index.html#koh1996" id="id1">[Koh1996]</a>.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_intermediate_curves">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_intermediate_curves</code><span class="sig-paren">(</span><em>E1</em>, <em>E2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_intermediate_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Return intermediate curves and isomorphisms.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is used so we can compute <span class="math notranslate nohighlight">\(\wp\)</span> functions from the short
Weierstrass model more easily.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The base field must be of characteristic not equal to 2,3.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E1</span></code> - an elliptic curve</li>
<li><code class="docutils literal notranslate"><span class="pre">E2</span></code> - an elliptic curve</li>
</ul>
<p>OUTPUT:</p>
<p>tuple (<code class="docutils literal notranslate"><span class="pre">pre_isomorphism</span></code>, <code class="docutils literal notranslate"><span class="pre">post_isomorphism</span></code>,
<code class="docutils literal notranslate"><span class="pre">intermediate_domain</span></code>, <code class="docutils literal notranslate"><span class="pre">intermediate_codomain</span></code>):</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">intermediate_domain</span></code>: a short Weierstrass model isomorphic to
<code class="docutils literal notranslate"><span class="pre">E1</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">intermediate_codomain</span></code>: a short Weierstrass model isomorphic
to <code class="docutils literal notranslate"><span class="pre">E2</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">pre_isomorphism</span></code>: normalized isomorphism from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to
intermediate_domain</li>
<li><code class="docutils literal notranslate"><span class="pre">post_isomorphism</span></code>: normalized isomorphism from
intermediate_codomain to <code class="docutils literal notranslate"><span class="pre">E2</span></code></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_intermediate_curves</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">83</span><span class="p">)[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">24</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_intermediate_curves</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">)</span>
<span class="go">(Elliptic Curve defined by y^2 = x^3 + 62*x + 74 over Finite Field of size 83,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 65*x + 69 over Finite Field of size 83,</span>
<span class="go"> Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + x over Finite Field of size 83</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 62*x + 74 over Finite Field of size 83</span>
<span class="go">  Via:  (u,r,s,t) = (1, 76, 41, 3),</span>
<span class="go"> Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 65*x + 69 over Finite Field of size 83</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + 4*x + 16 over Finite Field of size 83</span>
<span class="go">  Via:  (u,r,s,t) = (1, 7, 42, 42))</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">compute_intermediate_curves</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">)</span>
<span class="go">(Elliptic Curve defined by y^2 = x^3 + x over Number Field in i with defining polynomial x^2 + 1,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 16*x over Number Field in i with defining polynomial x^2 + 1,</span>
<span class="go"> Generic endomorphism of Abelian group of points on Elliptic Curve defined by y^2 = x^3 + x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Via:  (u,r,s,t) = (1, 0, 0, 0),</span>
<span class="go"> Generic endomorphism of Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 16*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Via:  (u,r,s,t) = (1, 0, 0, 0))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_isogeny_kernel_polynomial">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_isogeny_kernel_polynomial</code><span class="sig-paren">(</span><em>E1</em>, <em>E2</em>, <em>ell</em>, <em>algorithm='starks'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_isogeny_kernel_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel polynomial of an isogeny of degree <code class="docutils literal notranslate"><span class="pre">ell</span></code>
between <code class="docutils literal notranslate"><span class="pre">E1</span></code> and <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E1</span></code>        - an elliptic curve in short Weierstrass form.</li>
<li><code class="docutils literal notranslate"><span class="pre">E2</span></code>        - an elliptic curve in short Weierstrass form.</li>
<li><code class="docutils literal notranslate"><span class="pre">ell</span></code>       - the degree of the isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - currently only <code class="docutils literal notranslate"><span class="pre">starks</span></code> (default) is implemented.</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial over the field of definition of <code class="docutils literal notranslate"><span class="pre">E1</span></code>, <code class="docutils literal notranslate"><span class="pre">E2</span></code>, that is
the kernel polynomial of the isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If there is no degree <code class="docutils literal notranslate"><span class="pre">ell</span></code>, cyclic, separable, normalized
isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code> then an error will be raised.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_isogeny_kernel_polynomial</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_isogeny_kernel_polynomial</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">x^2 + 7*x + 13</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">x^2 + 7*x + 13</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">compute_isogeny_kernel_polynomial</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">x^3 + x</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_isogeny_starks">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_isogeny_starks</code><span class="sig-paren">(</span><em>E1</em>, <em>E2</em>, <em>ell</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_isogeny_starks" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the kernel polynomials of an isogeny of degree <code class="docutils literal notranslate"><span class="pre">ell</span></code>
between <code class="docutils literal notranslate"><span class="pre">E1</span></code> and <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E1</span></code>  - an elliptic curve in short Weierstrass form.</li>
<li><code class="docutils literal notranslate"><span class="pre">E2</span></code>  - an elliptic curve in short Weierstrass form.</li>
<li><code class="docutils literal notranslate"><span class="pre">ell</span></code> - the degree of the isogeny from E1 to E2.</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial over the field of definition of <code class="docutils literal notranslate"><span class="pre">E1</span></code>, <code class="docutils literal notranslate"><span class="pre">E2</span></code>, that is
the kernel polynomial of the isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There must be a degree <code class="docutils literal notranslate"><span class="pre">ell</span></code>, separable, normalized cyclic
isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code>, or an error will be raised.</p>
</div>
<p>ALGORITHM:</p>
<p>This function uses Starks Algorithm as presented in section 6.2 of
<a class="reference internal" href="../../../../references/index.html#bmss2006" id="id2">[BMSS2006]</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As published in <a class="reference internal" href="../../../../references/index.html#bmss2006" id="id3">[BMSS2006]</a>, the algorithm is incorrect, and a
correct version (with slightly different notation) can be found
in <a class="reference internal" href="../../../../references/index.html#mo2009" id="id4">[Mo2009]</a>.  The algorithm originates in <a class="reference internal" href="../../../../references/index.html#sta1973" id="id5">[Sta1973]</a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_isogeny_starks</span><span class="p">,</span> <span class="n">compute_sequence_of_maps</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">97</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">97</span><span class="p">)[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">61</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">58</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">21</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">isom1</span><span class="p">,</span> <span class="n">isom2</span><span class="p">,</span> <span class="n">E1pr</span><span class="p">,</span> <span class="n">E2pr</span><span class="p">,</span> <span class="n">ker_poly</span><span class="p">)</span> <span class="o">=</span> <span class="n">compute_sequence_of_maps</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">compute_isogeny_starks</span><span class="p">(</span><span class="n">E1pr</span><span class="p">,</span> <span class="n">E2pr</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="go">x^10 + 37*x^9 + 53*x^8 + 66*x^7 + 66*x^6 + 17*x^5 + 57*x^4 + 6*x^3 + 89*x^2 + 53*x + 8</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_isogeny_starks</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">x^4 + 14*x^3 + x^2 + 34*x + 21</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">**</span><span class="mi">2</span>
<span class="go">x^4 + 14*x^3 + x^2 + 34*x + 21</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_isogeny_starks</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">x</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_sequence_of_maps">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_sequence_of_maps</code><span class="sig-paren">(</span><em>E1</em>, <em>E2</em>, <em>ell</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_sequence_of_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Return intermediate curves, isomorphisms and kernel polynomial.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E1</span></code>, <code class="docutils literal notranslate"><span class="pre">E2</span></code> – elliptic curves.</li>
<li><code class="docutils literal notranslate"><span class="pre">ell</span></code> – a prime such that there is a degree <code class="docutils literal notranslate"><span class="pre">ell</span></code> separable
normalized isogeny from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to <code class="docutils literal notranslate"><span class="pre">E2</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>(pre_isom, post_isom, E1pr, E2pr, ker_poly) where:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E1pr</span></code> is an elliptic curve in short Weierstrass form
isomorphic to <code class="docutils literal notranslate"><span class="pre">E1</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">E2pr</span></code> is an elliptic curve in short Weierstrass form
isomorphic to <code class="docutils literal notranslate"><span class="pre">E2</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">pre_isom</span></code> is a normalised isomorphism from <code class="docutils literal notranslate"><span class="pre">E1</span></code> to
<code class="docutils literal notranslate"><span class="pre">E1pr</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">post_isom</span></code> is a normalised isomorphism from <code class="docutils literal notranslate"><span class="pre">E2pr</span></code> to
<code class="docutils literal notranslate"><span class="pre">E2</span></code>;</li>
<li><code class="docutils literal notranslate"><span class="pre">ker_poly</span></code> is the kernel polynomial of an <code class="docutils literal notranslate"><span class="pre">ell</span></code>-isogeny from
<code class="docutils literal notranslate"><span class="pre">E1pr</span></code> to <code class="docutils literal notranslate"><span class="pre">E2pr</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_sequence_of_maps</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">21</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">80</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_sequence_of_maps</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">(Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x^2 - 10*x - 20 over Rational Field</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 = x^3 - 31/3*x - 2501/108 over Rational Field</span>
<span class="go">  Via:  (u,r,s,t) = (1, 1/3, 0, -1/2),</span>
<span class="go"> Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 = x^3 - 23461/3*x - 28748141/108 over Rational Field</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 + y = x^3 - x^2 - 7820*x - 263580 over Rational Field</span>
<span class="go">  Via:  (u,r,s,t) = (1, -1/3, 0, 1/2),</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 - 31/3*x - 2501/108 over Rational Field,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 - 23461/3*x - 28748141/108 over Rational Field,</span>
<span class="go"> x^2 - 61/3*x + 658/9)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">i</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">NumberField</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">compute_sequence_of_maps</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">(Generic endomorphism of Abelian group of points on Elliptic Curve defined by y^2 = x^3 + x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Via:  (u,r,s,t) = (1, 0, 0, 0),</span>
<span class="go"> Generic endomorphism of Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 16*x over Number Field in i with defining polynomial x^2 + 1</span>
<span class="go">  Via:  (u,r,s,t) = (1, 0, 0, 0),</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + x over Number Field in i with defining polynomial x^2 + 1,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 16*x over Number Field in i with defining polynomial x^2 + 1,</span>
<span class="go"> x^3 + x)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">97</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">97</span><span class="p">)[];</span> <span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">27</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">61</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">58</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">28</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">21</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">compute_sequence_of_maps</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="go">(Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + x over Finite Field of size 97</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 52*x + 31 over Finite Field of size 97</span>
<span class="go">  Via:  (u,r,s,t) = (1, 8, 48, 44),</span>
<span class="go"> Generic morphism:</span>
<span class="go">  From: Abelian group of points on Elliptic Curve defined by y^2 = x^3 + 41*x + 66 over Finite Field of size 97</span>
<span class="go">  To:   Abelian group of points on Elliptic Curve defined by y^2 + x*y + y = x^3 + 87*x + 26 over Finite Field of size 97</span>
<span class="go">  Via:  (u,r,s,t) = (1, 89, 49, 49),</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 52*x + 31 over Finite Field of size 97,</span>
<span class="go"> Elliptic Curve defined by y^2 = x^3 + 41*x + 66 over Finite Field of size 97,</span>
<span class="go"> x^5 + 67*x^4 + 13*x^3 + 35*x^2 + 77*x + 69)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_even_deg1">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_vw_kohel_even_deg1</code><span class="sig-paren">(</span><em>x0</em>, <em>y0</em>, <em>a1</em>, <em>a2</em>, <em>a4</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_even_deg1" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Velu’s (v,w) using Kohel’s formulas for isogenies of
degree exactly divisible by 2.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">x0</span></code>, <code class="docutils literal notranslate"><span class="pre">y0</span></code> – coordinates of a 2-torsion point on an elliptic curve E</li>
<li><code class="docutils literal notranslate"><span class="pre">a1</span></code>, <code class="docutils literal notranslate"><span class="pre">a2</span></code>, <code class="docutils literal notranslate"><span class="pre">a4</span></code> – invariants of E</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) Velu’s isogeny parameters (v,w).</p>
<p>EXAMPLES:</p>
<p>This function will be implicitly called by the following example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">1</span><span class="p">]);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 2 from Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over Finite Field of size 19 to Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 9*x + 8 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_vw_kohel_even_deg1</span>
<span class="gp">sage: </span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">,</span><span class="n">a6</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">ainvs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">9</span>
<span class="gp">sage: </span><span class="n">y0</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">a1</span><span class="o">*</span><span class="n">x0</span> <span class="o">+</span> <span class="n">a3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">compute_vw_kohel_even_deg1</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a4</span><span class="p">)</span>
<span class="go">(18, 9)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_even_deg3">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_vw_kohel_even_deg3</code><span class="sig-paren">(</span><em>b2</em>, <em>b4</em>, <em>s1</em>, <em>s2</em>, <em>s3</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_even_deg3" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Velu’s (v,w) using Kohel’s formulas for isogenies of
degree divisible by 4.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">b2</span></code>, <code class="docutils literal notranslate"><span class="pre">b4</span></code> – invariants of an elliptic curve E</li>
<li><code class="docutils literal notranslate"><span class="pre">s1</span></code>, <code class="docutils literal notranslate"><span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s3</span></code> – signed coefficients of the 2-division
polynomial of E</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) Velu’s isogeny parameters (v,w).</p>
<p>EXAMPLES:</p>
<p>This function will be implicitly called by the following example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 4 from Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 4*x + 5 over Finite Field of size 19 to Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 3*x + 15 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_vw_kohel_even_deg3</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="n">b4</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">b2</span><span class="p">(),</span> <span class="n">E</span><span class="o">.</span><span class="n">b4</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">compute_vw_kohel_even_deg3</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span> <span class="n">b4</span><span class="p">,</span> <span class="n">s1</span><span class="p">,</span> <span class="n">s2</span><span class="p">,</span> <span class="n">s3</span><span class="p">)</span>
<span class="go">(4, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_odd">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">compute_vw_kohel_odd</code><span class="sig-paren">(</span><em>b2</em>, <em>b4</em>, <em>b6</em>, <em>s1</em>, <em>s2</em>, <em>s3</em>, <em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.compute_vw_kohel_odd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Velu’s (v,w) using Kohel’s formulas for isogenies of odd
degree.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">b2</span></code>, <code class="docutils literal notranslate"><span class="pre">b4</span></code>, <code class="docutils literal notranslate"><span class="pre">b6</span></code> – invariants of an elliptic curve E</li>
<li><code class="docutils literal notranslate"><span class="pre">s1</span></code>, <code class="docutils literal notranslate"><span class="pre">s2</span></code>, <code class="docutils literal notranslate"><span class="pre">s3</span></code> – signed coefficients of lowest powers
of x in the kernel polynomial.</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> (int) – the degree</li>
</ul>
<p>OUTPUT:</p>
<p>(tuple) Velu’s isogeny parameters (v,w).</p>
<p>EXAMPLES:</p>
<p>This function will be implicitly called by the following example:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">14</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">11</span><span class="p">);</span> <span class="n">phi</span>
<span class="go">Isogeny of degree 7 from Elliptic Curve defined by y^2 + 18*x*y + 16*y = x^3 + 17*x^2 + 15*x + 14 over Finite Field of size 19 to Elliptic Curve defined by y^2 + 18*x*y + 16*y = x^3 + 17*x^2 + 18*x + 18 over Finite Field of size 19</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_vw_kohel_odd</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="n">b4</span><span class="p">,</span><span class="n">b6</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="o">.</span><span class="n">b2</span><span class="p">(),</span> <span class="n">E</span><span class="o">.</span><span class="n">b4</span><span class="p">(),</span> <span class="n">E</span><span class="o">.</span><span class="n">b6</span><span class="p">())</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">compute_vw_kohel_odd</span><span class="p">(</span><span class="n">b2</span><span class="p">,</span><span class="n">b4</span><span class="p">,</span><span class="n">b6</span><span class="p">,</span><span class="n">s1</span><span class="p">,</span><span class="n">s2</span><span class="p">,</span><span class="n">s3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">(7, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.fill_isogeny_matrix">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">fill_isogeny_matrix</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.fill_isogeny_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a filled isogeny matrix giving all degrees from one giving only prime degrees.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> – a square symmetric matrix whose off-diagonal <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span>
entry is either a prime <span class="math notranslate nohighlight">\(l\)</span> (if the <span class="math notranslate nohighlight">\(i\)</span>’th and <span class="math notranslate nohighlight">\(j\)</span>’th curves
have an <span class="math notranslate nohighlight">\(l\)</span>-isogeny between them), otherwise is 0.</li>
</ul>
<p>OUTPUT:</p>
<p>(matrix) a square matrix with entries <span class="math notranslate nohighlight">\(1\)</span> on the diagonal, and in
general the <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(j\)</span> entry is <span class="math notranslate nohighlight">\(d&gt;0\)</span> if <span class="math notranslate nohighlight">\(d\)</span> is the minimal degree
of an isogeny from the <span class="math notranslate nohighlight">\(i\)</span>’th to the <span class="math notranslate nohighlight">\(j\)</span>’th curve,</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[0 2 3 3 0 0]</span>
<span class="go">[2 0 0 0 3 3]</span>
<span class="go">[3 0 0 0 2 0]</span>
<span class="go">[3 0 0 0 0 2]</span>
<span class="go">[0 3 2 0 0 0]</span>
<span class="go">[0 3 0 2 0 0]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">fill_isogeny_matrix</span>
<span class="gp">sage: </span><span class="n">fill_isogeny_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">[ 1  2  3  3  6  6]</span>
<span class="go">[ 2  1  6  6  3  3]</span>
<span class="go">[ 3  6  1  9  2 18]</span>
<span class="go">[ 3  6  9  1 18  2]</span>
<span class="go">[ 6  3  2 18  1  9]</span>
<span class="go">[ 6  3 18  2  9  1]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.isogeny_codomain_from_kernel">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">isogeny_codomain_from_kernel</code><span class="sig-paren">(</span><em>E</em>, <em>kernel</em>, <em>degree=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.isogeny_codomain_from_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the isogeny codomain given a kernel.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> - The domain elliptic curve.</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">kernel</span></code> - Either a list of points in the kernel of the isogeny, or a</dt>
<dd>kernel polynomial (specified as a either a univariate
polynomial or a coefficient list.)</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">degree</span></code> - an integer, (default:<code class="docutils literal notranslate"><span class="pre">None</span></code>)  optionally specified degree</dt>
<dd>of the kernel.</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>(elliptic curve) the codomain of the separable normalized isogeny
from this kernel</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">isogeny_codomain_from_kernel</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + 4*x + 6 over Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span> <span class="o">==</span> <span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + 4*x + 6 over Finite Field of size 7</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + y = x^3 + 5*x + 2 over Finite Field of size 7</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">kernel_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">E</span><span class="p">((</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">)),</span> <span class="n">E</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">)),</span><span class="n">E</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">))]</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">kernel_list</span><span class="p">)</span>
<span class="go">Elliptic Curve defined by y^2 + x*y + 3*y = x^3 + 2*x^2 + 3*x + 15 over Finite Field of size 19</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.isogeny_determine_algorithm">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">isogeny_determine_algorithm</code><span class="sig-paren">(</span><em>E</em>, <em>kernel</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.isogeny_determine_algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that allows the various isogeny functions to infer
the algorithm type from the parameters passed in.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> (elliptic curve) – an elliptic curve</li>
<li><code class="docutils literal notranslate"><span class="pre">kernel</span></code> – either a list of points on <code class="docutils literal notranslate"><span class="pre">E</span></code>, or a univariate
polynomial or list of coefficients of a univariate polynomial.</li>
</ul>
<p>OUTPUT:</p>
<p>(string) either ‘velu’ or ‘kohel’</p>
<p>If <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is a list of points on the EllipticCurve <span class="math notranslate nohighlight">\(E\)</span>, then
we will try to use Velu’s algorithm.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is a list of coefficients or a univariate
polynomial, we will try to use the Kohel’s algorithms.</p>
<p>EXAMPLES:</p>
<p>This helper function will be implicitly called by the following examples:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p>We can construct the same isogeny from a kernel polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>or from a list of coefficients of a kernel polynomial:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">==</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
<p>or from a rational point which generates the kernel:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">==</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span>  <span class="n">E</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span> <span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>In the first two cases, Kohel’s algorithm will be used, while in
the third case it is Velu:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">isogeny_determine_algorithm</span>
<span class="gp">sage: </span><span class="n">isogeny_determine_algorithm</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="go">&#39;kohel&#39;</span>
<span class="gp">sage: </span><span class="n">isogeny_determine_algorithm</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&#39;kohel&#39;</span>
<span class="gp">sage: </span><span class="n">isogeny_determine_algorithm</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span>
<span class="go">&#39;velu&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.split_kernel_polynomial">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">split_kernel_polynomial</code><span class="sig-paren">(</span><em>poly</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.split_kernel_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal helper function for <code class="docutils literal notranslate"><span class="pre">compute_isogeny_kernel_polynomial</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">poly</span></code> – a nonzero univariate polynomial.</li>
</ul>
<p>OUTPUT:</p>
<p>The maximum separable divisor of <code class="docutils literal notranslate"><span class="pre">poly</span></code>.  If the input is a full
kernel polynomial where the roots which are <span class="math notranslate nohighlight">\(x\)</span>-coordinates of
points of order greater than 2 have multiplicity 1, the output
will be a polynomial with the same roots, all of multiplicity 1.</p>
<p>EXAMPLES:</p>
<p>The following example implicitly exercises this function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">37</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">16</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E2</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">compute_isogeny_starks</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">split_kernel_polynomial</span>
<span class="gp">sage: </span><span class="n">ker_poly</span> <span class="o">=</span> <span class="n">compute_isogeny_starks</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">E2</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span> <span class="n">ker_poly</span>
<span class="go">x^6 + 2*x^5 + 20*x^4 + 11*x^3 + 36*x^2 + 35*x + 16</span>
<span class="gp">sage: </span><span class="n">ker_poly</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + 10)^2 * (x + 12)^2 * (x + 16)^2</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">split_kernel_polynomial</span><span class="p">(</span><span class="n">ker_poly</span><span class="p">);</span> <span class="n">poly</span>
<span class="go">x^3 + x^2 + 28*x + 33</span>
<span class="gp">sage: </span><span class="n">poly</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">(x + 10) * (x + 12) * (x + 16)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.two_torsion_part">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">two_torsion_part</code><span class="sig-paren">(</span><em>E</em>, <em>psi</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.two_torsion_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the greatest common divisor of <code class="docutils literal notranslate"><span class="pre">psi</span></code> and the 2 torsion
polynomial of <span class="math notranslate nohighlight">\(E\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">E</span></code> – an elliptic curve</li>
<li><code class="docutils literal notranslate"><span class="pre">psi</span></code> – a univariate polynomial over the base field of <code class="docutils literal notranslate"><span class="pre">E</span></code></li>
</ul>
<p>OUTPUT:</p>
<p>(polynomial) the gcd of psi and the 2-torsion polynomial of <code class="docutils literal notranslate"><span class="pre">E</span></code>.</p>
<p>EXAMPLES:</p>
<p>Every function that computes the kernel polynomial via Kohel’s
formulas will call this function:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">),</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">19</span><span class="p">)[]</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">EllipticCurveIsogeny</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">isogeny_codomain_from_kernel</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">13</span><span class="p">)</span> <span class="o">==</span> <span class="n">phi</span><span class="o">.</span><span class="n">codomain</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">two_torsion_part</span>
<span class="gp">sage: </span><span class="n">two_torsion_part</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">13</span><span class="p">)</span>
<span class="go">x + 13</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.elliptic_curves.ell_curve_isogeny.unfill_isogeny_matrix">
<code class="descclassname">sage.schemes.elliptic_curves.ell_curve_isogeny.</code><code class="descname">unfill_isogeny_matrix</code><span class="sig-paren">(</span><em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.ell_curve_isogeny.unfill_isogeny_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the action of <code class="docutils literal notranslate"><span class="pre">fill_isogeny_matrix</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">M</span></code> – a square symmetric matrix of integers.</li>
</ul>
<p>OUTPUT:</p>
<p>(matrix) a square symmetric matrix obtained from <code class="docutils literal notranslate"><span class="pre">M</span></code> by
replacing non-prime entries with <span class="math notranslate nohighlight">\(0\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]);</span> <span class="n">M</span>
<span class="go">[0 2 3 3 0 0]</span>
<span class="go">[2 0 0 0 3 3]</span>
<span class="go">[3 0 0 0 2 0]</span>
<span class="go">[3 0 0 0 0 2]</span>
<span class="go">[0 3 2 0 0 0]</span>
<span class="go">[0 3 0 2 0 0]</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.elliptic_curves.ell_curve_isogeny</span> <span class="kn">import</span> <span class="n">fill_isogeny_matrix</span><span class="p">,</span> <span class="n">unfill_isogeny_matrix</span>
<span class="gp">sage: </span><span class="n">M1</span> <span class="o">=</span> <span class="n">fill_isogeny_matrix</span><span class="p">(</span><span class="n">M</span><span class="p">);</span> <span class="n">M1</span>
<span class="go">[ 1  2  3  3  6  6]</span>
<span class="go">[ 2  1  6  6  3  3]</span>
<span class="go">[ 3  6  1  9  2 18]</span>
<span class="go">[ 3  6  9  1 18  2]</span>
<span class="go">[ 6  3  2 18  1  9]</span>
<span class="go">[ 6  3 18  2  9  1]</span>
<span class="gp">sage: </span><span class="n">unfill_isogeny_matrix</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="go">[0 2 3 3 0 0]</span>
<span class="go">[2 0 0 0 3 3]</span>
<span class="go">[3 0 0 0 2 0]</span>
<span class="go">[3 0 0 0 0 2]</span>
<span class="go">[0 3 2 0 0 0]</span>
<span class="go">[0 3 0 2 0 0]</span>
<span class="gp">sage: </span><span class="n">unfill_isogeny_matrix</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="weierstrass_morphism.html"
                        title="previous chapter">Isomorphisms between Weierstrass models of elliptic curves</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="isogeny_small_degree.html"
                        title="next chapter">Isogenies of small prime degree</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/elliptic_curves/ell_curve_isogeny.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="isogeny_small_degree.html" title="Isogenies of small prime degree"
             >next</a> |</li>
        <li class="right" >
          <a href="weierstrass_morphism.html" title="Isomorphisms between Weierstrass models of elliptic curves"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Sage 9.1 Reference Manual: Curves</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>