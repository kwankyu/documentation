
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Tate-Shafarevich group &#8212; Sage Reference Manual v8.2: Plane curves</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Complex multiplication for elliptic curves" href="cm.html" />
    <link rel="prev" title="Isogeny class of elliptic curves over number fields" href="isogeny_class.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cm.html" title="Complex multiplication for elliptic curves"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="isogeny_class.html" title="Isogeny class of elliptic curves over number fields"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tate-shafarevich-group">
<span id="sage-schemes-elliptic-curves-sha-tate"></span><h1>Tate-Shafarevich group<a class="headerlink" href="#tate-shafarevich-group" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.elliptic_curves.sha_tate"></span><p>If <span class="math">\(E\)</span> is an elliptic curve over a global field <span class="math">\(K\)</span>, the Tate-Shafarevich
group is the subgroup of elements in <span class="math">\(H^1(K,E)\)</span> which map to zero under every
global-to-local restriction map <span class="math">\(H^1(K,E) \to H^1(K_v,E)\)</span>, one for each place
<span class="math">\(v\)</span> of <span class="math">\(K\)</span>.</p>
<p>The group is usually denoted by the Russian letter Sha (Ш), in this document
it will be denoted by <span class="math">\(Sha\)</span>.</p>
<p><span class="math">\(Sha\)</span> is known to be an abelian torsion group. It is conjectured that the
Tate-Shafarevich group is finite for any elliptic curve over a global field.
But it is not known in general.</p>
<p>A theorem of Kolyvagin and Gross-Zagier using Heegner points shows that if the
L-series of an elliptic curve <span class="math">\(E/\QQ\)</span> does not vanish at 1 or has a simple
zero there, then <span class="math">\(Sha\)</span> is finite.</p>
<p>A theorem of Kato, together with theorems from Iwasawa theory, allows for
certain primes <span class="math">\(p\)</span> to show that the <span class="math">\(p\)</span>-primary part of <span class="math">\(Sha\)</span> is finite and
gives an effective upper bound for it.</p>
<p>The (<span class="math">\(p\)</span>-adic) conjecture of Birch and Swinnerton-Dyer predicts the order of
<span class="math">\(Sha\)</span> from the leading term of the (<span class="math">\(p\)</span>-adic) L-series of the elliptic curve.</p>
<p>Sage can compute a few things about <span class="math">\(Sha\)</span>. The commands <code class="docutils literal"><span class="pre">an</span></code>,
<code class="docutils literal"><span class="pre">an_numerical</span></code> and <code class="docutils literal"><span class="pre">an_padic</span></code> compute the conjectural order of <span class="math">\(Sha\)</span> as a
real or <span class="math">\(p\)</span>-adic number. With <code class="docutils literal"><span class="pre">p_primary_bound</span></code> one can find an upper bound
of the size of the <span class="math">\(p\)</span>-primary part of <span class="math">\(Sha\)</span>. Finally, if the analytic rank is
at most 1, then <code class="docutils literal"><span class="pre">bound_kato</span></code> and <code class="docutils literal"><span class="pre">bound_kolyvagin</span></code> find all primes for
which the theorems of Kato and Kolyvagin respectively do not prove the
triviality the <span class="math">\(p\)</span>-primary part of <span class="math">\(Sha\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 5], 1)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1 + O(7^5)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein (2007) – initial version</li>
<li>Chris Wuthrich (April 2009) – reformat docstrings</li>
<li>Aly Deines, Chris Wuthrich, Jeaninne Van Order (2016-03): Added
functionality that tests the Skinner-Urban condition.</li>
</ul>
<dl class="class">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha">
<em class="property">class </em><code class="descclassname">sage.schemes.elliptic_curves.sha_tate.</code><code class="descname">Sha</code><span class="sig-paren">(</span><em>E</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/sage_object.html#sage.structure.sage_object.SageObject" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>The Tate-Shafarevich group associated to an elliptic curve.</p>
<p>If <span class="math">\(E\)</span> is an elliptic curve over a global field <span class="math">\(K\)</span>, the Tate-Shafarevich
group is the subgroup of elements in <span class="math">\(H^1(K,E)\)</span> which map to zero under
every global-to-local restriction map <span class="math">\(H^1(K,E) \to H^1(K_v,E)\)</span>, one for
each place <span class="math">\(v\)</span> of <span class="math">\(K\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">_set_gens</span><span class="p">([])</span>   <span class="c1"># curve has rank 0, but non-trivial Sha[2]</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">4 + O(7^5)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">();</span> <span class="n">S</span>
<span class="go">Tate-Shafarevich group for the Elliptic Curve defined by y^2 + y = x^3 + x^2 - 2*x over Rational Field</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>  <span class="c1"># very long time</span>
<span class="go">1 + O(5^3)</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.an">
<code class="descname">an</code><span class="sig-paren">(</span><em>use_database=False</em>, <em>descent_second_limit=12</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Birch and Swinnerton-Dyer conjectural order of <span class="math">\(Sha\)</span>
as a provably correct integer, unless the analytic rank is &gt; 1,
in which case this function returns a numerical value.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">use_database</span></code> – bool (default: <code class="docutils literal"><span class="pre">False</span></code>); if <code class="docutils literal"><span class="pre">True</span></code>, try
to use any databases installed to lookup the analytic order of
<span class="math">\(Sha\)</span>, if possible.  The order of <span class="math">\(Sha\)</span> is computed if it cannot
be looked up.</li>
<li><code class="docutils literal"><span class="pre">descent_second_limit</span></code> – int (default: 12); limit to use on
point searching for the quartic twist in the hard case</li>
</ul>
</div></blockquote>
<p>This result is proved correct if the order of vanishing is 0
and the Manin constant is &lt;= 2.</p>
<p>If the optional parameter <code class="docutils literal"><span class="pre">use_database</span></code> is <code class="docutils literal"><span class="pre">True</span></code> (default:
<code class="docutils literal"><span class="pre">False</span></code>), this function returns the analytic order of <span class="math">\(Sha\)</span> as
listed in Cremona’s tables, if this curve appears in Cremona’s
tables.</p>
<p>NOTE:</p>
<p>If you come across the following error:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">34874</span><span class="p">,</span> <span class="o">-</span><span class="mi">2506691</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">RuntimeError</span>: <span class="n">Unable to compute the rank, hence generators, with certainty (lower bound=0, generators found=[]).  This could be because Sha(E/Q)[2] is nontrivial.</span>
<span class="go">Try increasing descent_second_limit then trying this command again.</span>
</pre></div>
</div>
<p>You can increase the <code class="docutils literal"><span class="pre">descent_second_limit</span></code> (in the above example,
set to the default, 12) option to try again:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">descent_second_limit</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;14a4&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">(</span><span class="n">use_database</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>   <span class="c1"># will be faster if you have large Cremona database installed</span>
<span class="go">1</span>
</pre></div>
</div>
<p>The smallest conductor curve with nontrivial <span class="math">\(Sha\)</span>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">352</span><span class="p">,</span><span class="o">-</span><span class="mi">2689</span><span class="p">])</span>     <span class="c1"># 66b3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The four optimal quotients with nontrivial <span class="math">\(Sha\)</span> and conductor &lt;= 1000:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">929</span><span class="p">,</span> <span class="o">-</span><span class="mi">10595</span><span class="p">])</span>       <span class="c1"># 571A</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1154</span><span class="p">,</span> <span class="o">-</span><span class="mi">15345</span><span class="p">])</span>       <span class="c1"># 681B</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">900</span><span class="p">,</span> <span class="o">-</span><span class="mi">10098</span><span class="p">])</span>       <span class="c1"># 960D</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">42</span><span class="p">])</span>            <span class="c1"># 960N</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The smallest conductor curve of rank &gt; 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># 389A (rank 2)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>The following are examples that require computation of the Mordell-
Weil group and regulator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>                     <span class="c1"># 37A  (rank 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;1610f3&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
<p>In this case the input curve is not minimal, and if this function did
not transform it to be minimal, it would give nonsense:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">432</span><span class="o">*</span><span class="mi">6</span><span class="o">^</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://trac.sagemath.org/10096">trac ticket #10096</a>: this used to give the wrong result 6.0000
before since the minimal model was not used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1215</span><span class="o">*</span><span class="mi">1216</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># non-minimal model</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">minimal_model</span><span class="p">()</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>  <span class="c1"># long time (1s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.an_numerical">
<code class="descname">an_numerical</code><span class="sig-paren">(</span><em>prec=None</em>, <em>use_database=True</em>, <em>proof=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_numerical" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the numerical analytic order of <span class="math">\(Sha\)</span>, which is
a floating point number in all cases.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">prec</span></code> - integer (default: 53) bits precision – used
for the L-series computation, period,  regulator, etc.</li>
<li><code class="docutils literal"><span class="pre">use_database</span></code> - whether the rank and generators should
be looked up in the database if possible. Default is <code class="docutils literal"><span class="pre">True</span></code></li>
<li><code class="docutils literal"><span class="pre">proof</span></code> - bool or <code class="docutils literal"><span class="pre">None</span></code> (default: <code class="docutils literal"><span class="pre">None</span></code>, see proof.[tab] or
sage.structure.proof) proof option passed
onto regulator and rank computation.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See also the <a class="reference internal" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an" title="sage.schemes.elliptic_curves.sha_tate.Sha.an"><code class="xref py py-meth docutils literal"><span class="pre">an()</span></code></a> command, which will return a
provably correct integer when the rank is 0 or 1.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the curve’s generators are not known, computing
them may be very time-consuming.  Also, computation of the
L-series derivative will be time-consuming for large rank and
large conductor, and the computation time for this may
increase substantially at greater precision.  However, use of
very low precision less than about 10 can cause the underlying
PARI library functions to fail.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66b3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">4.00000000000000</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;5077a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>A rank 4 curve:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">,</span> <span class="mi">289</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">()</span>  <span class="c1"># long time (3s on sage.math, 2011)</span>
<span class="go">1.00000000000000</span>
</pre></div>
</div>
<p>A rank 5 curve:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">79</span><span class="p">,</span> <span class="mi">342</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">proof</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># long time (22s on sage.math, 2011)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://trac.sagemath.org/1115">trac ticket #1115</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sha</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">sha</span><span class="o">.</span><span class="n">an_numerical</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span> <span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">)]</span>  <span class="c1"># long time (3s on sage.math, 2013)</span>
<span class="go">[1.0000000000,</span>
<span class="go">1.0000000000000,</span>
<span class="go">1.0000000000000000,</span>
<span class="go">1.0000000000000000000,</span>
<span class="go">1.0000000000000000000000,</span>
<span class="go">1.0000000000000000000000000]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.an_padic">
<code class="descname">an_padic</code><span class="sig-paren">(</span><em>p</em>, <em>prec=0</em>, <em>use_twists=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.an_padic" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the conjectural order of <span class="math">\(Sha(E/\QQ)\)</span>,
according to the <span class="math">\(p\)</span>-adic analogue of the Birch
and Swinnerton-Dyer conjecture as formulated
in <a class="reference internal" href="#mtt" id="id1">[MTT]</a> and <a class="reference internal" href="#bp" id="id2">[BP]</a>.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="mtt" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[MTT]</a></td><td>B. Mazur, J. Tate, and J. Teitelbaum, On <span class="math">\(p\)</span>-adic
analogues of the conjectures of Birch and Swinnerton-Dyer,
Inventiones mathematicae 84, (1986), 1-48.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bp" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[BP]</a></td><td>Dominique Bernardi and Bernadette Perrin-Riou,
Variante <span class="math">\(p\)</span>-adique de la conjecture de Birch et
Swinnerton-Dyer (le cas supersingulier),
C. R. Acad. Sci. Paris, Sér I. Math., 317 (1993), no. 3,
227-232.</td></tr>
</tbody>
</table>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> - a prime &gt; 3</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> (optional) - the precision used in the computation of the
<span class="math">\(p\)</span>-adic L-Series</li>
<li><code class="docutils literal"><span class="pre">use_twists</span></code> (default = <code class="docutils literal"><span class="pre">True</span></code>) - If <code class="docutils literal"><span class="pre">True</span></code> the algorithm may
change to a quadratic twist with minimal conductor to do the modular
symbol computations rather than using the modular symbols of the
curve itself. If <code class="docutils literal"><span class="pre">False</span></code> it forces the computation using the
modular symbols of the curve itself.</li>
</ul>
<p>OUTPUT:  <span class="math">\(p\)</span>-adic number - that conjecturally equals <span class="math">\(\# Sha(E/\QQ)\)</span>.</p>
<p>If <code class="docutils literal"><span class="pre">prec</span></code> is set to zero (default) then the precision is set so that
at least the first <span class="math">\(p\)</span>-adic digit of conjectural <span class="math">\(\# Sha(E/\QQ)\)</span> is
determined.</p>
<p>EXAMPLES:</p>
<p>Good ordinary examples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;43a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1"># rank 2, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^3)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>   <span class="c1"># rank 0, non trivial sha, long time (10s on sage.math, 2011)</span>
<span class="go">7^2 + O(7^24)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c1"># 9 elements in sha, long time (2s on sage.math, 2011)</span>
<span class="go">3^2 + O(3^24)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;300b2&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2 + 7 + O(7^8)</span>
</pre></div>
</div>
<p>Exceptional cases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(11^22)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;130a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 1</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
<p>Non-split, but rank 0 case (<a class="reference external" href="https://trac.sagemath.org/7331">trac ticket #7331</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;270b1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 0, long time (2s on sage.math, 2011)</span>
<span class="go">1 + O(5^22)</span>
</pre></div>
</div>
<p>The output has the correct sign:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;123a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">41</span><span class="p">)</span> <span class="c1"># rank 1, long time (3s on sage.math, 2011)</span>
<span class="go">1 + O(41)</span>
</pre></div>
</div>
<p>Supersingular cases:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;34a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 0</span>
<span class="go">1 + O(5^22)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;53a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="c1"># rank 1, long time (11s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
<p>Cases that use a twist to a lower conductor:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;99a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">1 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;240d3&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># sha has 4 elements here</span>
<span class="go">4 + O(5)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;448c5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">prec</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">use_twists</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>  <span class="c1"># long time (2s on sage.math, 2011)</span>
<span class="go">2 + 7 + O(7^6)</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">19</span><span class="p">,</span><span class="mi">34</span><span class="p">])</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># see trac #6455, long time (4s on sage.math, 2011)</span>
<span class="go">1 + O(5)</span>
</pre></div>
</div>
<p>Test for <a class="reference external" href="https://trac.sagemath.org/15737">trac ticket #15737</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">s</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">s</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">1 + O(13^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.bound">
<code class="descname">bound</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a provably correct bound on the order of the Tate-Shafarevich
group of this curve. The bound is either <code class="docutils literal"><span class="pre">False</span></code> (no bound) or a
list <code class="docutils literal"><span class="pre">B</span></code> of primes such that any prime divisor of the order of <span class="math">\(Sha\)</span>
is in this list.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound</span><span class="p">()</span>
<span class="go">([2], 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato">
<code class="descname">bound_kato</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of primes <span class="math">\(p\)</span> such that the theorems of Kato’s <a class="reference internal" href="#ka" id="id3">[Ka]</a>
and others (e.g., as explained in a thesis of Grigor Grigorov <a class="reference internal" href="#gri" id="id4">[Gri]</a>)
imply that if <span class="math">\(p\)</span> divides  the order of <span class="math">\(Sha(E/\QQ)\)</span> then <span class="math">\(p\)</span> is in
the list.</p>
<p>If <span class="math">\(L(E,1) = 0\)</span>, then this function gives no information, so
it returns <code class="docutils literal"><span class="pre">False</span></code>.</p>
<p>THEOREM: Suppose <span class="math">\(L(E,1) \neq 0\)</span> and <span class="math">\(p \neq 2\)</span> is a prime such
that</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(E\)</span> does not have additive reduction at <span class="math">\(p\)</span>,</li>
<li>either the <span class="math">\(p\)</span>-adic representation is surjective or has its
image contained in a Borel subgroup.</li>
</ul>
</div></blockquote>
<p>Then <span class="math">\({ord}_p(\#Sha(E))\)</span> is bounded from above by the <span class="math">\(p\)</span>-adic valuation of  <span class="math">\(L(E,1)\cdot\#E(\QQ)_{tor}^2 / (\Omega_E \cdot \prod c_v)\)</span>.</p>
<p>If the L-series vanishes, the method <code class="docutils literal"><span class="pre">p_primary_bound</span></code> can be used instead.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span>   <span class="c1"># 11A  = X_0(11)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># X_1(11)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">352</span><span class="p">,</span><span class="o">-</span><span class="mi">2689</span><span class="p">])</span>     <span class="c1"># 66B3</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">[2]</span>
</pre></div>
</div>
<p>For the following curve one really has that 25 divides the
order of <span class="math">\(Sha\)</span> (by <a class="reference internal" href="#gjpst" id="id5">[GJPST]</a>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">332311</span><span class="p">,</span> <span class="o">-</span><span class="mi">73733731</span><span class="p">])</span>   <span class="c1"># 1058D1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                 <span class="c1"># long time (about 1 second)</span>
<span class="go">[2, 5, 23]</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">galois_representation</span><span class="p">()</span><span class="o">.</span><span class="n">non_surjective</span><span class="p">()</span>                <span class="c1"># long time (about 1 second)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>For this one, <span class="math">\(Sha\)</span> is divisible by 7:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">4062871</span><span class="p">,</span> <span class="o">-</span><span class="mi">3152083138</span><span class="p">])</span>   <span class="c1"># 3364C1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>                 <span class="c1"># long time (&lt; 10 seconds)</span>
<span class="go">[2, 7, 29]</span>
</pre></div>
</div>
<p>No information about curves of rank &gt; 0:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>       <span class="c1"># 37A  (rank 1)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kato</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="ka" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[Ka]</a></td><td>Kayuza Kato, <span class="math">\(p\)</span>-adic Hodge theory and values of zeta
functions of modular forms, Cohomologies <span class="math">\(p\)</span>-adiques et
applications arithmétiques III, Astérisque vol 295, SMF,
Paris, 2004.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gri" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[Gri]</a></td><td>G. Grigorov, Kato’s Euler System and the Main Conjecture,
Harvard Ph.D. Thesis (2005).</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gjpst" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[GJPST]</a></td><td>G. Grigorov, A. Jorza, S. Patrikis, W. A. Stein,
and C. Tarniţǎ, Computational verification of the Birch and
Swinnerton-Dyer conjecture for individual elliptic curves,
Math. Comp. 78 (2009), 2397-2425.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.bound_kolyvagin">
<code class="descname">bound_kolyvagin</code><span class="sig-paren">(</span><em>D=0</em>, <em>regulator=None</em>, <em>ignore_nonsurj_hypothesis=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.bound_kolyvagin" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a fundamental discriminant <span class="math">\(D \neq -3,-4\)</span> that satisfies the
Heegner hypothesis for <span class="math">\(E\)</span>, return a list of primes so that
Kolyvagin’s theorem (as in Gross’s paper) implies that any
prime divisor of <span class="math">\(Sha\)</span> is in this list.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">D</span></code> - (optional) a fundamental discriminant &lt; -4 that satisfies
the Heegner hypothesis for <span class="math">\(E\)</span>; if not given, use the first such <span class="math">\(D\)</span></li>
<li><code class="docutils literal"><span class="pre">regulator</span></code> – (optional) regulator of <span class="math">\(E(K)\)</span>; if not given, will
be computed (which could take a long time)</li>
<li><code class="docutils literal"><span class="pre">ignore_nonsurj_hypothesis</span></code> (optional: default <code class="docutils literal"><span class="pre">False</span></code>) –
If <code class="docutils literal"><span class="pre">True</span></code>, then gives the bound coming from Heegner point
index, but without any hypothesis on surjectivity
of the mod-<span class="math">\(p\)</span> representation.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>list – a list of primes such that if <span class="math">\(p\)</span> divides <span class="math">\(Sha(E/K)\)</span>, then
<span class="math">\(p\)</span> is in this list, unless <span class="math">\(E/K\)</span> has complex multiplication or
analytic rank greater than 2 (in which case we return 0).</li>
<li>index – the odd part of the index of the Heegner point in the full
group of <span class="math">\(K\)</span>-rational points on E.  (If <span class="math">\(E\)</span> has CM, returns 0.)</li>
</ul>
<p>REMARKS:</p>
<ol class="arabic simple">
<li>We do not have to assume that the Manin constant is 1
(or a power of 2).  If the Manin constant were
divisible by a prime, that prime would get included in
the list of bad primes.</li>
<li>We assume the Gross-Zagier theorem is true under the
hypothesis that <span class="math">\(gcd(N,D) = 1\)</span>, instead of the stronger
hypothesis <span class="math">\(gcd(2\cdot N,D)=1\)</span> that is in the original
Gross-Zagier paper.  That Gross-Zagier is true when
<span class="math">\(gcd(N,D)=1\)</span> is “well-known” to the experts, but does not
seem to written up well in the literature.</li>
<li>Correctness of the computation is guaranteed using
interval arithmetic, under the assumption that the
regulator, square root, and period lattice are
computed to precision at least <span class="math">\(10^{-10}\)</span>, i.e., they are
correct up to addition or a real number with absolute
value less than <span class="math">\(10^{-10}\)</span>.</li>
</ol>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;37a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2], 1)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;141a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 7], 49)</span>
</pre></div>
</div>
<p>We get no information when the curve has rank 2.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">(0, 0)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;681b&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">9</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">bound_kolyvagin</span><span class="p">()</span>
<span class="go">([2, 3], 9)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_bound">
<code class="descname">p_primary_bound</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a provable upper bound for the order of the
<span class="math">\(p\)</span>-primary part <span class="math">\(Sha(E)(p)\)</span> of the Tate-Shafarevich group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – a prime &gt; 2</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">e</span></code> – a non-negative integer such that <span class="math">\(p^e\)</span> is an upper
bound for the order of <span class="math">\(Sha(E)(p)\)</span></li>
</ul>
<p>In particular, if this algorithm does not fail, then it proves
that the <span class="math">\(p\)</span>-primary part of <span class="math">\(Sha\)</span> is finite. This works also
for curves of rank &gt; 1.</p>
<p>Note also that this bound is sharp if one assumes the main conjecture
of Iwasawa theory of elliptic curves. One may use the method
<code class="docutils literal"><span class="pre">p_primary_order</span></code> for checking if the extra conditions hold under
which the main conjecture is known by the work of Skinner and Urban.
This then returns the provable <span class="math">\(p\)</span>-primary part of the Tate-Shafarevich
group,</p>
<p>Currently the algorithm is only implemented when the following
conditions are verified:</p>
<ul class="simple">
<li>The <span class="math">\(p\)</span>-adic Galois representation must be surjective or
must have its image contained in a Borel subgroup.</li>
<li>The reduction at <span class="math">\(p\)</span> is not allowed to be additive.</li>
<li>If the reduction at <span class="math">\(p\)</span> is non-split multiplicative, then
the rank must be 0.</li>
<li>If <span class="math">\(p = 3\)</span>, then the reduction at 3 must be good ordinary or
split multiplicative, and the rank must be 0.</li>
</ul>
<p>ALGORITHM:</p>
<p>The algorithm is described in <a class="reference internal" href="#sw" id="id6">[SW]</a>. The results for the
reducible case can be found in <a class="reference internal" href="#wu" id="id7">[Wu]</a>. The main ingredient is
Kato’s result on the main conjecture in Iwasawa theory.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;11a3&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;389a1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;858k2&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># long time (10s on sage.math, 2011)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>Some checks for <a class="reference external" href="https://trac.sagemath.org/6406">trac ticket #6406</a> and <a class="reference external" href="https://trac.sagemath.org/16959">trac ticket #16959</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># long time</span>
<span class="go">2</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;608b1&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The p-adic Galois representation is not surjective or reducible. Current knowledge about Euler systems does not provide an upper bound in this case. Try an_padic for a conjectural bound.</span>

<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">an_padic</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>           <span class="c1"># long time</span>
<span class="go">1 + O(5^22)</span>

<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;5040bi1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_bound</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="go">0</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="sw" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[SW]</a></td><td>William Stein and Christian Wuthrich, Algorithms
for the Arithmetic of Elliptic Curves using Iwasawa Theory
Mathematics of Computation 82 (2013), 1757-1792.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wu" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[Wu]</a></td><td>Christian Wuthrich, On the integrality of modular
symbols and Kato’s Euler system for elliptic curves.
Doc. Math. 19 (2014), 381-402.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_order">
<code class="descname">p_primary_order</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.p_primary_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the order of the <span class="math">\(p\)</span>-primary part of the Tate-Shafarevich
group.</p>
<p>This uses the result of Skinner and Urban <a class="reference internal" href="#su" id="id8">[SU]</a> on the
main conjecture in Iwasawa theory. In particular the elliptic
curve must have good ordinary reduction at <span class="math">\(p\)</span>, the residual
Galois representation must be surjective. Furthermore there must
be an auxiliary prime <span class="math">\(\ell\)</span> dividing the conductor of the curve
exactly once such that the residual representation is ramified
at <span class="math">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><span class="math">\(p\)</span> – an odd prime</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><span class="math">\(e\)</span> – a non-negative integer such that <span class="math">\(p^e\)</span> is the
order of the <span class="math">\(p\)</span>-primary order if the conditions are satisfied
and raises a <code class="docutils literal"><span class="pre">ValueError</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;389a1&quot;</span><span class="p">)</span>  <span class="c1"># rank 2</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s2">&quot;11a1&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">E</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span><span class="o">.</span><span class="n">p_primary_order</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The order is not provably known using Skinner-Urban.</span>
<span class="go">Try running p_primary_bound to get a bound.</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="su" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[SU]</a></td><td>Christopher Skinner and Eric Urban,
The Iwasawa main conjectures for GL2.
Invent. Math. 195 (2014), no. 1, 1-277.</td></tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.elliptic_curves.sha_tate.Sha.two_selmer_bound">
<code class="descname">two_selmer_bound</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.elliptic_curves.sha_tate.Sha.two_selmer_bound" title="Permalink to this definition">¶</a></dt>
<dd><p>This returns the 2-rank, i.e. the <span class="math">\(\GF{2}\)</span>-dimension
of the 2-torsion part of <span class="math">\(Sha\)</span>, provided we can determine the
rank of <span class="math">\(E\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;571a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>

<span class="gp">sage: </span><span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;66a1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">1</span>

<span class="gp">sage: </span><span class="n">sh</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="s1">&#39;960d1&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sha</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">two_selmer_bound</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">sh</span><span class="o">.</span><span class="n">an</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="isogeny_class.html"
                                  title="previous chapter">Isogeny class of elliptic curves over number fields</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="cm.html"
                                  title="next chapter">Complex multiplication for elliptic curves</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/elliptic_curves/sha_tate.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="cm.html" title="Complex multiplication for elliptic curves"
             >next</a> |</li>
        <li class="right" >
          <a href="isogeny_class.html" title="Isogeny class of elliptic curves over number fields"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>