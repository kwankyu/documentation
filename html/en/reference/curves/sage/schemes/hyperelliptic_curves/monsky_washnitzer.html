
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Computation of Frobenius matrix on Monsky-Washnitzer cohomology &#8212; Sage Reference Manual v8.2: Plane curves</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '8.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over GF(p)," href="hypellfrob.html" />
    <link rel="prev" title="Mestre’s algorithm" href="mestre.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypellfrob.html" title="Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over GF(p),"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mestre.html" title="Mestre’s algorithm"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="computation-of-frobenius-matrix-on-monsky-washnitzer-cohomology">
<span id="sage-schemes-hyperelliptic-curves-monsky-washnitzer"></span><h1>Computation of Frobenius matrix on Monsky-Washnitzer cohomology<a class="headerlink" href="#computation-of-frobenius-matrix-on-monsky-washnitzer-cohomology" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.schemes.hyperelliptic_curves.monsky_washnitzer"></span><p>The most interesting functions to be exported here are
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius"><code class="xref py py-func docutils literal"><span class="pre">matrix_of_frobenius()</span></code></a> and <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec"><code class="xref py py-func docutils literal"><span class="pre">adjusted_prec()</span></code></a>.</p>
<p>Currently this code is limited to the case <span class="math">\(p \geq 5\)</span> (no
<span class="math">\(GF(p^n)\)</span> for <span class="math">\(n &gt; 1\)</span>), and only handles the
elliptic curve case (not more general hyperelliptic curves).</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="ked2001" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Ked2001]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Kedlaya, K., “Counting points on hyperelliptic curves using
Monsky-Washnitzer cohomology”, J. Ramanujan Math. Soc. 16 (2001) no
4, 323-338</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="edix" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[Edix]</td><td>Edixhoven, B., “Point counting after Kedlaya”, EIDMA-Stieltjes
graduate course, Lieden (lecture notes?).</td></tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Harvey and Robert Bradshaw: initial code developed at the 2006
MSRI graduate workshop, working with Jennifer Balakrishnan and Liang
Xiao</li>
<li>David Harvey (2006-08): cleaned up, rewrote some chunks, lots more
documentation, added Newton iteration method, added more complete
‘trace trick’, integrated better into Sage.</li>
<li>David Harvey (2007-02): added algorithm with sqrt(p) complexity
(removed in May 2007 due to better C++ implementation)</li>
<li>Robert Bradshaw (2007-03): keep track of exact form in reduction
algorithms</li>
<li>Robert Bradshaw (2007-04): generalization to hyperelliptic curves</li>
<li>Julian Rueth (2014-05-09): improved caching</li>
</ul>
<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">MonskyWashnitzerDifferential</code><span class="sig-paren">(</span><em>parent</em>, <em>val=0</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.ModuleElement" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.ModuleElement</span></code></a></p>
<p>Create an element of the Monsky-Washnitzer ring of differentials, of
the form <span class="math">\(F dx/2y\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">parent</span></code> – Monsky-Washnitzer differential ring (instance of class
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing"><code class="xref py py-class docutils literal"><span class="pre">MonskyWashnitzerDifferentialRing</span></code></a></li>
<li><code class="docutils literal"><span class="pre">val</span></code> – element of the base ring, or list of coefficients</li>
<li><code class="docutils literal"><span class="pre">offset</span></code> – if non-zero, shift val by <span class="math">\(y^\text{offset}\)</span> (default 0)</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">hyperelliptic_curves</span><span class="o">.</span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">MonskyWashnitzerDifferential</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="go">x dx/2y</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">hyperelliptic_curves</span><span class="o">.</span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">MonskyWashnitzerDifferential</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">y*1 dx/2y</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">schemes</span><span class="o">.</span><span class="n">hyperelliptic_curves</span><span class="o">.</span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">MonskyWashnitzerDifferential</span><span class="p">(</span><span class="n">MW</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">y^10*x dx/2y</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeff">
<code class="descname">coeff</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math">\(A\)</span>, where this element is <span class="math">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span>
<span class="go">1 dx/2y</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coeff</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeff</span><span class="p">()</span>
<span class="go">y*x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeffs">
<code class="descname">coeffs</code><span class="sig-paren">(</span><em>R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to obtain the raw coefficients of a differential, see
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs"><code class="xref py py-meth docutils literal"><span class="pre">SpecialHyperellipticQuotientElement.coeffs()</span></code></a></p>
<p>INPUT:</p>
<ul class="simple">
<li>R – An (optional) base ring in which to cast the coefficients</li>
</ul>
<p>OUTPUT:</p>
<p>The raw coefficients of <span class="math">\(A\)</span> where self is <span class="math">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(1, 0, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (1, 0, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(1, 0, 0, 0, 0), (0, 0, 0, 0, 0), (0, 0, 0, 0, 0)], -2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral">
<code class="descname">coleman_integral</code><span class="sig-paren">(</span><em>P</em>, <em>Q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the definite integral of self from <span class="math">\(P\)</span> to <span class="math">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>P, Q – Two points on the underlying curve</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\(\int_P^Q \text{self}\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">pAdicField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="mi">31</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2501</span><span class="o">/</span><span class="mi">108</span><span class="p">])</span> <span class="c1">#11a</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">O(5^6)</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">58332</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y">
<code class="descname">extract_pow_y</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.extract_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the power of <span class="math">\(y\)</span> in <span class="math">\(A\)</span> where self is <span class="math">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 0, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">())</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[1, 0, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.integrate">
<code class="descname">integrate</code><span class="sig-paren">(</span><em>P</em>, <em>Q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.integrate" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the definite integral of self from <span class="math">\(P\)</span> to <span class="math">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>P, Q – Two points on the underlying curve</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\(\int_P^Q \text{self}\)</span></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">pAdicField</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">EllipticCurve</span><span class="p">(</span><span class="n">K</span><span class="p">,[</span><span class="o">-</span><span class="mi">31</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2501</span><span class="o">/</span><span class="mi">108</span><span class="p">])</span> <span class="c1">#11a</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">14</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="n">K</span><span class="p">(</span><span class="mi">11</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">)</span>
<span class="go">O(5^6)</span>

<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">E</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">58332</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">P</span><span class="p">,</span><span class="n">Q</span><span class="p">)</span>
<span class="go">2*5 + 4*5^2 + 3*5^3 + 4*5^4 + 3*5^5 + O(5^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">)</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">coleman_integral</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">Q</span><span class="p">))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.max_pow_y">
<code class="descname">max_pow_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.max_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the maximum power of <span class="math">\(y\)</span> in <span class="math">\(A\)</span> where self is <span class="math">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.min_pow_y">
<code class="descname">min_pow_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.min_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimum power of <span class="math">\(y\)</span> in <span class="math">\(A\)</span> where self is <span class="math">\(A dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">y</span><span class="o">^</span><span class="mi">5</span><span class="p">)</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce">
<code class="descname">reduce</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to find <span class="math">\(a\)</span> and <span class="math">\(f\)</span> such that this element is
equal to <span class="math">\(a + df\)</span>, where <span class="math">\(a\)</span> is given in terms of the <span class="math">\(x^i dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">(y*x, 0 dx/2y)</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="go">(1/5*y*1, 4/5*1 dx/2y)</span>

<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">QQ</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.</span><span class="o">.</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mf">3.</span><span class="o">.</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">reduce</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span> <span class="o">+</span> <span class="n">a</span> <span class="o">-</span> <span class="n">w</span>
<span class="go">0 dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_fast">
<code class="descname">reduce_fast</code><span class="sig-paren">(</span><em>even_degree_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to find <span class="math">\(a\)</span> and <span class="math">\(f\)</span> such that this element is
equal to <span class="math">\(a + df\)</span>, where <span class="math">\(a\)</span> is given in terms of the <span class="math">\(x^i dx/2y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(x, (0, 0))</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(y*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">((y^-1)*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">11</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">((y^-11)*1, (0, 0))</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_fast</span><span class="p">()</span>
<span class="go">(y^2*x, (0, 0))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y">
<code class="descname">reduce_neg_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_fast">
<code class="descname">reduce_neg_y_fast</code><span class="sig-paren">(</span><em>even_degree_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
<p>It leaves non-negative powers of <span class="math">\(y\)</span> alone:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">(-3*1 + 5*x^4) dx/2y</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_fast</span><span class="p">()</span>
<span class="go">(0, (-3*1 + 5*x^4) dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_faster">
<code class="descname">reduce_neg_y_faster</code><span class="sig-paren">(</span><em>even_degree_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_neg_y_faster" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to eliminate negative powers of <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y</span><span class="p">()</span>
<span class="go">((y^-1)*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^-</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">^-</span><span class="mi">1</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_neg_y_faster</span><span class="p">()</span>
<span class="go">((y^-1)*x + (y^-5)*x^2, 0 dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y">
<code class="descname">reduce_pos_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to eliminate positive powers of <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^2*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^2*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">92</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y</span><span class="p">()</span>
<span class="go">(y^92*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+=</span> <span class="n">w</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^3*1 + x, x dx/2y)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y_fast">
<code class="descname">reduce_pos_y_fast</code><span class="sig-paren">(</span><em>even_degree_only=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.reduce_pos_y_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>Use homology relations to eliminate positive powers of <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^2*1, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^2*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">92</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^92*x, 0 dx/2y)</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">+=</span> <span class="n">w</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">reduce_pos_y_fast</span><span class="p">()</span>
<span class="go">(y^3*1 + x, x dx/2y)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">MonskyWashnitzerDifferentialRing</code><span class="sig-paren">(</span><em>base_ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a>, <a class="reference external" href="../../../../modules/sage/modules/module.html#sage.modules.module.Module" title="(in Sage Reference Manual: Modules v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.modules.module.Module</span></code></a></p>
<p>A ring of Monsky–Washnitzer differentials over <code class="docutils literal"><span class="pre">base_ring</span></code>.</p>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Q">
<code class="descname">Q</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math">\(Q(x)\)</span> where the model of the underlying hyperelliptic curve
of self is given by <span class="math">\(y^2 = Q(x)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 4*x + 4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new differential ring which is self base-extended to <span class="math">\(R\)</span></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> – ring</li>
</ul>
<p>OUTPUT:</p>
<p>Self, base-extended to <span class="math">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 4*x + 4) over Rational Field</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = (1 + O(5^5))*x^5 + (1 + 4*5 + 4*5^2 + 4*5^3 + 4*5^4 + O(5^5))*x + (4 + O(5^5))) over 5-adic Field with capped relative precision 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a new differential ring which is self with the coefficient
ring changed to <span class="math">\(R\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> – ring of coefficients</li>
</ul>
<p>OUTPUT:</p>
<p>Self, with the coefficient ring changed to <span class="math">\(R\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 4*x + 4) over Rational Field</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = (1 + O(5^5))*x^5 + (1 + 4*5 + 4*5^2 + 4*5^3 + 4*5^4 + O(5^5))*x + (4 + O(5^5))) over 5-adic Field with capped relative precision 5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the degree of <span class="math">\(Q(x)\)</span>, where the model of the underlying
hyperelliptic curve of self is given by <span class="math">\(y^2 = Q(x)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 4*x + 4</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.dimension">
<code class="descname">dimension</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.dimension" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the dimension of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">CK</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">CK</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_Q">
<code class="descname">frob_Q</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns and caches <span class="math">\(Q(x^p)\)</span>, which is used in computing the image of
<span class="math">\(y\)</span> under a <span class="math">\(p\)</span>-power lift of Frobenius to <span class="math">\(A^{\dagger}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">-(60-48*y^2+12*y^4-y^6)*1 + (192-96*y^2+12*y^4)*x - (192-48*y^2)*x^2 + 60*x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">Q</span><span class="p">()(</span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-(60-48*y^2+12*y^4-y^6)*1 + (192-96*y^2+12*y^4)*x - (192-48*y^2)*x^2 + 60*x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span> <span class="ow">is</span> <span class="n">MW</span><span class="o">.</span><span class="n">frob_Q</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_basis_elements">
<code class="descname">frob_basis_elements</code><span class="sig-paren">(</span><em>prec</em>, <em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_basis_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the action of a <span class="math">\(p\)</span>-power lift of Frobenius on the basis</p>
<div class="math">
\[\{ dx/2y, x dx/2y, ..., x^{d-2} dx/2y \}\]</div>
<p>where <span class="math">\(d\)</span> is the degree of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_basis_elements</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="go">[((92000*y^-14-74200*y^-12+32000*y^-10-8000*y^-8+1000*y^-6-50*y^-4)*1 - (194400*y^-14-153600*y^-12+57600*y^-10-9600*y^-8+600*y^-6)*x + (204800*y^-14-153600*y^-12+38400*y^-10-3200*y^-8)*x^2 - (153600*y^-14-76800*y^-12+9600*y^-10)*x^3 + (63950*y^-14-18550*y^-12+1600*y^-10-400*y^-8+50*y^-6+5*y^-4)*x^4) dx/2y, (-(1391200*y^-14-941400*y^-12+302000*y^-10-76800*y^-8+14400*y^-6-1320*y^-4+30*y^-2)*1 + (2168800*y^-14-1402400*y^-12+537600*y^-10-134400*y^-8+16800*y^-6-720*y^-4)*x - (1596800*y^-14-1433600*y^-12+537600*y^-10-89600*y^-8+5600*y^-6)*x^2 + (1433600*y^-14-1075200*y^-12+268800*y^-10-22400*y^-8)*x^3 - (870200*y^-14-445350*y^-12+63350*y^-10-3200*y^-8+600*y^-6-30*y^-4-5*y^-2)*x^4) dx/2y, ((19488000*y^-14-15763200*y^-12+4944400*y^-10-913800*y^-8+156800*y^-6-22560*y^-4+1480*y^-2-10)*1 - (28163200*y^-14-18669600*y^-12+5774400*y^-10-1433600*y^-8+268800*y^-6-25440*y^-4+760*y^-2)*x + (15062400*y^-14-12940800*y^-12+5734400*y^-10-1433600*y^-8+179200*y^-6-8480*y^-4)*x^2 - (12121600*y^-14-11468800*y^-12+4300800*y^-10-716800*y^-8+44800*y^-6)*x^3 + (9215200*y^-14-6952400*y^-12+1773950*y^-10-165750*y^-8+5600*y^-6-720*y^-4+10*y^-2+5)*x^4) dx/2y, (-(225395200*y^-14-230640000*y^-12+91733600*y^-10-18347400*y^-8+2293600*y^-6-280960*y^-4+31520*y^-2-1480-10*y^2)*1 + (338048000*y^-14-277132800*y^-12+89928000*y^-10-17816000*y^-8+3225600*y^-6-472320*y^-4+34560*y^-2-720)*x - (172902400*y^-14-141504000*y^-12+58976000*y^-10-17203200*y^-8+3225600*y^-6-314880*y^-4+11520*y^-2)*x^2 + (108736000*y^-14-109760000*y^-12+51609600*y^-10-12902400*y^-8+1612800*y^-6-78720*y^-4)*x^3 - (85347200*y^-14-82900000*y^-12+31251400*y^-10-5304150*y^-8+367350*y^-6-8480*y^-4+760*y^-2+10-5*y^2)*x^4) dx/2y]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_invariant_differential">
<code class="descname">frob_invariant_differential</code><span class="sig-paren">(</span><em>prec</em>, <em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.frob_invariant_differential" title="Permalink to this definition">¶</a></dt>
<dd><p>Kedlaya’s algorithm allows us to calculate the action of Frobenius on
the Monsky-Washnitzer cohomology. First we lift <span class="math">\(\phi\)</span> to <span class="math">\(A^{\dagger}\)</span>
by setting</p>
<div class="math">
\[ \begin{align}\begin{aligned}\phi(x) = x^p\\\phi(y) = y^p \sqrt{1  + \frac{Q(x^p) - Q(x)^p}{Q(x)^p}}.\end{aligned}\end{align} \]</div>
<p>Pulling back the differential <span class="math">\(dx/2y\)</span>, we get</p>
<div class="math">
\[\phi^*(dx/2y) = px^{p-1} y(\phi(y))^{-1} dx/2y
              = px^{p-1} y^{1-p} \sqrt{1+ \frac{Q(x^p) - Q(x)^p}{Q(x)^p}} dx/2y\]</div>
<p>Use Newton’s method to calculate the square root.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">frob_invariant_differential</span><span class="p">(</span><span class="n">prec</span><span class="p">,</span><span class="n">p</span><span class="p">)</span>
<span class="go">((67894400*y^-20-81198880*y^-18+40140800*y^-16-10035200*y^-14+1254400*y^-12-62720*y^-10)*1 - (119503944*y^-20-116064242*y^-18+43753472*y^-16-7426048*y^-14+514304*y^-12-12544*y^-10+1568*y^-8-70*y^-6-7*y^-4)*x + (78905288*y^-20-61014016*y^-18+16859136*y^-16-2207744*y^-14+250880*y^-12-37632*y^-10+3136*y^-8-70*y^-6)*x^2 - (39452448*y^-20-26148752*y^-18+8085490*y^-16-2007040*y^-14+376320*y^-12-37632*y^-10+1568*y^-8)*x^3 + (21102144*y^-20-18120592*y^-18+8028160*y^-16-2007040*y^-14+250880*y^-12-12544*y^-10)*x^4) dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.helper_matrix">
<code class="descname">helper_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.helper_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>We use this to solve for the linear combination of
<span class="math">\(x^i y^j\)</span> needed to clear all terms with
<span class="math">\(y^{j-1}\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">helper_matrix</span><span class="p">()</span>
<span class="go">[ 256/2101  320/2101  400/2101  500/2101  625/2101]</span>
<span class="go">[-625/8404  -64/2101  -80/2101 -100/2101 -125/2101]</span>
<span class="go">[-125/2101 -625/8404  -64/2101  -80/2101 -100/2101]</span>
<span class="go">[-100/2101 -125/2101 -625/8404  -64/2101  -80/2101]</span>
<span class="go">[ -80/2101 -100/2101 -125/2101 -625/8404  -64/2101]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.invariant_differential">
<code class="descname">invariant_differential</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.invariant_differential" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math">\(dx/2y\)</span> as an element of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span>
<span class="go">1 dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.x_to_p">
<code class="descname">x_to_p</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing.x_to_p" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns and caches <span class="math">\(x^p\)</span>, reduced via the relations coming from the
defining polynomial of the hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">invariant_differential</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">x^3</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-(4-y^2)*1 + 4*x</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span> <span class="ow">is</span> <span class="n">MW</span><span class="o">.</span><span class="n">x_to_p</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing_class">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">MonskyWashnitzerDifferentialRing_class</code><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferentialRing"><code class="xref py py-class docutils literal"><span class="pre">MonskyWashnitzerDifferentialRing</span></code></a></p>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">SpecialCubicQuotientRing</code><span class="sig-paren">(</span><em>Q</em>, <em>laurent_series=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.CommutativeAlgebra" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.ring.CommutativeAlgebra</span></code></a></p>
<p>Specialised class for representing the quotient ring
<span class="math">\(R[x,T]/(T - x^3 - ax - b)\)</span>, where <span class="math">\(R\)</span> is an
arbitrary commutative base ring (in which 2 and 3 are invertible),
<span class="math">\(a\)</span> and <span class="math">\(b\)</span> are elements of that ring.</p>
<p>Polynomials are represented internally in the form
<span class="math">\(p_0 + p_1 x + p_2 x^2\)</span> where the <span class="math">\(p_i\)</span> are
polynomials in <span class="math">\(T\)</span>. Multiplication of polynomials always
reduces high powers of <span class="math">\(x\)</span> (i.e. beyond <span class="math">\(x^2\)</span>) to
powers of <span class="math">\(T\)</span>.</p>
<p>Hopefully this ring is faster than a general quotient ring because
it uses the special structure of this ring to speed multiplication
(which is the dominant operation in the frobenius matrix
calculation). I haven’t actually tested this theory though…</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Eventually we will want to run this in characteristic 3, so we
need to: (a) Allow <span class="math">\(Q(x)\)</span> to contain an <span class="math">\(x^2\)</span> term, and (b) Remove
the requirement that 3 be invertible. Currently this is used in
the Toom-Cook algorithm to speed multiplication.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span>
<span class="go">SpecialCubicQuotientRing over Ring of integers modulo 125 with polynomial T = x^3 + 124*x + 94</span>
</pre></div>
</div>
<p>Get generators:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">(0) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(T) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
<p>Coercions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">(7) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
<p>Create elements directly from polynomials:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">Univariate Polynomial Ring in T over Ring of integers modulo 125</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(T^2) + (T + 1)*x + (3)*x^2</span>
</pre></div>
</div>
<p>Some arithmetic:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">3</span>
<span class="go">(T + 31) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="mi">3</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">15</span> <span class="o">*</span> <span class="n">T</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">-</span> <span class="n">T</span>
<span class="go">(3*T^7 + 90*T^6 + 110*T^5 + 20*T^4 + 58*T^3 + 26*T^2 + 124*T) + (15*T^6 + 110*T^5 + 35*T^4 + 63*T^2 + 1)*x + (30*T^5 + 40*T^4 + 8*T^3 + 38*T^2)*x^2</span>
</pre></div>
</div>
<p>Retrieve coefficients (output is zero-padded):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span><span class="o">^</span><span class="mi">10</span>
<span class="go">(3*T^2 + 61*T + 8) + (T^3 + 93*T^2 + 12*T + 40)*x + (3*T^2 + 61*T + 9)*x^2</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">[[8, 61, 3, 0], [40, 12, 93, 1], [9, 61, 3, 0]]</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">write an example checking multiplication of these polynomials
against Sage’s ordinary quotient ring arithmetic. I can’t seem
to get the quotient ring stuff happening right now…</p>
</div>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.create_element">
<code class="descname">create_element</code><span class="sig-paren">(</span><em>p0</em>, <em>p1</em>, <em>p2</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.create_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates the element <span class="math">\(p_0 + p_1*x + p_2*x^2\)</span>, where the <span class="math">\(p_i\)</span>
are polynomials in <span class="math">\(T\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">p0,</span> <span class="pre">p1,</span> <span class="pre">p2</span></code> – coefficients; must be coercible</dt>
<dd>into poly_ring()</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">check</span></code> – bool (default True): whether to carry</dt>
<dd>out coercion</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span><span class="o">.</span><span class="n">objgen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">z</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="n">z</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">(T^2) + (T + 1)*x + (3)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.gens">
<code class="descname">gens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list [x, T] where x and T are the generators of the ring
(as element <em>of this ring</em>).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I have no idea if this is compatible with the usual Sage
‘gens’ interface.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span>
<span class="go">(0) + (1)*x + (0)*x^2</span>
<span class="gp">sage: </span><span class="n">T</span>
<span class="go">(T) + (0)*x + (0)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.poly_ring">
<code class="descname">poly_ring</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRing.poly_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying polynomial ring in <span class="math">\(T\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">poly_ring</span><span class="p">()</span>
<span class="go">Univariate Polynomial Ring in T over Ring of integers modulo 125</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">SpecialCubicQuotientRingElement</code><span class="sig-paren">(</span><em>parent</em>, <em>p0</em>, <em>p1</em>, <em>p2</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>An element of a SpecialCubicQuotientRing.</p>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.coeffs">
<code class="descname">coeffs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of three lists of coefficients, corresponding to the
<span class="math">\(x^0\)</span>, <span class="math">\(x^1\)</span>, <span class="math">\(x^2\)</span> coefficients. The lists
are zero padded to the same length. The list entries belong to the
base ring.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">p</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">[[0, 1, 0], [123, 0, 1], [3, 0, 0]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.scalar_multiply">
<code class="descname">scalar_multiply</code><span class="sig-paren">(</span><em>scalar</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.scalar_multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplies this element by a scalar, i.e. just multiply each
coefficient of <span class="math">\(x^j\)</span> by the scalar.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">scalar</span></code> – either an element of base_ring, or an</dt>
<dd>element of poly_ring.</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">(2) + (T)*x + (T^2 + 122)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">scalar_multiply</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(4) + (2*T)*x + (2*T^2 + 119)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">scalar_multiply</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">(2*T) + (T^2)*x + (T^3 + 122*T)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns this element multiplied by <span class="math">\(T^n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">t</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span>
<span class="go">(2) + (T)*x + (T^2 + 122)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(2*T) + (T^2)*x + (T^3 + 122*T)*x^2</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">(2*T^2) + (T^3)*x + (T^4 + 122*T^2)*x^2</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.square">
<code class="descname">square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialCubicQuotientRingElement.square" title="Permalink to this definition">¶</a></dt>
<dd><p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="mi">125</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">SpecialCubicQuotientRing</span><span class="p">(</span><span class="n">t</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">B</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">create_element</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">11</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">f</span><span class="o">.</span><span class="n">square</span><span class="p">()</span>
<span class="go">(73*T^5 + 16*T^4 + 38*T^3 + 39*T^2 + 70*T + 120) + (121*T^5 + 113*T^4 + 73*T^3 + 8*T^2 + 51*T + 61)*x + (18*T^4 + 60*T^3 + 22*T^2 + 108*T + 31)*x^2</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">SpecialHyperellipticQuotientElement</code><span class="sig-paren">(</span><em>parent</em>, <em>val=0</em>, <em>offset=0</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/element.html#sage.structure.element.CommutativeAlgebraElement" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.element.CommutativeAlgebraElement</span></code></a></p>
<p>Elements in the Hyperelliptic quotient ring</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">77</span><span class="p">)</span>  <span class="c1"># indirect doctest</span>
<span class="go">-(77-y)*1 + x + x^2</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the same element after changing the base ring to R.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">36</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">MW</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">MW</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">y</span><span class="o">-</span><span class="mi">77</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">AA</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 36*x + 1) over Algebraic Real Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs">
<code class="descname">coeffs</code><span class="sig-paren">(</span><em>R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the raw coefficients of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">R</span></code> – an (optional) base-ring in which to cast the coefficients</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">coeffs</span></code> – a list of coefficients of powers of <span class="math">\(x\)</span> for each power</dt>
<dd>of <span class="math">\(y\)</span></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">n</span></code> – an offset indicating the power of <span class="math">\(y\)</span> of the first list</dt>
<dd>element</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 0, 0, 0)], 0)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (1, 0, 0, 0, 0)], 0)</span>

<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="n">a</span>
<span class="go">x + 2*x^2 + 3*x^3 + 4*x^4</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 2, 3, 4)], 0)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="go">([(0, 1 + O(7^20), 2 + O(7^20), 3 + O(7^20), 4 + O(7^20))], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 0, 0, 0, 0), (0, 1, 2, 3, 4)], 0)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="go">([(0, 1, 2, 3, 4), (0, 0, 0, 0, 0), (0, 0, 0, 0, 0)], -2)</span>
</pre></div>
</div>
<p>Note that the coefficient list is transposed compared to how they
are stored and printed:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">2</span>
<span class="go">(y^-2)*x + (2*y^-2)*x^2 + (3*y^-2)*x^3 + (4*y^-2)*x^4</span>
</pre></div>
</div>
<p>A more complicated example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">20</span><span class="o">*</span><span class="n">y</span><span class="o">^-</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span><span class="o">^</span><span class="mi">11</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span><span class="p">;</span> <span class="n">a</span>
<span class="go">(y^-3-4*y^-1+6*y-4*y^3+y^5)*1 - (12*y^-3-36*y^-1+36*y+y^2-12*y^3-2*y^4+y^6)*x + (54*y^-3-108*y^-1+54*y+6*y^2-6*y^4)*x^2 - (108*y^-3-108*y^-1+9*y^2)*x^3 + (81*y^-3)*x^4</span>
<span class="gp">sage: </span><span class="n">raw</span><span class="p">,</span> <span class="n">offset</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">coeffs</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">offset</span>
<span class="go">-3</span>
<span class="gp">sage: </span><span class="n">raw</span>
<span class="go">[(1, -12, 54, -108, 81),</span>
<span class="go"> (0, 0, 0, 0, 0),</span>
<span class="go"> (-4, 36, -108, 108, 0),</span>
<span class="go"> (0, 0, 0, 0, 0),</span>
<span class="go"> (6, -36, 54, 0, 0),</span>
<span class="go"> (0, -1, 6, -9, 0),</span>
<span class="go"> (-4, 12, 0, 0, 0),</span>
<span class="go"> (0, 2, -6, 0, 0),</span>
<span class="go"> (1, 0, 0, 0, 0),</span>
<span class="go"> (0, -1, 0, 0, 0)]</span>
<span class="gp">sage: </span><span class="nb">sum</span><span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">^</span><span class="n">i</span> <span class="o">*</span> <span class="n">y</span><span class="o">^</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="n">offset</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">L</span><span class="p">))</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Can also be used to construct elements:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">parent</span><span class="p">()(</span><span class="n">raw</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.diff">
<code class="descname">diff</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the differential of <code class="docutils literal"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span>
<span class="go">(-(9-2*y)*1 + 15*x^4) dx/2y</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.extract_pow_y">
<code class="descname">extract_pow_y</code><span class="sig-paren">(</span><em>k</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.extract_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coefficients of <span class="math">\(y^k\)</span> in <code class="docutils literal"><span class="pre">self</span></code> as a list</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">extract_pow_y</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[3, 9, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.max_pow_y">
<code class="descname">max_pow_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.max_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the maximal degree of <code class="docutils literal"><span class="pre">self</span></code> w.r.t. y</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">max_pow_y</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.min_pow_y">
<code class="descname">min_pow_y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.min_pow_y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the minimal degree of <code class="docutils literal"><span class="pre">self</span></code> w.r.t. y</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">min_pow_y</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.truncate_neg">
<code class="descname">truncate_neg</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientElement.truncate_neg" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal"><span class="pre">self</span></code> minus its terms of degree less than <span class="math">\(n\)</span> wrt <span class="math">\(y\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">7</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">truncate_neg</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3*y*1 + 14*y^4*x</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing">
<em class="property">class </em><code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">SpecialHyperellipticQuotientRing</code><span class="sig-paren">(</span><em>Q</em>, <em>R=None</em>, <em>invert_y=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a>, <a class="reference external" href="../../../../rings/sage/rings/ring.html#sage.rings.ring.CommutativeAlgebra" title="(in Sage Reference Manual: General Rings, Ideals, and Morphisms v8.2)"><code class="xref py py-class docutils literal"><span class="pre">sage.rings.ring.CommutativeAlgebra</span></code></a></p>
<p>Initialization.</p>
<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Q">
<code class="descname">Q</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the defining polynomial of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">Q</span><span class="p">()</span>
<span class="go">x^5 - 2*x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.base_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the base extension of <code class="docutils literal"><span class="pre">self</span></code> to the ring <code class="docutils literal"><span class="pre">R</span></code> if possible.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">UniversalCyclotomicField</span><span class="p">())</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 3*x + 1) over Universal Cyclotomic Field</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">no such base extension</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.change_ring">
<code class="descname">change_ring</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.change_ring" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the analog of <code class="docutils literal"><span class="pre">self</span></code> over the ring <code class="docutils literal"><span class="pre">R</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">ZZ</span><span class="p">)</span>
<span class="go">SpecialHyperellipticQuotientRing K[x,y,y^-1] / (y^2 = x^5 - 3*x + 1) over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.curve">
<code class="descname">curve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">curve</span><span class="p">()</span>
<span class="go">Hyperelliptic Curve over Rational Field defined by y^2 = x^5 - 3*x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.degree">
<code class="descname">degree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.degree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of the underlying hyperelliptic curve.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">degree</span><span class="p">()</span>
<span class="go">5</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.gens">
<code class="descname">gens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.gens" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generators of <code class="docutils literal"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(x, y*1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.is_field">
<code class="descname">is_field</code><span class="sig-paren">(</span><em>proof=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.is_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Return False as <code class="docutils literal"><span class="pre">self</span></code> is not a field.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">is_field</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial">
<code class="descname">monomial</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>b=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math">\(b y^j x^i\)</span>, computed quickly.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">y^5*x^4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs">
<code class="descname">monomial_diff_coeffs</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>The key here is that the formula for <span class="math">\(d(x^iy^j)\)</span> is messy
in terms of <span class="math">\(i\)</span>, but varies nicely with <span class="math">\(j\)</span>.</p>
<div class="math">
\[d(x^iy^j) = y^{j-1} (2ix^{i-1}y^2 + j (A_i(x) + B_i(x)y^2)) \frac{dx}{2y}\]</div>
<p>Where <span class="math">\(A,B\)</span> have degree at most <span class="math">\(n-1\)</span> for each
<span class="math">\(i\)</span>. Pre-compute <span class="math">\(A_i, B_i\)</span> for each <span class="math">\(i\)</span>
the “hard” way, and the rest are easy.</p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs_matrices">
<code class="descname">monomial_diff_coeffs_matrices</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monomial_diff_coeffs_matrices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monsky_washnitzer">
<code class="descname">monsky_washnitzer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.monsky_washnitzer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.prime">
<code class="descname">prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.prime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.x">
<code class="descname">x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.x" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generator <span class="math">\(x\)</span> of <code class="docutils literal"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">x</span><span class="p">()</span>
<span class="go">x</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.y">
<code class="descname">y</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing.y" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the generator <span class="math">\(y\)</span> of <code class="docutils literal"><span class="pre">self</span></code></p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">E</span> <span class="o">=</span> <span class="n">HyperellipticCurve</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">E</span><span class="o">.</span><span class="n">monsky_washnitzer_gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">y</span><span class="p">()</span>
<span class="go">y*1</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_class">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">SpecialHyperellipticQuotientRing_class</code><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing_class" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.SpecialHyperellipticQuotientRing"><code class="xref py py-class docutils literal"><span class="pre">SpecialHyperellipticQuotientRing</span></code></a></p>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">adjusted_prec</code><span class="sig-paren">(</span><em>p</em>, <em>prec</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.adjusted_prec" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes how much precision is required in matrix_of_frobenius to
get an answer correct to prec <span class="math">\(p\)</span>-adic digits.</p>
<p>The issue is that the algorithm used in
<a class="reference internal" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius"><code class="xref py py-func docutils literal"><span class="pre">matrix_of_frobenius()</span></code></a> sometimes performs divisions by <span class="math">\(p\)</span>,
so precision is lost during the algorithm.</p>
<p>The estimate returned by this function is based on Kedlaya’s result
(Lemmas 2 and 3 of <a class="reference internal" href="#ked2001" id="id1">[Ked2001]</a>),
which implies that if we start with <span class="math">\(M\)</span> <span class="math">\(p\)</span>-adic
digits, the total precision loss is at most
<span class="math">\(1 + \lfloor \log_p(2M-3) \rfloor\)</span> <span class="math">\(p\)</span>-adic
digits. (This estimate is somewhat less than the amount you would
expect by naively counting the number of divisions by
<span class="math">\(p\)</span>.)</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – a prime = 5</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> – integer, desired output precision, = 1</li>
</ul>
<p>OUTPUT: adjusted precision (usually slightly more than prec)</p>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_newton">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">frobenius_expansion_by_newton</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_newton" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the action of Frobenius on <span class="math">\(dx/y\)</span> and on
<span class="math">\(x dx/y\)</span>, using Newton’s method (as suggested in Kedlaya’s
paper <a class="reference internal" href="#ked2001" id="id2">[Ked2001]</a>).</p>
<p>(This function does <em>not</em> yet use the cohomology relations - that
happens afterwards in the “reduction” step.)</p>
<p>More specifically, it finds <span class="math">\(F_0\)</span> and <span class="math">\(F_1\)</span> in
the quotient ring <span class="math">\(R[x, T]/(T - Q(x))\)</span>, such that</p>
<div class="math">
\[F(  dx/y) = T^{-r} F0 dx/y, \text{\ and\ } F(x dx/y) = T^{-r} F1 dx/y\]</div>
<p>where</p>
<div class="math">
\[r = ( (2M-3)p - 1 )/2.\]</div>
<p>(Here <span class="math">\(T\)</span> is <span class="math">\(y^2 = z^{-2}\)</span>, and <span class="math">\(R\)</span> is the
coefficient ring of <span class="math">\(Q\)</span>.)</p>
<p><span class="math">\(F_0\)</span> and <span class="math">\(F_1\)</span> are computed in the
SpecialCubicQuotientRing associated to <span class="math">\(Q\)</span>, so all powers
of <span class="math">\(x^j\)</span> for <span class="math">\(j \geq 3\)</span> are reduced to powers of
<span class="math">\(T\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial of the form</dt>
<dd><span class="math">\(Q(x) = x^3 + ax + b\)</span>, whose coefficient ring is a
<span class="math">\(Z/(p^M)Z\)</span>-algebra</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">p</span></code> – residue characteristic of the p-adic field</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">M</span></code> – p-adic precision of the coefficient ring</dt>
<dd>(this will be used to determine the number of Newton iterations)</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">F0,</span> <span class="pre">F1</span></code> - elements of
SpecialCubicQuotientRing(Q), as described above</li>
<li><code class="docutils literal"><span class="pre">r</span></code> - non-negative integer, as described above</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">frobenius_expansion_by_newton</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">frobenius_expansion_by_newton</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((25*T^5 + 75*T^3 + 100*T^2 + 100*T + 100) + (5*T^6 + 80*T^5 + 100*T^3</span>
<span class="go">+ 25*T + 50)*x + (55*T^5 + 50*T^4 + 75*T^3 + 25*T^2 + 25*T + 25)*x^2,</span>
<span class="go">(5*T^8 + 15*T^7 + 95*T^6 + 10*T^5 + 25*T^4 + 25*T^3 + 100*T^2 + 50)</span>
<span class="go">+ (65*T^7 + 55*T^6 + 70*T^5 + 100*T^4 + 25*T^2 + 100*T)*x</span>
<span class="go">+ (15*T^6 + 115*T^5 + 75*T^4 + 100*T^3 + 50*T^2 + 75*T + 75)*x^2, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_series">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">frobenius_expansion_by_series</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>M</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.frobenius_expansion_by_series" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the action of Frobenius on <span class="math">\(dx/y\)</span> and on <span class="math">\(x dx/y\)</span>, using a
series expansion.</p>
<p>(This function computes the same thing as
frobenius_expansion_by_newton(), using a different method.
Theoretically the Newton method should be asymptotically faster,
when the precision gets large. However, in practice, this functions
seems to be marginally faster for moderate precision, so I’m
keeping it here until I figure out exactly why it is faster.)</p>
<p>(This function does <em>not</em> yet use the cohomology relations - that
happens afterwards in the “reduction” step.)</p>
<p>More specifically, it finds F0 and F1 in the quotient ring
<span class="math">\(R[x, T]/(T - Q(x))\)</span>, such that
<span class="math">\(F(  dx/y) = T^{-r} F0 dx/y\)</span>, and
<span class="math">\(F(x dx/y) = T^{-r} F1 dx/y\)</span> where
<span class="math">\(r = ( (2M-3)p - 1 )/2\)</span>. (Here <span class="math">\(T\)</span> is <span class="math">\(y^2 = z^{-2}\)</span>,
and <span class="math">\(R\)</span> is the coefficient ring of <span class="math">\(Q\)</span>.)</p>
<p><span class="math">\(F_0\)</span> and <span class="math">\(F_1\)</span> are computed in the
SpecialCubicQuotientRing associated to <span class="math">\(Q\)</span>, so all powers
of <span class="math">\(x^j\)</span> for <span class="math">\(j \geq 3\)</span> are reduced to powers of
<span class="math">\(T\)</span>.</p>
<p>It uses the sum</p>
<div class="math">
\[F0 = \sum_{k=0}^{M-2} \binom{-1/2}{k} p x^{p-1} E^k T^{(M-2-k)p}\]</div>
<p>and</p>
<div class="math">
\[ \begin{align}\begin{aligned}    F1 = x^p F0,\\where `E = Q(x^p) - Q(x)^p`.\end{aligned}\end{align} \]</div>
<p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial of the form</dt>
<dd><span class="math">\(Q(x) = x^3 + ax + b\)</span>, whose coefficient ring is a
<span class="math">\(\ZZ/(p^M)\ZZ\)</span> -algebra</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">p</span></code> – residue characteristic of the <span class="math">\(p\)</span>-adic field</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">M</span></code> – <span class="math">\(p\)</span>-adic precision of the coefficient ring</dt>
<dd>(this will be used to determine the number of terms in the
series)</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">F0,</span> <span class="pre">F1</span></code> - elements of
SpecialCubicQuotientRing(Q), as described above</li>
<li><code class="docutils literal"><span class="pre">r</span></code> - non-negative integer, as described above</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">frobenius_expansion_by_series</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">frobenius_expansion_by_series</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((25*T^5 + 75*T^3 + 100*T^2 + 100*T + 100) + (5*T^6 + 80*T^5 + 100*T^3</span>
<span class="go">+ 25*T + 50)*x + (55*T^5 + 50*T^4 + 75*T^3 + 25*T^2 + 25*T + 25)*x^2,</span>
<span class="go">(5*T^8 + 15*T^7 + 95*T^6 + 10*T^5 + 25*T^4 + 25*T^3 + 100*T^2 + 50)</span>
<span class="go">+ (65*T^7 + 55*T^6 + 70*T^5 + 100*T^4 + 25*T^2 + 100*T)*x</span>
<span class="go">+ (15*T^6 + 115*T^5 + 75*T^4 + 100*T^3 + 50*T^2 + 75*T + 75)*x^2, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.helper_matrix">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">helper_matrix</code><span class="sig-paren">(</span><em>Q</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.helper_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the (constant) matrix used to calculate the linear
combinations of the <span class="math">\(d(x^i y^j)\)</span> needed to eliminate the
negative powers of <span class="math">\(y\)</span> in the cohomology (i.e. in
reduce_negative()).</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">t</span> <span class="o">=</span> <span class="n">polygen</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">helper_matrix</span>
<span class="gp">sage: </span><span class="n">helper_matrix</span><span class="p">(</span><span class="n">t</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">691</span><span class="p">)</span>
<span class="go">[     64/12891731  -16584/12891731 4297329/12891731]</span>
<span class="go">[   6219/12891731     -32/12891731    8292/12891731]</span>
<span class="go">[    -24/12891731    6219/12891731     -32/12891731]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.lift">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">lift</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.lift" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to call x.lift(), presumably from the <span class="math">\(p\)</span>-adics to ZZ.</p>
<p>If this fails, it assumes the input is a power series, and tries to
lift it to a power series over QQ.</p>
<p>This function is just a very kludgy solution to the problem of
trying to make the reduction code (below) work over both Zp and
Zp[[t]].</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">lift</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">lift</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">)(</span><span class="mi">131</span><span class="p">));</span> <span class="n">l</span>
<span class="go">131</span>
<span class="gp">sage: </span><span class="n">l</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Integer Ring</span>

<span class="gp">sage: </span><span class="n">x</span><span class="o">=</span><span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Qp</span><span class="p">(</span><span class="mi">17</span><span class="p">),</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">l</span> <span class="o">=</span> <span class="n">lift</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">17</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">6</span><span class="p">);</span> <span class="n">l</span>
<span class="go">4 + 5*t + 17*t^6</span>
<span class="gp">sage: </span><span class="n">l</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Power Series Ring in t over Rational Field</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">matrix_of_frobenius</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>M</em>, <em>trace=None</em>, <em>compute_exact_forms=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the matrix of Frobenius on Monsky-Washnitzer cohomology,
with respect to the basis <span class="math">\((dx/y, x dx/y)\)</span>.</p>
<p>INPUT:</p>
<ul>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial <span class="math">\(Q(x) = x^3 + ax + b\)</span></dt>
<dd><p class="first last">defining an elliptic curve <span class="math">\(E\)</span> by
<span class="math">\(y^2 = Q(x)\)</span>. The coefficient ring of <span class="math">\(Q\)</span> should be a
<span class="math">\(\ZZ/(p^M)\ZZ\)</span>-algebra in which the matrix of
frobenius will be constructed.</p>
</dd>
</dl>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">p</span></code> – prime = 5 for which E has good reduction</p>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">M</span></code> – integer = 2; <span class="math">\(p\)</span> -adic precision of</dt>
<dd><p class="first last">the coefficient ring</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">trace</span></code> – (optional) the trace of the matrix, if</dt>
<dd><p class="first">known in advance. This is easy to compute because it is just the
<span class="math">\(a_p\)</span> of the curve. If the trace is supplied,
matrix_of_frobenius will use it to speed the computation (i.e. we
know the determinant is <span class="math">\(p\)</span>, so we have two conditions, so
really only column of the matrix needs to be computed. it is
actually a little more complicated than that, but that’s the basic
idea.) If trace=None, then both columns will be computed
independently, and you can get a strong indication of correctness
by verifying the trace afterwards.</p>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">THE RESULT WILL NOT NECESSARILY BE CORRECT TO M p-ADIC
DIGITS. If you want prec digits of precision, you need to use
the function adjusted_prec(), and then you need to reduce the
answer mod <span class="math">\(p^{\mathrm{prec}}\)</span> at the end.</p>
</div>
</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<p>2x2 matrix of frobenius on Monsky-Washnitzer cohomology,
with entries in the coefficient ring of Q.</p>
<p>EXAMPLES:</p>
<p>A simple example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">M</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[3090  187]</span>
<span class="go">[2945  408]</span>
</pre></div>
</div>
<p>But the result is only accurate to prec digits:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">B</span>
<span class="go">[90 62]</span>
<span class="go">[70 33]</span>
</pre></div>
</div>
<p>Check trace (123 = -2 mod 125) and determinant:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">123</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Try using the trace to speed up the calculation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span>
<span class="go">....:                                           p, M, -2)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[2715  187]</span>
<span class="go">[1445  408]</span>
</pre></div>
</div>
<p>Hmmm… it looks different, but that’s because the trace of our
first answer was only -2 modulo <span class="math">\(5^3\)</span>, not -2 modulo
<span class="math">\(5^5\)</span>. So the right answer is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">     [90 62]</span>
<span class="go">     [70 33]</span>
</pre></div>
</div>
<p>Check it works with only one digit of precision:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>
<span class="go">[0 2]</span>
<span class="go">[0 3]</span>
</pre></div>
</div>
<p>Here is an example that is particularly badly conditioned for
using the trace trick:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">[1144  176]</span>
<span class="go">[ 847  185]</span>
</pre></div>
</div>
<p>The problem here is that the top-right entry is divisible by 11,
and the bottom-left entry is divisible by <span class="math">\(11^2\)</span>. So when
you apply the trace trick, neither <span class="math">\(F(dx/y)\)</span> nor
<span class="math">\(F(x dx/y)\)</span> is enough to compute the whole matrix to the
desired precision, even if you try increasing the target precision
by one. Nevertheless, <code class="docutils literal"><span class="pre">matrix_of_frobenius</span></code> knows
how to get the right answer by evaluating <span class="math">\(F((x+1) dx/y)\)</span>
instead:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">7</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>
<span class="go">[1144  176]</span>
<span class="go">[ 847  185]</span>
</pre></div>
</div>
<p>The running time is about <code class="docutils literal"><span class="pre">O(p*prec**2)</span></code> (times some logarithmic
factors), so it is feasible to run on fairly large primes, or
precision (or both?!?!):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">10007</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span>            <span class="c1"># long time</span>
<span class="go">....:                           x^3 - x + R(1/4), p, M)     # long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">));</span> <span class="n">B</span>               <span class="c1"># long time</span>
<span class="go">[74311982 57996908]</span>
<span class="go">[95877067 25828133]</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">10007</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                             <span class="c1"># long time</span>
<span class="go">66</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">10007</span><span class="p">)</span>                    <span class="c1"># long time</span>
<span class="go">66</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">300</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span>            <span class="c1"># long time</span>
<span class="go">....:                           x^3 - x + R(1/4), p, M)     # long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">))</span>                  <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">B</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>                                            <span class="c1"># long time</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">EllipticCurve</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">ap</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>                        <span class="c1"># long time</span>
<span class="go">-2</span>
</pre></div>
</div>
<p>Let us check consistency of the results for a range of precisions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">max_prec</span> <span class="o">=</span> <span class="mi">60</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>         <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">max_prec</span><span class="p">))</span>              <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>                                           <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">prec</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_prec</span><span class="p">):</span>                       <span class="c1"># long time</span>
<span class="go">....:     M = monsky_washnitzer.adjusted_prec(p, prec)      # long time</span>
<span class="go">....:     R.&lt;x&gt; = PolynomialRing(Integers(p^M),&#39;x&#39;)         # long time</span>
<span class="go">....:     B = monsky_washnitzer.matrix_of_frobenius(        # long time</span>
<span class="go">....:                       x^3 - x + R(1/4), p, M)         # long time</span>
<span class="go">....:     B = B.change_ring(Integers(p**prec))              # long time</span>
<span class="go">....:     result.append(B == A.change_ring(                 # long time</span>
<span class="go">....:                              Integers(p**prec)))      # long time</span>
<span class="gp">sage: </span><span class="n">result</span> <span class="o">==</span> <span class="p">[</span><span class="bp">True</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">max_prec</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>                     <span class="c1"># long time</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The remaining examples discuss what happens when you take the
coefficient ring to be a power series ring; i.e. in effect you’re
looking at a family of curves.</p>
<p>The code does in fact work…</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">11</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">adjusted_prec</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">M</span><span class="p">),</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">t</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">8</span> <span class="o">-</span> <span class="mi">6</span><span class="o">*</span><span class="n">t</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">t</span><span class="o">^</span><span class="mi">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">b</span>
<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>    <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">PowerSeriesRing</span><span class="p">(</span><span class="n">Integers</span><span class="p">(</span><span class="n">p</span><span class="o">**</span><span class="n">prec</span><span class="p">),</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">default_prec</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>        <span class="c1"># long time</span>
<span class="gp">sage: </span><span class="n">B</span>                                                     <span class="c1"># long time</span>
<span class="go">[1144 + 264*t + 841*t^2 + 1025*t^3 + O(t^4)  176 + 1052*t + 216*t^2 + 523*t^3 + O(t^4)]</span>
<span class="go">[   847 + 668*t + 81*t^2 + 424*t^3 + O(t^4)   185 + 341*t + 171*t^2 + 642*t^3 + O(t^4)]</span>
</pre></div>
</div>
<p>The trace trick should work for power series rings too, even in the
badly- conditioned case. Unfortunately I don’t know how to compute
the trace in advance, so I’m not sure exactly how this would help.
Also, I suspect the running time will be dominated by the
expansion, so the trace trick won’t really speed things up anyway.
Another problem is that the determinant is not always p:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>                                               <span class="c1"># long time</span>
<span class="go">11 + 484*t^2 + 451*t^3 + O(t^4)</span>
</pre></div>
</div>
<p>However, it appears that the determinant always has the property
that if you substitute t - 11t, you do get the constant series p
(mod p**prec). Similarly for the trace. And since the parameter
only really makes sense when it is divisible by p anyway, perhaps
this isn’t a problem after all.</p>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius_hyperelliptic">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">matrix_of_frobenius_hyperelliptic</code><span class="sig-paren">(</span><em>Q</em>, <em>p=None</em>, <em>prec=None</em>, <em>M=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.matrix_of_frobenius_hyperelliptic" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the matrix of Frobenius on Monsky-Washnitzer cohomology,
with respect to the basis <span class="math">\((dx/2y, x dx/2y, ...x^{d-2} dx/2y)\)</span>, where
<span class="math">\(d\)</span> is the degree of <span class="math">\(Q\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> – monic polynomial <span class="math">\(Q(x)\)</span></li>
<li><code class="docutils literal"><span class="pre">p</span></code> – prime <span class="math">\(\geq 5\)</span> for which <span class="math">\(E\)</span> has good reduction</li>
<li><code class="docutils literal"><span class="pre">prec</span></code> – (optional) <span class="math">\(p\)</span>-adic precision of the coefficient ring</li>
<li><code class="docutils literal"><span class="pre">M</span></code> – (optional) adjusted <span class="math">\(p\)</span>-adic precision of the coefficient ring</li>
</ul>
<p>OUTPUT:</p>
<p><span class="math">\((d-1)\)</span> x <span class="math">\((d-1)\)</span> matrix <span class="math">\(M\)</span> of Frobenius on Monsky-Washnitzer cohomology,
and list of differentials {f_i } such that</p>
<div class="math">
\[\phi^* (x^i dx/2y) = df_i + M[i]*vec(dx/2y, ..., x^{d-2} dx/2y)\]</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">p</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">prec</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">,</span><span class="n">f</span> <span class="o">=</span> <span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">matrix_of_frobenius_hyperelliptic</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">prec</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span>
<span class="go">[            4*5 + O(5^3)       5 + 2*5^2 + O(5^3) 2 + 3*5 + 2*5^2 + O(5^3)     2 + 5 + 5^2 + O(5^3)]</span>
<span class="go">[      3*5 + 5^2 + O(5^3)             3*5 + O(5^3)             4*5 + O(5^3)         2 + 5^2 + O(5^3)]</span>
<span class="go">[    4*5 + 4*5^2 + O(5^3)     3*5 + 2*5^2 + O(5^3)       5 + 3*5^2 + O(5^3)     2*5 + 2*5^2 + O(5^3)]</span>
<span class="go">[            5^2 + O(5^3)       5 + 4*5^2 + O(5^3)     4*5 + 3*5^2 + O(5^3)             2*5 + O(5^3)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_all">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">reduce_all</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>coeffs</em>, <em>offset</em>, <em>compute_exact_form=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cohomology relations to reduce all terms to a linear
combination of <span class="math">\(dx/y\)</span> and <span class="math">\(x dx/y\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">coeffs</span></code> – list of length 3 lists. The</dt>
<dd><span class="math">\(i^{th}\)</span> list [a, b, c] represents
<span class="math">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">offset</span></code> – nonnegative integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">A,</span> <span class="pre">B</span></code> - pair such that the input differential is
cohomologous to (A + Bx) dx/y.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The algorithm operates in-place, so the data in coeffs is
destroyed.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_all</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go"> (21, 106)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_negative">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">reduce_negative</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>coeffs</em>, <em>offset</em>, <em>exact_form=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_negative" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cohomology relations to incorporate negative powers of
<span class="math">\(y\)</span> into the <span class="math">\(y^0\)</span> term.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">p</span></code> – prime</li>
<li><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">coeffs</span></code> – list of length 3 lists. The</dt>
<dd><span class="math">\(i^{th}\)</span> list [a, b, c] represents
<span class="math">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">offset</span></code> – nonnegative integer</li>
</ul>
<p>OUTPUT: The reduction is performed in-place. The output is placed
in coeffs[offset]. Note that coeffs[i] will be meaningless for i
offset after this function is finished.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_negative</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go"> [28, 52, 9]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_negative</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go"> [245, 332, 9]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_positive">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">reduce_positive</code><span class="sig-paren">(</span><em>Q</em>, <em>p</em>, <em>coeffs</em>, <em>offset</em>, <em>exact_form=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_positive" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cohomology relations to incorporate positive powers of
<span class="math">\(y\)</span> into the <span class="math">\(y^0\)</span> term.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">coeffs</span></code> – list of length 3 lists. The</dt>
<dd><span class="math">\(i^{th}\)</span> list [a, b, c] represents
<span class="math">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">offset</span></code> – nonnegative integer</li>
</ul>
<p>OUTPUT: The reduction is performed in-place. The output is placed
in coeffs[offset]. Note that coeffs[i] will be meaningless for i
offset after this function is finished.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_positive</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go"> [16, 102, 88]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_positive</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go"> [24, 108, 92]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_zero">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">reduce_zero</code><span class="sig-paren">(</span><em>Q</em>, <em>coeffs</em>, <em>offset</em>, <em>exact_form=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.reduce_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies cohomology relation to incorporate <span class="math">\(x^2 y^0\)</span> term
into <span class="math">\(x^0 y^0\)</span> and <span class="math">\(x^1 y^0\)</span> terms.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">Q</span></code> – cubic polynomial</li>
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">coeffs</span></code> – list of length 3 lists. The</dt>
<dd><span class="math">\(i^{th}\)</span> list [a, b, c] represents
<span class="math">\(y^{2(i - offset)} (a + bx + cx^2) dx/y\)</span>.</dd>
</dl>
</li>
<li><code class="docutils literal"><span class="pre">offset</span></code> – nonnegative integer</li>
</ul>
<p>OUTPUT: The reduction is performed in-place. The output is placed
in coeffs[offset]. This method completely ignores coeffs[i] for i
!= offset.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Integers</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">Q</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[[</span><span class="n">R</span><span class="o">.</span><span class="n">base_ring</span><span class="p">()(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">row</span><span class="p">]</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">monsky_washnitzer</span><span class="o">.</span><span class="n">reduce_zero</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">coeffs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go"> [6, 5, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.schemes.hyperelliptic_curves.monsky_washnitzer.transpose_list">
<code class="descclassname">sage.schemes.hyperelliptic_curves.monsky_washnitzer.</code><code class="descname">transpose_list</code><span class="sig-paren">(</span><em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.hyperelliptic_curves.monsky_washnitzer.transpose_list" title="Permalink to this definition">¶</a></dt>
<dd><p>INPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">input</span></code> – a list of lists, each list of the same</dt>
<dd>length</dd>
</dl>
</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="docutils literal"><span class="pre">output</span></code> – a list of lists such that output[i][j]</dt>
<dd>= input[j][i]</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.hyperelliptic_curves.monsky_washnitzer</span> <span class="kn">import</span> <span class="n">transpose_list</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">transpose_list</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
<span class="go">[[1, 3, 5], [2, 4, 6]]</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="mestre.html"
                                  title="previous chapter">Mestre’s algorithm</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="hypellfrob.html"
                                  title="next chapter">Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over GF(p),</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../../_sources/sage/schemes/hyperelliptic_curves/monsky_washnitzer.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypellfrob.html" title="Frobenius on Monsky-Washnitzer cohomology of a hyperelliptic curve over GF(p),"
             >next</a> |</li>
        <li class="right" >
          <a href="mestre.html" title="Mestre’s algorithm"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Plane curves</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>