<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=600, initial-scale=1">
    <title>Morphisms between toric lattices compatible with fans &#8212; Sage Reference Manual v8.0: Combinatorial and Discrete Geometry</title>
    
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '8.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Point collections" href="point_collection.html" />
    <link rel="prev" title="Rational polyhedral fans" href="fan.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="point_collection.html" title="Point collections"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fan.html" title="Rational polyhedral fans"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Combinatorial and Discrete Geometry</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="morphisms-between-toric-lattices-compatible-with-fans">
<span id="sage-geometry-fan-morphism"></span><h1>Morphisms between toric lattices compatible with fans<a class="headerlink" href="#morphisms-between-toric-lattices-compatible-with-fans" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.geometry.fan_morphism"></span><p>This module is a part of the framework for toric varieties
(<a class="reference external" href="../../../schemes/sage/schemes/toric/variety.html#module-sage.schemes.toric.variety" title="(in Sage Reference Manual: Schemes v8.0)"><code class="xref py py-mod docutils literal"><span class="pre">variety</span></code></a>,
<a class="reference external" href="../../../schemes/sage/schemes/toric/fano_variety.html#module-sage.schemes.toric.fano_variety" title="(in Sage Reference Manual: Schemes v8.0)"><code class="xref py py-mod docutils literal"><span class="pre">fano_variety</span></code></a>). Its main purpose is to
provide support for working with lattice morphisms compatible with fans via
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism" title="sage.geometry.fan_morphism.FanMorphism"><code class="xref py py-class docutils literal"><span class="pre">FanMorphism</span></code></a> class.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Andrey Novoseltsev (2010-10-17): initial version.</li>
<li><dl class="first docutils">
<dt>Andrey Novoseltsev (2011-04-11): added tests for injectivity/surjectivity,</dt>
<dd>fibration, bundle, as well as some related methods.</dd>
</dl>
</li>
</ul>
<p>EXAMPLES:</p>
<p>Let&#8217;s consider the face and normal fans of the &#8220;diamond&#8221; and the projection
to the <span class="math">\(x\)</span>-axis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">normal</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">N</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Free module morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain: 2-d lattice N</span>
<span class="go">Codomain: 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the image of generating cone #1 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
</pre></div>
</div>
<p>Some of the cones of the normal fan fail to be mapped to a single cone of the
face fan. We can rectify the situation in the following way:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 1, -1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N(-1,  1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N( 0,  1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">normal</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 1, -1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N(-1,  1)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>As you see, it was necessary to insert two new rays (to prevent &#8220;upper&#8221; and
&#8220;lower&#8221; cones of the normal fan from being mapped to the whole <span class="math">\(x\)</span>-axis).</p>
<dl class="class">
<dt id="sage.geometry.fan_morphism.FanMorphism">
<em class="property">class </em><code class="descclassname">sage.geometry.fan_morphism.</code><code class="descname">FanMorphism</code><span class="sig-paren">(</span><em>morphism</em>, <em>domain_fan</em>, <em>codomain=None</em>, <em>subdivide=False</em>, <em>check=True</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../modules/sage/modules/free_module_morphism.html#sage.modules.free_module_morphism.FreeModuleMorphism" title="(in Sage Reference Manual: Modules v8.0)"><code class="xref py py-class docutils literal"><span class="pre">sage.modules.free_module_morphism.FreeModuleMorphism</span></code></a></p>
<p>Create a fan morphism.</p>
<p>Let <span class="math">\(\Sigma_1\)</span> and <span class="math">\(\Sigma_2\)</span> be two fans in lattices <span class="math">\(N_1\)</span> and <span class="math">\(N_2\)</span>
respectively. Let <span class="math">\(\phi\)</span> be a morphism (i.e. a linear map) from <span class="math">\(N_1\)</span> to
<span class="math">\(N_2\)</span>. We say that <span class="math">\(\phi\)</span> is <em>compatible</em> with <span class="math">\(\Sigma_1\)</span> and <span class="math">\(\Sigma_2\)</span>
if every cone <span class="math">\(\sigma_1\in\Sigma_1\)</span> is mapped by <span class="math">\(\phi\)</span> into a single cone
<span class="math">\(\sigma_2\in\Sigma_2\)</span>, i.e. <span class="math">\(\phi(\sigma_1)\subset\sigma_2\)</span> (<span class="math">\(\sigma_2\)</span>
may be different for different <span class="math">\(\sigma_1\)</span>).</p>
<p>By a <strong>fan morphism</strong> we understand a morphism between two lattices
compatible with specified fans in these lattices. Such morphisms behave in
exactly the same way as &#8220;regular&#8221; morphisms between lattices, but:</p>
<ul class="simple">
<li>fan morphisms have a special constructor allowing some automatic
adjustments to the initial fans (see below);</li>
<li>fan morphisms are aware of the associated fans and they can be
accessed via <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> and <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a>;</li>
<li>fan morphisms can efficiently compute <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal"><span class="pre">image_cone()</span></code></a> of a given
cone of the domain fan and <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></code></a> of a given cone of
the codomain fan.</li>
</ul>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">morphism</span></code> &#8211; either a morphism between domain and codomain, or an
integral matrix defining such a morphism;</li>
<li><code class="docutils literal"><span class="pre">domain_fan</span></code> &#8211; a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a> in the domain;</li>
<li><code class="docutils literal"><span class="pre">codomain</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) either a codomain lattice or a fan in
the codomain. If the codomain fan is not given, the image fan (fan
generated by images of generating cones) of <code class="docutils literal"><span class="pre">domain_fan</span></code> will be used,
if possible;</li>
<li><code class="docutils literal"><span class="pre">subdivide</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">False</span></code>) if <code class="docutils literal"><span class="pre">True</span></code> and <code class="docutils literal"><span class="pre">domain_fan</span></code> is
not compatible with the codomain fan because it is too coarse, it will be
automatically refined to become compatible (the minimal refinement is
canonical, so there are no choices involved);</li>
<li><code class="docutils literal"><span class="pre">check</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">True</span></code>) if <code class="docutils literal"><span class="pre">False</span></code>, given fans and morphism
will be assumed to be compatible. Be careful when using this option,
since wrong assumptions can lead to wrong and hard-to-detect errors. On
the other hand, this option may save you some time;</li>
<li><code class="docutils literal"><span class="pre">verbose</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">False</span></code>) if <code class="docutils literal"><span class="pre">True</span></code>, some information may be
printed during construction of the fan morphism.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a fan morphism.</li>
</ul>
<p>EXAMPLES:</p>
<p>Here we consider the face and normal fans of the &#8220;diamond&#8221; and the
projection to the <span class="math">\(x\)</span>-axis:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">diamond</span> <span class="o">=</span> <span class="n">lattice_polytope</span><span class="o">.</span><span class="n">cross_polytope</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">face</span> <span class="o">=</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">,</span> <span class="n">lattice</span><span class="o">=</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">normal</span> <span class="o">=</span> <span class="n">NormalFan</span><span class="p">(</span><span class="n">diamond</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">H</span><span class="p">([</span><span class="n">N</span><span class="o">.</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Free module morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 0]</span>
<span class="go">Domain: 2-d lattice N</span>
<span class="go">Codomain: 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">normal</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">face</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note, that since <code class="docutils literal"><span class="pre">phi</span></code> is compatible with these fans, the returned
fan is exactly the same object as the initial <code class="docutils literal"><span class="pre">domain_fan</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the image of generating cone #1 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">face</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">normal</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">6</span>
</pre></div>
</div>
<p>We had to subdivide two of the four cones of the normal fan, since
they were mapped by <code class="docutils literal"><span class="pre">phi</span></code> into non-strictly convex cones.</p>
<p>It is possible to omit the codomain fan, in which case the image fan will
be used instead of it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in 2-d lattice N</span>
</pre></div>
</div>
<p>Now we demonstrate a more subtle example. We take the first quadrant as our
domain fan. Then we divide the first quadrant into three cones, throw away
the middle one and take the other two as our codomain fan. These fans are
incompatible with the identity lattice morphism since the image of the
domain fan is out of the support of the codomain fan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">End</span><span class="p">(</span><span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">identity</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">F1</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)],</span>
<span class="go">....:          rays=[(1,0), (2,1), (1,2), (0,1)])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">the image of generating cone #0 of the domain fan</span>
<span class="go">is not contained in a single cone of the codomain fan!</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">morphism defined by</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="go">does not map</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="go">into the support of</span>
<span class="go">Rational polyhedral fan in 2-d lattice N!</span>
</pre></div>
</div>
<p>The problem was detected and handled correctly (i.e. an exception was
raised). However, the used algorithm requires extra checks for this
situation after constructing a potential subdivision and this can take
significant time. You can save about half the time using
<code class="docutils literal"><span class="pre">check=False</span></code> option, if you know in advance that it is possible to
make fans compatible with the morphism by subdividing the domain fan.
Of course, if your assumption was incorrect, the result will be wrong
and you will get a fan which <em>does</em> map into the support of the
codomain fan, but is <strong>not</strong> a subdivision of the domain fan. You
can test it on the example above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">,</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
<span class="go">....:                  check=False, verbose=True)</span>
<span class="go">Placing ray images (... ms)</span>
<span class="go">Computing chambers (... ms)</span>
<span class="go">Number of domain cones: 1.</span>
<span class="go">Number of chambers: 2.</span>
<span class="go">Cone 0 sits in chambers 0 1 (... ms)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">is_equivalent</span><span class="p">(</span><span class="n">F2</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.codomain_fan">
<code class="descname">codomain_fan</code><span class="sig-paren">(</span><em>dim=None</em>, <em>codim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the codomain fan of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">dim</span></code> &#8211; dimension of the requested cones;</li>
<li><code class="docutils literal"><span class="pre">codim</span></code> &#8211; codimension of the requested cones.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a> if no parameters were
given, <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">quadrant</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.domain_fan">
<code class="descname">domain_fan</code><span class="sig-paren">(</span><em>dim=None</em>, <em>codim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the codomain fan of <code class="docutils literal"><span class="pre">self</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">dim</span></code> &#8211; dimension of the requested cones;</li>
<li><code class="docutils literal"><span class="pre">codim</span></code> &#8211; codimension of the requested cones.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a> if no parameters were
given, <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span> <span class="ow">is</span> <span class="n">quadrant_bl</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.factor">
<code class="descname">factor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Factor <code class="docutils literal"><span class="pre">self</span></code> into injective * birational * surjective morphisms.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a triple of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism" title="sage.geometry.fan_morphism.FanMorphism"><code class="xref py py-class docutils literal"><span class="pre">FanMorphism</span></code></a> <span class="math">\((\phi_i, \phi_b, \phi_s)\)</span>, such that
<span class="math">\(\phi_s\)</span> is surjective, <span class="math">\(\phi_b\)</span> is birational, <span class="math">\(\phi_i\)</span> is injective,
and <code class="docutils literal"><span class="pre">self</span></code> is equal to <span class="math">\(\phi_i \circ \phi_b \circ \phi_s\)</span>.</li>
</ul>
<p>Intermediate fans live in the saturation of the image of <code class="docutils literal"><span class="pre">self</span></code>
as a map between lattices and are the image of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a>
and the restriction of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a>, i.e. if <code class="docutils literal"><span class="pre">self</span></code> maps
<span class="math">\(\Sigma \to \Sigma'\)</span>, then we have factorization into</p>
<div class="math">
\[\Sigma
\twoheadrightarrow
\Sigma_s
\to
\Sigma_i
\hookrightarrow
\Sigma.\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><span class="math">\(\Sigma_s\)</span> is the finest fan with the smallest support that is
compatible with <code class="docutils literal"><span class="pre">self</span></code>: any fan morphism from <span class="math">\(\Sigma\)</span> given by
the same map of lattices as <code class="docutils literal"><span class="pre">self</span></code> factors through <span class="math">\(\Sigma_s\)</span>.</li>
<li><span class="math">\(\Sigma_i\)</span> is the coarsest fan of the largest support that is
compatible with <code class="docutils literal"><span class="pre">self</span></code>: any fan morphism into <span class="math">\(\Sigma'\)</span> given by
the same map of lattices as <code class="docutils literal"><span class="pre">self</span></code> factors though <span class="math">\(\Sigma_i\)</span>.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<p>We map an affine plane into a projective 3-space in such a way, that it
becomes &#8220;a double cover of a chart of the blow up of one of the
coordinate planes&#8221;:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P3</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">hom</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">P3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">as_polynomial_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d affine toric variety</span>
<span class="go">  To:   3-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="go">  Defn: Defined on coordinates by sending [x : y] to</span>
<span class="go">        [x^2*y : y : 1 : 1]</span>
</pre></div>
</div>
<p>Now we will work with the underlying fan morphism:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">fan_morphism</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[2 0 0]</span>
<span class="go">[1 1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(False, False, False)</span>
<span class="gp">sage: </span><span class="n">phi_i</span><span class="p">,</span> <span class="n">phi_b</span><span class="p">,</span> <span class="n">phi_s</span> <span class="o">=</span> <span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">(),</span> <span class="n">phi_b</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">phi_i</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">(True, True, True)</span>
<span class="gp">sage: </span><span class="n">prod</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">factor</span><span class="p">())</span> <span class="o">==</span> <span class="n">phi</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Double cover (surjective):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0),</span>
<span class="go">N(0, 1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi_s</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[2 0]</span>
<span class="go">[1 1]</span>
<span class="go">Domain fan: Rational polyhedral fan in 2-d lattice N</span>
<span class="go">Codomain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">phi_s</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 0, 0),</span>
<span class="go">N(1, 1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
</pre></div>
</div>
<p>Blowup chart (birational):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_b</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0]</span>
<span class="go">[0 1]</span>
<span class="go">Domain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="go">Codomain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="gp">sage: </span><span class="n">phi_b</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  0, 0),</span>
<span class="go">N( 0,  1, 0),</span>
<span class="go">N(-1, -1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
</pre></div>
</div>
<p>Coordinate plane inclusion (injective):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi_i</span>
<span class="go">Fan morphism defined by the matrix</span>
<span class="go">[1 0 0]</span>
<span class="go">[0 1 0]</span>
<span class="go">Domain fan: Rational polyhedral fan in Sublattice &lt;N(1, 0, 0), N(0, 1, 0)&gt;</span>
<span class="go">Codomain fan: Rational polyhedral fan in 3-d lattice N</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">codomain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  0,  0),</span>
<span class="go">N( 0,  1,  0),</span>
<span class="go">N( 0,  0,  1),</span>
<span class="go">N(-1, -1, -1)</span>
<span class="go">in 3-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.image_cone">
<code class="descname">image_cone</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the cone of the codomain fan containing the image of <code class="docutils literal"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a>
of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">1-d cone of Rational polyhedral fan in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">image_cone</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">2-d cone of Rational polyhedral fan in 2-d lattice N</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.index">
<code class="descname">index</code><span class="sig-paren">(</span><em>cone=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of <code class="docutils literal"><span class="pre">self</span></code> as a map between lattices.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; (default: <code class="docutils literal"><span class="pre">None</span></code>) a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a> of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an integer, infinity, or <code class="docutils literal"><span class="pre">None</span></code>.</li>
</ul>
<p>If no cone was specified, this function computes the index of the
image of <code class="docutils literal"><span class="pre">self</span></code> in the codomain. If a cone <span class="math">\(\sigma\)</span> was given, the
index of <code class="docutils literal"><span class="pre">self</span></code> over <span class="math">\(\sigma\)</span> is computed in the sense of
Definition 2.1.7 of <a class="reference internal" href="../../../references/index.html#hly2002" id="id1">[HLY2002]</a>: if <span class="math">\(\sigma'\)</span> is any cone of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code> whose relative interior is mapped to the
relative interior of <span class="math">\(\sigma\)</span>, it is the index of the image of
<span class="math">\(N'(\sigma')\)</span> in <span class="math">\(N(\sigma)\)</span>, where <span class="math">\(N'\)</span> and <span class="math">\(N\)</span> are domain and codomain
lattices respectively. While that definition was formulated for the case
of the finite index only, we extend it to the infinite one as well and
return <code class="docutils literal"><span class="pre">None</span></code> if there is no <span class="math">\(\sigma'\)</span> at all. See examples below for
situations when such things happen. Note also that the index of <code class="docutils literal"><span class="pre">self</span></code>
is the same as index over the trivial cone.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>Infinite index in the last example indicates that the image has positive
codimension in the codomain. Let&#8217;s look at the rays of our fans:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma_p</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1),</span>
<span class="go">N(-1)</span>
<span class="go">in 1-d lattice N</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1,  1),</span>
<span class="go">N( 0,  1),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N( 1,  0)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">factor</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">domain_fan</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 1, 0),</span>
<span class="go">N(-1, 0)</span>
<span class="go">in Sublattice &lt;N(1, 0)&gt;</span>
</pre></div>
</div>
<p>We see that one of the rays of the fan of <code class="docutils literal"><span class="pre">P1</span></code> is mapped to a ray,
while the other one to the interior of some 2-d cone. Both rays
correspond to single points on <code class="docutils literal"><span class="pre">P1</span></code>, yet one is mapped to the
distinguished point of a torus invariant curve of <code class="docutils literal"><span class="pre">dP8</span></code> (with the
rest of this curve being uncovered) and the other to a fixed point
of <code class="docutils literal"><span class="pre">dP8</span></code> (thus completely covering this torus orbit in <code class="docutils literal"><span class="pre">dP8</span></code>).</p>
<p>We should therefore expect the following behaviour: all indices over
1-d cones are <code class="docutils literal"><span class="pre">None</span></code>, except for one which is infinite, and all
indices over 2-d cones are <code class="docutils literal"><span class="pre">None</span></code>, except for one which is 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="p">[</span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">Sigma</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
<span class="go">[None, None, None, +Infinity]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cone</span><span class="p">)</span> <span class="k">for</span> <span class="n">cone</span> <span class="ow">in</span> <span class="n">Sigma</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="go">[None, 1, None, None]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_birational">
<code class="descname">is_birational</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_birational" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is birational.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is birational, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>For fan morphisms this check is equivalent to <code class="docutils literal"><span class="pre">self.index()</span> <span class="pre">==</span> <span class="pre">1</span></code> and
means that the corresponding map between toric varieties is birational.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">(),</span> <span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">(1, 2, +Infinity)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">psi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">(),</span> <span class="n">xi</span><span class="o">.</span><span class="n">is_birational</span><span class="p">()</span>
<span class="go">(True, False, False)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_bundle">
<code class="descname">is_bundle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is a bundle.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is a bundle, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>Let <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism such that the
underlying lattice morphism <span class="math">\(\phi: N \to N'\)</span> is surjective. Let
<span class="math">\(\Sigma_0\)</span> be the kernel fan of <span class="math">\(\phi\)</span>. Then <span class="math">\(\phi\)</span> is a <strong>bundle</strong> (or
splitting) if there is a subfan <span class="math">\(\widehat{\Sigma}\)</span> of <span class="math">\(\Sigma\)</span> such
that the following two conditions are satisfied:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Cones of <span class="math">\(\Sigma\)</span> are precisely the cones of the form
<span class="math">\(\sigma_0 + \widehat{\sigma}\)</span>, where <span class="math">\(\sigma_0 \in \Sigma_0\)</span> and
<span class="math">\(\widehat{\sigma} \in \widehat{\Sigma}\)</span>.</li>
<li>Cones of <span class="math">\(\widehat{\Sigma}\)</span> are in bijection with cones of
<span class="math">\(\Sigma'\)</span> induced by <span class="math">\(\phi\)</span> and <span class="math">\(\phi\)</span> maps lattice points in
every cone <span class="math">\(\widehat{\sigma} \in \widehat{\Sigma}\)</span> bijectively
onto lattice points in <span class="math">\(\phi(\widehat{\sigma})\)</span>.</li>
</ol>
</div></blockquote>
<p>If a fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is a bundle, then
<span class="math">\(X_\Sigma\)</span> is a fiber bundle over <span class="math">\(X_{\Sigma'}\)</span> with fibers
<span class="math">\(X_{\Sigma_0, N_0}\)</span>, where <span class="math">\(N_0\)</span> is the kernel lattice of <span class="math">\(\phi\)</span>. See
<a class="reference internal" href="../../../references/index.html#cls2011" id="id2">[CLS2011]</a> for more details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal"><span class="pre">is_fibration()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="sage.geometry.fan_morphism.FanMorphism.kernel_fan"><code class="xref py py-meth docutils literal"><span class="pre">kernel_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We consider several maps between fans of a del Pezzo surface and the
projective line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>The first of these maps induces not only a fibration, but a fiber
bundle structure. The second map is very similar, yet it fails to be
a bundle, as its index is 2. The last map is not even a fibration.</p>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_dominant">
<code class="descname">is_dominant</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the fan morphism is dominant.</p>
<p>A fan morphism <span class="math">\(\phi\)</span> is dominant if it is surjective as a map
of vector spaces. That is, <span class="math">\(\phi_\RR: N_\RR \to N'_\RR\)</span> is
surjective.</p>
<p>If the domain fan is <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan.is_complete" title="sage.geometry.fan.RationalPolyhedralFan.is_complete"><code class="xref py py-meth docutils literal"><span class="pre">complete</span></code></a>, then
this implies that the fan morphism is <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="sage.geometry.fan_morphism.FanMorphism.is_surjective"><code class="xref py py-meth docutils literal"><span class="pre">surjective</span></code></a>.</p>
<p>If the fan morphism is dominant, then the associated morphism
of toric varieties is dominant in the algebraic-geometric
sense (that is, surjective onto a dense subset).</p>
<p>OUTPUT:</p>
<p>Boolean.</p>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">A1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">A1</span><span class="o">.</span><span class="n">fan</span><span class="p">(),</span> <span class="n">P1</span><span class="o">.</span><span class="n">fan</span><span class="p">())</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_dominant</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_fibration">
<code class="descname">is_fibration</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is a fibration.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is a fibration, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>A fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is a <strong>fibration</strong>
if for any cone <span class="math">\(\sigma' \in \Sigma'\)</span> and any primitive
preimage cone <span class="math">\(\sigma \in \Sigma\)</span> corresponding to <span class="math">\(\sigma'\)</span>
the linear map of vector spaces <span class="math">\(\phi_\RR\)</span> induces a bijection
between <span class="math">\(\sigma\)</span> and <span class="math">\(\sigma'\)</span>, and, in addition, <span class="math">\(phi\)</span> is
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_dominant" title="sage.geometry.fan_morphism.FanMorphism.is_dominant"><code class="xref py py-meth docutils literal"><span class="pre">dominant</span></code></a> (that is, <span class="math">\(\phi_\RR: N_\RR \to
N'_\RR\)</span> is surjective).</p>
<p>If a fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is a fibration, then the
associated morphism between toric varieties <span class="math">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is a fibration in the sense that it is surjective and all
of its fibers have the same dimension, namely <span class="math">\(\dim X_\Sigma -
\dim X_{\Sigma'}\)</span>. These fibers do <em>not</em> have to be isomorphic, i.e. a
fibration is not necessarily a fiber bundle. See <a class="reference internal" href="../../../references/index.html#hly2002" id="id3">[HLY2002]</a> for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="sage.geometry.fan_morphism.FanMorphism.is_bundle"><code class="xref py py-meth docutils literal"><span class="pre">is_bundle()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">primitive_preimage_cones()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>We consider several maps between fans of a del Pezzo surface and the
projective line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP8</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">psi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">xi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]),</span> <span class="n">Sigma_p</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">psi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">xi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
<p>The first of these maps induces not only a fibration, but a fiber
bundle structure. The second map is very similar, yet it fails to be
a bundle, as its index is 2. The last map is not even a fibration.</p>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_injective">
<code class="descname">is_injective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_injective" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is injective.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is injective, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>Let <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism such that the
underlying lattice morphism <span class="math">\(\phi: N \to N'\)</span> bijectively maps <span class="math">\(N\)</span> to a
<em>saturated</em> sublattice of <span class="math">\(N'\)</span>. Let <span class="math">\(\psi: \Sigma \to \Sigma'_0\)</span> be the
restriction of <span class="math">\(\phi\)</span> to the image. Then <span class="math">\(\phi\)</span> is <strong>injective</strong> if the
map between cones corresponding to <span class="math">\(\psi\)</span> (injectively) maps each cone
of <span class="math">\(\Sigma\)</span> to a cone of the same dimension.</p>
<p>If a fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is injective, then the
associated morphism between toric varieties <span class="math">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is injective.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.factor" title="sage.geometry.fan_morphism.FanMorphism.factor"><code class="xref py py-meth docutils literal"><span class="pre">factor()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Consider the fan of the affine plane:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
</pre></div>
</div>
<p>We will map several fans consisting of a single ray into the interior
of the 2-cone:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This morphism was not injective since (in the toric varieties
interpretation) the 1-dimensional orbit corresponding to the ray was
mapped to the 0-dimensional orbit corresponding to the 2-cone.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>While the fans in this example are close to the previous one, here the
ray corresponds to a 0-dimensional orbit.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Here the problem is that <code class="docutils literal"><span class="pre">m</span></code> maps the domain lattice to a
non-saturated sublattice of the codomain. The corresponding map of the
toric varieties is a two-sheeted cover of its image.</p>
<p>We also embed the affine plane into the projective one:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">P2</span><span class="p">)</span><span class="o">.</span><span class="n">is_injective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.is_surjective">
<code class="descname">is_surjective</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.is_surjective" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal"><span class="pre">self</span></code> is surjective.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">self</span></code> is surjective, <code class="docutils literal"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>A fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is <strong>surjective</strong> if the
corresponding map between cones is surjective, i.e. for each cone
<span class="math">\(\sigma' \in \Sigma'\)</span> there is at least one preimage cone <span class="math">\(\sigma \in
\Sigma\)</span> such that the relative interior of <span class="math">\(\sigma\)</span> is mapped to the
relative interior of <span class="math">\(\sigma'\)</span> and, in addition,
<span class="math">\(\phi_\RR: N_\RR \to N'_\RR\)</span> is surjective.</p>
<p>If a fan morphism <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> is surjective, then the
associated morphism between toric varieties <span class="math">\(\tilde{\phi}: X_\Sigma \to
X_{\Sigma'}\)</span> is surjective.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_bundle" title="sage.geometry.fan_morphism.FanMorphism.is_bundle"><code class="xref py py-meth docutils literal"><span class="pre">is_bundle()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal"><span class="pre">is_fibration()</span></code></a>,
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></code></a>, <code class="xref py py-meth docutils literal"><span class="pre">is_complete()</span></code>.</p>
</div>
<p>EXAMPLES:</p>
<p>We check that the blow up of the affine plane at the origin is
surjective:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Bl</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>It remains surjective if we throw away &#8220;south and north poles&#8221; of the
exceptional divisor:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">Fan</span><span class="p">(</span><span class="n">Bl</span><span class="o">.</span><span class="n">cones</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But a single patch of the blow up does not cover the plane:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">Bl</span><span class="o">.</span><span class="n">generating_cone</span><span class="p">(</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">FanMorphism</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span><span class="o">.</span><span class="n">is_surjective</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.kernel_fan">
<code class="descname">kernel_fan</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subfan of the domain fan mapped into the origin.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The lattice of the kernel fan is the <code class="xref py py-meth docutils literal"><span class="pre">kernel()</span></code> sublattice of
<code class="docutils literal"><span class="pre">self</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)],</span> <span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">fan</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">kernel_fan</span><span class="p">()</span>
<span class="go">Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N(1, 1)</span>
<span class="go">in Sublattice &lt;N(1, 1)&gt;</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">kernel_fan</span><span class="p">()</span><span class="o">.</span><span class="n">cones</span><span class="p">()</span>
<span class="go">((0-d cone of Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;,),</span>
<span class="go"> (1-d cone of Rational polyhedral fan in Sublattice &lt;N(1, 1)&gt;,))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.preimage_cones">
<code class="descname">preimage_cones</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Return cones of the domain fan whose <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal"><span class="pre">image_cone()</span></code></a> is <code class="docutils literal"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal"><span class="pre">tuple</span></code></a> of <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cones</span></code></a> of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>, sorted by dimension.</li>
</ul>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">quadrant_bl</span><span class="p">,</span> <span class="n">quadrant</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)]))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.preimage_fan">
<code class="descname">preimage_fan</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the subfan of the domain fan mapped into <code class="docutils literal"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="fan.html#sage.geometry.fan.RationalPolyhedralFan" title="sage.geometry.fan.RationalPolyhedralFan"><code class="xref py py-class docutils literal"><span class="pre">fan</span></code></a>.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The preimage fan of <code class="docutils literal"><span class="pre">cone</span></code> consists of all cones of the
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a> which are mapped into <code class="docutils literal"><span class="pre">cone</span></code>, including those
that are mapped into its boundary. So this fan is not necessarily
generated by <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></code></a> of <code class="docutils literal"><span class="pre">cone</span></code>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.kernel_fan" title="sage.geometry.fan_morphism.FanMorphism.kernel_fan"><code class="xref py py-meth docutils literal"><span class="pre">kernel_fan()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">quadrant_cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">quadrant_fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">([</span><span class="n">quadrant_cone</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">quadrant_bl</span> <span class="o">=</span> <span class="n">quadrant_fan</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">fm</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
<span class="go">....:                  quadrant_bl, quadrant_fan)</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_fan</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)]))</span><span class="o">.</span><span class="n">cones</span><span class="p">()</span>
<span class="go">((0-d cone of Rational polyhedral fan in 2-d lattice N,),</span>
<span class="go"> (1-d cone of Rational polyhedral fan in 2-d lattice N,))</span>
<span class="gp">sage: </span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_fan</span><span class="p">(</span><span class="n">quadrant_cone</span><span class="p">)</span><span class="o">.</span><span class="n">ngenerating_cones</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">quadrant_cone</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones">
<code class="descname">primitive_preimage_cones</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.primitive_preimage_cones" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the primitive cones of the domain fan corresponding to <code class="docutils literal"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">cone</span></code> &#8211; a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a> equivalent to a
cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.codomain_fan" title="sage.geometry.fan_morphism.FanMorphism.codomain_fan"><code class="xref py py-meth docutils literal"><span class="pre">codomain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <a class="reference internal" href="cone.html#sage.geometry.cone.ConvexRationalPolyhedralCone" title="sage.geometry.cone.ConvexRationalPolyhedralCone"><code class="xref py py-class docutils literal"><span class="pre">cone</span></code></a>.</li>
</ul>
<p>Let <span class="math">\(\phi: \Sigma \to \Sigma'\)</span> be a fan morphism, let <span class="math">\(\sigma \in
\Sigma\)</span>, and let <span class="math">\(\sigma' = \phi(\sigma)\)</span>. Then <span class="math">\(\sigma\)</span> is a
<strong>primitive cone corresponding to</strong> <span class="math">\(\sigma'\)</span> if there is no proper
face <span class="math">\(\tau\)</span> of <span class="math">\(\sigma\)</span> such that <span class="math">\(\phi(\tau) = \sigma'\)</span>.</p>
<p>Primitive cones play an important role for fibration morphisms.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.is_fibration" title="sage.geometry.fan_morphism.FanMorphism.is_fibration"><code class="xref py py-meth docutils literal"><span class="pre">is_fibration()</span></code></a>, <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_cones" title="sage.geometry.fan_morphism.FanMorphism.preimage_cones"><code class="xref py py-meth docutils literal"><span class="pre">preimage_cones()</span></code></a>,
<a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal"><span class="pre">preimage_fan()</span></code></a>.</p>
</div>
<p>EXAMPLES:</p>
<p>Consider a projection of a del Pezzo surface onto the projective line:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Sigma</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Sigma</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">N( 0,  1),</span>
<span class="go">N(-1,  0),</span>
<span class="go">N(-1, -1),</span>
<span class="go">N( 0, -1),</span>
<span class="go">N( 1,  0),</span>
<span class="go">N( 1,  1)</span>
<span class="go">in 2-d lattice N</span>
<span class="gp">sage: </span><span class="n">Sigma_p</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">phi</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]),</span> <span class="n">Sigma</span><span class="p">,</span> <span class="n">Sigma_p</span><span class="p">)</span>
</pre></div>
</div>
<p>Under this map, one pair of rays is mapped to the origin, one in the
positive direction, and one in the negative one. Also three
2-dimensional cones are mapped in the positive direction and three in
the negative one, so there are 5 preimage cones corresponding to either
of the rays of the codomain fan <code class="docutils literal"><span class="pre">Sigma_p</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span><span class="n">phi</span><span class="o">.</span><span class="n">preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)])))</span>
<span class="go">5</span>
</pre></div>
</div>
<p>Yet only rays are primitive:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">primitive_preimage_cones</span><span class="p">(</span><span class="n">Cone</span><span class="p">([(</span><span class="mi">1</span><span class="p">,)]))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 1-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
<p>Since all primitive cones are mapped onto their images bijectively, we
get a fibration:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_fibration</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>But since there are several primitive cones corresponding to the same
cone of the codomain fan, this map is not a bundle, even though its
index is 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">is_bundle</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">phi</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.fan_morphism.FanMorphism.relative_star_generators">
<code class="descname">relative_star_generators</code><span class="sig-paren">(</span><em>domain_cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.fan_morphism.FanMorphism.relative_star_generators" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the relative star generators of <code class="docutils literal"><span class="pre">domain_cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">domain_cone</span></code> &#8211; a cone of the <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.domain_fan" title="sage.geometry.fan_morphism.FanMorphism.domain_fan"><code class="xref py py-meth docutils literal"><span class="pre">domain_fan()</span></code></a> of <code class="docutils literal"><span class="pre">self</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="xref py py-meth docutils literal"><span class="pre">star_generators()</span></code> of <code class="docutils literal"><span class="pre">domain_cone</span></code>
viewed as a cone of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.preimage_fan" title="sage.geometry.fan_morphism.FanMorphism.preimage_fan"><code class="xref py py-meth docutils literal"><span class="pre">preimage_fan()</span></code></a> of <a class="reference internal" href="#sage.geometry.fan_morphism.FanMorphism.image_cone" title="sage.geometry.fan_morphism.FanMorphism.image_cone"><code class="xref py py-meth docutils literal"><span class="pre">image_cone()</span></code></a> of
<code class="docutils literal"><span class="pre">domain_cone</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Bl</span> <span class="o">=</span> <span class="n">A2</span><span class="o">.</span><span class="n">subdivide</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">FanMorphism</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">Bl</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">Bl</span><span class="p">(</span><span class="mi">1</span><span class="p">):</span>
<span class="go">....:     print(f.relative_star_generators(c1))</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">(1-d cone of Rational polyhedral fan in 2-d lattice N,)</span>
<span class="go">(2-d cone of Rational polyhedral fan in 2-d lattice N,</span>
<span class="go"> 2-d cone of Rational polyhedral fan in 2-d lattice N)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <h4>Previous topic</h4>
            <p class="topless"><a href="fan.html"
                                  title="previous chapter">Rational polyhedral fans</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="point_collection.html"
                                  title="next chapter">Point collections</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../../_sources/sage/geometry/fan_morphism.rst.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="../../../search.html" method="get">
                <input type="text" name="q" size="18" />
               <!-- The shading of the "Go" button should be consistent -->
               <!-- with the colour of the header and footer. See the file -->
               <!-- doc/common/themes/sage/theme.conf for colours used by -->
               <!-- the Sage theme. -->
                <input type="submit" style="background-color: #B8B9F6" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="point_collection.html" title="Point collections"
             >next</a> |</li>
        <li class="right" >
          <a href="fan.html" title="Rational polyhedral fans"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Combinatorial and Discrete Geometry</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2017, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.3.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>