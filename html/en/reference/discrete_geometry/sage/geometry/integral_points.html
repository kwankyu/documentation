
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Cython helper methods to compute integral points in polyhedra. &#8212; Sage Reference Manual v8.9: Combinatorial and Discrete Geometry</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Helper Functions For Freeness Of Hyperplane Arrangements" href="hyperplane_arrangement/check_freeness.html" />
    <link rel="prev" title="Construction of finite atomic and coatomic lattices from incidences." href="hasse_diagram.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hyperplane_arrangement/check_freeness.html" title="Helper Functions For Freeness Of Hyperplane Arrangements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="hasse_diagram.html" title="Construction of finite atomic and coatomic lattices from incidences."
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Combinatorial and Discrete Geometry</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cython-helper-methods-to-compute-integral-points-in-polyhedra">
<span id="sage-geometry-integral-points"></span><h1>Cython helper methods to compute integral points in polyhedra.<a class="headerlink" href="#cython-helper-methods-to-compute-integral-points-in-polyhedra" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.geometry.integral_points"></span><dl class="class">
<dt id="sage.geometry.integral_points.InequalityCollection">
<em class="property">class </em><code class="descclassname">sage.geometry.integral_points.</code><code class="descname">InequalityCollection</code><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A collection of inequalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">polyhedron</span></code> – a polyhedron defining the inequalities.</li>
<li><code class="docutils literal notranslate"><span class="pre">permutation</span></code> – list; a 0-based permutation of the coordinates.
Will be used to permute the coordinates of the inequality.</li>
<li><code class="docutils literal notranslate"><span class="pre">box_min</span></code>, <code class="docutils literal notranslate"><span class="pre">box_max</span></code> – the (not permuted) minimal and maximal
coordinates of the bounding box. Used for bounds checking.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">P_QQ</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">P_RR</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mf">2.7</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_RR</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (-1, -1) x + 1 &gt;= 0</span>
<span class="go">generic: (-1.0, 3.7) x + 1.0 &gt;= 0</span>
<span class="go">generic: (1.0, -1.35) x + 1.35 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">eqns</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">InequalityCollection</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7) x + 2 &gt;= 0</span>
<span class="go">integer: (-3, -7) x + -2 &gt;= 0</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.are_satisfied">
<code class="descname">are_satisfied</code><span class="sig-paren">(</span><em>inner_loop_variable</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.are_satisfied" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether all inequalities are satisfied.</p>
<p>You must call <a class="reference internal" href="#sage.geometry.integral_points.InequalityCollection.prepare_inner_loop" title="sage.geometry.integral_points.InequalityCollection.prepare_inner_loop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_inner_loop()</span></code></a> before calling this
method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">inner_loop_variable</span></code> – Integer. the 0-th coordinate of
the lattice point.</li>
</ul>
<p>OUTPUT:</p>
<p>Boolean. Whether the lattice point is in the polyhedron.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">line</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">eqns</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">are_satisfied</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.prepare_inner_loop">
<code class="descname">prepare_inner_loop</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.prepare_inner_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Peel off the inner loop.</p>
<p>In the inner loop of <a class="reference internal" href="#sage.geometry.integral_points.rectangular_box_points" title="sage.geometry.integral_points.rectangular_box_points"><code class="xref py py-func docutils literal notranslate"><span class="pre">rectangular_box_points()</span></code></a>, we have
to repeatedly evaluate <span class="math notranslate nohighlight">\(A x+b\geq 0\)</span>. To speed up computation, we pre-evaluate</p>
<div class="math notranslate nohighlight">
\[c = A x - A_0 x_0 +b = b + \sum_{i=1} A_i x_i\]</div>
<p>and only test <span class="math notranslate nohighlight">\(A_0 x_0 +c \geq 0\)</span> in the inner loop.</p>
<p>You must call <a class="reference internal" href="#sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop" title="sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prepare_next_to_inner_loop()</span></code></a> before
calling this method.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – the coordinates of the point to loop over. Only the
<code class="docutils literal notranslate"><span class="pre">p[1:]</span></code> entries are used.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7, 11) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 42 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 35 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop">
<code class="descname">prepare_next_to_inner_loop</code><span class="sig-paren">(</span><em>p</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.prepare_next_to_inner_loop" title="Permalink to this definition">¶</a></dt>
<dd><p>Peel off the next-to-inner loop.</p>
<p>In the next-to-inner loop of <a class="reference internal" href="#sage.geometry.integral_points.rectangular_box_points" title="sage.geometry.integral_points.rectangular_box_points"><code class="xref py py-func docutils literal notranslate"><span class="pre">rectangular_box_points()</span></code></a>,
we have to repeatedly evaluate <span class="math notranslate nohighlight">\(A x-A_0 x_0+b\)</span>. To speed up
computation, we pre-evaluate</p>
<div class="math notranslate nohighlight">
\[c = b + \sum_{i=2} A_i x_i\]</div>
<p>and only compute <span class="math notranslate nohighlight">\(A x-A_0 x_0+b = A_1 x_1 +c \geq 0\)</span> in the
next-to-inner loop.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – the point coordinates. Only <code class="docutils literal notranslate"><span class="pre">p[2:]</span></code> coordinates
are potentially used by this method.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7, 11) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 42 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 35 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.satisfied_as_equalities">
<code class="descname">satisfied_as_equalities</code><span class="sig-paren">(</span><em>inner_loop_variable</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.satisfied_as_equalities" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inequalities (by their index) that are satisfied as
equalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">inner_loop_variable</span></code> – Integer. the 0-th coordinate of
the lattice point.</li>
</ul>
<p>OUTPUT:</p>
<p>A set of integers in ascending order. Each integer is the
index of a H-representation object of the polyhedron (either a
inequality or an equation).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">quadrant</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieqs</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">quadrant</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">frozenset({1})</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">frozenset({0, 1})</span>
<span class="gp">sage: </span><span class="n">ieqs</span><span class="o">.</span><span class="n">satisfied_as_equalities</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">frozenset({1})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.geometry.integral_points.InequalityCollection.swap_ineq_to_front">
<code class="descname">swap_ineq_to_front</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.InequalityCollection.swap_ineq_to_front" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th entry of the list to the front of the list of inequalities.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">i</span></code> – Integer. The <a class="reference internal" href="#sage.geometry.integral_points.Inequality_int" title="sage.geometry.integral_points.Inequality_int"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inequality_int</span></code></a> to swap to the
beginning of the list of integral inequalities.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span>
<span class="gp">sage: </span><span class="n">P_QQ</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">identity_matrix</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span><span class="p">()</span> <span class="o">+</span> <span class="p">[(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P_QQ</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">iec</span><span class="o">.</span><span class="n">swap_ineq_to_front</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">iec</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (-1, -1, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (3, -2, -2) x + 2 &gt;= 0</span>
<span class="go">integer: (-1, 4, -1) x + 1 &gt;= 0</span>
<span class="go">integer: (-1, -1, 4) x + 1 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.geometry.integral_points.Inequality_generic">
<em class="property">class </em><code class="descclassname">sage.geometry.integral_points.</code><code class="descname">Inequality_generic</code><a class="headerlink" href="#sage.geometry.integral_points.Inequality_generic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>An inequality whose coefficients are arbitrary Python/Sage objects</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – list of coefficients</li>
<li><code class="docutils literal notranslate"><span class="pre">b</span></code> – element</li>
</ul>
<p>OUTPUT:</p>
<p>Inequality <span class="math notranslate nohighlight">\(A x + b \geq 0\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">Inequality_generic</span>
<span class="gp">sage: </span><span class="n">Inequality_generic</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="mi">7</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.5</span><span class="p">)</span>
<span class="go">generic: (2*pi, sqrt(3), 7/2) x + -5.50000000000000 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.geometry.integral_points.Inequality_int">
<em class="property">class </em><code class="descclassname">sage.geometry.integral_points.</code><code class="descname">Inequality_int</code><a class="headerlink" href="#sage.geometry.integral_points.Inequality_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Fast version of inequality in the case that all coefficients fit
into machine ints.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code> – list of integers</li>
<li><code class="docutils literal notranslate"><span class="pre">b</span></code> – integer</li>
<li><code class="docutils literal notranslate"><span class="pre">max_abs_coordinates</span></code> – the maximum of the coordinates that
one wants to evaluate the coordinates on; used for overflow
checking</li>
</ul>
<p>OUTPUT:</p>
<p>Inequality <span class="math notranslate nohighlight">\(A x + b \geq 0\)</span>. A <code class="docutils literal notranslate"><span class="pre">OverflowError</span></code> is raised if a
machine integer is not long enough to hold the results. A
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised if some of the input is not integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">Inequality_int</span>
<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="go">integer: (2, 3, 7) x + -5 &gt;= 0</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">21</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">OverflowError: Dimension limit exceeded.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Not integral.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mf">5.2</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: Not integral.</span>

<span class="gp">sage: </span><span class="n">Inequality_int</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># actual error message can differ between 32 and 64 bit</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">OverflowError: ...</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.loop_over_parallelotope_points">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">loop_over_parallelotope_points</code><span class="sig-paren">(</span><em>e</em>, <em>d</em>, <em>VDinv</em>, <em>R</em>, <em>lattice</em>, <em>A=None</em>, <em>b=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.loop_over_parallelotope_points" title="Permalink to this definition">¶</a></dt>
<dd><p>The inner loop of <a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><code class="xref py py-func docutils literal notranslate"><span class="pre">parallelotope_points()</span></code></a>.</p>
<p>INPUT:</p>
<p>See <a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><code class="xref py py-meth docutils literal notranslate"><span class="pre">parallelotope_points()</span></code></a> for <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">VDinv</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span></code>, <code class="docutils literal notranslate"><span class="pre">lattice</span></code>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>: Either both <code class="docutils literal notranslate"><span class="pre">None</span></code> or a vector and number. If
present, only the parallelotope points satisfying <span class="math notranslate nohighlight">\(A x \leq b\)</span>
are returned.</li>
</ul>
<p>OUTPUT:</p>
<p>The points of the half-open parallelotope as a tuple of lattice
points.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">VDinv</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">column_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">lattice</span> <span class="o">=</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">3</span>
<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">loop_over_parallelotope_points</span>
<span class="gp">sage: </span><span class="n">loop_over_parallelotope_points</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">VDinv</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">lattice</span><span class="p">)</span>
<span class="go">((0, 0, 0), (1, 1, 1), (2, 2, 2))</span>

<span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">sage: </span><span class="n">loop_over_parallelotope_points</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">VDinv</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">lattice</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">((0, 0, 0), (1, 1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.parallelotope_points">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">parallelotope_points</code><span class="sig-paren">(</span><em>spanning_points</em>, <em>lattice</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.parallelotope_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return integral points in the parallelotope starting at the origin
and spanned by the <code class="docutils literal notranslate"><span class="pre">spanning_points</span></code>.</p>
<p>See <code class="xref py py-meth docutils literal notranslate"><span class="pre">semigroup_generators()</span></code> for a description of the
algorithm.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">spanning_points</span></code> – a non-empty list of linearly independent
rays (<span class="math notranslate nohighlight">\(\ZZ\)</span>-vectors or <a class="reference internal" href="toric_lattice.html#sage.geometry.toric_lattice.ToricLatticeFactory" title="sage.geometry.toric_lattice.ToricLatticeFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">lattice</span></code></a> elements),
not necessarily primitive lattice points.</li>
</ul>
<p>OUTPUT:</p>
<p>The tuple of all lattice points in the half-open parallelotope
spanned by the rays <span class="math notranslate nohighlight">\(r_i\)</span>,</p>
<div class="math notranslate nohighlight">
\[\mathop{par}(\{r_i\}) =
\sum_{0\leq a_i &lt; 1} a_i r_i\]</div>
<p>By half-open parallelotope, we mean that the
points in the facets not meeting the origin are omitted.</p>
<p>EXAMPLES:</p>
<p>Note how the points on the outward-facing factes are omitted:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">parallelotope_points</span>
<span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="go">((0, 0), (1, 0), (0, 1), (1, 1))</span>
</pre></div>
</div>
<p>The rays can also be toric lattice points:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)]))</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(N(0, 0), N(1, 0), N(0, 1), N(1, 1))</span>
</pre></div>
</div>
<p>A non-smooth cone:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">([</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">])</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">rays</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">lattice</span><span class="p">())</span>
<span class="go">(N(0, 0), N(1, 1))</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised if the <code class="docutils literal notranslate"><span class="pre">spanning_points</span></code> are not
linearly independent:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">parallelotope_points</span><span class="p">(</span><span class="n">rays</span><span class="p">,</span> <span class="n">ToricLattice</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: The spanning points are not linearly independent!</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.print_cache">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">print_cache</code><span class="sig-paren">(</span><em>inequality_collection</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.print_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the cached values in <a class="reference internal" href="#sage.geometry.integral_points.Inequality_int" title="sage.geometry.integral_points.Inequality_int"><code class="xref py py-class docutils literal notranslate"><span class="pre">Inequality_int</span></code></a> (for
debugging/doctesting only).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">InequalityCollection</span><span class="p">,</span> <span class="n">print_cache</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">ieq</span> <span class="o">=</span> <span class="n">InequalityCollection</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">,[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span> <span class="n">ieq</span>
<span class="go">The collection of inequalities</span>
<span class="go">integer: (3, 7) x + 2 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_next_to_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ieq</span><span class="o">.</span><span class="n">prepare_inner_loop</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">print_cache</span><span class="p">(</span><span class="n">ieq</span><span class="p">)</span>
<span class="go">Cached inner loop: 3 * x_0 + 37 &gt;= 0</span>
<span class="go">Cached next-to-inner loop: 3 * x_0 + 7 * x_1 + 2 &gt;= 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.ray_matrix_normal_form">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">ray_matrix_normal_form</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.ray_matrix_normal_form" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Smith normal form of the ray matrix for
<a class="reference internal" href="#sage.geometry.integral_points.parallelotope_points" title="sage.geometry.integral_points.parallelotope_points"><code class="xref py py-func docutils literal notranslate"><span class="pre">parallelotope_points()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">R</span></code> – <span class="math notranslate nohighlight">\(\ZZ\)</span>-matrix whose columns are the rays spanning the
parallelotope.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple containing <code class="docutils literal notranslate"><span class="pre">e</span></code>, <code class="docutils literal notranslate"><span class="pre">d</span></code>, and <code class="docutils literal notranslate"><span class="pre">VDinv</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">ray_matrix_normal_form</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">column_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ray_matrix_normal_form</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="go">([3], 3, [1])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.rectangular_box_points">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">rectangular_box_points</code><span class="sig-paren">(</span><em>box_min</em>, <em>box_max</em>, <em>polyhedron=None</em>, <em>count_only=False</em>, <em>return_saturated=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.rectangular_box_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral points in the lattice bounding box that are
also contained in the given polyhedron.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">box_min</span></code> – A list of integers. The minimal value for each
coordinate of the rectangular bounding box.</li>
<li><code class="docutils literal notranslate"><span class="pre">box_max</span></code> – A list of integers. The maximal value for each
coordinate of the rectangular bounding box.</li>
<li><code class="docutils literal notranslate"><span class="pre">polyhedron</span></code> – A
<a class="reference internal" href="polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="sage.geometry.polyhedron.base.Polyhedron_base"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyhedron_base</span></code></a>, a PPL
<a class="reference external" href="/home/user/sage-git/local/share/doc/pplpy/index.html#ppl.polyhedron.C_Polyhedron" title="(in pplpy v0.8.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">C_Polyhedron</span></code></a>, or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</li>
<li><code class="docutils literal notranslate"><span class="pre">count_only</span></code> – Boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>). Whether to
return only the total number of vertices, and not their
coordinates. Enabling this option speeds up the
enumeration. Cannot be combined with the <code class="docutils literal notranslate"><span class="pre">return_saturated</span></code>
option.</li>
<li><code class="docutils literal notranslate"><span class="pre">return_saturated</span></code> – Boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>. Whether to
also return which inequalities are saturated for each point of
the polyhedron. Enabling this slows down the enumeration. Cannot
be combined with the <code class="docutils literal notranslate"><span class="pre">count_only</span></code> option.</li>
</ul>
<p>OUTPUT:</p>
<p>By default, this function returns a tuple containing the integral
points of the rectangular box spanned by <code class="docutils literal notranslate"><span class="pre">box_min</span></code> and <code class="docutils literal notranslate"><span class="pre">box_max</span></code>
and that lie inside the <code class="docutils literal notranslate"><span class="pre">polyhedron</span></code>. For sufficiently large
bounding boxes, this are all integral points of the polyhedron.</p>
<p>If no polyhedron is specified, all integral points of the
rectangular box are returned.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">count_only</span></code> is specified, only the total number (an integer)
of found lattice points is returned.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">return_saturated</span></code> is enabled, then for each integral point a
pair <code class="docutils literal notranslate"><span class="pre">(point,</span> <span class="pre">Hrep)</span></code> is returned where <code class="docutils literal notranslate"><span class="pre">point</span></code> is the point
and <code class="docutils literal notranslate"><span class="pre">Hrep</span></code> is the set of indices of the H-representation objects
that are saturated at the point.</p>
<p>ALGORITHM:</p>
<p>This function implements the naive algorithm towards counting
integral points. Given min and max of vertex coordinates, it
iterates over all points in the bounding box and checks whether
they lie in the polyhedron. The following optimizations are
implemented:</p>
<ul>
<li><p class="first">Cython: Use machine integers and optimizing C/C++ compiler
where possible, arbitrary precision integers where necessary.
Bounds checking, no compile time limits.</p>
</li>
<li><p class="first">Unwind inner loop (and next-to-inner loop):</p>
<div class="math notranslate nohighlight">
\[Ax \leq b
\quad \Leftrightarrow \quad
a_1 x_1 ~\leq~ b - \sum_{i=2}^d a_i x_i\]</div>
<p>so we only have to evaluate <span class="math notranslate nohighlight">\(a_1 * x_1\)</span> in the inner loop.</p>
</li>
<li><p class="first">Coordinates are permuted to make the longest box edge the
inner loop. The inner loop is optimized to run very fast, so
its best to do as much work as possible there.</p>
</li>
<li><p class="first">Continuously reorder inequalities and test the most
restrictive inequalities first.</p>
</li>
<li><p class="first">Use convexity and only find first and last allowed point in
the inner loop. The points in-between must be points of the
polyhedron, too.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">rectangular_box_points</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">((0, 0, 0), (0, 0, 1), (0, 0, 2), (0, 0, 3),</span>
<span class="go"> (0, 1, 0), (0, 1, 1), (0, 1, 2), (0, 1, 3),</span>
<span class="go"> (0, 2, 0), (0, 2, 1), (0, 2, 2), (0, 2, 3),</span>
<span class="go"> (1, 0, 0), (1, 0, 1), (1, 0, 2), (1, 0, 3),</span>
<span class="go"> (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 1, 3),</span>
<span class="go"> (1, 2, 0), (1, 2, 1), (1, 2, 2), (1, 2, 3))</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">rectangular_box_points</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">count_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">24</span>

<span class="gp">sage: </span><span class="n">cell24</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">twenty_four_cell</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">cell24</span><span class="p">)</span>
<span class="go">((-1, 0, 0, 0), (0, -1, 0, 0), (0, 0, -1, 0), (0, 0, 0, -1),</span>
<span class="go"> (0, 0, 0, 0),</span>
<span class="go"> (0, 0, 0, 1), (0, 0, 1, 0), (0, 1, 0, 0), (1, 0, 0, 0))</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">dilated_cell24</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">cell24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">)</span> <span class="p">)</span>
<span class="go">305</span>

<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="mi">6</span>
<span class="gp">sage: </span><span class="n">dilated_cell24</span> <span class="o">=</span> <span class="n">d</span><span class="o">*</span><span class="n">cell24</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">)</span> <span class="p">)</span>
<span class="go">3625</span>

<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="n">d</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">dilated_cell24</span><span class="p">,</span> <span class="n">count_only</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">3625</span>

<span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">pts</span> <span class="o">=</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">polytope</span><span class="p">);</span> <span class="n">pts</span>
<span class="go">((-4, -3, -2, -1), (-1, 0, 0, 1), (0, 1, 1, 1), (1, 1, 1, 1), (1, 1, 3, 0),</span>
<span class="go"> (1, 2, 1, 1), (1, 2, 2, 2), (1, 3, 2, 4), (2, 1, 1, 1), (3, 1, 1, 1))</span>
<span class="gp">sage: </span><span class="nb">all</span><span class="p">(</span><span class="n">polytope</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">)</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span><span class="n">pts</span><span class="p">))</span> <span class="o">==</span> \
<span class="gp">....: </span><span class="nb">set</span><span class="p">([(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
<span class="gp">....: </span>     <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)])</span>   <span class="c1"># computed with PALP</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Long ints and non-integral polyhedra are explicitly allowed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">polytope</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="n">pi</span><span class="o">.</span><span class="n">n</span><span class="p">()]],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">RDF</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span><span class="p">],</span> <span class="n">polytope</span><span class="p">)</span> <span class="p">)</span>
<span class="go">31</span>

<span class="gp">sage: </span><span class="n">halfplane</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">(</span><span class="n">ieqs</span><span class="o">=</span><span class="p">[(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">])</span>
<span class="go">((0, 99999999999999999999999999999999999999999999999999),</span>
<span class="go"> (0, 100000000000000000000000000000000000000000000000000),</span>
<span class="go"> (0, 100000000000000000000000000000000000000000000000001))</span>
<span class="gp">sage: </span><span class="nb">len</span><span class="p">(</span> <span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="o">+</span><span class="mi">10</span><span class="o">^</span><span class="mi">50</span><span class="p">],</span> <span class="n">halfplane</span><span class="p">)</span> <span class="p">)</span>
<span class="go">201</span>
</pre></div>
</div>
<p>Using a PPL polyhedron:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">ppl</span> <span class="kn">import</span> <span class="n">Variable</span><span class="p">,</span> <span class="n">Generator_System</span><span class="p">,</span> <span class="n">C_Polyhedron</span><span class="p">,</span> <span class="n">point</span>
<span class="gp">sage: </span><span class="n">gs</span> <span class="o">=</span> <span class="n">Generator_System</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">y</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="n">z</span> <span class="o">=</span> <span class="n">Variable</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">0</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">gs</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">point</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">z</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">poly</span> <span class="o">=</span> <span class="n">C_Polyhedron</span><span class="p">(</span><span class="n">gs</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">poly</span><span class="p">)</span>
<span class="go">((0, 1, 0), (0, 1, 1), (0, 1, 2), (0, 1, 3), (1, 1, 0), (1, 1, 1), (1, 1, 2), (1, 1, 3),</span>
<span class="go"> (2, 1, 0), (2, 1, 1), (2, 1, 2), (2, 1, 3), (3, 1, 0), (3, 1, 1), (3, 1, 2), (3, 1, 3))</span>
</pre></div>
</div>
<p>Optionally, return the information about the saturated inequalities as well:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cube</span> <span class="o">=</span> <span class="n">polytopes</span><span class="o">.</span><span class="n">cube</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">An inequality (0, 0, -1) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">An inequality (0, -1, 0) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">cube</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">An inequality (-1, 0, 0) x + 1 &gt;= 0</span>
<span class="gp">sage: </span><span class="n">rectangular_box_points</span><span class="p">([</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="n">cube</span><span class="p">,</span> <span class="n">return_saturated</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(((0, 0, 0), frozenset()),</span>
<span class="go"> ((0, 0, 1), frozenset({0})),</span>
<span class="go"> ((0, 1, 0), frozenset({1})),</span>
<span class="go"> ((0, 1, 1), frozenset({0, 1})),</span>
<span class="go"> ((1, 0, 0), frozenset({2})),</span>
<span class="go"> ((1, 0, 1), frozenset({0, 2})),</span>
<span class="go"> ((1, 1, 0), frozenset({1, 2})),</span>
<span class="go"> ((1, 1, 1), frozenset({0, 1, 2})))</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.geometry.integral_points.simplex_points">
<code class="descclassname">sage.geometry.integral_points.</code><code class="descname">simplex_points</code><span class="sig-paren">(</span><em>vertices</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.geometry.integral_points.simplex_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integral points in a lattice simplex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">vertices</span></code> – an iterable of integer coordinate vectors. The
indices of vertices that span the simplex under
consideration.</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple containing the integral point coordinates as <span class="math notranslate nohighlight">\(\ZZ\)</span>-vectors.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.geometry.integral_points</span> <span class="kn">import</span> <span class="n">simplex_points</span>
<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">)])</span>
<span class="go">((-2, -3, -11), (0, 0, -2), (1, 2, 3), (2, 3, 7))</span>
</pre></div>
</div>
<p>The simplex need not be full-dimensional:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">simplex</span> <span class="o">=</span> <span class="n">Polyhedron</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">(</span><span class="n">simplex</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">())</span>
<span class="go">((2, 3, 7, 5), (0, 0, -2, 5), (-2, -3, -11, 5), (1, 2, 3, 5))</span>

<span class="gp">sage: </span><span class="n">simplex_points</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="go">((2, 3, 7),)</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="hasse_diagram.html"
                        title="previous chapter">Construction of finite atomic and coatomic lattices from incidences.</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hyperplane_arrangement/check_freeness.html"
                        title="next chapter">Helper Functions For Freeness Of Hyperplane Arrangements</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/geometry/integral_points.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hyperplane_arrangement/check_freeness.html" title="Helper Functions For Freeness Of Hyperplane Arrangements"
             >next</a> |</li>
        <li class="right" >
          <a href="hasse_diagram.html" title="Construction of finite atomic and coatomic lattices from incidences."
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Combinatorial and Discrete Geometry</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>