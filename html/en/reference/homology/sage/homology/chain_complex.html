
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Chain complexes &#8212; Sage Reference Manual v8.8: Cell complexes and their homology</title>
    <link rel="stylesheet" href="../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Chains and cochains" href="chains.html" />
    <link rel="prev" title="Cell complexes and their homology" href="../../index.html" />
    <link rel="icon" href="../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="chains.html" title="Chains and cochains"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Cell complexes and their homology"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cell complexes and their homology</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="chain-complexes">
<span id="sage-homology-chain-complex"></span><h1>Chain complexes<a class="headerlink" href="#chain-complexes" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.homology.chain_complex"></span><p>AUTHORS:</p>
<ul class="simple">
<li>John H. Palmieri (2009-04)</li>
</ul>
<p>This module implements bounded chain complexes of free <span class="math notranslate nohighlight">\(R\)</span>-modules,
for any commutative ring <span class="math notranslate nohighlight">\(R\)</span> (although the interesting things, like
homology, only work if <span class="math notranslate nohighlight">\(R\)</span> is the integers or a field).</p>
<p>Fix a ring <span class="math notranslate nohighlight">\(R\)</span>.  A chain complex over <span class="math notranslate nohighlight">\(R\)</span> is a collection of
<span class="math notranslate nohighlight">\(R\)</span>-modules <span class="math notranslate nohighlight">\(\{C_n\}\)</span> indexed by the integers, with <span class="math notranslate nohighlight">\(R\)</span>-module maps
<span class="math notranslate nohighlight">\(d_n : C_n \rightarrow C_{n+1}\)</span> such that <span class="math notranslate nohighlight">\(d_{n+1} \circ d_n = 0\)</span> for
all <span class="math notranslate nohighlight">\(n\)</span>.  The maps <span class="math notranslate nohighlight">\(d_n\)</span> are called <em>differentials</em>.</p>
<p>One can vary this somewhat: the differentials may decrease degree by
one instead of increasing it: sometimes a chain complex is defined
with <span class="math notranslate nohighlight">\(d_n : C_n \rightarrow C_{n-1}\)</span> for each <span class="math notranslate nohighlight">\(n\)</span>. Indeed, the
differentials may change dimension by any fixed integer.</p>
<p>Also, the modules may be indexed over an abelian group other than the
integers, e.g., <span class="math notranslate nohighlight">\(\ZZ^{m}\)</span> for some integer <span class="math notranslate nohighlight">\(m \geq 1\)</span>, in which case
the differentials may change the grading by any element of that
grading group. The elements of the grading group are generally called
degrees, so <span class="math notranslate nohighlight">\(C_n\)</span> is the module in degree <span class="math notranslate nohighlight">\(n\)</span> and so on.</p>
<p>In this implementation, the ring <span class="math notranslate nohighlight">\(R\)</span> must be commutative and the
modules <span class="math notranslate nohighlight">\(C_n\)</span> must be free <span class="math notranslate nohighlight">\(R\)</span>-modules.  As noted above, homology
calculations will only work if the ring <span class="math notranslate nohighlight">\(R\)</span> is either <span class="math notranslate nohighlight">\(\ZZ\)</span> or a
field.  The modules may be indexed by any free abelian group.  The
differentials may increase degree by 1 or decrease it, or indeed
change it by any fixed amount: this is controlled by the
<code class="docutils literal notranslate"><span class="pre">degree_of_differential</span></code> parameter used in defining the chain
complex.</p>
<dl class="function">
<dt id="sage.homology.chain_complex.ChainComplex">
<code class="descclassname">sage.homology.chain_complex.</code><code class="descname">ChainComplex</code><span class="sig-paren">(</span><em>data=None</em>, <em>base_ring=None</em>, <em>grading_group=None</em>, <em>degree_of_differential=1</em>, <em>degree=1</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a chain complex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">data</span></code> – the data defining the chain complex; see below for
more details.</li>
</ul>
<p>The following keyword arguments are supported:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a commutative ring (optional), the ring over
which the chain complex is defined. If this is not specified,
it is determined by the data defining the chain complex.</li>
<li><code class="docutils literal notranslate"><span class="pre">grading_group</span></code> – a additive free abelian group (optional,
default <code class="docutils literal notranslate"><span class="pre">ZZ</span></code>), the group over which the chain complex is
indexed.</li>
<li><code class="docutils literal notranslate"><span class="pre">degree_of_differential</span></code> – element of grading_group
(optional, default <code class="docutils literal notranslate"><span class="pre">1</span></code>). The degree of the differential.</li>
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> – alias for <code class="docutils literal notranslate"><span class="pre">degree_of_differential</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> – boolean (optional, default <code class="docutils literal notranslate"><span class="pre">True</span></code>). If <code class="docutils literal notranslate"><span class="pre">True</span></code>,
check that each consecutive pair of differentials are
composable and have composite equal to zero.</li>
</ul>
<p>OUTPUT:</p>
<p>A chain complex.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Right now, homology calculations will only work if the base
ring is either <span class="math notranslate nohighlight">\(\ZZ\)</span> or a field, so please take this into account
when defining a chain complex.</p>
</div>
<p>Use data to define the chain complex.  This may be in any of the
following forms.</p>
<ol class="arabic simple">
<li>a dictionary with integers (or more generally, elements of
grading_group) for keys, and with <code class="docutils literal notranslate"><span class="pre">data[n]</span></code> a matrix representing
(via left multiplication) the differential coming from degree
<span class="math notranslate nohighlight">\(n\)</span>.  (Note that the shape of the matrix then determines the
rank of the free modules <span class="math notranslate nohighlight">\(C_n\)</span> and <span class="math notranslate nohighlight">\(C_{n+d}\)</span>.)</li>
<li>a list/tuple/iterable of the form <span class="math notranslate nohighlight">\([C_0, d_0, C_1, d_1, C_2,
d_2, ...]\)</span>, where each <span class="math notranslate nohighlight">\(C_i\)</span> is a free module and each <span class="math notranslate nohighlight">\(d_i\)</span> is
a matrix, as above.  This only makes sense if <code class="docutils literal notranslate"><span class="pre">grading_group</span></code>
is <span class="math notranslate nohighlight">\(\ZZ\)</span> and <code class="docutils literal notranslate"><span class="pre">degree</span></code> is 1.</li>
<li>a list/tuple/iterable of the form <span class="math notranslate nohighlight">\([r_0, d_0, r_1, d_1, r_2,
d_2, \ldots]\)</span>, where <span class="math notranslate nohighlight">\(r_i\)</span> is the rank of the free module <span class="math notranslate nohighlight">\(C_i\)</span>
and each <span class="math notranslate nohighlight">\(d_i\)</span> is a matrix, as above.  This only makes sense if
<code class="docutils literal notranslate"><span class="pre">grading_group</span></code> is <span class="math notranslate nohighlight">\(\ZZ\)</span> and <code class="docutils literal notranslate"><span class="pre">degree</span></code> is 1.</li>
<li>a list/tuple/iterable of the form <span class="math notranslate nohighlight">\([d_0, d_1, d_2, \ldots]\)</span> where
each <span class="math notranslate nohighlight">\(d_i\)</span> is a matrix, as above.  This only makes sense if
<code class="docutils literal notranslate"><span class="pre">grading_group</span></code> is <span class="math notranslate nohighlight">\(\ZZ\)</span> and <code class="docutils literal notranslate"><span class="pre">degree</span></code> is 1.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In fact, the free modules <span class="math notranslate nohighlight">\(C_i\)</span> in case 2 and the ranks <span class="math notranslate nohighlight">\(r_i\)</span>
in case 3 are ignored: only the matrices are kept, and from
their shapes, the ranks of the modules are determined.
(Indeed, if <code class="docutils literal notranslate"><span class="pre">data</span></code> is a list or tuple, then any element which
is not a matrix is discarded; thus the list may have any number
of different things in it, and all of the non-matrices will be
ignored.)  No error checking is done to make sure, for
instance, that the given modules have the appropriate ranks for
the given matrices.  However, as long as <code class="docutils literal notranslate"><span class="pre">check</span></code> is True, the
code checks to see if the matrices are composable and that each
appropriate composite is zero.</p>
</div>
<p>If the base ring is not specified, then the matrices are examined
to determine a ring over which they are all naturally defined, and
this becomes the base ring for the complex.  If no such ring can
be found, an error is raised.  If the base ring is specified, then
the matrices are converted automatically to this ring when
defining the chain complex.  If some matrix cannot be converted,
then an error is raised.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ChainComplex</span><span class="p">()</span>
<span class="go">Trivial chain complex over Integer Ring</span>

<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">C</span>
<span class="go">Chain complex with at most 2 nonzero terms over Integer Ring</span>

<span class="gp">sage: </span><span class="n">m</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">([</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">));</span> <span class="n">D</span>
<span class="go">Chain complex with at most 3 nonzero terms over Finite Field of size 2</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">==</span> <span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">==</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">(),</span> <span class="n">D</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_immutable</span><span class="p">()</span>
<span class="go">(True, False, True)</span>
</pre></div>
</div>
<p>Note that when a chain complex is defined in Sage, new
differentials may be created: every nonzero module in the chain
complex must have a differential coming from it, even if that
differential is zero:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">IZ</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">diff</span> <span class="o">=</span> <span class="n">IZ</span><span class="o">.</span><span class="n">differential</span><span class="p">()</span>  <span class="c1"># the differentials in the chain complex</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">([], [1], [])</span>
<span class="gp">sage: </span><span class="n">IZ</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Full MatrixSpace of 0 by 1 dense matrices over Integer Ring</span>
<span class="gp">sage: </span><span class="n">mat</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">mat</span><span class="o">.</span><span class="n">nrows</span><span class="p">(),</span> <span class="n">mat</span><span class="o">.</span><span class="n">ncols</span><span class="p">()</span>
<span class="go">(0, 3)</span>
</pre></div>
</div>
<p>Defining the base ring implicitly:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="go">Chain complex with at most 3 nonzero terms over Rational Field</span>
<span class="gp">sage: </span><span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="go">Chain complex with at most 3 nonzero terms over Finite Field in a of size 5^3</span>
</pre></div>
</div>
<p>If the matrices are defined over incompatible rings, an error results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">matrix</span><span class="p">(</span><span class="n">QQ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)])</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: no common canonical parent for objects with parents: &#39;Finite Field in a of size 5^3&#39; and &#39;Rational Field&#39;</span>
</pre></div>
</div>
<p>If the base ring is given explicitly but is not compatible with
the matrices, an error results:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">125</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: unable to convert 0 to a rational</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.homology.chain_complex.ChainComplex_class">
<em class="property">class </em><code class="descclassname">sage.homology.chain_complex.</code><code class="descname">ChainComplex_class</code><span class="sig-paren">(</span><em>grading_group</em>, <em>degree_of_differential</em>, <em>base_ring</em>, <em>differentials</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/parent.html#sage.structure.parent.Parent" title="(in Sage Reference Manual: Parents and Elements v8.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.parent.Parent</span></code></a></p>
<p>See <a class="reference internal" href="#sage.homology.chain_complex.ChainComplex" title="sage.homology.chain_complex.ChainComplex"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChainComplex()</span></code></a> for full documentation.</p>
<p>The differentials are required to be in the following canonical form:</p>
<ul class="simple">
<li>All differentials that are not <span class="math notranslate nohighlight">\(0 \times 0\)</span> must be specified
(even if they have zero rows or zero columns), and</li>
<li>Differentials that are <span class="math notranslate nohighlight">\(0 \times 0\)</span> must not be specified.</li>
<li>Immutable matrices over the <code class="docutils literal notranslate"><span class="pre">base_ring</span></code></li>
</ul>
<p>This and more is ensured by the assertions in the
constructor. The <a class="reference internal" href="#sage.homology.chain_complex.ChainComplex" title="sage.homology.chain_complex.ChainComplex"><code class="xref py py-func docutils literal notranslate"><span class="pre">ChainComplex()</span></code></a> factory function must
ensure that only valid input is passed.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">();</span> <span class="n">C</span>
<span class="go">Trivial chain complex over Integer Ring</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">D</span>
<span class="go">Chain complex with at most 2 nonzero terms over Integer Ring</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.homology.chain_complex.ChainComplex_class.Element">
<code class="descname">Element</code><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#sage.homology.chain_complex.Chain_class" title="sage.homology.chain_complex.Chain_class"><code class="xref py py-class docutils literal notranslate"><span class="pre">Chain_class</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.betti">
<code class="descname">betti</code><span class="sig-paren">(</span><em>deg=None</em>, <em>base_ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.betti" title="Permalink to this definition">¶</a></dt>
<dd><p>The Betti number the chain complex.</p>
<p>That is, write the homology in this degree as a direct sum
of a free module and a torsion module; the Betti number is the
rank of the free summand.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">deg</span></code> – an element of the grading group for the chain
complex or None (default <code class="docutils literal notranslate"><span class="pre">None</span></code>); if <code class="docutils literal notranslate"><span class="pre">None</span></code>,
then return every Betti number, as a dictionary indexed by
degree, or if an element of the grading group, then return
the Betti number in that degree</li>
<li><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a commutative ring (optional, default is the
base ring for the chain complex); compute homology with
these coefficients – must be either the integers or a
field</li>
</ul>
<p>OUTPUT:</p>
<p>The Betti number in degree <code class="docutils literal notranslate"><span class="pre">deg</span></code> – the rank of the free
part of the homology module in this degree.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">betti</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">betti</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
<span class="go">[2, 1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">{0: 2, 1: 1}</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">betti</span><span class="p">()</span>
<span class="go">{0: 1, 1: 1}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.cartesian_product">
<code class="descname">cartesian_product</code><span class="sig-paren">(</span><em>*factors</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.cartesian_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the direct sum (Cartesian product) of <code class="docutils literal notranslate"><span class="pre">self</span></code> with <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span> be two chain complexes with differentials
<span class="math notranslate nohighlight">\(\partial_C\)</span> and <span class="math notranslate nohighlight">\(\partial_D\)</span>, respectively, of the same degree (so
they must also have the same grading group).
The direct sum <span class="math notranslate nohighlight">\(S = C \oplus D\)</span> is a chain complex given by
<span class="math notranslate nohighlight">\(S_i = C_i \oplus D_i\)</span> with differential
<span class="math notranslate nohighlight">\(\partial = \partial_C \oplus \partial_D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) whether to subdivide the
the differential matrices</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="n">y</span><span class="p">],[</span><span class="n">x</span><span class="p">]]),</span> <span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]])])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">]]),</span> <span class="n">matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">]])])</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">D</span><span class="p">))</span>
<span class="go">            [x y 0]       [   -y     0]</span>
<span class="go">            [0 0 0]       [    x     0]</span>
<span class="go">            [0 0 0]       [    0 x - y]</span>
<span class="go"> 0 &lt;-- C_2 &lt;-------- C_1 &lt;-------------- C_0 &lt;-- 0</span>

<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">]]),</span> <span class="mi">4</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">            [x]</span>
<span class="go">            [y]                     [x - y]</span>
<span class="go"> 0 &lt;-- C_5 &lt;---- C_4 &lt;-- 0 &lt;-- C_2 &lt;-------- C_1 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">cartesian_product</span><span class="p">([</span><span class="n">C</span><span class="p">,</span> <span class="n">D</span><span class="p">]))</span>
<span class="go">                                                              [-y]</span>
<span class="go">            [x]                     [    x     y     0]       [ x]</span>
<span class="go">            [y]                     [    0     0 x - y]       [ 0]</span>
<span class="go"> 0 &lt;-- C_5 &lt;---- C_4 &lt;-- 0 &lt;-- C_2 &lt;-------------------- C_1 &lt;----- C_0 &lt;-- 0</span>
</pre></div>
</div>
<p>The degrees of the differentials must agree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the degrees of the differentials must match</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">y</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">C3</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">z</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">cartesian_product</span><span class="p">([</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">]))</span>
<span class="go">            [x 0 0]</span>
<span class="go">            [0 y 0]</span>
<span class="go">            [0 0 z]</span>
<span class="go"> 0 &lt;-- C_2 &lt;-------- C_1 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C1</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">([</span><span class="n">C2</span><span class="p">,</span> <span class="n">C3</span><span class="p">],</span> <span class="n">subdivide</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
<span class="go">            [x|0|0]</span>
<span class="go">            [-+-+-]</span>
<span class="go">            [0|y|0]</span>
<span class="go">            [-+-+-]</span>
<span class="go">            [0|0|z]</span>
<span class="go"> 0 &lt;-- C_2 &lt;-------- C_1 &lt;-- 0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">AdditiveAbelianGroup</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])):</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])}</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">grading_group</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C</span><span class="o">.</span><span class="n">cartesian_product</span><span class="p">(</span><span class="n">C</span><span class="p">))</span>
<span class="go">                 [x 0]</span>
<span class="go">                 [0 x]</span>
<span class="go"> 0 &lt;-- C_(3, 2) &lt;------ C_(1, 1) &lt;-- 0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.degree_of_differential">
<code class="descname">degree_of_differential</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.degree_of_differential" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degree of the differentials of the complex</p>
<p>OUTPUT:</p>
<p>An element of the grading group.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">degree_of_differential</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.differential">
<code class="descname">differential</code><span class="sig-paren">(</span><em>dim=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.differential" title="Permalink to this definition">¶</a></dt>
<dd><p>The differentials which make up the chain complex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">dim</span></code> – element of the grading group (optional, default
<code class="docutils literal notranslate"><span class="pre">None</span></code>); if this is <code class="docutils literal notranslate"><span class="pre">None</span></code>, return a dictionary of all
of the differentials, or if this is a single element, return
the differential starting in that dimension</li>
</ul>
<p>OUTPUT:</p>
<p>Either a dictionary of all of the differentials or a single
differential (i.e., a matrix).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1 0]</span>
<span class="go">[0 2]</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">40</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">diff</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">differential</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">40 x 0 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">40 x 40 dense matrix over Integer Ring (use the &#39;.str()&#39; method to see the entries)</span>
<span class="gp">sage: </span><span class="n">diff</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.dual">
<code class="descname">dual</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.dual" title="Permalink to this definition">¶</a></dt>
<dd><p>The dual chain complex to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>Since all modules in <code class="docutils literal notranslate"><span class="pre">self</span></code> are free of finite rank, the
dual in dimension <span class="math notranslate nohighlight">\(n\)</span> is isomorphic to the original chain
complex in dimension <span class="math notranslate nohighlight">\(n\)</span>, and the corresponding boundary
matrix is the transpose of the matrix in the original complex.
This converts a chain complex to a cochain complex and vice versa.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">degree_of_differential</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[3 0 0]</span>
<span class="go">[0 0 0]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">degree_of_differential</span><span class="p">()</span>
<span class="go">-1</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[3 0]</span>
<span class="go">[0 0]</span>
<span class="go">[0 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.free_module">
<code class="descname">free_module</code><span class="sig-paren">(</span><em>degree=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.free_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the free module at fixed <code class="docutils literal notranslate"><span class="pre">degree</span></code>, or their sum.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> – an element of the grading group or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default).</li>
</ul>
<p>OUTPUT:</p>
<p>The free module <span class="math notranslate nohighlight">\(C_n\)</span> at the given degree <span class="math notranslate nohighlight">\(n\)</span>. If the degree
is not specified, the sum <span class="math notranslate nohighlight">\(\bigoplus C_n\)</span> is returned.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">free_module</span><span class="p">()</span>
<span class="go">Ambient free module of rank 6 over the principal ideal domain Integer Ring</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">free_module</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">Ambient free module of rank 3 over the principal ideal domain Integer Ring</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">free_module</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Ambient free module of rank 2 over the principal ideal domain Integer Ring</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">free_module</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">Ambient free module of rank 1 over the principal ideal domain Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.free_module_rank">
<code class="descname">free_module_rank</code><span class="sig-paren">(</span><em>degree</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.free_module_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rank of the free module at the given <code class="docutils literal notranslate"><span class="pre">degree</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> – an element of the grading group</li>
</ul>
<p>OUTPUT:</p>
<p>Integer. The rank of the free module <span class="math notranslate nohighlight">\(C_n\)</span> at the given degree
<span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">C</span><span class="o">.</span><span class="n">free_module_rank</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>
<span class="go">[0, 0, 3, 2, 1, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.grading_group">
<code class="descname">grading_group</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.grading_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the grading group.</p>
<p>OUTPUT:</p>
<p>The discrete abelian group that indexes the individual modules
of the complex. Usually <span class="math notranslate nohighlight">\(\ZZ\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">AdditiveAbelianGroup</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">(</span><span class="n">grading_group</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">grading_group</span><span class="p">()</span>
<span class="go">Additive abelian group isomorphic to Z + Z/3</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">degree_of_differential</span><span class="p">()</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.homology">
<code class="descname">homology</code><span class="sig-paren">(</span><em>deg=None</em>, <em>base_ring=None</em>, <em>generators=False</em>, <em>verbose=False</em>, <em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.homology" title="Permalink to this definition">¶</a></dt>
<dd><p>The homology of the chain complex.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">deg</span></code> – an element of the grading group for the chain
complex (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); the degree in which
to compute homology – if this is <code class="docutils literal notranslate"><span class="pre">None</span></code>, return the
homology in every degree in which the chain complex is
possibly nonzero.</li>
<li><code class="docutils literal notranslate"><span class="pre">base_ring</span></code> – a commutative ring (optional, default is the
base ring for the chain complex); must be either the
integers <span class="math notranslate nohighlight">\(\ZZ\)</span> or a field</li>
<li><code class="docutils literal notranslate"><span class="pre">generators</span></code> – boolean (optional, default <code class="docutils literal notranslate"><span class="pre">False</span></code>); if
<code class="docutils literal notranslate"><span class="pre">True</span></code>, return generators for the homology groups along with
the groups. See <a class="reference external" href="https://trac.sagemath.org/6100">trac ticket #6100</a></li>
<li><code class="docutils literal notranslate"><span class="pre">verbose</span></code> - boolean (optional, default <code class="docutils literal notranslate"><span class="pre">False</span></code>); if
<code class="docutils literal notranslate"><span class="pre">True</span></code>, print some messages as the homology is computed</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> - string (optional, default <code class="docutils literal notranslate"><span class="pre">'pari'</span></code>); the
options are:<ul>
<li><code class="docutils literal notranslate"><span class="pre">'auto'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'chomp'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'dhsw'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'pari'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'no_chomp'</span></code></li>
</ul>
</li>
</ul>
<p>see below for descriptions</p>
<p>OUTPUT:</p>
<p>If the degree is specified, the homology in degree <code class="docutils literal notranslate"><span class="pre">deg</span></code>.
Otherwise, the homology in every dimension as a dictionary
indexed by dimension.</p>
<p>ALGORITHM:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> is set to <code class="docutils literal notranslate"><span class="pre">'auto'</span></code>, then use
CHomP if available. CHomP is available at the web page
<a class="reference external" href="http://chomp.rutgers.edu/">http://chomp.rutgers.edu/</a>.  It is also an optional package
for Sage. If <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> is <code class="docutils literal notranslate"><span class="pre">chomp</span></code>, always use chomp.</p>
<p>CHomP computes homology, not cohomology, and only works over
the integers or finite prime fields.  Therefore if any of
these conditions fails, or if CHomP is not present, or if
<code class="docutils literal notranslate"><span class="pre">algorithm</span></code> is set to ‘no_chomp’, go to plan B: if <code class="docutils literal notranslate"><span class="pre">self</span></code>
has a <code class="docutils literal notranslate"><span class="pre">_homology</span></code> method – each simplicial complex has
this, for example – then call that.  Such a method implements
specialized algorithms for the particular type of cell
complex.</p>
<p>Otherwise, move on to plan C: compute the chain complex of
<code class="docutils literal notranslate"><span class="pre">self</span></code> and compute its homology groups.  To do this: over a
field, just compute ranks and nullities, thus obtaining
dimensions of the homology groups as vector spaces.  Over the
integers, compute Smith normal form of the boundary matrices
defining the chain complex according to the value of
<code class="docutils literal notranslate"><span class="pre">algorithm</span></code>.  If <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> is <code class="docutils literal notranslate"><span class="pre">'auto'</span></code> or <code class="docutils literal notranslate"><span class="pre">'no_chomp'</span></code>,
then for each relatively small matrix, use the standard Sage
method, which calls the Pari package.  For any large matrix,
reduce it using the Dumas, Heckenbach, Saunders, and Welker
elimination algorithm <a class="reference internal" href="../../../references/index.html#dhsw2003" id="id1">[DHSW2003]</a>: see
<a class="reference internal" href="matrix_utils.html#sage.homology.matrix_utils.dhsw_snf" title="sage.homology.matrix_utils.dhsw_snf"><code class="xref py py-func docutils literal notranslate"><span class="pre">dhsw_snf()</span></code></a> for details.</p>
<p>Finally, <code class="docutils literal notranslate"><span class="pre">algorithm</span></code> may also be <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> or <code class="docutils literal notranslate"><span class="pre">'dhsw'</span></code>, which
forces the named algorithm to be used regardless of the size
of the matrices and regardless of whether CHomP is available.</p>
<p>As of this writing, <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> is the fastest standard option.
The optional CHomP package may be better still.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This only works if the base ring is the integers or a
field.  Other values will return an error.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z x Z, 1: Z x C3}</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">base_ring</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Vector space of dimension 2 over Finite Field of size 3</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">4</span><span class="p">:</span> <span class="n">identity_matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">30</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: 0, 1: 0, 4: 0, 5: 0}</span>
</pre></div>
</div>
<p>Generators: generators are given as
a list of cycles, each of which is an element in the
appropriate free module, and hence is represented as a vector:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">generators</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>  <span class="c1"># optional - CHomP</span>
<span class="go">(Z x C3, [(0, 1), (1, 0)])</span>
</pre></div>
</div>
<p>Tests for <a class="reference external" href="https://trac.sagemath.org/6100">trac ticket #6100</a>, the Klein bottle with generators:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d0</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">C_k</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">d0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">d1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="n">d2</span><span class="p">},</span> <span class="n">degree</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C_k</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">generators</span><span class="o">=</span><span class="n">true</span><span class="p">)</span>   <span class="c1"># optional - CHomP</span>
<span class="go">{0: (Z, [(1)]), 1: (Z x C2, [(0, 0, 1), (0, 1, -1)]), 2: 0}</span>
</pre></div>
</div>
<p>From a torus using a field:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">simplicial_complexes</span><span class="o">.</span><span class="n">Torus</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C_t</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">chain_complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">C_t</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">,</span> <span class="n">generators</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">{0: [(Vector space of dimension 1 over Rational Field,</span>
<span class="go">   Chain(0:(0, 0, 0, 0, 0, 0, 1)))],</span>
<span class="go"> 1: [(Vector space of dimension 1 over Rational Field,</span>
<span class="go">   Chain(1:(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, -1, 0, 0, 1))),</span>
<span class="go">  (Vector space of dimension 1 over Rational Field,</span>
<span class="go">   Chain(1:(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 1, 0, -1, 0)))],</span>
<span class="go"> 2: [(Vector space of dimension 1 over Rational Field,</span>
<span class="go">   Chain(2:(1, -1, 1, -1, 1, -1, -1, 1, -1, 1, -1, 1, 1, -1)))]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.nonzero_degrees">
<code class="descname">nonzero_degrees</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.nonzero_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the degrees in which the module is non-trivial.</p>
<p>See also <a class="reference internal" href="#sage.homology.chain_complex.ChainComplex_class.ordered_degrees" title="sage.homology.chain_complex.ChainComplex_class.ordered_degrees"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ordered_degrees()</span></code></a>.</p>
<p>OUTPUT:</p>
<p>The tuple containing all degrees <span class="math notranslate nohighlight">\(n\)</span> (grading group elements)
such that the module <span class="math notranslate nohighlight">\(C_n\)</span> of the chain is non-trivial.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">one</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">one</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">one</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="n">one</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">           [1]                             [1]       [0]       [1]</span>
<span class="go">0 &lt;-- C_7 &lt;---- C_6 &lt;-- 0  ...  0 &lt;-- C_3 &lt;---- C_2 &lt;---- C_1 &lt;---- C_0 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">nonzero_degrees</span><span class="p">()</span>
<span class="go">(0, 1, 2, 3, 6, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.ordered_degrees">
<code class="descname">ordered_degrees</code><span class="sig-paren">(</span><em>start=None</em>, <em>exclude_first=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.ordered_degrees" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort the degrees in the order determined by the differential</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">start</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) a degree (element of the grading
group) or <code class="docutils literal notranslate"><span class="pre">None</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">exclude_first</span></code> – boolean (optional; default:
<code class="docutils literal notranslate"><span class="pre">False</span></code>); whether to exclude the lowest degree – this is a
handy way to just get the degrees of the non-zero modules,
as the domain of the first differential is zero.</li>
</ul>
<p>OUTPUT:</p>
<p>If <code class="docutils literal notranslate"><span class="pre">start</span></code> has been specified, the longest tuple of degrees</p>
<ul class="simple">
<li>containing <code class="docutils literal notranslate"><span class="pre">start</span></code> (unless <code class="docutils literal notranslate"><span class="pre">start</span></code> would be the first
and <code class="docutils literal notranslate"><span class="pre">exclude_first=True</span></code>),</li>
<li>in ascending order relative to <a class="reference internal" href="#sage.homology.chain_complex.ChainComplex_class.degree_of_differential" title="sage.homology.chain_complex.ChainComplex_class.degree_of_differential"><code class="xref py py-meth docutils literal notranslate"><span class="pre">degree_of_differential()</span></code></a>, and</li>
<li>such that none of the corresponding differentials are <span class="math notranslate nohighlight">\(0\times 0\)</span>.</li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">start</span></code> has not been specified, a tuple of such tuples of
degrees. One for each sequence of non-zero differentials. They
are returned in sort order.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">one</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">one</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="n">one</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="n">one</span><span class="p">})</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">           [1]                             [1]       [0]       [1]</span>
<span class="go">0 &lt;-- C_7 &lt;---- C_6 &lt;-- 0  ...  0 &lt;-- C_3 &lt;---- C_2 &lt;---- C_1 &lt;---- C_0 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">ordered_degrees</span><span class="p">()</span>
<span class="go">((-1, 0, 1, 2, 3), (5, 6, 7))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">ordered_degrees</span><span class="p">(</span><span class="n">exclude_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">((0, 1, 2, 3), (6, 7))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">ordered_degrees</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">(5, 6, 7)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">ordered_degrees</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">exclude_first</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(6, 7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.random_element">
<code class="descname">random_element</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.random_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random element.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>    <span class="c1"># random output</span>
<span class="go">Chain with 1 nonzero terms over Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.rank">
<code class="descname">rank</code><span class="sig-paren">(</span><em>degree</em>, <em>ring=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rank of a differential</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">degree</span></code> – an element <span class="math notranslate nohighlight">\(\delta\)</span> of the grading
group. Which differential <span class="math notranslate nohighlight">\(d_{\delta}\)</span> we want to know the
rank of</li>
<li><code class="docutils literal notranslate"><span class="pre">ring</span></code> – (optional) a commutative ring <span class="math notranslate nohighlight">\(S\)</span>;
if specified, the rank is computed after changing to this ring</li>
</ul>
<p>OUTPUT:</p>
<p>The rank of the differential <span class="math notranslate nohighlight">\(d_{\delta} \otimes_R S\)</span>, where
<span class="math notranslate nohighlight">\(R\)</span> is the base ring of the chain complex.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">]])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[2]</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.shift">
<code class="descname">shift</code><span class="sig-paren">(</span><em>n=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift this chain complex <span class="math notranslate nohighlight">\(n\)</span> times.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer (optional, default 1)</li>
</ul>
<p>The <em>shift</em> operation is also sometimes called <em>translation</em> or
<em>suspension</em>.</p>
<p>To shift a chain complex by <span class="math notranslate nohighlight">\(n\)</span>, shift its entries up by <span class="math notranslate nohighlight">\(n\)</span>
(if it is a chain complex) or down by <span class="math notranslate nohighlight">\(n\)</span> (if it is a cochain
complex); that is, shifting by 1 always shifts in the opposite
direction of the differential. In symbols, if <span class="math notranslate nohighlight">\(C\)</span> is a chain
complex and <span class="math notranslate nohighlight">\(C[n]\)</span> is its <span class="math notranslate nohighlight">\(n\)</span>-th shift, then <span class="math notranslate nohighlight">\(C[n]_j =
C_{j-n}\)</span>. The differential in the shift <span class="math notranslate nohighlight">\(C[n]\)</span> is obtained by
multiplying each differential in <span class="math notranslate nohighlight">\(C\)</span> by <span class="math notranslate nohighlight">\((-1)^n\)</span>.</p>
<p>Caveat: different sources use different conventions for
shifting: what we call <span class="math notranslate nohighlight">\(C[n]\)</span> might be called <span class="math notranslate nohighlight">\(C[-n]\)</span> in some
places. See for example.
<a class="reference external" href="https://ncatlab.org/nlab/show/suspension+of+a+chain+complex">https://ncatlab.org/nlab/show/suspension+of+a+chain+complex</a>
(which uses <span class="math notranslate nohighlight">\(C[n]\)</span> as we do but acknowledges <span class="math notranslate nohighlight">\(C[-n]\)</span>) or 1.2.8
in <a class="reference internal" href="../../../references/index.html#wei1994" id="id2">[Wei1994]</a> (which uses <span class="math notranslate nohighlight">\(C[-n]\)</span>).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">S1</span> <span class="o">=</span> <span class="n">simplicial_complexes</span><span class="o">.</span><span class="n">Sphere</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">chain_complex</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">S1</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">S1</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S1</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">S1</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">S1</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">Z</span>
</pre></div>
</div>
<p>For cochain complexes, shifting goes in the other
direction. Topologically, this makes sense if we grade the
cochain complex for a space negatively:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">simplicial_complexes</span><span class="o">.</span><span class="n">Torus</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">co_T</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">chain_complex</span><span class="p">()</span><span class="o">.</span><span class="n">_flip_</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">co_T</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-2: Z, -1: Z x Z, 0: Z}</span>
<span class="gp">sage: </span><span class="n">co_T</span><span class="o">.</span><span class="n">degree_of_differential</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">co_T</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-4: Z, -3: Z x Z, -2: Z}</span>
</pre></div>
</div>
<p>You can achieve the same result by tensoring (on the left, to
get the signs right) with a rank one free module in degree
<code class="docutils literal notranslate"><span class="pre">-n</span> <span class="pre">*</span> <span class="pre">deg</span></code>, if <code class="docutils literal notranslate"><span class="pre">deg</span></code> is the degree of the differential:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">co_T</span><span class="p">)</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{-4: Z, -3: Z x Z, -2: Z}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.tensor">
<code class="descname">tensor</code><span class="sig-paren">(</span><em>*factors</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the tensor product of <code class="docutils literal notranslate"><span class="pre">self</span></code> with <code class="docutils literal notranslate"><span class="pre">D</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span> be two chain complexes with differentials
<span class="math notranslate nohighlight">\(\partial_C\)</span> and <span class="math notranslate nohighlight">\(\partial_D\)</span>, respectively, of the same degree (so
they must also have the same grading group).
The tensor product <span class="math notranslate nohighlight">\(S = C \otimes D\)</span> is a chain complex given by</p>
<div class="math notranslate nohighlight">
\[S_i = \bigoplus_{a+b=i} C_a \otimes D_b\]</div>
<p>with differential</p>
<div class="math notranslate nohighlight">
\[\partial(x \otimes y) = \partial_C x \otimes y
+ (-1)^{|a| \cdot |\partial_D|} x \otimes \partial_D y\]</div>
<p>for <span class="math notranslate nohighlight">\(x \in C_a\)</span> and <span class="math notranslate nohighlight">\(y \in D_b\)</span>, where <span class="math notranslate nohighlight">\(|a|\)</span> is the degree of <span class="math notranslate nohighlight">\(a\)</span> and
<span class="math notranslate nohighlight">\(|\partial_D|\)</span> is the degree of <span class="math notranslate nohighlight">\(\partial_D\)</span>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the degree of the differential is even, then this may not
result in a valid chain complex.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">subdivide</span></code> – (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>) whether to subdivide the
the differential matrices</li>
</ul>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Make subdivision work correctly on multiple factors.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">y</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C3</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">z</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C1</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C2</span><span class="p">))</span>
<span class="go">                        [ x]</span>
<span class="go">            [y x]       [-y]</span>
<span class="go"> 0 &lt;-- C_0 &lt;------ C_1 &lt;----- C_2 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C1</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C2</span><span class="p">)</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C3</span><span class="p">))</span>
<span class="go">                          [ y  x  0]       [ x]</span>
<span class="go">                          [-z  0  x]       [-y]</span>
<span class="go">            [z y x]       [ 0 -z -y]       [ z]</span>
<span class="go"> 0 &lt;-- C_0 &lt;-------- C_1 &lt;----------- C_2 &lt;----- C_3 &lt;-- 0</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="o">-</span><span class="n">y</span><span class="p">],[</span><span class="n">x</span><span class="p">]]),</span> <span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]])},</span>
<span class="gp">....: </span>                 <span class="n">degree_of_differential</span><span class="o">=-</span><span class="mi">1</span><span class="p">);</span> <span class="n">ascii_art</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go">                        [-y]</span>
<span class="go">            [x y]       [ x]</span>
<span class="go"> 0 &lt;-- C_0 &lt;------ C_1 &lt;----- C_2 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[x y x y]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[-y  x  0  y  0  0]</span>
<span class="go">[ x  0  x  0  y  0]</span>
<span class="go">[ 0 -x -y  0  0 -y]</span>
<span class="go">[ 0  0  0 -x -y  x]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">[ x  y  0  0]</span>
<span class="go">[ y  0 -y  0]</span>
<span class="go">[-x  0  0 -y]</span>
<span class="go">[ 0  y  x  0]</span>
<span class="go">[ 0 -x  0  x]</span>
<span class="go">[ 0  0  x  y]</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">differential</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">[-y]</span>
<span class="go">[ x]</span>
<span class="go">[-y]</span>
<span class="go">[ x]</span>
</pre></div>
</div>
<p>The degrees of the differentials must agree:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C1p</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])},</span> <span class="n">degree_of_differential</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">C1</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C1p</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">ValueError: the degrees of the differentials must match</span>
</pre></div>
</div>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">G</span> <span class="o">=</span> <span class="n">AdditiveAbelianGroup</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">d1</span> <span class="o">=</span> <span class="p">{</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])):</span><span class="n">matrix</span><span class="p">([[</span><span class="n">x</span><span class="p">]])}</span>
<span class="gp">sage: </span><span class="n">C1</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">(</span><span class="n">d1</span><span class="p">,</span> <span class="n">grading_group</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">d2</span> <span class="o">=</span> <span class="p">{</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span><span class="n">matrix</span><span class="p">([[</span><span class="n">y</span><span class="p">]])}</span>
<span class="gp">sage: </span><span class="n">C2</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">(</span><span class="n">d2</span><span class="p">,</span> <span class="n">grading_group</span><span class="o">=</span><span class="n">G</span><span class="p">,</span> <span class="n">degree</span><span class="o">=</span><span class="n">G</span><span class="p">(</span><span class="n">vector</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])))</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C1</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C2</span><span class="p">))</span>
<span class="go">                                    [y]</span>
<span class="go">                 [ x -y]            [x]</span>
<span class="go"> 0 &lt;-- C_(8, 3) &lt;-------- C_(6, 2) &lt;---- C_(4, 1) &lt;-- 0</span>
</pre></div>
</div>
<p>Check that <a class="reference external" href="https://trac.sagemath.org/21760">trac ticket #21760</a> is fixed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)},</span> <span class="n">degree</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="go"> 0 &lt;-- C_0 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">T</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ascii_art</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<span class="go"> 0 &lt;-- C_0 &lt;-- 0</span>
<span class="gp">sage: </span><span class="n">T</span><span class="o">.</span><span class="n">free_module_rank</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.ChainComplex_class.torsion_list">
<code class="descname">torsion_list</code><span class="sig-paren">(</span><em>max_prime</em>, <em>min_prime=2</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.ChainComplex_class.torsion_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Look for torsion in this chain complex by computing its mod <span class="math notranslate nohighlight">\(p\)</span>
homology for a range of primes <span class="math notranslate nohighlight">\(p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">max_prime</span></code> – prime number; search for torsion mod <span class="math notranslate nohighlight">\(p\)</span> for
all <span class="math notranslate nohighlight">\(p\)</span> strictly less than this number</li>
<li><code class="docutils literal notranslate"><span class="pre">min_prime</span></code> – prime (optional, default 2); search for
torsion mod <span class="math notranslate nohighlight">\(p\)</span> for primes at least as big as this</li>
</ul>
<p>Return a list of pairs <span class="math notranslate nohighlight">\((p, d)\)</span> where <span class="math notranslate nohighlight">\(p\)</span> is a prime at which
there is torsion and <span class="math notranslate nohighlight">\(d\)</span> is a list of dimensions in which this
torsion occurs.</p>
<p>The base ring for the chain complex must be the integers; if
not, an error is raised.</p>
<p>ALGORITHM:</p>
<p>let <span class="math notranslate nohighlight">\(C\)</span> denote the chain complex.  Let <span class="math notranslate nohighlight">\(P\)</span> equal
<code class="docutils literal notranslate"><span class="pre">max_prime</span></code>.  Compute the mod <span class="math notranslate nohighlight">\(P\)</span> homology of <span class="math notranslate nohighlight">\(C\)</span>, and use
this as the base-line computation: the assumption is that this
is isomorphic to the integral homology tensored with
<span class="math notranslate nohighlight">\(\GF{P}\)</span>.  Then compute the mod <span class="math notranslate nohighlight">\(p\)</span> homology for a range of
primes <span class="math notranslate nohighlight">\(p\)</span>, and record whenever the answer differs from the
base-line answer.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">()</span>
<span class="go">{0: Z x Z, 1: Z x C3}</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">[(3, [1])]</span>
<span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">([</span><span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">])])</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">C2</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">homology</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">C3</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">torsion_list</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">[(2, [1]), (3, [3])]</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.homology.chain_complex.Chain_class">
<em class="property">class </em><code class="descclassname">sage.homology.chain_complex.</code><code class="descname">Chain_class</code><span class="sig-paren">(</span><em>parent</em>, <em>vectors</em>, <em>check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.Chain_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../structure/sage/structure/element.html#sage.structure.element.ModuleElement" title="(in Sage Reference Manual: Parents and Elements v8.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.element.ModuleElement</span></code></a></p>
<p>A Chain in a Chain Complex</p>
<p>A chain is collection of module elements for each module <span class="math notranslate nohighlight">\(C_n\)</span>
of the chain complex <span class="math notranslate nohighlight">\((C_n, d_n)\)</span>. There is no restriction on
how the differentials <span class="math notranslate nohighlight">\(d_n\)</span> act on the elements of the chain.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must use the chain complex to construct chains.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])},</span> <span class="n">base_ring</span><span class="o">=</span><span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">C</span><span class="o">.</span><span class="n">category</span><span class="p">()</span>
<span class="go">Category of chain complexes over Finite Field of size 7</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.homology.chain_complex.Chain_class.is_boundary">
<code class="descname">is_boundary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.Chain_class.is_boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the chain is a boundary.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether the elements of the chain are in the image of
the differentials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">z3</span> <span class="o">=</span> <span class="n">C</span><span class="p">({</span><span class="mi">1</span><span class="p">:(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)})</span>
<span class="gp">sage: </span><span class="n">z3</span><span class="o">.</span><span class="n">is_cycle</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">z3</span><span class="p">)</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">z3</span><span class="p">)</span><span class="o">.</span><span class="n">is_boundary</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.Chain_class.is_cycle">
<code class="descname">is_cycle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.Chain_class.is_cycle" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the chain is a cycle.</p>
<p>OUTPUT:</p>
<p>Boolean. Whether the elements of the chain are in the kernel
of the differentials.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">is_cycle</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.homology.chain_complex.Chain_class.vector">
<code class="descname">vector</code><span class="sig-paren">(</span><em>degree</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.homology.chain_complex.Chain_class.vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the free module element in <code class="docutils literal notranslate"><span class="pre">degree</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">C</span> <span class="o">=</span> <span class="n">ChainComplex</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="n">matrix</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="mi">1</span><span class="p">:</span><span class="n">vector</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])})</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1, 2, 3)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">(4, 5)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">vector</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="../../index.html"
                        title="previous chapter">Cell complexes and their homology</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="chains.html"
                        title="next chapter">Chains and cochains</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/homology/chain_complex.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="chains.html" title="Chains and cochains"
             >next</a> |</li>
        <li class="right" >
          <a href="../../index.html" title="Cell complexes and their homology"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Cell complexes and their homology</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>