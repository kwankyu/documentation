
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>p-Adic Generic Element &#8212; Sage Reference Manual v8.5: p-Adics</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="\(p\)-Adic Capped Relative Elements" href="padic_capped_relative_element.html" />
    <link rel="prev" title="Local Generic Element" href="local_generic_element.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_capped_relative_element.html" title="\(p\)-Adic Capped Relative Elements"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="local_generic_element.html" title="Local Generic Element"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">p-Adics</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="p-adic-generic-element">
<span id="sage-rings-padics-padic-generic-element"></span><h1>p-Adic Generic Element<a class="headerlink" href="#p-adic-generic-element" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.rings.padics.padic_generic_element"></span><p>Elements of <span class="math notranslate nohighlight">\(p\)</span>-Adic Rings and Fields</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>David Roe</li>
<li>Genya Zaytman: documentation</li>
<li>David Harvey: doctests</li>
<li>Julian Rueth: fixes for exp() and log(), implemented gcd, xgcd</li>
</ul>
<dl class="class">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement">
<em class="property">class </em><code class="descclassname">sage.rings.padics.padic_generic_element.</code><code class="descname">pAdicGenericElement</code><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="local_generic_element.html#sage.rings.padics.local_generic_element.LocalGenericElement" title="sage.rings.padics.local_generic_element.LocalGenericElement"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.rings.padics.local_generic_element.LocalGenericElement</span></code></a></p>
<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.abs">
<code class="descname">abs</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <span class="math notranslate nohighlight">\(p\)</span>-adic absolute value of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
<p>This is normalized so that the absolute value of <span class="math notranslate nohighlight">\(p\)</span> is <span class="math notranslate nohighlight">\(1/p\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – Integer.  The precision of the real field in which
the answer is returned.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, returns a rational for
absolutely unramified fields, or a real with 53 bits of
precision for ramified fields.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">15</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="mi">53</span><span class="p">)</span>
<span class="go">0.200000000000000</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">prec</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="go">0.00000</span>
</pre></div>
</div>
<p>An unramified extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">PolynomialRing</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Z25</span><span class="o">.&lt;</span><span class="n">u</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="o">^</span><span class="mi">24</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">1/5</span>
</pre></div>
</div>
<p>A ramified extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">75</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">125</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.724779663677696</span>
<span class="gp">sage: </span><span class="n">W</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
<span class="go">0.000000000000000</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order">
<code class="descname">additive_order</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.additive_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the additive order of this element truncated
at precision <code class="docutils literal notranslate"><span class="pre">prec</span></code></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</li>
</ul>
<p>OUTPUT:</p>
<p>The additive order of this element</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;fixed-mod&#39;</span><span class="p">,</span> <span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">5</span><span class="p">);</span> <span class="n">a</span><span class="o">.</span><span class="n">additive_order</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep">
<code class="descname">algdep</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algdep" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> which is approximately
satisfied by this number. Note that the returned polynomial need not be
irreducible, and indeed usually won’t be if this number is a good
approximation to an algebraic number of degree less than <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library <code class="docutils literal notranslate"><span class="pre">algdep</span></code> command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial – degree n polynomial approximately satisfied by self</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algdep</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency">
<code class="descname">algebraic_dependency</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.algebraic_dependency" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a polynomial of degree at most <span class="math notranslate nohighlight">\(n\)</span> which is approximately
satisfied by this number.  Note that the returned polynomial need not
be irreducible, and indeed usually won’t be if this number is a good
approximation to an algebraic number of degree less than <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>ALGORITHM: Uses the PARI C-library algdep command.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</li>
</ul>
<p>OUTPUT:</p>
<p>polynomial – degree n polynomial approximately satisfied by self</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">);</span> <span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">,</span><span class="s1">&#39;series&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">K2</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">K2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">7</span><span class="o">/</span><span class="mi">19</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 2*3 + 3^2 + 3^3 + 2*3^4 + 2*3^5 + 3^8 + 2*3^9 + 3^11 + 3^12 + 2*3^15 + 2*3^16 + 3^17 + 2*3^19 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">19*x - 7</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">x^2 - x + 1</span>
<span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R2</span><span class="o">.</span><span class="n">zeta</span><span class="p">();</span> <span class="n">b</span><span class="o">.</span><span class="n">algebraic_dependency</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">x^4 - x^3 + x^2 - x + 1</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.artin_hasse_exp">
<code class="descname">artin_hasse_exp</code><span class="sig-paren">(</span><em>prec=None</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.artin_hasse_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Artin-Hasse exponential of this element.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)
the desired precision on the result; if <code class="docutils literal notranslate"><span class="pre">None</span></code>, the
precision is derived from the precision on the input</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">direct</span></code>, <code class="docutils literal notranslate"><span class="pre">series</span></code>, <code class="docutils literal notranslate"><span class="pre">newton</span></code> or 
<code class="docutils literal notranslate"><span class="pre">None</span></code> (default)</p>
<p>The direct algorithm computes the Artin-Hasse exponential
of <code class="docutils literal notranslate"><span class="pre">x</span></code>, namely <code class="docutils literal notranslate"><span class="pre">AH(x)</span></code> as</p>
<div class="math notranslate nohighlight">
\[AH(x) = \exp(x + \frac{x^p}{p} + \frac{x^{p^2}}{p^2} + \dots\]</div>
<p>It runs roughly as fast as the computation of the exponential
(since the computation of the argument is not that costly).</p>
<p>The series algorithm computes the series defining the
Artin-Hasse exponential and evaluates it.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Newton</span></code> algorithm solves the equation</p>
<div class="math notranslate nohighlight">
\[\log(AH(x)) = x + \frac{x^p}{p} + \frac{x^{p^2}}{p^2} + \dots\]</div>
<p>using a Newton scheme. It runs roughly as fast as the computation
of the logarithm.</p>
<p>By default, we use the direct algorithm if a fast algorithm for
computing the exponential is available.
If not, we use the Newton algorithm if a fast algorithm for
computing the logarithm is available.
Otherwise we switch to the series algorithm.</p>
</li>
</ul>
<p>OUTPUT:</p>
<p>The Artin-Hasse exponential of this element.</p>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Artin-Hasse_exponential">Wikipedia article Artin-Hasse_exponential</a> for more information.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">();</span> <span class="n">y</span>
<span class="go">1 + 2*5 + 4*5^2 + 3*5^3 + 5^7 + 2*5^8 + 3*5^10 + 2*5^11 + 2*5^12 +</span>
<span class="go">2*5^13 + 5^14 + 3*5^17 + 2*5^18 + 2*5^19 + O(5^20)</span>

<span class="gp">sage: </span><span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + O(5^20)</span>
</pre></div>
</div>
<p>The function respects your precision:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 +</span>
<span class="go">3^13 + 2*3^15 + 2*3^16 + 2*3^17 + 3^19 + 3^20 + 2*3^21 + 3^23 + 3^24 +</span>
<span class="go">3^26 + 3^27 + 2*3^28 + O(3^30)</span>
</pre></div>
</div>
<p>Unless you tell it not to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">30</span><span class="p">)(</span><span class="mi">45</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">()</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + 2*3^10 + 3^11 +</span>
<span class="go">3^13 + 2*3^15 + 2*3^16 + 2*3^17 + 3^19 + 3^20 + 2*3^21 + 3^23 + 3^24 +</span>
<span class="go">3^26 + 3^27 + 2*3^28 + O(3^30)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">1 + 2*3^2 + 3^4 + 2*3^5 + 3^6 + 2*3^7 + 2*3^8 + 3^9 + O(3^10)</span>
</pre></div>
</div>
<p>For precision 1 the function just returns 1 since the
exponential is always a 1-unit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">artin_hasse_exp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1 + O(3)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Mitchell Owen, Sebastian Pancrantz (2012-02): initial version.</li>
<li>Xavier Caruso (2018-08): extend to any p-adic rings and fields
and implement several algorithms.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion">
<code class="descname">dwork_expansion</code><span class="sig-paren">(</span><em>bd=20</em>, <em>a=0</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.dwork_expansion" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of a function defined by Dwork.</p>
<p>Used to compute the <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma function, see <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gamma()</span></code></a>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">bd</span></code> – integer. Is a bound for precision, defaults to 20</li>
<li><code class="docutils literal notranslate"><span class="pre">a</span></code>  – integer. Offset parameter, defaults to 0</li>
</ul>
<p>OUTPUT:</p>
<p>A <code class="docutils literal notranslate"><span class="pre">p</span></code>– adic integer.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The output is a <span class="math notranslate nohighlight">\(p\)</span>-adic integer from Dwork’s expansion,
used to compute the <span class="math notranslate nohighlight">\(p\)</span>-adic gamma function as in <a class="reference internal" href="#rv" id="id1">[RV]</a>
section 6.2.
The coefficients of the expansion are now cached to speed up
multiple evaluation, as in the trace formula for hypergeometric
motives.</p>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="rv" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[RV]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> Rodriguez Villegas, Fernando. Experimental Number Theory.
Oxford Graduate Texts in Mathematics 13, 2007.</td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">+</span><span class="mi">13</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">6</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">10</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="p">(</span><span class="mi">19</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="go">16 + 7*17 + 11*17^2 + 4*17^3 + 8*17^4 + 10*17^5 + 11*17^6 + 6*17^7 </span>
<span class="go">+ 17^8 + 8*17^10 + 13*17^11 + 9*17^12 + 15*17^13  + 2*17^14 + 6*17^15 </span>
<span class="go">+ 7*17^16 + 6*17^17 + O(17^18)</span>

<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">4</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="mi">5</span><span class="o">+</span><span class="mi">1</span><span class="o">*</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="p">(</span><span class="mi">20</span><span class="p">)))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">()</span>
<span class="go">4 + 4*5 + 4*5^2 + 4*5^3 + 2*5^4 + 4*5^5 + 5^7 + 3*5^9 + 4*5^10 + 3*5^11 </span>
<span class="go">+ 5^13 + 4*5^14 + 2*5^15 + 2*5^16 + 2*5^17 + 3*5^18 + O(5^20)</span>
</pre></div>
</div>
<p>This test was added in <a class="reference external" href="https://trac.sagemath.org/24433">trac ticket #24433</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">gamma</span><span class="p">()</span>
<span class="go">6 + O(7^20)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">dwork_expansion</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">6 + 4*7^19 + O(7^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp">
<code class="descname">exp</code><span class="sig-paren">(</span><em>aprec=None</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(p\)</span>-adic exponential of this element if the exponential
series converges.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">aprec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>); if
specified, computes only up to the indicated precision.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">generic</span></code>, <code class="docutils literal notranslate"><span class="pre">binary_splitting</span></code>, <code class="docutils literal notranslate"><span class="pre">newton</span></code> 
or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)
The generic algorithm evaluates naively the series defining the
exponential, namely</p>
<div class="math notranslate nohighlight">
\[\exp(x) = 1 + x + x^2/2 + x^3/6 + x^4/24 + \cdots\]</div>
<p>Its binary complexity is quadratic with respect to the precision.</p>
<p>The binary splitting algorithm is faster, it has a quasi-linear
complexity.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Newton</span></code> algorithms solve the equation <span class="math notranslate nohighlight">\(\log(x) = self\)</span> using
a Newton scheme. It runs roughly as fast as the computation of the
logarithm.</p>
<p>By default, we use the binary splitting if it is available. 
If it is not, we use the Newton algorithm if a fast algorithm for
computing the logarithm is available.
Otherwise we switch to the generic algorithm.</p>
</li>
</ul>
<p>EXAMPLES:</p>
<p><a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.log"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log()</span></code></a> and <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.exp" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.exp"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exp()</span></code></a> are inverse to each other:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + 13 + O(13^10)</span>
</pre></div>
</div>
<p>An error occurs if this is called with an element for which the
exponential series does not converge:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span><span class="o">.</span><span class="n">one</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Exponential does not converge for that input.</span>
</pre></div>
</div>
<p>The next few examples illustrate precision when computing <span class="math notranslate nohighlight">\(p\)</span>-adic
exponentials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">R</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">**</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">7</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">8</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="mi">5</span><span class="o">**</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">add_bigoh</span><span class="p">(</span><span class="mi">10</span><span class="p">);</span> <span class="n">e</span>
<span class="go">2*5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^5 + 3*5^7 + 2*5^8 + 4*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span><span class="o">*</span><span class="n">K</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^3 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms and exponentials in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">);</span> <span class="n">b</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">exp</span><span class="p">()</span>
<span class="go">1 + (a^2 + 1)*5 + (2*a + 3)*5^3 + O(5^5)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Genya Zaytman (2007-02-15)</li>
<li>Amnon Besser, Marc Masdeu (2012-02-23): Complete rewrite</li>
<li>Julian Rueth (2013-02-14): Added doctests, fixed some corner cases</li>
<li>Xavier Caruso (2017-06): Added binary splitting and Newton algorithms</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma">
<code class="descname">gamma</code><span class="sig-paren">(</span><em>algorithm='pari'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of the <span class="math notranslate nohighlight">\(p\)</span>-adic Gamma function.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – string. Can be set to <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> to call
the pari function, or <code class="docutils literal notranslate"><span class="pre">'sage'</span></code> to call the function
implemented in sage. The default is <code class="docutils literal notranslate"><span class="pre">'pari'</span></code> since
pari is about 10 times faster than sage.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>a <span class="math notranslate nohighlight">\(p\)</span>-adic integer</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is based on GP code written by Fernando Rodriguez
Villegas (<a class="reference external" href="http://www.ma.utexas.edu/cnt/cnt-frames.html">http://www.ma.utexas.edu/cnt/cnt-frames.html</a>).
William Stein sped it up for GP
(<a class="reference external" href="http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c">http://sage.math.washington.edu/home/wstein/www/home/wbhart/pari-2.4.2.alpha/src/basemath/trans2.c</a>).
The ‘sage’ version uses dwork_expansion() to compute the
<span class="math notranslate nohighlight">\(p\)</span>-adic gamma function of self as in <a class="reference internal" href="#rv" id="id2">[RV]</a> section 6.2.</p>
</div>
<p>EXAMPLES:</p>
<p>This example illustrates <code class="docutils literal notranslate"><span class="pre">x.gamma()</span></code> for <span class="math notranslate nohighlight">\(x\)</span> a <span class="math notranslate nohighlight">\(p\)</span>-adic unit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="mi">7</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">20</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12 </span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 2*7^2 + 4*7^3 + 5*7^4 + 3*7^5 + 7^8 + 7^9 + 4*7^10 + 3*7^12 </span>
<span class="go">+ 7^13 + 5*7^14 + 3*7^15 + 2*7^16 + 2*7^17 + 5*7^18 + 4*7^19 + O(7^20)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">x.gamma()</span></code> for <span class="math notranslate nohighlight">\(x\)</span> a <span class="math notranslate nohighlight">\(p\)</span>-adic integer but not a unit:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">17</span><span class="o">+</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">3</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">8</span><span class="o">+</span><span class="n">O</span><span class="p">(</span><span class="mi">17</span><span class="o">^</span><span class="mi">13</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7 </span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">1 + 12*17 + 13*17^2 + 13*17^3 + 10*17^4 + 7*17^5 + 16*17^7 </span>
<span class="go">+ 13*17^9 + 4*17^10 + 9*17^11 + 17^12 + O(17^13)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;pari&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">(</span><span class="s1">&#39;sage&#39;</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Finally, this function is not defined if <span class="math notranslate nohighlight">\(x\)</span> is not a <span class="math notranslate nohighlight">\(p\)</span>-adic integer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">K</span><span class="p">(</span><span class="mi">7</span><span class="o">^-</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span><span class="o">^-</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="mi">7</span> 
<span class="go">....:       + 7^3 + 4*7^4 + 5*7^5 + 6*7^8 + 3*7^9 + 6*7^10 + 5*7^11 + 6*7^12 </span>
<span class="go">....:       + 3*7^13 + 5*7^14 + O(7^15))</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">gamma</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">The p-adic gamma function only works on elements of Zp</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd">
<code class="descname">gcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a greatest common divisor of <code class="docutils literal notranslate"><span class="pre">self</span></code> and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">other</span></code> – an element in the same ring as <code class="docutils literal notranslate"><span class="pre">self</span></code></li>
</ul>
<p>AUTHORS:</p>
<ul class="simple">
<li>Julian Rueth (2012-10-19): initial version</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the elements are only given with finite precision,
their greatest common divisor is in general not unique (not even up
to units). For example <span class="math notranslate nohighlight">\(O(3)\)</span> is a representative for the elements
0 and 3 in the 3-adic ring <span class="math notranslate nohighlight">\(\ZZ_3\)</span>. The greatest common
divisor of <span class="math notranslate nohighlight">\(O(3)\)</span> and <span class="math notranslate nohighlight">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of&nbsp;minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>A non-zero result is always lifted to the maximal precision possible in
the ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with the precision
set to the smallest of their precisions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">O(3^2)</span>
</pre></div>
</div>
<p>One could argue that it is mathematically correct to return <span class="math notranslate nohighlight">\(9 +
O(3^{22})\)</span> instead. However, this would lead to some confusing
behaviour:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">alternative_gcd</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">22</span><span class="p">);</span> <span class="n">alternative_gcd</span>
<span class="go">3^2 + O(3^22)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">alternative_gcd</span><span class="o">.</span><span class="n">is_zero</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>If exactly one element is zero, then the result depends on the
valuation of the other element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^3)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">O(3^4)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">3</span><span class="o">^</span><span class="mi">4</span><span class="p">)</span>
<span class="go">3^4 + O(3^24)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">1 + O(3^20)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_prime">
<code class="descname">is_prime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_prime" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this element is prime in its parent</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">A</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">fraction_field</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">B</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">A</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">5</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">B</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_prime</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square">
<code class="descname">is_square</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_square" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether this element is a square</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_square</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.is_squarefree">
<code class="descname">is_squarefree</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.is_squarefree" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether this element is squarefree, i.e., whether there exists
no non-unit <span class="math notranslate nohighlight">\(g\)</span> such that <span class="math notranslate nohighlight">\(g^2\)</span> divides this element.</p>
<p>EXAMPLES:</p>
<p>The zero element is never squarefree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>In <span class="math notranslate nohighlight">\(p\)</span>-adic rings, only elements of valuation at most 1 are
squarefree:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>This works only if the precision is known sufficiently well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PrecisionError</span>: <span class="n">element not known to sufficient precision to decide squarefreeness</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>For fields we are not so strict about the precision and treat inexact
zeros as the zero element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">is_squarefree</span><span class="p">()</span>
<span class="kc">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>p_branch=None</em>, <em>pi_branch=None</em>, <em>aprec=None</em>, <em>change_frac=False</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the <span class="math notranslate nohighlight">\(p\)</span>-adic logarithm of this element.</p>
<p>The usual power series for the logarithm with values in the additive
group of a <span class="math notranslate nohighlight">\(p\)</span>-adic ring only converges for 1-units (units congruent to
1 modulo <span class="math notranslate nohighlight">\(p\)</span>).  However, there is a unique extension of the logarithm
to a homomorphism defined on all the units: If <span class="math notranslate nohighlight">\(u = a \cdot v\)</span> is a
unit with <span class="math notranslate nohighlight">\(v \equiv 1 \pmod{p}\)</span> and <span class="math notranslate nohighlight">\(a\)</span> a Teichmuller representative,
then we define <span class="math notranslate nohighlight">\(log(u) = log(v)\)</span>.  This is the correct extension
because the units <span class="math notranslate nohighlight">\(U\)</span> split as a product <span class="math notranslate nohighlight">\(U = V \times \langle w
\rangle\)</span>, where <span class="math notranslate nohighlight">\(V\)</span> is the subgroup of 1-units and <span class="math notranslate nohighlight">\(w\)</span> is a fundamental
root of unity.  The <span class="math notranslate nohighlight">\(\langle w \rangle\)</span> factor is torsion, so must go
to 0 under any homomorphism to the fraction field, which is a torsion
free group.</p>
<p>INPUT:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">p_branch</span></code> – an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends <span class="math notranslate nohighlight">\(p\)</span> to <code class="docutils literal notranslate"><span class="pre">branch</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pi_branch</span></code> – an element in the base ring or its fraction
field; the implementation will choose the branch of the
logarithm which sends the uniformizer to <code class="docutils literal notranslate"><span class="pre">branch</span></code>.  You
may specify at most one of <code class="docutils literal notranslate"><span class="pre">p_branch</span></code> and <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>,
and must specify one of them if this element is not a unit.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">aprec</span></code> – an integer or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) if not
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then the result will only be correct to precision
<code class="docutils literal notranslate"><span class="pre">aprec</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">change_frac</span></code> – In general the codomain of the logarithm should be
in the <span class="math notranslate nohighlight">\(p\)</span>-adic field, however, for most neighborhoods of 1, it lies
in the ring of integers. This flag decides if the codomain should be
the same as the input (default) or if it should change to the
fraction field of the input.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">generic</span></code>, <code class="docutils literal notranslate"><span class="pre">binary_splitting</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default)
The generic algorithm evaluates naively the series defining the log,
namely</p>
<div class="math notranslate nohighlight">
\[\log(1-x) = -x - 1/2 x^2 - 1/3 x^3 - 1/4 x^4 - 1/5 x^5 - \cdots\]</div>
<p>Its binary complexity is quadratic with respect to the precision.</p>
<p>The binary splitting algorithm is faster, it has a quasi-linear
complexity.
By default, we use the binary splitting if it is available. Otherwise
we switch to the generic algorithm.</p>
</li>
</ul>
<p>NOTES:</p>
<p>What some other systems do:</p>
<ul class="simple">
<li>PARI: Seems to define the logarithm for units not congruent
to 1 as we do.</li>
<li>MAGMA: Only implements logarithm for 1-units (as of version 2.19-2)</li>
</ul>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">There is a soft-linear time algorithm for logarithm described
by Dan Berstein at
<a class="reference external" href="http://cr.yp.to/lineartime/multapps-20041007.pdf">http://cr.yp.to/lineartime/multapps-20041007.pdf</a></p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Z13</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Z13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>

<span class="gp">sage: </span><span class="n">Q13</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">Q13</span><span class="p">(</span><span class="mi">14</span><span class="p">);</span> <span class="n">a</span>
<span class="go">1 + 13 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
</pre></div>
</div>
<p>Note that the relative precision decreases when we take log.
Precisely the absolute precision on <code class="docutils literal notranslate"><span class="pre">\log(a)</span></code> agrees with the relative
precision on <code class="docutils literal notranslate"><span class="pre">a</span></code> thanks to the relation <code class="docutils literal notranslate"><span class="pre">d\log(a)</span> <span class="pre">=</span> <span class="pre">da/a</span></code>.</p>
<p>The call <span class="math notranslate nohighlight">\(log(a)\)</span> works as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">13 + 6*13^2 + 2*13^3 + 5*13^4 + 10*13^6 + 13^7 + 11*13^8 + 8*13^9 + O(13^10)</span>
<span class="gp">sage: </span><span class="n">log</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The logarithm is not only defined for 1-units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>If you want to take the logarithm of a non-unit you must specify either
<code class="docutils literal notranslate"><span class="pre">p_branch</span></code> or <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="go">4 + 2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>The branch parameters are only relevant for elements of non-zero
valuation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">2*5 + 3*5^2 + 2*5^3 + 4*5^4 + 2*5^6 + 2*5^7 + 4*5^8 + 2*5^9 + O(5^10)</span>
</pre></div>
</div>
<p>Logarithms can also be computed in extension fields. First, in an
Eisenstein extension:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">ZZ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">625</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">z</span>
<span class="go">1 + w^2 + 4*w^7 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">w^2 + 2*w^4 + 3*w^6 + 4*w^7 + w^9 + 4*w^10 + 4*w^11 + 4*w^12 + 3*w^14 + w^15 + w^17 + 3*w^18 + 3*w^19 + O(w^20)</span>
</pre></div>
</div>
<p>In an extension, there will usually be a difference between
specifying <code class="docutils literal notranslate"><span class="pre">p_branch</span></code> and <code class="docutils literal notranslate"><span class="pre">pi_branch</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">W</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">You must specify a branch of the logarithm for non-units</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">pi_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15 + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">unit_part</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">3*w^2 + 2*w^4 + 2*w^6 + 3*w^8 + 4*w^10 + w^13 + w^14 + 2*w^15 + 2*w^16 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">^</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">4</span><span class="o">*</span><span class="n">w</span><span class="o">^</span><span class="mi">7</span><span class="p">;</span> <span class="n">y</span>
<span class="go">4*w^9 + O(w^29)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">2*w^2 + 2*w^4 + 2*w^6 + 2*w^8 + w^10 + w^12 + 4*w^13 + 4*w^14 + 3*w^15 + 4*w^16 + 4*w^17 + w^18 + 4*w^19 + O(w^20)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="n">w</span><span class="p">)</span>
<span class="go">w + 2*w^2 + 2*w^4 + 4*w^5 + 2*w^6 + 2*w^7 + 2*w^8 + 4*w^9 + w^10 + 3*w^11 + w^12 + 4*w^14 + 4*w^16 + 2*w^17 + w^19 + O(w^20)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">y</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">z</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="n">z</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">O(w^20)</span>
</pre></div>
</div>
<p>Now an unramified example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">g</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">A</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">(a^2 + 1)*5 + (3*a^2 + 4*a + 2)*5^2 + (3*a^2 + 2*a)*5^3 + (3*a^2 + 2*a + 2)*5^4 + O(5^5)</span>
</pre></div>
</div>
<p>Check that log is multiplicative:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">5</span><span class="o">^</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">b</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">+</span> <span class="n">c</span><span class="o">.</span><span class="n">log</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span><span class="o">*</span><span class="n">c</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">O(5^5)</span>
</pre></div>
</div>
<p>We illustrate the effect of the precision argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">41152263</span><span class="p">);</span> <span class="n">x</span>
<span class="go">5 + 3*7^2 + 4*7^3 + 3*7^4 + 5*7^5 + 6*7^6 + 7^9 + O(7^10)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + O(7^5)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">aprec</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + O(7^7)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="go">7 + 3*7^2 + 4*7^3 + 3*7^4 + 7^5 + 3*7^6 + 7^7 + 3*7^8 + 4*7^9 + O(7^10)</span>
</pre></div>
</div>
<p>The logarithm is not defined for zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">log</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">logarithm is not defined at zero</span>
</pre></div>
</div>
<p>For elements in a <span class="math notranslate nohighlight">\(p\)</span>-adic ring, the logarithm will be returned in the
same ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">7-adic Ring with capped absolute precision 10</span>
</pre></div>
</div>
<p>This is not possible if the logarithm has negative valuation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">ZpCA</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">3</span>
<span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">w</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">ext</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">logarithm is not integral, use change_frac=True to obtain a result in the fraction field</span>
<span class="gp">sage: </span><span class="n">w</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_branch</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">change_frac</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">2*w^-3 + O(w^24)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>William Stein: initial version</li>
<li>David Harvey (2006-09-13): corrected subtle precision bug (need to
take denominators into account! – see <a class="reference external" href="https://trac.sagemath.org/53">trac ticket #53</a>)</li>
<li>Genya Zaytman (2007-02-14): adapted to new <span class="math notranslate nohighlight">\(p\)</span>-adic class</li>
<li>Amnon Besser, Marc Masdeu (2012-02-21): complete rewrite, valid for
generic <span class="math notranslate nohighlight">\(p\)</span>-adic rings.</li>
<li>Soroosh Yazdani (2013-02-1): Fixed a precision issue in
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_log_generic()</span></code>.  This should really fix the issue with
divisions.</li>
<li>Julian Rueth (2013-02-14): Added doctests, some changes for
capped-absolute implementations.</li>
<li>Xavier Caruso (2017-06): Added binary splitting type algorithms
over Qp</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial">
<code class="descname">minimal_polynomial</code><span class="sig-paren">(</span><em>name='x'</em>, <em>base=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.minimal_polynomial" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the minimal polynomial of this element over <code class="docutils literal notranslate"><span class="pre">base</span></code></p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> – string (default: <code class="docutils literal notranslate"><span class="pre">x</span></code>): the name of the variable</li>
<li><code class="docutils literal notranslate"><span class="pre">base</span></code> – a ring (default: the base ring of the parent):
the base ring over which the minimal polynomial is computed</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">(1 + O(5^5))*x + 3 + 5 + 3*5^2 + 5^3 + 3*5^4 + O(5^5)</span>

<span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">)</span>
<span class="go">(1 + O(5^5))*foo + 3 + 5 + 3*5^2 + 5^3 + 3*5^4 + O(5^5)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>
<span class="go">(1 + O(2^5))*x^4 + a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>
<span class="go">(1 + O(2^5))*x^2 + a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>
<span class="go">(1 + O(2^5))*x^4 + (a^2 + 1)*2^-1 + O(2^4)</span>

<span class="gp">sage: </span><span class="n">elt</span> <span class="o">=</span> <span class="n">L</span><span class="o">.</span><span class="n">random_element</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span> <span class="o">=</span> <span class="n">elt</span><span class="o">.</span><span class="n">minimal_polynomial</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P</span><span class="p">(</span><span class="n">elt</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order">
<code class="descname">multiplicative_order</code><span class="sig-paren">(</span><em>prec=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.multiplicative_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the multiplicative order of self, where self is
considered to be one if it is one modulo <span class="math notranslate nohighlight">\(p^{\mbox{prec}}\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
<li><code class="docutils literal notranslate"><span class="pre">prec</span></code> – an integer</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>integer – the multiplicative order of self</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zeta</span><span class="p">()</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Over unramified extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L1</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">L1</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">124</span>
<span class="gp">sage: </span><span class="n">c</span><span class="o">^</span><span class="mi">124</span>
<span class="go">1 + O(5^20)</span>
</pre></div>
</div>
<p>Over totally ramified extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">L2</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="mi">5</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">pi</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">5</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">L2</span><span class="o">.</span><span class="n">teichmuller</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">v</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">u</span><span class="o">*</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">multiplicative_order</span><span class="p">()</span>
<span class="go">20</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.norm">
<code class="descname">norm</code><span class="sig-paren">(</span><em>base=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.norm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the norm of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over <code class="docutils literal notranslate"><span class="pre">base</span></code>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This is not the <span class="math notranslate nohighlight">\(p\)</span>-adic absolute value.  This is a field
theoretic norm down to a base ring.  If you want the
<span class="math notranslate nohighlight">\(p\)</span>-adic absolute value, use the <code class="docutils literal notranslate"><span class="pre">abs()</span></code> function
instead.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">base</span></code> – a subring of the parent (default: base ring)</li>
</ul>
<p>OUTPUT:</p>
<p>The norm of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the given base.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">5 + O(5^21)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>  <span class="c1"># norm over K</span>
<span class="go">a*2 + a*2^2 + a*2^3 + a*2^4 + a*2^5 + O(2^6)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span>
<span class="go">a^2*2^2 + O(2^7)</span>
<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">^</span><span class="mi">2</span>
<span class="go">a^2*2^2 + O(2^7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.nth_root">
<code class="descname">nth_root</code><span class="sig-paren">(</span><em>n</em>, <em>all=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.nth_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the nth root of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – an integer</li>
<li><code class="docutils literal notranslate"><span class="pre">all</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>): if <code class="docutils literal notranslate"><span class="pre">True</span></code>, 
return all ntn roots of this element, instead of just one.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">A</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">A</span><span class="p">(</span><span class="mi">61376</span><span class="p">);</span> <span class="n">x</span>
<span class="go">1 + 5^3 + 3*5^4 + 4*5^5 + 3*5^6 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span> <span class="n">y</span>
<span class="go">2 + 5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^6 + O(5^10)</span>
<span class="gp">sage: </span><span class="n">y</span><span class="o">^</span><span class="mi">4</span> <span class="o">==</span> <span class="n">x</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[2 + 5 + 2*5^2 + 4*5^3 + 3*5^4 + 5^6 + O(5^10),</span>
<span class="go"> 4 + 4*5 + 4*5^2 + 4*5^4 + 3*5^5 + 5^6 + 3*5^7 + 5^8 + 5^9 + O(5^10),</span>
<span class="go"> 3 + 3*5 + 2*5^2 + 5^4 + 4*5^5 + 3*5^6 + 4*5^7 + 4*5^8 + 4*5^9 + O(5^10),</span>
<span class="go"> 1 + 4*5^3 + 5^5 + 3*5^6 + 5^7 + 3*5^8 + 3*5^9 + O(5^10)]</span>
</pre></div>
</div>
<p>When <span class="math notranslate nohighlight">\(n\)</span> is divisible by the underlying prime <span class="math notranslate nohighlight">\(p\)</span>, we
are losing precision (which is consistant with the fact
that raising to the pth power increases precision):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="n">z</span>
<span class="go">1 + 5^2 + 3*5^3 + 2*5^4 + 5^5 + 3*5^7 + 2*5^8 + O(5^9)</span>
<span class="gp">sage: </span><span class="n">z</span><span class="o">^</span><span class="mi">5</span>
<span class="go">1 + 5^3 + 3*5^4 + 4*5^5 + 3*5^6 + O(5^10)</span>
</pre></div>
</div>
<p>Everything works over extensions as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">W</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zq</span><span class="p">(</span><span class="mi">5</span><span class="o">^</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">W</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">7</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">pi + O(pi^141)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="nb">all</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[pi + O(pi^141)]</span>
</pre></div>
</div>
<p>An error is raised if the given element is not a nth power
in the ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">nth_root</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">This element is not a nth power</span>
</pre></div>
</div>
<p>Similarly, when precision on the input is too small, an error
is raised:</p>
<blockquote>
<div>sage: x = R(1,6); x
1 + O(pi^6)
sage: x.nth_root(5)
Traceback (most recent call last):
…
PrecisionError: Not enough precision to be sure that this element is a nth power</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp">
<code class="descname">ordp</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.ordp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the valuation of self, normalized so that the valuation of <span class="math notranslate nohighlight">\(p\)</span> is 1</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>). If specified, will make sure that <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">==</span> <span class="pre">self.parent().prime()</span></code></li>
</ul>
<p>NOTE: The optional argument p is used for consistency with the valuation methods on integer and rational.</p>
<p>OUTPUT:</p>
<p>integer – the valuation of self, normalized so that the valuation of <span class="math notranslate nohighlight">\(p\)</span> is 1</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">+Infinity</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">ordp</span><span class="p">()</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.polylog">
<code class="descname">polylog</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.polylog" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(Li_n(self)\)</span> , the <span class="math notranslate nohighlight">\(n`th `p\)</span>-adic polylogarithm of this element.</p>
<p>INPUT:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">n</span></code> – a non-negative integer</li>
</ul>
</div></blockquote>
<p>OUTPUT:</p>
<blockquote>
<div><ul class="simple">
<li><span class="math notranslate nohighlight">\(Li_n(self)\)</span></li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>The <span class="math notranslate nohighlight">\(n\)</span>-th polylogarithm of <span class="math notranslate nohighlight">\(-1\)</span> is <span class="math notranslate nohighlight">\(0\)</span> for even <span class="math notranslate nohighlight">\(n\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">13</span><span class="p">)(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>We can check some identities, for example those mentioned in <a class="reference internal" href="#dcw2016" id="id3">[DCW2016]</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="mi">8</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">x</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">30</span><span class="p">)(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">x</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p><span class="math notranslate nohighlight">\(Li_1(z) = -\log(1-z)\)</span> for <span class="math notranslate nohighlight">\(|z| &lt; 1\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="o">-</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The polylogarithm of 1 is not defined</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">5</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Polylogarithm is not defined for 1.</span>
</pre></div>
</div>
<p>The polylogarithm of 0 is 0</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Qp</span><span class="p">(</span><span class="mi">11</span><span class="p">)(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">polylog</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>ALGORITHM:</p>
<p>The algorithm of Besser-de Jeu, as described in <a class="reference internal" href="#bdj2008" id="id4">[BdJ2008]</a> is used.</p>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="bdj2008" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[BdJ2008]</a></td><td>Besser, Amnon, and Rob de Jeu. “Li^(p)-Service? An Algorithm
for Computing p-Adic Polylogarithms.” Mathematics of Computation
(2008): 1105-1134.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dcw2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[DCW2016]</a></td><td>Dan-Cohen, Ishai, and Stefan Wewers. “Mixed Tate motives and the
unit equation.” International Mathematics Research Notices
2016.17 (2016): 5291-5354.</td></tr>
</tbody>
</table>
<p>AUTHORS:</p>
<ul class="simple">
<li>Jennifer Balakrishnan - Initial implementation</li>
<li>Alex J. Best (2017-07-21) - Extended to other residue disks</li>
</ul>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Implement for extensions</li>
<li>Use the change method to create K from self.parent()</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction">
<code class="descname">rational_reconstruction</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.rational_reconstruction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a rational approximation to this <span class="math notranslate nohighlight">\(p\)</span>-adic number</p>
<p>This will raise an ArithmeticError if there are no valid
approximations to the unit part with numerator and
denominator bounded by <code class="docutils literal notranslate"><span class="pre">sqrt(p^absprec</span> <span class="pre">/</span> <span class="pre">2)</span></code>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-meth docutils literal notranslate"><span class="pre">_rational_()</span></code></p>
</div>
<p>OUTPUT:</p>
<p>rational – an approximation to self</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
<span class="go">....:     for j in range(1,10):</span>
<span class="go">....:         if j == 5:</span>
<span class="go">....:             continue</span>
<span class="go">....:         assert i/j == R(i/j).rational_reconstruction()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root">
<code class="descname">square_root</code><span class="sig-paren">(</span><em>extend=True</em>, <em>all=False</em>, <em>algorithm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.square_root" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the square root of this <span class="math notranslate nohighlight">\(p\)</span>-adic number.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a <span class="math notranslate nohighlight">\(p\)</span>-adic element.</li>
<li><code class="docutils literal notranslate"><span class="pre">extend</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">True</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a 
square root in an extension if necessary; if <code class="docutils literal notranslate"><span class="pre">False</span></code> and no root 
exists in the given ring or field, raise a ValueError.</li>
<li><code class="docutils literal notranslate"><span class="pre">all</span></code> – a boolean (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>); if <code class="docutils literal notranslate"><span class="pre">True</span></code>, return a 
list of all square roots.</li>
<li><code class="docutils literal notranslate"><span class="pre">algorithm</span></code> – <code class="docutils literal notranslate"><span class="pre">&quot;pari&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;sage&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> (default: 
<code class="docutils literal notranslate"><span class="pre">None</span></code>); Sage provides an implementation for any extension of 
<span class="math notranslate nohighlight">\(Q_p\)</span> whereas only square roots over <span class="math notranslate nohighlight">\(Q_p\)</span> is implemented in Pari;
the default is <code class="docutils literal notranslate"><span class="pre">&quot;pari&quot;</span></code> if the ground field is <span class="math notranslate nohighlight">\(Q_p\)</span>, <code class="docutils literal notranslate"><span class="pre">&quot;sage&quot;</span></code>
otherwise.</li>
</ul>
<p>OUTPUT:</p>
<p>The square root or the list of all square roots of this <span class="math notranslate nohighlight">\(p\)</span>-adic 
number.</p>
<p>NOTE:</p>
<p>The square root is chosen (resp. the square roots are ordered) in
a deterministic way.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">0</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(3^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">element is not a square</span>

<span class="gp">sage: </span><span class="o">-</span><span class="n">R</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(3^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">3 + O(3^21)</span>
</pre></div>
</div>
<p>When <span class="math notranslate nohighlight">\(p = 2\)</span>, the precision of the square root is less
than the input:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R2</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(2^19)</span>
<span class="gp">sage: </span><span class="n">R2</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">2 + O(2^20)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">t</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zq</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">t</span>
<span class="gp">sage: </span><span class="n">u</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + t*2^2 + t^2*2^3 + t^2*2^4 + (t^4 + t^3 + t^2)*2^5 + (t^4 + t^2)*2^6 + (t^5 + t^2)*2^7 + (t^6 + t^5 + t^4 + t^2)*2^8 + O(2^9)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">u</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">5</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">7</span> <span class="o">+</span> <span class="n">a</span><span class="o">^</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span> <span class="n">u</span>
<span class="go">1 + a^4 + a^5 + a^7 + a^8 + O(a^10)</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">square_root</span><span class="p">();</span> <span class="n">v</span>
<span class="go">1 + a^2 + a^4 + a^6 + O(a^7)</span>
</pre></div>
</div>
<p>However, observe that the precision increases to its original value 
when we recompute the square of the square root:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span><span class="o">^</span><span class="mi">2</span>
<span class="go">1 + a^4 + a^5 + a^7 + a^8 + O(a^10)</span>
</pre></div>
</div>
<p>If the input does not have enough precision in order to determine if
the given element has a square root in the ground field, an error is 
raised:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">PrecisionError</span>: <span class="n">not enough precision to be sure that this element has a square root</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">()</span>
<span class="go">1 + O(a^4)</span>

<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">a</span><span class="o">^</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">square_root</span><span class="p">(</span><span class="n">extend</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">element is not a square</span>
</pre></div>
</div>
<p>In particular, an error is raised when we try to compute the square
root of an inexact zero.</p>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.str">
<code class="descname">str</code><span class="sig-paren">(</span><em>mode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string representation of self.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="n">print_mode</span><span class="o">=</span><span class="s1">&#39;bars&#39;</span><span class="p">)(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">()[</span><span class="mi">3</span><span class="p">:]</span>
<span class="go">&#39;1|3|1|3|2&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.trace">
<code class="descname">trace</code><span class="sig-paren">(</span><em>base=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the trace of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the base ring</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">base</span></code> – a subring of the parent (default: base ring)</li>
</ul>
<p>OUTPUT:</p>
<p>The trace of this <span class="math notranslate nohighlight">\(p\)</span>-adic element over the given base.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">5 + O(5^6)</span>

<span class="gp">sage: </span><span class="n">K</span><span class="o">.&lt;</span><span class="n">a</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QqCR</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">S</span><span class="o">.&lt;</span><span class="n">x</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.&lt;</span><span class="n">pi</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">K</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">a</span><span class="o">*</span><span class="n">x</span><span class="o">^</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>

<span class="gp">sage: </span><span class="n">pi</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>  <span class="c1"># trace over K</span>
<span class="go">a*2^2 + O(2^8)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">pi</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">trace</span><span class="p">()</span>
<span class="go">(a + 1)*2^2 + O(2^7)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit">
<code class="descname">val_unit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.val_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return <code class="docutils literal notranslate"><span class="pre">(self.valuation(),</span> <span class="pre">self.unit_part())</span></code>. To be overridden in
derived classes.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">val_unit</span><span class="p">()</span>
<span class="go">(1, 1 + O(5^5))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation">
<code class="descname">valuation</code><span class="sig-paren">(</span><em>p=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.valuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the valuation of this element.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">self</span></code> – a p-adic element</li>
<li><code class="docutils literal notranslate"><span class="pre">p</span></code> – a prime (default: None). If specified, will make sure that p==self.parent().prime()</li>
</ul>
<p>NOTE: The optional argument p is used for consistency with the valuation methods on integer and rational.</p>
<p>OUTPUT:</p>
<p>integer – the valuation of self</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">17</span><span class="o">^</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">2</span>
<span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span><span class="s1">&#39;capped-rel&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">valuation</span><span class="p">()</span>
<span class="go">+Infinity</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd">
<code class="descname">xgcd</code><span class="sig-paren">(</span><em>other</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.xgcd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the extended gcd of this element and <code class="docutils literal notranslate"><span class="pre">other</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">other</span></code> – an element in the same ring</li>
</ul>
<p>OUTPUT:</p>
<p>A tuple <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">s</span></code>, <code class="docutils literal notranslate"><span class="pre">t</span></code> such that <code class="docutils literal notranslate"><span class="pre">r</span></code> is a greatest common
divisor of this element and <code class="docutils literal notranslate"><span class="pre">other</span></code> and <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span> <span class="pre">t*other</span></code>.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Julian Rueth (2012-10-19): initial version</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Since the elements are only given with finite precision, their
greatest common divisor is in general not unique (not even up to
units). For example <span class="math notranslate nohighlight">\(O(3)\)</span> is a representative for the elements 0
and 3 in the 3-adic ring <span class="math notranslate nohighlight">\(\ZZ_3\)</span>. The greatest common
divisor of <span class="math notranslate nohighlight">\(O(3)\)</span> and <span class="math notranslate nohighlight">\(O(3)\)</span> could be (among others) 3 or 0 which
have different valuation. The algorithm implemented here, will
return an element of minimal valuation among the possible greatest
common divisors.</p>
</div>
<p>EXAMPLES:</p>
<p>The greatest common divisor is either zero or a power of the
uniformizing parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">Zp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">())</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">(3 + O(3^21), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Unlike for <a class="reference internal" href="#sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd" title="sage.rings.padics.padic_generic_element.pAdicGenericElement.gcd"><code class="xref py py-meth docutils literal notranslate"><span class="pre">gcd()</span></code></a>, the result is not lifted to the maximal
precision possible in the ring; it is such that <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">=</span> <span class="pre">s*self</span> <span class="pre">+</span>
<span class="pre">t*other</span></code> holds true:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">a</span>
<span class="go">3 + O(3^2)</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span> <span class="n">b</span>
<span class="go">3^2 + O(3^3)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(3 + O(3^2), 1 + O(3), 0)</span>
</pre></div>
</div>
<p>If both elements are zero, then the result is zero with
the precision set to the smallest of their precisions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="o">.</span><span class="n">zero</span><span class="p">();</span> <span class="n">a</span>
<span class="go">0</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span> <span class="n">b</span>
<span class="go">O(3^2)</span>
<span class="gp">sage: </span><span class="n">a</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
</pre></div>
</div>
<p>If only one element is zero, then the result depends on its precision:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(O(3), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">R</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="go">(3^2 + O(3^22), 1 + O(3^20), 0)</span>
</pre></div>
</div>
<p>Over a field, the greatest common divisor is either zero (possibly with
finite precision) or one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">Qp</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">(0, 1 + O(3^20), 0)</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">zero</span><span class="p">()</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="n">K</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="go">(O(3^2), 0, 1 + O(3^20))</span>
<span class="gp">sage: </span><span class="n">K</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">xgcd</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1 + O(3^20), 3^-1 + O(3^19), 0)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="local_generic_element.html"
                        title="previous chapter">Local Generic Element</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="padic_capped_relative_element.html"
                        title="next chapter"><span class="math notranslate nohighlight">\(p\)</span>-Adic Capped Relative Elements</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/rings/padics/padic_generic_element.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="padic_capped_relative_element.html" title="\(p\)-Adic Capped Relative Elements"
             >next</a> |</li>
        <li class="right" >
          <a href="local_generic_element.html" title="Local Generic Element"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">p-Adics</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>