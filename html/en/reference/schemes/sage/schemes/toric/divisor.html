
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Toric divisors and divisor classes &#8212; Sage Reference Manual v8.6: Schemes</title>
    <link rel="stylesheet" href="../../../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="../../../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Toric rational divisor classes" href="divisor_class.html" />
    <link rel="prev" title="Library of toric varieties" href="library.html" />
    <link rel="icon" href="../../../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="divisor_class.html" title="Toric rational divisor classes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="library.html" title="Library of toric varieties"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Schemes</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="toric-divisors-and-divisor-classes">
<span id="sage-schemes-toric-divisor"></span><h1>Toric divisors and divisor classes<a class="headerlink" href="#toric-divisors-and-divisor-classes" title="Permalink to this headline">Â¶</a></h1>
<span class="target" id="module-sage.schemes.toric.divisor"></span><p>Let <span class="math notranslate nohighlight">\(X\)</span> be a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a> corresponding to a
<a class="reference external" href="../../../../discrete_geometry/sage/geometry/fan.html#sage.geometry.fan.RationalPolyhedralFan" title="(in Sage Reference Manual: Combinatorial and Discrete Geometry v8.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">rational</span> <span class="pre">polyhedral</span> <span class="pre">fan</span></code></a>
<span class="math notranslate nohighlight">\(\Sigma\)</span>. A <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">divisor</span></code></a> <span class="math notranslate nohighlight">\(D\)</span> is a T-Weil
divisor over a given coefficient ring (usually <span class="math notranslate nohighlight">\(\ZZ\)</span> or <span class="math notranslate nohighlight">\(\QQ\)</span>), i.e. a formal
linear combination of torus-invariant subvarieties of <span class="math notranslate nohighlight">\(X\)</span> of codimension one.
In homogeneous coordinates <span class="math notranslate nohighlight">\([z_0:\cdots:z_k]\)</span>, these are the subvarieties
<span class="math notranslate nohighlight">\(\{z_i=0\}\)</span>. Note that there is a finite number of such subvarieties, one for
each ray of <span class="math notranslate nohighlight">\(\Sigma\)</span>. We generally identify</p>
<blockquote>
<div><ul class="simple">
<li>Toric divisor <span class="math notranslate nohighlight">\(D\)</span>,</li>
<li>Sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span> (if <span class="math notranslate nohighlight">\(D\)</span> is Cartier, it is a line bundle),</li>
<li>Support function <span class="math notranslate nohighlight">\(\phi_D\)</span> (if <span class="math notranslate nohighlight">\(D\)</span> is <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier, it is a function
linear on each cone of <span class="math notranslate nohighlight">\(\Sigma\)</span>).</li>
</ul>
</div></blockquote>
<p>EXAMPLES:</p>
<p>We start with an illustration of basic divisor arithmetic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="p">,</span><span class="n">Du</span><span class="p">,</span><span class="n">Dy</span><span class="p">,</span><span class="n">Dv</span><span class="p">,</span><span class="n">Dz</span><span class="p">,</span><span class="n">Dw</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">Dx</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="o">-</span><span class="n">Dx</span>
<span class="go">-V(x)</span>
<span class="gp">sage: </span><span class="mi">2</span><span class="o">*</span><span class="n">Dx</span>
<span class="go">2*V(x)</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">*</span><span class="mi">2</span>
<span class="go">2*V(x)</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">Dx</span> <span class="o">+</span> <span class="n">Dy</span><span class="o">/</span><span class="mi">3</span> <span class="o">-</span> <span class="n">Dz</span>
<span class="go">1/2*V(x) + 1/3*V(y) - V(z)</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">Dx</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric QQ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
</pre></div>
</div>
<p>Now we create a more complicated variety to demonstrate divisors of different
types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="go">....:     rays=[(1,1,1), (1,-1,1), (1,-1,-1), (1,1,-1), (0,0,1)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cartier</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">QQ_Cartier</span>
<span class="gp">sage: </span><span class="n">Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="n">Weil</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">QQ_Weil</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="go">....:  QQ_Weil.is_Weil(),</span>
<span class="go">....:  QQ_Weil.is_QQ_Cartier(),</span>
<span class="go">....:  QQ_Weil.is_Cartier()]</span>
<span class="go">[True, False, False, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Weil</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="go">....:  Weil.is_Weil(),</span>
<span class="go">....:  Weil.is_QQ_Cartier(),</span>
<span class="go">....:  Weil.is_Cartier()]</span>
<span class="go">[True, True, False, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="go">....:  QQ_Cartier.is_Weil(),</span>
<span class="go">....:  QQ_Cartier.is_QQ_Cartier(),</span>
<span class="go">....:  QQ_Cartier.is_Cartier()]</span>
<span class="go">[True, True, True, False]</span>
<span class="gp">sage: </span><span class="p">[</span><span class="n">Cartier</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">(),</span>
<span class="go">....:  Cartier.is_Weil(),</span>
<span class="go">....:  Cartier.is_QQ_Cartier(),</span>
<span class="go">....:  Cartier.is_Cartier()]</span>
<span class="go">[True, True, True, True]</span>
</pre></div>
</div>
<p>The toric (<span class="math notranslate nohighlight">\(\QQ\)</span>-Weil) divisors on a toric variety <span class="math notranslate nohighlight">\(X\)</span> modulo linear
equivalence generate the divisor <strong>class group</strong> <span class="math notranslate nohighlight">\(\mathrm{Cl}(X)\)</span>, implemented
by <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.  If <span class="math notranslate nohighlight">\(X\)</span> is smooth, this equals the
<strong>Picard group</strong> <span class="math notranslate nohighlight">\(\mathop{\mathrm{Pic}}(X)\)</span>. We continue using del Pezzo
surface of degree 6 introduced above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Cl</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">();</span> <span class="n">Cl</span>
<span class="go">The toric rational divisor class group</span>
<span class="go">of a 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">Cl</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="p">,</span><span class="n">c1</span><span class="p">,</span><span class="n">c2</span><span class="p">,</span><span class="n">c3</span> <span class="o">=</span> <span class="n">Cl</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">c0</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">c1</span> <span class="o">-</span> <span class="n">c3</span><span class="p">;</span> <span class="n">c</span>
<span class="go">Divisor class [1, 2, 0, -1]</span>
</pre></div>
</div>
<p>Divisors are mapped to their classes and lifted via:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">Dx</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span> <span class="ow">in</span> <span class="n">Cl</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">Dw</span><span class="o">+</span><span class="n">Dv</span><span class="o">+</span><span class="n">Dy</span><span class="p">)</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">c0</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">c0</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(x)</span>
</pre></div>
</div>
<p>The (rational) divisor class group is where the Kaehler cone lives:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">Kc</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">();</span> <span class="n">Kc</span>
<span class="go">4-d cone in 4-d lattice</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Divisor class [0, 1, 1, 0],</span>
<span class="go">Divisor class [0, 0, 1, 1],</span>
<span class="go">Divisor class [1, 1, 0, 0],</span>
<span class="go">Divisor class [1, 1, 1, 0],</span>
<span class="go">Divisor class [0, 1, 1, 1]</span>
<span class="go">in Basis lattice of The toric rational divisor class group</span>
<span class="go">of a 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">Kc</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(y) + V(v)</span>
</pre></div>
</div>
<p>Given a divisor <span class="math notranslate nohighlight">\(D\)</span>, we have an associated line bundle (or a reflexive
sheaf, if <span class="math notranslate nohighlight">\(D\)</span> is not Cartier) <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>. Its sections are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">H</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(-1, 0), M(-1, 1), M(0, 0))</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
</pre></div>
</div>
<p>Note that the space of sections is always spanned by
monomials. Therefore, we can grade the sections (as homogeneous
monomials) by their weight under rescaling individual
coordinates. This weight data amounts to a point of the dual lattice.</p>
<p>In the same way, we can grade cohomology groups by their cohomological
degree and a weight:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span><span class="o">.</span><span class="n">dual</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">H</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a more complicated example with <span class="math notranslate nohighlight">\(h^1(dP_6, \mathcal{O}(D))=4\)</span></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 4, 0)</span>
</pre></div>
</div>
<p>AUTHORS:</p>
<ul class="simple">
<li>Volker Braun, Andrey Novoseltsev (2010-09-07): initial version.</li>
</ul>
<dl class="function">
<dt id="sage.schemes.toric.divisor.ToricDivisor">
<code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">ToricDivisor</code><span class="sig-paren">(</span><em>toric_variety</em>, <em>arg=None</em>, <em>ring=None</em>, <em>check=True</em>, <em>reduce=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Construct a divisor of <code class="docutils literal notranslate"><span class="pre">toric_variety</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> â a <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span></code></a>;</li>
<li><code class="docutils literal notranslate"><span class="pre">arg</span></code> â one of the following description of the toric divisor to be
constructed:<ul>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> or 0 (the trivial divisor);</li>
<li>monomial in the homogeneous coordinates;</li>
<li>one-dimensional cone of the fan of <code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> or a lattice
point generating such a cone;</li>
<li>sequence of rational numbers, specifying multiplicities for each of
the toric divisors.</li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">ring</span></code> â usually either <span class="math notranslate nohighlight">\(\ZZ\)</span> or <span class="math notranslate nohighlight">\(\QQ\)</span>. The base ring of the
divisor group. If <code class="docutils literal notranslate"><span class="pre">ring</span></code> is not specified, a coefficient ring
suitable for <code class="docutils literal notranslate"><span class="pre">arg</span></code> is derived.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> â bool (default: True). Whether to coerce
coefficients into base ring. Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> can speed
up construction.</li>
<li><code class="docutils literal notranslate"><span class="pre">reduce</span></code> â reduce (default: True). Whether to combine common
terms. Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> can speed up construction.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The coefficients of the divisor must be in the base ring and
the terms must be reduced. If you set <code class="docutils literal notranslate"><span class="pre">check=False</span></code> and/or
<code class="docutils literal notranslate"><span class="pre">reduce=False</span></code> it is your responsibility to pass valid input
data <code class="docutils literal notranslate"><span class="pre">arg</span></code>.</p>
</div>
<p>OUTPUT:</p>
<ul class="simple">
<li>A <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.toric.divisor.ToricDivisor_generic</span></code></a></li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.toric.divisor</span> <span class="kn">import</span> <span class="n">ToricDivisor</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="n">dP6</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">dP6</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">1</span><span class="p">))])</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, u, y, v, z, w</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">u</span><span class="o">+</span><span class="n">y</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">u + y is not a monomial!</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">u</span><span class="o">*</span><span class="n">y</span><span class="p">)</span>
<span class="go">V(u) + V(y)</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">cone</span> <span class="o">=</span> <span class="n">Cone</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">cone</span><span class="p">)</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">V(w)</span>
</pre></div>
</div>
<p>We attempt to guess the correct base ring:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="go">1/2*V(u)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric QQ-Weil divisors on</span>
<span class="go">2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="go">V(u)</span>
<span class="gp">sage: </span><span class="n">_</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors on</span>
<span class="go">2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="gp">sage: </span><span class="n">ToricDivisor</span><span class="p">(</span><span class="n">dP6</span><span class="p">,</span> <span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">u</span><span class="p">)])</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">Cannot deduce coefficient ring for [(u, u)]!</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup">
<em class="property">class </em><code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">ToricDivisorGroup</code><span class="sig-paren">(</span><em>toric_variety</em>, <em>base_ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/divisor_group.html#sage.schemes.generic.divisor_group.DivisorGroup_generic" title="sage.schemes.generic.divisor_group.DivisorGroup_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.generic.divisor_group.DivisorGroup_generic</span></code></a></p>
<p>The group of (<span class="math notranslate nohighlight">\(\QQ\)</span>-T-Weil) divisors on a toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 3 affine patches</span>
</pre></div>
</div>
<dl class="class">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup.Element">
<em class="property">class </em><code class="descname">Element</code><span class="sig-paren">(</span><em>v</em>, <em>parent</em>, <em>check=True</em>, <em>reduce=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.Element" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/divisor.html#sage.schemes.generic.divisor.Divisor_generic" title="sage.schemes.generic.divisor.Divisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.generic.divisor.Divisor_generic</span></code></a></p>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup.base_extend">
<code class="descname">base_extend</code><span class="sig-paren">(</span><em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.base_extend" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Extend the scalars of <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">R</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">R</span></code> â ring.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>toric divisor group.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DivZZ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DivQQ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">DivZZ</span><span class="o">.</span><span class="n">base_extend</span><span class="p">(</span><span class="n">QQ</span><span class="p">)</span> <span class="ow">is</span> <span class="n">DivQQ</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup.gen">
<code class="descname">gen</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gen" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the <code class="docutils literal notranslate"><span class="pre">i</span></code>-th generator of the divisor group.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">i</span></code> â integer.</li>
</ul>
<p>OUTPUT:</p>
<p>The divisor <span class="math notranslate nohighlight">\(z_i=0\)</span>, where <span class="math notranslate nohighlight">\(z_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th homogeneous
coordinate.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="go">V(z)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup.gens">
<code class="descname">gens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.gens" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the generators of the divisor group.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">gens</span><span class="p">()</span>
<span class="go">(V(x), V(y), V(z))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisorGroup.ngens">
<code class="descname">ngens</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisorGroup.ngens" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the number of generators.</p>
<p>OUTPUT:</p>
<p>The number of generators of <code class="docutils literal notranslate"><span class="pre">self</span></code>, which equals the number of
rays in the fan of the toric variety.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">TDiv</span><span class="o">.</span><span class="n">ngens</span><span class="p">()</span>
<span class="go">3</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic">
<em class="property">class </em><code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">ToricDivisor_generic</code><span class="sig-paren">(</span><em>v</em>, <em>parent</em>, <em>check=True</em>, <em>reduce=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../generic/divisor.html#sage.schemes.generic.divisor.Divisor_generic" title="sage.schemes.generic.divisor.Divisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.schemes.generic.divisor.Divisor_generic</span></code></a></p>
<p>Construct a <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">(toric</span> <span class="pre">Weil)</span> <span class="pre">divisor</span></code></a> on the
given toric variety.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">v</span></code> â a list of tuples (multiplicity, coordinate).</li>
<li><code class="docutils literal notranslate"><span class="pre">parent</span></code> â <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisorGroup" title="sage.schemes.toric.divisor.ToricDivisorGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisorGroup</span></code></a>. The parent divisor group.</li>
<li><code class="docutils literal notranslate"><span class="pre">check</span></code> â boolean. Type-check the entries of <code class="docutils literal notranslate"><span class="pre">v</span></code>, see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.schemes.generic.divisor_group.DivisorGroup_generic.__init__()</span></code>.</li>
<li><code class="docutils literal notranslate"><span class="pre">reduce</span></code> â boolean. Combine coefficients in <code class="docutils literal notranslate"><span class="pre">v</span></code>, see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">sage.schemes.generic.divisor_group.DivisorGroup_generic.__init__()</span></code>.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not construct <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a> objects manually.
Instead, use either the function <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor" title="sage.schemes.toric.divisor.ToricDivisor"><code class="xref py py-func docutils literal notranslate"><span class="pre">ToricDivisor()</span></code></a> or the method
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.divisor" title="sage.schemes.toric.variety.ToricVariety_field.divisor"><code class="xref py py-meth docutils literal notranslate"><span class="pre">divisor()</span></code></a>
of toric varieties.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ray</span>
<span class="go">N(0, 1)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">ray</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">Group of toric ZZ-Weil divisors</span>
<span class="go">on 2-d CPR-Fano toric variety covered by 6 affine patches</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.Chern_character">
<code class="descname">Chern_character</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chern_character" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the Chern character of the sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>
defined by the divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>You can also use a shortcut <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="sage.schemes.toric.divisor.ToricDivisor_generic.ch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ch()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Chern_character</span><span class="p">()</span>
<span class="go">[5*w^2 + y - 2*v + w + 1]</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">()</span> <span class="p">)</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.Chow_cycle">
<code class="descname">Chow_cycle</code><span class="sig-paren">(</span><em>ring=Integer Ring</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Chow_cycle" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Returns the Chow homology class of the divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">ring</span></code> â Either <code class="docutils literal notranslate"><span class="pre">ZZ</span></code> (default) or <code class="docutils literal notranslate"><span class="pre">QQ</span></code>. The base ring
of the Chow group.</li>
</ul>
<p>OUTPUT:</p>
<p>The <a class="reference internal" href="chow_group.html#sage.schemes.toric.chow_group.ChowCycle" title="sage.schemes.toric.chow_group.ChowCycle"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChowCycle</span></code></a>
represented by the divisor.</p>
<p>EXAMPLES:</p>
<blockquote>
<div>sage: dP6 = toric_varieties.dP6()
sage: cone = dP6.fan(1)[0]
sage: D = dP6.divisor(cone); D
V(x)
sage: D.Chow_cycle()
( 0 | -1, 0, 1, 1 | 0 )
sage: dP6.Chow_group()(cone)
( 0 | -1, 0, 1, 1 | 0 )</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.Kodaira_map">
<code class="descname">Kodaira_map</code><span class="sig-paren">(</span><em>names='z'</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.Kodaira_map" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the Kodaira map.</p>
<p>The Kodaira map is the rational map <span class="math notranslate nohighlight">\(X_\Sigma \to
\mathbb{P}^{n-1}\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> equals the number of sections. It
is defined by the monomial sections of the line bundle.</p>
<p>If the divisor is ample and the toric variety smooth or of
dimension 2, then this is an embedding.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">names</span></code> â string (optional; default <code class="docutils literal notranslate"><span class="pre">'z'</span></code>). The
variable names for the destination projective space.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1</span><span class="o">.&lt;</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">P1</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Kodaira_map</span><span class="p">()</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 1-d CPR-Fano toric variety covered by 2 affine patches</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 2 </span>
<span class="go">        over Rational Field defined by:</span>
<span class="go">  -z1^2 + z0*z2</span>
<span class="go">  Defn: Defined on coordinates by sending [u : v] to</span>
<span class="go">        (v^2 : u*v : u^2)</span>

<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">dP6</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Kodaira_map</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="go">Scheme morphism:</span>
<span class="go">  From: 2-d CPR-Fano toric variety covered by 6 affine patches</span>
<span class="go">  To:   Closed subscheme of Projective Space of dimension 6</span>
<span class="go">        over Rational Field defined by:</span>
<span class="go">  -x1*x5 + x0*x6,</span>
<span class="go">  -x2*x3 + x0*x5,</span>
<span class="go">  -x1*x3 + x0*x4,</span>
<span class="go">  x4*x5 - x3*x6,</span>
<span class="go">  -x1*x2 + x0*x3,</span>
<span class="go">  x3*x5 - x2*x6,</span>
<span class="go">  x3*x4 - x1*x6,</span>
<span class="go">  x3^2 - x1*x5,</span>
<span class="go">  x2*x4 - x1*x5,</span>
<span class="go">  -x1*x5^2 + x2*x3*x6,</span>
<span class="go">  -x1*x5^3 + x2^2*x6^2</span>
<span class="go">  Defn: Defined on coordinates by sending [x : u : y : v : z : w] to</span>
<span class="go">        (x*u^2*y^2*v : x^2*u^2*y*w : u*y^2*v^2*z : x*u*y*v*z*w : </span>
<span class="go">         x^2*u*z*w^2 : y*v^2*z^2*w : x*v*z^2*w^2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.ch">
<code class="descname">ch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the Chern character of the sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>
defined by the divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>You can also use a shortcut <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.ch" title="sage.schemes.toric.divisor.ToricDivisor_generic.ch"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ch()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>   <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>  <span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">Chern_character</span><span class="p">()</span>
<span class="go">[5*w^2 + y - 2*v + w + 1]</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">()</span> <span class="p">)</span>
<span class="go">-4</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.coefficient">
<code class="descname">coefficient</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.coefficient" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the coefficient of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">x</span></code> â one of the homogeneous coordinates, either given by
the variable or its index.</li>
</ul>
<p>OUTPUT:</p>
<p>The coefficient of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">));</span> <span class="n">D</span>
<span class="go">11*V(x) + 12*V(y) + 13*V(z)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">12</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">inject_variables</span><span class="p">()</span>
<span class="go">Defining x, y, z</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">coefficient</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">12</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology">
<code class="descname">cohomology</code><span class="sig-paren">(</span><em>weight=None</em>, <em>deg=None</em>, <em>dim=False</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the cohomology of the line bundle associated to the
Cartier divisor or reflexive sheaf associated to the Weil
divisor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The cohomology of a toric line bundle/reflexive sheaf is
graded by the usual degree as well as by the <span class="math notranslate nohighlight">\(M\)</span>-lattice.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">weight</span></code> â (optional) a point of the <span class="math notranslate nohighlight">\(M\)</span>-lattice.</li>
<li><code class="docutils literal notranslate"><span class="pre">deg</span></code> â (optional) the degree of the cohomology group.</li>
<li><code class="docutils literal notranslate"><span class="pre">dim</span></code> â boolean. If <code class="docutils literal notranslate"><span class="pre">False</span></code> (default), the cohomology
groups are returned as vector spaces. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, only the
dimension of the vector space(s) is returned.</li>
</ul>
<p>OUTPUT:</p>
<p>The vector space <span class="math notranslate nohighlight">\(H^\text{deg}(X,\mathcal{O}(D))\)</span> (if <code class="docutils literal notranslate"><span class="pre">deg</span></code>
is specified) or a dictionary <code class="docutils literal notranslate"><span class="pre">{degree:cohomology(degree)}</span></code>
of all degrees between 0 and the dimension of the variety.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">weight</span></code> is specified, return only the subspace
<span class="math notranslate nohighlight">\(H^\text{deg}(X,\mathcal{O}(D))_\text{weight}\)</span> of the
cohomology of the given weight.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">dim==True</span></code>, the dimension of the cohomology vector space
is returned instead of actual vector space. Moreover, if
<code class="docutils literal notranslate"><span class="pre">deg</span></code> was not specified, a vector whose entries are the
dimensions is returned instead of a dictionary.</p>
<p>ALGORITHM:</p>
<p>Roughly, Chech cohomology is used to compute the
cohomology. For toric divisors, the local sections can be
chosen to be monomials (instead of general homogeneous
polynomials), this is the reason for the extra grading by
<span class="math notranslate nohighlight">\(m\in M\)</span>. General references would be <a class="reference internal" href="../../../../references/index.html#fu1993" id="id1">[Fu1993]</a>, <a class="reference internal" href="variety.html#cls" id="id2">[CLS]</a>. Here
are some salient features of our implementation:</p>
<ul>
<li><p class="first">First, a finite set of <span class="math notranslate nohighlight">\(M\)</span>-lattice points is identified that
supports the cohomology. The toric divisor determines a
(polyhedral) chamber decomposition of <span class="math notranslate nohighlight">\(M_\RR\)</span>, see Section
9.1 and Figure 4 of <a class="reference internal" href="variety.html#cls" id="id3">[CLS]</a>. The cohomology vanishes on the
non-compact chambers. Hence, the convex hull of the vertices
of the chamber decomposition contains all non-vanishing
cohomology groups. This is returned by the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_cohomology_support()</span></code>.</p>
<p>It would be more efficient, but more difficult to implement,
to keep track of all of the individual chambers. We leave
this for future work.</p>
</li>
<li><p class="first">For each point <span class="math notranslate nohighlight">\(m\in M\)</span>, the weight-<span class="math notranslate nohighlight">\(m\)</span> part of the
cohomology can be rewritten as the cohomology of a
simplicial complex, see Exercise 9.1.10 of <a class="reference internal" href="variety.html#cls" id="id4">[CLS]</a>,
<a class="reference internal" href="#perling" id="id5">[Perling]</a>. This is returned by the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_complex()</span></code>.</p>
<p>The simplicial complex is the same for all points in a
chamber, but we currently do not make use of this and
compute each point <span class="math notranslate nohighlight">\(m\in M\)</span> separately.</p>
</li>
<li><p class="first">Finally, the cohomology (over <span class="math notranslate nohighlight">\(\QQ\)</span>) of this simplicial
complex is computed in the private method
<code class="xref py py-meth docutils literal notranslate"><span class="pre">_sheaf_cohomology()</span></code>. Summing over the supporting
points <span class="math notranslate nohighlight">\(m\in M\)</span> yields the cohomology of the sheaf`.</p>
</li>
</ul>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="perling" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[Perling]</a></td><td>Markus Perling: Divisorial Cohomology Vanishing on Toric Varieties,
<a class="reference external" href="https://arxiv.org/abs/0711.4836v2">Arxiv 0711.4836v2</a></td></tr>
</tbody>
</table>
<p>EXAMPLES:</p>
<p>Example 9.1.7 of Cox, Little, Schenck: âToric Varietiesâ <a class="reference internal" href="variety.html#cls" id="id6">[CLS]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="go">....:         rays=[(1,0), (1,1), (0,1), (-1,0), (-1,-1), (0,-1)])</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 4 over Rational Field</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 1 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span> <span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span> <span class="p">)</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">dP6</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP6</span><span class="o">.</span><span class="n">Td</span><span class="p">()</span> <span class="p">)</span>
<span class="go">-4</span>
</pre></div>
</div>
<p>Note the different output options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">()</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 4 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 4, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">{0: Vector space of dimension 0 over Rational Field,</span>
<span class="go"> 1: Vector space of dimension 1 over Rational Field,</span>
<span class="go"> 2: Vector space of dimension 0 over Rational Field}</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 1, 0)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 4 over Rational Field</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">Vector space of dimension 1 over Rational Field</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
<p>Here is a Weil (non-Cartier) divisor example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_nonpolyhedral</span><span class="p">()</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">K</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(0, 0, 0, 1)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_class">
<code class="descname">cohomology_class</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_class" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the degree-2 cohomology class associated to the divisor.</p>
<p>OUTPUT:</p>
<p>Returns the corresponding cohomology class as an instance of
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.CohomologyClass" title="sage.schemes.toric.variety.CohomologyClass"><code class="xref py py-class docutils literal notranslate"><span class="pre">CohomologyClass</span></code></a>.
The cohomology class is the first Chern class of the
associated line bundle <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="n">dP6</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology_class</span><span class="p">()</span>
<span class="go">[y + v - w]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_support">
<code class="descname">cohomology_support</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.cohomology_support" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the weights for which the cohomology groups do not vanish.</p>
<p>OUTPUT:</p>
<p>A tuple of dual lattice points. <code class="docutils literal notranslate"><span class="pre">self.cohomology(weight=m)</span></code>
does not vanish if and only if <code class="docutils literal notranslate"><span class="pre">m</span></code> is in the output.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is provided for educational purposes and it is
not an efficient way of computing the cohomology groups.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="go">....:         rays=[(1,0), (1,1), (0,1), (-1,0), (-1,-1), (0,-1)])</span>
<span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D3</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D5</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D6</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="o">-</span><span class="n">D3</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">D5</span> <span class="o">-</span> <span class="n">D6</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology_support</span><span class="p">()</span>
<span class="go">(M(0, 0), M(1, 0), M(2, 0), M(1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class">
<code class="descname">divisor_class</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the linear equivalence class of the divisor.</p>
<p>OUTPUT:</p>
<p>Returns the class of the divisor in <span class="math notranslate nohighlight">\(\mathop{Cl}(X)
\otimes_\ZZ \QQ\)</span> as an instance of
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP6</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP6</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP6</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.function_value">
<code class="descname">function_value</code><span class="sig-paren">(</span><em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.function_value" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the value of the support function at <code class="docutils literal notranslate"><span class="pre">point</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be the ambient toric variety of <code class="docutils literal notranslate"><span class="pre">self</span></code>, <span class="math notranslate nohighlight">\(\Sigma\)</span> the fan
associated to <span class="math notranslate nohighlight">\(X\)</span>, and <span class="math notranslate nohighlight">\(N\)</span> the ambient lattice of <span class="math notranslate nohighlight">\(\Sigma\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">point</span></code> â either an integer, interpreted as the index of a ray of
<span class="math notranslate nohighlight">\(\Sigma\)</span>, or a point of the lattice <span class="math notranslate nohighlight">\(N\)</span>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>an integer or a rational number.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">11</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">44</span><span class="p">])</span>   <span class="c1"># total degree 77</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">11</span>
<span class="gp">sage: </span><span class="n">N</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span> <span class="n">N</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
<span class="go">33</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">function_value</span><span class="p">(</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">ray</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_Cartier">
<code class="descname">is_Cartier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Cartier" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the divisor is a Cartier-divisor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The sheaf <span class="math notranslate nohighlight">\(\mathcal{O}(D)\)</span> associated to the given divisor
<span class="math notranslate nohighlight">\(D\)</span> is a line bundle if and only if the divisor is
Cartier.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P4_11169</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_Cartier</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Cartier">
<code class="descname">is_QQ_Cartier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Cartier" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the divisor is a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor.</p>
<p>A <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is a divisor such that some multiple
of it is Cartier.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P4_11169</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">Cube_face_fan</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Cartier</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Weil">
<code class="descname">is_QQ_Weil</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_QQ_Weil" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the divisor is a <span class="math notranslate nohighlight">\(\QQ\)</span>-Weil-divisor.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This function returns always <code class="docutils literal notranslate"><span class="pre">True</span></code> since
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor</span></code></a> can only
describe <span class="math notranslate nohighlight">\(\QQ\)</span>-Weil divisors.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_QQ_Weil</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_Weil">
<code class="descname">is_Weil</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_Weil" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the divisor is a Weil-divisor.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="n">D</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">is_Weil</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_ample">
<code class="descname">is_ample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_ample" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is ample.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> if the divisor is in the ample cone, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>For a QQ-Cartier divisor, some positive integral
multiple is Cartier. We return whether this associated
divisor is ample, i.e. corresponds to an ample line bundle.</li>
<li>In the orbifold case, the ample cone is an open
and full-dimensional cone in the rational divisor class
group <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>.</li>
<li>If the variety has worse than orbifold singularities,
the ample cone is a full-dimensional cone within the
(not full-dimensional) subspace spanned by the Cartier
divisors inside the rational (Weil) divisor class group,
that is, <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClassGroup</span></code></a>. The
ample cone is then relative open (open in this
subspace).</li>
<li>See also <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_nef" title="sage.schemes.toric.divisor.ToricDivisor_generic.is_nef"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_nef()</span></code></a>.</li>
<li>A toric divisor is ample if and only if its support
function is strictly convex.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">+</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="variety.html#cls" id="id7">[CLS]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="go">....:           rays=[(-1,2), (0,1), (1,0), (0,-1)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">....:         if D(a,b).is_ample() ]</span>
<span class="go">[(1, 1), (1, 2), (2, 1), (2, 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">....:         if D(a,b).is_nef() ]</span>
<span class="go">[(0, 0), (0, 1), (0, 2), (1, 0),</span>
<span class="go"> (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]</span>
</pre></div>
</div>
<p>A (worse than orbifold) singular Fano threefold:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">facets</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="n">facets</span><span class="p">,</span> <span class="n">rays</span><span class="o">=</span><span class="n">points</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">()</span><span class="o">.</span><span class="n">dimension</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="n">X</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">()</span><span class="o">.</span><span class="n">rays</span><span class="p">()</span>
<span class="go">Divisor class [1, 0, 0, 0]</span>
<span class="go">in Basis lattice of The toric rational divisor class group</span>
<span class="go">of a 3-d toric variety covered by 7 affine patches</span>
<span class="gp">sage: </span><span class="n">antiK</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">antiK</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">()</span>
<span class="go">Divisor class [2, 0, 0, 0]</span>
<span class="gp">sage: </span><span class="n">antiK</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_integral">
<code class="descname">is_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_integral" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether the coefficients of the divisor are all integral.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">DZZ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">ZZ</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">DZZ</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">DQQ</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">toric_divisor_group</span><span class="p">(</span><span class="n">base_ring</span><span class="o">=</span><span class="n">QQ</span><span class="p">)</span><span class="o">.</span><span class="n">gen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">DQQ</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">DZZ</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">DQQ</span><span class="o">.</span><span class="n">is_integral</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.is_nef">
<code class="descname">is_nef</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_nef" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return whether a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor is nef.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> if the divisor is in the closure of the ample cone,
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>For a <span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor, some positive integral multiple is
Cartier. We return whether this associated divisor is nef.</li>
<li>The nef cone is the closure of the ample cone.</li>
<li>See also <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.is_ample" title="sage.schemes.toric.divisor.ToricDivisor_generic.is_ample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">is_ample()</span></code></a>.</li>
<li>A toric divisor is nef if and only if its support
function is convex (but not necessarily strictly
convex).</li>
<li>A toric Cartier divisor is nef if and only if its linear
system is basepoint free.</li>
</ul>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">+</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="p">(</span><span class="mi">0</span><span class="o">*</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="p">(</span><span class="o">-</span><span class="n">K</span><span class="p">)</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="variety.html#cls" id="id8">[CLS]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="go">....:           rays=[(-1,2), (0,1), (1,0), (0,-1)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="n">a</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span><span class="o">*</span><span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">....:         if D(a,b).is_ample() ]</span>
<span class="go">[(1, 1), (1, 2), (2, 1), (2, 2)]</span>
<span class="gp">sage: </span><span class="p">[</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">repeat</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">....:         if D(a,b).is_nef() ]</span>
<span class="go">[(0, 0), (0, 1), (0, 2), (1, 0),</span>
<span class="go"> (1, 1), (1, 2), (2, 0), (2, 1), (2, 2)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.m">
<code class="descname">m</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.m" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return <span class="math notranslate nohighlight">\(m_\sigma\)</span> representing <span class="math notranslate nohighlight">\(\phi_D\)</span> on <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>Let <span class="math notranslate nohighlight">\(X\)</span> be the ambient toric variety of this divisor <span class="math notranslate nohighlight">\(D\)</span> associated to
the fan <span class="math notranslate nohighlight">\(\Sigma\)</span> in lattice <span class="math notranslate nohighlight">\(N\)</span>. Let <span class="math notranslate nohighlight">\(M\)</span> be the lattice dual to <span class="math notranslate nohighlight">\(N\)</span>.
Given the cone <span class="math notranslate nohighlight">\(\sigma =\langle v_1, \dots, v_k \rangle\)</span> in <span class="math notranslate nohighlight">\(\Sigma\)</span>,
this method searches for a vector <span class="math notranslate nohighlight">\(m_\sigma \in M_\QQ\)</span> such that
<span class="math notranslate nohighlight">\(\phi_D(v_i) = \langle m_\sigma, v_i \rangle\)</span> for all <span class="math notranslate nohighlight">\(i=1, \dots, k\)</span>,
where <span class="math notranslate nohighlight">\(\phi_D\)</span> is the support function of <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">cone</span></code> â A cone in the fan of the toric variety.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>If possible, a point of lattice <span class="math notranslate nohighlight">\(M\)</span>.</li>
<li>If the dual vector cannot be chosen integral, a rational vector is
returned.</li>
<li>If there is no such vector (i.e. <code class="docutils literal notranslate"><span class="pre">self</span></code> is not even a
<span class="math notranslate nohighlight">\(\QQ\)</span>-Cartier divisor), a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="go">....:     rays=[(1,1,1), (1,-1,1), (1,-1,-1), (1,1,-1), (0,0,1)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">triangle_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">ray</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">ray</span><span class="p">)</span>
<span class="go">M(0, 2, 0)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">square_cone</span><span class="p">)</span>
<span class="go">(3/2, 0, 1/2)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="go">M(1, 0, 1)</span>
<span class="gp">sage: </span><span class="n">QQ_Cartier</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">Cone</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">))</span>
<span class="go">M(1, 0, 1)</span>
<span class="gp">sage: </span><span class="n">Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Weil</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">square_cone</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">V(z0) + V(z1) + V(z2) is not QQ-Cartier,</span>
<span class="go">cannot choose a dual vector on 3-d cone</span>
<span class="go">of Rational polyhedral fan in 3-d lattice N!</span>
<span class="gp">sage: </span><span class="n">Weil</span><span class="o">.</span><span class="n">m</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="go">M(1, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.monomial">
<code class="descname">monomial</code><span class="sig-paren">(</span><em>point</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.monomial" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the monomial in the homogeneous coordinate ring
associated to the <code class="docutils literal notranslate"><span class="pre">point</span></code> in the dual lattice.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">point</span></code> â a point in <code class="docutils literal notranslate"><span class="pre">self.variety().fan().dual_lattice()</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<p>For a fixed divisor <code class="docutils literal notranslate"><span class="pre">D</span></code>, the sections are generated by
monomials in <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.coordinate_ring" title="sage.schemes.toric.variety.ToricVariety_field.coordinate_ring"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ToricVariety.coordinate_ring</span></code></a>.
Alternatively, the monomials can be described as <span class="math notranslate nohighlight">\(M\)</span>-lattice
points in the polyhedron <code class="docutils literal notranslate"><span class="pre">D.polyhedron()</span></code>. This method
converts the points <span class="math notranslate nohighlight">\(m\in M\)</span> into homogeneous polynomials.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O3_P2</span> <span class="o">=</span> <span class="o">-</span><span class="n">P2</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">M</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">dual_lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">O3_P2</span><span class="o">.</span><span class="n">monomial</span><span class="p">(</span> <span class="n">M</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
<span class="go">x*y*z</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.move_away_from">
<code class="descname">move_away_from</code><span class="sig-paren">(</span><em>cone</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.move_away_from" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Move the divisor away from the orbit closure of <code class="docutils literal notranslate"><span class="pre">cone</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li>A <code class="docutils literal notranslate"><span class="pre">cone</span></code> of the fan of the toric variety.</li>
</ul>
<p>OUTPUT:</p>
<p>A (rationally equivalent) divisor that is moved off the
orbit closure of the given cone.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A divisor that is Weil but not Cartier might be impossible
to move away. In this case, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised.</p>
</div>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)],</span>
<span class="go">....:     rays=[(1,1,1), (1,-1,1), (1,-1,-1), (1,1,-1), (0,0,1)])</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">square_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">triangle_cone</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">cone_containing</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">line_cone</span> <span class="o">=</span> <span class="n">square_cone</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">triangle_cone</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">Cartier</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">Cartier</span>
<span class="go">2*V(z0) + 2*V(z1) + V(z2) + V(z3) + V(z4)</span>
<span class="gp">sage: </span><span class="n">Cartier</span><span class="o">.</span><span class="n">move_away_from</span><span class="p">(</span><span class="n">line_cone</span><span class="p">)</span>
<span class="go">-V(z2) - V(z3) + V(z4)</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">sage: </span><span class="n">QQ_Weil</span><span class="o">.</span><span class="n">move_away_from</span><span class="p">(</span><span class="n">line_cone</span><span class="p">)</span>
<span class="go">V(z2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.polyhedron">
<code class="descname">polyhedron</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.polyhedron" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the polyhedron <span class="math notranslate nohighlight">\(P_D\subset M\)</span> associated to a toric
divisor <span class="math notranslate nohighlight">\(D\)</span>.</p>
<p>OUTPUT:</p>
<p><span class="math notranslate nohighlight">\(P_D\)</span> as an instance of <a class="reference external" href="../../../../discrete_geometry/sage/geometry/polyhedron/base.html#sage.geometry.polyhedron.base.Polyhedron_base" title="(in Sage Reference Manual: Combinatorial and Discrete Geometry v8.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Polyhedron_base</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">dP7</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">dP7</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">dP7</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">P_D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">();</span> <span class="n">P_D</span>
<span class="go">A 0-dimensional polyhedron in QQ^2 defined as the convex hull of 1 vertex</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">dP7</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span> <span class="n">D</span><span class="o">.</span><span class="n">ch</span><span class="p">()</span> <span class="o">*</span> <span class="n">dP7</span><span class="o">.</span><span class="n">Td</span><span class="p">()</span> <span class="p">)</span>
<span class="go">1</span>
<span class="gp">sage: </span><span class="n">P_antiK</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="n">dP7</span><span class="o">.</span><span class="n">K</span><span class="p">())</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">();</span> <span class="n">P_antiK</span>
<span class="go">A 2-dimensional polyhedron in QQ^2 defined as the convex hull of 5 vertices</span>
<span class="gp">sage: </span><span class="n">P_antiK</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (1, -1), A vertex at (0, 1), A vertex at (1, 0),</span>
<span class="go"> A vertex at (-1, 1), A vertex at (-1, -1))</span>
<span class="gp">sage: </span><span class="n">P_antiK</span><span class="o">.</span><span class="n">integral_points</span><span class="p">()</span>
<span class="go">((-1, -1), (-1, 0), (-1, 1), (0, -1), (0, 0), (0, 1), (1, -1), (1, 0))</span>
</pre></div>
</div>
<p>Example 6.1.3, 6.1.11, 6.1.17 of <a class="reference internal" href="variety.html#cls" id="id9">[CLS]</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">fan</span> <span class="o">=</span> <span class="n">Fan</span><span class="p">(</span><span class="n">cones</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)],</span>
<span class="go">....:           rays=[(-1,2), (0,1), (1,0), (0,-1)])</span>
<span class="gp">sage: </span><span class="n">F2</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">fan</span><span class="p">,</span><span class="s1">&#39;u1, u2, u3, u4&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (0, 0), A vertex at (2, 1), A vertex at (0, 1))</span>
<span class="gp">sage: </span><span class="n">Dprime</span> <span class="o">=</span> <span class="n">F2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">D</span>
<span class="gp">sage: </span><span class="n">Dprime</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (2, 1), A vertex at (0, 1), A vertex at (0, 0))</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_ample</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">Dprime</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
</pre></div>
</div>
<p>A more complicated example where <span class="math notranslate nohighlight">\(P_D\)</span> is not a lattice polytope:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">BCdlOG_base</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">antiK</span> <span class="o">=</span> <span class="o">-</span><span class="n">X</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P_D</span> <span class="o">=</span> <span class="n">antiK</span><span class="o">.</span><span class="n">polyhedron</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P_D</span>
<span class="go">A 3-dimensional polyhedron in QQ^3 defined as the convex hull of 8 vertices</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Vrepresentation</span><span class="p">()</span>
<span class="go">(A vertex at (1, -1, 0), A vertex at (1, -3, 1),</span>
<span class="go"> A vertex at (1, 1, 1), A vertex at (-5, 1, 1),</span>
<span class="go"> A vertex at (1, 1, -1/2), A vertex at (1, 1/2, -1/2),</span>
<span class="go"> A vertex at (-1, -1, 0), A vertex at (-5, -3, 1))</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">Hrepresentation</span><span class="p">()</span>
<span class="go">(An inequality (-1, 0, 0) x + 1 &gt;= 0, An inequality (0, -1, 0) x + 1 &gt;= 0,</span>
<span class="go"> An inequality (0, 0, -1) x + 1 &gt;= 0, An inequality (1, 0, 4) x + 1 &gt;= 0,</span>
<span class="go"> An inequality (0, 1, 3) x + 1 &gt;= 0, An inequality (0, 1, 2) x + 1 &gt;= 0)</span>
<span class="gp">sage: </span><span class="n">P_D</span><span class="o">.</span><span class="n">integral_points</span><span class="p">()</span>
<span class="go">((-1, -1, 0), (0, -1, 0), (1, -1, 0), (-1, 0, 0), (0, 0, 0),</span>
<span class="go"> (1, 0, 0), (-1, 1, 0), (0, 1, 0), (1, 1, 0), (-5, -3, 1),</span>
<span class="go"> (-4, -3, 1), (-3, -3, 1), (-2, -3, 1), (-1, -3, 1), (0, -3, 1),</span>
<span class="go"> (1, -3, 1), (-5, -2, 1), (-4, -2, 1), (-3, -2, 1), (-2, -2, 1),</span>
<span class="go"> (-1, -2, 1), (0, -2, 1), (1, -2, 1), (-5, -1, 1), (-4, -1, 1),</span>
<span class="go"> (-3, -1, 1), (-2, -1, 1), (-1, -1, 1), (0, -1, 1), (1, -1, 1),</span>
<span class="go"> (-5, 0, 1), (-4, 0, 1), (-3, 0, 1), (-2, 0, 1), (-1, 0, 1),</span>
<span class="go"> (0, 0, 1), (1, 0, 1), (-5, 1, 1), (-4, 1, 1), (-3, 1, 1),</span>
<span class="go"> (-2, 1, 1), (-1, 1, 1), (0, 1, 1), (1, 1, 1))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.sections">
<code class="descname">sections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the global sections (as points of the <span class="math notranslate nohighlight">\(M\)</span>-lattice) of
the line bundle (or reflexive sheaf) associated to the
divisor.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.python.org/library/functions.html#tuple" title="(in Python v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a> of points of lattice <span class="math notranslate nohighlight">\(M\)</span>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(-1, 0), M(-1, 1), M(0, 0))</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, -1), M(0, 0), M(1, -1))</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, 0), M(0, 1), M(1, 0))</span>
</pre></div>
</div>
<p>The divisor can be non-nef yet still have sections:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">rays</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="n">cones</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
<span class="gp">sage: </span><span class="n">X</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span><span class="n">Fan</span><span class="p">(</span><span class="n">rays</span><span class="o">=</span><span class="n">rays</span><span class="p">,</span><span class="n">cones</span><span class="o">=</span><span class="n">cones</span><span class="p">))</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(z2)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">is_nef</span><span class="p">()</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(M(0, 0, 0),)</span>
<span class="gp">sage: </span><span class="n">D</span><span class="o">.</span><span class="n">cohomology</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(1, 0, 0, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.schemes.toric.divisor.ToricDivisor_generic.sections_monomials">
<code class="descname">sections_monomials</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricDivisor_generic.sections_monomials" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Return the global sections of the line bundle associated to the
Cartier divisor.</p>
<p>The sections are described as monomials in the generalized homogeneous
coordinates.</p>
<p>OUTPUT:</p>
<ul class="simple">
<li>tuple of monomials in the coordinate ring of <code class="docutils literal notranslate"><span class="pre">self</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">fan</span><span class="p">()</span><span class="o">.</span><span class="n">nrays</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(z, y, x)</span>
</pre></div>
</div>
<p>From <a class="reference internal" href="#coxtutorial" id="id10">[CoxTutorial]</a> page 38:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">lp</span> <span class="o">=</span> <span class="n">LatticePolytope</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="n">lp</span>
<span class="go">2-d reflexive polytope #5 in 2-d lattice M</span>
<span class="gp">sage: </span><span class="n">dP7</span> <span class="o">=</span> <span class="n">ToricVariety</span><span class="p">(</span> <span class="n">FaceFan</span><span class="p">(</span><span class="n">lp</span><span class="p">),</span> <span class="s1">&#39;x1, x2, x3, x4, x5&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">AK</span> <span class="o">=</span> <span class="o">-</span><span class="n">dP7</span><span class="o">.</span><span class="n">K</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">AK</span><span class="o">.</span><span class="n">sections</span><span class="p">()</span>
<span class="go">(N(-1, 0), N(-1, 1), N(0, -1), N(0, 0),</span>
<span class="go"> N(0, 1), N(1, -1), N(1, 0), N(1, 1))</span>
<span class="gp">sage: </span><span class="n">AK</span><span class="o">.</span><span class="n">sections_monomials</span><span class="p">()</span>
<span class="go">(x3*x4^2*x5, x2*x3^2*x4^2, x1*x4*x5^2, x1*x2*x3*x4*x5,</span>
<span class="go"> x1*x2^2*x3^2*x4, x1^2*x2*x5^2, x1^2*x2^2*x3*x5, x1^2*x2^3*x3^2)</span>
</pre></div>
</div>
<p>REFERENCES:</p>
<table class="docutils citation" frame="void" id="coxtutorial" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[CoxTutorial]</a></td><td>David Cox, âWhat is a Toric Varietyâ,
<a class="reference external" href="http://www.cs.amherst.edu/~dac/lectures/tutorial.ps">http://www.cs.amherst.edu/~dac/lectures/tutorial.ps</a></td></tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup">
<em class="property">class </em><code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">ToricRationalDivisorClassGroup</code><span class="sig-paren">(</span><em>toric_variety</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_ambient_field" title="(in Sage Reference Manual: Modules v8.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.free_module.FreeModule_ambient_field</span></code></a>, <a class="reference external" href="../../../../structure/sage/structure/unique_representation.html#sage.structure.unique_representation.UniqueRepresentation" title="(in Sage Reference Manual: Parents and Elements v8.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.unique_representation.UniqueRepresentation</span></code></a></p>
<p>The rational divisor class group of a toric variety.</p>
<p>The <strong>T-Weil divisor class group</strong> <span class="math notranslate nohighlight">\(\mathop{Cl}(X)\)</span> of a toric
variety <span class="math notranslate nohighlight">\(X\)</span> is a finitely generated abelian group and can contain
torsion. Its rank equals the number of rays in the fan of <span class="math notranslate nohighlight">\(X\)</span>
minus the dimension of <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>The <strong>rational divisor class group</strong> is <span class="math notranslate nohighlight">\(\mathop{Cl}(X)
\otimes_\ZZ \QQ\)</span> and never includes torsion. If <span class="math notranslate nohighlight">\(X\)</span> is <em>smooth</em>,
this equals the <strong>Picard group</strong> <span class="math notranslate nohighlight">\(\mathop{\mathrm{Pic}}(X)\)</span>, whose
elements are the isomorphism classes of line bundles on <span class="math notranslate nohighlight">\(X\)</span>. The
group law (which we write as addition) is the tensor product of
the line bundles. The Picard group of a toric variety is always
torsion-free.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not instantiate this class yourself. Use
<a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field.rational_class_group" title="sage.schemes.toric.variety.ToricVariety_field.rational_class_group"><code class="xref py py-meth docutils literal notranslate"><span class="pre">rational_class_group()</span></code></a>
method of <a class="reference internal" href="variety.html#sage.schemes.toric.variety.ToricVariety_field" title="sage.schemes.toric.variety.ToricVariety_field"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">varieties</span></code></a> if you need
the divisor class group. Or you can obtain it as the parent of any
divisor class constructed, for example, via
<a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class" title="sage.schemes.toric.divisor.ToricDivisor_generic.divisor_class"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ToricDivisor_generic.divisor_class()</span></code></a>.</p>
</div>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">toric_variety</span></code> â <code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">variety</span>
<span class="pre">&lt;sage.schemes.toric.variety.ToricVariety_field</span></code>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>rational divisor class group of a toric variety.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">P2</span><span class="o">.</span><span class="n">rational_class_group</span><span class="p">()</span>
<span class="go">The toric rational divisor class group of a 2-d CPR-Fano</span>
<span class="go">toric variety covered by 3 affine patches</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">Dclass</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">divisor_class</span><span class="p">();</span> <span class="n">Dclass</span>
<span class="go">Divisor class [1]</span>
<span class="gp">sage: </span><span class="n">Dclass</span><span class="o">.</span><span class="n">lift</span><span class="p">()</span>
<span class="go">V(y)</span>
<span class="gp">sage: </span><span class="n">Dclass</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span>
<span class="go">The toric rational divisor class group of a 2-d CPR-Fano</span>
<span class="go">toric variety covered by 3 affine patches</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup.Element">
<code class="descname">Element</code><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup.Element" title="Permalink to this definition">Â¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClass</span></code></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice">
<em class="property">class </em><code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">ToricRationalDivisorClassGroup_basis_lattice</code><span class="sig-paren">(</span><em>group</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Bases: <a class="reference external" href="../../../../modules/sage/modules/free_module.html#sage.modules.free_module.FreeModule_ambient_pid" title="(in Sage Reference Manual: Modules v8.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.modules.free_module.FreeModule_ambient_pid</span></code></a></p>
<p>Construct the basis lattice of the <code class="docutils literal notranslate"><span class="pre">group</span></code>.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">group</span></code> â <a class="reference internal" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup" title="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup"><code class="xref py py-class docutils literal notranslate"><span class="pre">toric</span> <span class="pre">rational</span> <span class="pre">divisor</span> <span class="pre">class</span> <span class="pre">group</span></code></a>.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li>the basis lattice of <code class="docutils literal notranslate"><span class="pre">group</span></code>.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">P1xP1</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P1xP1</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span> <span class="o">=</span> <span class="n">P1xP1</span><span class="o">.</span><span class="n">Kaehler_cone</span><span class="p">()</span><span class="o">.</span><span class="n">lattice</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">L</span>
<span class="go">Basis lattice of The toric rational divisor class group of a</span>
<span class="go">2-d CPR-Fano toric variety covered by 4 affine patches</span>
<span class="gp">sage: </span><span class="n">L</span><span class="o">.</span><span class="n">basis</span><span class="p">()</span>
<span class="go">[</span>
<span class="go">Divisor class [1, 0],</span>
<span class="go">Divisor class [0, 1]</span>
<span class="go">]</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice.Element">
<code class="descname">Element</code><a class="headerlink" href="#sage.schemes.toric.divisor.ToricRationalDivisorClassGroup_basis_lattice.Element" title="Permalink to this definition">Â¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ToricRationalDivisorClass</span></code></p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.schemes.toric.divisor.is_ToricDivisor">
<code class="descclassname">sage.schemes.toric.divisor.</code><code class="descname">is_ToricDivisor</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.schemes.toric.divisor.is_ToricDivisor" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Test whether <code class="docutils literal notranslate"><span class="pre">x</span></code> is a toric divisor.</p>
<p>INPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">x</span></code> â anything.</li>
</ul>
<p>OUTPUT:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">True</span></code> if <code class="docutils literal notranslate"><span class="pre">x</span></code> is an instance of <a class="reference internal" href="#sage.schemes.toric.divisor.ToricDivisor_generic" title="sage.schemes.toric.divisor.ToricDivisor_generic"><code class="xref py py-class docutils literal notranslate"><span class="pre">ToricDivisor_generic</span></code></a> and
<code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</li>
</ul>
<p>EXAMPLES:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.schemes.toric.divisor</span> <span class="kn">import</span> <span class="n">is_ToricDivisor</span>
<span class="gp">sage: </span><span class="n">is_ToricDivisor</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">P2</span> <span class="o">=</span> <span class="n">toric_varieties</span><span class="o">.</span><span class="n">P2</span><span class="p">()</span>
<span class="gp">sage: </span><span class="n">D</span> <span class="o">=</span> <span class="n">P2</span><span class="o">.</span><span class="n">divisor</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="n">D</span>
<span class="go">V(x)</span>
<span class="gp">sage: </span><span class="n">is_ToricDivisor</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="library.html"
                        title="previous chapter">Library of toric varieties</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="divisor_class.html"
                        title="next chapter">Toric rational divisor classes</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/sage/schemes/toric/divisor.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="divisor_class.html" title="Toric rational divisor classes"
             >next</a> |</li>
        <li class="right" >
          <a href="library.html" title="Library of toric varieties"
             >previous</a> |</li>
  
    
      <a href="../../../../../index.html"><img src="../../../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../../index.html">Schemes</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2019, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>