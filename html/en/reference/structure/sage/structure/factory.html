
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Factory for cached representations &#8212; Sage Reference Manual v9.0: Parents and Elements</title>
    <link rel="stylesheet" href="../../_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="../../_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Dynamic classes" href="dynamic_class.html" />
    <link rel="prev" title="Unique Representation" href="unique_representation.html" />
    <link rel="icon" href="../../_static/sageicon.png" type="image/x-icon" />
    <script src="../../_static/thebe.js" type="text/javascript"></script>
    <script src="../../_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic_class.html" title="Dynamic classes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="unique_representation.html" title="Unique Representation"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Parents and Elements</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="factory-for-cached-representations">
<span id="sage-structure-factory"></span><h1>Factory for cached representations<a class="headerlink" href="#factory-for-cached-representations" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-sage.structure.factory"></span><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="unique_representation.html#module-sage.structure.unique_representation" title="sage.structure.unique_representation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.structure.unique_representation</span></code></a></p>
</div>
<p>Using a <a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a> is one way of implementing a <em>cached
representation behaviour</em>. In spite of its name, using a
<a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a> is not enough to ensure the <em>unique representation
behaviour</em>. See <a class="reference internal" href="unique_representation.html#module-sage.structure.unique_representation" title="sage.structure.unique_representation"><code class="xref py py-mod docutils literal notranslate"><span class="pre">unique_representation</span></code></a> for a
detailed explanation.</p>
<p>With a <a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a>, one can preprocess the given arguments. There
is special support for specifying a subset of the arguments that serve as the
unique key, so that still <em>all</em> given arguments are used to create a new
instance, but only the specified subset is used to look up in the
cache. Typically, this is used to construct objects that accept an optional
<code class="docutils literal notranslate"><span class="pre">check=[True|False]</span></code> argument, but whose result should be unique
regardless of said optional argument. (This use case should be handled with
care, though: Any checking which isn’t done in the <code class="docutils literal notranslate"><span class="pre">create_key</span></code> or
<code class="docutils literal notranslate"><span class="pre">create_key_and_extra_args</span></code> method will be done only when a new object is
generated, but not when a cached object is retrieved from cache.
Consequently, if the factory is once called with <code class="docutils literal notranslate"><span class="pre">check=False</span></code>, a
subsequent call with <code class="docutils literal notranslate"><span class="pre">check=True</span></code> cannot be expected to perform all checks
unless these checks are all in the <code class="docutils literal notranslate"><span class="pre">create_key</span></code> or
<code class="docutils literal notranslate"><span class="pre">create_key_and_extra_args</span></code> method.)</p>
<p>For a class derived from
<a class="reference internal" href="unique_representation.html#sage.structure.unique_representation.CachedRepresentation" title="sage.structure.unique_representation.CachedRepresentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">CachedRepresentation</span></code></a>, argument
preprocessing can be obtained by providing a custom static <code class="docutils literal notranslate"><span class="pre">__classcall__</span></code>
or <code class="docutils literal notranslate"><span class="pre">__classcall_private__</span></code> method, but this seems less transparent. When
argument preprocessing is not needed or the preprocess is not very
sophisticated, then generally
<a class="reference internal" href="unique_representation.html#sage.structure.unique_representation.CachedRepresentation" title="sage.structure.unique_representation.CachedRepresentation"><code class="xref py py-class docutils literal notranslate"><span class="pre">CachedRepresentation</span></code></a> is much
easier to use than a factory.</p>
<p>AUTHORS:</p>
<ul class="simple">
<li>Robert Bradshaw (2008): initial version.</li>
<li>Simon King (2013): extended documentation.</li>
<li>Julian Rueth (2014-05-09): use <code class="docutils literal notranslate"><span class="pre">_cache_key</span></code> if parameters are unhashable</li>
</ul>
<dl class="class">
<dt id="sage.structure.factory.UniqueFactory">
<em class="property">class </em><code class="descclassname">sage.structure.factory.</code><code class="descname">UniqueFactory</code><a class="headerlink" href="#sage.structure.factory.UniqueFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="sage_object.html#sage.structure.sage_object.SageObject" title="sage.structure.sage_object.SageObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.structure.sage_object.SageObject</span></code></a></p>
<p>This class is intended to make it easy to cache objects.</p>
<p>It is based on the idea that the object is uniquely defined by a set of
defining data (the key). There is also the possibility of some
non-defining data (extra args) which will be used in initial creation,
but not affect the caching.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This class only provides <em>cached representation behaviour</em>. Hence,
using <a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a>, it is still possible to create distinct
objects that evaluate equal. Unique representation behaviour can be
added, for example, by additionally inheriting from
<a class="reference external" href="../../../misc/sage/misc/fast_methods.html#sage.misc.fast_methods.WithEqualityById" title="(in Sage Reference Manual: Utilities v9.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">sage.misc.fast_methods.WithEqualityById</span></code></a>.</p>
</div>
<p>The objects created are cached (using weakrefs) based on their key and
returned directly rather than re-created if requested again. Pickling is
taken care of by the factory, and will return the same object for the same
version of Sage, and distinct (but hopefully equal) objects for different
versions of Sage.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The objects returned by a <a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a> must be instances of
new style classes (hence, they must be instances of <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>)
that must not only allow a weak reference, but must accept general
attribute assignment. Otherwise, pickling won’t work.</p>
</div>
<p>USAGE:</p>
<p>A <em>unique factory</em> provides a way to create objects from parameters
(the type of these objects can depend on the parameters, and is often
determined only at runtime) and to cache them by a certain key
derived from these parameters, so that when the factory is being
called again with the same parameters (or just with parameters which
yield the same key), the object is being returned from cache rather
than constructed anew.</p>
<p>An implementation of a unique factory consists of a factory class and
an instance of this factory class.</p>
<p>The factory class has to be a class inheriting from <code class="docutils literal notranslate"><span class="pre">UniqueFactory</span></code>.
Typically it only needs to implement <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a> (a method that
creates a key from the given parameters, under which key the object
will be stored in the cache) and <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_object" title="sage.structure.factory.UniqueFactory.create_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_object()</span></code></a> (a method that
returns the actual object from the key). Sometimes, one would also
implement <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key_and_extra_args" title="sage.structure.factory.UniqueFactory.create_key_and_extra_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key_and_extra_args()</span></code></a> (this differs from
<a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a> in allowing to also create some additional
arguments from the given parameters, which arguments then get passed
to <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_object" title="sage.structure.factory.UniqueFactory.create_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_object()</span></code></a> and thus can have an effect on the initial
creation of the object, but do <em>not</em> affect the key) or
<a class="reference internal" href="#sage.structure.factory.UniqueFactory.other_keys" title="sage.structure.factory.UniqueFactory.other_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">other_keys()</span></code></a>. Other methods are not supposed to be overloaded.</p>
<p>The factory class itself cannot be called to create objects. Instead,
an instance of the factory class has to be created first. For
technical reasons, this instance has to be provided with a name that
allows Sage to find its definition. Specifically, the name of the
factory instance (or the full path to it, if it is not in the global
namespace) has to be passed to the factory class as a string variable.
So, if our factory class has been called <code class="docutils literal notranslate"><span class="pre">A</span></code> and is located in
<code class="docutils literal notranslate"><span class="pre">sage/spam/battletoads.py</span></code>, then we need to define an instance (say,
<code class="docutils literal notranslate"><span class="pre">B</span></code>) of <code class="docutils literal notranslate"><span class="pre">A</span></code> by writing <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">A(&quot;sage.spam.battletoads.B&quot;)</span></code>
(or <code class="docutils literal notranslate"><span class="pre">B</span> <span class="pre">=</span> <span class="pre">A(&quot;B&quot;)</span></code> if this <code class="docutils literal notranslate"><span class="pre">B</span></code> will be imported into global
namespace). This instance can then be used to create objects (by
calling <code class="docutils literal notranslate"><span class="pre">B(*parameters)</span></code>).</p>
<p>Notice that the objects created by the factory don’t inherit from the
factory class. They <em>do</em> know about the factory that created them (this
information, along with the keys under which this factory caches them,
is stored in the <code class="docutils literal notranslate"><span class="pre">_factory_data</span></code> attributes of the objects), but not
via inheritance.</p>
<p>EXAMPLES:</p>
<p>The below examples are rather artificial and illustrate particular
aspects. For a “real-life” usage case of <code class="docutils literal notranslate"><span class="pre">UniqueFactory</span></code>, see
the finite field factory in <a class="reference external" href="../../../finite_rings/sage/rings/finite_rings/finite_field_constructor.html#module-sage.rings.finite_rings.finite_field_constructor" title="(in Sage Reference Manual: Finite Rings v9.0)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.rings.finite_rings.finite_field_constructor</span></code></a>.</p>
<p>In many cases, a factory class is implemented by providing the two
methods <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a> and <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_object" title="sage.structure.factory.UniqueFactory.create_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_object()</span></code></a>. In our example,
we want to demonstrate how to use “extra arguments” to choose a specific
implementation, with preference given to an instance found in the cache,
even if its implementation is different. Hence, we implement
<a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key_and_extra_args" title="sage.structure.factory.UniqueFactory.create_key_and_extra_args"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key_and_extra_args()</span></code></a> rather than <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a>, putting
the chosen implementation into the extra arguments. Then, in the
<a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_object" title="sage.structure.factory.UniqueFactory.create_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_object()</span></code></a> method, we create and return instances of the
specified implementation.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.factory</span> <span class="kn">import</span> <span class="n">UniqueFactory</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">MyFactory</span><span class="p">(</span><span class="n">UniqueFactory</span><span class="p">):</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">create_key_and_extra_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="n">args</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;impl&#39;</span><span class="p">:</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;impl&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)}</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="nf">create_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_args</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="n">impl</span> <span class="o">=</span> <span class="n">extra_args</span><span class="p">[</span><span class="s1">&#39;impl&#39;</span><span class="p">]</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">impl</span><span class="o">==</span><span class="s1">&#39;C&#39;</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="n">C</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">if</span> <span class="n">impl</span><span class="o">==</span><span class="s1">&#39;D&#39;</span><span class="p">:</span>
<span class="gp">....: </span>            <span class="k">return</span> <span class="n">D</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="n">E</span><span class="p">(</span><span class="o">*</span><span class="n">key</span><span class="p">)</span>
<span class="gp">....:</span>
</pre></div>
</div>
<p>Now we can create a factory instance. It is supposed to be found under the
name <code class="docutils literal notranslate"><span class="pre">&quot;F&quot;</span></code> in the <code class="docutils literal notranslate"><span class="pre">&quot;__main__&quot;</span></code> module. Note that in an interactive
session, <code class="docutils literal notranslate"><span class="pre">F</span></code> would automatically be in the <code class="docutils literal notranslate"><span class="pre">__main__</span></code> module. Hence,
the second and third of the following four lines are only needed in
doctests.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span> <span class="o">=</span> <span class="n">MyFactory</span><span class="p">(</span><span class="s2">&quot;__main__.F&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="kn">import</span> <span class="nn">__main__</span>
<span class="gp">sage: </span><span class="n">__main__</span><span class="o">.</span><span class="n">F</span> <span class="o">=</span> <span class="n">F</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">F</span><span class="p">))</span> <span class="ow">is</span> <span class="n">F</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now we create three classes <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">D</span></code> and <code class="docutils literal notranslate"><span class="pre">E</span></code>. The first is a Cython
extension-type class that does not allow weak references nor attribute
assignment. The second is a Python class that is not derived from
<code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>. The third allows attribute assignment and is derived
from <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code>.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cython</span><span class="p">(</span><span class="s2">&quot;cdef class C: pass&quot;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">D</span><span class="p">:</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">args</span>
<span class="gp">....: </span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">....: </span>        <span class="k">return</span> <span class="s2">&quot;D</span><span class="si">%s</span><span class="s2">&quot;</span><span class="o">%</span><span class="k">repr</span>(self.t)
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="k">class</span> <span class="nc">E</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="nb">object</span><span class="p">):</span> <span class="k">pass</span>
</pre></div>
</div>
<p>Again, being in a doctest, we need to put the class <code class="docutils literal notranslate"><span class="pre">D</span></code> into the
<code class="docutils literal notranslate"><span class="pre">__main__</span></code> module, so that Python can find it:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">import</span> <span class="nn">__main__</span>
<span class="gp">sage: </span><span class="n">__main__</span><span class="o">.</span><span class="n">D</span> <span class="o">=</span> <span class="n">D</span>
</pre></div>
</div>
<p>It is impossible to create an instance of <code class="docutils literal notranslate"><span class="pre">C</span></code> with our factory, since it
does not allow weak references:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="go">Traceback (most recent call last):</span>
<span class="go">...</span>
<span class="go">TypeError: cannot create weak reference to &#39;....C&#39; object</span>
</pre></div>
</div>
<p>Let us try again, with a Cython class that does allow weak
references. Now, creation of an instance using the factory works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">cython</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;cdef class C:</span>
<span class="gp">....: </span><span class="s1">    cdef __weakref__</span>
<span class="gp">....: </span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
<span class="gp">....:</span>
<span class="gp">sage: </span><span class="n">c</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The cache is used when calling the factory again—even if it is suggested
to use a different implementation. This is because the implementation is
only considered an “extra argument” that does not count for the key.</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">c</span> <span class="ow">is</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">F</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However, pickling and unpickling does not use the cache. This is because
the factory has tried to assign an attribute to the instance that provides
information on the key used to create the instance, but failed:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">c</span><span class="p">))</span> <span class="ow">is</span> <span class="n">c</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="nb">hasattr</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s1">&#39;_factory_data&#39;</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
<p>We have already seen that our factory will only take the requested
implementation into account if the arguments used as key have not been
used yet. So, we use other arguments to create an instance of class
<code class="docutils literal notranslate"><span class="pre">D</span></code>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">d</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">impl</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">D</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The factory only knows about the pickling protocol used by new style
classes. Hence, again, pickling and unpickling fails to use the cache,
even though the “factory data” are now available (this is not the case
on Python 3 which <em>only</em> has new style classes):</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">d</span><span class="p">))</span> <span class="ow">is</span> <span class="n">d</span>  <span class="c1"># py2</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">d</span><span class="o">.</span><span class="n">_factory_data</span>
<span class="go">(&lt;__main__.MyFactory object at ...&gt;,</span>
<span class="go"> (...),</span>
<span class="go"> (2,),</span>
<span class="go"> {&#39;impl&#39;: &#39;D&#39;})</span>
</pre></div>
</div>
<p>Only when we have a new style class that can be weak referenced and allows
for attribute assignment, everything works:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">e</span> <span class="o">=</span> <span class="n">F</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">sage: </span><span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">E</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">e</span><span class="p">))</span> <span class="ow">is</span> <span class="n">e</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">e</span><span class="o">.</span><span class="n">_factory_data</span>
<span class="go">(&lt;__main__.MyFactory object at ...&gt;,</span>
<span class="go"> (...),</span>
<span class="go"> (3,),</span>
<span class="go"> {&#39;impl&#39;: None})</span>
</pre></div>
</div>
<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.create_key">
<code class="descname">create_key</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.create_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the parameters (arguments and keywords), create a key
that uniquely determines this object.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">create_key</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(1, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.create_key_and_extra_args">
<code class="descname">create_key_and_extra_args</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.create_key_and_extra_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the key (uniquely defining data)
and any extra arguments (empty by default).</p>
<p>Defaults to <a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a>.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="go">((1, 2), {})</span>
<span class="gp">sage: </span><span class="n">GF</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">((3, (&#39;x&#39;,), None, &#39;modn&#39;, 3, 1, True, None, None, None), {})</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.create_object">
<code class="descname">create_object</code><span class="sig-paren">(</span><em>version</em>, <em>key</em>, <em>**extra_args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.create_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object from the key and extra arguments. This is only
called if the object was not found in the cache.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">Making object (1, 2, 3)</span>
<span class="go">&lt;sage.structure.test_factory.A object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="go">Making object (&#39;a&#39;,)</span>
<span class="go">&lt;sage.structure.test_factory.A object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="c1"># NOT called again</span>
<span class="go">&lt;sage.structure.test_factory.A object at ...&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.get_object">
<code class="descname">get_object</code><span class="sig-paren">(</span><em>version</em>, <em>key</em>, <em>extra_args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.get_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object corresponding to <code class="docutils literal notranslate"><span class="pre">key</span></code>, creating it with
<code class="docutils literal notranslate"><span class="pre">extra_args</span></code> if necessary (for example, it isn’t in the cache
or it is unpickling from an older version of Sage).</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{});</span> <span class="n">a</span>
<span class="go">Making object a</span>
<span class="go">&lt;sage.structure.test_factory.A object at ...&gt;</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">is</span> <span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">is</span> <span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.1</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="go">Making object a</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="p">{})</span> <span class="ow">is</span> <span class="n">test_factory</span><span class="o">.</span><span class="n">get_object</span><span class="p">(</span><span class="mf">3.0</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="p">{})</span>
<span class="go">Making object b</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.get_version">
<code class="descname">get_version</code><span class="sig-paren">(</span><em>sage_version</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>This is provided to allow more or less granular control over
pickle versioning. Objects pickled in the same version of Sage
will unpickle to the same rather than simply equal objects. This
can provide significant gains as arithmetic must be performed on
objects with identical parents. However, if there has been an
incompatible change (e.g. in element representation) we want the
version number to change so coercion is forced between the two
parents.</p>
<p>Defaults to the Sage version that is passed in, but coarser
granularity can be provided.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">get_version</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">(3, 1, 0)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.other_keys">
<code class="descname">other_keys</code><span class="sig-paren">(</span><em>key</em>, <em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.other_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Sometimes during object creation, certain defaults are chosen which
may result in a new (more specific) key. This allows the more specific
key to be regarded as equivalent to the original key returned by
<a class="reference internal" href="#sage.structure.factory.UniqueFactory.create_key" title="sage.structure.factory.UniqueFactory.create_key"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_key()</span></code></a> for the purpose of lookup in the cache, and is used
for pickling.</p>
<p>EXAMPLES:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">GF</span></code> factory used to have a custom <a class="reference internal" href="#sage.structure.factory.UniqueFactory.other_keys" title="sage.structure.factory.UniqueFactory.other_keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">other_keys()</span></code></a>
method, but this was removed in <a class="reference external" href="https://trac.sagemath.org/16934">trac ticket #16934</a>:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">key</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">GF</span><span class="o">.</span><span class="n">create_key_and_extra_args</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">);</span> <span class="n">key</span>
<span class="go">(27, (&#39;k&#39;,), x^3 + 2*x + 1, &#39;givaro&#39;, 3, 3, True, None, &#39;poly&#39;, True)</span>
<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">key</span><span class="p">);</span> <span class="n">K</span>
<span class="go">Finite Field in k of size 3^3</span>
<span class="gp">sage: </span><span class="n">GF</span><span class="o">.</span><span class="n">other_keys</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
<span class="go">[]</span>

<span class="gp">sage: </span><span class="n">K</span> <span class="o">=</span> <span class="n">GF</span><span class="p">(</span><span class="mi">7</span><span class="o">^</span><span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">loads</span><span class="p">(</span><span class="n">dumps</span><span class="p">(</span><span class="n">K</span><span class="p">))</span> <span class="ow">is</span> <span class="n">K</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="sage.structure.factory.UniqueFactory.reduce_data">
<code class="descname">reduce_data</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.UniqueFactory.reduce_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The results of this function can be returned from
<code class="xref py py-meth docutils literal notranslate"><span class="pre">__reduce__()</span></code>. This is here so the factory internals can
change without having to re-write <code class="xref py py-meth docutils literal notranslate"><span class="pre">__reduce__()</span></code> methods
that use it.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">FreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factory</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">FreeModule</span><span class="o">.</span><span class="n">reduce_data</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">factory</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="go">Ambient free module of rank 5 over the principal ideal domain Integer Ring</span>
<span class="gp">sage: </span><span class="n">factory</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">V</span>
<span class="go">True</span>

<span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.test_factory</span> <span class="kn">import</span> <span class="n">test_factory</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">test_factory</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">Making object (1, 2)</span>
<span class="gp">sage: </span><span class="n">test_factory</span><span class="o">.</span><span class="n">reduce_data</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(&lt;built-in function generic_factory_unpickle&gt;,</span>
<span class="go"> (&lt;sage.structure.test_factory.UniqueFactoryTester object at ...&gt;,</span>
<span class="go">  (...),</span>
<span class="go">  (1, 2),</span>
<span class="go">  {}))</span>
</pre></div>
</div>
<p>Note that the ellipsis <code class="docutils literal notranslate"><span class="pre">(...)</span></code> here stands for the Sage
version.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="sage.structure.factory.generic_factory_reduce">
<code class="descclassname">sage.structure.factory.</code><code class="descname">generic_factory_reduce</code><span class="sig-paren">(</span><em>self</em>, <em>proto</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.generic_factory_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to provide a <code class="docutils literal notranslate"><span class="pre">__reduce__</span></code> method if one does not already exist.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">QQ</span><span class="o">^</span><span class="mi">6</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">generic_factory_reduce</span><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">V</span><span class="o">.</span><span class="n">__reduce_ex__</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.structure.factory.generic_factory_unpickle">
<code class="descclassname">sage.structure.factory.</code><code class="descname">generic_factory_unpickle</code><span class="sig-paren">(</span><em>factory</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.generic_factory_unpickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Method used for unpickling the object.</p>
<p>The unpickling mechanism needs a plain Python function to call.
It takes a factory as the first argument, passes the rest of the
arguments onto the factory’s <a class="reference internal" href="#sage.structure.factory.UniqueFactory.get_object" title="sage.structure.factory.UniqueFactory.get_object"><code class="xref py py-meth docutils literal notranslate"><span class="pre">UniqueFactory.get_object()</span></code></a> method.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">V</span> <span class="o">=</span> <span class="n">FreeModule</span><span class="p">(</span><span class="n">ZZ</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">func</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">FreeModule</span><span class="o">.</span><span class="n">reduce_data</span><span class="p">(</span><span class="n">V</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">func</span> <span class="ow">is</span> <span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">generic_factory_unpickle</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">sage</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">factory</span><span class="o">.</span><span class="n">generic_factory_unpickle</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="n">V</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.structure.factory.lookup_global">
<code class="descclassname">sage.structure.factory.</code><code class="descname">lookup_global</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.lookup_global" title="Permalink to this definition">¶</a></dt>
<dd><p>Used in unpickling the factory itself.</p>
<p>EXAMPLES:</p>
<div class="highlight-ipycon notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="kn">from</span> <span class="nn">sage.structure.factory</span> <span class="kn">import</span> <span class="n">lookup_global</span>
<span class="gp">sage: </span><span class="n">lookup_global</span><span class="p">(</span><span class="s1">&#39;ZZ&#39;</span><span class="p">)</span>
<span class="go">Integer Ring</span>
<span class="gp">sage: </span><span class="n">lookup_global</span><span class="p">(</span><span class="s1">&#39;sage.rings.all.ZZ&#39;</span><span class="p">)</span>
<span class="go">Integer Ring</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="sage.structure.factory.register_factory_unpickle">
<code class="descclassname">sage.structure.factory.</code><code class="descname">register_factory_unpickle</code><span class="sig-paren">(</span><em>name</em>, <em>callable</em><span class="sig-paren">)</span><a class="headerlink" href="#sage.structure.factory.register_factory_unpickle" title="Permalink to this definition">¶</a></dt>
<dd><p>Register a callable to handle the unpickling from an old
<a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a> object.</p>
<p><a class="reference internal" href="#sage.structure.factory.UniqueFactory" title="sage.structure.factory.UniqueFactory"><code class="xref py py-class docutils literal notranslate"><span class="pre">UniqueFactory</span></code></a> pickles use a global name through
<a class="reference internal" href="#sage.structure.factory.generic_factory_unpickle" title="sage.structure.factory.generic_factory_unpickle"><code class="xref py py-func docutils literal notranslate"><span class="pre">generic_factory_unpickle()</span></code></a>, so the usual
<a class="reference external" href="../../../misc/sage/misc/persist.html#sage.misc.persist.register_unpickle_override" title="(in Sage Reference Manual: Utilities v9.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_unpickle_override()</span></code></a>
cannot be used here.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#sage.structure.factory.generic_factory_unpickle" title="sage.structure.factory.generic_factory_unpickle"><code class="xref py py-func docutils literal notranslate"><span class="pre">generic_factory_unpickle()</span></code></a></p>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="unique_representation.html"
                        title="previous chapter">Unique Representation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dynamic_class.html"
                        title="next chapter">Dynamic classes</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/sage/structure/factory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dynamic_class.html" title="Dynamic classes"
             >next</a> |</li>
        <li class="right" >
          <a href="unique_representation.html" title="Unique Representation"
             >previous</a> |</li>
  
    
      <a href="../../../../index.html"><img src="../../_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="../../index.html">Parents and Elements</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2020, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>