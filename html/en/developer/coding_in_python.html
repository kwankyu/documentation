
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=600, initial-scale=1">
    <title>Coding in Python for Sage &#8212; Sage Developer&#39;s Guide v8.5</title>
    <link rel="stylesheet" href="_static/sage.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,../mathjax_sage.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Coding in Cython" href="coding_in_cython.html" />
    <link rel="prev" title="The Sage Manuals" href="sage_manuals.html" />
    <link rel="icon" href="_static/sageicon.png" type="image/x-icon" />
    <script src="_static/thebe.js" type="text/javascript"></script>
    <script src="_static/thebe-sage.js" type="text/javascript"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="coding_in_cython.html" title="Coding in Cython"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sage_manuals.html" title="The Sage Manuals"
             accesskey="P">previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Developer&#39;s Guide v8.5</a> &#187;</li>
 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="coding-in-python-for-sage">
<span id="chapter-python"></span><h1>Coding in Python for Sage<a class="headerlink" href="#coding-in-python-for-sage" title="Permalink to this headline">¶</a></h1>
<p>This chapter discusses some issues with, and advice for, coding in
Sage.</p>
<div class="section" id="design">
<h2>Design<a class="headerlink" href="#design" title="Permalink to this headline">¶</a></h2>
<p>If you are planning to develop some new code for Sage, design is
important. So think about what your program will do and how that fits
into the structure of Sage. In particular, much of Sage is implemented
in the object-oriented language Python, and there is a hierarchy of
classes that organize code and functionality. For example, if you
implement elements of a ring, your class should derive from
<code class="docutils literal notranslate"><span class="pre">sage.structure.element.RingElement</span></code>, rather than starting from
scratch. Try to figure out how your code should fit in with other Sage
code, and design it accordingly.</p>
</div>
<div class="section" id="special-sage-functions">
<h2>Special Sage Functions<a class="headerlink" href="#special-sage-functions" title="Permalink to this headline">¶</a></h2>
<p>Functions with leading and trailing double underscores <code class="docutils literal notranslate"><span class="pre">__XXX__</span></code> are
all predefined by Python. Functions with leading and trailing single
underscores <code class="docutils literal notranslate"><span class="pre">_XXX_</span></code> are defined for Sage. Functions with a single
leading underscore are meant to be semi-private, and those with a
double leading underscore are considered really private. Users can
create functions with leading and trailing underscores.</p>
<p>Just as Python has many standard special methods for objects, Sage
also has special methods. They are typically of the form <code class="docutils literal notranslate"><span class="pre">_XXX_</span></code>.
In a few cases, the trailing underscore is not included, but this will
eventually be changed so that the trailing underscore is always
included. This section describes these special methods.</p>
<p>All objects in Sage should derive from the Cython extension class
<code class="docutils literal notranslate"><span class="pre">SageObject</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.ext.sage_object</span> <span class="k">import</span> <span class="n">SageObject</span>

<span class="k">class</span> <span class="nc">MyClass</span><span class="p">(</span><span class="n">SageObject</span><span class="p">,</span><span class="o">...</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>or from some other already existing Sage class:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.rings.ring</span> <span class="k">import</span> <span class="n">Algebra</span>

<span class="k">class</span> <span class="nc">MyFavoriteAlgebra</span><span class="p">(</span><span class="n">Algebra</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>You should implement the <code class="docutils literal notranslate"><span class="pre">_latex_</span></code> and <code class="docutils literal notranslate"><span class="pre">_repr_</span></code> method for every
object. The other methods depend on the nature of the object.</p>
<div class="section" id="latex-representation">
<h3>LaTeX Representation<a class="headerlink" href="#latex-representation" title="Permalink to this headline">¶</a></h3>
<p>Every object <code class="docutils literal notranslate"><span class="pre">x</span></code> in Sage should support the command <code class="docutils literal notranslate"><span class="pre">latex(x)</span></code>, so
that any Sage object can be easily and accurately displayed via
LaTeX. Here is how to make a class (and therefore its instances)
support the command <code class="docutils literal notranslate"><span class="pre">latex</span></code>.</p>
<ol class="arabic simple">
<li>Define a method <code class="docutils literal notranslate"><span class="pre">_latex_(self)</span></code> that returns a LaTeX
representation of your object. It should be something that can be
typeset correctly within math mode. Do not include opening and
closing $’s.</li>
<li>Often objects are built up out of other Sage objects, and these
components should be typeset using the <code class="docutils literal notranslate"><span class="pre">latex</span></code> function. For
example, if <code class="docutils literal notranslate"><span class="pre">c</span></code> is a coefficient of your object, and you want to
typeset <code class="docutils literal notranslate"><span class="pre">c</span></code> using LaTeX, use <code class="docutils literal notranslate"><span class="pre">latex(c)</span></code> instead of
<code class="docutils literal notranslate"><span class="pre">c._latex_()</span></code>, since <code class="docutils literal notranslate"><span class="pre">c</span></code> might not have a <code class="docutils literal notranslate"><span class="pre">_latex_</span></code> method,
and <code class="docutils literal notranslate"><span class="pre">latex(c)</span></code> knows how to deal with this.</li>
<li>Do not forget to include a docstring and an example that
illustrates LaTeX generation for your object.</li>
<li>You can use any macros included in <code class="docutils literal notranslate"><span class="pre">amsmath</span></code>, <code class="docutils literal notranslate"><span class="pre">amssymb</span></code>, or
<code class="docutils literal notranslate"><span class="pre">amsfonts</span></code>, or the ones defined in
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/doc/commontex/macros.tex</span></code>.</li>
</ol>
<p>An example template for a <code class="docutils literal notranslate"><span class="pre">_latex_</span></code> method follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">X</span><span class="p">:</span>
   <span class="o">...</span>
   <span class="k">def</span> <span class="nf">_latex_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">       Return the LaTeX representation of X.</span>

<span class="sd">       EXAMPLES::</span>

<span class="sd">           sage: a = X(1,2)</span>
<span class="sd">           sage: latex(a)</span>
<span class="sd">           &#39;\\frac{1}{2}&#39;</span>
<span class="sd">       &quot;&quot;&quot;</span>
       <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">frac{</span><span class="si">%s</span><span class="s1">}{</span><span class="si">%s</span><span class="s1">}&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">numer</span><span class="p">),</span> <span class="n">latex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">denom</span><span class="p">))</span>
</pre></div>
</div>
<p>As shown in the example, <code class="docutils literal notranslate"><span class="pre">latex(a)</span></code> will produce LaTeX code
representing the object <code class="docutils literal notranslate"><span class="pre">a</span></code>. Calling <code class="docutils literal notranslate"><span class="pre">view(a)</span></code> will display the
typeset version of this.</p>
</div>
<div class="section" id="print-representation">
<h3>Print Representation<a class="headerlink" href="#print-representation" title="Permalink to this headline">¶</a></h3>
<p>The standard Python printing method is <code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code>. In Sage,
that is for objects that derive from <code class="docutils literal notranslate"><span class="pre">SageObject</span></code> (which is
everything in Sage), instead define <code class="docutils literal notranslate"><span class="pre">_repr_(self)</span></code>. This is
preferable because if you only define <code class="docutils literal notranslate"><span class="pre">_repr_(self)</span></code> and not
<code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code>, then users can rename your object to print however
they like. Also, some objects should print differently depending on
the context.</p>
<p>Here is an example of the <code class="docutils literal notranslate"><span class="pre">_latex_</span></code> and <code class="docutils literal notranslate"><span class="pre">_repr_</span></code> functions for the
<code class="docutils literal notranslate"><span class="pre">Pi</span></code> class. It is from the file
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/functions/constants.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Pi</span><span class="p">(</span><span class="n">Constant</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ratio of a circle&#39;s circumference to its diameter.</span>

<span class="sd">    EXAMPLES::</span>

<span class="sd">        sage: pi</span>
<span class="sd">        pi</span>
<span class="sd">        sage: float(pi) # rel tol 1e-10</span>
<span class="sd">        3.1415926535897931</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_repr_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;pi&quot;</span>

    <span class="k">def</span> <span class="nf">_latex_</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">pi&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="matrix-or-vector-from-object">
<h3>Matrix or Vector from Object<a class="headerlink" href="#matrix-or-vector-from-object" title="Permalink to this headline">¶</a></h3>
<p>Provide a <code class="docutils literal notranslate"><span class="pre">_matrix_</span></code> method for an object that can be coerced to a
matrix over a ring <span class="math notranslate nohighlight">\(R\)</span>. Then the Sage function <code class="docutils literal notranslate"><span class="pre">matrix</span></code> will work
for this object.</p>
<p>The following is from
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/graphs/graph.py</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GenericGraph</span><span class="p">(</span><span class="n">SageObject</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_matrix_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">R</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">am</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">am</span><span class="p">()</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">adjacency_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sparse</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">boundary_first</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
<p>Similarly, provide a <code class="docutils literal notranslate"><span class="pre">_vector_</span></code> method for an object that can be
coerced to a vector over a ring <span class="math notranslate nohighlight">\(R\)</span>. Then the Sage function <code class="docutils literal notranslate"><span class="pre">vector</span></code>
will work for this object. The following is from the file
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/sage/sage/modules/free_module_element.pyx</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cdef</span> <span class="k">class</span> <span class="nc">FreeModuleElement</span><span class="p">(</span><span class="n">element_Vector</span><span class="p">):</span>   <span class="c1"># abstract base class</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="nf">_vector_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">R</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_ring</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="sage-preparsing">
<span id="section-preparsing"></span><h2>Sage Preparsing<a class="headerlink" href="#sage-preparsing" title="Permalink to this headline">¶</a></h2>
<p>To make Python even more usable interactively, there are a number of
tweaks to the syntax made when you use Sage from the commandline or
via the notebook (but not for Python code in the Sage
library). Technically, this is implemented by a <code class="docutils literal notranslate"><span class="pre">preparse()</span></code>
function that rewrites the input string. Most notably, the following
replacements are made:</p>
<ul>
<li><p class="first">Sage supports a special syntax for generating rings or, more
generally, parents with named generators:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span><span class="o">.&lt;</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">&gt;</span> <span class="o">=</span> <span class="n">QQ</span><span class="p">[]</span>
<span class="gp">sage: </span><span class="n">preparse</span><span class="p">(</span><span class="s1">&#39;R.&lt;x,y&gt; = QQ[]&#39;</span><span class="p">)</span>
<span class="go">&quot;R = QQ[&#39;x, y&#39;]; (x, y,) = R._first_ngens(2)&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Integer and real literals are Sage integers and Sage floating point
numbers. For example, in pure Python these would be an attribute
error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="mf">16.</span><span class="n">sqrt</span><span class="p">()</span>
<span class="go">4</span>
<span class="gp">sage: </span><span class="mf">87.</span><span class="n">factor</span><span class="p">()</span>
<span class="go">3 * 29</span>
</pre></div>
</div>
</li>
<li><p class="first">Raw literals are not preparsed, which can be useful from an
efficiency point of view. Just like Python ints are denoted by an L,
in Sage raw integer and floating literals are followed by an “r” (or
“R”) for raw, meaning not preparsed. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="mi">393939</span><span class="n">r</span>
<span class="gp">sage: </span><span class="n">a</span>
<span class="go">393939</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">&lt;... &#39;int&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">b</span> <span class="o">=</span> <span class="mi">393939</span>
<span class="gp">sage: </span><span class="nb">type</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">&lt;type &#39;sage.rings.integer.Integer&#39;&gt;</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
</pre></div>
</div>
</li>
<li><p class="first">Raw literals can be very useful in certain cases. For instance,
Python integers can be more efficient than Sage integers when they
are very small.  Large Sage integers are much more efficient than
Python integers since they are implemented using the GMP C library.</p>
</li>
</ul>
<p>Consult the file <code class="docutils literal notranslate"><span class="pre">preparser.py</span></code> for more details about Sage
preparsing, more examples involving raw literals, etc.</p>
<p>When a file <code class="docutils literal notranslate"><span class="pre">foo.sage</span></code> is loaded or attached in a Sage session, a
preparsed version of <code class="docutils literal notranslate"><span class="pre">foo.sage</span></code> is created with the name
<code class="docutils literal notranslate"><span class="pre">foo.sage.py</span></code>. The beginning of the preparsed file states:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">file</span> <span class="n">was</span> <span class="o">*</span><span class="n">autogenerated</span><span class="o">*</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">file</span> <span class="n">foo</span><span class="o">.</span><span class="n">sage</span><span class="o">.</span>
</pre></div>
</div>
<p>You can explicitly preparse a file with the <code class="docutils literal notranslate"><span class="pre">--preparse</span></code>
command-line option: running</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sage</span> <span class="o">--</span><span class="n">preparse</span> <span class="n">foo</span><span class="o">.</span><span class="n">sage</span>
</pre></div>
</div>
<p>creates the file <code class="docutils literal notranslate"><span class="pre">foo.sage.py</span></code>.</p>
<p>The following files are relevant to preparsing in Sage:</p>
<ol class="arabic simple">
<li><code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/bin/sage</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/bin/sage-preparse</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/repl/preparse.py</span></code></li>
</ol>
<p>In particular, the file <code class="docutils literal notranslate"><span class="pre">preparse.py</span></code> contains the Sage preparser
code.</p>
</div>
<div class="section" id="the-sage-coercion-model">
<h2>The Sage Coercion Model<a class="headerlink" href="#the-sage-coercion-model" title="Permalink to this headline">¶</a></h2>
<p>The primary goal of coercion is to be able to transparently do
arithmetic, comparisons, etc. between elements of distinct sets. For
example, when one writes <span class="math notranslate nohighlight">\(3 + 1/2\)</span>, one wants to perform arithmetic on
the operands as rational numbers, despite the left term being an
integer.  This makes sense given the obvious and natural inclusion of
the integers into the rational numbers. The goal of the coercion
system is to facilitate this (and more complicated arithmetic) without
having to explicitly map everything over into the same domain, and at
the same time being strict enough to not resolve ambiguity or accept
nonsense.</p>
<p>The coercion model for Sage is described in detail, with examples, in
the Coercion section of the Sage Reference Manual.</p>
</div>
<div class="section" id="mutability">
<h2>Mutability<a class="headerlink" href="#mutability" title="Permalink to this headline">¶</a></h2>
<p>Parent structures (e.g. rings, fields, matrix spaces, etc.) should be
immutable and globally unique whenever possible. Immutability means,
among other things, that properties like generator labels and default
coercion precision cannot be changed.</p>
<p>Global uniqueness while not wasting memory is best implemented using
the standard Python weakref module, a factory function, and module
scope variable.</p>
<p>Certain objects, e.g. matrices, may start out mutable and become
immutable later. See the file
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/structure/mutability.py</span></code>.</p>
</div>
<div class="section" id="the-hash-special-method">
<h2>The  __hash__ Special Method<a class="headerlink" href="#the-hash-special-method" title="Permalink to this headline">¶</a></h2>
<p>Here is the definition of <code class="docutils literal notranslate"><span class="pre">__hash__</span></code> from the Python reference
manual:</p>
<blockquote>
<div>Called by built-in function <code class="docutils literal notranslate"><span class="pre">hash()</span></code> and for operations on members of
hashed collections including set, frozenset, and dict. <code class="docutils literal notranslate"><span class="pre">__hash__()</span></code>
should return an integer. The only required property is that objects which
compare equal have the same hash value; it is advised to somehow mix
together (e.g. using exclusive or) the hash values for the components of
the object that also play a part in comparison of objects. If a class does
not define a
<code class="docutils literal notranslate"><span class="pre">__cmp__()</span></code> method it should not define a
<code class="docutils literal notranslate"><span class="pre">__hash__()</span></code> operation either; if it defines
<code class="docutils literal notranslate"><span class="pre">__cmp__()</span></code> or <code class="docutils literal notranslate"><span class="pre">__eq__()</span></code> but not
<code class="docutils literal notranslate"><span class="pre">__hash__()</span></code>, its instances will not be usable as
dictionary keys. If a class defines mutable objects and implements
a <code class="docutils literal notranslate"><span class="pre">__cmp__()</span></code> or <code class="docutils literal notranslate"><span class="pre">__eq__()</span></code> method, it
should not implement <code class="docutils literal notranslate"><span class="pre">__hash__()</span></code>, since the dictionary
implementation requires that a key’s hash value is immutable (if
the object’s hash value changes, it will be in the wrong hash
bucket).</div></blockquote>
<p>Notice the phrase, “The only required property is that objects which
compare equal have the same hash value.” This is an assumption made by
the Python language, which in Sage we simply cannot make (!), and
violating it has consequences. Fortunately, the consequences are
pretty clearly defined and reasonably easy to understand, so if you
know about them they do not cause you trouble. The following example
illustrates them pretty well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)]</span>
<span class="gp">sage: </span><span class="mi">9</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">v</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)])</span>
<span class="gp">sage: </span><span class="mi">9</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">False</span>
<span class="gp">sage: </span><span class="mi">2</span> <span class="ow">in</span> <span class="n">v</span>
<span class="go">True</span>
<span class="gp">sage: </span><span class="n">w</span> <span class="o">=</span> <span class="p">{</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">):</span><span class="s1">&#39;a&#39;</span><span class="p">}</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="go">&#39;a&#39;</span>
<span class="gp">sage: </span><span class="n">w</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">KeyError</span>: <span class="n">9</span>
</pre></div>
</div>
<p>Here is another example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="n">R</span> <span class="o">=</span> <span class="n">RealField</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">R</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">^-</span><span class="mi">100</span>
<span class="gp">sage: </span><span class="n">a</span> <span class="o">==</span> <span class="n">RDF</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># because the a gets coerced down to RDF</span>
<span class="go">True</span>
</pre></div>
</div>
<p>but <code class="docutils literal notranslate"><span class="pre">hash(a)</span></code> should not equal <code class="docutils literal notranslate"><span class="pre">hash(1)</span></code>.</p>
<p>Unfortunately, in Sage we simply cannot require</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="c1">#)   &quot;a == b ==&gt; hash(a) == hash(b)&quot;</span>
</pre></div>
</div>
<p>because serious mathematics is simply too complicated for this
rule. For example, the equalities <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">==</span> <span class="pre">Mod(z,</span> <span class="pre">2)</span></code> and
<code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">==</span> <span class="pre">Mod(z,</span> <span class="pre">3)</span></code> would force <code class="docutils literal notranslate"><span class="pre">hash()</span></code> to be constant on the
integers.</p>
<p>The only way we could “fix” this problem for good would be to abandon
using the <code class="docutils literal notranslate"><span class="pre">==</span></code> operator for “Sage equality”, and implement Sage
equality as a new method attached to each object. Then we could follow
Python rules for <code class="docutils literal notranslate"><span class="pre">==</span></code> and our rules for everything else, and all
Sage code would become completely unreadable (and for that matter
unwritable). So we just have to live with it.</p>
<p>So what is done in Sage is to attempt to satisfy <code class="docutils literal notranslate"><span class="pre">(#)</span></code> when it is
reasonably easy to do so, but use judgment and not go overboard.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">sage: </span><span class="nb">hash</span><span class="p">(</span><span class="n">Mod</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="go">2</span>
</pre></div>
</div>
<p>The output 2 is better than some random hash that also involves the
moduli, but it is of course not right from the Python point of view,
since <code class="docutils literal notranslate"><span class="pre">9</span> <span class="pre">==</span> <span class="pre">Mod(2,7)</span></code>. The goal is to make a hash function that is
fast, but within reason respects any obvious natural inclusions and
coercions.</p>
</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<p>Please avoid catch-all code like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">some_code</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>               <span class="c1"># bad</span>
    <span class="n">more_code</span><span class="p">()</span>
</pre></div>
</div>
<p>If you do not have any exceptions explicitly listed (as a tuple), your
code will catch absolutely anything, including <code class="docutils literal notranslate"><span class="pre">ctrl-C</span></code>, typos in
the code, and alarms, and this will lead to confusion. Also, this
might catch real errors which should be propagated to the user.</p>
<p>To summarize, only catch specific exceptions as in the following
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__coordinate_ring</span>
<span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">OtherExceptions</span><span class="p">)</span> <span class="k">as</span> <span class="n">msg</span><span class="p">:</span>           <span class="c1"># good</span>
    <span class="n">more_code_to_compute_something</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that the syntax in <code class="docutils literal notranslate"><span class="pre">except</span></code> is to list all the exceptions that
are caught as a tuple, followed by an error message.</p>
</div>
<div class="section" id="importing">
<h2>Importing<a class="headerlink" href="#importing" title="Permalink to this headline">¶</a></h2>
<p>We mention two issues with importing: circular imports and importing
large third-party modules.</p>
<p>First, you must avoid circular imports. For example, suppose that the
file <code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/algebras/steenrod_algebra.py</span></code>
started with a line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.sage.algebras.steenrod_algebra_bases</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>and that the file
<code class="docutils literal notranslate"><span class="pre">SAGE_ROOT/src/sage/algebras/steenrod_algebra_bases.py</span></code>
started with a line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.sage.algebras.steenrod_algebra</span> <span class="k">import</span> <span class="n">SteenrodAlgebra</span>
</pre></div>
</div>
<p>This sets up a loop: loading one of these files requires the other,
which then requires the first, etc.</p>
<p>With this set-up, running Sage will produce an error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="n">exceptions</span><span class="o">.</span><span class="n">ImportError</span><span class="p">:</span> <span class="s1">&#39;cannot import name SteenrodAlgebra&#39;</span>
<span class="ow">in</span> <span class="s1">&#39;sage.rings.polynomial.polynomial_element.</span>
<span class="n">Polynomial_generic_dense</span><span class="o">.</span><span class="n">__normalize</span><span class="s1">&#39; ignored</span>
<span class="o">-------------------------------------------------------------------</span>
<span class="ne">ImportError</span>                       <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">...</span>
<span class="ne">ImportError</span><span class="p">:</span> <span class="n">cannot</span> <span class="kn">import</span> <span class="nn">name</span> <span class="n">SteenrodAlgebra</span>
</pre></div>
</div>
<p>Instead, you might replace the <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code> line at the top of the
file by more specific imports where they are needed in the code. For
example, the <code class="docutils literal notranslate"><span class="pre">basis</span></code> method for the class <code class="docutils literal notranslate"><span class="pre">SteenrodAlgebra</span></code> might
look like this (omitting the documentation string):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">basis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">steenrod_algebra_bases</span> <span class="k">import</span> <span class="n">steenrod_algebra_basis</span>
    <span class="k">return</span> <span class="n">steenrod_algebra_basis</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_basis_name</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">prime</span><span class="p">)</span>
</pre></div>
</div>
<p>Second, do not import at the top level of your module a third-party
module that will take a long time to initialize (e.g. matplotlib). As
above, you might instead import specific components of the module when
they are needed, rather than at the top level of your file.</p>
<p>It is important to try to make <code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">sage.all</span> <span class="pre">import</span> <span class="pre">*</span></code> as fast as
possible, since this is what dominates the Sage startup time, and
controlling the top-level imports helps to do this. One important
mechanism in Sage are lazy imports, which don’t actually perform the
import but delay it until the object is actually used. See
<a class="reference external" href="../reference/misc/sage/misc/lazy_import.html#module-sage.misc.lazy_import" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sage.misc.lazy_import</span></code></a> for more details of lazy imports, and
<a class="reference internal" href="coding_basics.html#chapter-directory-structure"><span class="std std-ref">Files and Directory Structure</span></a> for an example using lazy imports
for a new module.</p>
</div>
<div class="section" id="deprecation">
<h2>Deprecation<a class="headerlink" href="#deprecation" title="Permalink to this headline">¶</a></h2>
<p>When making a <strong>backward-incompatible</strong> modification in Sage, the old code should
keep working and display a message indicating how it should be updated/written
in the future. We call this a <em>deprecation</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Deprecated code can only be removed one year after the first
stable release in which it appeared.</p>
</div>
<p>Each deprecation warning contains the number of the trac ticket that defines
it. We use 666 in the examples below. For each entry, consult the function’s
documentation for more information on its behaviour and optional arguments.</p>
<ul>
<li><p class="first"><strong>Rename a keyword:</strong> by decorating a function/method with
<a class="reference external" href="../reference/misc/sage/misc/decorators.html#sage.misc.decorators.rename_keyword" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">rename_keyword</span></code></a>, any user calling
<code class="docutils literal notranslate"><span class="pre">my_function(my_old_keyword=5)</span></code> will see a warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.decorators</span> <span class="k">import</span> <span class="n">rename_keyword</span>
<span class="nd">@rename_keyword</span><span class="p">(</span><span class="n">deprecation</span><span class="o">=</span><span class="mi">666</span><span class="p">,</span> <span class="n">my_old_keyword</span><span class="o">=</span><span class="s1">&#39;my_new_keyword&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">my_new_keyword</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">my_new_keyword</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Rename a function/method:</strong> call
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecated_function_alias" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecated_function_alias()</span></code></a> to obtain a copy of a
function that raises a deprecation warning:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="k">import</span> <span class="n">deprecated_function_alias</span>
<span class="k">def</span> <span class="nf">my_new_function</span><span class="p">():</span>
    <span class="o">...</span>

<span class="n">my_old_function</span> <span class="o">=</span> <span class="n">deprecated_function_alias</span><span class="p">(</span><span class="mi">666</span><span class="p">,</span> <span class="n">my_new_function</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Moving an object to a different module:</strong>
if you rename a source file or move some function (or class) to a
different file, it should still be possible to import that function
from the old module. This can be done using a
<a class="reference external" href="../reference/misc/sage/misc/lazy_import.html#sage.misc.lazy_import.lazy_import" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">lazy_import()</span></code></a> with deprecation.
In the old module, you would write:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="k">import</span> <span class="n">lazy_import</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.new.module.name&#39;</span><span class="p">,</span> <span class="s1">&#39;name_of_the_function&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">666</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also lazily import everything using <code class="docutils literal notranslate"><span class="pre">*</span></code> or a few functions
using a tuple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="k">import</span> <span class="n">lazy_import</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.new.module.name&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">666</span><span class="p">)</span>
<span class="n">lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.other.module&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;func1&#39;</span><span class="p">,</span> <span class="s1">&#39;func2&#39;</span><span class="p">),</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">666</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Remove a name from a global namespace:</strong> this is when you want to
remove a name from a global namespace (say, <code class="docutils literal notranslate"><span class="pre">sage.all</span></code> or some
other <code class="docutils literal notranslate"><span class="pre">all.py</span></code> file) but you want to keep the functionality
available with an explicit import.
This case is similar as the previous one: use a lazy import with
deprecation. One detail: in this case, you don’t want the name
<code class="docutils literal notranslate"><span class="pre">lazy_import</span></code> to be visible in the global namespace, so we add
a leading underscore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.lazy_import</span> <span class="k">import</span> <span class="n">lazy_import</span> <span class="k">as</span> <span class="n">_lazy_import</span>
<span class="n">_lazy_import</span><span class="p">(</span><span class="s1">&#39;sage.some.package&#39;</span><span class="p">,</span> <span class="s1">&#39;some_function&#39;</span><span class="p">,</span> <span class="n">deprecation</span><span class="o">=</span><span class="mi">666</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Any other case:</strong> if none of the cases above apply, call
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.deprecation" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">deprecation()</span></code></a> in the function that you want to
deprecate. It will display the message of your choice (and interact properly
with the doctest framework):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="k">import</span> <span class="n">deprecation</span>
<span class="n">deprecation</span><span class="p">(</span><span class="mi">666</span><span class="p">,</span> <span class="s2">&quot;Do not use your computer to compute 1+1. Use your brain.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<div class="section" id="experimental-unstable-code">
<h3>Experimental/Unstable Code<a class="headerlink" href="#experimental-unstable-code" title="Permalink to this headline">¶</a></h3>
<p>You can mark your newly created code (classes/functions/methods) as
experimental/unstable. In this case, no deprecation warning is needed
when changing this code, its functionality or its interface.</p>
<p>This should allow you to put your stuff in Sage early, without worrying about
making (design) changes later.</p>
<p>When satisfied with the code (when stable for some time, say, one
year), you can delete this warning.</p>
<p>As usual, all code has to be fully doctested and go through our
reviewing process.</p>
<ul>
<li><p class="first"><strong>Experimental function/method:</strong> use the decorator
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">experimental</span></code></a>. Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="k">import</span> <span class="n">experimental</span>
<span class="nd">@experimental</span><span class="p">(</span><span class="mi">66666</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">experimental_function</span><span class="p">():</span>
    <span class="c1"># do something</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Experimental class:</strong> use the decorator
<a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">experimental</span></code></a> for its <code class="docutils literal notranslate"><span class="pre">__init__</span></code>.
Here is an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="k">import</span> <span class="n">experimental</span>
<span class="k">class</span> <span class="nc">experimental_class</span><span class="p">(</span><span class="n">SageObject</span><span class="p">):</span>
    <span class="nd">@experimental</span><span class="p">(</span><span class="mi">66666</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">some</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
        <span class="c1"># do something</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>Any other case:</strong> if none of the cases above apply, call <a class="reference external" href="../reference/misc/sage/misc/superseded.html#sage.misc.superseded.experimental_warning" title="(in Sage Reference Manual: Utilities v8.5)"><code class="xref py py-func docutils literal notranslate"><span class="pre">experimental_warning()</span></code></a> in the code where you want to warn. It will display the message of your choice:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sage.misc.superseded</span> <span class="k">import</span> <span class="n">experimental_warning</span>
<span class="n">experimental_warning</span><span class="p">(</span><span class="mi">66666</span><span class="p">,</span> <span class="s1">&#39;This code is not foolproof.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="using-optional-packages">
<h2>Using Optional Packages<a class="headerlink" href="#using-optional-packages" title="Permalink to this headline">¶</a></h2>
<p>If a function requires an optional package, that function should fail
gracefully—perhaps using a <code class="docutils literal notranslate"><span class="pre">try</span></code>-<code class="docutils literal notranslate"><span class="pre">except</span></code> block—when the
optional package is not available, and should give a hint about how to
install it. For example, typing <code class="docutils literal notranslate"><span class="pre">sage</span> <span class="pre">-optional</span></code> gives a list of all
optional packages, so it might suggest to the user that they type
that. The command <code class="docutils literal notranslate"><span class="pre">optional_packages()</span></code> from within Sage also
returns this list.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Coding in Python for Sage</a><ul>
<li><a class="reference internal" href="#design">Design</a></li>
<li><a class="reference internal" href="#special-sage-functions">Special Sage Functions</a><ul>
<li><a class="reference internal" href="#latex-representation">LaTeX Representation</a></li>
<li><a class="reference internal" href="#print-representation">Print Representation</a></li>
<li><a class="reference internal" href="#matrix-or-vector-from-object">Matrix or Vector from Object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sage-preparsing">Sage Preparsing</a></li>
<li><a class="reference internal" href="#the-sage-coercion-model">The Sage Coercion Model</a></li>
<li><a class="reference internal" href="#mutability">Mutability</a></li>
<li><a class="reference internal" href="#the-hash-special-method">The  __hash__ Special Method</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
<li><a class="reference internal" href="#importing">Importing</a></li>
<li><a class="reference internal" href="#deprecation">Deprecation</a><ul>
<li><a class="reference internal" href="#experimental-unstable-code">Experimental/Unstable Code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-optional-packages">Using Optional Packages</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sage_manuals.html"
                        title="previous chapter">The Sage Manuals</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="coding_in_cython.html"
                        title="next chapter">Coding in Cython</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/coding_in_python.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="coding_in_cython.html" title="Coding in Cython"
             >next</a> |</li>
        <li class="right" >
          <a href="sage_manuals.html" title="The Sage Manuals"
             >previous</a> |</li>
  
    
      <a href="../index.html"><img src="_static/logo_sagemath_black.svg" height="28" style="vertical-align: middle" title="Sage Logo"></a>
    
  
  
        <li class="nav-item nav-item-0"><a href="index.html">Developer&#39;s Guide v8.5</a> &#187;</li>
 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2005--2018, The Sage Development Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
    <script type="text/javascript">
/*global jQuery, window */
/* Sphinx sidebar toggle.  Putting this code at the end of the body
 * enables the toggle for the live, static, and offline docs.  Note:
 * sage.misc.html.math_parse() eats jQuery's dollar-sign shortcut. */
var jq = jQuery;
jq(document).ready(function () {
    var bar, bod, bg, fg, key, tog, wid_old, wid_new, resize, get_state, set_state;
    bod = jq('div.bodywrapper');
    bar = jq('div.sphinxsidebar');
    tog = jq('<div class="sphinxsidebartoggle"></div>');

    /* Delayed resize helper.  Not perfect but good enough. */
    resize = function () {
        setTimeout(function () {
            tog.height(bod.height());
        }, 100);
    };
    jq(window).resize(function () {
        resize();
    });

    /* Setup and add the toggle. See Sphinx v0.5.1 default.css. */
    fg = jq('div.sphinxsidebar p a').css('color') || 'rgb(152, 219, 204)';
    bg = jq('div.document').css('background-color') || 'rgb(28, 78, 99)';
    wid_old = '230px';
    wid_new = '5px';
    tog.css('background-color', bg)
        .css('border-width', '0px')
        .css('border-right', wid_new + ' ridge ' + bg)
        .css('cursor', 'pointer')
        .css('position', 'absolute')
        .css('left', '-' + wid_new)
        .css('top', '0px')
        .css('width', wid_new);
    bod.css('position', 'relative');
    bod.prepend(tog);
    resize();

    /* Cookie helpers. */
    key = 'sphinxsidebar=';
    set_state = function (s) {
        var date = new Date();
        /* Expiry in 7 days. */
        date.setTime(date.getTime() + (7 * 24 * 3600 * 1000));
        document.cookie = key + encodeURIComponent(s) + '; expires=' +
            date.toUTCString() + '; path=/';
    };
    get_state = function () {
        var i, c, crumbs = document.cookie.split(';');
        for (i = 0; i < crumbs.length; i += 1) {
            c = crumbs[i].replace(/^\s+/, '');
            if (c.indexOf(key) === 0) {
                return decodeURIComponent(c.substring(key.length, c.length));
            }
        }
        return null;
    };

    /* Event handlers. */
    tog.mouseover(function (ev) {
        tog.css('border-right-color', fg);
    }).mouseout(function (ev) {
        tog.css('border-right-color', bg);
    }).click(function (ev) {
        if (bod.hasClass('wide')) {
            bod.removeClass('wide');
            bod.css('margin-left', wid_old);
            bar.css('width', wid_old);
            bar.show();
            set_state('visible');
        } else {
            set_state('hidden');
            bar.hide();
            bar.css('width', '0px');
            bod.css('margin-left', wid_new);
            bod.addClass('wide');
        }
        resize();
    });

    /* Hide the normally visible sidebar? */
    if (get_state() === 'hidden') {
        tog.trigger('click');
    } else {
        set_state('visible');
    }
});
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-66100-14', 'auto');
  ga('send', 'pageview');
</script>
  </body>
</html>